var Fb=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var T2=Fb((bS,Gs)=>{function Bb(r,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in r)){const a=Object.getOwnPropertyDescriptor(i,s);a&&Object.defineProperty(r,s,a.get?a:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();function uh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var td={exports:{}},Ka={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y0;function Ub(){if(Y0)return Ka;Y0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:r,type:i,key:l,ref:s!==void 0?s:null,props:a}}return Ka.Fragment=t,Ka.jsx=e,Ka.jsxs=e,Ka}var X0;function $b(){return X0||(X0=1,td.exports=Ub()),td.exports}var $=$b(),ed={exports:{}},Rt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W0;function jb(){if(W0)return Rt;W0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function v(k){return k===null||typeof k!="object"?null:(k=g&&k[g]||k["@@iterator"],typeof k=="function"?k:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,T={};function A(k,j,st){this.props=k,this.context=j,this.refs=T,this.updater=st||y}A.prototype.isReactComponent={},A.prototype.setState=function(k,j){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,j,"setState")},A.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function b(){}b.prototype=A.prototype;function R(k,j,st){this.props=k,this.context=j,this.refs=T,this.updater=st||y}var C=R.prototype=new b;C.constructor=R,S(C,A.prototype),C.isPureReactComponent=!0;var D=Array.isArray;function N(){}var w={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function B(k,j,st){var ct=st.ref;return{$$typeof:r,type:k,key:j,ref:ct!==void 0?ct:null,props:st}}function M(k,j){return B(k.type,j,k.props)}function q(k){return typeof k=="object"&&k!==null&&k.$$typeof===r}function tt(k){var j={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(st){return j[st]})}var V=/\/+/g;function H(k,j){return typeof k=="object"&&k!==null&&k.key!=null?tt(""+k.key):j.toString(36)}function X(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(N,N):(k.status="pending",k.then(function(j){k.status==="pending"&&(k.status="fulfilled",k.value=j)},function(j){k.status==="pending"&&(k.status="rejected",k.reason=j)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function O(k,j,st,ct,ft){var dt=typeof k;(dt==="undefined"||dt==="boolean")&&(k=null);var Et=!1;if(k===null)Et=!0;else switch(dt){case"bigint":case"string":case"number":Et=!0;break;case"object":switch(k.$$typeof){case r:case t:Et=!0;break;case h:return Et=k._init,O(Et(k._payload),j,st,ct,ft)}}if(Et)return ft=ft(k),Et=ct===""?"."+H(k,0):ct,D(ft)?(st="",Et!=null&&(st=Et.replace(V,"$&/")+"/"),O(ft,j,st,"",function(ie){return ie})):ft!=null&&(q(ft)&&(ft=M(ft,st+(ft.key==null||k&&k.key===ft.key?"":(""+ft.key).replace(V,"$&/")+"/")+Et)),j.push(ft)),1;Et=0;var Lt=ct===""?".":ct+":";if(D(k))for(var _t=0;_t<k.length;_t++)ct=k[_t],dt=Lt+H(ct,_t),Et+=O(ct,j,st,dt,ft);else if(_t=v(k),typeof _t=="function")for(k=_t.call(k),_t=0;!(ct=k.next()).done;)ct=ct.value,dt=Lt+H(ct,_t++),Et+=O(ct,j,st,dt,ft);else if(dt==="object"){if(typeof k.then=="function")return O(X(k),j,st,ct,ft);throw j=String(k),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return Et}function G(k,j,st){if(k==null)return k;var ct=[],ft=0;return O(k,ct,"","",function(dt){return j.call(st,dt,ft++)}),ct}function K(k){if(k._status===-1){var j=k._result;j=j(),j.then(function(st){(k._status===0||k._status===-1)&&(k._status=1,k._result=st)},function(st){(k._status===0||k._status===-1)&&(k._status=2,k._result=st)}),k._status===-1&&(k._status=0,k._result=j)}if(k._status===1)return k._result.default;throw k._result}var nt=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},ut={map:G,forEach:function(k,j,st){G(k,function(){j.apply(this,arguments)},st)},count:function(k){var j=0;return G(k,function(){j++}),j},toArray:function(k){return G(k,function(j){return j})||[]},only:function(k){if(!q(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return Rt.Activity=p,Rt.Children=ut,Rt.Component=A,Rt.Fragment=e,Rt.Profiler=s,Rt.PureComponent=R,Rt.StrictMode=i,Rt.Suspense=d,Rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,Rt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return w.H.useMemoCache(k)}},Rt.cache=function(k){return function(){return k.apply(null,arguments)}},Rt.cacheSignal=function(){return null},Rt.cloneElement=function(k,j,st){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var ct=S({},k.props),ft=k.key;if(j!=null)for(dt in j.key!==void 0&&(ft=""+j.key),j)!P.call(j,dt)||dt==="key"||dt==="__self"||dt==="__source"||dt==="ref"&&j.ref===void 0||(ct[dt]=j[dt]);var dt=arguments.length-2;if(dt===1)ct.children=st;else if(1<dt){for(var Et=Array(dt),Lt=0;Lt<dt;Lt++)Et[Lt]=arguments[Lt+2];ct.children=Et}return B(k.type,ft,ct)},Rt.createContext=function(k){return k={$$typeof:l,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},Rt.createElement=function(k,j,st){var ct,ft={},dt=null;if(j!=null)for(ct in j.key!==void 0&&(dt=""+j.key),j)P.call(j,ct)&&ct!=="key"&&ct!=="__self"&&ct!=="__source"&&(ft[ct]=j[ct]);var Et=arguments.length-2;if(Et===1)ft.children=st;else if(1<Et){for(var Lt=Array(Et),_t=0;_t<Et;_t++)Lt[_t]=arguments[_t+2];ft.children=Lt}if(k&&k.defaultProps)for(ct in Et=k.defaultProps,Et)ft[ct]===void 0&&(ft[ct]=Et[ct]);return B(k,dt,ft)},Rt.createRef=function(){return{current:null}},Rt.forwardRef=function(k){return{$$typeof:u,render:k}},Rt.isValidElement=q,Rt.lazy=function(k){return{$$typeof:h,_payload:{_status:-1,_result:k},_init:K}},Rt.memo=function(k,j){return{$$typeof:f,type:k,compare:j===void 0?null:j}},Rt.startTransition=function(k){var j=w.T,st={};w.T=st;try{var ct=k(),ft=w.S;ft!==null&&ft(st,ct),typeof ct=="object"&&ct!==null&&typeof ct.then=="function"&&ct.then(N,nt)}catch(dt){nt(dt)}finally{j!==null&&st.types!==null&&(j.types=st.types),w.T=j}},Rt.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},Rt.use=function(k){return w.H.use(k)},Rt.useActionState=function(k,j,st){return w.H.useActionState(k,j,st)},Rt.useCallback=function(k,j){return w.H.useCallback(k,j)},Rt.useContext=function(k){return w.H.useContext(k)},Rt.useDebugValue=function(){},Rt.useDeferredValue=function(k,j){return w.H.useDeferredValue(k,j)},Rt.useEffect=function(k,j){return w.H.useEffect(k,j)},Rt.useEffectEvent=function(k){return w.H.useEffectEvent(k)},Rt.useId=function(){return w.H.useId()},Rt.useImperativeHandle=function(k,j,st){return w.H.useImperativeHandle(k,j,st)},Rt.useInsertionEffect=function(k,j){return w.H.useInsertionEffect(k,j)},Rt.useLayoutEffect=function(k,j){return w.H.useLayoutEffect(k,j)},Rt.useMemo=function(k,j){return w.H.useMemo(k,j)},Rt.useOptimistic=function(k,j){return w.H.useOptimistic(k,j)},Rt.useReducer=function(k,j,st){return w.H.useReducer(k,j,st)},Rt.useRef=function(k){return w.H.useRef(k)},Rt.useState=function(k){return w.H.useState(k)},Rt.useSyncExternalStore=function(k,j,st){return w.H.useSyncExternalStore(k,j,st)},Rt.useTransition=function(){return w.H.useTransition()},Rt.version="19.2.0",Rt}var Q0;function ch(){return Q0||(Q0=1,ed.exports=jb()),ed.exports}var F=ch();const Gb=uh(F),Hb=Bb({__proto__:null,default:Gb},[F]);var id={exports:{}},qa={},nd={exports:{}},sd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z0;function zb(){return Z0||(Z0=1,(function(r){function t(O,G){var K=O.length;O.push(G);t:for(;0<K;){var nt=K-1>>>1,ut=O[nt];if(0<s(ut,G))O[nt]=G,O[K]=ut,K=nt;else break t}}function e(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var G=O[0],K=O.pop();if(K!==G){O[0]=K;t:for(var nt=0,ut=O.length,k=ut>>>1;nt<k;){var j=2*(nt+1)-1,st=O[j],ct=j+1,ft=O[ct];if(0>s(st,K))ct<ut&&0>s(ft,st)?(O[nt]=ft,O[ct]=K,nt=ct):(O[nt]=st,O[j]=K,nt=j);else if(ct<ut&&0>s(ft,K))O[nt]=ft,O[ct]=K,nt=ct;else break t}}return G}function s(O,G){var K=O.sortIndex-G.sortIndex;return K!==0?K:O.id-G.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var d=[],f=[],h=1,p=null,g=3,v=!1,y=!1,S=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function C(O){for(var G=e(f);G!==null;){if(G.callback===null)i(f);else if(G.startTime<=O)i(f),G.sortIndex=G.expirationTime,t(d,G);else break;G=e(f)}}function D(O){if(S=!1,C(O),!y)if(e(d)!==null)y=!0,N||(N=!0,tt());else{var G=e(f);G!==null&&X(D,G.startTime-O)}}var N=!1,w=-1,P=5,B=-1;function M(){return T?!0:!(r.unstable_now()-B<P)}function q(){if(T=!1,N){var O=r.unstable_now();B=O;var G=!0;try{t:{y=!1,S&&(S=!1,b(w),w=-1),v=!0;var K=g;try{e:{for(C(O),p=e(d);p!==null&&!(p.expirationTime>O&&M());){var nt=p.callback;if(typeof nt=="function"){p.callback=null,g=p.priorityLevel;var ut=nt(p.expirationTime<=O);if(O=r.unstable_now(),typeof ut=="function"){p.callback=ut,C(O),G=!0;break e}p===e(d)&&i(d),C(O)}else i(d);p=e(d)}if(p!==null)G=!0;else{var k=e(f);k!==null&&X(D,k.startTime-O),G=!1}}break t}finally{p=null,g=K,v=!1}G=void 0}}finally{G?tt():N=!1}}}var tt;if(typeof R=="function")tt=function(){R(q)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,H=V.port2;V.port1.onmessage=q,tt=function(){H.postMessage(null)}}else tt=function(){A(q,0)};function X(O,G){w=A(function(){O(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(O){O.callback=null},r.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<O?Math.floor(1e3/O):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_next=function(O){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var K=g;g=G;try{return O()}finally{g=K}},r.unstable_requestPaint=function(){T=!0},r.unstable_runWithPriority=function(O,G){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var K=g;g=O;try{return G()}finally{g=K}},r.unstable_scheduleCallback=function(O,G,K){var nt=r.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?nt+K:nt):K=nt,O){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=K+ut,O={id:h++,callback:G,priorityLevel:O,startTime:K,expirationTime:ut,sortIndex:-1},K>nt?(O.sortIndex=K,t(f,O),e(d)===null&&O===e(f)&&(S?(b(w),w=-1):S=!0,X(D,K-nt))):(O.sortIndex=ut,t(d,O),y||v||(y=!0,N||(N=!0,tt()))),O},r.unstable_shouldYield=M,r.unstable_wrapCallback=function(O){var G=g;return function(){var K=g;g=G;try{return O.apply(this,arguments)}finally{g=K}}}})(sd)),sd}var J0;function Vb(){return J0||(J0=1,nd.exports=zb()),nd.exports}var rd={exports:{}},Ge={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function Kb(){if(ty)return Ge;ty=1;var r=ch();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:d,containerInfo:f,implementation:h}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ge.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ge.createPortal=function(d,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,h)},Ge.flushSync=function(d){var f=l.T,h=i.p;try{if(l.T=null,i.p=2,d)return d()}finally{l.T=f,i.p=h,i.d.f()}},Ge.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Ge.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Ge.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var h=f.as,p=u(h,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):h==="script"&&i.d.X(d,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ge.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Ge.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=u(h,f.crossOrigin);i.d.L(d,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ge.preloadModule=function(d,f){if(typeof d=="string")if(f){var h=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Ge.requestFormReset=function(d){i.d.r(d)},Ge.unstable_batchedUpdates=function(d,f){return d(f)},Ge.useFormState=function(d,f,h){return l.H.useFormState(d,f,h)},Ge.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ge.version="19.2.0",Ge}var ey;function Hv(){if(ey)return rd.exports;ey=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),rd.exports=Kb(),rd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy;function qb(){if(iy)return qa;iy=1;var r=Vb(),t=ch(),e=Hv();function i(n){var o="https://react.dev/errors/"+n;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function a(n){var o=n,c=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(c=o.return),n=o.return;while(n)}return o.tag===3?c:null}function l(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function u(n){if(n.tag===31){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function d(n){if(a(n)!==n)throw Error(i(188))}function f(n){var o=n.alternate;if(!o){if(o=a(n),o===null)throw Error(i(188));return o!==n?null:n}for(var c=n,m=o;;){var E=c.return;if(E===null)break;var x=E.alternate;if(x===null){if(m=E.return,m!==null){c=m;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===c)return d(E),n;if(x===m)return d(E),o;x=x.sibling}throw Error(i(188))}if(c.return!==m.return)c=E,m=x;else{for(var L=!1,I=E.child;I;){if(I===c){L=!0,c=E,m=x;break}if(I===m){L=!0,m=E,c=x;break}I=I.sibling}if(!L){for(I=x.child;I;){if(I===c){L=!0,c=x,m=E;break}if(I===m){L=!0,m=x,c=E;break}I=I.sibling}if(!L)throw Error(i(189))}}if(c.alternate!==m)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?n:o}function h(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n;for(n=n.child;n!==null;){if(o=h(n),o!==null)return o;n=n.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),R=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function tt(n){return n===null||typeof n!="object"?null:(n=q&&n[q]||n["@@iterator"],typeof n=="function"?n:null)}var V=Symbol.for("react.client.reference");function H(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===V?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case D:return"Suspense";case N:return"SuspenseList";case B:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case y:return"Portal";case R:return n.displayName||"Context";case b:return(n._context.displayName||"Context")+".Consumer";case C:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case w:return o=n.displayName||null,o!==null?o:H(n.type)||"Memo";case P:o=n._payload,n=n._init;try{return H(n(o))}catch{}}return null}var X=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},nt=[],ut=-1;function k(n){return{current:n}}function j(n){0>ut||(n.current=nt[ut],nt[ut]=null,ut--)}function st(n,o){ut++,nt[ut]=n.current,n.current=o}var ct=k(null),ft=k(null),dt=k(null),Et=k(null);function Lt(n,o){switch(st(dt,o),st(ft,n),st(ct,null),o.nodeType){case 9:case 11:n=(n=o.documentElement)&&(n=n.namespaceURI)?y0(n):0;break;default:if(n=o.tagName,o=o.namespaceURI)o=y0(o),n=v0(o,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}j(ct),st(ct,n)}function _t(){j(ct),j(ft),j(dt)}function ie(n){n.memoizedState!==null&&st(Et,n);var o=ct.current,c=v0(o,n.type);o!==c&&(st(ft,n),st(ct,c))}function pe(n){ft.current===n&&(j(ct),j(ft)),Et.current===n&&(j(Et),Ga._currentValue=K)}var _e,Oe;function Ce(n){if(_e===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);_e=o&&o[1]||"",Oe=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_e+n+Oe}var $i=!1;function bt(n,o){if(!n||$i)return"";$i=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(o){var lt=function(){throw Error()};if(Object.defineProperty(lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(lt,[])}catch(it){var et=it}Reflect.construct(n,[],lt)}else{try{lt.call()}catch(it){et=it}n.call(lt.prototype)}}else{try{throw Error()}catch(it){et=it}(lt=n())&&typeof lt.catch=="function"&&lt.catch(function(){})}}catch(it){if(it&&et&&typeof it.stack=="string")return[it.stack,et.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=m.DetermineComponentFrameRoot(),L=x[0],I=x[1];if(L&&I){var U=L.split(`
`),J=I.split(`
`);for(E=m=0;m<U.length&&!U[m].includes("DetermineComponentFrameRoot");)m++;for(;E<J.length&&!J[E].includes("DetermineComponentFrameRoot");)E++;if(m===U.length||E===J.length)for(m=U.length-1,E=J.length-1;1<=m&&0<=E&&U[m]!==J[E];)E--;for(;1<=m&&0<=E;m--,E--)if(U[m]!==J[E]){if(m!==1||E!==1)do if(m--,E--,0>E||U[m]!==J[E]){var rt=`
`+U[m].replace(" at new "," at ");return n.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",n.displayName)),rt}while(1<=m&&0<=E);break}}}finally{$i=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?Ce(c):""}function pt(n,o){switch(n.tag){case 26:case 27:case 5:return Ce(n.type);case 16:return Ce("Lazy");case 13:return n.child!==o&&o!==null?Ce("Suspense Fallback"):Ce("Suspense");case 19:return Ce("SuspenseList");case 0:case 15:return bt(n.type,!1);case 11:return bt(n.type.render,!1);case 1:return bt(n.type,!0);case 31:return Ce("Activity");default:return""}}function be(n){try{var o="",c=null;do o+=pt(n,c),c=n,n=n.return;while(n);return o}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var le=Object.prototype.hasOwnProperty,ue=r.unstable_scheduleCallback,ke=r.unstable_cancelCallback,je=r.unstable_shouldYield,He=r.unstable_requestPaint,ne=r.unstable_now,un=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,ys=r.unstable_UserBlockingPriority,Bn=r.unstable_NormalPriority,Qs=r.unstable_LowPriority,vs=r.unstable_IdlePriority,cn=r.log,Bu=r.unstable_setDisableYieldValue,Es=null,ze=null;function ji(n){if(typeof cn=="function"&&Bu(n),ze&&typeof ze.setStrictMode=="function")try{ze.setStrictMode(Es,n)}catch{}}var Ve=Math.clz32?Math.clz32:Ot,Uu=Math.log,$u=Math.LN2;function Ot(n){return n>>>=0,n===0?32:31-(Uu(n)/$u|0)|0}var po=256,go=262144,yo=4194304;function xs(n){var o=n&42;if(o!==0)return o;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function vo(n,o,c){var m=n.pendingLanes;if(m===0)return 0;var E=0,x=n.suspendedLanes,L=n.pingedLanes;n=n.warmLanes;var I=m&134217727;return I!==0?(m=I&~x,m!==0?E=xs(m):(L&=I,L!==0?E=xs(L):c||(c=I&~n,c!==0&&(E=xs(c))))):(I=m&~x,I!==0?E=xs(I):L!==0?E=xs(L):c||(c=m&~n,c!==0&&(E=xs(c)))),E===0?0:o!==0&&o!==E&&(o&x)===0&&(x=E&-E,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:E}function ea(n,o){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&o)===0}function AS(n,o){switch(n){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zh(){var n=yo;return yo<<=1,(yo&62914560)===0&&(yo=4194304),n}function ju(n){for(var o=[],c=0;31>c;c++)o.push(n);return o}function ia(n,o){n.pendingLanes|=o,o!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function RS(n,o,c,m,E,x){var L=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var I=n.entanglements,U=n.expirationTimes,J=n.hiddenUpdates;for(c=L&~c;0<c;){var rt=31-Ve(c),lt=1<<rt;I[rt]=0,U[rt]=-1;var et=J[rt];if(et!==null)for(J[rt]=null,rt=0;rt<et.length;rt++){var it=et[rt];it!==null&&(it.lane&=-536870913)}c&=~lt}m!==0&&Jh(n,m,0),x!==0&&E===0&&n.tag!==0&&(n.suspendedLanes|=x&~(L&~o))}function Jh(n,o,c){n.pendingLanes|=o,n.suspendedLanes&=~o;var m=31-Ve(o);n.entangledLanes|=o,n.entanglements[m]=n.entanglements[m]|1073741824|c&261930}function tm(n,o){var c=n.entangledLanes|=o;for(n=n.entanglements;c;){var m=31-Ve(c),E=1<<m;E&o|n[m]&o&&(n[m]|=o),c&=~E}}function em(n,o){var c=o&-o;return c=(c&42)!==0?1:Gu(c),(c&(n.suspendedLanes|o))!==0?0:c}function Gu(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Hu(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function im(){var n=G.p;return n!==0?n:(n=window.event,n===void 0?32:j0(n.type))}function nm(n,o){var c=G.p;try{return G.p=n,o()}finally{G.p=c}}var Un=Math.random().toString(36).slice(2),Me="__reactFiber$"+Un,We="__reactProps$"+Un,Zs="__reactContainer$"+Un,zu="__reactEvents$"+Un,LS="__reactListeners$"+Un,_S="__reactHandles$"+Un,sm="__reactResources$"+Un,na="__reactMarker$"+Un;function Vu(n){delete n[Me],delete n[We],delete n[zu],delete n[LS],delete n[_S]}function Js(n){var o=n[Me];if(o)return o;for(var c=n.parentNode;c;){if(o=c[Zs]||c[Me]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(n=R0(n);n!==null;){if(c=n[Me])return c;n=R0(n)}return o}n=c,c=n.parentNode}return null}function tr(n){if(n=n[Me]||n[Zs]){var o=n.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return n}return null}function sa(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n.stateNode;throw Error(i(33))}function er(n){var o=n[sm];return o||(o=n[sm]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function we(n){n[na]=!0}var rm=new Set,am={};function Ss(n,o){ir(n,o),ir(n+"Capture",o)}function ir(n,o){for(am[n]=o,n=0;n<o.length;n++)rm.add(o[n])}var CS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),om={},lm={};function wS(n){return le.call(lm,n)?!0:le.call(om,n)?!1:CS.test(n)?lm[n]=!0:(om[n]=!0,!1)}function Eo(n,o,c){if(wS(o))if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(o);return;case"boolean":var m=o.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){n.removeAttribute(o);return}}n.setAttribute(o,""+c)}}function xo(n,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttribute(o,""+c)}}function fn(n,o,c,m){if(m===null)n.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(o,c,""+m)}}function xi(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function um(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function DS(n,o,c){var m=Object.getOwnPropertyDescriptor(n.constructor.prototype,o);if(!n.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var E=m.get,x=m.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return E.call(this)},set:function(L){c=""+L,x.call(this,L)}}),Object.defineProperty(n,o,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(L){c=""+L},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Ku(n){if(!n._valueTracker){var o=um(n)?"checked":"value";n._valueTracker=DS(n,o,""+n[o])}}function cm(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return n&&(m=um(n)?n.checked?"true":"false":n.value),n=m,n!==c?(o.setValue(n),!0):!1}function So(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var IS=/[\n"\\]/g;function Si(n){return n.replace(IS,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function qu(n,o,c,m,E,x,L,I){n.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.type=L:n.removeAttribute("type"),o!=null?L==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+xi(o)):n.value!==""+xi(o)&&(n.value=""+xi(o)):L!=="submit"&&L!=="reset"||n.removeAttribute("value"),o!=null?Yu(n,L,xi(o)):c!=null?Yu(n,L,xi(c)):m!=null&&n.removeAttribute("value"),E==null&&x!=null&&(n.defaultChecked=!!x),E!=null&&(n.checked=E&&typeof E!="function"&&typeof E!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?n.name=""+xi(I):n.removeAttribute("name")}function fm(n,o,c,m,E,x,L,I){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){Ku(n);return}c=c!=null?""+xi(c):"",o=o!=null?""+xi(o):c,I||o===n.value||(n.value=o),n.defaultValue=o}m=m??E,m=typeof m!="function"&&typeof m!="symbol"&&!!m,n.checked=I?n.checked:!!m,n.defaultChecked=!!m,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(n.name=L),Ku(n)}function Yu(n,o,c){o==="number"&&So(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function nr(n,o,c,m){if(n=n.options,o){o={};for(var E=0;E<c.length;E++)o["$"+c[E]]=!0;for(c=0;c<n.length;c++)E=o.hasOwnProperty("$"+n[c].value),n[c].selected!==E&&(n[c].selected=E),E&&m&&(n[c].defaultSelected=!0)}else{for(c=""+xi(c),o=null,E=0;E<n.length;E++){if(n[E].value===c){n[E].selected=!0,m&&(n[E].defaultSelected=!0);return}o!==null||n[E].disabled||(o=n[E])}o!==null&&(o.selected=!0)}}function dm(n,o,c){if(o!=null&&(o=""+xi(o),o!==n.value&&(n.value=o),c==null)){n.defaultValue!==o&&(n.defaultValue=o);return}n.defaultValue=c!=null?""+xi(c):""}function hm(n,o,c,m){if(o==null){if(m!=null){if(c!=null)throw Error(i(92));if(X(m)){if(1<m.length)throw Error(i(93));m=m[0]}c=m}c==null&&(c=""),o=c}c=xi(o),n.defaultValue=c,m=n.textContent,m===c&&m!==""&&m!==null&&(n.value=m),Ku(n)}function sr(n,o){if(o){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=o;return}}n.textContent=o}var OS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mm(n,o,c){var m=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?n.setProperty(o,""):o==="float"?n.cssFloat="":n[o]="":m?n.setProperty(o,c):typeof c!="number"||c===0||OS.has(o)?o==="float"?n.cssFloat=c:n[o]=(""+c).trim():n[o]=c+"px"}function pm(n,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(n=n.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||o!=null&&o.hasOwnProperty(m)||(m.indexOf("--")===0?n.setProperty(m,""):m==="float"?n.cssFloat="":n[m]="");for(var E in o)m=o[E],o.hasOwnProperty(E)&&c[E]!==m&&mm(n,E,m)}else for(var x in o)o.hasOwnProperty(x)&&mm(n,x,o[x])}function Xu(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function To(n){return MS.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function dn(){}var Wu=null;function Qu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rr=null,ar=null;function gm(n){var o=tr(n);if(o&&(n=o.stateNode)){var c=n[We]||null;t:switch(n=o.stateNode,o.type){case"input":if(qu(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Si(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==n&&m.form===n.form){var E=m[We]||null;if(!E)throw Error(i(90));qu(m,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(o=0;o<c.length;o++)m=c[o],m.form===n.form&&cm(m)}break t;case"textarea":dm(n,c.value,c.defaultValue);break t;case"select":o=c.value,o!=null&&nr(n,!!c.multiple,o,!1)}}}var Zu=!1;function ym(n,o,c){if(Zu)return n(o,c);Zu=!0;try{var m=n(o);return m}finally{if(Zu=!1,(rr!==null||ar!==null)&&(ul(),rr&&(o=rr,n=ar,ar=rr=null,gm(o),n)))for(o=0;o<n.length;o++)gm(n[o])}}function ra(n,o){var c=n.stateNode;if(c===null)return null;var m=c[We]||null;if(m===null)return null;c=m[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break t;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ju=!1;if(hn)try{var aa={};Object.defineProperty(aa,"passive",{get:function(){Ju=!0}}),window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,aa)}catch{Ju=!1}var $n=null,tc=null,bo=null;function vm(){if(bo)return bo;var n,o=tc,c=o.length,m,E="value"in $n?$n.value:$n.textContent,x=E.length;for(n=0;n<c&&o[n]===E[n];n++);var L=c-n;for(m=1;m<=L&&o[c-m]===E[x-m];m++);return bo=E.slice(n,1<m?1-m:void 0)}function Ao(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Ro(){return!0}function Em(){return!1}function Qe(n){function o(c,m,E,x,L){this._reactName=c,this._targetInst=E,this.type=m,this.nativeEvent=x,this.target=L,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(c=n[I],this[I]=c?c(x):x[I]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ro:Em,this.isPropagationStopped=Em,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ro)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ro)},persist:function(){},isPersistent:Ro}),o}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lo=Qe(Ts),oa=p({},Ts,{view:0,detail:0}),PS=Qe(oa),ec,ic,la,_o=p({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==la&&(la&&n.type==="mousemove"?(ec=n.screenX-la.screenX,ic=n.screenY-la.screenY):ic=ec=0,la=n),ec)},movementY:function(n){return"movementY"in n?n.movementY:ic}}),xm=Qe(_o),NS=p({},_o,{dataTransfer:0}),FS=Qe(NS),BS=p({},oa,{relatedTarget:0}),nc=Qe(BS),US=p({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),$S=Qe(US),jS=p({},Ts,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),GS=Qe(jS),HS=p({},Ts,{data:0}),Sm=Qe(HS),zS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qS(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=KS[n])?!!o[n]:!1}function sc(){return qS}var YS=p({},oa,{key:function(n){if(n.key){var o=zS[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Ao(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?VS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sc,charCode:function(n){return n.type==="keypress"?Ao(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ao(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),XS=Qe(YS),WS=p({},_o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tm=Qe(WS),QS=p({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sc}),ZS=Qe(QS),JS=p({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),tT=Qe(JS),eT=p({},_o,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),iT=Qe(eT),nT=p({},Ts,{newState:0,oldState:0}),sT=Qe(nT),rT=[9,13,27,32],rc=hn&&"CompositionEvent"in window,ua=null;hn&&"documentMode"in document&&(ua=document.documentMode);var aT=hn&&"TextEvent"in window&&!ua,bm=hn&&(!rc||ua&&8<ua&&11>=ua),Am=" ",Rm=!1;function Lm(n,o){switch(n){case"keyup":return rT.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _m(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var or=!1;function oT(n,o){switch(n){case"compositionend":return _m(o);case"keypress":return o.which!==32?null:(Rm=!0,Am);case"textInput":return n=o.data,n===Am&&Rm?null:n;default:return null}}function lT(n,o){if(or)return n==="compositionend"||!rc&&Lm(n,o)?(n=vm(),bo=tc=$n=null,or=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return bm&&o.locale!=="ko"?null:o.data;default:return null}}var uT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!uT[n.type]:o==="textarea"}function wm(n,o,c,m){rr?ar?ar.push(m):ar=[m]:rr=m,o=gl(o,"onChange"),0<o.length&&(c=new Lo("onChange","change",null,c,m),n.push({event:c,listeners:o}))}var ca=null,fa=null;function cT(n){f0(n,0)}function Co(n){var o=sa(n);if(cm(o))return n}function Dm(n,o){if(n==="change")return o}var Im=!1;if(hn){var ac;if(hn){var oc="oninput"in document;if(!oc){var Om=document.createElement("div");Om.setAttribute("oninput","return;"),oc=typeof Om.oninput=="function"}ac=oc}else ac=!1;Im=ac&&(!document.documentMode||9<document.documentMode)}function km(){ca&&(ca.detachEvent("onpropertychange",Mm),fa=ca=null)}function Mm(n){if(n.propertyName==="value"&&Co(fa)){var o=[];wm(o,fa,n,Qu(n)),ym(cT,o)}}function fT(n,o,c){n==="focusin"?(km(),ca=o,fa=c,ca.attachEvent("onpropertychange",Mm)):n==="focusout"&&km()}function dT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Co(fa)}function hT(n,o){if(n==="click")return Co(o)}function mT(n,o){if(n==="input"||n==="change")return Co(o)}function pT(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var ri=typeof Object.is=="function"?Object.is:pT;function da(n,o){if(ri(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var c=Object.keys(n),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var E=c[m];if(!le.call(o,E)||!ri(n[E],o[E]))return!1}return!0}function Pm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Nm(n,o){var c=Pm(n);n=0;for(var m;c;){if(c.nodeType===3){if(m=n+c.textContent.length,n<=o&&m>=o)return{node:c,offset:o-n};n=m}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Pm(c)}}function Fm(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Fm(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Bm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var o=So(n.document);o instanceof n.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)n=o.contentWindow;else break;o=So(n.document)}return o}function lc(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}var gT=hn&&"documentMode"in document&&11>=document.documentMode,lr=null,uc=null,ha=null,cc=!1;function Um(n,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;cc||lr==null||lr!==So(m)||(m=lr,"selectionStart"in m&&lc(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ha&&da(ha,m)||(ha=m,m=gl(uc,"onSelect"),0<m.length&&(o=new Lo("onSelect","select",null,o,c),n.push({event:o,listeners:m}),o.target=lr)))}function bs(n,o){var c={};return c[n.toLowerCase()]=o.toLowerCase(),c["Webkit"+n]="webkit"+o,c["Moz"+n]="moz"+o,c}var ur={animationend:bs("Animation","AnimationEnd"),animationiteration:bs("Animation","AnimationIteration"),animationstart:bs("Animation","AnimationStart"),transitionrun:bs("Transition","TransitionRun"),transitionstart:bs("Transition","TransitionStart"),transitioncancel:bs("Transition","TransitionCancel"),transitionend:bs("Transition","TransitionEnd")},fc={},$m={};hn&&($m=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);function As(n){if(fc[n])return fc[n];if(!ur[n])return n;var o=ur[n],c;for(c in o)if(o.hasOwnProperty(c)&&c in $m)return fc[n]=o[c];return n}var jm=As("animationend"),Gm=As("animationiteration"),Hm=As("animationstart"),yT=As("transitionrun"),vT=As("transitionstart"),ET=As("transitioncancel"),zm=As("transitionend"),Vm=new Map,dc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dc.push("scrollEnd");function ki(n,o){Vm.set(n,o),Ss(o,[n])}var wo=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Ti=[],cr=0,hc=0;function Do(){for(var n=cr,o=hc=cr=0;o<n;){var c=Ti[o];Ti[o++]=null;var m=Ti[o];Ti[o++]=null;var E=Ti[o];Ti[o++]=null;var x=Ti[o];if(Ti[o++]=null,m!==null&&E!==null){var L=m.pending;L===null?E.next=E:(E.next=L.next,L.next=E),m.pending=E}x!==0&&Km(c,E,x)}}function Io(n,o,c,m){Ti[cr++]=n,Ti[cr++]=o,Ti[cr++]=c,Ti[cr++]=m,hc|=m,n.lanes|=m,n=n.alternate,n!==null&&(n.lanes|=m)}function mc(n,o,c,m){return Io(n,o,c,m),Oo(n)}function Rs(n,o){return Io(n,null,null,o),Oo(n)}function Km(n,o,c){n.lanes|=c;var m=n.alternate;m!==null&&(m.lanes|=c);for(var E=!1,x=n.return;x!==null;)x.childLanes|=c,m=x.alternate,m!==null&&(m.childLanes|=c),x.tag===22&&(n=x.stateNode,n===null||n._visibility&1||(E=!0)),n=x,x=x.return;return n.tag===3?(x=n.stateNode,E&&o!==null&&(E=31-Ve(c),n=x.hiddenUpdates,m=n[E],m===null?n[E]=[o]:m.push(o),o.lane=c|536870912),x):null}function Oo(n){if(50<Pa)throw Pa=0,Af=null,Error(i(185));for(var o=n.return;o!==null;)n=o,o=n.return;return n.tag===3?n.stateNode:null}var fr={};function xT(n,o,c,m){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(n,o,c,m){return new xT(n,o,c,m)}function pc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function mn(n,o){var c=n.alternate;return c===null?(c=ai(n.tag,o,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=o,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,o=n.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function qm(n,o){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,o=c.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),n}function ko(n,o,c,m,E,x){var L=0;if(m=n,typeof n=="function")pc(n)&&(L=1);else if(typeof n=="string")L=Rb(n,c,ct.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case B:return n=ai(31,c,o,E),n.elementType=B,n.lanes=x,n;case S:return Ls(c.children,E,x,o);case T:L=8,E|=24;break;case A:return n=ai(12,c,o,E|2),n.elementType=A,n.lanes=x,n;case D:return n=ai(13,c,o,E),n.elementType=D,n.lanes=x,n;case N:return n=ai(19,c,o,E),n.elementType=N,n.lanes=x,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case R:L=10;break t;case b:L=9;break t;case C:L=11;break t;case w:L=14;break t;case P:L=16,m=null;break t}L=29,c=Error(i(130,n===null?"null":typeof n,"")),m=null}return o=ai(L,c,o,E),o.elementType=n,o.type=m,o.lanes=x,o}function Ls(n,o,c,m){return n=ai(7,n,m,o),n.lanes=c,n}function gc(n,o,c){return n=ai(6,n,null,o),n.lanes=c,n}function Ym(n){var o=ai(18,null,null,0);return o.stateNode=n,o}function yc(n,o,c){return o=ai(4,n.children!==null?n.children:[],n.key,o),o.lanes=c,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}var Xm=new WeakMap;function bi(n,o){if(typeof n=="object"&&n!==null){var c=Xm.get(n);return c!==void 0?c:(o={value:n,source:o,stack:be(o)},Xm.set(n,o),o)}return{value:n,source:o,stack:be(o)}}var dr=[],hr=0,Mo=null,ma=0,Ai=[],Ri=0,jn=null,Gi=1,Hi="";function pn(n,o){dr[hr++]=ma,dr[hr++]=Mo,Mo=n,ma=o}function Wm(n,o,c){Ai[Ri++]=Gi,Ai[Ri++]=Hi,Ai[Ri++]=jn,jn=n;var m=Gi;n=Hi;var E=32-Ve(m)-1;m&=~(1<<E),c+=1;var x=32-Ve(o)+E;if(30<x){var L=E-E%5;x=(m&(1<<L)-1).toString(32),m>>=L,E-=L,Gi=1<<32-Ve(o)+E|c<<E|m,Hi=x+n}else Gi=1<<x|c<<E|m,Hi=n}function vc(n){n.return!==null&&(pn(n,1),Wm(n,1,0))}function Ec(n){for(;n===Mo;)Mo=dr[--hr],dr[hr]=null,ma=dr[--hr],dr[hr]=null;for(;n===jn;)jn=Ai[--Ri],Ai[Ri]=null,Hi=Ai[--Ri],Ai[Ri]=null,Gi=Ai[--Ri],Ai[Ri]=null}function Qm(n,o){Ai[Ri++]=Gi,Ai[Ri++]=Hi,Ai[Ri++]=jn,Gi=o.id,Hi=o.overflow,jn=n}var Pe=null,te=null,Ft=!1,Gn=null,Li=!1,xc=Error(i(519));function Hn(n){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw pa(bi(o,n)),xc}function Zm(n){var o=n.stateNode,c=n.type,m=n.memoizedProps;switch(o[Me]=n,o[We]=m,c){case"dialog":Mt("cancel",o),Mt("close",o);break;case"iframe":case"object":case"embed":Mt("load",o);break;case"video":case"audio":for(c=0;c<Fa.length;c++)Mt(Fa[c],o);break;case"source":Mt("error",o);break;case"img":case"image":case"link":Mt("error",o),Mt("load",o);break;case"details":Mt("toggle",o);break;case"input":Mt("invalid",o),fm(o,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Mt("invalid",o);break;case"textarea":Mt("invalid",o),hm(o,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||m.suppressHydrationWarning===!0||p0(o.textContent,c)?(m.popover!=null&&(Mt("beforetoggle",o),Mt("toggle",o)),m.onScroll!=null&&Mt("scroll",o),m.onScrollEnd!=null&&Mt("scrollend",o),m.onClick!=null&&(o.onclick=dn),o=!0):o=!1,o||Hn(n,!0)}function Jm(n){for(Pe=n.return;Pe;)switch(Pe.tag){case 5:case 31:case 13:Li=!1;return;case 27:case 3:Li=!0;return;default:Pe=Pe.return}}function mr(n){if(n!==Pe)return!1;if(!Ft)return Jm(n),Ft=!0,!1;var o=n.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||Uf(n.type,n.memoizedProps)),c=!c),c&&te&&Hn(n),Jm(n),o===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));te=A0(n)}else if(o===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));te=A0(n)}else o===27?(o=te,ns(n.type)?(n=zf,zf=null,te=n):te=o):te=Pe?Ci(n.stateNode.nextSibling):null;return!0}function _s(){te=Pe=null,Ft=!1}function Sc(){var n=Gn;return n!==null&&(ei===null?ei=n:ei.push.apply(ei,n),Gn=null),n}function pa(n){Gn===null?Gn=[n]:Gn.push(n)}var Tc=k(null),Cs=null,gn=null;function zn(n,o,c){st(Tc,o._currentValue),o._currentValue=c}function yn(n){n._currentValue=Tc.current,j(Tc)}function bc(n,o,c){for(;n!==null;){var m=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),n===c)break;n=n.return}}function Ac(n,o,c,m){var E=n.child;for(E!==null&&(E.return=n);E!==null;){var x=E.dependencies;if(x!==null){var L=E.child;x=x.firstContext;t:for(;x!==null;){var I=x;x=E;for(var U=0;U<o.length;U++)if(I.context===o[U]){x.lanes|=c,I=x.alternate,I!==null&&(I.lanes|=c),bc(x.return,c,n),m||(L=null);break t}x=I.next}}else if(E.tag===18){if(L=E.return,L===null)throw Error(i(341));L.lanes|=c,x=L.alternate,x!==null&&(x.lanes|=c),bc(L,c,n),L=null}else L=E.child;if(L!==null)L.return=E;else for(L=E;L!==null;){if(L===n){L=null;break}if(E=L.sibling,E!==null){E.return=L.return,L=E;break}L=L.return}E=L}}function pr(n,o,c,m){n=null;for(var E=o,x=!1;E!==null;){if(!x){if((E.flags&524288)!==0)x=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var L=E.alternate;if(L===null)throw Error(i(387));if(L=L.memoizedProps,L!==null){var I=E.type;ri(E.pendingProps.value,L.value)||(n!==null?n.push(I):n=[I])}}else if(E===Et.current){if(L=E.alternate,L===null)throw Error(i(387));L.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(n!==null?n.push(Ga):n=[Ga])}E=E.return}n!==null&&Ac(o,n,c,m),o.flags|=262144}function Po(n){for(n=n.firstContext;n!==null;){if(!ri(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ws(n){Cs=n,gn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ne(n){return tp(Cs,n)}function No(n,o){return Cs===null&&ws(n),tp(n,o)}function tp(n,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},gn===null){if(n===null)throw Error(i(308));gn=o,n.dependencies={lanes:0,firstContext:o},n.flags|=524288}else gn=gn.next=o;return c}var ST=typeof AbortController<"u"?AbortController:function(){var n=[],o=this.signal={aborted:!1,addEventListener:function(c,m){n.push(m)}};this.abort=function(){o.aborted=!0,n.forEach(function(c){return c()})}},TT=r.unstable_scheduleCallback,bT=r.unstable_NormalPriority,ve={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rc(){return{controller:new ST,data:new Map,refCount:0}}function ga(n){n.refCount--,n.refCount===0&&TT(bT,function(){n.controller.abort()})}var ya=null,Lc=0,gr=0,yr=null;function AT(n,o){if(ya===null){var c=ya=[];Lc=0,gr=Df(),yr={status:"pending",value:void 0,then:function(m){c.push(m)}}}return Lc++,o.then(ep,ep),o}function ep(){if(--Lc===0&&ya!==null){yr!==null&&(yr.status="fulfilled");var n=ya;ya=null,gr=0,yr=null;for(var o=0;o<n.length;o++)(0,n[o])()}}function RT(n,o){var c=[],m={status:"pending",value:null,reason:null,then:function(E){c.push(E)}};return n.then(function(){m.status="fulfilled",m.value=o;for(var E=0;E<c.length;E++)(0,c[E])(o)},function(E){for(m.status="rejected",m.reason=E,E=0;E<c.length;E++)(0,c[E])(void 0)}),m}var ip=O.S;O.S=function(n,o){Ug=ne(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&AT(n,o),ip!==null&&ip(n,o)};var Ds=k(null);function _c(){var n=Ds.current;return n!==null?n:Qt.pooledCache}function Fo(n,o){o===null?st(Ds,Ds.current):st(Ds,o.pool)}function np(){var n=_c();return n===null?null:{parent:ve._currentValue,pool:n}}var vr=Error(i(460)),Cc=Error(i(474)),Bo=Error(i(542)),Uo={then:function(){}};function sp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function rp(n,o,c){switch(c=n[c],c===void 0?n.push(o):c!==o&&(o.then(dn,dn),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,op(n),n;default:if(typeof o.status=="string")o.then(dn,dn);else{if(n=Qt,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=o,n.status="pending",n.then(function(m){if(o.status==="pending"){var E=o;E.status="fulfilled",E.value=m}},function(m){if(o.status==="pending"){var E=o;E.status="rejected",E.reason=m}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,op(n),n}throw Os=o,vr}}function Is(n){try{var o=n._init;return o(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Os=c,vr):c}}var Os=null;function ap(){if(Os===null)throw Error(i(459));var n=Os;return Os=null,n}function op(n){if(n===vr||n===Bo)throw Error(i(483))}var Er=null,va=0;function $o(n){var o=va;return va+=1,Er===null&&(Er=[]),rp(Er,n,o)}function Ea(n,o){o=o.props.ref,n.ref=o!==void 0?o:null}function jo(n,o){throw o.$$typeof===g?Error(i(525)):(n=Object.prototype.toString.call(o),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n)))}function lp(n){function o(Y,z){if(n){var Z=Y.deletions;Z===null?(Y.deletions=[z],Y.flags|=16):Z.push(z)}}function c(Y,z){if(!n)return null;for(;z!==null;)o(Y,z),z=z.sibling;return null}function m(Y){for(var z=new Map;Y!==null;)Y.key!==null?z.set(Y.key,Y):z.set(Y.index,Y),Y=Y.sibling;return z}function E(Y,z){return Y=mn(Y,z),Y.index=0,Y.sibling=null,Y}function x(Y,z,Z){return Y.index=Z,n?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<z?(Y.flags|=67108866,z):Z):(Y.flags|=67108866,z)):(Y.flags|=1048576,z)}function L(Y){return n&&Y.alternate===null&&(Y.flags|=67108866),Y}function I(Y,z,Z,ot){return z===null||z.tag!==6?(z=gc(Z,Y.mode,ot),z.return=Y,z):(z=E(z,Z),z.return=Y,z)}function U(Y,z,Z,ot){var xt=Z.type;return xt===S?rt(Y,z,Z.props.children,ot,Z.key):z!==null&&(z.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===P&&Is(xt)===z.type)?(z=E(z,Z.props),Ea(z,Z),z.return=Y,z):(z=ko(Z.type,Z.key,Z.props,null,Y.mode,ot),Ea(z,Z),z.return=Y,z)}function J(Y,z,Z,ot){return z===null||z.tag!==4||z.stateNode.containerInfo!==Z.containerInfo||z.stateNode.implementation!==Z.implementation?(z=yc(Z,Y.mode,ot),z.return=Y,z):(z=E(z,Z.children||[]),z.return=Y,z)}function rt(Y,z,Z,ot,xt){return z===null||z.tag!==7?(z=Ls(Z,Y.mode,ot,xt),z.return=Y,z):(z=E(z,Z),z.return=Y,z)}function lt(Y,z,Z){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=gc(""+z,Y.mode,Z),z.return=Y,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case v:return Z=ko(z.type,z.key,z.props,null,Y.mode,Z),Ea(Z,z),Z.return=Y,Z;case y:return z=yc(z,Y.mode,Z),z.return=Y,z;case P:return z=Is(z),lt(Y,z,Z)}if(X(z)||tt(z))return z=Ls(z,Y.mode,Z,null),z.return=Y,z;if(typeof z.then=="function")return lt(Y,$o(z),Z);if(z.$$typeof===R)return lt(Y,No(Y,z),Z);jo(Y,z)}return null}function et(Y,z,Z,ot){var xt=z!==null?z.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return xt!==null?null:I(Y,z,""+Z,ot);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case v:return Z.key===xt?U(Y,z,Z,ot):null;case y:return Z.key===xt?J(Y,z,Z,ot):null;case P:return Z=Is(Z),et(Y,z,Z,ot)}if(X(Z)||tt(Z))return xt!==null?null:rt(Y,z,Z,ot,null);if(typeof Z.then=="function")return et(Y,z,$o(Z),ot);if(Z.$$typeof===R)return et(Y,z,No(Y,Z),ot);jo(Y,Z)}return null}function it(Y,z,Z,ot,xt){if(typeof ot=="string"&&ot!==""||typeof ot=="number"||typeof ot=="bigint")return Y=Y.get(Z)||null,I(z,Y,""+ot,xt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case v:return Y=Y.get(ot.key===null?Z:ot.key)||null,U(z,Y,ot,xt);case y:return Y=Y.get(ot.key===null?Z:ot.key)||null,J(z,Y,ot,xt);case P:return ot=Is(ot),it(Y,z,Z,ot,xt)}if(X(ot)||tt(ot))return Y=Y.get(Z)||null,rt(z,Y,ot,xt,null);if(typeof ot.then=="function")return it(Y,z,Z,$o(ot),xt);if(ot.$$typeof===R)return it(Y,z,Z,No(z,ot),xt);jo(z,ot)}return null}function gt(Y,z,Z,ot){for(var xt=null,Ut=null,yt=z,wt=z=0,Nt=null;yt!==null&&wt<Z.length;wt++){yt.index>wt?(Nt=yt,yt=null):Nt=yt.sibling;var $t=et(Y,yt,Z[wt],ot);if($t===null){yt===null&&(yt=Nt);break}n&&yt&&$t.alternate===null&&o(Y,yt),z=x($t,z,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t,yt=Nt}if(wt===Z.length)return c(Y,yt),Ft&&pn(Y,wt),xt;if(yt===null){for(;wt<Z.length;wt++)yt=lt(Y,Z[wt],ot),yt!==null&&(z=x(yt,z,wt),Ut===null?xt=yt:Ut.sibling=yt,Ut=yt);return Ft&&pn(Y,wt),xt}for(yt=m(yt);wt<Z.length;wt++)Nt=it(yt,Y,wt,Z[wt],ot),Nt!==null&&(n&&Nt.alternate!==null&&yt.delete(Nt.key===null?wt:Nt.key),z=x(Nt,z,wt),Ut===null?xt=Nt:Ut.sibling=Nt,Ut=Nt);return n&&yt.forEach(function(ls){return o(Y,ls)}),Ft&&pn(Y,wt),xt}function St(Y,z,Z,ot){if(Z==null)throw Error(i(151));for(var xt=null,Ut=null,yt=z,wt=z=0,Nt=null,$t=Z.next();yt!==null&&!$t.done;wt++,$t=Z.next()){yt.index>wt?(Nt=yt,yt=null):Nt=yt.sibling;var ls=et(Y,yt,$t.value,ot);if(ls===null){yt===null&&(yt=Nt);break}n&&yt&&ls.alternate===null&&o(Y,yt),z=x(ls,z,wt),Ut===null?xt=ls:Ut.sibling=ls,Ut=ls,yt=Nt}if($t.done)return c(Y,yt),Ft&&pn(Y,wt),xt;if(yt===null){for(;!$t.done;wt++,$t=Z.next())$t=lt(Y,$t.value,ot),$t!==null&&(z=x($t,z,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t);return Ft&&pn(Y,wt),xt}for(yt=m(yt);!$t.done;wt++,$t=Z.next())$t=it(yt,Y,wt,$t.value,ot),$t!==null&&(n&&$t.alternate!==null&&yt.delete($t.key===null?wt:$t.key),z=x($t,z,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t);return n&&yt.forEach(function(Nb){return o(Y,Nb)}),Ft&&pn(Y,wt),xt}function Xt(Y,z,Z,ot){if(typeof Z=="object"&&Z!==null&&Z.type===S&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case v:t:{for(var xt=Z.key;z!==null;){if(z.key===xt){if(xt=Z.type,xt===S){if(z.tag===7){c(Y,z.sibling),ot=E(z,Z.props.children),ot.return=Y,Y=ot;break t}}else if(z.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===P&&Is(xt)===z.type){c(Y,z.sibling),ot=E(z,Z.props),Ea(ot,Z),ot.return=Y,Y=ot;break t}c(Y,z);break}else o(Y,z);z=z.sibling}Z.type===S?(ot=Ls(Z.props.children,Y.mode,ot,Z.key),ot.return=Y,Y=ot):(ot=ko(Z.type,Z.key,Z.props,null,Y.mode,ot),Ea(ot,Z),ot.return=Y,Y=ot)}return L(Y);case y:t:{for(xt=Z.key;z!==null;){if(z.key===xt)if(z.tag===4&&z.stateNode.containerInfo===Z.containerInfo&&z.stateNode.implementation===Z.implementation){c(Y,z.sibling),ot=E(z,Z.children||[]),ot.return=Y,Y=ot;break t}else{c(Y,z);break}else o(Y,z);z=z.sibling}ot=yc(Z,Y.mode,ot),ot.return=Y,Y=ot}return L(Y);case P:return Z=Is(Z),Xt(Y,z,Z,ot)}if(X(Z))return gt(Y,z,Z,ot);if(tt(Z)){if(xt=tt(Z),typeof xt!="function")throw Error(i(150));return Z=xt.call(Z),St(Y,z,Z,ot)}if(typeof Z.then=="function")return Xt(Y,z,$o(Z),ot);if(Z.$$typeof===R)return Xt(Y,z,No(Y,Z),ot);jo(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,z!==null&&z.tag===6?(c(Y,z.sibling),ot=E(z,Z),ot.return=Y,Y=ot):(c(Y,z),ot=gc(Z,Y.mode,ot),ot.return=Y,Y=ot),L(Y)):c(Y,z)}return function(Y,z,Z,ot){try{va=0;var xt=Xt(Y,z,Z,ot);return Er=null,xt}catch(yt){if(yt===vr||yt===Bo)throw yt;var Ut=ai(29,yt,null,Y.mode);return Ut.lanes=ot,Ut.return=Y,Ut}finally{}}}var ks=lp(!0),up=lp(!1),Vn=!1;function wc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dc(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Kn(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function qn(n,o,c){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,(jt&2)!==0){var E=m.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),m.pending=o,o=Oo(n),Km(n,null,c),o}return Io(n,m,o,c),Oo(n)}function xa(n,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var m=o.lanes;m&=n.pendingLanes,c|=m,o.lanes=c,tm(n,c)}}function Ic(n,o){var c=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var E=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var L={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?E=x=L:x=x.next=L,c=c.next}while(c!==null);x===null?E=x=o:x=x.next=o}else E=x=o;c={baseState:m.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:m.shared,callbacks:m.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=o:n.next=o,c.lastBaseUpdate=o}var Oc=!1;function Sa(){if(Oc){var n=yr;if(n!==null)throw n}}function Ta(n,o,c,m){Oc=!1;var E=n.updateQueue;Vn=!1;var x=E.firstBaseUpdate,L=E.lastBaseUpdate,I=E.shared.pending;if(I!==null){E.shared.pending=null;var U=I,J=U.next;U.next=null,L===null?x=J:L.next=J,L=U;var rt=n.alternate;rt!==null&&(rt=rt.updateQueue,I=rt.lastBaseUpdate,I!==L&&(I===null?rt.firstBaseUpdate=J:I.next=J,rt.lastBaseUpdate=U))}if(x!==null){var lt=E.baseState;L=0,rt=J=U=null,I=x;do{var et=I.lane&-536870913,it=et!==I.lane;if(it?(Pt&et)===et:(m&et)===et){et!==0&&et===gr&&(Oc=!0),rt!==null&&(rt=rt.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});t:{var gt=n,St=I;et=o;var Xt=c;switch(St.tag){case 1:if(gt=St.payload,typeof gt=="function"){lt=gt.call(Xt,lt,et);break t}lt=gt;break t;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=St.payload,et=typeof gt=="function"?gt.call(Xt,lt,et):gt,et==null)break t;lt=p({},lt,et);break t;case 2:Vn=!0}}et=I.callback,et!==null&&(n.flags|=64,it&&(n.flags|=8192),it=E.callbacks,it===null?E.callbacks=[et]:it.push(et))}else it={lane:et,tag:I.tag,payload:I.payload,callback:I.callback,next:null},rt===null?(J=rt=it,U=lt):rt=rt.next=it,L|=et;if(I=I.next,I===null){if(I=E.shared.pending,I===null)break;it=I,I=it.next,it.next=null,E.lastBaseUpdate=it,E.shared.pending=null}}while(!0);rt===null&&(U=lt),E.baseState=U,E.firstBaseUpdate=J,E.lastBaseUpdate=rt,x===null&&(E.shared.lanes=0),Zn|=L,n.lanes=L,n.memoizedState=lt}}function cp(n,o){if(typeof n!="function")throw Error(i(191,n));n.call(o)}function fp(n,o){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)cp(c[n],o)}var xr=k(null),Go=k(0);function dp(n,o){n=Ln,st(Go,n),st(xr,o),Ln=n|o.baseLanes}function kc(){st(Go,Ln),st(xr,xr.current)}function Mc(){Ln=Go.current,j(xr),j(Go)}var oi=k(null),_i=null;function Yn(n){var o=n.alternate;st(ge,ge.current&1),st(oi,n),_i===null&&(o===null||xr.current!==null||o.memoizedState!==null)&&(_i=n)}function Pc(n){st(ge,ge.current),st(oi,n),_i===null&&(_i=n)}function hp(n){n.tag===22?(st(ge,ge.current),st(oi,n),_i===null&&(_i=n)):Xn()}function Xn(){st(ge,ge.current),st(oi,oi.current)}function li(n){j(oi),_i===n&&(_i=null),j(ge)}var ge=k(0);function Ho(n){for(var o=n;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Gf(c)||Hf(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vn=0,Ct=null,qt=null,Ee=null,zo=!1,Sr=!1,Ms=!1,Vo=0,ba=0,Tr=null,LT=0;function ce(){throw Error(i(321))}function Nc(n,o){if(o===null)return!1;for(var c=0;c<o.length&&c<n.length;c++)if(!ri(n[c],o[c]))return!1;return!0}function Fc(n,o,c,m,E,x){return vn=x,Ct=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,O.H=n===null||n.memoizedState===null?Wp:Zc,Ms=!1,x=c(m,E),Ms=!1,Sr&&(x=pp(o,c,m,E)),mp(n),x}function mp(n){O.H=La;var o=qt!==null&&qt.next!==null;if(vn=0,Ee=qt=Ct=null,zo=!1,ba=0,Tr=null,o)throw Error(i(300));n===null||xe||(n=n.dependencies,n!==null&&Po(n)&&(xe=!0))}function pp(n,o,c,m){Ct=n;var E=0;do{if(Sr&&(Tr=null),ba=0,Sr=!1,25<=E)throw Error(i(301));if(E+=1,Ee=qt=null,n.updateQueue!=null){var x=n.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}O.H=Qp,x=o(c,m)}while(Sr);return x}function _T(){var n=O.H,o=n.useState()[0];return o=typeof o.then=="function"?Aa(o):o,n=n.useState()[0],(qt!==null?qt.memoizedState:null)!==n&&(Ct.flags|=1024),o}function Bc(){var n=Vo!==0;return Vo=0,n}function Uc(n,o,c){o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~c}function $c(n){if(zo){for(n=n.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}zo=!1}vn=0,Ee=qt=Ct=null,Sr=!1,ba=Vo=0,Tr=null}function Ke(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ee===null?Ct.memoizedState=Ee=n:Ee=Ee.next=n,Ee}function ye(){if(qt===null){var n=Ct.alternate;n=n!==null?n.memoizedState:null}else n=qt.next;var o=Ee===null?Ct.memoizedState:Ee.next;if(o!==null)Ee=o,qt=n;else{if(n===null)throw Ct.alternate===null?Error(i(467)):Error(i(310));qt=n,n={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Ee===null?Ct.memoizedState=Ee=n:Ee=Ee.next=n}return Ee}function Ko(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Aa(n){var o=ba;return ba+=1,Tr===null&&(Tr=[]),n=rp(Tr,n,o),o=Ct,(Ee===null?o.memoizedState:Ee.next)===null&&(o=o.alternate,O.H=o===null||o.memoizedState===null?Wp:Zc),n}function qo(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Aa(n);if(n.$$typeof===R)return Ne(n)}throw Error(i(438,String(n)))}function jc(n){var o=null,c=Ct.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var m=Ct.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(o={data:m.data.map(function(E){return E.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Ko(),Ct.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(n),m=0;m<n;m++)c[m]=M;return o.index++,c}function En(n,o){return typeof o=="function"?o(n):o}function Yo(n){var o=ye();return Gc(o,qt,n)}function Gc(n,o,c){var m=n.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=c;var E=n.baseQueue,x=m.pending;if(x!==null){if(E!==null){var L=E.next;E.next=x.next,x.next=L}o.baseQueue=E=x,m.pending=null}if(x=n.baseState,E===null)n.memoizedState=x;else{o=E.next;var I=L=null,U=null,J=o,rt=!1;do{var lt=J.lane&-536870913;if(lt!==J.lane?(Pt&lt)===lt:(vn&lt)===lt){var et=J.revertLane;if(et===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),lt===gr&&(rt=!0);else if((vn&et)===et){J=J.next,et===gr&&(rt=!0);continue}else lt={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=lt,L=x):U=U.next=lt,Ct.lanes|=et,Zn|=et;lt=J.action,Ms&&c(x,lt),x=J.hasEagerState?J.eagerState:c(x,lt)}else et={lane:lt,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=et,L=x):U=U.next=et,Ct.lanes|=lt,Zn|=lt;J=J.next}while(J!==null&&J!==o);if(U===null?L=x:U.next=I,!ri(x,n.memoizedState)&&(xe=!0,rt&&(c=yr,c!==null)))throw c;n.memoizedState=x,n.baseState=L,n.baseQueue=U,m.lastRenderedState=x}return E===null&&(m.lanes=0),[n.memoizedState,m.dispatch]}function Hc(n){var o=ye(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=n;var m=c.dispatch,E=c.pending,x=o.memoizedState;if(E!==null){c.pending=null;var L=E=E.next;do x=n(x,L.action),L=L.next;while(L!==E);ri(x,o.memoizedState)||(xe=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,m]}function gp(n,o,c){var m=Ct,E=ye(),x=Ft;if(x){if(c===void 0)throw Error(i(407));c=c()}else c=o();var L=!ri((qt||E).memoizedState,c);if(L&&(E.memoizedState=c,xe=!0),E=E.queue,Kc(Ep.bind(null,m,E,n),[n]),E.getSnapshot!==o||L||Ee!==null&&Ee.memoizedState.tag&1){if(m.flags|=2048,br(9,{destroy:void 0},vp.bind(null,m,E,c,o),null),Qt===null)throw Error(i(349));x||(vn&127)!==0||yp(m,o,c)}return c}function yp(n,o,c){n.flags|=16384,n={getSnapshot:o,value:c},o=Ct.updateQueue,o===null?(o=Ko(),Ct.updateQueue=o,o.stores=[n]):(c=o.stores,c===null?o.stores=[n]:c.push(n))}function vp(n,o,c,m){o.value=c,o.getSnapshot=m,xp(o)&&Sp(n)}function Ep(n,o,c){return c(function(){xp(o)&&Sp(n)})}function xp(n){var o=n.getSnapshot;n=n.value;try{var c=o();return!ri(n,c)}catch{return!0}}function Sp(n){var o=Rs(n,2);o!==null&&ii(o,n,2)}function zc(n){var o=Ke();if(typeof n=="function"){var c=n;if(n=c(),Ms){ji(!0);try{c()}finally{ji(!1)}}}return o.memoizedState=o.baseState=n,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:En,lastRenderedState:n},o}function Tp(n,o,c,m){return n.baseState=c,Gc(n,qt,typeof m=="function"?m:En)}function CT(n,o,c,m,E){if(Qo(n))throw Error(i(485));if(n=o.action,n!==null){var x={payload:E,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){x.listeners.push(L)}};O.T!==null?c(!0):x.isTransition=!1,m(x),c=o.pending,c===null?(x.next=o.pending=x,bp(o,x)):(x.next=c.next,o.pending=c.next=x)}}function bp(n,o){var c=o.action,m=o.payload,E=n.state;if(o.isTransition){var x=O.T,L={};O.T=L;try{var I=c(E,m),U=O.S;U!==null&&U(L,I),Ap(n,o,I)}catch(J){Vc(n,o,J)}finally{x!==null&&L.types!==null&&(x.types=L.types),O.T=x}}else try{x=c(E,m),Ap(n,o,x)}catch(J){Vc(n,o,J)}}function Ap(n,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Rp(n,o,m)},function(m){return Vc(n,o,m)}):Rp(n,o,c)}function Rp(n,o,c){o.status="fulfilled",o.value=c,Lp(o),n.state=c,o=n.pending,o!==null&&(c=o.next,c===o?n.pending=null:(c=c.next,o.next=c,bp(n,c)))}function Vc(n,o,c){var m=n.pending;if(n.pending=null,m!==null){m=m.next;do o.status="rejected",o.reason=c,Lp(o),o=o.next;while(o!==m)}n.action=null}function Lp(n){n=n.listeners;for(var o=0;o<n.length;o++)(0,n[o])()}function _p(n,o){return o}function Cp(n,o){if(Ft){var c=Qt.formState;if(c!==null){t:{var m=Ct;if(Ft){if(te){e:{for(var E=te,x=Li;E.nodeType!==8;){if(!x){E=null;break e}if(E=Ci(E.nextSibling),E===null){E=null;break e}}x=E.data,E=x==="F!"||x==="F"?E:null}if(E){te=Ci(E.nextSibling),m=E.data==="F!";break t}}Hn(m)}m=!1}m&&(o=c[0])}}return c=Ke(),c.memoizedState=c.baseState=o,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_p,lastRenderedState:o},c.queue=m,c=qp.bind(null,Ct,m),m.dispatch=c,m=zc(!1),x=Qc.bind(null,Ct,!1,m.queue),m=Ke(),E={state:o,dispatch:null,action:n,pending:null},m.queue=E,c=CT.bind(null,Ct,E,x,c),E.dispatch=c,m.memoizedState=n,[o,c,!1]}function wp(n){var o=ye();return Dp(o,qt,n)}function Dp(n,o,c){if(o=Gc(n,o,_p)[0],n=Yo(En)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var m=Aa(o)}catch(L){throw L===vr?Bo:L}else m=o;o=ye();var E=o.queue,x=E.dispatch;return c!==o.memoizedState&&(Ct.flags|=2048,br(9,{destroy:void 0},wT.bind(null,E,c),null)),[m,x,n]}function wT(n,o){n.action=o}function Ip(n){var o=ye(),c=qt;if(c!==null)return Dp(o,c,n);ye(),o=o.memoizedState,c=ye();var m=c.queue.dispatch;return c.memoizedState=n,[o,m,!1]}function br(n,o,c,m){return n={tag:n,create:c,deps:m,inst:o,next:null},o=Ct.updateQueue,o===null&&(o=Ko(),Ct.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=n.next=n:(m=c.next,c.next=n,n.next=m,o.lastEffect=n),n}function Op(){return ye().memoizedState}function Xo(n,o,c,m){var E=Ke();Ct.flags|=n,E.memoizedState=br(1|o,{destroy:void 0},c,m===void 0?null:m)}function Wo(n,o,c,m){var E=ye();m=m===void 0?null:m;var x=E.memoizedState.inst;qt!==null&&m!==null&&Nc(m,qt.memoizedState.deps)?E.memoizedState=br(o,x,c,m):(Ct.flags|=n,E.memoizedState=br(1|o,x,c,m))}function kp(n,o){Xo(8390656,8,n,o)}function Kc(n,o){Wo(2048,8,n,o)}function DT(n){Ct.flags|=4;var o=Ct.updateQueue;if(o===null)o=Ko(),Ct.updateQueue=o,o.events=[n];else{var c=o.events;c===null?o.events=[n]:c.push(n)}}function Mp(n){var o=ye().memoizedState;return DT({ref:o,nextImpl:n}),function(){if((jt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function Pp(n,o){return Wo(4,2,n,o)}function Np(n,o){return Wo(4,4,n,o)}function Fp(n,o){if(typeof o=="function"){n=n();var c=o(n);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function Bp(n,o,c){c=c!=null?c.concat([n]):null,Wo(4,4,Fp.bind(null,o,n),c)}function qc(){}function Up(n,o){var c=ye();o=o===void 0?null:o;var m=c.memoizedState;return o!==null&&Nc(o,m[1])?m[0]:(c.memoizedState=[n,o],n)}function $p(n,o){var c=ye();o=o===void 0?null:o;var m=c.memoizedState;if(o!==null&&Nc(o,m[1]))return m[0];if(m=n(),Ms){ji(!0);try{n()}finally{ji(!1)}}return c.memoizedState=[m,o],m}function Yc(n,o,c){return c===void 0||(vn&1073741824)!==0&&(Pt&261930)===0?n.memoizedState=o:(n.memoizedState=c,n=jg(),Ct.lanes|=n,Zn|=n,c)}function jp(n,o,c,m){return ri(c,o)?c:xr.current!==null?(n=Yc(n,c,m),ri(n,o)||(xe=!0),n):(vn&42)===0||(vn&1073741824)!==0&&(Pt&261930)===0?(xe=!0,n.memoizedState=c):(n=jg(),Ct.lanes|=n,Zn|=n,o)}function Gp(n,o,c,m,E){var x=G.p;G.p=x!==0&&8>x?x:8;var L=O.T,I={};O.T=I,Qc(n,!1,o,c);try{var U=E(),J=O.S;if(J!==null&&J(I,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var rt=RT(U,m);Ra(n,o,rt,fi(n))}else Ra(n,o,m,fi(n))}catch(lt){Ra(n,o,{then:function(){},status:"rejected",reason:lt},fi())}finally{G.p=x,L!==null&&I.types!==null&&(L.types=I.types),O.T=L}}function IT(){}function Xc(n,o,c,m){if(n.tag!==5)throw Error(i(476));var E=Hp(n).queue;Gp(n,E,o,K,c===null?IT:function(){return zp(n),c(m)})}function Hp(n){var o=n.memoizedState;if(o!==null)return o;o={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:En,lastRenderedState:K},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:En,lastRenderedState:c},next:null},n.memoizedState=o,n=n.alternate,n!==null&&(n.memoizedState=o),o}function zp(n){var o=Hp(n);o.next===null&&(o=n.alternate.memoizedState),Ra(n,o.next.queue,{},fi())}function Wc(){return Ne(Ga)}function Vp(){return ye().memoizedState}function Kp(){return ye().memoizedState}function OT(n){for(var o=n.return;o!==null;){switch(o.tag){case 24:case 3:var c=fi();n=Kn(c);var m=qn(o,n,c);m!==null&&(ii(m,o,c),xa(m,o,c)),o={cache:Rc()},n.payload=o;return}o=o.return}}function kT(n,o,c){var m=fi();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Qo(n)?Yp(o,c):(c=mc(n,o,c,m),c!==null&&(ii(c,n,m),Xp(c,o,m)))}function qp(n,o,c){var m=fi();Ra(n,o,c,m)}function Ra(n,o,c,m){var E={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Qo(n))Yp(o,E);else{var x=n.alternate;if(n.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var L=o.lastRenderedState,I=x(L,c);if(E.hasEagerState=!0,E.eagerState=I,ri(I,L))return Io(n,o,E,0),Qt===null&&Do(),!1}catch{}finally{}if(c=mc(n,o,E,m),c!==null)return ii(c,n,m),Xp(c,o,m),!0}return!1}function Qc(n,o,c,m){if(m={lane:2,revertLane:Df(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Qo(n)){if(o)throw Error(i(479))}else o=mc(n,c,m,2),o!==null&&ii(o,n,2)}function Qo(n){var o=n.alternate;return n===Ct||o!==null&&o===Ct}function Yp(n,o){Sr=zo=!0;var c=n.pending;c===null?o.next=o:(o.next=c.next,c.next=o),n.pending=o}function Xp(n,o,c){if((c&4194048)!==0){var m=o.lanes;m&=n.pendingLanes,c|=m,o.lanes=c,tm(n,c)}}var La={readContext:Ne,use:qo,useCallback:ce,useContext:ce,useEffect:ce,useImperativeHandle:ce,useLayoutEffect:ce,useInsertionEffect:ce,useMemo:ce,useReducer:ce,useRef:ce,useState:ce,useDebugValue:ce,useDeferredValue:ce,useTransition:ce,useSyncExternalStore:ce,useId:ce,useHostTransitionStatus:ce,useFormState:ce,useActionState:ce,useOptimistic:ce,useMemoCache:ce,useCacheRefresh:ce};La.useEffectEvent=ce;var Wp={readContext:Ne,use:qo,useCallback:function(n,o){return Ke().memoizedState=[n,o===void 0?null:o],n},useContext:Ne,useEffect:kp,useImperativeHandle:function(n,o,c){c=c!=null?c.concat([n]):null,Xo(4194308,4,Fp.bind(null,o,n),c)},useLayoutEffect:function(n,o){return Xo(4194308,4,n,o)},useInsertionEffect:function(n,o){Xo(4,2,n,o)},useMemo:function(n,o){var c=Ke();o=o===void 0?null:o;var m=n();if(Ms){ji(!0);try{n()}finally{ji(!1)}}return c.memoizedState=[m,o],m},useReducer:function(n,o,c){var m=Ke();if(c!==void 0){var E=c(o);if(Ms){ji(!0);try{c(o)}finally{ji(!1)}}}else E=o;return m.memoizedState=m.baseState=E,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:E},m.queue=n,n=n.dispatch=kT.bind(null,Ct,n),[m.memoizedState,n]},useRef:function(n){var o=Ke();return n={current:n},o.memoizedState=n},useState:function(n){n=zc(n);var o=n.queue,c=qp.bind(null,Ct,o);return o.dispatch=c,[n.memoizedState,c]},useDebugValue:qc,useDeferredValue:function(n,o){var c=Ke();return Yc(c,n,o)},useTransition:function(){var n=zc(!1);return n=Gp.bind(null,Ct,n.queue,!0,!1),Ke().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,o,c){var m=Ct,E=Ke();if(Ft){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),Qt===null)throw Error(i(349));(Pt&127)!==0||yp(m,o,c)}E.memoizedState=c;var x={value:c,getSnapshot:o};return E.queue=x,kp(Ep.bind(null,m,x,n),[n]),m.flags|=2048,br(9,{destroy:void 0},vp.bind(null,m,x,c,o),null),c},useId:function(){var n=Ke(),o=Qt.identifierPrefix;if(Ft){var c=Hi,m=Gi;c=(m&~(1<<32-Ve(m)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Vo++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=LT++,o="_"+o+"r_"+c.toString(32)+"_";return n.memoizedState=o},useHostTransitionStatus:Wc,useFormState:Cp,useActionState:Cp,useOptimistic:function(n){var o=Ke();o.memoizedState=o.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Qc.bind(null,Ct,!0,c),c.dispatch=o,[n,o]},useMemoCache:jc,useCacheRefresh:function(){return Ke().memoizedState=OT.bind(null,Ct)},useEffectEvent:function(n){var o=Ke(),c={impl:n};return o.memoizedState=c,function(){if((jt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Zc={readContext:Ne,use:qo,useCallback:Up,useContext:Ne,useEffect:Kc,useImperativeHandle:Bp,useInsertionEffect:Pp,useLayoutEffect:Np,useMemo:$p,useReducer:Yo,useRef:Op,useState:function(){return Yo(En)},useDebugValue:qc,useDeferredValue:function(n,o){var c=ye();return jp(c,qt.memoizedState,n,o)},useTransition:function(){var n=Yo(En)[0],o=ye().memoizedState;return[typeof n=="boolean"?n:Aa(n),o]},useSyncExternalStore:gp,useId:Vp,useHostTransitionStatus:Wc,useFormState:wp,useActionState:wp,useOptimistic:function(n,o){var c=ye();return Tp(c,qt,n,o)},useMemoCache:jc,useCacheRefresh:Kp};Zc.useEffectEvent=Mp;var Qp={readContext:Ne,use:qo,useCallback:Up,useContext:Ne,useEffect:Kc,useImperativeHandle:Bp,useInsertionEffect:Pp,useLayoutEffect:Np,useMemo:$p,useReducer:Hc,useRef:Op,useState:function(){return Hc(En)},useDebugValue:qc,useDeferredValue:function(n,o){var c=ye();return qt===null?Yc(c,n,o):jp(c,qt.memoizedState,n,o)},useTransition:function(){var n=Hc(En)[0],o=ye().memoizedState;return[typeof n=="boolean"?n:Aa(n),o]},useSyncExternalStore:gp,useId:Vp,useHostTransitionStatus:Wc,useFormState:Ip,useActionState:Ip,useOptimistic:function(n,o){var c=ye();return qt!==null?Tp(c,qt,n,o):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:jc,useCacheRefresh:Kp};Qp.useEffectEvent=Mp;function Jc(n,o,c,m){o=n.memoizedState,c=c(m,o),c=c==null?o:p({},o,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var tf={enqueueSetState:function(n,o,c){n=n._reactInternals;var m=fi(),E=Kn(m);E.payload=o,c!=null&&(E.callback=c),o=qn(n,E,m),o!==null&&(ii(o,n,m),xa(o,n,m))},enqueueReplaceState:function(n,o,c){n=n._reactInternals;var m=fi(),E=Kn(m);E.tag=1,E.payload=o,c!=null&&(E.callback=c),o=qn(n,E,m),o!==null&&(ii(o,n,m),xa(o,n,m))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var c=fi(),m=Kn(c);m.tag=2,o!=null&&(m.callback=o),o=qn(n,m,c),o!==null&&(ii(o,n,c),xa(o,n,c))}};function Zp(n,o,c,m,E,x,L){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,x,L):o.prototype&&o.prototype.isPureReactComponent?!da(c,m)||!da(E,x):!0}function Jp(n,o,c,m){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==n&&tf.enqueueReplaceState(o,o.state,null)}function Ps(n,o){var c=o;if("ref"in o){c={};for(var m in o)m!=="ref"&&(c[m]=o[m])}if(n=n.defaultProps){c===o&&(c=p({},c));for(var E in n)c[E]===void 0&&(c[E]=n[E])}return c}function tg(n){wo(n)}function eg(n){console.error(n)}function ig(n){wo(n)}function Zo(n,o){try{var c=n.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(m){setTimeout(function(){throw m})}}function ng(n,o,c){try{var m=n.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function ef(n,o,c){return c=Kn(c),c.tag=3,c.payload={element:null},c.callback=function(){Zo(n,o)},c}function sg(n){return n=Kn(n),n.tag=3,n}function rg(n,o,c,m){var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var x=m.value;n.payload=function(){return E(x)},n.callback=function(){ng(o,c,m)}}var L=c.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(n.callback=function(){ng(o,c,m),typeof E!="function"&&(Jn===null?Jn=new Set([this]):Jn.add(this));var I=m.stack;this.componentDidCatch(m.value,{componentStack:I!==null?I:""})})}function MT(n,o,c,m,E){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(o=c.alternate,o!==null&&pr(o,c,E,!0),c=oi.current,c!==null){switch(c.tag){case 31:case 13:return _i===null?cl():c.alternate===null&&fe===0&&(fe=3),c.flags&=-257,c.flags|=65536,c.lanes=E,m===Uo?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([m]):o.add(m),_f(n,m,E)),!1;case 22:return c.flags|=65536,m===Uo?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([m]):c.add(m)),_f(n,m,E)),!1}throw Error(i(435,c.tag))}return _f(n,m,E),cl(),!1}if(Ft)return o=oi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=E,m!==xc&&(n=Error(i(422),{cause:m}),pa(bi(n,c)))):(m!==xc&&(o=Error(i(423),{cause:m}),pa(bi(o,c))),n=n.current.alternate,n.flags|=65536,E&=-E,n.lanes|=E,m=bi(m,c),E=ef(n.stateNode,m,E),Ic(n,E),fe!==4&&(fe=2)),!1;var x=Error(i(520),{cause:m});if(x=bi(x,c),Ma===null?Ma=[x]:Ma.push(x),fe!==4&&(fe=2),o===null)return!0;m=bi(m,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,n=E&-E,c.lanes|=n,n=ef(c.stateNode,m,n),Ic(c,n),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Jn===null||!Jn.has(x))))return c.flags|=65536,E&=-E,c.lanes|=E,E=sg(E),rg(E,n,c,m),Ic(c,E),!1}c=c.return}while(c!==null);return!1}var nf=Error(i(461)),xe=!1;function Fe(n,o,c,m){o.child=n===null?up(o,null,c,m):ks(o,n.child,c,m)}function ag(n,o,c,m,E){c=c.render;var x=o.ref;if("ref"in m){var L={};for(var I in m)I!=="ref"&&(L[I]=m[I])}else L=m;return ws(o),m=Fc(n,o,c,L,x,E),I=Bc(),n!==null&&!xe?(Uc(n,o,E),xn(n,o,E)):(Ft&&I&&vc(o),o.flags|=1,Fe(n,o,m,E),o.child)}function og(n,o,c,m,E){if(n===null){var x=c.type;return typeof x=="function"&&!pc(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,lg(n,o,x,m,E)):(n=ko(c.type,null,m,o,o.mode,E),n.ref=o.ref,n.return=o,o.child=n)}if(x=n.child,!ff(n,E)){var L=x.memoizedProps;if(c=c.compare,c=c!==null?c:da,c(L,m)&&n.ref===o.ref)return xn(n,o,E)}return o.flags|=1,n=mn(x,m),n.ref=o.ref,n.return=o,o.child=n}function lg(n,o,c,m,E){if(n!==null){var x=n.memoizedProps;if(da(x,m)&&n.ref===o.ref)if(xe=!1,o.pendingProps=m=x,ff(n,E))(n.flags&131072)!==0&&(xe=!0);else return o.lanes=n.lanes,xn(n,o,E)}return sf(n,o,c,m,E)}function ug(n,o,c,m){var E=m.children,x=n!==null?n.memoizedState:null;if(n===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,n!==null){for(m=o.child=n.child,E=0;m!==null;)E=E|m.lanes|m.childLanes,m=m.sibling;m=E&~x}else m=0,o.child=null;return cg(n,o,x,c,m)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},n!==null&&Fo(o,x!==null?x.cachePool:null),x!==null?dp(o,x):kc(),hp(o);else return m=o.lanes=536870912,cg(n,o,x!==null?x.baseLanes|c:c,c,m)}else x!==null?(Fo(o,x.cachePool),dp(o,x),Xn(),o.memoizedState=null):(n!==null&&Fo(o,null),kc(),Xn());return Fe(n,o,E,c),o.child}function _a(n,o){return n!==null&&n.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function cg(n,o,c,m,E){var x=_c();return x=x===null?null:{parent:ve._currentValue,pool:x},o.memoizedState={baseLanes:c,cachePool:x},n!==null&&Fo(o,null),kc(),hp(o),n!==null&&pr(n,o,m,!0),o.childLanes=E,null}function Jo(n,o){return o=el({mode:o.mode,children:o.children},n.mode),o.ref=n.ref,n.child=o,o.return=n,o}function fg(n,o,c){return ks(o,n.child,null,c),n=Jo(o,o.pendingProps),n.flags|=2,li(o),o.memoizedState=null,n}function PT(n,o,c){var m=o.pendingProps,E=(o.flags&128)!==0;if(o.flags&=-129,n===null){if(Ft){if(m.mode==="hidden")return n=Jo(o,m),o.lanes=536870912,_a(null,n);if(Pc(o),(n=te)?(n=b0(n,Li),n=n!==null&&n.data==="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:jn!==null?{id:Gi,overflow:Hi}:null,retryLane:536870912,hydrationErrors:null},c=Ym(n),c.return=o,o.child=c,Pe=o,te=null)):n=null,n===null)throw Hn(o);return o.lanes=536870912,null}return Jo(o,m)}var x=n.memoizedState;if(x!==null){var L=x.dehydrated;if(Pc(o),E)if(o.flags&256)o.flags&=-257,o=fg(n,o,c);else if(o.memoizedState!==null)o.child=n.child,o.flags|=128,o=null;else throw Error(i(558));else if(xe||pr(n,o,c,!1),E=(c&n.childLanes)!==0,xe||E){if(m=Qt,m!==null&&(L=em(m,c),L!==0&&L!==x.retryLane))throw x.retryLane=L,Rs(n,L),ii(m,n,L),nf;cl(),o=fg(n,o,c)}else n=x.treeContext,te=Ci(L.nextSibling),Pe=o,Ft=!0,Gn=null,Li=!1,n!==null&&Qm(o,n),o=Jo(o,m),o.flags|=4096;return o}return n=mn(n.child,{mode:m.mode,children:m.children}),n.ref=o.ref,o.child=n,n.return=o,n}function tl(n,o){var c=o.ref;if(c===null)n!==null&&n.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(n===null||n.ref!==c)&&(o.flags|=4194816)}}function sf(n,o,c,m,E){return ws(o),c=Fc(n,o,c,m,void 0,E),m=Bc(),n!==null&&!xe?(Uc(n,o,E),xn(n,o,E)):(Ft&&m&&vc(o),o.flags|=1,Fe(n,o,c,E),o.child)}function dg(n,o,c,m,E,x){return ws(o),o.updateQueue=null,c=pp(o,m,c,E),mp(n),m=Bc(),n!==null&&!xe?(Uc(n,o,x),xn(n,o,x)):(Ft&&m&&vc(o),o.flags|=1,Fe(n,o,c,x),o.child)}function hg(n,o,c,m,E){if(ws(o),o.stateNode===null){var x=fr,L=c.contextType;typeof L=="object"&&L!==null&&(x=Ne(L)),x=new c(m,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=tf,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=m,x.state=o.memoizedState,x.refs={},wc(o),L=c.contextType,x.context=typeof L=="object"&&L!==null?Ne(L):fr,x.state=o.memoizedState,L=c.getDerivedStateFromProps,typeof L=="function"&&(Jc(o,c,L,m),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(L=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),L!==x.state&&tf.enqueueReplaceState(x,x.state,null),Ta(o,m,x,E),Sa(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),m=!0}else if(n===null){x=o.stateNode;var I=o.memoizedProps,U=Ps(c,I);x.props=U;var J=x.context,rt=c.contextType;L=fr,typeof rt=="object"&&rt!==null&&(L=Ne(rt));var lt=c.getDerivedStateFromProps;rt=typeof lt=="function"||typeof x.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,rt||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(I||J!==L)&&Jp(o,x,m,L),Vn=!1;var et=o.memoizedState;x.state=et,Ta(o,m,x,E),Sa(),J=o.memoizedState,I||et!==J||Vn?(typeof lt=="function"&&(Jc(o,c,lt,m),J=o.memoizedState),(U=Vn||Zp(o,c,U,m,et,J,L))?(rt||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=J),x.props=m,x.state=J,x.context=L,m=U):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{x=o.stateNode,Dc(n,o),L=o.memoizedProps,rt=Ps(c,L),x.props=rt,lt=o.pendingProps,et=x.context,J=c.contextType,U=fr,typeof J=="object"&&J!==null&&(U=Ne(J)),I=c.getDerivedStateFromProps,(J=typeof I=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(L!==lt||et!==U)&&Jp(o,x,m,U),Vn=!1,et=o.memoizedState,x.state=et,Ta(o,m,x,E),Sa();var it=o.memoizedState;L!==lt||et!==it||Vn||n!==null&&n.dependencies!==null&&Po(n.dependencies)?(typeof I=="function"&&(Jc(o,c,I,m),it=o.memoizedState),(rt=Vn||Zp(o,c,rt,m,et,it,U)||n!==null&&n.dependencies!==null&&Po(n.dependencies))?(J||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(m,it,U),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(m,it,U)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=it),x.props=m,x.state=it,x.context=U,m=rt):(typeof x.componentDidUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=1024),m=!1)}return x=m,tl(n,o),m=(o.flags&128)!==0,x||m?(x=o.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,n!==null&&m?(o.child=ks(o,n.child,null,E),o.child=ks(o,null,c,E)):Fe(n,o,c,E),o.memoizedState=x.state,n=o.child):n=xn(n,o,E),n}function mg(n,o,c,m){return _s(),o.flags|=256,Fe(n,o,c,m),o.child}var rf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function af(n){return{baseLanes:n,cachePool:np()}}function of(n,o,c){return n=n!==null?n.childLanes&~c:0,o&&(n|=ci),n}function pg(n,o,c){var m=o.pendingProps,E=!1,x=(o.flags&128)!==0,L;if((L=x)||(L=n!==null&&n.memoizedState===null?!1:(ge.current&2)!==0),L&&(E=!0,o.flags&=-129),L=(o.flags&32)!==0,o.flags&=-33,n===null){if(Ft){if(E?Yn(o):Xn(),(n=te)?(n=b0(n,Li),n=n!==null&&n.data!=="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:jn!==null?{id:Gi,overflow:Hi}:null,retryLane:536870912,hydrationErrors:null},c=Ym(n),c.return=o,o.child=c,Pe=o,te=null)):n=null,n===null)throw Hn(o);return Hf(n)?o.lanes=32:o.lanes=536870912,null}var I=m.children;return m=m.fallback,E?(Xn(),E=o.mode,I=el({mode:"hidden",children:I},E),m=Ls(m,E,c,null),I.return=o,m.return=o,I.sibling=m,o.child=I,m=o.child,m.memoizedState=af(c),m.childLanes=of(n,L,c),o.memoizedState=rf,_a(null,m)):(Yn(o),lf(o,I))}var U=n.memoizedState;if(U!==null&&(I=U.dehydrated,I!==null)){if(x)o.flags&256?(Yn(o),o.flags&=-257,o=uf(n,o,c)):o.memoizedState!==null?(Xn(),o.child=n.child,o.flags|=128,o=null):(Xn(),I=m.fallback,E=o.mode,m=el({mode:"visible",children:m.children},E),I=Ls(I,E,c,null),I.flags|=2,m.return=o,I.return=o,m.sibling=I,o.child=m,ks(o,n.child,null,c),m=o.child,m.memoizedState=af(c),m.childLanes=of(n,L,c),o.memoizedState=rf,o=_a(null,m));else if(Yn(o),Hf(I)){if(L=I.nextSibling&&I.nextSibling.dataset,L)var J=L.dgst;L=J,m=Error(i(419)),m.stack="",m.digest=L,pa({value:m,source:null,stack:null}),o=uf(n,o,c)}else if(xe||pr(n,o,c,!1),L=(c&n.childLanes)!==0,xe||L){if(L=Qt,L!==null&&(m=em(L,c),m!==0&&m!==U.retryLane))throw U.retryLane=m,Rs(n,m),ii(L,n,m),nf;Gf(I)||cl(),o=uf(n,o,c)}else Gf(I)?(o.flags|=192,o.child=n.child,o=null):(n=U.treeContext,te=Ci(I.nextSibling),Pe=o,Ft=!0,Gn=null,Li=!1,n!==null&&Qm(o,n),o=lf(o,m.children),o.flags|=4096);return o}return E?(Xn(),I=m.fallback,E=o.mode,U=n.child,J=U.sibling,m=mn(U,{mode:"hidden",children:m.children}),m.subtreeFlags=U.subtreeFlags&65011712,J!==null?I=mn(J,I):(I=Ls(I,E,c,null),I.flags|=2),I.return=o,m.return=o,m.sibling=I,o.child=m,_a(null,m),m=o.child,I=n.child.memoizedState,I===null?I=af(c):(E=I.cachePool,E!==null?(U=ve._currentValue,E=E.parent!==U?{parent:U,pool:U}:E):E=np(),I={baseLanes:I.baseLanes|c,cachePool:E}),m.memoizedState=I,m.childLanes=of(n,L,c),o.memoizedState=rf,_a(n.child,m)):(Yn(o),c=n.child,n=c.sibling,c=mn(c,{mode:"visible",children:m.children}),c.return=o,c.sibling=null,n!==null&&(L=o.deletions,L===null?(o.deletions=[n],o.flags|=16):L.push(n)),o.child=c,o.memoizedState=null,c)}function lf(n,o){return o=el({mode:"visible",children:o},n.mode),o.return=n,n.child=o}function el(n,o){return n=ai(22,n,null,o),n.lanes=0,n}function uf(n,o,c){return ks(o,n.child,null,c),n=lf(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function gg(n,o,c){n.lanes|=o;var m=n.alternate;m!==null&&(m.lanes|=o),bc(n.return,o,c)}function cf(n,o,c,m,E,x){var L=n.memoizedState;L===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:E,treeForkCount:x}:(L.isBackwards=o,L.rendering=null,L.renderingStartTime=0,L.last=m,L.tail=c,L.tailMode=E,L.treeForkCount=x)}function yg(n,o,c){var m=o.pendingProps,E=m.revealOrder,x=m.tail;m=m.children;var L=ge.current,I=(L&2)!==0;if(I?(L=L&1|2,o.flags|=128):L&=1,st(ge,L),Fe(n,o,m,c),m=Ft?ma:0,!I&&n!==null&&(n.flags&128)!==0)t:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gg(n,c,o);else if(n.tag===19)gg(n,c,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break t;for(;n.sibling===null;){if(n.return===null||n.return===o)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(E){case"forwards":for(c=o.child,E=null;c!==null;)n=c.alternate,n!==null&&Ho(n)===null&&(E=c),c=c.sibling;c=E,c===null?(E=o.child,o.child=null):(E=c.sibling,c.sibling=null),cf(o,!1,E,c,x,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,E=o.child,o.child=null;E!==null;){if(n=E.alternate,n!==null&&Ho(n)===null){o.child=E;break}n=E.sibling,E.sibling=c,c=E,E=n}cf(o,!0,c,null,x,m);break;case"together":cf(o,!1,null,null,void 0,m);break;default:o.memoizedState=null}return o.child}function xn(n,o,c){if(n!==null&&(o.dependencies=n.dependencies),Zn|=o.lanes,(c&o.childLanes)===0)if(n!==null){if(pr(n,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(n!==null&&o.child!==n.child)throw Error(i(153));if(o.child!==null){for(n=o.child,c=mn(n,n.pendingProps),o.child=c,c.return=o;n.sibling!==null;)n=n.sibling,c=c.sibling=mn(n,n.pendingProps),c.return=o;c.sibling=null}return o.child}function ff(n,o){return(n.lanes&o)!==0?!0:(n=n.dependencies,!!(n!==null&&Po(n)))}function NT(n,o,c){switch(o.tag){case 3:Lt(o,o.stateNode.containerInfo),zn(o,ve,n.memoizedState.cache),_s();break;case 27:case 5:ie(o);break;case 4:Lt(o,o.stateNode.containerInfo);break;case 10:zn(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Pc(o),null;break;case 13:var m=o.memoizedState;if(m!==null)return m.dehydrated!==null?(Yn(o),o.flags|=128,null):(c&o.child.childLanes)!==0?pg(n,o,c):(Yn(o),n=xn(n,o,c),n!==null?n.sibling:null);Yn(o);break;case 19:var E=(n.flags&128)!==0;if(m=(c&o.childLanes)!==0,m||(pr(n,o,c,!1),m=(c&o.childLanes)!==0),E){if(m)return yg(n,o,c);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),st(ge,ge.current),m)break;return null;case 22:return o.lanes=0,ug(n,o,c,o.pendingProps);case 24:zn(o,ve,n.memoizedState.cache)}return xn(n,o,c)}function vg(n,o,c){if(n!==null)if(n.memoizedProps!==o.pendingProps)xe=!0;else{if(!ff(n,c)&&(o.flags&128)===0)return xe=!1,NT(n,o,c);xe=(n.flags&131072)!==0}else xe=!1,Ft&&(o.flags&1048576)!==0&&Wm(o,ma,o.index);switch(o.lanes=0,o.tag){case 16:t:{var m=o.pendingProps;if(n=Is(o.elementType),o.type=n,typeof n=="function")pc(n)?(m=Ps(n,m),o.tag=1,o=hg(null,o,n,m,c)):(o.tag=0,o=sf(null,o,n,m,c));else{if(n!=null){var E=n.$$typeof;if(E===C){o.tag=11,o=ag(null,o,n,m,c);break t}else if(E===w){o.tag=14,o=og(null,o,n,m,c);break t}}throw o=H(n)||n,Error(i(306,o,""))}}return o;case 0:return sf(n,o,o.type,o.pendingProps,c);case 1:return m=o.type,E=Ps(m,o.pendingProps),hg(n,o,m,E,c);case 3:t:{if(Lt(o,o.stateNode.containerInfo),n===null)throw Error(i(387));m=o.pendingProps;var x=o.memoizedState;E=x.element,Dc(n,o),Ta(o,m,null,c);var L=o.memoizedState;if(m=L.cache,zn(o,ve,m),m!==x.cache&&Ac(o,[ve],c,!0),Sa(),m=L.element,x.isDehydrated)if(x={element:m,isDehydrated:!1,cache:L.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=mg(n,o,m,c);break t}else if(m!==E){E=bi(Error(i(424)),o),pa(E),o=mg(n,o,m,c);break t}else{switch(n=o.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(te=Ci(n.firstChild),Pe=o,Ft=!0,Gn=null,Li=!0,c=up(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(_s(),m===E){o=xn(n,o,c);break t}Fe(n,o,m,c)}o=o.child}return o;case 26:return tl(n,o),n===null?(c=w0(o.type,null,o.pendingProps,null))?o.memoizedState=c:Ft||(c=o.type,n=o.pendingProps,m=yl(dt.current).createElement(c),m[Me]=o,m[We]=n,Be(m,c,n),we(m),o.stateNode=m):o.memoizedState=w0(o.type,n.memoizedProps,o.pendingProps,n.memoizedState),null;case 27:return ie(o),n===null&&Ft&&(m=o.stateNode=L0(o.type,o.pendingProps,dt.current),Pe=o,Li=!0,E=te,ns(o.type)?(zf=E,te=Ci(m.firstChild)):te=E),Fe(n,o,o.pendingProps.children,c),tl(n,o),n===null&&(o.flags|=4194304),o.child;case 5:return n===null&&Ft&&((E=m=te)&&(m=db(m,o.type,o.pendingProps,Li),m!==null?(o.stateNode=m,Pe=o,te=Ci(m.firstChild),Li=!1,E=!0):E=!1),E||Hn(o)),ie(o),E=o.type,x=o.pendingProps,L=n!==null?n.memoizedProps:null,m=x.children,Uf(E,x)?m=null:L!==null&&Uf(E,L)&&(o.flags|=32),o.memoizedState!==null&&(E=Fc(n,o,_T,null,null,c),Ga._currentValue=E),tl(n,o),Fe(n,o,m,c),o.child;case 6:return n===null&&Ft&&((n=c=te)&&(c=hb(c,o.pendingProps,Li),c!==null?(o.stateNode=c,Pe=o,te=null,n=!0):n=!1),n||Hn(o)),null;case 13:return pg(n,o,c);case 4:return Lt(o,o.stateNode.containerInfo),m=o.pendingProps,n===null?o.child=ks(o,null,m,c):Fe(n,o,m,c),o.child;case 11:return ag(n,o,o.type,o.pendingProps,c);case 7:return Fe(n,o,o.pendingProps,c),o.child;case 8:return Fe(n,o,o.pendingProps.children,c),o.child;case 12:return Fe(n,o,o.pendingProps.children,c),o.child;case 10:return m=o.pendingProps,zn(o,o.type,m.value),Fe(n,o,m.children,c),o.child;case 9:return E=o.type._context,m=o.pendingProps.children,ws(o),E=Ne(E),m=m(E),o.flags|=1,Fe(n,o,m,c),o.child;case 14:return og(n,o,o.type,o.pendingProps,c);case 15:return lg(n,o,o.type,o.pendingProps,c);case 19:return yg(n,o,c);case 31:return PT(n,o,c);case 22:return ug(n,o,c,o.pendingProps);case 24:return ws(o),m=Ne(ve),n===null?(E=_c(),E===null&&(E=Qt,x=Rc(),E.pooledCache=x,x.refCount++,x!==null&&(E.pooledCacheLanes|=c),E=x),o.memoizedState={parent:m,cache:E},wc(o),zn(o,ve,E)):((n.lanes&c)!==0&&(Dc(n,o),Ta(o,null,null,c),Sa()),E=n.memoizedState,x=o.memoizedState,E.parent!==m?(E={parent:m,cache:m},o.memoizedState=E,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=E),zn(o,ve,m)):(m=x.cache,zn(o,ve,m),m!==E.cache&&Ac(o,[ve],c,!0))),Fe(n,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Sn(n){n.flags|=4}function df(n,o,c,m,E){if((o=(n.mode&32)!==0)&&(o=!1),o){if(n.flags|=16777216,(E&335544128)===E)if(n.stateNode.complete)n.flags|=8192;else if(Vg())n.flags|=8192;else throw Os=Uo,Cc}else n.flags&=-16777217}function Eg(n,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!M0(o))if(Vg())n.flags|=8192;else throw Os=Uo,Cc}function il(n,o){o!==null&&(n.flags|=4),n.flags&16384&&(o=n.tag!==22?Zh():536870912,n.lanes|=o,_r|=o)}function Ca(n,o){if(!Ft)switch(n.tailMode){case"hidden":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function ee(n){var o=n.alternate!==null&&n.alternate.child===n.child,c=0,m=0;if(o)for(var E=n.child;E!==null;)c|=E.lanes|E.childLanes,m|=E.subtreeFlags&65011712,m|=E.flags&65011712,E.return=n,E=E.sibling;else for(E=n.child;E!==null;)c|=E.lanes|E.childLanes,m|=E.subtreeFlags,m|=E.flags,E.return=n,E=E.sibling;return n.subtreeFlags|=m,n.childLanes=c,o}function FT(n,o,c){var m=o.pendingProps;switch(Ec(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ee(o),null;case 1:return ee(o),null;case 3:return c=o.stateNode,m=null,n!==null&&(m=n.memoizedState.cache),o.memoizedState.cache!==m&&(o.flags|=2048),yn(ve),_t(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(mr(o)?Sn(o):n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Sc())),ee(o),null;case 26:var E=o.type,x=o.memoizedState;return n===null?(Sn(o),x!==null?(ee(o),Eg(o,x)):(ee(o),df(o,E,null,m,c))):x?x!==n.memoizedState?(Sn(o),ee(o),Eg(o,x)):(ee(o),o.flags&=-16777217):(n=n.memoizedProps,n!==m&&Sn(o),ee(o),df(o,E,n,m,c)),null;case 27:if(pe(o),c=dt.current,E=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==m&&Sn(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return ee(o),null}n=ct.current,mr(o)?Zm(o):(n=L0(E,m,c),o.stateNode=n,Sn(o))}return ee(o),null;case 5:if(pe(o),E=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==m&&Sn(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return ee(o),null}if(x=ct.current,mr(o))Zm(o);else{var L=yl(dt.current);switch(x){case 1:x=L.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:x=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":x=L.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":x=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":x=L.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof m.is=="string"?L.createElement("select",{is:m.is}):L.createElement("select"),m.multiple?x.multiple=!0:m.size&&(x.size=m.size);break;default:x=typeof m.is=="string"?L.createElement(E,{is:m.is}):L.createElement(E)}}x[Me]=o,x[We]=m;t:for(L=o.child;L!==null;){if(L.tag===5||L.tag===6)x.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===o)break t;for(;L.sibling===null;){if(L.return===null||L.return===o)break t;L=L.return}L.sibling.return=L.return,L=L.sibling}o.stateNode=x;t:switch(Be(x,E,m),E){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break t;case"img":m=!0;break t;default:m=!1}m&&Sn(o)}}return ee(o),df(o,o.type,n===null?null:n.memoizedProps,o.pendingProps,c),null;case 6:if(n&&o.stateNode!=null)n.memoizedProps!==m&&Sn(o);else{if(typeof m!="string"&&o.stateNode===null)throw Error(i(166));if(n=dt.current,mr(o)){if(n=o.stateNode,c=o.memoizedProps,m=null,E=Pe,E!==null)switch(E.tag){case 27:case 5:m=E.memoizedProps}n[Me]=o,n=!!(n.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||p0(n.nodeValue,c)),n||Hn(o,!0)}else n=yl(n).createTextNode(m),n[Me]=o,o.stateNode=n}return ee(o),null;case 31:if(c=o.memoizedState,n===null||n.memoizedState!==null){if(m=mr(o),c!==null){if(n===null){if(!m)throw Error(i(318));if(n=o.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Me]=o}else _s(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ee(o),n=!1}else c=Sc(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return o.flags&256?(li(o),o):(li(o),null);if((o.flags&128)!==0)throw Error(i(558))}return ee(o),null;case 13:if(m=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(E=mr(o),m!==null&&m.dehydrated!==null){if(n===null){if(!E)throw Error(i(318));if(E=o.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(i(317));E[Me]=o}else _s(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ee(o),E=!1}else E=Sc(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=E),E=!0;if(!E)return o.flags&256?(li(o),o):(li(o),null)}return li(o),(o.flags&128)!==0?(o.lanes=c,o):(c=m!==null,n=n!==null&&n.memoizedState!==null,c&&(m=o.child,E=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(E=m.alternate.memoizedState.cachePool.pool),x=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(x=m.memoizedState.cachePool.pool),x!==E&&(m.flags|=2048)),c!==n&&c&&(o.child.flags|=8192),il(o,o.updateQueue),ee(o),null);case 4:return _t(),n===null&&Mf(o.stateNode.containerInfo),ee(o),null;case 10:return yn(o.type),ee(o),null;case 19:if(j(ge),m=o.memoizedState,m===null)return ee(o),null;if(E=(o.flags&128)!==0,x=m.rendering,x===null)if(E)Ca(m,!1);else{if(fe!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if(x=Ho(n),x!==null){for(o.flags|=128,Ca(m,!1),n=x.updateQueue,o.updateQueue=n,il(o,n),o.subtreeFlags=0,n=c,c=o.child;c!==null;)qm(c,n),c=c.sibling;return st(ge,ge.current&1|2),Ft&&pn(o,m.treeForkCount),o.child}n=n.sibling}m.tail!==null&&ne()>ol&&(o.flags|=128,E=!0,Ca(m,!1),o.lanes=4194304)}else{if(!E)if(n=Ho(x),n!==null){if(o.flags|=128,E=!0,n=n.updateQueue,o.updateQueue=n,il(o,n),Ca(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!Ft)return ee(o),null}else 2*ne()-m.renderingStartTime>ol&&c!==536870912&&(o.flags|=128,E=!0,Ca(m,!1),o.lanes=4194304);m.isBackwards?(x.sibling=o.child,o.child=x):(n=m.last,n!==null?n.sibling=x:o.child=x,m.last=x)}return m.tail!==null?(n=m.tail,m.rendering=n,m.tail=n.sibling,m.renderingStartTime=ne(),n.sibling=null,c=ge.current,st(ge,E?c&1|2:c&1),Ft&&pn(o,m.treeForkCount),n):(ee(o),null);case 22:case 23:return li(o),Mc(),m=o.memoizedState!==null,n!==null?n.memoizedState!==null!==m&&(o.flags|=8192):m&&(o.flags|=8192),m?(c&536870912)!==0&&(o.flags&128)===0&&(ee(o),o.subtreeFlags&6&&(o.flags|=8192)):ee(o),c=o.updateQueue,c!==null&&il(o,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==c&&(o.flags|=2048),n!==null&&j(Ds),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),yn(ve),ee(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function BT(n,o){switch(Ec(o),o.tag){case 1:return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return yn(ve),_t(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 26:case 27:case 5:return pe(o),null;case 31:if(o.memoizedState!==null){if(li(o),o.alternate===null)throw Error(i(340));_s()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 13:if(li(o),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(i(340));_s()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return j(ge),null;case 4:return _t(),null;case 10:return yn(o.type),null;case 22:case 23:return li(o),Mc(),n!==null&&j(Ds),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 24:return yn(ve),null;case 25:return null;default:return null}}function xg(n,o){switch(Ec(o),o.tag){case 3:yn(ve),_t();break;case 26:case 27:case 5:pe(o);break;case 4:_t();break;case 31:o.memoizedState!==null&&li(o);break;case 13:li(o);break;case 19:j(ge);break;case 10:yn(o.type);break;case 22:case 23:li(o),Mc(),n!==null&&j(Ds);break;case 24:yn(ve)}}function wa(n,o){try{var c=o.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var E=m.next;c=E;do{if((c.tag&n)===n){m=void 0;var x=c.create,L=c.inst;m=x(),L.destroy=m}c=c.next}while(c!==E)}}catch(I){Ht(o,o.return,I)}}function Wn(n,o,c){try{var m=o.updateQueue,E=m!==null?m.lastEffect:null;if(E!==null){var x=E.next;m=x;do{if((m.tag&n)===n){var L=m.inst,I=L.destroy;if(I!==void 0){L.destroy=void 0,E=o;var U=c,J=I;try{J()}catch(rt){Ht(E,U,rt)}}}m=m.next}while(m!==x)}}catch(rt){Ht(o,o.return,rt)}}function Sg(n){var o=n.updateQueue;if(o!==null){var c=n.stateNode;try{fp(o,c)}catch(m){Ht(n,n.return,m)}}}function Tg(n,o,c){c.props=Ps(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(m){Ht(n,o,m)}}function Da(n,o){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var m=n.stateNode;break;case 30:m=n.stateNode;break;default:m=n.stateNode}typeof c=="function"?n.refCleanup=c(m):c.current=m}}catch(E){Ht(n,o,E)}}function zi(n,o){var c=n.ref,m=n.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(E){Ht(n,o,E)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(E){Ht(n,o,E)}else c.current=null}function bg(n){var o=n.type,c=n.memoizedProps,m=n.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break t;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(E){Ht(n,n.return,E)}}function hf(n,o,c){try{var m=n.stateNode;ab(m,n.type,c,o),m[We]=o}catch(E){Ht(n,n.return,E)}}function Ag(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ns(n.type)||n.tag===4}function mf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Ag(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ns(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function pf(n,o,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(n),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=dn));else if(m!==4&&(m===27&&ns(n.type)&&(c=n.stateNode,o=null),n=n.child,n!==null))for(pf(n,o,c),n=n.sibling;n!==null;)pf(n,o,c),n=n.sibling}function nl(n,o,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,o?c.insertBefore(n,o):c.appendChild(n);else if(m!==4&&(m===27&&ns(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(nl(n,o,c),n=n.sibling;n!==null;)nl(n,o,c),n=n.sibling}function Rg(n){var o=n.stateNode,c=n.memoizedProps;try{for(var m=n.type,E=o.attributes;E.length;)o.removeAttributeNode(E[0]);Be(o,m,c),o[Me]=n,o[We]=c}catch(x){Ht(n,n.return,x)}}var Tn=!1,Se=!1,gf=!1,Lg=typeof WeakSet=="function"?WeakSet:Set,De=null;function UT(n,o){if(n=n.containerInfo,Ff=Al,n=Bm(n),lc(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else t:{c=(c=n.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var E=m.anchorOffset,x=m.focusNode;m=m.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break t}var L=0,I=-1,U=-1,J=0,rt=0,lt=n,et=null;e:for(;;){for(var it;lt!==c||E!==0&&lt.nodeType!==3||(I=L+E),lt!==x||m!==0&&lt.nodeType!==3||(U=L+m),lt.nodeType===3&&(L+=lt.nodeValue.length),(it=lt.firstChild)!==null;)et=lt,lt=it;for(;;){if(lt===n)break e;if(et===c&&++J===E&&(I=L),et===x&&++rt===m&&(U=L),(it=lt.nextSibling)!==null)break;lt=et,et=lt.parentNode}lt=it}c=I===-1||U===-1?null:{start:I,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(Bf={focusedElem:n,selectionRange:c},Al=!1,De=o;De!==null;)if(o=De,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,De=n;else for(;De!==null;){switch(o=De,x=o.alternate,n=o.flags,o.tag){case 0:if((n&4)!==0&&(n=o.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)E=n[c],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&x!==null){n=void 0,c=o,E=x.memoizedProps,x=x.memoizedState,m=c.stateNode;try{var gt=Ps(c.type,E);n=m.getSnapshotBeforeUpdate(gt,x),m.__reactInternalSnapshotBeforeUpdate=n}catch(St){Ht(c,c.return,St)}}break;case 3:if((n&1024)!==0){if(n=o.stateNode.containerInfo,c=n.nodeType,c===9)jf(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":jf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=o.sibling,n!==null){n.return=o.return,De=n;break}De=o.return}}function _g(n,o,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:An(n,c),m&4&&wa(5,c);break;case 1:if(An(n,c),m&4)if(n=c.stateNode,o===null)try{n.componentDidMount()}catch(L){Ht(c,c.return,L)}else{var E=Ps(c.type,o.memoizedProps);o=o.memoizedState;try{n.componentDidUpdate(E,o,n.__reactInternalSnapshotBeforeUpdate)}catch(L){Ht(c,c.return,L)}}m&64&&Sg(c),m&512&&Da(c,c.return);break;case 3:if(An(n,c),m&64&&(n=c.updateQueue,n!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{fp(n,o)}catch(L){Ht(c,c.return,L)}}break;case 27:o===null&&m&4&&Rg(c);case 26:case 5:An(n,c),o===null&&m&4&&bg(c),m&512&&Da(c,c.return);break;case 12:An(n,c);break;case 31:An(n,c),m&4&&Dg(n,c);break;case 13:An(n,c),m&4&&Ig(n,c),m&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=YT.bind(null,c),mb(n,c))));break;case 22:if(m=c.memoizedState!==null||Tn,!m){o=o!==null&&o.memoizedState!==null||Se,E=Tn;var x=Se;Tn=m,(Se=o)&&!x?Rn(n,c,(c.subtreeFlags&8772)!==0):An(n,c),Tn=E,Se=x}break;case 30:break;default:An(n,c)}}function Cg(n){var o=n.alternate;o!==null&&(n.alternate=null,Cg(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&Vu(o)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var se=null,Ze=!1;function bn(n,o,c){for(c=c.child;c!==null;)wg(n,o,c),c=c.sibling}function wg(n,o,c){if(ze&&typeof ze.onCommitFiberUnmount=="function")try{ze.onCommitFiberUnmount(Es,c)}catch{}switch(c.tag){case 26:Se||zi(c,o),bn(n,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Se||zi(c,o);var m=se,E=Ze;ns(c.type)&&(se=c.stateNode,Ze=!1),bn(n,o,c),Ua(c.stateNode),se=m,Ze=E;break;case 5:Se||zi(c,o);case 6:if(m=se,E=Ze,se=null,bn(n,o,c),se=m,Ze=E,se!==null)if(Ze)try{(se.nodeType===9?se.body:se.nodeName==="HTML"?se.ownerDocument.body:se).removeChild(c.stateNode)}catch(x){Ht(c,o,x)}else try{se.removeChild(c.stateNode)}catch(x){Ht(c,o,x)}break;case 18:se!==null&&(Ze?(n=se,S0(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),Pr(n)):S0(se,c.stateNode));break;case 4:m=se,E=Ze,se=c.stateNode.containerInfo,Ze=!0,bn(n,o,c),se=m,Ze=E;break;case 0:case 11:case 14:case 15:Wn(2,c,o),Se||Wn(4,c,o),bn(n,o,c);break;case 1:Se||(zi(c,o),m=c.stateNode,typeof m.componentWillUnmount=="function"&&Tg(c,o,m)),bn(n,o,c);break;case 21:bn(n,o,c);break;case 22:Se=(m=Se)||c.memoizedState!==null,bn(n,o,c),Se=m;break;default:bn(n,o,c)}}function Dg(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Pr(n)}catch(c){Ht(o,o.return,c)}}}function Ig(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Pr(n)}catch(c){Ht(o,o.return,c)}}function $T(n){switch(n.tag){case 31:case 13:case 19:var o=n.stateNode;return o===null&&(o=n.stateNode=new Lg),o;case 22:return n=n.stateNode,o=n._retryCache,o===null&&(o=n._retryCache=new Lg),o;default:throw Error(i(435,n.tag))}}function sl(n,o){var c=$T(n);o.forEach(function(m){if(!c.has(m)){c.add(m);var E=XT.bind(null,n,m);m.then(E,E)}})}function Je(n,o){var c=o.deletions;if(c!==null)for(var m=0;m<c.length;m++){var E=c[m],x=n,L=o,I=L;t:for(;I!==null;){switch(I.tag){case 27:if(ns(I.type)){se=I.stateNode,Ze=!1;break t}break;case 5:se=I.stateNode,Ze=!1;break t;case 3:case 4:se=I.stateNode.containerInfo,Ze=!0;break t}I=I.return}if(se===null)throw Error(i(160));wg(x,L,E),se=null,Ze=!1,x=E.alternate,x!==null&&(x.return=null),E.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Og(o,n),o=o.sibling}var Mi=null;function Og(n,o){var c=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Je(o,n),ti(n),m&4&&(Wn(3,n,n.return),wa(3,n),Wn(5,n,n.return));break;case 1:Je(o,n),ti(n),m&512&&(Se||c===null||zi(c,c.return)),m&64&&Tn&&(n=n.updateQueue,n!==null&&(m=n.callbacks,m!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var E=Mi;if(Je(o,n),ti(n),m&512&&(Se||c===null||zi(c,c.return)),m&4){var x=c!==null?c.memoizedState:null;if(m=n.memoizedState,c===null)if(m===null)if(n.stateNode===null){t:{m=n.type,c=n.memoizedProps,E=E.ownerDocument||E;e:switch(m){case"title":x=E.getElementsByTagName("title")[0],(!x||x[na]||x[Me]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=E.createElement(m),E.head.insertBefore(x,E.querySelector("head > title"))),Be(x,m,c),x[Me]=n,we(x),m=x;break t;case"link":var L=O0("link","href",E).get(m+(c.href||""));if(L){for(var I=0;I<L.length;I++)if(x=L[I],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){L.splice(I,1);break e}}x=E.createElement(m),Be(x,m,c),E.head.appendChild(x);break;case"meta":if(L=O0("meta","content",E).get(m+(c.content||""))){for(I=0;I<L.length;I++)if(x=L[I],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){L.splice(I,1);break e}}x=E.createElement(m),Be(x,m,c),E.head.appendChild(x);break;default:throw Error(i(468,m))}x[Me]=n,we(x),m=x}n.stateNode=m}else k0(E,n.type,n.stateNode);else n.stateNode=I0(E,m,n.memoizedProps);else x!==m?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,m===null?k0(E,n.type,n.stateNode):I0(E,m,n.memoizedProps)):m===null&&n.stateNode!==null&&hf(n,n.memoizedProps,c.memoizedProps)}break;case 27:Je(o,n),ti(n),m&512&&(Se||c===null||zi(c,c.return)),c!==null&&m&4&&hf(n,n.memoizedProps,c.memoizedProps);break;case 5:if(Je(o,n),ti(n),m&512&&(Se||c===null||zi(c,c.return)),n.flags&32){E=n.stateNode;try{sr(E,"")}catch(gt){Ht(n,n.return,gt)}}m&4&&n.stateNode!=null&&(E=n.memoizedProps,hf(n,E,c!==null?c.memoizedProps:E)),m&1024&&(gf=!0);break;case 6:if(Je(o,n),ti(n),m&4){if(n.stateNode===null)throw Error(i(162));m=n.memoizedProps,c=n.stateNode;try{c.nodeValue=m}catch(gt){Ht(n,n.return,gt)}}break;case 3:if(xl=null,E=Mi,Mi=vl(o.containerInfo),Je(o,n),Mi=E,ti(n),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Pr(o.containerInfo)}catch(gt){Ht(n,n.return,gt)}gf&&(gf=!1,kg(n));break;case 4:m=Mi,Mi=vl(n.stateNode.containerInfo),Je(o,n),ti(n),Mi=m;break;case 12:Je(o,n),ti(n);break;case 31:Je(o,n),ti(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,sl(n,m)));break;case 13:Je(o,n),ti(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(al=ne()),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,sl(n,m)));break;case 22:E=n.memoizedState!==null;var U=c!==null&&c.memoizedState!==null,J=Tn,rt=Se;if(Tn=J||E,Se=rt||U,Je(o,n),Se=rt,Tn=J,ti(n),m&8192)t:for(o=n.stateNode,o._visibility=E?o._visibility&-2:o._visibility|1,E&&(c===null||U||Tn||Se||Ns(n)),c=null,o=n;;){if(o.tag===5||o.tag===26){if(c===null){U=c=o;try{if(x=U.stateNode,E)L=x.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{I=U.stateNode;var lt=U.memoizedProps.style,et=lt!=null&&lt.hasOwnProperty("display")?lt.display:null;I.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(gt){Ht(U,U.return,gt)}}}else if(o.tag===6){if(c===null){U=o;try{U.stateNode.nodeValue=E?"":U.memoizedProps}catch(gt){Ht(U,U.return,gt)}}}else if(o.tag===18){if(c===null){U=o;try{var it=U.stateNode;E?T0(it,!0):T0(U.stateNode,!1)}catch(gt){Ht(U,U.return,gt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===n)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break t;for(;o.sibling===null;){if(o.return===null||o.return===n)break t;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}m&4&&(m=n.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,sl(n,c))));break;case 19:Je(o,n),ti(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,sl(n,m)));break;case 30:break;case 21:break;default:Je(o,n),ti(n)}}function ti(n){var o=n.flags;if(o&2){try{for(var c,m=n.return;m!==null;){if(Ag(m)){c=m;break}m=m.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var E=c.stateNode,x=mf(n);nl(n,x,E);break;case 5:var L=c.stateNode;c.flags&32&&(sr(L,""),c.flags&=-33);var I=mf(n);nl(n,I,L);break;case 3:case 4:var U=c.stateNode.containerInfo,J=mf(n);pf(n,J,U);break;default:throw Error(i(161))}}catch(rt){Ht(n,n.return,rt)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function kg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var o=n;kg(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),n=n.sibling}}function An(n,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)_g(n,o.alternate,o),o=o.sibling}function Ns(n){for(n=n.child;n!==null;){var o=n;switch(o.tag){case 0:case 11:case 14:case 15:Wn(4,o,o.return),Ns(o);break;case 1:zi(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&Tg(o,o.return,c),Ns(o);break;case 27:Ua(o.stateNode);case 26:case 5:zi(o,o.return),Ns(o);break;case 22:o.memoizedState===null&&Ns(o);break;case 30:Ns(o);break;default:Ns(o)}n=n.sibling}}function Rn(n,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var m=o.alternate,E=n,x=o,L=x.flags;switch(x.tag){case 0:case 11:case 15:Rn(E,x,c),wa(4,x);break;case 1:if(Rn(E,x,c),m=x,E=m.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(J){Ht(m,m.return,J)}if(m=x,E=m.updateQueue,E!==null){var I=m.stateNode;try{var U=E.shared.hiddenCallbacks;if(U!==null)for(E.shared.hiddenCallbacks=null,E=0;E<U.length;E++)cp(U[E],I)}catch(J){Ht(m,m.return,J)}}c&&L&64&&Sg(x),Da(x,x.return);break;case 27:Rg(x);case 26:case 5:Rn(E,x,c),c&&m===null&&L&4&&bg(x),Da(x,x.return);break;case 12:Rn(E,x,c);break;case 31:Rn(E,x,c),c&&L&4&&Dg(E,x);break;case 13:Rn(E,x,c),c&&L&4&&Ig(E,x);break;case 22:x.memoizedState===null&&Rn(E,x,c),Da(x,x.return);break;case 30:break;default:Rn(E,x,c)}o=o.sibling}}function yf(n,o){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(n=o.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&ga(c))}function vf(n,o){n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&ga(n))}function Pi(n,o,c,m){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Mg(n,o,c,m),o=o.sibling}function Mg(n,o,c,m){var E=o.flags;switch(o.tag){case 0:case 11:case 15:Pi(n,o,c,m),E&2048&&wa(9,o);break;case 1:Pi(n,o,c,m);break;case 3:Pi(n,o,c,m),E&2048&&(n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&ga(n)));break;case 12:if(E&2048){Pi(n,o,c,m),n=o.stateNode;try{var x=o.memoizedProps,L=x.id,I=x.onPostCommit;typeof I=="function"&&I(L,o.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){Ht(o,o.return,U)}}else Pi(n,o,c,m);break;case 31:Pi(n,o,c,m);break;case 13:Pi(n,o,c,m);break;case 23:break;case 22:x=o.stateNode,L=o.alternate,o.memoizedState!==null?x._visibility&2?Pi(n,o,c,m):Ia(n,o):x._visibility&2?Pi(n,o,c,m):(x._visibility|=2,Ar(n,o,c,m,(o.subtreeFlags&10256)!==0||!1)),E&2048&&yf(L,o);break;case 24:Pi(n,o,c,m),E&2048&&vf(o.alternate,o);break;default:Pi(n,o,c,m)}}function Ar(n,o,c,m,E){for(E=E&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=n,L=o,I=c,U=m,J=L.flags;switch(L.tag){case 0:case 11:case 15:Ar(x,L,I,U,E),wa(8,L);break;case 23:break;case 22:var rt=L.stateNode;L.memoizedState!==null?rt._visibility&2?Ar(x,L,I,U,E):Ia(x,L):(rt._visibility|=2,Ar(x,L,I,U,E)),E&&J&2048&&yf(L.alternate,L);break;case 24:Ar(x,L,I,U,E),E&&J&2048&&vf(L.alternate,L);break;default:Ar(x,L,I,U,E)}o=o.sibling}}function Ia(n,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=n,m=o,E=m.flags;switch(m.tag){case 22:Ia(c,m),E&2048&&yf(m.alternate,m);break;case 24:Ia(c,m),E&2048&&vf(m.alternate,m);break;default:Ia(c,m)}o=o.sibling}}var Oa=8192;function Rr(n,o,c){if(n.subtreeFlags&Oa)for(n=n.child;n!==null;)Pg(n,o,c),n=n.sibling}function Pg(n,o,c){switch(n.tag){case 26:Rr(n,o,c),n.flags&Oa&&n.memoizedState!==null&&Lb(c,Mi,n.memoizedState,n.memoizedProps);break;case 5:Rr(n,o,c);break;case 3:case 4:var m=Mi;Mi=vl(n.stateNode.containerInfo),Rr(n,o,c),Mi=m;break;case 22:n.memoizedState===null&&(m=n.alternate,m!==null&&m.memoizedState!==null?(m=Oa,Oa=16777216,Rr(n,o,c),Oa=m):Rr(n,o,c));break;default:Rr(n,o,c)}}function Ng(n){var o=n.alternate;if(o!==null&&(n=o.child,n!==null)){o.child=null;do o=n.sibling,n.sibling=null,n=o;while(n!==null)}}function ka(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];De=m,Bg(m,n)}Ng(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Fg(n),n=n.sibling}function Fg(n){switch(n.tag){case 0:case 11:case 15:ka(n),n.flags&2048&&Wn(9,n,n.return);break;case 3:ka(n);break;case 12:ka(n);break;case 22:var o=n.stateNode;n.memoizedState!==null&&o._visibility&2&&(n.return===null||n.return.tag!==13)?(o._visibility&=-3,rl(n)):ka(n);break;default:ka(n)}}function rl(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];De=m,Bg(m,n)}Ng(n)}for(n=n.child;n!==null;){switch(o=n,o.tag){case 0:case 11:case 15:Wn(8,o,o.return),rl(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,rl(o));break;default:rl(o)}n=n.sibling}}function Bg(n,o){for(;De!==null;){var c=De;switch(c.tag){case 0:case 11:case 15:Wn(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:ga(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,De=m;else t:for(c=n;De!==null;){m=De;var E=m.sibling,x=m.return;if(Cg(m),m===c){De=null;break t}if(E!==null){E.return=x,De=E;break t}De=x}}}var jT={getCacheForType:function(n){var o=Ne(ve),c=o.data.get(n);return c===void 0&&(c=n(),o.data.set(n,c)),c},cacheSignal:function(){return Ne(ve).controller.signal}},GT=typeof WeakMap=="function"?WeakMap:Map,jt=0,Qt=null,kt=null,Pt=0,Gt=0,ui=null,Qn=!1,Lr=!1,Ef=!1,Ln=0,fe=0,Zn=0,Fs=0,xf=0,ci=0,_r=0,Ma=null,ei=null,Sf=!1,al=0,Ug=0,ol=1/0,ll=null,Jn=null,Ae=0,ts=null,Cr=null,_n=0,Tf=0,bf=null,$g=null,Pa=0,Af=null;function fi(){return(jt&2)!==0&&Pt!==0?Pt&-Pt:O.T!==null?Df():im()}function jg(){if(ci===0)if((Pt&536870912)===0||Ft){var n=go;go<<=1,(go&3932160)===0&&(go=262144),ci=n}else ci=536870912;return n=oi.current,n!==null&&(n.flags|=32),ci}function ii(n,o,c){(n===Qt&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)&&(wr(n,0),es(n,Pt,ci,!1)),ia(n,c),((jt&2)===0||n!==Qt)&&(n===Qt&&((jt&2)===0&&(Fs|=c),fe===4&&es(n,Pt,ci,!1)),Vi(n))}function Gg(n,o,c){if((jt&6)!==0)throw Error(i(327));var m=!c&&(o&127)===0&&(o&n.expiredLanes)===0||ea(n,o),E=m?VT(n,o):Lf(n,o,!0),x=m;do{if(E===0){Lr&&!m&&es(n,o,0,!1);break}else{if(c=n.current.alternate,x&&!HT(c)){E=Lf(n,o,!1),x=!1;continue}if(E===2){if(x=o,n.errorRecoveryDisabledLanes&x)var L=0;else L=n.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){o=L;t:{var I=n;E=Ma;var U=I.current.memoizedState.isDehydrated;if(U&&(wr(I,L).flags|=256),L=Lf(I,L,!1),L!==2){if(Ef&&!U){I.errorRecoveryDisabledLanes|=x,Fs|=x,E=4;break t}x=ei,ei=E,x!==null&&(ei===null?ei=x:ei.push.apply(ei,x))}E=L}if(x=!1,E!==2)continue}}if(E===1){wr(n,0),es(n,o,0,!0);break}t:{switch(m=n,x=E,x){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:es(m,o,ci,!Qn);break t;case 2:ei=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(E=al+300-ne(),10<E)){if(es(m,o,ci,!Qn),vo(m,0,!0)!==0)break t;_n=o,m.timeoutHandle=E0(Hg.bind(null,m,c,ei,ll,Sf,o,ci,Fs,_r,Qn,x,"Throttled",-0,0),E);break t}Hg(m,c,ei,ll,Sf,o,ci,Fs,_r,Qn,x,null,-0,0)}}break}while(!0);Vi(n)}function Hg(n,o,c,m,E,x,L,I,U,J,rt,lt,et,it){if(n.timeoutHandle=-1,lt=o.subtreeFlags,lt&8192||(lt&16785408)===16785408){lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dn},Pg(o,x,lt);var gt=(x&62914560)===x?al-ne():(x&4194048)===x?Ug-ne():0;if(gt=_b(lt,gt),gt!==null){_n=x,n.cancelPendingCommit=gt(Qg.bind(null,n,o,x,c,m,E,L,I,U,rt,lt,null,et,it)),es(n,x,L,!J);return}}Qg(n,o,x,c,m,E,L,I,U)}function HT(n){for(var o=n;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var E=c[m],x=E.getSnapshot;E=E.value;try{if(!ri(x(),E))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function es(n,o,c,m){o&=~xf,o&=~Fs,n.suspendedLanes|=o,n.pingedLanes&=~o,m&&(n.warmLanes|=o),m=n.expirationTimes;for(var E=o;0<E;){var x=31-Ve(E),L=1<<x;m[x]=-1,E&=~L}c!==0&&Jh(n,c,o)}function ul(){return(jt&6)===0?(Na(0),!1):!0}function Rf(){if(kt!==null){if(Gt===0)var n=kt.return;else n=kt,gn=Cs=null,$c(n),Er=null,va=0,n=kt;for(;n!==null;)xg(n.alternate,n),n=n.return;kt=null}}function wr(n,o){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,ub(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),_n=0,Rf(),Qt=n,kt=c=mn(n.current,null),Pt=o,Gt=0,ui=null,Qn=!1,Lr=ea(n,o),Ef=!1,_r=ci=xf=Fs=Zn=fe=0,ei=Ma=null,Sf=!1,(o&8)!==0&&(o|=o&32);var m=n.entangledLanes;if(m!==0)for(n=n.entanglements,m&=o;0<m;){var E=31-Ve(m),x=1<<E;o|=n[E],m&=~x}return Ln=o,Do(),c}function zg(n,o){Ct=null,O.H=La,o===vr||o===Bo?(o=ap(),Gt=3):o===Cc?(o=ap(),Gt=4):Gt=o===nf?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ui=o,kt===null&&(fe=1,Zo(n,bi(o,n.current)))}function Vg(){var n=oi.current;return n===null?!0:(Pt&4194048)===Pt?_i===null:(Pt&62914560)===Pt||(Pt&536870912)!==0?n===_i:!1}function Kg(){var n=O.H;return O.H=La,n===null?La:n}function qg(){var n=O.A;return O.A=jT,n}function cl(){fe=4,Qn||(Pt&4194048)!==Pt&&oi.current!==null||(Lr=!0),(Zn&134217727)===0&&(Fs&134217727)===0||Qt===null||es(Qt,Pt,ci,!1)}function Lf(n,o,c){var m=jt;jt|=2;var E=Kg(),x=qg();(Qt!==n||Pt!==o)&&(ll=null,wr(n,o)),o=!1;var L=fe;t:do try{if(Gt!==0&&kt!==null){var I=kt,U=ui;switch(Gt){case 8:Rf(),L=6;break t;case 3:case 2:case 9:case 6:oi.current===null&&(o=!0);var J=Gt;if(Gt=0,ui=null,Dr(n,I,U,J),c&&Lr){L=0;break t}break;default:J=Gt,Gt=0,ui=null,Dr(n,I,U,J)}}zT(),L=fe;break}catch(rt){zg(n,rt)}while(!0);return o&&n.shellSuspendCounter++,gn=Cs=null,jt=m,O.H=E,O.A=x,kt===null&&(Qt=null,Pt=0,Do()),L}function zT(){for(;kt!==null;)Yg(kt)}function VT(n,o){var c=jt;jt|=2;var m=Kg(),E=qg();Qt!==n||Pt!==o?(ll=null,ol=ne()+500,wr(n,o)):Lr=ea(n,o);t:do try{if(Gt!==0&&kt!==null){o=kt;var x=ui;e:switch(Gt){case 1:Gt=0,ui=null,Dr(n,o,x,1);break;case 2:case 9:if(sp(x)){Gt=0,ui=null,Xg(o);break}o=function(){Gt!==2&&Gt!==9||Qt!==n||(Gt=7),Vi(n)},x.then(o,o);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:sp(x)?(Gt=0,ui=null,Xg(o)):(Gt=0,ui=null,Dr(n,o,x,7));break;case 5:var L=null;switch(kt.tag){case 26:L=kt.memoizedState;case 5:case 27:var I=kt;if(L?M0(L):I.stateNode.complete){Gt=0,ui=null;var U=I.sibling;if(U!==null)kt=U;else{var J=I.return;J!==null?(kt=J,fl(J)):kt=null}break e}}Gt=0,ui=null,Dr(n,o,x,5);break;case 6:Gt=0,ui=null,Dr(n,o,x,6);break;case 8:Rf(),fe=6;break t;default:throw Error(i(462))}}KT();break}catch(rt){zg(n,rt)}while(!0);return gn=Cs=null,O.H=m,O.A=E,jt=c,kt!==null?0:(Qt=null,Pt=0,Do(),fe)}function KT(){for(;kt!==null&&!je();)Yg(kt)}function Yg(n){var o=vg(n.alternate,n,Ln);n.memoizedProps=n.pendingProps,o===null?fl(n):kt=o}function Xg(n){var o=n,c=o.alternate;switch(o.tag){case 15:case 0:o=dg(c,o,o.pendingProps,o.type,void 0,Pt);break;case 11:o=dg(c,o,o.pendingProps,o.type.render,o.ref,Pt);break;case 5:$c(o);default:xg(c,o),o=kt=qm(o,Ln),o=vg(c,o,Ln)}n.memoizedProps=n.pendingProps,o===null?fl(n):kt=o}function Dr(n,o,c,m){gn=Cs=null,$c(o),Er=null,va=0;var E=o.return;try{if(MT(n,E,o,c,Pt)){fe=1,Zo(n,bi(c,n.current)),kt=null;return}}catch(x){if(E!==null)throw kt=E,x;fe=1,Zo(n,bi(c,n.current)),kt=null;return}o.flags&32768?(Ft||m===1?n=!0:Lr||(Pt&536870912)!==0?n=!1:(Qn=n=!0,(m===2||m===9||m===3||m===6)&&(m=oi.current,m!==null&&m.tag===13&&(m.flags|=16384))),Wg(o,n)):fl(o)}function fl(n){var o=n;do{if((o.flags&32768)!==0){Wg(o,Qn);return}n=o.return;var c=FT(o.alternate,o,Ln);if(c!==null){kt=c;return}if(o=o.sibling,o!==null){kt=o;return}kt=o=n}while(o!==null);fe===0&&(fe=5)}function Wg(n,o){do{var c=BT(n.alternate,n);if(c!==null){c.flags&=32767,kt=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(n=n.sibling,n!==null)){kt=n;return}kt=n=c}while(n!==null);fe=6,kt=null}function Qg(n,o,c,m,E,x,L,I,U){n.cancelPendingCommit=null;do dl();while(Ae!==0);if((jt&6)!==0)throw Error(i(327));if(o!==null){if(o===n.current)throw Error(i(177));if(x=o.lanes|o.childLanes,x|=hc,RS(n,c,x,L,I,U),n===Qt&&(kt=Qt=null,Pt=0),Cr=o,ts=n,_n=c,Tf=x,bf=E,$g=m,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,WT(Bn,function(){return i0(),null})):(n.callbackNode=null,n.callbackPriority=0),m=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||m){m=O.T,O.T=null,E=G.p,G.p=2,L=jt,jt|=4;try{UT(n,o,c)}finally{jt=L,G.p=E,O.T=m}}Ae=1,Zg(),Jg(),t0()}}function Zg(){if(Ae===1){Ae=0;var n=ts,o=Cr,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=O.T,O.T=null;var m=G.p;G.p=2;var E=jt;jt|=4;try{Og(o,n);var x=Bf,L=Bm(n.containerInfo),I=x.focusedElem,U=x.selectionRange;if(L!==I&&I&&I.ownerDocument&&Fm(I.ownerDocument.documentElement,I)){if(U!==null&&lc(I)){var J=U.start,rt=U.end;if(rt===void 0&&(rt=J),"selectionStart"in I)I.selectionStart=J,I.selectionEnd=Math.min(rt,I.value.length);else{var lt=I.ownerDocument||document,et=lt&&lt.defaultView||window;if(et.getSelection){var it=et.getSelection(),gt=I.textContent.length,St=Math.min(U.start,gt),Xt=U.end===void 0?St:Math.min(U.end,gt);!it.extend&&St>Xt&&(L=Xt,Xt=St,St=L);var Y=Nm(I,St),z=Nm(I,Xt);if(Y&&z&&(it.rangeCount!==1||it.anchorNode!==Y.node||it.anchorOffset!==Y.offset||it.focusNode!==z.node||it.focusOffset!==z.offset)){var Z=lt.createRange();Z.setStart(Y.node,Y.offset),it.removeAllRanges(),St>Xt?(it.addRange(Z),it.extend(z.node,z.offset)):(Z.setEnd(z.node,z.offset),it.addRange(Z))}}}}for(lt=[],it=I;it=it.parentNode;)it.nodeType===1&&lt.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<lt.length;I++){var ot=lt[I];ot.element.scrollLeft=ot.left,ot.element.scrollTop=ot.top}}Al=!!Ff,Bf=Ff=null}finally{jt=E,G.p=m,O.T=c}}n.current=o,Ae=2}}function Jg(){if(Ae===2){Ae=0;var n=ts,o=Cr,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=O.T,O.T=null;var m=G.p;G.p=2;var E=jt;jt|=4;try{_g(n,o.alternate,o)}finally{jt=E,G.p=m,O.T=c}}Ae=3}}function t0(){if(Ae===4||Ae===3){Ae=0,He();var n=ts,o=Cr,c=_n,m=$g;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ae=5:(Ae=0,Cr=ts=null,e0(n,n.pendingLanes));var E=n.pendingLanes;if(E===0&&(Jn=null),Hu(c),o=o.stateNode,ze&&typeof ze.onCommitFiberRoot=="function")try{ze.onCommitFiberRoot(Es,o,void 0,(o.current.flags&128)===128)}catch{}if(m!==null){o=O.T,E=G.p,G.p=2,O.T=null;try{for(var x=n.onRecoverableError,L=0;L<m.length;L++){var I=m[L];x(I.value,{componentStack:I.stack})}}finally{O.T=o,G.p=E}}(_n&3)!==0&&dl(),Vi(n),E=n.pendingLanes,(c&261930)!==0&&(E&42)!==0?n===Af?Pa++:(Pa=0,Af=n):Pa=0,Na(0)}}function e0(n,o){(n.pooledCacheLanes&=o)===0&&(o=n.pooledCache,o!=null&&(n.pooledCache=null,ga(o)))}function dl(){return Zg(),Jg(),t0(),i0()}function i0(){if(Ae!==5)return!1;var n=ts,o=Tf;Tf=0;var c=Hu(_n),m=O.T,E=G.p;try{G.p=32>c?32:c,O.T=null,c=bf,bf=null;var x=ts,L=_n;if(Ae=0,Cr=ts=null,_n=0,(jt&6)!==0)throw Error(i(331));var I=jt;if(jt|=4,Fg(x.current),Mg(x,x.current,L,c),jt=I,Na(0,!1),ze&&typeof ze.onPostCommitFiberRoot=="function")try{ze.onPostCommitFiberRoot(Es,x)}catch{}return!0}finally{G.p=E,O.T=m,e0(n,o)}}function n0(n,o,c){o=bi(c,o),o=ef(n.stateNode,o,2),n=qn(n,o,2),n!==null&&(ia(n,2),Vi(n))}function Ht(n,o,c){if(n.tag===3)n0(n,n,c);else for(;o!==null;){if(o.tag===3){n0(o,n,c);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Jn===null||!Jn.has(m))){n=bi(c,n),c=sg(2),m=qn(o,c,2),m!==null&&(rg(c,m,o,n),ia(m,2),Vi(m));break}}o=o.return}}function _f(n,o,c){var m=n.pingCache;if(m===null){m=n.pingCache=new GT;var E=new Set;m.set(o,E)}else E=m.get(o),E===void 0&&(E=new Set,m.set(o,E));E.has(c)||(Ef=!0,E.add(c),n=qT.bind(null,n,o,c),o.then(n,n))}function qT(n,o,c){var m=n.pingCache;m!==null&&m.delete(o),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,Qt===n&&(Pt&c)===c&&(fe===4||fe===3&&(Pt&62914560)===Pt&&300>ne()-al?(jt&2)===0&&wr(n,0):xf|=c,_r===Pt&&(_r=0)),Vi(n)}function s0(n,o){o===0&&(o=Zh()),n=Rs(n,o),n!==null&&(ia(n,o),Vi(n))}function YT(n){var o=n.memoizedState,c=0;o!==null&&(c=o.retryLane),s0(n,c)}function XT(n,o){var c=0;switch(n.tag){case 31:case 13:var m=n.stateNode,E=n.memoizedState;E!==null&&(c=E.retryLane);break;case 19:m=n.stateNode;break;case 22:m=n.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(o),s0(n,c)}function WT(n,o){return ue(n,o)}var hl=null,Ir=null,Cf=!1,ml=!1,wf=!1,is=0;function Vi(n){n!==Ir&&n.next===null&&(Ir===null?hl=Ir=n:Ir=Ir.next=n),ml=!0,Cf||(Cf=!0,ZT())}function Na(n,o){if(!wf&&ml){wf=!0;do for(var c=!1,m=hl;m!==null;){if(n!==0){var E=m.pendingLanes;if(E===0)var x=0;else{var L=m.suspendedLanes,I=m.pingedLanes;x=(1<<31-Ve(42|n)+1)-1,x&=E&~(L&~I),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,l0(m,x))}else x=Pt,x=vo(m,m===Qt?x:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(x&3)===0||ea(m,x)||(c=!0,l0(m,x));m=m.next}while(c);wf=!1}}function QT(){r0()}function r0(){ml=Cf=!1;var n=0;is!==0&&lb()&&(n=is);for(var o=ne(),c=null,m=hl;m!==null;){var E=m.next,x=a0(m,o);x===0?(m.next=null,c===null?hl=E:c.next=E,E===null&&(Ir=c)):(c=m,(n!==0||(x&3)!==0)&&(ml=!0)),m=E}Ae!==0&&Ae!==5||Na(n),is!==0&&(is=0)}function a0(n,o){for(var c=n.suspendedLanes,m=n.pingedLanes,E=n.expirationTimes,x=n.pendingLanes&-62914561;0<x;){var L=31-Ve(x),I=1<<L,U=E[L];U===-1?((I&c)===0||(I&m)!==0)&&(E[L]=AS(I,o)):U<=o&&(n.expiredLanes|=I),x&=~I}if(o=Qt,c=Pt,c=vo(n,n===o?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m=n.callbackNode,c===0||n===o&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)return m!==null&&m!==null&&ke(m),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||ea(n,c)){if(o=c&-c,o===n.callbackPriority)return o;switch(m!==null&&ke(m),Hu(c)){case 2:case 8:c=ys;break;case 32:c=Bn;break;case 268435456:c=vs;break;default:c=Bn}return m=o0.bind(null,n),c=ue(c,m),n.callbackPriority=o,n.callbackNode=c,o}return m!==null&&m!==null&&ke(m),n.callbackPriority=2,n.callbackNode=null,2}function o0(n,o){if(Ae!==0&&Ae!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(dl()&&n.callbackNode!==c)return null;var m=Pt;return m=vo(n,n===Qt?m:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m===0?null:(Gg(n,m,o),a0(n,ne()),n.callbackNode!=null&&n.callbackNode===c?o0.bind(null,n):null)}function l0(n,o){if(dl())return null;Gg(n,o,!0)}function ZT(){cb(function(){(jt&6)!==0?ue(Xe,QT):r0()})}function Df(){if(is===0){var n=gr;n===0&&(n=po,po<<=1,(po&261888)===0&&(po=256)),is=n}return is}function u0(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:To(""+n)}function c0(n,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,n.id&&c.setAttribute("form",n.id),o.parentNode.insertBefore(c,o),n=new FormData(n),c.parentNode.removeChild(c),n}function JT(n,o,c,m,E){if(o==="submit"&&c&&c.stateNode===E){var x=u0((E[We]||null).action),L=m.submitter;L&&(o=(o=L[We]||null)?u0(o.formAction):L.getAttribute("formAction"),o!==null&&(x=o,L=null));var I=new Lo("action","action",null,m,E);n.push({event:I,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(is!==0){var U=L?c0(E,L):new FormData(E);Xc(c,{pending:!0,data:U,method:E.method,action:x},null,U)}}else typeof x=="function"&&(I.preventDefault(),U=L?c0(E,L):new FormData(E),Xc(c,{pending:!0,data:U,method:E.method,action:x},x,U))},currentTarget:E}]})}}for(var If=0;If<dc.length;If++){var Of=dc[If],tb=Of.toLowerCase(),eb=Of[0].toUpperCase()+Of.slice(1);ki(tb,"on"+eb)}ki(jm,"onAnimationEnd"),ki(Gm,"onAnimationIteration"),ki(Hm,"onAnimationStart"),ki("dblclick","onDoubleClick"),ki("focusin","onFocus"),ki("focusout","onBlur"),ki(yT,"onTransitionRun"),ki(vT,"onTransitionStart"),ki(ET,"onTransitionCancel"),ki(zm,"onTransitionEnd"),ir("onMouseEnter",["mouseout","mouseover"]),ir("onMouseLeave",["mouseout","mouseover"]),ir("onPointerEnter",["pointerout","pointerover"]),ir("onPointerLeave",["pointerout","pointerover"]),Ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ss("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ib=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fa));function f0(n,o){o=(o&4)!==0;for(var c=0;c<n.length;c++){var m=n[c],E=m.event;m=m.listeners;t:{var x=void 0;if(o)for(var L=m.length-1;0<=L;L--){var I=m[L],U=I.instance,J=I.currentTarget;if(I=I.listener,U!==x&&E.isPropagationStopped())break t;x=I,E.currentTarget=J;try{x(E)}catch(rt){wo(rt)}E.currentTarget=null,x=U}else for(L=0;L<m.length;L++){if(I=m[L],U=I.instance,J=I.currentTarget,I=I.listener,U!==x&&E.isPropagationStopped())break t;x=I,E.currentTarget=J;try{x(E)}catch(rt){wo(rt)}E.currentTarget=null,x=U}}}}function Mt(n,o){var c=o[zu];c===void 0&&(c=o[zu]=new Set);var m=n+"__bubble";c.has(m)||(d0(o,n,2,!1),c.add(m))}function kf(n,o,c){var m=0;o&&(m|=4),d0(c,n,m,o)}var pl="_reactListening"+Math.random().toString(36).slice(2);function Mf(n){if(!n[pl]){n[pl]=!0,rm.forEach(function(c){c!=="selectionchange"&&(ib.has(c)||kf(c,!1,n),kf(c,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[pl]||(o[pl]=!0,kf("selectionchange",!1,o))}}function d0(n,o,c,m){switch(j0(o)){case 2:var E=Db;break;case 8:E=Ib;break;default:E=Xf}c=E.bind(null,o,c,n),E=void 0,!Ju||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),m?E!==void 0?n.addEventListener(o,c,{capture:!0,passive:E}):n.addEventListener(o,c,!0):E!==void 0?n.addEventListener(o,c,{passive:E}):n.addEventListener(o,c,!1)}function Pf(n,o,c,m,E){var x=m;if((o&1)===0&&(o&2)===0&&m!==null)t:for(;;){if(m===null)return;var L=m.tag;if(L===3||L===4){var I=m.stateNode.containerInfo;if(I===E)break;if(L===4)for(L=m.return;L!==null;){var U=L.tag;if((U===3||U===4)&&L.stateNode.containerInfo===E)return;L=L.return}for(;I!==null;){if(L=Js(I),L===null)return;if(U=L.tag,U===5||U===6||U===26||U===27){m=x=L;continue t}I=I.parentNode}}m=m.return}ym(function(){var J=x,rt=Qu(c),lt=[];t:{var et=Vm.get(n);if(et!==void 0){var it=Lo,gt=n;switch(n){case"keypress":if(Ao(c)===0)break t;case"keydown":case"keyup":it=XS;break;case"focusin":gt="focus",it=nc;break;case"focusout":gt="blur",it=nc;break;case"beforeblur":case"afterblur":it=nc;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=xm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=FS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=ZS;break;case jm:case Gm:case Hm:it=$S;break;case zm:it=tT;break;case"scroll":case"scrollend":it=PS;break;case"wheel":it=iT;break;case"copy":case"cut":case"paste":it=GS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=Tm;break;case"toggle":case"beforetoggle":it=sT}var St=(o&4)!==0,Xt=!St&&(n==="scroll"||n==="scrollend"),Y=St?et!==null?et+"Capture":null:et;St=[];for(var z=J,Z;z!==null;){var ot=z;if(Z=ot.stateNode,ot=ot.tag,ot!==5&&ot!==26&&ot!==27||Z===null||Y===null||(ot=ra(z,Y),ot!=null&&St.push(Ba(z,ot,Z))),Xt)break;z=z.return}0<St.length&&(et=new it(et,gt,null,c,rt),lt.push({event:et,listeners:St}))}}if((o&7)===0){t:{if(et=n==="mouseover"||n==="pointerover",it=n==="mouseout"||n==="pointerout",et&&c!==Wu&&(gt=c.relatedTarget||c.fromElement)&&(Js(gt)||gt[Zs]))break t;if((it||et)&&(et=rt.window===rt?rt:(et=rt.ownerDocument)?et.defaultView||et.parentWindow:window,it?(gt=c.relatedTarget||c.toElement,it=J,gt=gt?Js(gt):null,gt!==null&&(Xt=a(gt),St=gt.tag,gt!==Xt||St!==5&&St!==27&&St!==6)&&(gt=null)):(it=null,gt=J),it!==gt)){if(St=xm,ot="onMouseLeave",Y="onMouseEnter",z="mouse",(n==="pointerout"||n==="pointerover")&&(St=Tm,ot="onPointerLeave",Y="onPointerEnter",z="pointer"),Xt=it==null?et:sa(it),Z=gt==null?et:sa(gt),et=new St(ot,z+"leave",it,c,rt),et.target=Xt,et.relatedTarget=Z,ot=null,Js(rt)===J&&(St=new St(Y,z+"enter",gt,c,rt),St.target=Z,St.relatedTarget=Xt,ot=St),Xt=ot,it&&gt)e:{for(St=nb,Y=it,z=gt,Z=0,ot=Y;ot;ot=St(ot))Z++;ot=0;for(var xt=z;xt;xt=St(xt))ot++;for(;0<Z-ot;)Y=St(Y),Z--;for(;0<ot-Z;)z=St(z),ot--;for(;Z--;){if(Y===z||z!==null&&Y===z.alternate){St=Y;break e}Y=St(Y),z=St(z)}St=null}else St=null;it!==null&&h0(lt,et,it,St,!1),gt!==null&&Xt!==null&&h0(lt,Xt,gt,St,!0)}}t:{if(et=J?sa(J):window,it=et.nodeName&&et.nodeName.toLowerCase(),it==="select"||it==="input"&&et.type==="file")var Ut=Dm;else if(Cm(et))if(Im)Ut=mT;else{Ut=dT;var yt=fT}else it=et.nodeName,!it||it.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?J&&Xu(J.elementType)&&(Ut=Dm):Ut=hT;if(Ut&&(Ut=Ut(n,J))){wm(lt,Ut,c,rt);break t}yt&&yt(n,et,J),n==="focusout"&&J&&et.type==="number"&&J.memoizedProps.value!=null&&Yu(et,"number",et.value)}switch(yt=J?sa(J):window,n){case"focusin":(Cm(yt)||yt.contentEditable==="true")&&(lr=yt,uc=J,ha=null);break;case"focusout":ha=uc=lr=null;break;case"mousedown":cc=!0;break;case"contextmenu":case"mouseup":case"dragend":cc=!1,Um(lt,c,rt);break;case"selectionchange":if(gT)break;case"keydown":case"keyup":Um(lt,c,rt)}var wt;if(rc)t:{switch(n){case"compositionstart":var Nt="onCompositionStart";break t;case"compositionend":Nt="onCompositionEnd";break t;case"compositionupdate":Nt="onCompositionUpdate";break t}Nt=void 0}else or?Lm(n,c)&&(Nt="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(bm&&c.locale!=="ko"&&(or||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&or&&(wt=vm()):($n=rt,tc="value"in $n?$n.value:$n.textContent,or=!0)),yt=gl(J,Nt),0<yt.length&&(Nt=new Sm(Nt,n,null,c,rt),lt.push({event:Nt,listeners:yt}),wt?Nt.data=wt:(wt=_m(c),wt!==null&&(Nt.data=wt)))),(wt=aT?oT(n,c):lT(n,c))&&(Nt=gl(J,"onBeforeInput"),0<Nt.length&&(yt=new Sm("onBeforeInput","beforeinput",null,c,rt),lt.push({event:yt,listeners:Nt}),yt.data=wt)),JT(lt,n,J,c,rt)}f0(lt,o)})}function Ba(n,o,c){return{instance:n,listener:o,currentTarget:c}}function gl(n,o){for(var c=o+"Capture",m=[];n!==null;){var E=n,x=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||x===null||(E=ra(n,c),E!=null&&m.unshift(Ba(n,E,x)),E=ra(n,o),E!=null&&m.push(Ba(n,E,x))),n.tag===3)return m;n=n.return}return[]}function nb(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function h0(n,o,c,m,E){for(var x=o._reactName,L=[];c!==null&&c!==m;){var I=c,U=I.alternate,J=I.stateNode;if(I=I.tag,U!==null&&U===m)break;I!==5&&I!==26&&I!==27||J===null||(U=J,E?(J=ra(c,x),J!=null&&L.unshift(Ba(c,J,U))):E||(J=ra(c,x),J!=null&&L.push(Ba(c,J,U)))),c=c.return}L.length!==0&&n.push({event:o,listeners:L})}var sb=/\r\n?/g,rb=/\u0000|\uFFFD/g;function m0(n){return(typeof n=="string"?n:""+n).replace(sb,`
`).replace(rb,"")}function p0(n,o){return o=m0(o),m0(n)===o}function Yt(n,o,c,m,E,x){switch(c){case"children":typeof m=="string"?o==="body"||o==="textarea"&&m===""||sr(n,m):(typeof m=="number"||typeof m=="bigint")&&o!=="body"&&sr(n,""+m);break;case"className":xo(n,"class",m);break;case"tabIndex":xo(n,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":xo(n,c,m);break;case"style":pm(n,m,x);break;case"data":if(o!=="object"){xo(n,"data",m);break}case"src":case"href":if(m===""&&(o!=="a"||c!=="href")){n.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=To(""+m),n.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&Yt(n,o,"name",E.name,E,null),Yt(n,o,"formEncType",E.formEncType,E,null),Yt(n,o,"formMethod",E.formMethod,E,null),Yt(n,o,"formTarget",E.formTarget,E,null)):(Yt(n,o,"encType",E.encType,E,null),Yt(n,o,"method",E.method,E,null),Yt(n,o,"target",E.target,E,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=To(""+m),n.setAttribute(c,m);break;case"onClick":m!=null&&(n.onclick=dn);break;case"onScroll":m!=null&&Mt("scroll",n);break;case"onScrollEnd":m!=null&&Mt("scrollend",n);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(E.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"multiple":n.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":n.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){n.removeAttribute("xlink:href");break}c=To(""+m),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""+m):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":m===!0?n.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,m):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?n.setAttribute(c,m):n.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?n.removeAttribute(c):n.setAttribute(c,m);break;case"popover":Mt("beforetoggle",n),Mt("toggle",n),Eo(n,"popover",m);break;case"xlinkActuate":fn(n,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":fn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":fn(n,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":fn(n,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":fn(n,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":fn(n,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":fn(n,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":fn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":fn(n,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Eo(n,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=kS.get(c)||c,Eo(n,c,m))}}function Nf(n,o,c,m,E,x){switch(c){case"style":pm(n,m,x);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(E.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"children":typeof m=="string"?sr(n,m):(typeof m=="number"||typeof m=="bigint")&&sr(n,""+m);break;case"onScroll":m!=null&&Mt("scroll",n);break;case"onScrollEnd":m!=null&&Mt("scrollend",n);break;case"onClick":m!=null&&(n.onclick=dn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!am.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(E=c.endsWith("Capture"),o=c.slice(2,E?c.length-7:void 0),x=n[We]||null,x=x!=null?x[c]:null,typeof x=="function"&&n.removeEventListener(o,x,E),typeof m=="function")){typeof x!="function"&&x!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(o,m,E);break t}c in n?n[c]=m:m===!0?n.setAttribute(c,""):Eo(n,c,m)}}}function Be(n,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",n),Mt("load",n);var m=!1,E=!1,x;for(x in c)if(c.hasOwnProperty(x)){var L=c[x];if(L!=null)switch(x){case"src":m=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Yt(n,o,x,L,c,null)}}E&&Yt(n,o,"srcSet",c.srcSet,c,null),m&&Yt(n,o,"src",c.src,c,null);return;case"input":Mt("invalid",n);var I=x=L=E=null,U=null,J=null;for(m in c)if(c.hasOwnProperty(m)){var rt=c[m];if(rt!=null)switch(m){case"name":E=rt;break;case"type":L=rt;break;case"checked":U=rt;break;case"defaultChecked":J=rt;break;case"value":x=rt;break;case"defaultValue":I=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(i(137,o));break;default:Yt(n,o,m,rt,c,null)}}fm(n,x,I,U,J,L,E,!1);return;case"select":Mt("invalid",n),m=L=x=null;for(E in c)if(c.hasOwnProperty(E)&&(I=c[E],I!=null))switch(E){case"value":x=I;break;case"defaultValue":L=I;break;case"multiple":m=I;default:Yt(n,o,E,I,c,null)}o=x,c=L,n.multiple=!!m,o!=null?nr(n,!!m,o,!1):c!=null&&nr(n,!!m,c,!0);return;case"textarea":Mt("invalid",n),x=E=m=null;for(L in c)if(c.hasOwnProperty(L)&&(I=c[L],I!=null))switch(L){case"value":m=I;break;case"defaultValue":E=I;break;case"children":x=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:Yt(n,o,L,I,c,null)}hm(n,m,E,x);return;case"option":for(U in c)if(c.hasOwnProperty(U)&&(m=c[U],m!=null))switch(U){case"selected":n.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Yt(n,o,U,m,c,null)}return;case"dialog":Mt("beforetoggle",n),Mt("toggle",n),Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":Mt("load",n);break;case"video":case"audio":for(m=0;m<Fa.length;m++)Mt(Fa[m],n);break;case"image":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"embed":case"source":case"link":Mt("error",n),Mt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in c)if(c.hasOwnProperty(J)&&(m=c[J],m!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Yt(n,o,J,m,c,null)}return;default:if(Xu(o)){for(rt in c)c.hasOwnProperty(rt)&&(m=c[rt],m!==void 0&&Nf(n,o,rt,m,c,void 0));return}}for(I in c)c.hasOwnProperty(I)&&(m=c[I],m!=null&&Yt(n,o,I,m,c,null))}function ab(n,o,c,m){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,x=null,L=null,I=null,U=null,J=null,rt=null;for(it in c){var lt=c[it];if(c.hasOwnProperty(it)&&lt!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":U=lt;default:m.hasOwnProperty(it)||Yt(n,o,it,null,m,lt)}}for(var et in m){var it=m[et];if(lt=c[et],m.hasOwnProperty(et)&&(it!=null||lt!=null))switch(et){case"type":x=it;break;case"name":E=it;break;case"checked":J=it;break;case"defaultChecked":rt=it;break;case"value":L=it;break;case"defaultValue":I=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(i(137,o));break;default:it!==lt&&Yt(n,o,et,it,m,lt)}}qu(n,L,I,U,J,rt,x,E);return;case"select":it=L=I=et=null;for(x in c)if(U=c[x],c.hasOwnProperty(x)&&U!=null)switch(x){case"value":break;case"multiple":it=U;default:m.hasOwnProperty(x)||Yt(n,o,x,null,m,U)}for(E in m)if(x=m[E],U=c[E],m.hasOwnProperty(E)&&(x!=null||U!=null))switch(E){case"value":et=x;break;case"defaultValue":I=x;break;case"multiple":L=x;default:x!==U&&Yt(n,o,E,x,m,U)}o=I,c=L,m=it,et!=null?nr(n,!!c,et,!1):!!m!=!!c&&(o!=null?nr(n,!!c,o,!0):nr(n,!!c,c?[]:"",!1));return;case"textarea":it=et=null;for(I in c)if(E=c[I],c.hasOwnProperty(I)&&E!=null&&!m.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:Yt(n,o,I,null,m,E)}for(L in m)if(E=m[L],x=c[L],m.hasOwnProperty(L)&&(E!=null||x!=null))switch(L){case"value":et=E;break;case"defaultValue":it=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:E!==x&&Yt(n,o,L,E,m,x)}dm(n,et,it);return;case"option":for(var gt in c)if(et=c[gt],c.hasOwnProperty(gt)&&et!=null&&!m.hasOwnProperty(gt))switch(gt){case"selected":n.selected=!1;break;default:Yt(n,o,gt,null,m,et)}for(U in m)if(et=m[U],it=c[U],m.hasOwnProperty(U)&&et!==it&&(et!=null||it!=null))switch(U){case"selected":n.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:Yt(n,o,U,et,m,it)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var St in c)et=c[St],c.hasOwnProperty(St)&&et!=null&&!m.hasOwnProperty(St)&&Yt(n,o,St,null,m,et);for(J in m)if(et=m[J],it=c[J],m.hasOwnProperty(J)&&et!==it&&(et!=null||it!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(i(137,o));break;default:Yt(n,o,J,et,m,it)}return;default:if(Xu(o)){for(var Xt in c)et=c[Xt],c.hasOwnProperty(Xt)&&et!==void 0&&!m.hasOwnProperty(Xt)&&Nf(n,o,Xt,void 0,m,et);for(rt in m)et=m[rt],it=c[rt],!m.hasOwnProperty(rt)||et===it||et===void 0&&it===void 0||Nf(n,o,rt,et,m,it);return}}for(var Y in c)et=c[Y],c.hasOwnProperty(Y)&&et!=null&&!m.hasOwnProperty(Y)&&Yt(n,o,Y,null,m,et);for(lt in m)et=m[lt],it=c[lt],!m.hasOwnProperty(lt)||et===it||et==null&&it==null||Yt(n,o,lt,et,m,it)}function g0(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ob(){if(typeof performance.getEntriesByType=="function"){for(var n=0,o=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var E=c[m],x=E.transferSize,L=E.initiatorType,I=E.duration;if(x&&I&&g0(L)){for(L=0,I=E.responseEnd,m+=1;m<c.length;m++){var U=c[m],J=U.startTime;if(J>I)break;var rt=U.transferSize,lt=U.initiatorType;rt&&g0(lt)&&(U=U.responseEnd,L+=rt*(U<I?1:(I-J)/(U-J)))}if(--m,o+=8*(x+L)/(E.duration/1e3),n++,10<n)break}}if(0<n)return o/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Ff=null,Bf=null;function yl(n){return n.nodeType===9?n:n.ownerDocument}function y0(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function v0(n,o){if(n===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&o==="foreignObject"?0:n}function Uf(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var $f=null;function lb(){var n=window.event;return n&&n.type==="popstate"?n===$f?!1:($f=n,!0):($f=null,!1)}var E0=typeof setTimeout=="function"?setTimeout:void 0,ub=typeof clearTimeout=="function"?clearTimeout:void 0,x0=typeof Promise=="function"?Promise:void 0,cb=typeof queueMicrotask=="function"?queueMicrotask:typeof x0<"u"?function(n){return x0.resolve(null).then(n).catch(fb)}:E0;function fb(n){setTimeout(function(){throw n})}function ns(n){return n==="head"}function S0(n,o){var c=o,m=0;do{var E=c.nextSibling;if(n.removeChild(c),E&&E.nodeType===8)if(c=E.data,c==="/$"||c==="/&"){if(m===0){n.removeChild(E),Pr(o);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")Ua(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Ua(c);for(var x=c.firstChild;x;){var L=x.nextSibling,I=x.nodeName;x[na]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=L}}else c==="body"&&Ua(n.ownerDocument.body);c=E}while(c);Pr(o)}function T0(n,o){var c=n;n=0;do{var m=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=m}while(c)}function jf(n){var o=n.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":jf(c),Vu(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function db(n,o,c,m){for(;n.nodeType===1;){var E=c;if(n.nodeName.toLowerCase()!==o.toLowerCase()){if(!m&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(m){if(!n[na])switch(o){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(x=n.getAttribute("rel"),x==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(x!==E.rel||n.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||n.getAttribute("title")!==(E.title==null?null:E.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(x=n.getAttribute("src"),(x!==(E.src==null?null:E.src)||n.getAttribute("type")!==(E.type==null?null:E.type)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&x&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(o==="input"&&n.type==="hidden"){var x=E.name==null?null:""+E.name;if(E.type==="hidden"&&n.getAttribute("name")===x)return n}else return n;if(n=Ci(n.nextSibling),n===null)break}return null}function hb(n,o,c){if(o==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=Ci(n.nextSibling),n===null))return null;return n}function b0(n,o){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Ci(n.nextSibling),n===null))return null;return n}function Gf(n){return n.data==="$?"||n.data==="$~"}function Hf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function mb(n,o){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=o;else if(n.data!=="$?"||c.readyState!=="loading")o();else{var m=function(){o(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),n._reactRetry=m}}function Ci(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return n}var zf=null;function A0(n){n=n.nextSibling;for(var o=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(o===0)return Ci(n.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}n=n.nextSibling}return null}function R0(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return n;o--}else c!=="/$"&&c!=="/&"||o++}n=n.previousSibling}return null}function L0(n,o,c){switch(o=yl(c),n){case"html":if(n=o.documentElement,!n)throw Error(i(452));return n;case"head":if(n=o.head,!n)throw Error(i(453));return n;case"body":if(n=o.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Ua(n){for(var o=n.attributes;o.length;)n.removeAttributeNode(o[0]);Vu(n)}var wi=new Map,_0=new Set;function vl(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Cn=G.d;G.d={f:pb,r:gb,D:yb,C:vb,L:Eb,m:xb,X:Tb,S:Sb,M:bb};function pb(){var n=Cn.f(),o=ul();return n||o}function gb(n){var o=tr(n);o!==null&&o.tag===5&&o.type==="form"?zp(o):Cn.r(n)}var Or=typeof document>"u"?null:document;function C0(n,o,c){var m=Or;if(m&&typeof o=="string"&&o){var E=Si(o);E='link[rel="'+n+'"][href="'+E+'"]',typeof c=="string"&&(E+='[crossorigin="'+c+'"]'),_0.has(E)||(_0.add(E),n={rel:n,crossOrigin:c,href:o},m.querySelector(E)===null&&(o=m.createElement("link"),Be(o,"link",n),we(o),m.head.appendChild(o)))}}function yb(n){Cn.D(n),C0("dns-prefetch",n,null)}function vb(n,o){Cn.C(n,o),C0("preconnect",n,o)}function Eb(n,o,c){Cn.L(n,o,c);var m=Or;if(m&&n&&o){var E='link[rel="preload"][as="'+Si(o)+'"]';o==="image"&&c&&c.imageSrcSet?(E+='[imagesrcset="'+Si(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(E+='[imagesizes="'+Si(c.imageSizes)+'"]')):E+='[href="'+Si(n)+'"]';var x=E;switch(o){case"style":x=kr(n);break;case"script":x=Mr(n)}wi.has(x)||(n=p({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:n,as:o},c),wi.set(x,n),m.querySelector(E)!==null||o==="style"&&m.querySelector($a(x))||o==="script"&&m.querySelector(ja(x))||(o=m.createElement("link"),Be(o,"link",n),we(o),m.head.appendChild(o)))}}function xb(n,o){Cn.m(n,o);var c=Or;if(c&&n){var m=o&&typeof o.as=="string"?o.as:"script",E='link[rel="modulepreload"][as="'+Si(m)+'"][href="'+Si(n)+'"]',x=E;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Mr(n)}if(!wi.has(x)&&(n=p({rel:"modulepreload",href:n},o),wi.set(x,n),c.querySelector(E)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ja(x)))return}m=c.createElement("link"),Be(m,"link",n),we(m),c.head.appendChild(m)}}}function Sb(n,o,c){Cn.S(n,o,c);var m=Or;if(m&&n){var E=er(m).hoistableStyles,x=kr(n);o=o||"default";var L=E.get(x);if(!L){var I={loading:0,preload:null};if(L=m.querySelector($a(x)))I.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":o},c),(c=wi.get(x))&&Vf(n,c);var U=L=m.createElement("link");we(U),Be(U,"link",n),U._p=new Promise(function(J,rt){U.onload=J,U.onerror=rt}),U.addEventListener("load",function(){I.loading|=1}),U.addEventListener("error",function(){I.loading|=2}),I.loading|=4,El(L,o,m)}L={type:"stylesheet",instance:L,count:1,state:I},E.set(x,L)}}}function Tb(n,o){Cn.X(n,o);var c=Or;if(c&&n){var m=er(c).hoistableScripts,E=Mr(n),x=m.get(E);x||(x=c.querySelector(ja(E)),x||(n=p({src:n,async:!0},o),(o=wi.get(E))&&Kf(n,o),x=c.createElement("script"),we(x),Be(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},m.set(E,x))}}function bb(n,o){Cn.M(n,o);var c=Or;if(c&&n){var m=er(c).hoistableScripts,E=Mr(n),x=m.get(E);x||(x=c.querySelector(ja(E)),x||(n=p({src:n,async:!0,type:"module"},o),(o=wi.get(E))&&Kf(n,o),x=c.createElement("script"),we(x),Be(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},m.set(E,x))}}function w0(n,o,c,m){var E=(E=dt.current)?vl(E):null;if(!E)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=kr(c.href),c=er(E).hoistableStyles,m=c.get(o),m||(m={type:"style",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=kr(c.href);var x=er(E).hoistableStyles,L=x.get(n);if(L||(E=E.ownerDocument||E,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(n,L),(x=E.querySelector($a(n)))&&!x._p&&(L.instance=x,L.state.loading=5),wi.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},wi.set(n,c),x||Ab(E,n,c,L.state))),o&&m===null)throw Error(i(528,""));return L}if(o&&m!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Mr(c),c=er(E).hoistableScripts,m=c.get(o),m||(m={type:"script",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function kr(n){return'href="'+Si(n)+'"'}function $a(n){return'link[rel="stylesheet"]['+n+"]"}function D0(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function Ab(n,o,c,m){n.querySelector('link[rel="preload"][as="style"]['+o+"]")?m.loading=1:(o=n.createElement("link"),m.preload=o,o.addEventListener("load",function(){return m.loading|=1}),o.addEventListener("error",function(){return m.loading|=2}),Be(o,"link",c),we(o),n.head.appendChild(o))}function Mr(n){return'[src="'+Si(n)+'"]'}function ja(n){return"script[async]"+n}function I0(n,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var m=n.querySelector('style[data-href~="'+Si(c.href)+'"]');if(m)return o.instance=m,we(m),m;var E=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(n.ownerDocument||n).createElement("style"),we(m),Be(m,"style",E),El(m,c.precedence,n),o.instance=m;case"stylesheet":E=kr(c.href);var x=n.querySelector($a(E));if(x)return o.state.loading|=4,o.instance=x,we(x),x;m=D0(c),(E=wi.get(E))&&Vf(m,E),x=(n.ownerDocument||n).createElement("link"),we(x);var L=x;return L._p=new Promise(function(I,U){L.onload=I,L.onerror=U}),Be(x,"link",m),o.state.loading|=4,El(x,c.precedence,n),o.instance=x;case"script":return x=Mr(c.src),(E=n.querySelector(ja(x)))?(o.instance=E,we(E),E):(m=c,(E=wi.get(x))&&(m=p({},c),Kf(m,E)),n=n.ownerDocument||n,E=n.createElement("script"),we(E),Be(E,"link",m),n.head.appendChild(E),o.instance=E);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(m=o.instance,o.state.loading|=4,El(m,c.precedence,n));return o.instance}function El(n,o,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=m.length?m[m.length-1]:null,x=E,L=0;L<m.length;L++){var I=m[L];if(I.dataset.precedence===o)x=I;else if(x!==E)break}x?x.parentNode.insertBefore(n,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(n,o.firstChild))}function Vf(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.title==null&&(n.title=o.title)}function Kf(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.integrity==null&&(n.integrity=o.integrity)}var xl=null;function O0(n,o,c){if(xl===null){var m=new Map,E=xl=new Map;E.set(c,m)}else E=xl,m=E.get(c),m||(m=new Map,E.set(c,m));if(m.has(n))return m;for(m.set(n,null),c=c.getElementsByTagName(n),E=0;E<c.length;E++){var x=c[E];if(!(x[na]||x[Me]||n==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var L=x.getAttribute(o)||"";L=n+L;var I=m.get(L);I?I.push(x):m.set(L,[x])}}return m}function k0(n,o,c){n=n.ownerDocument||n,n.head.insertBefore(c,o==="title"?n.querySelector("head > title"):null)}function Rb(n,o,c){if(c===1||o.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return n=o.disabled,typeof o.precedence=="string"&&n==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function M0(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function Lb(n,o,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var E=kr(m.href),x=o.querySelector($a(E));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(n.count++,n=Sl.bind(n),o.then(n,n)),c.state.loading|=4,c.instance=x,we(x);return}x=o.ownerDocument||o,m=D0(m),(E=wi.get(E))&&Vf(m,E),x=x.createElement("link"),we(x);var L=x;L._p=new Promise(function(I,U){L.onload=I,L.onerror=U}),Be(x,"link",m),c.instance=x}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=Sl.bind(n),o.addEventListener("load",c),o.addEventListener("error",c))}}var qf=0;function _b(n,o){return n.stylesheets&&n.count===0&&bl(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var m=setTimeout(function(){if(n.stylesheets&&bl(n,n.stylesheets),n.unsuspend){var x=n.unsuspend;n.unsuspend=null,x()}},6e4+o);0<n.imgBytes&&qf===0&&(qf=62500*ob());var E=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&bl(n,n.stylesheets),n.unsuspend)){var x=n.unsuspend;n.unsuspend=null,x()}},(n.imgBytes>qf?50:800)+o);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(m),clearTimeout(E)}}:null}function Sl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bl(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Tl=null;function bl(n,o){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Tl=new Map,o.forEach(Cb,n),Tl=null,Sl.call(n))}function Cb(n,o){if(!(o.state.loading&4)){var c=Tl.get(n);if(c)var m=c.get(null);else{c=new Map,Tl.set(n,c);for(var E=n.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<E.length;x++){var L=E[x];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(c.set(L.dataset.precedence,L),m=L)}m&&c.set(null,m)}E=o.instance,L=E.getAttribute("data-precedence"),x=c.get(L)||m,x===m&&c.set(null,E),c.set(L,E),this.count++,m=Sl.bind(this),E.addEventListener("load",m),E.addEventListener("error",m),x?x.parentNode.insertBefore(E,x.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(E,n.firstChild)),o.state.loading|=4}}var Ga={$$typeof:R,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function wb(n,o,c,m,E,x,L,I,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ju(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.hiddenUpdates=ju(null),this.identifierPrefix=m,this.onUncaughtError=E,this.onCaughtError=x,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function P0(n,o,c,m,E,x,L,I,U,J,rt,lt){return n=new wb(n,o,c,L,U,J,rt,lt,I),o=1,x===!0&&(o|=24),x=ai(3,null,null,o),n.current=x,x.stateNode=n,o=Rc(),o.refCount++,n.pooledCache=o,o.refCount++,x.memoizedState={element:m,isDehydrated:c,cache:o},wc(x),n}function N0(n){return n?(n=fr,n):fr}function F0(n,o,c,m,E,x){E=N0(E),m.context===null?m.context=E:m.pendingContext=E,m=Kn(o),m.payload={element:c},x=x===void 0?null:x,x!==null&&(m.callback=x),c=qn(n,m,o),c!==null&&(ii(c,n,o),xa(c,n,o))}function B0(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<o?c:o}}function Yf(n,o){B0(n,o),(n=n.alternate)&&B0(n,o)}function U0(n){if(n.tag===13||n.tag===31){var o=Rs(n,67108864);o!==null&&ii(o,n,67108864),Yf(n,67108864)}}function $0(n){if(n.tag===13||n.tag===31){var o=fi();o=Gu(o);var c=Rs(n,o);c!==null&&ii(c,n,o),Yf(n,o)}}var Al=!0;function Db(n,o,c,m){var E=O.T;O.T=null;var x=G.p;try{G.p=2,Xf(n,o,c,m)}finally{G.p=x,O.T=E}}function Ib(n,o,c,m){var E=O.T;O.T=null;var x=G.p;try{G.p=8,Xf(n,o,c,m)}finally{G.p=x,O.T=E}}function Xf(n,o,c,m){if(Al){var E=Wf(m);if(E===null)Pf(n,o,m,Rl,c),G0(n,m);else if(kb(E,n,o,c,m))m.stopPropagation();else if(G0(n,m),o&4&&-1<Ob.indexOf(n)){for(;E!==null;){var x=tr(E);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var L=xs(x.pendingLanes);if(L!==0){var I=x;for(I.pendingLanes|=2,I.entangledLanes|=2;L;){var U=1<<31-Ve(L);I.entanglements[1]|=U,L&=~U}Vi(x),(jt&6)===0&&(ol=ne()+500,Na(0))}}break;case 31:case 13:I=Rs(x,2),I!==null&&ii(I,x,2),ul(),Yf(x,2)}if(x=Wf(m),x===null&&Pf(n,o,m,Rl,c),x===E)break;E=x}E!==null&&m.stopPropagation()}else Pf(n,o,m,null,c)}}function Wf(n){return n=Qu(n),Qf(n)}var Rl=null;function Qf(n){if(Rl=null,n=Js(n),n!==null){var o=a(n);if(o===null)n=null;else{var c=o.tag;if(c===13){if(n=l(o),n!==null)return n;n=null}else if(c===31){if(n=u(o),n!==null)return n;n=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}return Rl=n,null}function j0(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(un()){case Xe:return 2;case ys:return 8;case Bn:case Qs:return 32;case vs:return 268435456;default:return 32}default:return 32}}var Zf=!1,ss=null,rs=null,as=null,Ha=new Map,za=new Map,os=[],Ob="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function G0(n,o){switch(n){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":Ha.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":za.delete(o.pointerId)}}function Va(n,o,c,m,E,x){return n===null||n.nativeEvent!==x?(n={blockedOn:o,domEventName:c,eventSystemFlags:m,nativeEvent:x,targetContainers:[E]},o!==null&&(o=tr(o),o!==null&&U0(o)),n):(n.eventSystemFlags|=m,o=n.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),n)}function kb(n,o,c,m,E){switch(o){case"focusin":return ss=Va(ss,n,o,c,m,E),!0;case"dragenter":return rs=Va(rs,n,o,c,m,E),!0;case"mouseover":return as=Va(as,n,o,c,m,E),!0;case"pointerover":var x=E.pointerId;return Ha.set(x,Va(Ha.get(x)||null,n,o,c,m,E)),!0;case"gotpointercapture":return x=E.pointerId,za.set(x,Va(za.get(x)||null,n,o,c,m,E)),!0}return!1}function H0(n){var o=Js(n.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){n.blockedOn=o,nm(n.priority,function(){$0(c)});return}}else if(o===31){if(o=u(c),o!==null){n.blockedOn=o,nm(n.priority,function(){$0(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ll(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var c=Wf(n.nativeEvent);if(c===null){c=n.nativeEvent;var m=new c.constructor(c.type,c);Wu=m,c.target.dispatchEvent(m),Wu=null}else return o=tr(c),o!==null&&U0(o),n.blockedOn=c,!1;o.shift()}return!0}function z0(n,o,c){Ll(n)&&c.delete(o)}function Mb(){Zf=!1,ss!==null&&Ll(ss)&&(ss=null),rs!==null&&Ll(rs)&&(rs=null),as!==null&&Ll(as)&&(as=null),Ha.forEach(z0),za.forEach(z0)}function _l(n,o){n.blockedOn===o&&(n.blockedOn=null,Zf||(Zf=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Mb)))}var Cl=null;function V0(n){Cl!==n&&(Cl=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Cl===n&&(Cl=null);for(var o=0;o<n.length;o+=3){var c=n[o],m=n[o+1],E=n[o+2];if(typeof m!="function"){if(Qf(m||c)===null)continue;break}var x=tr(c);x!==null&&(n.splice(o,3),o-=3,Xc(x,{pending:!0,data:E,method:c.method,action:m},m,E))}}))}function Pr(n){function o(U){return _l(U,n)}ss!==null&&_l(ss,n),rs!==null&&_l(rs,n),as!==null&&_l(as,n),Ha.forEach(o),za.forEach(o);for(var c=0;c<os.length;c++){var m=os[c];m.blockedOn===n&&(m.blockedOn=null)}for(;0<os.length&&(c=os[0],c.blockedOn===null);)H0(c),c.blockedOn===null&&os.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var E=c[m],x=c[m+1],L=E[We]||null;if(typeof x=="function")L||V0(c);else if(L){var I=null;if(x&&x.hasAttribute("formAction")){if(E=x,L=x[We]||null)I=L.formAction;else if(Qf(E)!==null)continue}else I=L.action;typeof I=="function"?c[m+1]=I:(c.splice(m,3),m-=3),V0(c)}}}function K0(){function n(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(L){return E=L})},focusReset:"manual",scroll:"manual"})}function o(){E!==null&&(E(),E=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,E=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),E!==null&&(E(),E=null)}}}function Jf(n){this._internalRoot=n}wl.prototype.render=Jf.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,m=fi();F0(c,m,n,o,null,null)},wl.prototype.unmount=Jf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;F0(n.current,2,null,n,null,null),ul(),o[Zs]=null}};function wl(n){this._internalRoot=n}wl.prototype.unstable_scheduleHydration=function(n){if(n){var o=im();n={blockedOn:null,target:n,priority:o};for(var c=0;c<os.length&&o!==0&&o<os[c].priority;c++);os.splice(c,0,n),c===0&&H0(n)}};var q0=t.version;if(q0!=="19.2.0")throw Error(i(527,q0,"19.2.0"));G.findDOMNode=function(n){var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(o),n=n!==null?h(n):null,n=n===null?null:n.stateNode,n};var Pb={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dl.isDisabled&&Dl.supportsFiber)try{Es=Dl.inject(Pb),ze=Dl}catch{}}return qa.createRoot=function(n,o){if(!s(n))throw Error(i(299));var c=!1,m="",E=tg,x=eg,L=ig;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(E=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError)),o=P0(n,1,!1,null,null,c,m,null,E,x,L,K0),n[Zs]=o.current,Mf(n),new Jf(o)},qa.hydrateRoot=function(n,o,c){if(!s(n))throw Error(i(299));var m=!1,E="",x=tg,L=eg,I=ig,U=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(I=c.onRecoverableError),c.formState!==void 0&&(U=c.formState)),o=P0(n,1,!0,o,c??null,m,E,U,x,L,I,K0),o.context=N0(null),c=o.current,m=fi(),m=Gu(m),E=Kn(m),E.callback=null,qn(c,E,m),c=m,o.current.lanes=c,ia(o,c),Vi(o),n[Zs]=o.current,Mf(n),new wl(o)},qa.version="19.2.0",qa}var ny;function Yb(){if(ny)return id.exports;ny=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),id.exports=qb(),id.exports}var Xb=Yb();function Wb({children:r}){return r}/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var sy="popstate";function Qb(r={}){function t(i,s){let{pathname:a,search:l,hash:u}=i.location;return Bd("",{pathname:a,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(i,s){return typeof s=="string"?s:to(s)}return Jb(t,e,null,r)}function oe(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function en(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Zb(){return Math.random().toString(36).substring(2,10)}function ry(r,t){return{usr:r.state,key:r.key,idx:t}}function Bd(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Wr(t):t,state:e,key:t&&t.key||i||Zb()}}function to({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Wr(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function Jb(r,t,e,i={}){let{window:s=document.defaultView,v5Compat:a=!1}=i,l=s.history,u="POP",d=null,f=h();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function h(){return(l.state||{idx:null}).idx}function p(){u="POP";let T=h(),A=T==null?null:T-f;f=T,d&&d({action:u,location:S.location,delta:A})}function g(T,A){u="PUSH";let b=Bd(S.location,T,A);f=h()+1;let R=ry(b,f),C=S.createHref(b);try{l.pushState(R,"",C)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(C)}a&&d&&d({action:u,location:S.location,delta:1})}function v(T,A){u="REPLACE";let b=Bd(S.location,T,A);f=h();let R=ry(b,f),C=S.createHref(b);l.replaceState(R,"",C),a&&d&&d({action:u,location:S.location,delta:0})}function y(T){return t1(T)}let S={get action(){return u},get location(){return r(s,l)},listen(T){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(sy,p),d=T,()=>{s.removeEventListener(sy,p),d=null}},createHref(T){return t(s,T)},createURL:y,encodeLocation(T){let A=y(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:g,replace:v,go(T){return l.go(T)}};return S}function t1(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),oe(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:to(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function zv(r,t,e="/"){return e1(r,t,e,!1)}function e1(r,t,e,i){let s=typeof t=="string"?Wr(t):t,a=Pn(s.pathname||"/",e);if(a==null)return null;let l=Vv(r);i1(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let f=h1(a);u=f1(l[d],f,i)}return u}function Vv(r,t=[],e=[],i="",s=!1){let a=(l,u,d=s,f)=>{let h={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(i)&&d)return;oe(h.relativePath.startsWith(i),`Absolute route path "${h.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(i.length)}let p=Mn([i,h.relativePath]),g=e.concat(h);l.children&&l.children.length>0&&(oe(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Vv(l.children,t,g,p,d)),!(l.path==null&&!l.index)&&t.push({path:p,score:u1(p,l.index),routesMeta:g})};return r.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))a(l,u);else for(let d of Kv(l.path))a(l,u,!0,d)}),t}function Kv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,s=e.endsWith("?"),a=e.replace(/\?$/,"");if(i.length===0)return s?[a,""]:[a];let l=Kv(i.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&u.push(...l),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function i1(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:c1(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var n1=/^:[\w-]+$/,s1=3,r1=2,a1=1,o1=10,l1=-2,ay=r=>r==="*";function u1(r,t){let e=r.split("/"),i=e.length;return e.some(ay)&&(i+=l1),t&&(i+=r1),e.filter(s=>!ay(s)).reduce((s,a)=>s+(n1.test(a)?s1:a===""?a1:o1),i)}function c1(r,t){return r.length===t.length&&r.slice(0,-1).every((i,s)=>i===t[s])?r[r.length-1]-t[t.length-1]:0}function f1(r,t,e=!1){let{routesMeta:i}=r,s={},a="/",l=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,h=a==="/"?t:t.slice(a.length)||"/",p=ou({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},h),g=d.route;if(!p&&f&&e&&!i[i.length-1].route.index&&(p=ou({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),l.push({params:s,pathname:Mn([a,p.pathname]),pathnameBase:y1(Mn([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=Mn([a,p.pathnameBase]))}return l}function ou(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=d1(r.path,r.caseSensitive,r.end),s=t.match(e);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:i.reduce((f,{paramName:h,isOptional:p},g)=>{if(h==="*"){let y=u[g]||"";l=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const v=u[g];return p&&!v?f[h]=void 0:f[h]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:r}}function d1(r,t=!1,e=!0){en(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),i]}function h1(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return en(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function Pn(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}function m1(r,t="/"){let{pathname:e,search:i="",hash:s=""}=typeof r=="string"?Wr(r):r;return{pathname:e?e.startsWith("/")?e:p1(e,t):t,search:v1(i),hash:E1(s)}}function p1(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function ad(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function g1(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function qv(r){let t=g1(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function Yv(r,t,e,i=!1){let s;typeof r=="string"?s=Wr(r):(s={...r},oe(!s.pathname||!s.pathname.includes("?"),ad("?","pathname","search",s)),oe(!s.pathname||!s.pathname.includes("#"),ad("#","pathname","hash",s)),oe(!s.search||!s.search.includes("#"),ad("#","search","hash",s)));let a=r===""||s.pathname==="",l=a?"/":s.pathname,u;if(l==null)u=e;else{let p=t.length-1;if(!i&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}u=p>=0?t[p]:"/"}let d=m1(s,u),f=l&&l!=="/"&&l.endsWith("/"),h=(a||l===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||h)&&(d.pathname+="/"),d}var Mn=r=>r.join("/").replace(/\/\/+/g,"/"),y1=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),v1=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,E1=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function x1(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var Xv=["POST","PUT","PATCH","DELETE"];new Set(Xv);var S1=["GET",...Xv];new Set(S1);var Qr=F.createContext(null);Qr.displayName="DataRouter";var Ru=F.createContext(null);Ru.displayName="DataRouterState";F.createContext(!1);var Wv=F.createContext({isTransitioning:!1});Wv.displayName="ViewTransition";var T1=F.createContext(new Map);T1.displayName="Fetchers";var b1=F.createContext(null);b1.displayName="Await";var an=F.createContext(null);an.displayName="Navigation";var co=F.createContext(null);co.displayName="Location";var on=F.createContext({outlet:null,matches:[],isDataRoute:!1});on.displayName="Route";var fh=F.createContext(null);fh.displayName="RouteError";function A1(r,{relative:t}={}){oe(fo(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=F.useContext(an),{hash:s,pathname:a,search:l}=ho(r,{relative:t}),u=a;return e!=="/"&&(u=a==="/"?e:Mn([e,a])),i.createHref({pathname:u,search:l,hash:s})}function fo(){return F.useContext(co)!=null}function Ys(){return oe(fo(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(co).location}var Qv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Zv(r){F.useContext(an).static||F.useLayoutEffect(r)}function R1(){let{isDataRoute:r}=F.useContext(on);return r?U1():L1()}function L1(){oe(fo(),"useNavigate() may be used only in the context of a <Router> component.");let r=F.useContext(Qr),{basename:t,navigator:e}=F.useContext(an),{matches:i}=F.useContext(on),{pathname:s}=Ys(),a=JSON.stringify(qv(i)),l=F.useRef(!1);return Zv(()=>{l.current=!0}),F.useCallback((d,f={})=>{if(en(l.current,Qv),!l.current)return;if(typeof d=="number"){e.go(d);return}let h=Yv(d,JSON.parse(a),s,f.relative==="path");r==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Mn([t,h.pathname])),(f.replace?e.replace:e.push)(h,f.state,f)},[t,e,a,s,r])}F.createContext(null);function _1(){let{matches:r}=F.useContext(on),t=r[r.length-1];return t?t.params:{}}function ho(r,{relative:t}={}){let{matches:e}=F.useContext(on),{pathname:i}=Ys(),s=JSON.stringify(qv(e));return F.useMemo(()=>Yv(r,JSON.parse(s),i,t==="path"),[r,s,i,t])}function C1(r,t){return Jv(r,t)}function Jv(r,t,e,i,s){oe(fo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=F.useContext(an),{matches:l}=F.useContext(on),u=l[l.length-1],d=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",p=u&&u.route;{let b=p&&p.path||"";tE(f,!p||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let g=Ys(),v;if(t){let b=typeof t=="string"?Wr(t):t;oe(h==="/"||b.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${b.pathname}" was given in the \`location\` prop.`),v=b}else v=g;let y=v.pathname||"/",S=y;if(h!=="/"){let b=h.replace(/^\//,"").split("/");S="/"+y.replace(/^\//,"").split("/").slice(b.length).join("/")}let T=zv(r,{pathname:S});en(p||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),en(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=k1(T&&T.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:Mn([h,a.encodeLocation?a.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:Mn([h,a.encodeLocation?a.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),l,e,i,s);return t&&A?F.createElement(co.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},A):A}function w1(){let r=B1(),t=x1(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",r),l=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:a},"ErrorBoundary")," or"," ",F.createElement("code",{style:a},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},t),e?F.createElement("pre",{style:s},e):null,l)}var D1=F.createElement(w1,null),I1=class extends F.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.unstable_onError?this.props.unstable_onError(r,t):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?F.createElement(on.Provider,{value:this.props.routeContext},F.createElement(fh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function O1({routeContext:r,match:t,children:e}){let i=F.useContext(Qr);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),F.createElement(on.Provider,{value:r},e)}function k1(r,t=[],e=null,i=null,s=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,l=e?.errors;if(l!=null){let f=a.findIndex(h=>h.route.id&&l?.[h.route.id]!==void 0);oe(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(e)for(let f=0;f<a.length;f++){let h=a[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=f),h.route.id){let{loaderData:p,errors:g}=e,v=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||v){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,h,p)=>{let g,v=!1,y=null,S=null;e&&(g=l&&h.route.id?l[h.route.id]:void 0,y=h.route.errorElement||D1,u&&(d<0&&p===0?(tE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,S=null):d===p&&(v=!0,S=h.route.hydrateFallbackElement||null)));let T=t.concat(a.slice(0,p+1)),A=()=>{let b;return g?b=y:v?b=S:h.route.Component?b=F.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=f,F.createElement(O1,{match:h,routeContext:{outlet:f,matches:T,isDataRoute:e!=null},children:b})};return e&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?F.createElement(I1,{location:e.location,revalidation:e.revalidation,component:y,error:g,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:i}):A()},null)}function dh(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function M1(r){let t=F.useContext(Qr);return oe(t,dh(r)),t}function P1(r){let t=F.useContext(Ru);return oe(t,dh(r)),t}function N1(r){let t=F.useContext(on);return oe(t,dh(r)),t}function hh(r){let t=N1(r),e=t.matches[t.matches.length-1];return oe(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function F1(){return hh("useRouteId")}function B1(){let r=F.useContext(fh),t=P1("useRouteError"),e=hh("useRouteError");return r!==void 0?r:t.errors?.[e]}function U1(){let{router:r}=M1("useNavigate"),t=hh("useNavigate"),e=F.useRef(!1);return Zv(()=>{e.current=!0}),F.useCallback(async(s,a={})=>{en(e.current,Qv),e.current&&(typeof s=="number"?r.navigate(s):await r.navigate(s,{fromRouteId:t,...a}))},[r,t])}var oy={};function tE(r,t,e){!t&&!oy[r]&&(oy[r]=!0,en(!1,e))}F.memo($1);function $1({routes:r,future:t,state:e,unstable_onError:i}){return Jv(r,void 0,e,i,t)}function eE(r){oe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function j1({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:s,static:a=!1}){oe(!fo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),u=F.useMemo(()=>({basename:l,navigator:s,static:a,future:{}}),[l,s,a]);typeof e=="string"&&(e=Wr(e));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:g="default"}=e,v=F.useMemo(()=>{let y=Pn(d,l);return y==null?null:{location:{pathname:y,search:f,hash:h,state:p,key:g},navigationType:i}},[l,d,f,h,p,g,i]);return en(v!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:F.createElement(an.Provider,{value:u},F.createElement(co.Provider,{children:t,value:v}))}function G1({children:r,location:t}){return C1(Ud(r),t)}function Ud(r,t=[]){let e=[];return F.Children.forEach(r,(i,s)=>{if(!F.isValidElement(i))return;let a=[...t,s];if(i.type===F.Fragment){e.push.apply(e,Ud(i.props.children,a));return}oe(i.type===eE,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),oe(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=Ud(i.props.children,a)),e.push(l)}),e}var Wl="get",Ql="application/x-www-form-urlencoded";function Lu(r){return r!=null&&typeof r.tagName=="string"}function H1(r){return Lu(r)&&r.tagName.toLowerCase()==="button"}function z1(r){return Lu(r)&&r.tagName.toLowerCase()==="form"}function V1(r){return Lu(r)&&r.tagName.toLowerCase()==="input"}function K1(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function q1(r,t){return r.button===0&&(!t||t==="_self")&&!K1(r)}var Il=null;function Y1(){if(Il===null)try{new FormData(document.createElement("form"),0),Il=!1}catch{Il=!0}return Il}var X1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function od(r){return r!=null&&!X1.has(r)?(en(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ql}"`),null):r}function W1(r,t){let e,i,s,a,l;if(z1(r)){let u=r.getAttribute("action");i=u?Pn(u,t):null,e=r.getAttribute("method")||Wl,s=od(r.getAttribute("enctype"))||Ql,a=new FormData(r)}else if(H1(r)||V1(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?Pn(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Wl,s=od(r.getAttribute("formenctype"))||od(u.getAttribute("enctype"))||Ql,a=new FormData(u,r),!Y1()){let{name:f,type:h,value:p}=r;if(h==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,p)}}else{if(Lu(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Wl,i=null,s=Ql,l=r}return a&&s==="text/plain"&&(l=a,a=void 0),{action:i,method:e.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function mh(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Q1(r,t,e){let i=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return i.pathname==="/"?i.pathname=`_root.${e}`:t&&Pn(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${e}`,i}async function Z1(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function J1(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function tA(r,t,e){let i=await Promise.all(r.map(async s=>{let a=t.routes[s.route.id];if(a){let l=await Z1(a,e);return l.links?l.links():[]}return[]}));return sA(i.flat(1).filter(J1).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ly(r,t,e,i,s,a){let l=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return a==="assets"?t.filter((d,f)=>l(d,f)||u(d,f)):a==="data"?t.filter((d,f)=>{let h=i.routes[d.route.id];if(!h||!h.hasLoader)return!1;if(l(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function eA(r,t,{includeHydrateFallback:e}={}){return iA(r.map(i=>{let s=t.routes[i.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function iA(r){return[...new Set(r)]}function nA(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function sA(r,t){let e=new Set;return new Set(t),r.reduce((i,s)=>{let a=JSON.stringify(nA(s));return e.has(a)||(e.add(a),i.push({key:a,link:s})),i},[])}function iE(){let r=F.useContext(Qr);return mh(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function rA(){let r=F.useContext(Ru);return mh(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var ph=F.createContext(void 0);ph.displayName="FrameworkContext";function nE(){let r=F.useContext(ph);return mh(r,"You must render this element inside a <HydratedRouter> element"),r}function aA(r,t){let e=F.useContext(ph),[i,s]=F.useState(!1),[a,l]=F.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=t,g=F.useRef(null);F.useEffect(()=>{if(r==="render"&&l(!0),r==="viewport"){let S=A=>{A.forEach(b=>{l(b.isIntersecting)})},T=new IntersectionObserver(S,{threshold:.5});return g.current&&T.observe(g.current),()=>{T.disconnect()}}},[r]),F.useEffect(()=>{if(i){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[i]);let v=()=>{s(!0)},y=()=>{s(!1),l(!1)};return e?r!=="intent"?[a,g,{}]:[a,g,{onFocus:Ya(u,v),onBlur:Ya(d,y),onMouseEnter:Ya(f,v),onMouseLeave:Ya(h,y),onTouchStart:Ya(p,v)}]:[!1,g,{}]}function Ya(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function oA({page:r,...t}){let{router:e}=iE(),i=F.useMemo(()=>zv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?F.createElement(uA,{page:r,matches:i,...t}):null}function lA(r){let{manifest:t,routeModules:e}=nE(),[i,s]=F.useState([]);return F.useEffect(()=>{let a=!1;return tA(r,t,e).then(l=>{a||s(l)}),()=>{a=!0}},[r,t,e]),i}function uA({page:r,matches:t,...e}){let i=Ys(),{manifest:s,routeModules:a}=nE(),{basename:l}=iE(),{loaderData:u,matches:d}=rA(),f=F.useMemo(()=>ly(r,t,d,s,i,"data"),[r,t,d,s,i]),h=F.useMemo(()=>ly(r,t,d,s,i,"assets"),[r,t,d,s,i]),p=F.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let y=new Set,S=!1;if(t.forEach(A=>{let b=s.routes[A.route.id];!b||!b.hasLoader||(!f.some(R=>R.route.id===A.route.id)&&A.route.id in u&&a[A.route.id]?.shouldRevalidate||b.hasClientLoader?S=!0:y.add(A.route.id))}),y.size===0)return[];let T=Q1(r,l,"data");return S&&y.size>0&&T.searchParams.set("_routes",t.filter(A=>y.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[l,u,i,s,f,t,r,a]),g=F.useMemo(()=>eA(h,s),[h,s]),v=lA(h);return F.createElement(F.Fragment,null,p.map(y=>F.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...e})),g.map(y=>F.createElement("link",{key:y,rel:"modulepreload",href:y,...e})),v.map(({key:y,link:S})=>F.createElement("link",{key:y,nonce:e.nonce,...S})))}function cA(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var sE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sE&&(window.__reactRouterVersion="7.9.4")}catch{}function fA({basename:r,children:t,window:e}){let i=F.useRef();i.current==null&&(i.current=Qb({window:e,v5Compat:!0}));let s=i.current,[a,l]=F.useState({action:s.action,location:s.location}),u=F.useCallback(d=>{F.startTransition(()=>l(d))},[l]);return F.useLayoutEffect(()=>s.listen(u),[s,u]),F.createElement(j1,{basename:r,children:t,location:a.location,navigationType:a.action,navigator:s})}var rE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,me=F.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:s,reloadDocument:a,replace:l,state:u,target:d,to:f,preventScrollReset:h,viewTransition:p,...g},v){let{basename:y}=F.useContext(an),S=typeof f=="string"&&rE.test(f),T,A=!1;if(typeof f=="string"&&S&&(T=f,sE))try{let B=new URL(window.location.href),M=f.startsWith("//")?new URL(B.protocol+f):new URL(f),q=Pn(M.pathname,y);M.origin===B.origin&&q!=null?f=q+M.search+M.hash:A=!0}catch{en(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=A1(f,{relative:s}),[R,C,D]=aA(i,g),N=pA(f,{replace:l,state:u,target:d,preventScrollReset:h,relative:s,viewTransition:p});function w(B){t&&t(B),B.defaultPrevented||N(B)}let P=F.createElement("a",{...g,...D,href:T||b,onClick:A||a?t:w,ref:cA(v,C),target:d,"data-discover":!S&&e==="render"?"true":void 0});return R&&!S?F.createElement(F.Fragment,null,P,F.createElement(oA,{page:b})):P});me.displayName="Link";var dA=F.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:s=!1,style:a,to:l,viewTransition:u,children:d,...f},h){let p=ho(l,{relative:f.relative}),g=Ys(),v=F.useContext(Ru),{navigator:y,basename:S}=F.useContext(an),T=v!=null&&xA(p)&&u===!0,A=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,b=g.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(b=b.toLowerCase(),R=R?R.toLowerCase():null,A=A.toLowerCase()),R&&S&&(R=Pn(R,S)||R);const C=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let D=b===A||!s&&b.startsWith(A)&&b.charAt(C)==="/",N=R!=null&&(R===A||!s&&R.startsWith(A)&&R.charAt(A.length)==="/"),w={isActive:D,isPending:N,isTransitioning:T},P=D?t:void 0,B;typeof i=="function"?B=i(w):B=[i,D?"active":null,N?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(w):a;return F.createElement(me,{...f,"aria-current":P,className:B,ref:h,style:M,to:l,viewTransition:u},typeof d=="function"?d(w):d)});dA.displayName="NavLink";var hA=F.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:s,state:a,method:l=Wl,action:u,onSubmit:d,relative:f,preventScrollReset:h,viewTransition:p,...g},v)=>{let y=vA(),S=EA(u,{relative:f}),T=l.toLowerCase()==="get"?"get":"post",A=typeof u=="string"&&rE.test(u),b=R=>{if(d&&d(R),R.defaultPrevented)return;R.preventDefault();let C=R.nativeEvent.submitter,D=C?.getAttribute("formmethod")||l;y(C||R.currentTarget,{fetcherKey:t,method:D,navigate:e,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:p})};return F.createElement("form",{ref:v,method:T,action:S,onSubmit:i?d:b,...g,"data-discover":!A&&r==="render"?"true":void 0})});hA.displayName="Form";function mA(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aE(r){let t=F.useContext(Qr);return oe(t,mA(r)),t}function pA(r,{target:t,replace:e,state:i,preventScrollReset:s,relative:a,viewTransition:l}={}){let u=R1(),d=Ys(),f=ho(r,{relative:a});return F.useCallback(h=>{if(q1(h,t)){h.preventDefault();let p=e!==void 0?e:to(d)===to(f);u(r,{replace:p,state:i,preventScrollReset:s,relative:a,viewTransition:l})}},[d,u,f,e,i,t,r,s,a,l])}var gA=0,yA=()=>`__${String(++gA)}__`;function vA(){let{router:r}=aE("useSubmit"),{basename:t}=F.useContext(an),e=F1();return F.useCallback(async(i,s={})=>{let{action:a,method:l,encType:u,formData:d,body:f}=W1(i,t);if(s.navigate===!1){let h=s.fetcherKey||yA();await r.fetch(h,e,s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:f,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await r.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:f,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,t,e])}function EA(r,{relative:t}={}){let{basename:e}=F.useContext(an),i=F.useContext(on);oe(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),a={...ho(r||".",{relative:t})},l=Ys();if(r==null){a.search=l.search;let u=new URLSearchParams(a.search),d=u.getAll("index");if(d.some(h=>h==="")){u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let h=u.toString();a.search=h?`?${h}`:""}}return(!r||r===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:Mn([e,a.pathname])),to(a)}function xA(r,{relative:t}={}){let e=F.useContext(Wv);oe(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=aE("useViewTransitionState"),s=ho(r,{relative:t});if(!e.isTransitioning)return!1;let a=Pn(e.currentLocation.pathname,i)||e.currentLocation.pathname,l=Pn(e.nextLocation.pathname,i)||e.nextLocation.pathname;return ou(s.pathname,l)!=null||ou(s.pathname,a)!=null}var gh=Hv();const SA=uh(gh);var ld={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var uy;function TA(){return uy||(uy=1,(function(r){(function(){var t={}.hasOwnProperty;function e(){for(var a="",l=0;l<arguments.length;l++){var u=arguments[l];u&&(a=s(a,i.call(this,u)))}return a}function i(a){if(typeof a=="string"||typeof a=="number")return this&&this[a]||a;if(typeof a!="object")return"";if(Array.isArray(a))return e.apply(this,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var l="";for(var u in a)t.call(a,u)&&a[u]&&(l=s(l,this&&this[u]||u));return l}function s(a,l){return l?a?a+" "+l:a+l:a}r.exports?(e.default=e,r.exports=e):window.classNames=e})()})(ld)),ld.exports}var bA=TA();const Xs=uh(bA),AA="_slide_1o53q_1",RA={slide:AA,"slide-title":"_slide-title_1o53q_7","title-text":"_title-text_1o53q_16","title-info":"_title-info_1o53q_23","slide-wrapper":"_slide-wrapper_1o53q_43","slide-content":"_slide-content_1o53q_49","slide-group":"_slide-group_1o53q_54","slide-nav":"_slide-nav_1o53q_63","slide-nav-prev":"_slide-nav-prev_1o53q_84","slide-nav-next":"_slide-nav-next_1o53q_89"};function Di(r,t,{checkForDefaultPrevented:e=!0}={}){return function(s){if(r?.(s),e===!1||!s.defaultPrevented)return t?.(s)}}function oE(r,t=[]){let e=[];function i(a,l){const u=F.createContext(l),d=e.length;e=[...e,l];const f=p=>{const{scope:g,children:v,...y}=p,S=g?.[r]?.[d]||u,T=F.useMemo(()=>y,Object.values(y));return $.jsx(S.Provider,{value:T,children:v})};f.displayName=a+"Provider";function h(p,g){const v=g?.[r]?.[d]||u,y=F.useContext(v);if(y)return y;if(l!==void 0)return l;throw new Error(`\`${p}\` must be used within \`${a}\``)}return[f,h]}const s=()=>{const a=e.map(l=>F.createContext(l));return function(u){const d=u?.[r]||a;return F.useMemo(()=>({[`__scope${r}`]:{...u,[r]:d}}),[u,d])}};return s.scopeName=r,[i,LA(s,...t)]}function LA(...r){const t=r[0];if(r.length===1)return t;const e=()=>{const i=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const l=i.reduce((u,{useScope:d,scopeName:f})=>{const p=d(a)[`__scope${f}`];return{...u,...p}},{});return F.useMemo(()=>({[`__scope${t.scopeName}`]:l}),[l])}};return e.scopeName=t.scopeName,e}var Vs=globalThis?.document?F.useLayoutEffect:()=>{},_A=Hb[" useInsertionEffect ".trim().toString()]||Vs;function CA({prop:r,defaultProp:t,onChange:e=()=>{},caller:i}){const[s,a,l]=wA({defaultProp:t,onChange:e}),u=r!==void 0,d=u?r:s;{const h=F.useRef(r!==void 0);F.useEffect(()=>{const p=h.current;p!==u&&console.warn(`${i} is changing from ${p?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=u},[u,i])}const f=F.useCallback(h=>{if(u){const p=DA(h)?h(r):h;p!==r&&l.current?.(p)}else a(h)},[u,r,a,l]);return[d,f]}function wA({defaultProp:r,onChange:t}){const[e,i]=F.useState(r),s=F.useRef(e),a=F.useRef(t);return _A(()=>{a.current=t},[t]),F.useEffect(()=>{s.current!==e&&(a.current?.(e),s.current=e)},[e,s]),[e,i,a]}function DA(r){return typeof r=="function"}function cy(r,t){if(typeof r=="function")return r(t);r!=null&&(r.current=t)}function lE(...r){return t=>{let e=!1;const i=r.map(s=>{const a=cy(s,t);return!e&&typeof a=="function"&&(e=!0),a});if(e)return()=>{for(let s=0;s<i.length;s++){const a=i[s];typeof a=="function"?a():cy(r[s],null)}}}}function Zr(...r){return F.useCallback(lE(...r),r)}const IA=["top","right","bottom","left"],hs=Math.min,gi=Math.max,lu=Math.round,Ol=Math.floor,tn=r=>({x:r,y:r}),OA={left:"right",right:"left",bottom:"top",top:"bottom"},kA={start:"end",end:"start"};function $d(r,t,e){return gi(r,hs(t,e))}function Nn(r,t){return typeof r=="function"?r(t):r}function Fn(r){return r.split("-")[0]}function Jr(r){return r.split("-")[1]}function yh(r){return r==="x"?"y":"x"}function vh(r){return r==="y"?"height":"width"}const MA=new Set(["top","bottom"]);function Qi(r){return MA.has(Fn(r))?"y":"x"}function Eh(r){return yh(Qi(r))}function PA(r,t,e){e===void 0&&(e=!1);const i=Jr(r),s=Eh(r),a=vh(s);let l=s==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(l=uu(l)),[l,uu(l)]}function NA(r){const t=uu(r);return[jd(r),t,jd(t)]}function jd(r){return r.replace(/start|end/g,t=>kA[t])}const fy=["left","right"],dy=["right","left"],FA=["top","bottom"],BA=["bottom","top"];function UA(r,t,e){switch(r){case"top":case"bottom":return e?t?dy:fy:t?fy:dy;case"left":case"right":return t?FA:BA;default:return[]}}function $A(r,t,e,i){const s=Jr(r);let a=UA(Fn(r),e==="start",i);return s&&(a=a.map(l=>l+"-"+s),t&&(a=a.concat(a.map(jd)))),a}function uu(r){return r.replace(/left|right|bottom|top/g,t=>OA[t])}function jA(r){return{top:0,right:0,bottom:0,left:0,...r}}function uE(r){return typeof r!="number"?jA(r):{top:r,right:r,bottom:r,left:r}}function cu(r){const{x:t,y:e,width:i,height:s}=r;return{width:i,height:s,top:e,left:t,right:t+i,bottom:e+s,x:t,y:e}}function hy(r,t,e){let{reference:i,floating:s}=r;const a=Qi(t),l=Eh(t),u=vh(l),d=Fn(t),f=a==="y",h=i.x+i.width/2-s.width/2,p=i.y+i.height/2-s.height/2,g=i[u]/2-s[u]/2;let v;switch(d){case"top":v={x:h,y:i.y-s.height};break;case"bottom":v={x:h,y:i.y+i.height};break;case"right":v={x:i.x+i.width,y:p};break;case"left":v={x:i.x-s.width,y:p};break;default:v={x:i.x,y:i.y}}switch(Jr(t)){case"start":v[l]-=g*(e&&f?-1:1);break;case"end":v[l]+=g*(e&&f?-1:1);break}return v}const GA=async(r,t,e)=>{const{placement:i="bottom",strategy:s="absolute",middleware:a=[],platform:l}=e,u=a.filter(Boolean),d=await(l.isRTL==null?void 0:l.isRTL(t));let f=await l.getElementRects({reference:r,floating:t,strategy:s}),{x:h,y:p}=hy(f,i,d),g=i,v={},y=0;for(let S=0;S<u.length;S++){const{name:T,fn:A}=u[S],{x:b,y:R,data:C,reset:D}=await A({x:h,y:p,initialPlacement:i,placement:g,strategy:s,middlewareData:v,rects:f,platform:l,elements:{reference:r,floating:t}});h=b??h,p=R??p,v={...v,[T]:{...v[T],...C}},D&&y<=50&&(y++,typeof D=="object"&&(D.placement&&(g=D.placement),D.rects&&(f=D.rects===!0?await l.getElementRects({reference:r,floating:t,strategy:s}):D.rects),{x:h,y:p}=hy(f,g,d)),S=-1)}return{x:h,y:p,placement:g,strategy:s,middlewareData:v}};async function eo(r,t){var e;t===void 0&&(t={});const{x:i,y:s,platform:a,rects:l,elements:u,strategy:d}=r,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:p="floating",altBoundary:g=!1,padding:v=0}=Nn(t,r),y=uE(v),T=u[g?p==="floating"?"reference":"floating":p],A=cu(await a.getClippingRect({element:(e=await(a.isElement==null?void 0:a.isElement(T)))==null||e?T:T.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(u.floating)),boundary:f,rootBoundary:h,strategy:d})),b=p==="floating"?{x:i,y:s,width:l.floating.width,height:l.floating.height}:l.reference,R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u.floating)),C=await(a.isElement==null?void 0:a.isElement(R))?await(a.getScale==null?void 0:a.getScale(R))||{x:1,y:1}:{x:1,y:1},D=cu(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:b,offsetParent:R,strategy:d}):b);return{top:(A.top-D.top+y.top)/C.y,bottom:(D.bottom-A.bottom+y.bottom)/C.y,left:(A.left-D.left+y.left)/C.x,right:(D.right-A.right+y.right)/C.x}}const HA=r=>({name:"arrow",options:r,async fn(t){const{x:e,y:i,placement:s,rects:a,platform:l,elements:u,middlewareData:d}=t,{element:f,padding:h=0}=Nn(r,t)||{};if(f==null)return{};const p=uE(h),g={x:e,y:i},v=Eh(s),y=vh(v),S=await l.getDimensions(f),T=v==="y",A=T?"top":"left",b=T?"bottom":"right",R=T?"clientHeight":"clientWidth",C=a.reference[y]+a.reference[v]-g[v]-a.floating[y],D=g[v]-a.reference[v],N=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f));let w=N?N[R]:0;(!w||!await(l.isElement==null?void 0:l.isElement(N)))&&(w=u.floating[R]||a.floating[y]);const P=C/2-D/2,B=w/2-S[y]/2-1,M=hs(p[A],B),q=hs(p[b],B),tt=M,V=w-S[y]-q,H=w/2-S[y]/2+P,X=$d(tt,H,V),O=!d.arrow&&Jr(s)!=null&&H!==X&&a.reference[y]/2-(H<tt?M:q)-S[y]/2<0,G=O?H<tt?H-tt:H-V:0;return{[v]:g[v]+G,data:{[v]:X,centerOffset:H-X-G,...O&&{alignmentOffset:G}},reset:O}}}),zA=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:s,middlewareData:a,rects:l,initialPlacement:u,platform:d,elements:f}=t,{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:S=!0,...T}=Nn(r,t);if((e=a.arrow)!=null&&e.alignmentOffset)return{};const A=Fn(s),b=Qi(u),R=Fn(u)===u,C=await(d.isRTL==null?void 0:d.isRTL(f.floating)),D=g||(R||!S?[uu(u)]:NA(u)),N=y!=="none";!g&&N&&D.push(...$A(u,S,y,C));const w=[u,...D],P=await eo(t,T),B=[];let M=((i=a.flip)==null?void 0:i.overflows)||[];if(h&&B.push(P[A]),p){const H=PA(s,l,C);B.push(P[H[0]],P[H[1]])}if(M=[...M,{placement:s,overflows:B}],!B.every(H=>H<=0)){var q,tt;const H=(((q=a.flip)==null?void 0:q.index)||0)+1,X=w[H];if(X&&(!(p==="alignment"?b!==Qi(X):!1)||M.every(K=>Qi(K.placement)===b?K.overflows[0]>0:!0)))return{data:{index:H,overflows:M},reset:{placement:X}};let O=(tt=M.filter(G=>G.overflows[0]<=0).sort((G,K)=>G.overflows[1]-K.overflows[1])[0])==null?void 0:tt.placement;if(!O)switch(v){case"bestFit":{var V;const G=(V=M.filter(K=>{if(N){const nt=Qi(K.placement);return nt===b||nt==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(nt=>nt>0).reduce((nt,ut)=>nt+ut,0)]).sort((K,nt)=>K[1]-nt[1])[0])==null?void 0:V[0];G&&(O=G);break}case"initialPlacement":O=u;break}if(s!==O)return{reset:{placement:O}}}return{}}}};function my(r,t){return{top:r.top-t.height,right:r.right-t.width,bottom:r.bottom-t.height,left:r.left-t.width}}function py(r){return IA.some(t=>r[t]>=0)}const VA=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(t){const{rects:e}=t,{strategy:i="referenceHidden",...s}=Nn(r,t);switch(i){case"referenceHidden":{const a=await eo(t,{...s,elementContext:"reference"}),l=my(a,e.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:py(l)}}}case"escaped":{const a=await eo(t,{...s,altBoundary:!0}),l=my(a,e.floating);return{data:{escapedOffsets:l,escaped:py(l)}}}default:return{}}}}},cE=new Set(["left","top"]);async function KA(r,t){const{placement:e,platform:i,elements:s}=r,a=await(i.isRTL==null?void 0:i.isRTL(s.floating)),l=Fn(e),u=Jr(e),d=Qi(e)==="y",f=cE.has(l)?-1:1,h=a&&d?-1:1,p=Nn(t,r);let{mainAxis:g,crossAxis:v,alignmentAxis:y}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return u&&typeof y=="number"&&(v=u==="end"?y*-1:y),d?{x:v*h,y:g*f}:{x:g*f,y:v*h}}const qA=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(t){var e,i;const{x:s,y:a,placement:l,middlewareData:u}=t,d=await KA(t,r);return l===((e=u.offset)==null?void 0:e.placement)&&(i=u.arrow)!=null&&i.alignmentOffset?{}:{x:s+d.x,y:a+d.y,data:{...d,placement:l}}}}},YA=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:s}=t,{mainAxis:a=!0,crossAxis:l=!1,limiter:u={fn:T=>{let{x:A,y:b}=T;return{x:A,y:b}}},...d}=Nn(r,t),f={x:e,y:i},h=await eo(t,d),p=Qi(Fn(s)),g=yh(p);let v=f[g],y=f[p];if(a){const T=g==="y"?"top":"left",A=g==="y"?"bottom":"right",b=v+h[T],R=v-h[A];v=$d(b,v,R)}if(l){const T=p==="y"?"top":"left",A=p==="y"?"bottom":"right",b=y+h[T],R=y-h[A];y=$d(b,y,R)}const S=u.fn({...t,[g]:v,[p]:y});return{...S,data:{x:S.x-e,y:S.y-i,enabled:{[g]:a,[p]:l}}}}}},XA=function(r){return r===void 0&&(r={}),{options:r,fn(t){const{x:e,y:i,placement:s,rects:a,middlewareData:l}=t,{offset:u=0,mainAxis:d=!0,crossAxis:f=!0}=Nn(r,t),h={x:e,y:i},p=Qi(s),g=yh(p);let v=h[g],y=h[p];const S=Nn(u,t),T=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(d){const R=g==="y"?"height":"width",C=a.reference[g]-a.floating[R]+T.mainAxis,D=a.reference[g]+a.reference[R]-T.mainAxis;v<C?v=C:v>D&&(v=D)}if(f){var A,b;const R=g==="y"?"width":"height",C=cE.has(Fn(s)),D=a.reference[p]-a.floating[R]+(C&&((A=l.offset)==null?void 0:A[p])||0)+(C?0:T.crossAxis),N=a.reference[p]+a.reference[R]+(C?0:((b=l.offset)==null?void 0:b[p])||0)-(C?T.crossAxis:0);y<D?y=D:y>N&&(y=N)}return{[g]:v,[p]:y}}}},WA=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(t){var e,i;const{placement:s,rects:a,platform:l,elements:u}=t,{apply:d=()=>{},...f}=Nn(r,t),h=await eo(t,f),p=Fn(s),g=Jr(s),v=Qi(s)==="y",{width:y,height:S}=a.floating;let T,A;p==="top"||p==="bottom"?(T=p,A=g===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(A=p,T=g==="end"?"top":"bottom");const b=S-h.top-h.bottom,R=y-h.left-h.right,C=hs(S-h[T],b),D=hs(y-h[A],R),N=!t.middlewareData.shift;let w=C,P=D;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(P=R),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(w=b),N&&!g){const M=gi(h.left,0),q=gi(h.right,0),tt=gi(h.top,0),V=gi(h.bottom,0);v?P=y-2*(M!==0||q!==0?M+q:gi(h.left,h.right)):w=S-2*(tt!==0||V!==0?tt+V:gi(h.top,h.bottom))}await d({...t,availableWidth:P,availableHeight:w});const B=await l.getDimensions(u.floating);return y!==B.width||S!==B.height?{reset:{rects:!0}}:{}}}};function _u(){return typeof window<"u"}function ta(r){return fE(r)?(r.nodeName||"").toLowerCase():"#document"}function vi(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function ln(r){var t;return(t=(fE(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function fE(r){return _u()?r instanceof Node||r instanceof vi(r).Node:!1}function Bi(r){return _u()?r instanceof Element||r instanceof vi(r).Element:!1}function nn(r){return _u()?r instanceof HTMLElement||r instanceof vi(r).HTMLElement:!1}function gy(r){return!_u()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof vi(r).ShadowRoot}const QA=new Set(["inline","contents"]);function mo(r){const{overflow:t,overflowX:e,overflowY:i,display:s}=Ui(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!QA.has(s)}const ZA=new Set(["table","td","th"]);function JA(r){return ZA.has(ta(r))}const tR=[":popover-open",":modal"];function Cu(r){return tR.some(t=>{try{return r.matches(t)}catch{return!1}})}const eR=["transform","translate","scale","rotate","perspective"],iR=["transform","translate","scale","rotate","perspective","filter"],nR=["paint","layout","strict","content"];function xh(r){const t=Sh(),e=Bi(r)?Ui(r):r;return eR.some(i=>e[i]?e[i]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||iR.some(i=>(e.willChange||"").includes(i))||nR.some(i=>(e.contain||"").includes(i))}function sR(r){let t=ms(r);for(;nn(t)&&!qr(t);){if(xh(t))return t;if(Cu(t))return null;t=ms(t)}return null}function Sh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const rR=new Set(["html","body","#document"]);function qr(r){return rR.has(ta(r))}function Ui(r){return vi(r).getComputedStyle(r)}function wu(r){return Bi(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function ms(r){if(ta(r)==="html")return r;const t=r.assignedSlot||r.parentNode||gy(r)&&r.host||ln(r);return gy(t)?t.host:t}function dE(r){const t=ms(r);return qr(t)?r.ownerDocument?r.ownerDocument.body:r.body:nn(t)&&mo(t)?t:dE(t)}function io(r,t,e){var i;t===void 0&&(t=[]),e===void 0&&(e=!0);const s=dE(r),a=s===((i=r.ownerDocument)==null?void 0:i.body),l=vi(s);if(a){const u=Gd(l);return t.concat(l,l.visualViewport||[],mo(s)?s:[],u&&e?io(u):[])}return t.concat(s,io(s,[],e))}function Gd(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function hE(r){const t=Ui(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=nn(r),a=s?r.offsetWidth:e,l=s?r.offsetHeight:i,u=lu(e)!==a||lu(i)!==l;return u&&(e=a,i=l),{width:e,height:i,$:u}}function Th(r){return Bi(r)?r:r.contextElement}function Gr(r){const t=Th(r);if(!nn(t))return tn(1);const e=t.getBoundingClientRect(),{width:i,height:s,$:a}=hE(t);let l=(a?lu(e.width):e.width)/i,u=(a?lu(e.height):e.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const aR=tn(0);function mE(r){const t=vi(r);return!Sh()||!t.visualViewport?aR:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function oR(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==vi(r)?!1:t}function Ks(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const s=r.getBoundingClientRect(),a=Th(r);let l=tn(1);t&&(i?Bi(i)&&(l=Gr(i)):l=Gr(r));const u=oR(a,e,i)?mE(a):tn(0);let d=(s.left+u.x)/l.x,f=(s.top+u.y)/l.y,h=s.width/l.x,p=s.height/l.y;if(a){const g=vi(a),v=i&&Bi(i)?vi(i):i;let y=g,S=Gd(y);for(;S&&i&&v!==y;){const T=Gr(S),A=S.getBoundingClientRect(),b=Ui(S),R=A.left+(S.clientLeft+parseFloat(b.paddingLeft))*T.x,C=A.top+(S.clientTop+parseFloat(b.paddingTop))*T.y;d*=T.x,f*=T.y,h*=T.x,p*=T.y,d+=R,f+=C,y=vi(S),S=Gd(y)}}return cu({width:h,height:p,x:d,y:f})}function Du(r,t){const e=wu(r).scrollLeft;return t?t.left+e:Ks(ln(r)).left+e}function pE(r,t){const e=r.getBoundingClientRect(),i=e.left+t.scrollLeft-Du(r,e),s=e.top+t.scrollTop;return{x:i,y:s}}function lR(r){let{elements:t,rect:e,offsetParent:i,strategy:s}=r;const a=s==="fixed",l=ln(i),u=t?Cu(t.floating):!1;if(i===l||u&&a)return e;let d={scrollLeft:0,scrollTop:0},f=tn(1);const h=tn(0),p=nn(i);if((p||!p&&!a)&&((ta(i)!=="body"||mo(l))&&(d=wu(i)),nn(i))){const v=Ks(i);f=Gr(i),h.x=v.x+i.clientLeft,h.y=v.y+i.clientTop}const g=l&&!p&&!a?pE(l,d):tn(0);return{width:e.width*f.x,height:e.height*f.y,x:e.x*f.x-d.scrollLeft*f.x+h.x+g.x,y:e.y*f.y-d.scrollTop*f.y+h.y+g.y}}function uR(r){return Array.from(r.getClientRects())}function cR(r){const t=ln(r),e=wu(r),i=r.ownerDocument.body,s=gi(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),a=gi(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let l=-e.scrollLeft+Du(r);const u=-e.scrollTop;return Ui(i).direction==="rtl"&&(l+=gi(t.clientWidth,i.clientWidth)-s),{width:s,height:a,x:l,y:u}}const yy=25;function fR(r,t){const e=vi(r),i=ln(r),s=e.visualViewport;let a=i.clientWidth,l=i.clientHeight,u=0,d=0;if(s){a=s.width,l=s.height;const h=Sh();(!h||h&&t==="fixed")&&(u=s.offsetLeft,d=s.offsetTop)}const f=Du(i);if(f<=0){const h=i.ownerDocument,p=h.body,g=getComputedStyle(p),v=h.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,y=Math.abs(i.clientWidth-p.clientWidth-v);y<=yy&&(a-=y)}else f<=yy&&(a+=f);return{width:a,height:l,x:u,y:d}}const dR=new Set(["absolute","fixed"]);function hR(r,t){const e=Ks(r,!0,t==="fixed"),i=e.top+r.clientTop,s=e.left+r.clientLeft,a=nn(r)?Gr(r):tn(1),l=r.clientWidth*a.x,u=r.clientHeight*a.y,d=s*a.x,f=i*a.y;return{width:l,height:u,x:d,y:f}}function vy(r,t,e){let i;if(t==="viewport")i=fR(r,e);else if(t==="document")i=cR(ln(r));else if(Bi(t))i=hR(t,e);else{const s=mE(r);i={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return cu(i)}function gE(r,t){const e=ms(r);return e===t||!Bi(e)||qr(e)?!1:Ui(e).position==="fixed"||gE(e,t)}function mR(r,t){const e=t.get(r);if(e)return e;let i=io(r,[],!1).filter(u=>Bi(u)&&ta(u)!=="body"),s=null;const a=Ui(r).position==="fixed";let l=a?ms(r):r;for(;Bi(l)&&!qr(l);){const u=Ui(l),d=xh(l);!d&&u.position==="fixed"&&(s=null),(a?!d&&!s:!d&&u.position==="static"&&!!s&&dR.has(s.position)||mo(l)&&!d&&gE(r,l))?i=i.filter(h=>h!==l):s=u,l=ms(l)}return t.set(r,i),i}function pR(r){let{element:t,boundary:e,rootBoundary:i,strategy:s}=r;const l=[...e==="clippingAncestors"?Cu(t)?[]:mR(t,this._c):[].concat(e),i],u=l[0],d=l.reduce((f,h)=>{const p=vy(t,h,s);return f.top=gi(p.top,f.top),f.right=hs(p.right,f.right),f.bottom=hs(p.bottom,f.bottom),f.left=gi(p.left,f.left),f},vy(t,u,s));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function gR(r){const{width:t,height:e}=hE(r);return{width:t,height:e}}function yR(r,t,e){const i=nn(t),s=ln(t),a=e==="fixed",l=Ks(r,!0,a,t);let u={scrollLeft:0,scrollTop:0};const d=tn(0);function f(){d.x=Du(s)}if(i||!i&&!a)if((ta(t)!=="body"||mo(s))&&(u=wu(t)),i){const v=Ks(t,!0,a,t);d.x=v.x+t.clientLeft,d.y=v.y+t.clientTop}else s&&f();a&&!i&&s&&f();const h=s&&!i&&!a?pE(s,u):tn(0),p=l.left+u.scrollLeft-d.x-h.x,g=l.top+u.scrollTop-d.y-h.y;return{x:p,y:g,width:l.width,height:l.height}}function ud(r){return Ui(r).position==="static"}function Ey(r,t){if(!nn(r)||Ui(r).position==="fixed")return null;if(t)return t(r);let e=r.offsetParent;return ln(r)===e&&(e=e.ownerDocument.body),e}function yE(r,t){const e=vi(r);if(Cu(r))return e;if(!nn(r)){let s=ms(r);for(;s&&!qr(s);){if(Bi(s)&&!ud(s))return s;s=ms(s)}return e}let i=Ey(r,t);for(;i&&JA(i)&&ud(i);)i=Ey(i,t);return i&&qr(i)&&ud(i)&&!xh(i)?e:i||sR(r)||e}const vR=async function(r){const t=this.getOffsetParent||yE,e=this.getDimensions,i=await e(r.floating);return{reference:yR(r.reference,await t(r.floating),r.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function ER(r){return Ui(r).direction==="rtl"}const xR={convertOffsetParentRelativeRectToViewportRelativeRect:lR,getDocumentElement:ln,getClippingRect:pR,getOffsetParent:yE,getElementRects:vR,getClientRects:uR,getDimensions:gR,getScale:Gr,isElement:Bi,isRTL:ER};function vE(r,t){return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}function SR(r,t){let e=null,i;const s=ln(r);function a(){var u;clearTimeout(i),(u=e)==null||u.disconnect(),e=null}function l(u,d){u===void 0&&(u=!1),d===void 0&&(d=1),a();const f=r.getBoundingClientRect(),{left:h,top:p,width:g,height:v}=f;if(u||t(),!g||!v)return;const y=Ol(p),S=Ol(s.clientWidth-(h+g)),T=Ol(s.clientHeight-(p+v)),A=Ol(h),R={rootMargin:-y+"px "+-S+"px "+-T+"px "+-A+"px",threshold:gi(0,hs(1,d))||1};let C=!0;function D(N){const w=N[0].intersectionRatio;if(w!==d){if(!C)return l();w?l(!1,w):i=setTimeout(()=>{l(!1,1e-7)},1e3)}w===1&&!vE(f,r.getBoundingClientRect())&&l(),C=!1}try{e=new IntersectionObserver(D,{...R,root:s.ownerDocument})}catch{e=new IntersectionObserver(D,R)}e.observe(r)}return l(!0),a}function TR(r,t,e,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:d=!1}=i,f=Th(r),h=s||a?[...f?io(f):[],...io(t)]:[];h.forEach(A=>{s&&A.addEventListener("scroll",e,{passive:!0}),a&&A.addEventListener("resize",e)});const p=f&&u?SR(f,e):null;let g=-1,v=null;l&&(v=new ResizeObserver(A=>{let[b]=A;b&&b.target===f&&v&&(v.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var R;(R=v)==null||R.observe(t)})),e()}),f&&!d&&v.observe(f),v.observe(t));let y,S=d?Ks(r):null;d&&T();function T(){const A=Ks(r);S&&!vE(S,A)&&e(),S=A,y=requestAnimationFrame(T)}return e(),()=>{var A;h.forEach(b=>{s&&b.removeEventListener("scroll",e),a&&b.removeEventListener("resize",e)}),p?.(),(A=v)==null||A.disconnect(),v=null,d&&cancelAnimationFrame(y)}}const bR=qA,AR=YA,RR=zA,LR=WA,_R=VA,xy=HA,CR=XA,wR=(r,t,e)=>{const i=new Map,s={platform:xR,...e},a={...s.platform,_c:i};return GA(r,t,{...s,platform:a})};var DR=typeof document<"u",IR=function(){},Zl=DR?F.useLayoutEffect:IR;function fu(r,t){if(r===t)return!0;if(typeof r!=typeof t)return!1;if(typeof r=="function"&&r.toString()===t.toString())return!0;let e,i,s;if(r&&t&&typeof r=="object"){if(Array.isArray(r)){if(e=r.length,e!==t.length)return!1;for(i=e;i--!==0;)if(!fu(r[i],t[i]))return!1;return!0}if(s=Object.keys(r),e=s.length,e!==Object.keys(t).length)return!1;for(i=e;i--!==0;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=e;i--!==0;){const a=s[i];if(!(a==="_owner"&&r.$$typeof)&&!fu(r[a],t[a]))return!1}return!0}return r!==r&&t!==t}function EE(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Sy(r,t){const e=EE(r);return Math.round(t*e)/e}function cd(r){const t=F.useRef(r);return Zl(()=>{t.current=r}),t}function OR(r){r===void 0&&(r={});const{placement:t="bottom",strategy:e="absolute",middleware:i=[],platform:s,elements:{reference:a,floating:l}={},transform:u=!0,whileElementsMounted:d,open:f}=r,[h,p]=F.useState({x:0,y:0,strategy:e,placement:t,middlewareData:{},isPositioned:!1}),[g,v]=F.useState(i);fu(g,i)||v(i);const[y,S]=F.useState(null),[T,A]=F.useState(null),b=F.useCallback(K=>{K!==N.current&&(N.current=K,S(K))},[]),R=F.useCallback(K=>{K!==w.current&&(w.current=K,A(K))},[]),C=a||y,D=l||T,N=F.useRef(null),w=F.useRef(null),P=F.useRef(h),B=d!=null,M=cd(d),q=cd(s),tt=cd(f),V=F.useCallback(()=>{if(!N.current||!w.current)return;const K={placement:t,strategy:e,middleware:g};q.current&&(K.platform=q.current),wR(N.current,w.current,K).then(nt=>{const ut={...nt,isPositioned:tt.current!==!1};H.current&&!fu(P.current,ut)&&(P.current=ut,gh.flushSync(()=>{p(ut)}))})},[g,t,e,q,tt]);Zl(()=>{f===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,p(K=>({...K,isPositioned:!1})))},[f]);const H=F.useRef(!1);Zl(()=>(H.current=!0,()=>{H.current=!1}),[]),Zl(()=>{if(C&&(N.current=C),D&&(w.current=D),C&&D){if(M.current)return M.current(C,D,V);V()}},[C,D,V,M,B]);const X=F.useMemo(()=>({reference:N,floating:w,setReference:b,setFloating:R}),[b,R]),O=F.useMemo(()=>({reference:C,floating:D}),[C,D]),G=F.useMemo(()=>{const K={position:e,left:0,top:0};if(!O.floating)return K;const nt=Sy(O.floating,h.x),ut=Sy(O.floating,h.y);return u?{...K,transform:"translate("+nt+"px, "+ut+"px)",...EE(O.floating)>=1.5&&{willChange:"transform"}}:{position:e,left:nt,top:ut}},[e,u,O.floating,h.x,h.y]);return F.useMemo(()=>({...h,update:V,refs:X,elements:O,floatingStyles:G}),[h,V,X,O,G])}const kR=r=>{function t(e){return{}.hasOwnProperty.call(e,"current")}return{name:"arrow",options:r,fn(e){const{element:i,padding:s}=typeof r=="function"?r(e):r;return i&&t(i)?i.current!=null?xy({element:i.current,padding:s}).fn(e):{}:i?xy({element:i,padding:s}).fn(e):{}}}},MR=(r,t)=>({...bR(r),options:[r,t]}),PR=(r,t)=>({...AR(r),options:[r,t]}),NR=(r,t)=>({...CR(r),options:[r,t]}),FR=(r,t)=>({...RR(r),options:[r,t]}),BR=(r,t)=>({...LR(r),options:[r,t]}),UR=(r,t)=>({..._R(r),options:[r,t]}),$R=(r,t)=>({...kR(r),options:[r,t]});function jR(r){const t=GR(r),e=F.forwardRef((i,s)=>{const{children:a,...l}=i,u=F.Children.toArray(a),d=u.find(zR);if(d){const f=d.props.children,h=u.map(p=>p===d?F.Children.count(f)>1?F.Children.only(null):F.isValidElement(f)?f.props.children:null:p);return $.jsx(t,{...l,ref:s,children:F.isValidElement(f)?F.cloneElement(f,void 0,h):null})}return $.jsx(t,{...l,ref:s,children:a})});return e.displayName=`${r}.Slot`,e}function GR(r){const t=F.forwardRef((e,i)=>{const{children:s,...a}=e;if(F.isValidElement(s)){const l=KR(s),u=VR(a,s.props);return s.type!==F.Fragment&&(u.ref=i?lE(i,l):l),F.cloneElement(s,u)}return F.Children.count(s)>1?F.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var HR=Symbol("radix.slottable");function zR(r){return F.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===HR}function VR(r,t){const e={...t};for(const i in t){const s=r[i],a=t[i];/^on[A-Z]/.test(i)?s&&a?e[i]=(...u)=>{const d=a(...u);return s(...u),d}:s&&(e[i]=s):i==="style"?e[i]={...s,...a}:i==="className"&&(e[i]=[s,a].filter(Boolean).join(" "))}return{...r,...e}}function KR(r){let t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=Object.getOwnPropertyDescriptor(r,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}var qR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ws=qR.reduce((r,t)=>{const e=jR(`Primitive.${t}`),i=F.forwardRef((s,a)=>{const{asChild:l,...u}=s,d=l?e:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),$.jsx(d,{...u,ref:a})});return i.displayName=`Primitive.${t}`,{...r,[t]:i}},{});function YR(r,t){r&&gh.flushSync(()=>r.dispatchEvent(t))}var XR="Arrow",xE=F.forwardRef((r,t)=>{const{children:e,width:i=10,height:s=5,...a}=r;return $.jsx(Ws.svg,{...a,ref:t,width:i,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?e:$.jsx("polygon",{points:"0,0 30,0 15,10"})})});xE.displayName=XR;var WR=xE;function Iu(r){const t=F.useRef(r);return F.useEffect(()=>{t.current=r}),F.useMemo(()=>(...e)=>t.current?.(...e),[])}function QR(r){const[t,e]=F.useState(void 0);return Vs(()=>{if(r){e({width:r.offsetWidth,height:r.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let l,u;if("borderBoxSize"in a){const d=a.borderBoxSize,f=Array.isArray(d)?d[0]:d;l=f.inlineSize,u=f.blockSize}else l=r.offsetWidth,u=r.offsetHeight;e({width:l,height:u})});return i.observe(r,{box:"border-box"}),()=>i.unobserve(r)}else e(void 0)},[r]),t}var bh="Popper",[SE,TE]=oE(bh),[ZR,bE]=SE(bh),AE=r=>{const{__scopePopper:t,children:e}=r,[i,s]=F.useState(null);return $.jsx(ZR,{scope:t,anchor:i,onAnchorChange:s,children:e})};AE.displayName=bh;var RE="PopperAnchor",LE=F.forwardRef((r,t)=>{const{__scopePopper:e,virtualRef:i,...s}=r,a=bE(RE,e),l=F.useRef(null),u=Zr(t,l),d=F.useRef(null);return F.useEffect(()=>{const f=d.current;d.current=i?.current||l.current,f!==d.current&&a.onAnchorChange(d.current)}),i?null:$.jsx(Ws.div,{...s,ref:u})});LE.displayName=RE;var Ah="PopperContent",[JR,tL]=SE(Ah),_E=F.forwardRef((r,t)=>{const{__scopePopper:e,side:i="bottom",sideOffset:s=0,align:a="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:d=!0,collisionBoundary:f=[],collisionPadding:h=0,sticky:p="partial",hideWhenDetached:g=!1,updatePositionStrategy:v="optimized",onPlaced:y,...S}=r,T=bE(Ah,e),[A,b]=F.useState(null),R=Zr(t,Et=>b(Et)),[C,D]=F.useState(null),N=QR(C),w=N?.width??0,P=N?.height??0,B=i+(a!=="center"?"-"+a:""),M=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},q=Array.isArray(f)?f:[f],tt=q.length>0,V={padding:M,boundary:q.filter(iL),altBoundary:tt},{refs:H,floatingStyles:X,placement:O,isPositioned:G,middlewareData:K}=OR({strategy:"fixed",placement:B,whileElementsMounted:(...Et)=>TR(...Et,{animationFrame:v==="always"}),elements:{reference:T.anchor},middleware:[MR({mainAxis:s+P,alignmentAxis:l}),d&&PR({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?NR():void 0,...V}),d&&FR({...V}),BR({...V,apply:({elements:Et,rects:Lt,availableWidth:_t,availableHeight:ie})=>{const{width:pe,height:_e}=Lt.reference,Oe=Et.floating.style;Oe.setProperty("--radix-popper-available-width",`${_t}px`),Oe.setProperty("--radix-popper-available-height",`${ie}px`),Oe.setProperty("--radix-popper-anchor-width",`${pe}px`),Oe.setProperty("--radix-popper-anchor-height",`${_e}px`)}}),C&&$R({element:C,padding:u}),nL({arrowWidth:w,arrowHeight:P}),g&&UR({strategy:"referenceHidden",...V})]}),[nt,ut]=DE(O),k=Iu(y);Vs(()=>{G&&k?.()},[G,k]);const j=K.arrow?.x,st=K.arrow?.y,ct=K.arrow?.centerOffset!==0,[ft,dt]=F.useState();return Vs(()=>{A&&dt(window.getComputedStyle(A).zIndex)},[A]),$.jsx("div",{ref:H.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:G?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ft,"--radix-popper-transform-origin":[K.transformOrigin?.x,K.transformOrigin?.y].join(" "),...K.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:$.jsx(JR,{scope:e,placedSide:nt,onArrowChange:D,arrowX:j,arrowY:st,shouldHideArrow:ct,children:$.jsx(Ws.div,{"data-side":nt,"data-align":ut,...S,ref:R,style:{...S.style,animation:G?void 0:"none"}})})})});_E.displayName=Ah;var CE="PopperArrow",eL={top:"bottom",right:"left",bottom:"top",left:"right"},wE=F.forwardRef(function(t,e){const{__scopePopper:i,...s}=t,a=tL(CE,i),l=eL[a.placedSide];return $.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:$.jsx(WR,{...s,ref:e,style:{...s.style,display:"block"}})})});wE.displayName=CE;function iL(r){return r!==null}var nL=r=>({name:"transformOrigin",options:r,fn(t){const{placement:e,rects:i,middlewareData:s}=t,l=s.arrow?.centerOffset!==0,u=l?0:r.arrowWidth,d=l?0:r.arrowHeight,[f,h]=DE(e),p={start:"0%",center:"50%",end:"100%"}[h],g=(s.arrow?.x??0)+u/2,v=(s.arrow?.y??0)+d/2;let y="",S="";return f==="bottom"?(y=l?p:`${g}px`,S=`${-d}px`):f==="top"?(y=l?p:`${g}px`,S=`${i.floating.height+d}px`):f==="right"?(y=`${-d}px`,S=l?p:`${v}px`):f==="left"&&(y=`${i.floating.width+d}px`,S=l?p:`${v}px`),{data:{x:y,y:S}}}});function DE(r){const[t,e="center"]=r.split("-");return[t,e]}var sL=AE,rL=LE,aL=_E,oL=wE,lL="Portal",IE=F.forwardRef((r,t)=>{const{container:e,...i}=r,[s,a]=F.useState(!1);Vs(()=>a(!0),[]);const l=e||s&&globalThis?.document?.body;return l?SA.createPortal($.jsx(Ws.div,{...i,ref:t}),l):null});IE.displayName=lL;function uL(r,t){return F.useReducer((e,i)=>t[e][i]??e,r)}var Rh=r=>{const{present:t,children:e}=r,i=cL(t),s=typeof e=="function"?e({present:i.isPresent}):F.Children.only(e),a=Zr(i.ref,fL(s));return typeof e=="function"||i.isPresent?F.cloneElement(s,{ref:a}):null};Rh.displayName="Presence";function cL(r){const[t,e]=F.useState(),i=F.useRef(null),s=F.useRef(r),a=F.useRef("none"),l=r?"mounted":"unmounted",[u,d]=uL(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return F.useEffect(()=>{const f=kl(i.current);a.current=u==="mounted"?f:"none"},[u]),Vs(()=>{const f=i.current,h=s.current;if(h!==r){const g=a.current,v=kl(f);r?d("MOUNT"):v==="none"||f?.display==="none"?d("UNMOUNT"):d(h&&g!==v?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,d]),Vs(()=>{if(t){let f;const h=t.ownerDocument.defaultView??window,p=v=>{const S=kl(i.current).includes(CSS.escape(v.animationName));if(v.target===t&&S&&(d("ANIMATION_END"),!s.current)){const T=t.style.animationFillMode;t.style.animationFillMode="forwards",f=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=T)})}},g=v=>{v.target===t&&(a.current=kl(i.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p),()=>{h.clearTimeout(f),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",p),t.removeEventListener("animationend",p)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:F.useCallback(f=>{i.current=f?getComputedStyle(f):null,e(f)},[])}}function kl(r){return r?.animationName||"none"}function fL(r){let t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=Object.getOwnPropertyDescriptor(r,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}function dL(r,t=globalThis?.document){const e=Iu(r);F.useEffect(()=>{const i=s=>{s.key==="Escape"&&e(s)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[e,t])}var hL="DismissableLayer",Hd="dismissableLayer.update",mL="dismissableLayer.pointerDownOutside",pL="dismissableLayer.focusOutside",Ty,OE=F.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),kE=F.forwardRef((r,t)=>{const{disableOutsidePointerEvents:e=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,onDismiss:u,...d}=r,f=F.useContext(OE),[h,p]=F.useState(null),g=h?.ownerDocument??globalThis?.document,[,v]=F.useState({}),y=Zr(t,w=>p(w)),S=Array.from(f.layers),[T]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),A=S.indexOf(T),b=h?S.indexOf(h):-1,R=f.layersWithOutsidePointerEventsDisabled.size>0,C=b>=A,D=vL(w=>{const P=w.target,B=[...f.branches].some(M=>M.contains(P));!C||B||(s?.(w),l?.(w),w.defaultPrevented||u?.())},g),N=EL(w=>{const P=w.target;[...f.branches].some(M=>M.contains(P))||(a?.(w),l?.(w),w.defaultPrevented||u?.())},g);return dL(w=>{b===f.layers.size-1&&(i?.(w),!w.defaultPrevented&&u&&(w.preventDefault(),u()))},g),F.useEffect(()=>{if(h)return e&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(Ty=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(h)),f.layers.add(h),by(),()=>{e&&f.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=Ty)}},[h,g,e,f]),F.useEffect(()=>()=>{h&&(f.layers.delete(h),f.layersWithOutsidePointerEventsDisabled.delete(h),by())},[h,f]),F.useEffect(()=>{const w=()=>v({});return document.addEventListener(Hd,w),()=>document.removeEventListener(Hd,w)},[]),$.jsx(Ws.div,{...d,ref:y,style:{pointerEvents:R?C?"auto":"none":void 0,...r.style},onFocusCapture:Di(r.onFocusCapture,N.onFocusCapture),onBlurCapture:Di(r.onBlurCapture,N.onBlurCapture),onPointerDownCapture:Di(r.onPointerDownCapture,D.onPointerDownCapture)})});kE.displayName=hL;var gL="DismissableLayerBranch",yL=F.forwardRef((r,t)=>{const e=F.useContext(OE),i=F.useRef(null),s=Zr(t,i);return F.useEffect(()=>{const a=i.current;if(a)return e.branches.add(a),()=>{e.branches.delete(a)}},[e.branches]),$.jsx(Ws.div,{...r,ref:s})});yL.displayName=gL;function vL(r,t=globalThis?.document){const e=Iu(r),i=F.useRef(!1),s=F.useRef(()=>{});return F.useEffect(()=>{const a=u=>{if(u.target&&!i.current){let d=function(){ME(mL,e,f,{discrete:!0})};const f={originalEvent:u};u.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=d,t.addEventListener("click",s.current,{once:!0})):d()}else t.removeEventListener("click",s.current);i.current=!1},l=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,e]),{onPointerDownCapture:()=>i.current=!0}}function EL(r,t=globalThis?.document){const e=Iu(r),i=F.useRef(!1);return F.useEffect(()=>{const s=a=>{a.target&&!i.current&&ME(pL,e,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,e]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function by(){const r=new CustomEvent(Hd);document.dispatchEvent(r)}function ME(r,t,e,{discrete:i}){const s=e.originalEvent.target,a=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:e});t&&s.addEventListener(r,t,{once:!0}),i?YR(s,a):s.dispatchEvent(a)}var fd,Ou="HoverCard",[PE]=oE(Ou,[TE]),ku=TE(),[xL,Mu]=PE(Ou),NE=r=>{const{__scopeHoverCard:t,children:e,open:i,defaultOpen:s,onOpenChange:a,openDelay:l=700,closeDelay:u=300}=r,d=ku(t),f=F.useRef(0),h=F.useRef(0),p=F.useRef(!1),g=F.useRef(!1),[v,y]=CA({prop:i,defaultProp:s??!1,onChange:a,caller:Ou}),S=F.useCallback(()=>{clearTimeout(h.current),f.current=window.setTimeout(()=>y(!0),l)},[l,y]),T=F.useCallback(()=>{clearTimeout(f.current),!p.current&&!g.current&&(h.current=window.setTimeout(()=>y(!1),u))},[u,y]),A=F.useCallback(()=>y(!1),[y]);return F.useEffect(()=>()=>{clearTimeout(f.current),clearTimeout(h.current)},[]),$.jsx(xL,{scope:t,open:v,onOpenChange:y,onOpen:S,onClose:T,onDismiss:A,hasSelectionRef:p,isPointerDownOnContentRef:g,children:$.jsx(sL,{...d,children:e})})};NE.displayName=Ou;var FE="HoverCardTrigger",BE=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,...i}=r,s=Mu(FE,e),a=ku(e);return $.jsx(rL,{asChild:!0,...a,children:$.jsx(Ws.a,{"data-state":s.open?"open":"closed",...i,ref:t,onPointerEnter:Di(r.onPointerEnter,hu(s.onOpen)),onPointerLeave:Di(r.onPointerLeave,hu(s.onClose)),onFocus:Di(r.onFocus,s.onOpen),onBlur:Di(r.onBlur,s.onClose),onTouchStart:Di(r.onTouchStart,l=>l.preventDefault())})})});BE.displayName=FE;var Lh="HoverCardPortal",[SL,TL]=PE(Lh,{forceMount:void 0}),UE=r=>{const{__scopeHoverCard:t,forceMount:e,children:i,container:s}=r,a=Mu(Lh,t);return $.jsx(SL,{scope:t,forceMount:e,children:$.jsx(Rh,{present:e||a.open,children:$.jsx(IE,{asChild:!0,container:s,children:i})})})};UE.displayName=Lh;var du="HoverCardContent",$E=F.forwardRef((r,t)=>{const e=TL(du,r.__scopeHoverCard),{forceMount:i=e.forceMount,...s}=r,a=Mu(du,r.__scopeHoverCard);return $.jsx(Rh,{present:i||a.open,children:$.jsx(bL,{"data-state":a.open?"open":"closed",...s,onPointerEnter:Di(r.onPointerEnter,hu(a.onOpen)),onPointerLeave:Di(r.onPointerLeave,hu(a.onClose)),ref:t})})});$E.displayName=du;var bL=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,...u}=r,d=Mu(du,e),f=ku(e),h=F.useRef(null),p=Zr(t,h),[g,v]=F.useState(!1);return F.useEffect(()=>{if(g){const y=document.body;return fd=y.style.userSelect||y.style.webkitUserSelect,y.style.userSelect="none",y.style.webkitUserSelect="none",()=>{y.style.userSelect=fd,y.style.webkitUserSelect=fd}}},[g]),F.useEffect(()=>{if(h.current){const y=()=>{v(!1),d.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(d.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",y),()=>{document.removeEventListener("pointerup",y),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!1}}},[d.isPointerDownOnContentRef,d.hasSelectionRef]),F.useEffect(()=>{h.current&&LL(h.current).forEach(S=>S.setAttribute("tabindex","-1"))}),$.jsx(kE,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:l,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:Di(a,y=>{y.preventDefault()}),onDismiss:d.onDismiss,children:$.jsx(aL,{...f,...u,onPointerDown:Di(u.onPointerDown,y=>{y.currentTarget.contains(y.target)&&v(!0),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!0}),ref:p,style:{...u.style,userSelect:g?"text":void 0,WebkitUserSelect:g?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),AL="HoverCardArrow",RL=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,...i}=r,s=ku(e);return $.jsx(oL,{...s,...i,ref:t})});RL.displayName=AL;function hu(r){return t=>t.pointerType==="touch"?void 0:r()}function LL(r){const t=[],e=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;e.nextNode();)t.push(e.currentNode);return t}var _L=NE,CL=BE,wL=UE,DL=$E;const IL="_hover_1j4zy_1",OL={"hover-container":"_hover-container_1j4zy_1",hover:IL,"hover-poster":"_hover-poster_1j4zy_14","info-container":"_info-container_1j4zy_29","hover-info":"_hover-info_1j4zy_38","hover-name":"_hover-name_1j4zy_50","hover-origin-name":"_hover-origin-name_1j4zy_56","hover-control":"_hover-control_1j4zy_63","control-play":"_control-play_1j4zy_92","other-info":"_other-info_1j4zy_102","imdb-info":"_imdb-info_1j4zy_117","category-info":"_category-info_1j4zy_130","category-item":"_category-item_1j4zy_135"},_h=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M187.2 100.9C174.8 94.1 159.8 94.4 147.6 101.6C135.4 108.8 128 121.9 128 136L128 504C128 518.1 135.5 531.2 147.6 538.4C159.7 545.6 174.8 545.9 187.2 539.1L523.2 355.1C536 348.1 544 334.6 544 320C544 305.4 536 291.9 523.2 284.9L187.2 100.9z"})),jE=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M305 151.1L320 171.8L335 151.1C360 116.5 400.2 96 442.9 96C516.4 96 576 155.6 576 229.1L576 231.7C576 343.9 436.1 474.2 363.1 529.9C350.7 539.3 335.5 544 320 544C304.5 544 289.2 539.4 276.9 529.9C203.9 474.2 64 343.9 64 231.7L64 229.1C64 155.6 123.6 96 197.1 96C239.8 96 280 116.5 305 151.1z"})),GE=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM288 224C288 206.3 302.3 192 320 192C337.7 192 352 206.3 352 224C352 241.7 337.7 256 320 256C302.3 256 288 241.7 288 224zM280 288L328 288C341.3 288 352 298.7 352 312L352 400L360 400C373.3 400 384 410.7 384 424C384 437.3 373.3 448 360 448L280 448C266.7 448 256 437.3 256 424C256 410.7 266.7 400 280 400L304 400L304 336L280 336C266.7 336 256 325.3 256 312C256 298.7 266.7 288 280 288z"})),di=Xs.bind(OL);function kL({movieData:r,imgDom:t}){return $.jsx("div",{className:di("hover-container"),children:$.jsxs("div",{className:di("hover"),children:[$.jsx("div",{className:di("hover-poster"),children:$.jsx("img",{src:t+"/uploads/movies/"+r.poster_url})}),$.jsx("div",{className:di("info-container"),children:$.jsxs("div",{className:di("hover-info"),children:[$.jsx("div",{className:di("hover-name"),children:r.name}),$.jsx("div",{className:di("hover-origin-name"),children:r.origin_name}),$.jsxs("div",{className:di("hover-control"),children:[$.jsx(me,{to:`/watch/${r.slug}`,children:$.jsxs("button",{className:di("control-play"),children:[$.jsx(_h,{}),"Xem ngay"]})}),$.jsx("a",{children:$.jsxs("button",{children:[$.jsx(jE,{}),"Thich"]})}),$.jsx(me,{to:`/movies/${r.slug}`,children:$.jsxs("button",{children:[$.jsx(GE,{}),"Chi tit"]})})]}),$.jsxs("div",{className:di("other-info"),children:[$.jsxs("button",{className:di("imdb-info"),children:["IMDb ",$.jsx("span",{children:r.imdb.vote_count==0?"No rate":r.imdb.vote_average})]}),$.jsx("button",{children:r.year}),$.jsx("button",{children:r.type=="hoathinh"&&"Hoat hinh"||r.type=="series"&&"Phim b"||r.type=="single"&&"Phim le"||r.type=="tvshow"&&"Truyn hinh"||r.type}),$.jsx("button",{children:r.episode_current})]}),$.jsx("div",{className:di("category-info"),children:r.category.map(e=>$.jsx("span",{className:di("category-item"),children:e.name},e.id))})]})})]})})}const ML="_name_1dj3u_35",PL={"slide-card":"_slide-card_1dj3u_1","slide-poster":"_slide-poster_1dj3u_7","slide-img":"_slide-img_1dj3u_17","slide-name":"_slide-name_1dj3u_24",name:ML,"origin-name":"_origin-name_1dj3u_41","hover-preview":"_hover-preview_1dj3u_51","zoom-in-zoom-out":"_zoom-in-zoom-out_1dj3u_1"},Bs=Xs.bind(PL);function NL({movieData:r,width:t,imgDom:e}){return $.jsxs("div",{className:Bs("slide-card"),children:[$.jsxs(_L,{openDelay:250,closeDelay:150,children:[$.jsx(CL,{asChild:!0,children:$.jsx(me,{className:Bs("slide-poster"),to:`/phim/${r.slug}`,children:$.jsx("img",{className:Bs("slide-img"),src:e+"/uploads/movies/"+r.poster_url})})}),$.jsx(wL,{children:$.jsx(DL,{side:"center",align:"top",sideOffset:-35,alignOffset:-50,className:Bs("hover-preview"),style:{width:`${t}px`,height:`${t}px`},children:$.jsx(kL,{movieData:r,imgDom:e})})})]}),$.jsxs("div",{className:Bs("slide-name"),children:[$.jsx("div",{className:Bs("name"),children:$.jsxs(me,{to:`/phim/${r.slug}`,children:["X l scroll cho slide",r.name]})}),$.jsx("div",{className:Bs("origin-name"),children:$.jsx(me,{to:`/phim/${r.slug}`,children:r.origin_name})})]})]})}const HE=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M98.9 114.6C91.5 130.6 98.5 149.7 114.5 157.1L467.6 320L114.6 483C98.6 490.4 91.5 509.4 99 525.5C106.5 541.6 125.4 548.5 141.5 541.1L557.5 349.1C568.8 343.9 576.1 332.5 576.1 320C576.1 307.5 568.8 296.2 557.5 290.9L141.4 99C125.4 91.6 106.3 98.6 98.9 114.6z"})),zE=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M439.1 297.4C451.6 309.9 451.6 330.2 439.1 342.7L279.1 502.7C266.6 515.2 246.3 515.2 233.8 502.7C221.3 490.2 221.3 469.9 233.8 457.4L371.2 320L233.9 182.6C221.4 170.1 221.4 149.8 233.9 137.3C246.4 124.8 266.7 124.8 279.2 137.3L439.2 297.3z"})),FL=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M201.4 297.4C188.9 309.9 188.9 330.2 201.4 342.7L361.4 502.7C373.9 515.2 394.2 515.2 406.7 502.7C419.2 490.2 419.2 469.9 406.7 457.4L269.3 320L406.6 182.6C419.1 170.1 419.1 149.8 406.6 137.3C394.1 124.8 373.8 124.8 361.3 137.3L201.3 297.3z"})),Ki=Xs.bind(RA);function dd({data:r}){const[t,e]=F.useState(0),[i,s]=F.useState(0),[a,l]=F.useState(""),u=F.useRef(null),d=F.useRef(null),f=F.useRef(null);return F.useEffect(()=>{l(`#${Math.floor(Math.random()*16777215).toString(16)}`);var h=u.current.children[0],p=u.current.children[1];s(p.getBoundingClientRect().left-h.getBoundingClientRect().left)},[]),F.useEffect(()=>{u.current.style.transform=`translateX(${-t*i}px)`},[t]),$.jsxs("div",{className:Ki("slide"),children:[$.jsxs("div",{className:Ki("slide-title"),children:[$.jsxs("div",{className:Ki("title-text"),style:{background:`linear-gradient(
    235deg,
    rgb(255, 255, 255) 30%,
    ${a} 100%
  )`},children:[r.seoOnPage.titleHead," mi"]}),$.jsx("div",{className:Ki("title-info"),children:$.jsxs(me,{to:r.seoOnPage.og_url,children:[$.jsx("span",{children:"Xem toan b"}),$.jsx(HE,{})]})})]}),$.jsxs("div",{className:Ki("slide-wrapper"),children:[$.jsxs("div",{className:Ki("slide-nav"),children:[t!=0&&$.jsx("button",{type:"button",className:Ki("slide-nav-prev"),ref:d,onClick:()=>{e((h=>h-1))},children:$.jsx(FL,{})}),t!=r.params.pagination.totalItemsPerPage-3&&$.jsx("button",{type:"button",className:Ki("slide-nav-next"),ref:f,onClick:()=>{e((h=>h+1))},children:$.jsx(zE,{})})]}),$.jsx("div",{className:Ki("slide-content"),children:$.jsx("div",{className:Ki("slide-group"),ref:u,children:r.items.map(h=>$.jsx(NL,{movieData:h,width:i,imgDom:r.APP_DOMAIN_CDN_IMAGE},h._id))})})]})]})}const BL="_banner_1ej20_7",UL="_overlay_1ej20_35",$L="_active_1ej20_247",jL="_slideInFromRight_1ej20_1",GL="_slideInFromLeft_1ej20_1",HL="_topic_1ej20_259",zL="_all_1ej20_1",VL={"home-container":"_home-container_1ej20_1",banner:BL,"banner-container":"_banner-container_1ej20_11","banner-content":"_banner-content_1ej20_16","banner-item":"_banner-item_1ej20_20","banner-img":"_banner-img_1ej20_25",overlay:UL,"banner-info":"_banner-info_1ej20_57","banner-name":"_banner-name_1ej20_87","banner-origin-name":"_banner-origin-name_1ej20_97","banner-tags":"_banner-tags_1ej20_107","banner-touch":"_banner-touch_1ej20_124","touch-play":"_touch-play_1ej20_131","touch-group":"_touch-group_1ej20_145","touch-item":"_touch-item_1ej20_160","imdb-info":"_imdb-info_1ej20_194","banner-category":"_banner-category_1ej20_207","top-slide":"_top-slide_1ej20_221","top-slide-img":"_top-slide-img_1ej20_231",active:$L,slideInFromRight:jL,slideInFromLeft:GL,topic:HL,"topic-header":"_topic-header_1ej20_265","topic-item":"_topic-item_1ej20_271",all:zL,"topic-content":"_topic-content_1ej20_323","topic-wrapper":"_topic-wrapper_1ej20_329","topic-info":"_topic-info_1ej20_339","slide-container":"_slide-container_1ej20_350"},zt=Xs.bind(VL),KL=[{id:1,name:"Phim mi",slug:"phim-moi"},{id:2,name:"Phim b",slug:"phim-bo"},{id:3,name:"Phim l",slug:"phim-le"},{id:4,name:"TV Shows",slug:"tv-shows"},{id:5,name:"Hot hnh",slug:"hoat-hinh"},{id:6,name:"Phim Vietsub",slug:"phim-vietsub"},{id:7,name:"Phim thuyt minh",slug:"phim-thuyet-minh"},{id:8,name:"Phim lng ting",slug:"phim-long-tieng"},{id:9,name:"Phim b ang chiu",slug:"phim-bo-dang-chieu"},{id:10,name:"Phim b hon thnh",slug:"phim-bo-hoan-thanh"},{id:11,name:"Phim sp chiu",slug:"phim-sap-chieu"},{id:12,name:"Subteam",slug:"subteam"},{id:13,name:"Phim chiu rp",slug:"phim-chieu-rap"}];function qL(){const[r,t]=F.useState(null),[e,i]=F.useState(null),[s,a]=F.useState(0),[l,u]=F.useState(""),d=F.useRef(),f=document.documentElement.getBoundingClientRect().width;F.useEffect(()=>{fetch("https://ophim1.com/v1/api/quoc-gia/han-quoc",{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>t(T.data)).catch(T=>console.error(T)),fetch("https://ophim1.com/v1/api/home",{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>(u(T.data.APP_DOMAIN_CDN_IMAGE),i(T.data.items.slice(0,6)))).catch(T=>console.error(T))},[]);const[h,p]=F.useState(null);return F.useEffect(()=>{fetch("https://ophim1.com/v1/api/quoc-gia/nhat-ban",{method:"GET",headers:{accept:"application/json"}}).then(y=>y.json()).then(y=>p(y.data)).catch(y=>console.error(y))},[]),F.useEffect(()=>{d.current.style.transform=`translateX(${-s*f}px)`},[s]),$.jsxs("div",{children:[$.jsx("div",{className:zt("banner"),children:$.jsxs("div",{className:zt("banner-container"),children:[$.jsx("div",{className:zt("banner-content"),ref:d,children:e?.map((g,v)=>$.jsxs("div",{className:zt("banner-item",{active:v===s}),children:[$.jsx("div",{className:zt("banner-img"),children:$.jsx("img",{src:l+"/uploads/movies/"+g.thumb_url.replace("thumb","poster"),"data-step":"0",onError:y=>{const S=y.currentTarget,T=Number(S.dataset.step);T===0?(S.dataset.step="1",S.src=l+"/uploads/movies/"+g.slug+"-poster.jpg"):T===1?(S.dataset.step="2",S.src=l+"/uploads/movies/"+g.thumb_url):S.onerror=null}})}),$.jsxs("div",{className:zt("banner-info"),children:[$.jsx("a",{className:zt("banner-name"),children:g.name}),$.jsx("a",{className:zt("banner-origin-name"),children:g.origin_name}),$.jsxs("div",{children:[$.jsxs("div",{className:zt("banner-tags"),children:[$.jsxs("button",{className:zt("imdb-info"),children:["IMDb ",$.jsx("span",{children:g.imdb.vote_count==0?"No rate":g.imdb.vote_average})]}),$.jsx("button",{children:g.year}),$.jsx("button",{children:g.type=="hoathinh"&&"Hoat hinh"||g.type=="series"&&"Phim b"||g.type=="single"&&"Phim le"||g.type=="tvshow"&&"Truyn hinh"||g.type}),$.jsx("button",{children:g.episode_current})]}),$.jsx("div",{className:zt("banner-category"),children:g.category.map(y=>$.jsx(me,{to:`/the-loai/${y.slug}`,children:y.name},y.id))})]}),$.jsxs("div",{className:zt("banner-touch"),children:[$.jsx(me,{to:`/watch/${g.slug}`,className:zt("touch-play"),children:$.jsx(_h,{})}),$.jsxs("div",{className:zt("touch-group"),children:[$.jsx("a",{className:zt("touch-item"),children:$.jsx(jE,{})}),$.jsx(me,{to:`/movies/${g.slug}`,className:zt("touch-item"),children:$.jsx(GE,{})})]})]})]}),$.jsx("div",{className:zt("overlay")})]},g._id))}),$.jsx("div",{className:zt("top-slide"),children:e?.map((g,v)=>$.jsx("div",{className:zt("top-slide-img",{active:v===s}),onClick:()=>a(v),children:$.jsx("img",{src:l+"/uploads/movies/"+g.thumb_url.replace("thumb","poster"),"data-step":"0",onError:y=>{const S=y.currentTarget,T=Number(S.dataset.step);T===0?(S.dataset.step="1",S.src=l+"/uploads/movies/"+g.slug+"-poster.jpg"):T===1?(S.dataset.step="2",S.src=l+"/uploads/movies/"+g.thumb_url):S.onerror=null}})},g._id))})]})}),$.jsxs("div",{className:zt("home-container"),children:[$.jsxs("div",{className:zt("topic"),children:[$.jsx("div",{className:zt("topic-header"),children:"Ban ang quan tm gi?"}),$.jsxs("div",{className:zt("topic-content"),children:[KL.slice(0,6).map(g=>$.jsx(me,{to:`/chu-de/${g.slug}`,className:zt("topic-item"),children:$.jsxs("div",{className:zt("topic-wrapper"),children:[$.jsx("div",{className:zt("topic-name"),children:g.name}),$.jsxs("div",{className:zt("topic-info"),children:["Xem chu ",$.jsx(zE,{})]})]})},g.id)),$.jsx(me,{to:"/chu-de",className:zt("topic-item"),style:{textAlign:"center",fontSize:"1.1rem"},children:"+8 chu "})]})]}),$.jsxs("div",{className:zt("slide-container"),children:[r&&$.jsx(dd,{data:r}),h&&$.jsx(dd,{data:h}),h&&$.jsx(dd,{data:h})]})]})]})}/*!
 * artplayer.js v5.3.0
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(r,t,e,i,s,a,l,u){var d=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},f=typeof d[i]=="function"&&d[i],h=f.i||{},p=f.cache||{},g=typeof Gs<"u"&&typeof Gs.require=="function"&&Gs.require.bind(Gs);function v(T,A){if(!p[T]){if(!r[T]){if(s[T])return s[T];var b=typeof d[i]=="function"&&d[i];if(!A&&b)return b(T,!0);if(f)return f(T,!0);if(g&&typeof T=="string")return g(T);var R=Error("Cannot find module '"+T+"'");throw R.code="MODULE_NOT_FOUND",R}D.resolve=function(N){var w=r[T][1][N];return w??N},D.cache={};var C=p[T]=new v.Module(T);r[T][0].call(C.exports,D,C,C.exports,d)}return p[T].exports;function D(N){var w=D.resolve(N);return w===!1?{}:v(w)}}v.isParcelRequire=!0,v.Module=function(T){this.id=T,this.bundle=v,this.require=g,this.exports={}},v.modules=r,v.cache=p,v.parent=f,v.distDir=void 0,v.publicUrl=void 0,v.devServer=void 0,v.i=h,v.register=function(T,A){r[T]=[function(b,R){R.exports=A},{}]},Object.defineProperty(v,"root",{get:function(){return d[i]}}),d[i]=v;for(var y=0;y<t.length;y++)v(t[y]);{var S=v(e);typeof bS=="object"&&typeof Gs<"u"?Gs.exports=S:typeof define=="function"&&define.amd&&define(function(){return S})}})({esqvp:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("bundle-text:./style/index.less"),l=s.interopDefault(a),u=r("option-validator"),d=s.interopDefault(u),f=r("../package.json"),h=r("./config"),p=s.interopDefault(h),g=r("./contextmenu"),v=s.interopDefault(g),y=r("./control"),S=s.interopDefault(y),T=r("./events"),A=s.interopDefault(T),b=r("./hotkey"),R=s.interopDefault(b),C=r("./i18n"),D=s.interopDefault(C),N=r("./icons"),w=s.interopDefault(N),P=r("./info"),B=s.interopDefault(P),M=r("./layer"),q=s.interopDefault(M),tt=r("./loading"),V=s.interopDefault(tt),H=r("./mask"),X=s.interopDefault(H),O=r("./notice"),G=s.interopDefault(O),K=r("./player"),nt=s.interopDefault(K),ut=r("./plugins"),k=s.interopDefault(ut),j=r("./scheme"),st=s.interopDefault(j),ct=r("./setting"),ft=s.interopDefault(ct),dt=r("./storage"),Et=s.interopDefault(dt),Lt=r("./subtitle"),_t=s.interopDefault(Lt),ie=r("./template"),pe=s.interopDefault(ie),_e=r("./utils"),Oe=r("./utils/emitter"),Ce=s.interopDefault(Oe);let $i=0,bt=[];class pt extends Ce.default{constructor(le,ue){if(super(),!_e.isBrowser)throw Error("Artplayer can only be used in the browser environment");this.id=++$i;let ke=_e.mergeDeep(pt.option,le);if(ke.container=le.container,this.option=(0,d.default)(ke,st.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isRotate=!1,this.isDestroy=!1,this.template=new pe.default(this),this.events=new A.default(this),this.storage=new Et.default(this),this.icons=new w.default(this),this.i18n=new D.default(this),this.notice=new G.default(this),this.player=new nt.default(this),this.layers=new q.default(this),this.controls=new S.default(this),this.contextmenu=new v.default(this),this.subtitle=new _t.default(this),this.info=new B.default(this),this.loading=new V.default(this),this.hotkey=new R.default(this),this.mask=new X.default(this),this.setting=new ft.default(this),this.plugins=new k.default(this),typeof ue=="function"&&this.on("ready",()=>ue.call(this,this)),pt.DEBUG){let je=He=>console.log(`[ART.${this.id}] -> ${He}`);je(`Version@${pt.version}`);for(let He=0;He<p.default.events.length;He++)this.on(`video:${p.default.events[He]}`,ne=>je(`Event@${ne.type}`))}bt.push(this)}static get instances(){return bt}static get version(){return f.version}static get config(){return p.default}static get utils(){return _e}static get scheme(){return st.default}static get Emitter(){return Ce.default}static get validator(){return d.default}static get kindOf(){return d.default.kindOf}static get html(){return pe.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,gesture:!0,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,proxy:void 0,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],thumbnails:{url:"",number:60,column:10,width:0,height:0,scale:1},subtitle:{url:"",type:"",style:{},name:"",escape:!0,encoding:"utf-8",onVttLoad:le=>le},moreVideoAttr:{controls:!1,preload:_e.isSafari?"auto":"metadata"},i18n:{},icons:{},cssVar:{},customType:{},lang:navigator?.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}get video(){return this.template.$video}destroy(le=!0){pt.REMOVE_SRC_WHEN_DESTROY&&this.video.removeAttribute("src"),this.events.destroy(),this.template.destroy(le),bt.splice(bt.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}e.default=pt,pt.STYLE=l.default,pt.DEBUG=!1,pt.CONTEXTMENU=!0,pt.NOTICE_TIME=2e3,pt.SETTING_WIDTH=250,pt.SETTING_ITEM_WIDTH=200,pt.SETTING_ITEM_HEIGHT=35,pt.RESIZE_TIME=200,pt.SCROLL_TIME=200,pt.SCROLL_GAP=50,pt.AUTO_PLAYBACK_MAX=10,pt.AUTO_PLAYBACK_MIN=5,pt.AUTO_PLAYBACK_TIMEOUT=3e3,pt.RECONNECT_TIME_MAX=5,pt.RECONNECT_SLEEP_TIME=1e3,pt.CONTROL_HIDE_TIME=3e3,pt.DBCLICK_TIME=300,pt.DBCLICK_FULLSCREEN=!0,pt.MOBILE_DBCLICK_PLAY=!0,pt.MOBILE_CLICK_PLAY=!1,pt.AUTO_ORIENTATION_TIME=200,pt.INFO_LOOP_TIME=1e3,pt.FAST_FORWARD_VALUE=3,pt.FAST_FORWARD_TIME=1e3,pt.TOUCH_MOVE_RATIO=.5,pt.VOLUME_STEP=.1,pt.SEEK_STEP=5,pt.PLAYBACK_RATE=[.5,.75,1,1.25,1.5,2],pt.ASPECT_RATIO=["default","4:3","16:9"],pt.FLIP=["normal","horizontal","vertical"],pt.FULLSCREEN_WEB_IN_BODY=!1,pt.LOG_VERSION=!0,pt.USE_RAF=!1,pt.REMOVE_SRC_WHEN_DESTROY=!0,_e.isBrowser&&(window.Artplayer=pt,_e.setStyleText("artplayer-style",l.default),setTimeout(()=>{pt.LOG_VERSION&&console.log(`%c ArtPlayer %c ${pt.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},100))},{"bundle-text:./style/index.less":"2wh8D","option-validator":"g7VGh","../package.json":"lh3R5","./config":"eJfh8","./contextmenu":"9zso8","./control":"dp1yk","./events":"jmVSD","./hotkey":"dswts","./i18n":"d9ktO","./icons":"fFHY0","./info":"kZ0F8","./layer":"j9lbi","./loading":"bMjWd","./mask":"k1nkQ","./notice":"fPVaU","./player":"uR0Sw","./plugins":"cjxJL","./scheme":"biLjm","./setting":"bwLGT","./storage":"kwqbK","./subtitle":"k5613","./template":"fwOA1","./utils":"aBlEo","./utils/emitter":"4NM7P","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2wh8D":[function(r,t,e,i){t.exports='.art-video-player{--art-theme:red;--art-font-color:#fff;--art-background-color:#000;--art-text-shadow-color:#00000080;--art-transition-duration:.2s;--art-padding:10px;--art-border-radius:3px;--art-progress-height:6px;--art-progress-color:#ffffff40;--art-hover-color:#ffffff40;--art-loaded-color:#ffffff40;--art-state-size:80px;--art-state-opacity:.8;--art-bottom-height:100px;--art-bottom-offset:20px;--art-bottom-gap:5px;--art-highlight-width:8px;--art-highlight-color:#ffffff80;--art-control-height:46px;--art-control-opacity:.75;--art-control-icon-size:36px;--art-control-icon-scale:1.1;--art-volume-height:120px;--art-volume-handle-size:14px;--art-lock-size:36px;--art-indicator-scale:0;--art-indicator-size:16px;--art-fullscreen-web-index:9999;--art-settings-icon-size:24px;--art-settings-max-height:300px;--art-selector-max-height:300px;--art-contextmenus-min-width:250px;--art-subtitle-font-size:20px;--art-subtitle-gap:5px;--art-subtitle-bottom:15px;--art-subtitle-border:#000;--art-widget-background:#000000d9;--art-tip-background:#000000b3;--art-scrollbar-size:4px;--art-scrollbar-background:#ffffff40;--art-scrollbar-background-hover:#ffffff80;--art-mini-progress-height:2px}.art-bg-cover{background-position:50%;background-repeat:no-repeat;background-size:cover}.art-bottom-gradient{background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x}.art-backdrop-filter{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.art-video-player{zoom:1;text-align:left;user-select:none;box-sizing:border-box;width:100%;height:100%;color:var(--art-font-color);background-color:var(--art-background-color);text-shadow:0 0 2px var(--art-text-shadow-color);-webkit-tap-highlight-color:#0000;-ms-touch-action:manipulation;touch-action:manipulation;-ms-high-contrast-adjust:none;direction:ltr;outline:0;margin:0 auto;padding:0;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Roboto,Arial,sans-serif;font-size:14px;line-height:1.3;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box}.art-video-player ::-webkit-scrollbar{width:var(--art-scrollbar-size);height:var(--art-scrollbar-size)}.art-video-player ::-webkit-scrollbar-thumb{background-color:var(--art-scrollbar-background)}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:var(--art-scrollbar-background-hover)}.art-video-player img{vertical-align:top;max-width:100%}.art-video-player svg{fill:var(--art-font-color)}.art-video-player a{color:var(--art-font-color);text-decoration:none}.art-icon{justify-content:center;align-items:center;line-height:1;display:flex}.art-video-player.art-backdrop .art-contextmenus,.art-video-player.art-backdrop .art-info,.art-video-player.art-backdrop .art-settings,.art-video-player.art-backdrop .art-layer-auto-playback,.art-video-player.art-backdrop .art-selector-list,.art-video-player.art-backdrop .art-volume-inner{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-video{z-index:10;cursor:pointer;width:100%;height:100%;position:absolute;inset:0}.art-poster{z-index:11;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;width:100%;height:100%;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;text-align:center;pointer-events:none;justify-content:center;align-items:center;gap:var(--art-subtitle-gap);width:100%;bottom:var(--art-subtitle-bottom);font-size:var(--art-subtitle-font-size);transition:bottom var(--art-transition-duration)ease;text-shadow:var(--art-subtitle-border)1px 0 1px,var(--art-subtitle-border)0 1px 1px,var(--art-subtitle-border)-1px 0 1px,var(--art-subtitle-border)0 -1px 1px,var(--art-subtitle-border)1px 1px 1px,var(--art-subtitle-border)-1px -1px 1px,var(--art-subtitle-border)1px -1px 1px,var(--art-subtitle-border)-1px 1px 1px;flex-direction:column;padding:0 5%;display:none;position:absolute}.art-video-player.art-subtitle-show .art-subtitle{display:flex}.art-video-player.art-control-show .art-subtitle{bottom:calc(var(--art-control-height) + var(--art-subtitle-bottom))}.art-danmuku{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;pointer-events:none;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:flex}.art-video-player .art-mask{z-index:50;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;inset:0}.art-video-player .art-mask .art-state{opacity:0;width:var(--art-state-size);height:var(--art-state-size);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.art-video-player.art-mask-show .art-state{cursor:pointer;pointer-events:auto;opacity:var(--art-state-opacity);transform:scale(1)}.art-video-player.art-loading-show .art-state{display:none}.art-video-player .art-loading{z-index:70;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;opacity:0;pointer-events:none;width:100%;height:100%;padding:0 var(--art-padding);transition:all var(--art-transition-duration)ease;background-size:100% var(--art-bottom-height);background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:flex-end;display:flex;position:absolute;inset:0;overflow:hidden}.art-video-player .art-bottom .art-controls,.art-video-player .art-bottom .art-progress{transform:translateY(var(--art-bottom-offset));transition:transform var(--art-transition-duration)ease}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1}.art-video-player.art-control-show .art-bottom .art-controls,.art-video-player.art-hover .art-bottom .art-controls,.art-video-player.art-control-show .art-bottom .art-progress,.art-video-player.art-hover .art-bottom .art-progress{transform:translateY(0)}.art-bottom .art-progress{z-index:0;pointer-events:auto;padding-bottom:var(--art-bottom-gap);position:relative}.art-bottom .art-progress .art-control-progress{cursor:pointer;height:var(--art-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner{width:100%;height:50%;transition:height var(--art-transition-duration)ease;background-color:var(--art-progress-color);align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-hover{z-index:0;background-color:var(--art-hover-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;background-color:var(--art-loaded-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;background-color:var(--art-theme);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{z-index:0;pointer-events:auto;width:100%;height:100%;transform:translateX(calc(var(--art-highlight-width)/-2));background-color:var(--art-highlight-color);position:absolute;inset:0 auto 0 0;width:var(--art-highlight-width)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{z-index:40;width:var(--art-indicator-size);height:var(--art-indicator-size);transform:scale(var(--art-indicator-scale));margin-left:calc(var(--art-indicator-size)/-2);transition:transform var(--art-transition-duration)ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{pointer-events:none;width:100%;height:100%}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:hover{transform:scale(1.2)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:active{transform:scale(1)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;border-radius:var(--art-border-radius);white-space:nowrap;background-color:var(--art-tip-background);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.art-bottom .art-progress .art-control-progress:hover .art-control-progress-inner{height:100%}.art-bottom .art-progress .art-control-thumbnails{bottom:calc(var(--art-bottom-gap) + 10px);border-radius:var(--art-border-radius);pointer-events:none;background-color:var(--art-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px #0003,0 1px 2px -1px #0003}.art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{transform:scale(1)}.art-controls{z-index:10;pointer-events:auto;height:var(--art-control-height);justify-content:space-between;align-items:center;display:flex;position:relative}.art-controls .art-controls-left,.art-controls .art-controls-right{height:100%;display:flex}.art-controls .art-controls-center{flex:1;justify-content:center;align-items:center;height:100%;padding:0 10px;display:none}.art-controls .art-controls-right{justify-content:flex-end}.art-controls .art-control{cursor:pointer;white-space:nowrap;opacity:var(--art-control-opacity);min-height:var(--art-control-height);min-width:var(--art-control-height);transition:opacity var(--art-transition-duration)ease;flex-shrink:0;justify-content:center;align-items:center;display:flex}.art-controls .art-control .art-icon{height:var(--art-control-icon-size);width:var(--art-control-icon-size);transform:scale(var(--art-control-icon-scale));transition:transform var(--art-transition-duration)ease}.art-controls .art-control .art-icon:active{transform:scale(calc(var(--art-control-icon-scale)*.8))}.art-controls .art-control:hover{opacity:1}.art-control-volume{position:relative}.art-control-volume .art-volume-panel{text-align:center;cursor:default;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--art-control-height);width:var(--art-control-height);height:var(--art-volume-height);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;transform:translateY(10px)}.art-control-volume .art-volume-panel .art-volume-inner{border-radius:var(--art-border-radius);background-color:var(--art-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider{cursor:pointer;flex:1;justify-content:center;width:100%;display:flex;position:relative}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle{border-radius:var(--art-border-radius);background-color:#ffffff40;justify-content:center;width:2px;display:flex;position:relative;overflow:hidden}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle .art-volume-loaded{z-index:0;background-color:var(--art-theme);width:100%;height:100%;position:absolute;inset:0}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-indicator{width:var(--art-volume-handle-size);height:var(--art-volume-handle-size);margin-top:calc(var(--art-volume-handle-size)/-2);background-color:var(--art-theme);transition:transform var(--art-transition-duration)ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider:active .art-volume-indicator{transform:scale(.9)}.art-control-volume:hover .art-volume-panel{opacity:1;pointer-events:auto;transform:translateY(0)}.art-video-player .art-notice{z-index:80;width:100%;height:auto;padding:var(--art-padding);pointer-events:none;display:none;position:absolute;inset:0 0 auto}.art-video-player .art-notice .art-notice-inner{border-radius:var(--art-border-radius);background-color:var(--art-tip-background);padding:5px;line-height:1;display:inline-flex}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);min-width:var(--art-contextmenus-min-width);flex-direction:column;padding:5px 0;font-size:12px;display:none;position:absolute}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;border-bottom:1px solid #ffffff1a;padding:10px 15px;display:flex}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 8px}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:var(--art-theme)}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;border-radius:var(--art-border-radius);max-height:var(--art-settings-max-height);left:auto;right:var(--art-padding);bottom:var(--art-control-height);transition:all var(--art-transition-duration)ease;background-color:var(--art-widget-background);flex-direction:column;display:none;position:absolute;overflow:hidden auto}.art-video-player .art-settings .art-setting-panel{flex-direction:column;display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item{cursor:pointer;transition:background-color var(--art-transition-duration)ease;justify-content:space-between;align-items:center;padding:0 5px;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover{background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:var(--art-theme)}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{flex-shrink:0;justify-content:center;align-items:center;gap:5px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:var(--art-settings-icon-size);width:var(--art-settings-icon-size);justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{justify-content:center;align-items:center;gap:5px;font-size:12px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{justify-content:center;align-items:center;min-width:32px;height:24px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{appearance:none;background-color:#fff3;outline:none;width:80px;height:3px}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:flex}.art-video-player .art-info{left:var(--art-padding);top:var(--art-padding);z-index:100;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);padding:10px;font-size:12px;display:none;position:absolute}.art-video-player .art-info .art-info-panel{flex-direction:column;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item{align-items:center;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item .art-info-title{text-align:right;width:100px}.art-video-player .art-info .art-info-panel .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;user-select:all;width:250px;overflow:hidden}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio]{overflow:hidden}.art-video-player[data-aspect-ratio] .art-video{object-fit:fill;box-sizing:content-box}.art-fullscreen{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3}.art-fullscreen-web{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3;z-index:var(--art-fullscreen-web-index);width:100%;height:100%;position:fixed;inset:0}.art-mini-popup{z-index:9999;border-radius:var(--art-border-radius);cursor:move;user-select:none;background:#000;width:320px;height:180px;transition:opacity .2s;position:fixed;overflow:hidden;box-shadow:0 0 5px #00000080}.art-mini-popup svg{fill:#fff}.art-mini-popup .art-video{pointer-events:none}.art-mini-popup .art-mini-close{z-index:20;cursor:pointer;opacity:0;transition:opacity .2s;position:absolute;top:10px;right:10px}.art-mini-popup .art-mini-state{z-index:30;pointer-events:none;opacity:0;background-color:#00000040;justify-content:center;align-items:center;width:100%;height:100%;transition:opacity .2s;display:flex;position:absolute;inset:0}.art-mini-popup .art-mini-state .art-icon{opacity:.75;cursor:pointer;pointer-events:auto;transition:transform .2s;transform:scale(3)}.art-mini-popup .art-mini-state .art-icon:active{transform:scale(2.5)}.art-mini-popup.art-mini-dragging{opacity:.9}.art-mini-popup:hover .art-mini-close,.art-mini-popup:hover .art-mini-state{opacity:1}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-lock{height:var(--art-lock-size);width:var(--art-lock-size);top:50%;left:var(--art-padding);background-color:var(--art-tip-background);border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;transform:translateY(-50%)}.art-video-player .art-layer-auto-playback{border-radius:var(--art-border-radius);left:var(--art-padding);bottom:calc(var(--art-control-height) + var(--art-bottom-gap) + 10px);background-color:var(--art-widget-background);align-items:center;gap:10px;padding:10px;line-height:1;display:none;position:absolute}.art-video-player .art-layer-auto-playback .art-auto-playback-close{cursor:pointer;justify-content:center;align-items:center;display:flex}.art-video-player .art-layer-auto-playback .art-auto-playback-close svg{width:15px;height:15px;fill:var(--art-theme)}.art-video-player .art-layer-auto-playback .art-auto-playback-jump{color:var(--art-theme);cursor:pointer}.art-video-player.art-lock .art-subtitle{bottom:var(--art-subtitle-bottom)!important}.art-video-player.art-mini-progress-bar .art-bottom,.art-video-player.art-lock .art-bottom{opacity:1;background-image:none;padding:0}.art-video-player.art-mini-progress-bar .art-bottom .art-controls,.art-video-player.art-lock .art-bottom .art-controls,.art-video-player.art-mini-progress-bar .art-bottom .art-progress,.art-video-player.art-lock .art-bottom .art-progress{transform:translateY(calc(var(--art-control-height) + var(--art-bottom-gap) + var(--art-progress-height)/4))}.art-video-player.art-mini-progress-bar .art-bottom .art-progress-indicator,.art-video-player.art-lock .art-bottom .art-progress-indicator{display:none!important}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-control-selector{justify-content:center;display:flex;position:relative}.art-control-selector .art-selector-list{text-align:center;border-radius:var(--art-border-radius);opacity:0;pointer-events:none;bottom:var(--art-control-height);max-height:var(--art-selector-max-height);background-color:var(--art-widget-background);transition:all var(--art-transition-duration)ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto;transform:translateY(10px)}.art-control-selector .art-selector-list .art-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex}.art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-control-selector .art-selector-list .art-selector-item:hover,.art-control-selector .art-selector-list .art-selector-item.art-current{color:var(--art-theme)}.art-control-selector:hover .art-selector-list{opacity:1;pointer-events:auto;transform:translateY(0)}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.art-video-player.art-mobile{--art-bottom-gap:10px;--art-control-height:38px;--art-control-icon-scale:1;--art-state-size:60px;--art-settings-max-height:180px;--art-selector-max-height:180px;--art-indicator-scale:1;--art-control-opacity:1}.art-video-player.art-mobile .art-controls-left{margin-left:calc(var(--art-padding)/-1)}.art-video-player.art-mobile .art-controls-right{margin-right:calc(var(--art-padding)/-1)}'},{}],g7VGh:[function(r,t,e,i){t.exports=(function(){function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(p)}var a=Object.prototype.toString,l=function(p){if(p===void 0)return"undefined";if(p===null)return"null";var g=s(p);if(g==="boolean")return"boolean";if(g==="string")return"string";if(g==="number")return"number";if(g==="symbol")return"symbol";if(g==="function")return u(p)==="GeneratorFunction"?"generatorfunction":"function";if(Array.isArray?Array.isArray(p):p instanceof Array)return"array";if(p.constructor&&typeof p.constructor.isBuffer=="function"&&p.constructor.isBuffer(p))return"buffer";if((function(v){try{if(typeof v.length=="number"&&typeof v.callee=="function")return!0}catch(y){if(y.message.indexOf("callee")!==-1)return!0}return!1})(p))return"arguments";if(p instanceof Date||typeof p.toDateString=="function"&&typeof p.getDate=="function"&&typeof p.setDate=="function")return"date";if(p instanceof Error||typeof p.message=="string"&&p.constructor&&typeof p.constructor.stackTraceLimit=="number")return"error";if(p instanceof RegExp||typeof p.flags=="string"&&typeof p.ignoreCase=="boolean"&&typeof p.multiline=="boolean"&&typeof p.global=="boolean")return"regexp";switch(u(p)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(typeof p.throw=="function"&&typeof p.return=="function"&&typeof p.next=="function")return"generator";switch(g=a.call(p)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return g.slice(8,-1).toLowerCase().replace(/\s/g,"")};function u(p){return p.constructor?p.constructor.name:null}function d(p,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return f(p,g,v),h(p,g,v),(function(y,S,T){var A=l(S),b=l(y);if(A==="object"){if(b!=="object")throw Error("[Type Error]: '".concat(T.join("."),"' require 'object' type, but got '").concat(b,"'"));Object.keys(S).forEach(function(R){var C=y[R],D=S[R],N=T.slice();N.push(R),f(C,D,N),h(C,D,N),d(C,D,N)})}if(A==="array"){if(b!=="array")throw Error("[Type Error]: '".concat(T.join("."),"' require 'array' type, but got '").concat(b,"'"));y.forEach(function(R,C){var D=y[C],N=S[C]||S[0],w=T.slice();w.push(C),f(D,N,w),h(D,N,w),d(D,N,w)})}})(p,g,v),p}function f(p,g,v){if(l(g)==="string"){var y=l(p);if(g[0]==="?"&&(g=g.slice(1)+"|undefined"),!(-1<g.indexOf("|")?g.split("|").map(function(S){return S.toLowerCase().trim()}).filter(Boolean).some(function(S){return y===S}):g.toLowerCase().trim()===y))throw Error("[Type Error]: '".concat(v.join("."),"' require '").concat(g,"' type, but got '").concat(y,"'"))}}function h(p,g,v){if(l(g)==="function"){var y=g(p,l(p),v);if(y!==!0){var S=l(y);throw S==="string"?Error(y):S==="error"?y:Error("[Validator Error]: The scheme for '".concat(v.join("."),"' validator require return true, but got '").concat(y,"'"))}}}return d.kindOf=l,d})()},{}],lh3R5:[function(r,t,e,i){t.exports=JSON.parse('{"name":"artplayer","version":"5.3.0","description":"ArtPlayer.js is a modern and full featured HTML5 video player","author":"Harvey Zack <laozhaochaguan@gmail.com>","license":"MIT","homepage":"https://artplayer.org","repository":{"type":"git","url":"git+https://github.com/zhw2590582/ArtPlayer.git"},"bugs":{"url":"https://github.com/zhw2590582/ArtPlayer/issues"},"keywords":["html5","video","player"],"exports":{".":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.mjs","require":"./dist/artplayer.js"},"./legacy":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.legacy.js","require":"./dist/artplayer.legacy.js"},"./i18n/*":{"types":"./types/i18n.d.ts","import":"./dist/i18n/*.mjs","require":"./dist/i18n/*.js"}},"main":"./dist/artplayer.js","module":"./dist/artplayer.mjs","types":"./types/artplayer.d.ts","typesVersions":{"*":{"i18n/*":["types/i18n.d.ts"],"legacy":["types/artplayer.d.ts"]}},"legacy":"./dist/artplayer.legacy.js","browserslist":"last 1 Chrome version","dependencies":{"option-validator":"^2.0.6"}}')},{}],eJfh8:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default={properties:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],loqXi:[function(r,t,e,i){e.interopDefault=function(s){return s&&s.__esModule?s:{default:s}},e.defineInteropFlag=function(s){Object.defineProperty(s,"__esModule",{value:!0})},e.exportAll=function(s,a){return Object.keys(s).forEach(function(l){l==="default"||l==="__esModule"||Object.prototype.hasOwnProperty.call(a,l)||Object.defineProperty(a,l,{enumerable:!0,get:function(){return s[l]}})}),a},e.export=function(s,a,l){Object.defineProperty(s,a,{enumerable:!0,get:l})}},{}],"9zso8":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./aspectRatio"),f=s.interopDefault(d),h=r("./close"),p=s.interopDefault(h),g=r("./flip"),v=s.interopDefault(g),y=r("./info"),S=s.interopDefault(y),T=r("./playbackRate"),A=s.interopDefault(T),b=r("./version"),R=s.interopDefault(b);class C extends u.default{constructor(N){super(N),this.name="contextmenu",this.$parent=N.template.$contextmenu,a.isMobile||this.init()}init(){let{option:N,proxy:w,template:{$player:P,$contextmenu:B}}=this.art;N.playbackRate&&this.add((0,A.default)({name:"playbackRate",index:10})),N.aspectRatio&&this.add((0,f.default)({name:"aspectRatio",index:20})),N.flip&&this.add((0,v.default)({name:"flip",index:30})),this.add((0,S.default)({name:"info",index:40})),this.add((0,R.default)({name:"version",index:50})),this.add((0,p.default)({name:"close",index:60}));for(let M=0;M<N.contextmenu.length;M++)this.add(N.contextmenu[M]);w(P,"contextmenu",M=>{if(!this.art.constructor.CONTEXTMENU)return;M.preventDefault(),this.show=!0;let q=M.clientX,tt=M.clientY,{height:V,width:H,left:X,top:O}=(0,a.getRect)(P),{height:G,width:K}=(0,a.getRect)(B),nt=q-X,ut=tt-O;q+K>X+H&&(nt=H-K),tt+G>O+V&&(ut=V-G),(0,a.setStyles)(B,{top:`${ut}px`,left:`${nt}px`})}),w(P,"click",M=>{(0,a.includeFromEvent)(M,B)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}e.default=C},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"6XHP2","./close":"eF6AX","./flip":"7Wg1P","./info":"fjRnU","./playbackRate":"hm1DY","./version":"aJBeL","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBlEo:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./compatibility");s.exportAll(a,e);var l=r("./dom");s.exportAll(l,e);var u=r("./error");s.exportAll(u,e);var d=r("./file");s.exportAll(d,e);var f=r("./format");s.exportAll(f,e);var h=r("./property");s.exportAll(h,e);var p=r("./subtitle");s.exportAll(p,e);var g=r("./time");s.exportAll(g,e)},{"./compatibility":"jg0yq","./dom":"eANXw","./error":"4FwTI","./file":"i2JbS","./format":"dy9GH","./property":"jY49c","./subtitle":"ke7ox","./time":"f7gsx","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jg0yq:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"userAgent",()=>a),s.export(e,"isSafari",()=>l),s.export(e,"isIOS",()=>u),s.export(e,"isIOS13",()=>d),s.export(e,"isMobile",()=>f),s.export(e,"isBrowser",()=>h);let a=globalThis?.CUSTOM_USER_AGENT??(typeof navigator<"u"?navigator.userAgent:""),l=/^(?:(?!chrome|android).)*safari/i.test(a),u=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream,d=u||a.includes("Macintosh")&&navigator.maxTouchPoints>=1,f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)||d,h=typeof window<"u"&&typeof document<"u"},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eANXw:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"query",()=>l),s.export(e,"queryAll",()=>u),s.export(e,"addClass",()=>d),s.export(e,"removeClass",()=>f),s.export(e,"hasClass",()=>h),s.export(e,"append",()=>p),s.export(e,"remove",()=>g),s.export(e,"setStyle",()=>v),s.export(e,"setStyles",()=>y),s.export(e,"getStyle",()=>S),s.export(e,"siblings",()=>T),s.export(e,"inverseClass",()=>A),s.export(e,"tooltip",()=>b),s.export(e,"isInViewport",()=>R),s.export(e,"includeFromEvent",()=>C),s.export(e,"replaceElement",()=>D),s.export(e,"createElement",()=>N),s.export(e,"getIcon",()=>w),s.export(e,"setStyleText",()=>P),s.export(e,"supportsFlex",()=>B),s.export(e,"getRect",()=>M),s.export(e,"loadImg",()=>q),s.export(e,"getComposedPath",()=>tt);var a=r("./compatibility");function l(V,H=document){return H.querySelector(V)}function u(V,H=document){return Array.from(H.querySelectorAll(V))}function d(V,H){return V.classList.add(H)}function f(V,H){return V.classList.remove(H)}function h(V,H){return V.classList.contains(H)}function p(V,H){return H instanceof Element?V.appendChild(H):V.insertAdjacentHTML("beforeend",String(H)),V.lastElementChild||V.lastChild}function g(V){return V.parentNode.removeChild(V)}function v(V,H,X){return V.style[H]=X,V}function y(V,H){for(let X in H)v(V,X,H[X]);return V}function S(V,H,X=!0){let O=window.getComputedStyle(V,null).getPropertyValue(H);return X?Number.parseFloat(O):O}function T(V){return Array.from(V.parentElement.children).filter(H=>H!==V)}function A(V,H){T(V).forEach(X=>f(X,H)),d(V,H)}function b(V,H,X="top"){a.isMobile||(V.setAttribute("aria-label",H),d(V,"hint--rounded"),d(V,`hint--${X}`))}function R(V,H=0){let X=V.getBoundingClientRect(),O=window.innerHeight||document.documentElement.clientHeight,G=window.innerWidth||document.documentElement.clientWidth,K=X.top-H<=O&&X.top+X.height+H>=0,nt=X.left-H<=G+H&&X.left+X.width+H>=0;return K&&nt}function C(V,H){return tt(V).includes(H)}function D(V,H){return H.parentNode.replaceChild(V,H),V}function N(V){return document.createElement(V)}function w(V="",H=""){let X=N("i");return d(X,"art-icon"),d(X,`art-icon-${V}`),p(X,H),X}function P(V,H){let X=document.getElementById(V);X||((X=document.createElement("style")).id=V,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(X)}):(document.head||document.documentElement).appendChild(X)),X.textContent=H}function B(){let V=document.createElement("div");return V.style.display="flex",V.style.display==="flex"}function M(V){return V.getBoundingClientRect()}function q(V,H){return new Promise((X,O)=>{let G=new Image;G.onload=function(){if(H&&H!==1){let K=document.createElement("canvas"),nt=K.getContext("2d");K.width=G.width*H,K.height=G.height*H,nt.drawImage(G,0,0,K.width,K.height),K.toBlob(ut=>{let k=URL.createObjectURL(ut),j=new Image;j.onload=function(){X(j)},j.onerror=function(){URL.revokeObjectURL(k),O(Error(`Image load failed: ${V}`))},j.src=k})}else X(G)},G.onerror=function(){O(Error(`Image load failed: ${V}`))},G.src=V})}function tt(V){if(V.composedPath)return V.composedPath();let H=[],X=V.target;for(;X;)H.push(X),X=X.parentNode;return H.includes(window)||window===void 0||H.push(window),H}},{"./compatibility":"jg0yq","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4FwTI":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"ArtPlayerError",()=>a),s.export(e,"errorHandle",()=>l);class a extends Error{constructor(d,f){super(d),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,f||this.constructor),this.name="ArtPlayerError"}}function l(u,d){if(!u)throw new a(d);return u}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i2JbS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let d=document.createElement("a");d.style.display="none",d.href=l,d.download=u,document.body.appendChild(d),d.click(),document.body.removeChild(d)}s.defineInteropFlag(e),s.export(e,"getExt",()=>function l(u){return u.includes("?")?l(u.split("?")[0]):u.includes("#")?l(u.split("#")[0]):u.trim().toLowerCase().split(".").pop()}),s.export(e,"download",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dy9GH:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h,p,g){return Math.max(Math.min(h,Math.max(p,g)),Math.min(p,g))}function l(h){return h.charAt(0).toUpperCase()+h.slice(1)}function u(h){if(!h)return"00:00";let p=Math.floor(h/3600),g=Math.floor((h-3600*p)/60),v=Math.floor(h-3600*p-60*g);return(p>0?[p,g,v]:[g,v]).map(y=>y<10?`0${y}`:String(y)).join(":")}function d(h){return h.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}function f(h){let p={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'},g=RegExp(`(${Object.keys(p).join("|")})`,"g");return h.replace(g,v=>p[v]||v)}s.defineInteropFlag(e),s.export(e,"clamp",()=>a),s.export(e,"capitalize",()=>l),s.export(e,"secondToTime",()=>u),s.export(e,"escape",()=>d),s.export(e,"unescape",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jY49c:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"def",()=>a),s.export(e,"has",()=>u),s.export(e,"get",()=>d),s.export(e,"mergeDeep",()=>function f(...h){let p=g=>g&&typeof g=="object"&&!Array.isArray(g);return h.reduce((g,v)=>(Object.keys(v).forEach(y=>{let S=g[y],T=v[y];Array.isArray(S)&&Array.isArray(T)?g[y]=S.concat(...T):p(S)&&p(T)?g[y]=f(S,T):g[y]=T}),g),{})});let a=Object.defineProperty,{hasOwnProperty:l}=Object.prototype;function u(f,h){return l.call(f,h)}function d(f,h){return Object.getOwnPropertyDescriptor(f,h)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ke7ox:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(d){return`WEBVTT \r
\r
`.concat(d.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(f,h,p)=>{let g=p.slice(0,3);return p.length===1&&(g=`${p}00`),p.length===2&&(g=`${p}0`),`${h},${g}`}).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/\{[\s\S]*?\}/g,"").concat(`\r
\r
`))}function l(d){return URL.createObjectURL(new Blob([d],{type:"text/vtt"}))}function u(d){let f=RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function h(p=""){return p.split(/[:.]/).map((g,v,y)=>{if(v===y.length-1){if(g.length===1)return`.${g}00`;if(g.length===2)return`.${g}0`}else if(g.length===1)return(v===0?"0":":0")+g;return v===0?g:v===y.length-1?`.${g}`:`:${g}`}).join("")}return`WEBVTT ${d.split(/\r?\n/).map(p=>{let g=p.match(f);return g?{start:h(g[1].trim()),end:h(g[2].trim()),text:g[5].replace(/\{[\s\S]*?\}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(v=>v.trim()).join(`
`)}:null}).filter(p=>p).map((p,g)=>p?`${g+1} ${p.start} --> ${p.end} ${p.text}`:"").filter(p=>p.trim()).join(`

`)}`}s.defineInteropFlag(e),s.export(e,"srtToVtt",()=>a),s.export(e,"vttToBlob",()=>l),s.export(e,"assToVtt",()=>u)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f7gsx:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(d=0){return new Promise(f=>setTimeout(f,d))}function l(d,f){let h;return function(...p){let g=()=>(h=null,d.apply(this,p));clearTimeout(h),h=setTimeout(g,f)}}function u(d,f){let h=!1;return function(...p){h||(d.apply(this,p),h=!0,setTimeout(()=>{h=!1},f))}}s.defineInteropFlag(e),s.export(e,"sleep",()=>a),s.export(e,"debounce",()=>l),s.export(e,"throttle",()=>u)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],idCEj:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("option-validator"),l=s.interopDefault(a),u=r("../scheme"),d=r("./dom"),f=r("./error");e.default=class{constructor(h){this.id=0,this.art=h,this.cache=new Map,this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.update=this.update.bind(this)}get show(){return(0,d.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(h){let{$player:p}=this.art.template,g=`art-${this.name}-show`;h?(0,d.addClass)(p,g):(0,d.removeClass)(p,g),this.art.emit(this.name,h)}toggle(){this.show=!this.show}add(h){let p=typeof h=="function"?h(this.art):h;if(p.html=p.html||"",(0,l.default)(p,u.ComponentOption),!this.$parent||!this.name||p.disable)return;let g=p.name||`${this.name}${this.id}`,v=this.cache.get(g);(0,f.errorHandle)(!v,`Can't add an existing [${g}] to the [${this.name}]`),this.id+=1;let y=(0,d.createElement)("div");(0,d.addClass)(y,`art-${this.name}`),(0,d.addClass)(y,`art-${this.name}-${g}`);let S=Array.from(this.$parent.children);y.dataset.index=p.index||this.id;let T=S.find(b=>Number(b.dataset.index)>=Number(y.dataset.index));T?T.insertAdjacentElement("beforebegin",y):(0,d.append)(this.$parent,y),p.html&&(0,d.append)(y,p.html),p.style&&(0,d.setStyles)(y,p.style),p.tooltip&&(0,d.tooltip)(y,p.tooltip);let A=[];if(p.click){let b=this.art.events.proxy(y,"click",R=>{R.preventDefault(),p.click.call(this.art,this,R)});A.push(b)}return p.selector&&["left","right"].includes(p.position)&&this.selector(p,y,A),this[g]=y,this.cache.set(g,{$ref:y,events:A,option:p}),p.mounted&&p.mounted.call(this.art,y),y}remove(h){let p=this.cache.get(h);(0,f.errorHandle)(p,`Can't find [${h}] from the [${this.name}]`),p.option.beforeUnmount&&p.option.beforeUnmount.call(this.art,p.$ref);for(let g=0;g<p.events.length;g++)this.art.events.remove(p.events[g]);this.cache.delete(h),delete this[h],(0,d.remove)(p.$ref)}update(h){let p=this.cache.get(h.name);return p&&(h=Object.assign(p.option,h),this.remove(h.name)),this.add(h)}}},{"option-validator":"g7VGh","../scheme":"biLjm","./dom":"eANXw","./error":"4FwTI","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],biLjm:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"ComponentOption",()=>v);var a=r("../utils");let l="array",u="boolean",d="string",f="number",h="object",p="function";function g(y,S,T){return(0,a.errorHandle)(S===d||S===f||y instanceof Element,`${T.join(".")} require '${d}' or 'Element' type`)}let v={html:g,disable:`?${u}`,name:`?${d}`,index:`?${f}`,style:`?${h}`,click:`?${p}`,mounted:`?${p}`,tooltip:`?${d}|${f}`,width:`?${f}`,selector:`?${l}`,onSelect:`?${p}`,switch:`?${u}`,onSwitch:`?${p}`,range:`?${l}`,onRange:`?${p}`,onChange:`?${p}`};e.default={id:d,container:g,url:d,poster:d,type:d,theme:d,lang:d,volume:f,isLive:u,muted:u,autoplay:u,autoSize:u,autoMini:u,loop:u,flip:u,playbackRate:u,aspectRatio:u,screenshot:u,setting:u,hotkey:u,pip:u,mutex:u,backdrop:u,fullscreen:u,fullscreenWeb:u,subtitleOffset:u,miniProgressBar:u,useSSR:u,playsInline:u,lock:u,gesture:u,fastForward:u,autoPlayback:u,autoOrientation:u,airplay:u,proxy:`?${p}`,plugins:[p],layers:[v],contextmenu:[v],settings:[v],controls:[{...v,position:(y,S,T)=>{let A=["top","left","right"];return(0,a.errorHandle)(A.includes(y),`${T.join(".")} only accept ${A.toString()} as parameters`)}}],quality:[{default:`?${u}`,html:d,url:d}],highlight:[{time:f,text:d}],thumbnails:{url:d,number:f,column:f,width:f,height:f,scale:f},subtitle:{url:d,name:d,type:d,style:h,escape:u,encoding:d,onVttLoad:p},moreVideoAttr:h,i18n:h,icons:h,cssVar:h,customType:h}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6XHP2":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{ASPECT_RATIO:h}}=d,p=h.map(g=>`<span data-value="${g}">${g==="default"?f.get("Default"):g}</span>`).join("");return{...u,html:`${f.get("Aspect Ratio")}: ${p}`,click:(g,v)=>{let{value:y}=v.target.dataset;y&&(d.aspectRatio=y,g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="default"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("aspectRatio",y=>{let S=(0,a.queryAll)("span",g).find(T=>T.dataset.value===y);S&&(0,a.inverseClass)(S,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eF6AX:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return u=>({...l,html:u.i18n.get("Close"),click:d=>{d.show=!1}})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7Wg1P":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{FLIP:h}}=d,p=h.map(g=>`<span data-value="${g}">${f.get((0,a.capitalize)(g))}</span>`).join("");return{...u,html:`${f.get("Video Flip")}: ${p}`,click:(g,v)=>{let{value:y}=v.target.dataset;y&&(d.flip=y.toLowerCase(),g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="normal"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("flip",y=>{let S=(0,a.queryAll)("span",g).find(T=>T.dataset.value===y);S&&(0,a.inverseClass)(S,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjRnU:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return u=>({...l,html:u.i18n.get("Video Info"),click:d=>{u.info.show=!0,d.show=!1}})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hm1DY:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{PLAYBACK_RATE:h}}=d,p=h.map(g=>`<span data-value="${g}">${g===1?f.get("Normal"):g.toFixed(1)}</span>`).join("");return{...u,html:`${f.get("Play Speed")}: ${p}`,click:(g,v)=>{let{value:y}=v.target.dataset;y&&(d.playbackRate=Number(y),g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="1"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("video:ratechange",()=>{let y=(0,a.queryAll)("span",g).find(S=>Number(S.dataset.value)===d.playbackRate);y&&(0,a.inverseClass)(y,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aJBeL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>function(l){return{...l,html:`<a href="https://artplayer.org" target="_blank">ArtPlayer ${a.version}</a>`}});var a=r("../../package.json")},{"../../package.json":"lh3R5","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dp1yk:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./airplay"),f=s.interopDefault(d),h=r("./fullscreen"),p=s.interopDefault(h),g=r("./fullscreenWeb"),v=s.interopDefault(g),y=r("./pip"),S=s.interopDefault(y),T=r("./playAndPause"),A=s.interopDefault(T),b=r("./progress"),R=s.interopDefault(b),C=r("./screenshot"),D=s.interopDefault(C),N=r("./setting"),w=s.interopDefault(N),P=r("./time"),B=s.interopDefault(P),M=r("./volume"),q=s.interopDefault(M);class tt extends u.default{constructor(H){super(H),this.isHover=!1,this.name="control",this.timer=Date.now();let{constructor:X}=H,{$player:O,$bottom:G}=this.art.template;H.on("mousemove",()=>{a.isMobile||(this.show=!0)}),H.on("click",()=>{a.isMobile?this.toggle():this.show=!0}),H.on("document:mousemove",K=>{this.isHover=(0,a.includeFromEvent)(K,G)}),H.on("video:timeupdate",()=>{!H.setting.show&&!this.isHover&&!H.isInput&&H.playing&&this.show&&Date.now()-this.timer>=X.CONTROL_HIDE_TIME&&(this.show=!1)}),H.on("control",K=>{K?((0,a.removeClass)(O,"art-hide-cursor"),(0,a.addClass)(O,"art-hover"),this.timer=Date.now()):((0,a.addClass)(O,"art-hide-cursor"),(0,a.removeClass)(O,"art-hover"))}),this.init()}init(){let{option:H}=this.art;H.isLive||this.add((0,R.default)({name:"progress",position:"top",index:10})),this.add({name:"thumbnails",position:"top",index:20}),this.add((0,A.default)({name:"playAndPause",position:"left",index:10})),this.add((0,q.default)({name:"volume",position:"left",index:20})),H.isLive||this.add((0,B.default)({name:"time",position:"left",index:30})),H.quality.length&&(0,a.sleep)().then(()=>{this.art.quality=H.quality}),H.screenshot&&!a.isMobile&&this.add((0,D.default)({name:"screenshot",position:"right",index:20})),H.setting&&this.add((0,w.default)({name:"setting",position:"right",index:30})),H.pip&&this.add((0,S.default)({name:"pip",position:"right",index:40})),H.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,f.default)({name:"airplay",position:"right",index:50})),H.fullscreenWeb&&this.add((0,v.default)({name:"fullscreenWeb",position:"right",index:60})),H.fullscreen&&this.add((0,p.default)({name:"fullscreen",position:"right",index:70}));for(let X=0;X<H.controls.length;X++)this.add(H.controls[X])}add(H){let X=typeof H=="function"?H(this.art):H,{$progress:O,$controlsLeft:G,$controlsRight:K}=this.art.template;switch(X.position){case"top":this.$parent=O;break;case"left":this.$parent=G;break;case"right":this.$parent=K;break;default:(0,a.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(X)}check(H){H.$control_value.innerHTML=H.html;for(let X=0;X<H.$control_option.length;X++){let O=H.$control_option[X];O.default=O===H,O.default&&(0,a.inverseClass)(O.$control_item,"art-current")}}selector(H,X,O){let{proxy:G}=this.art.events;(0,a.addClass)(X,"art-control-selector");let K=(0,a.createElement)("div");(0,a.addClass)(K,"art-selector-value"),(0,a.append)(K,H.html),X.textContent="",(0,a.append)(X,K);let nt=(0,a.createElement)("div");(0,a.addClass)(nt,"art-selector-list"),(0,a.append)(X,nt);for(let k=0;k<H.selector.length;k++){let j=H.selector[k],st=(0,a.createElement)("div");(0,a.addClass)(st,"art-selector-item"),j.default&&(0,a.addClass)(st,"art-current"),st.dataset.index=k,st.dataset.value=j.value,st.innerHTML=j.html,(0,a.append)(nt,st),(0,a.def)(j,"$control_option",{get:()=>H.selector}),(0,a.def)(j,"$control_item",{get:()=>st}),(0,a.def)(j,"$control_value",{get:()=>K})}let ut=G(nt,"click",async k=>{let j=(0,a.getComposedPath)(k),st=H.selector.find(ct=>ct.$control_item===j.find(ft=>ct.$control_item===ft));this.check(st),H.onSelect&&(K.innerHTML=await H.onSelect.call(this.art,st,st.$control_item,k))});O.push(ut)}}e.default=tt},{"../utils":"aBlEo","../utils/component":"idCEj","./airplay":"amOzz","./fullscreen":"3GuBU","./fullscreenWeb":"jj1KV","./pip":"jMeHN","./playAndPause":"u3h8M","./progress":"1XZSS","./screenshot":"dIscA","./setting":"aqA0g","./time":"ihweO","./volume":"fJVWn","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],amOzz:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("AirPlay"),mounted:f=>{let{proxy:h,icons:p}=d;(0,a.append)(f,p.airplay),h(f,"click",()=>d.airplay())}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3GuBU":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Fullscreen"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,v=(0,a.append)(f,p.fullscreenOn),y=(0,a.append)(f,p.fullscreenOff);(0,a.setStyle)(y,"display","none"),h(f,"click",()=>{d.fullscreen=!d.fullscreen}),d.on("fullscreen",S=>{S?((0,a.tooltip)(f,g.get("Exit Fullscreen")),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(y,"display","inline-flex")):((0,a.tooltip)(f,g.get("Fullscreen")),(0,a.setStyle)(v,"display","inline-flex"),(0,a.setStyle)(y,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jj1KV:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Web Fullscreen"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,v=(0,a.append)(f,p.fullscreenWebOn),y=(0,a.append)(f,p.fullscreenWebOff);(0,a.setStyle)(y,"display","none"),h(f,"click",()=>{d.fullscreenWeb=!d.fullscreenWeb}),d.on("fullscreenWeb",S=>{S?((0,a.tooltip)(f,g.get("Exit Web Fullscreen")),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(y,"display","inline-flex")):((0,a.tooltip)(f,g.get("Web Fullscreen")),(0,a.setStyle)(v,"display","inline-flex"),(0,a.setStyle)(y,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jMeHN:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("PIP Mode"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d;(0,a.append)(f,p.pip),h(f,"click",()=>{d.pip=!d.pip}),d.on("pip",v=>{(0,a.tooltip)(f,g.get(v?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],u3h8M:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,v=(0,a.append)(f,p.play),y=(0,a.append)(f,p.pause);function S(){(0,a.setStyle)(v,"display","flex"),(0,a.setStyle)(y,"display","none")}function T(){(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(y,"display","flex")}(0,a.tooltip)(v,g.get("Play")),(0,a.tooltip)(y,g.get("Pause")),h(v,"click",()=>{d.play()}),h(y,"click",()=>{d.pause()}),d.playing?T():S(),d.on("video:playing",()=>{T()}),d.on("video:pause",()=>{S()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1XZSS":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"getPosFromEvent",()=>l),s.export(e,"setCurrentTime",()=>u),s.export(e,"default",()=>d);var a=r("../utils");function l(f,h){let{$progress:p}=f.template,{left:g}=(0,a.getRect)(p),v=a.isMobile?h.touches[0].clientX:h.clientX,y=(0,a.clamp)(v-g,0,p.clientWidth),S=y/p.clientWidth*f.duration,T=(0,a.secondToTime)(S),A=(0,a.clamp)(y/p.clientWidth,0,1);return{second:S,time:T,width:y,percentage:A}}function u(f,h){if(f.isRotate){let p=h.touches[0].clientY/f.height,g=p*f.duration;f.emit("setBar","played",p,h),f.seek=g}else{let{second:p,percentage:g}=l(f,h);f.emit("setBar","played",g,h),f.seek=p}}function d(f){return h=>{let{icons:p,option:g,proxy:v}=h;return{...f,html:'<div class="art-control-progress-inner"><div class="art-progress-hover"></div><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:y=>{let S=null,T=!1,A=(0,a.query)(".art-progress-hover",y),b=(0,a.query)(".art-progress-loaded",y),R=(0,a.query)(".art-progress-played",y),C=(0,a.query)(".art-progress-highlight",y),D=(0,a.query)(".art-progress-indicator",y),N=(0,a.query)(".art-progress-tip",y);function w(P,B){let{width:M,time:q}=B||l(h,P);N.textContent=q;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>y.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${y.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}p.indicator?(0,a.append)(D,p.indicator):(0,a.setStyle)(D,"backgroundColor","var(--art-theme)"),h.on("setBar",function(P,B,M){let q=P==="played"&&M&&a.isMobile;P==="loaded"&&(0,a.setStyle)(b,"width",`${100*B}%`),P==="hover"&&(0,a.setStyle)(A,"width",`${100*B}%`),P==="played"&&((0,a.setStyle)(R,"width",`${100*B}%`),(0,a.setStyle)(D,"left",`${100*B}%`)),q&&((0,a.setStyle)(N,"display","flex"),w(M,{width:y.clientWidth*B,time:(0,a.secondToTime)(B*h.duration)}),clearTimeout(S),S=setTimeout(()=>{(0,a.setStyle)(N,"display","none")},500))}),h.on("video:loadedmetadata",function(){C.textContent="";for(let P=0;P<g.highlight.length;P++){let B=g.highlight[P],M=(0,a.clamp)(B.time,0,h.duration)/h.duration*100,q=`<span data-text="${B.text}" data-time="${B.time}" style="left: ${M}%"></span>`;(0,a.append)(C,q)}}),h.constructor.USE_RAF?h.on("raf",()=>{h.emit("setBar","played",h.played),h.emit("setBar","loaded",h.loaded)}):(h.on("video:timeupdate",()=>{h.emit("setBar","played",h.played)}),h.on("video:progress",()=>{h.emit("setBar","loaded",h.loaded)}),h.on("video:ended",()=>{h.emit("setBar","played",1)})),h.emit("setBar","loaded",h.loaded||0),a.isMobile||(v(y,"click",P=>{P.target!==D&&u(h,P)}),v(y,"mousemove",P=>{let{percentage:B}=l(h,P);if(h.emit("setBar","hover",B,P),(0,a.setStyle)(N,"display","flex"),(0,a.includeFromEvent)(P,C)){let{width:M}=l(h,P),{text:q}=P.target.dataset;N.textContent=q;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>y.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${y.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}else w(P)}),v(y,"mouseleave",P=>{(0,a.setStyle)(N,"display","none"),h.emit("setBar","hover",0,P)}),v(y,"mousedown",P=>{T=P.button===0}),h.on("document:mousemove",P=>{if(T){let{second:B,percentage:M}=l(h,P);h.emit("setBar","played",M,P),h.seek=B}}),h.on("document:mouseup",()=>{T&&(T=!1)}))}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dIscA:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Screenshot"),mounted:f=>{let{proxy:h,icons:p}=d;(0,a.append)(f,p.screenshot),h(f,"click",()=>{d.screenshot()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aqA0g:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Show Setting"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d;(0,a.append)(f,p.setting),h(f,"click",()=>{d.setting.toggle(),d.setting.resize()}),d.on("setting",v=>{(0,a.tooltip)(f,g.get(v?"Hide Setting":"Show Setting"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ihweO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,style:a.isMobile?{fontSize:"12px",padding:"0 5px"}:{cursor:"auto",padding:"0 10px"},mounted:f=>{function h(){let g=`${(0,a.secondToTime)(d.currentTime)} / ${(0,a.secondToTime)(d.duration)}`;g!==f.textContent&&(f.textContent=g)}h();let p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let g=0;g<p.length;g++)d.on(p[g],h)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fJVWn:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,mounted:f=>{let{proxy:h,icons:p}=d,g=(0,a.append)(f,p.volume),v=(0,a.append)(f,p.volumeClose),y=(0,a.append)(f,'<div class="art-volume-panel"></div>'),S=(0,a.append)(y,'<div class="art-volume-inner"></div>'),T=(0,a.append)(S,'<div class="art-volume-val"></div>'),A=(0,a.append)(S,'<div class="art-volume-slider"></div>'),b=(0,a.append)(A,'<div class="art-volume-handle"></div>'),R=(0,a.append)(b,'<div class="art-volume-loaded"></div>'),C=(0,a.append)(A,'<div class="art-volume-indicator"></div>');function D(w){let{top:P,height:B}=(0,a.getRect)(A);return 1-(w.clientY-P)/B}function N(){if(d.muted||d.volume===0)(0,a.setStyle)(g,"display","none"),(0,a.setStyle)(v,"display","flex"),(0,a.setStyle)(C,"top","100%"),(0,a.setStyle)(R,"top","100%"),T.textContent=0;else{let w=100*d.volume;(0,a.setStyle)(g,"display","flex"),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(C,"top",`${100-w}%`),(0,a.setStyle)(R,"top",`${100-w}%`),T.textContent=Math.floor(w)}}if(N(),d.on("video:volumechange",N),h(g,"click",()=>{d.muted=!0}),h(v,"click",()=>{d.muted=!1}),a.isMobile)(0,a.setStyle)(y,"display","none");else{let w=!1;h(A,"mousedown",P=>{w=P.button===0,d.volume=D(P)}),d.on("document:mousemove",P=>{w&&(d.muted=!1,d.volume=D(P))}),d.on("document:mouseup",()=>{w&&(w=!1)})}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jmVSD:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./clickInit"),l=s.interopDefault(a),u=r("./gestureInit"),d=s.interopDefault(u),f=r("./globalInit"),h=s.interopDefault(f),p=r("./hoverInit"),g=s.interopDefault(p),v=r("./moveInit"),y=s.interopDefault(v),S=r("./resizeInit"),T=s.interopDefault(S),A=r("./updateInit"),b=s.interopDefault(A),R=r("./viewInit"),C=s.interopDefault(R);e.default=class{constructor(D){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),(0,l.default)(D,this),(0,g.default)(D,this),(0,y.default)(D,this),(0,T.default)(D,this),(0,d.default)(D,this),(0,C.default)(D,this),(0,h.default)(D,this),(0,b.default)(D,this)}proxy(D,N,w,P={}){if(Array.isArray(N))return N.map(M=>this.proxy(D,M,w,P));D.addEventListener(N,w,P);let B=()=>D.removeEventListener(N,w,P);return this.destroyEvents.push(B),B}hover(D,N,w){N&&this.proxy(D,"mouseenter",N),w&&this.proxy(D,"mouseleave",w)}remove(D){let N=this.destroyEvents.indexOf(D);N>-1&&(D(),this.destroyEvents.splice(N,1))}destroy(){for(let D=0;D<this.destroyEvents.length;D++)this.destroyEvents[D]()}}},{"./clickInit":"i8G6V","./gestureInit":"9wEzB","./globalInit":"ikBrS","./hoverInit":"jwNq0","./moveInit":"eqSsP","./resizeInit":"42JNz","./updateInit":"7kM1M","./viewInit":"2IW9m","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i8G6V:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{constructor:f,template:{$player:h,$video:p}}=u;function g(y){(0,a.includeFromEvent)(y,h)?(u.isInput=y.target.tagName==="INPUT",u.isFocus=!0,u.emit("focus",y)):(u.isInput=!1,u.isFocus=!1,u.emit("blur",y))}u.on("document:click",g),u.on("document:contextmenu",g);let v=[];d.proxy(p,"click",y=>{let S=Date.now();v.push(S);let{MOBILE_CLICK_PLAY:T,DBCLICK_TIME:A,MOBILE_DBCLICK_PLAY:b,DBCLICK_FULLSCREEN:R}=f,C=v.filter(D=>S-D<=A);switch(C.length){case 1:u.emit("click",y),a.isMobile?!u.isLock&&T&&u.toggle():u.toggle(),v=C;break;case 2:u.emit("dblclick",y),a.isMobile?!u.isLock&&b&&u.toggle():R&&(u.fullscreen=!u.fullscreen),v=[];break;default:v=[]}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"9wEzB":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>u);var a=r("../control/progress"),l=r("../utils");function u(d,f){if(l.isMobile&&!d.option.isLive){let{$video:h,$progress:p}=d.template,g=null,v=!1,y=0,S=0,T=0,A=R=>{if(R.touches.length===1&&!d.isLock){g===p&&(0,a.setCurrentTime)(d,R),v=!0;let{pageX:C,pageY:D}=R.touches[0];y=C,S=D,T=d.currentTime}},b=R=>{if(R.touches.length===1&&v&&d.duration){let{pageX:C,pageY:D}=R.touches[0],N=(function(B,M,q,tt){let V=M-tt,H=q-B,X=0;if(2>Math.abs(H)&&2>Math.abs(V))return X;let O=180*Math.atan2(V,H)/Math.PI;return O>=-45&&O<45?X=4:O>=45&&O<135?X=1:O>=-135&&O<-45?X=2:(O>=135&&O<=180||O>=-180&&O<-135)&&(X=3),X})(y,S,C,D),w=[3,4].includes(N),P=[1,2].includes(N);if(w&&!d.isRotate||P&&d.isRotate){let B=(0,l.clamp)((C-y)/d.width,-1,1),M=(0,l.clamp)((D-S)/d.height,-1,1),q=d.isRotate?M:B,tt=g===h?d.constructor.TOUCH_MOVE_RATIO:1,V=(0,l.clamp)(T+d.duration*q*tt,0,d.duration);d.seek=V,d.emit("setBar","played",(0,l.clamp)(V/d.duration,0,1),R),d.notice.show=`${(0,l.secondToTime)(V)} / ${(0,l.secondToTime)(d.duration)}`}}};d.option.gesture&&(f.proxy(h,"touchstart",R=>{g=h,A(R)}),f.proxy(h,"touchmove",b)),f.proxy(p,"touchstart",R=>{g=p,A(R)}),f.proxy(p,"touchmove",b),d.on("document:touchend",()=>{v&&(y=0,S=0,T=0,v=!1,g=null)})}}},{"../control/progress":"1XZSS","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ikBrS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let d=["click","mouseup","keydown","touchend","touchmove","mousemove","pointerup","contextmenu","pointermove","visibilitychange","webkitfullscreenchange"],f=["resize","scroll","orientationchange"],h=[];function p(g={}){for(let y=0;y<h.length;y++)u.remove(h[y]);h.length=0;let{$player:v}=l.template;d.forEach(y=>{let S=g.document||v.ownerDocument||document,T=u.proxy(S,y,A=>{l.emit(`document:${y}`,A)});h.push(T)}),f.forEach(y=>{let S=g.window||v.ownerDocument?.defaultView||window,T=u.proxy(S,y,A=>{l.emit(`window:${y}`,A)});h.push(T)})}p(),u.bindGlobalEvents=p}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jwNq0:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{$player:f}=u.template;d.hover(f,h=>{(0,a.addClass)(f,"art-hover"),u.emit("hover",!0,h)},h=>{(0,a.removeClass)(f,"art-hover"),u.emit("hover",!1,h)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eqSsP:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let{$player:d}=l.template;u.proxy(d,"mousemove",f=>{l.emit("mousemove",f)})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"42JNz":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{option:f,constructor:h}=u;u.on("resize",()=>{let{aspectRatio:g,notice:v}=u;u.state==="standard"&&f.autoSize&&u.autoSize(),u.aspectRatio=g,v.show=""});let p=(0,a.debounce)(()=>u.emit("resize"),h.RESIZE_TIME);u.on("window:orientationchange",()=>p()),u.on("window:resize",()=>p()),screen&&screen.orientation&&screen.orientation.onchange&&d.proxy(screen.orientation,"change",()=>p())}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7kM1M":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){if(l.constructor.USE_RAF){let u=null;(function d(){l.playing&&l.emit("raf"),l.isDestroy||(u=requestAnimationFrame(d))})(),l.on("destroy",()=>{cancelAnimationFrame(u)})}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2IW9m":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,constructor:f,template:{$container:h}}=u,p=(0,a.throttle)(()=>{u.emit("view",(0,a.isInViewport)(h,f.SCROLL_GAP))},f.SCROLL_TIME);u.on("window:scroll",()=>p()),u.on("view",g=>{d.autoMini&&(u.mini=!g)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dswts:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("./utils");e.default=class{constructor(a){this.art=a,this.keys={},a.option.hotkey&&!s.isMobile&&this.init()}init(){let{constructor:a}=this.art;this.add("Escape",()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add("Space",()=>{this.art.toggle()}),this.add("ArrowLeft",()=>{this.art.backward=a.SEEK_STEP}),this.add("ArrowUp",()=>{this.art.volume+=a.VOLUME_STEP}),this.add("ArrowRight",()=>{this.art.forward=a.SEEK_STEP}),this.add("ArrowDown",()=>{this.art.volume-=a.VOLUME_STEP}),this.art.on("document:keydown",l=>{if(this.art.isFocus){let u=document.activeElement.tagName.toUpperCase(),d=document.activeElement.getAttribute("contenteditable");if(u!=="INPUT"&&u!=="TEXTAREA"&&d!==""&&d!=="true"&&!l.altKey&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey){let f=this.keys[l.code];if(f){l.preventDefault();for(let h=0;h<f.length;h++)f[h].call(this.art,l);this.art.emit("hotkey",l)}}}this.art.emit("keydown",l)})}add(a,l){return this.keys[a]?this.keys[a].push(l):this.keys[a]=[l],this}remove(a,l){if(this.keys[a]){let u=this.keys[a].indexOf(l);u!==-1&&this.keys[a].splice(u,1)}return this}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d9ktO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("./zh-cn"),u=s.interopDefault(l);e.default=class{constructor(d){this.art=d,this.languages={"zh-cn":u.default},this.language={},this.update(d.option.i18n)}init(){let d=this.art.option.lang.toLowerCase();this.language=this.languages[d]||{}}get(d){return this.language[d]||d}update(d){this.languages=(0,a.mergeDeep)(this.languages,d),this.init()}}},{"../utils":"aBlEo","./zh-cn":"3hyaR","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3hyaR":[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let s={"Video Info":"",Close:"","Video Load Failed":"",Volume:"",Play:"",Pause:"",Rate:"",Mute:"","Video Flip":"",Horizontal:"",Vertical:"",Reconnect:"","Show Setting":"","Hide Setting":"",Screenshot:"","Play Speed":"","Aspect Ratio":"",Default:"",Normal:"",Open:"","Switch Video":"","Switch Subtitle":"",Fullscreen:"","Exit Fullscreen":"","Web Fullscreen":"","Exit Web Fullscreen":"","Mini Player":"","PIP Mode":"","Exit PIP Mode":"","PIP Not Supported":"","Fullscreen Not Supported":"","Subtitle Offset":"","Last Seen":"","Jump Play":"",AirPlay:"","AirPlay Not Available":""};e.default=s,typeof window<"u"&&(window["artplayer-i18n-zh-cn"]=s)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fFHY0:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("bundle-text:./airplay.svg"),l=s.interopDefault(a),u=r("bundle-text:./arrow-left.svg"),d=s.interopDefault(u),f=r("bundle-text:./arrow-right.svg"),h=s.interopDefault(f),p=r("bundle-text:./aspect-ratio.svg"),g=s.interopDefault(p),v=r("bundle-text:./check.svg"),y=s.interopDefault(v),S=r("bundle-text:./close.svg"),T=s.interopDefault(S),A=r("bundle-text:./config.svg"),b=s.interopDefault(A),R=r("bundle-text:./error.svg"),C=s.interopDefault(R),D=r("bundle-text:./flip.svg"),N=s.interopDefault(D),w=r("bundle-text:./fullscreen-off.svg"),P=s.interopDefault(w),B=r("bundle-text:./fullscreen-on.svg"),M=s.interopDefault(B),q=r("bundle-text:./fullscreen-web-off.svg"),tt=s.interopDefault(q),V=r("bundle-text:./fullscreen-web-on.svg"),H=s.interopDefault(V),X=r("bundle-text:./loading.svg"),O=s.interopDefault(X),G=r("bundle-text:./lock.svg"),K=s.interopDefault(G),nt=r("bundle-text:./pause.svg"),ut=s.interopDefault(nt),k=r("bundle-text:./pip.svg"),j=s.interopDefault(k),st=r("bundle-text:./play.svg"),ct=s.interopDefault(st),ft=r("bundle-text:./playback-rate.svg"),dt=s.interopDefault(ft),Et=r("bundle-text:./screenshot.svg"),Lt=s.interopDefault(Et),_t=r("bundle-text:./setting.svg"),ie=s.interopDefault(_t),pe=r("bundle-text:./state.svg"),_e=s.interopDefault(pe),Oe=r("bundle-text:./switch-off.svg"),Ce=s.interopDefault(Oe),$i=r("bundle-text:./switch-on.svg"),bt=s.interopDefault($i),pt=r("bundle-text:./unlock.svg"),be=s.interopDefault(pt),le=r("bundle-text:./volume-close.svg"),ue=s.interopDefault(le),ke=r("bundle-text:./volume.svg"),je=s.interopDefault(ke),He=r("../utils");e.default=class{constructor(ne){let un={loading:O.default,state:_e.default,play:ct.default,pause:ut.default,check:y.default,volume:je.default,volumeClose:ue.default,screenshot:Lt.default,setting:ie.default,pip:j.default,arrowLeft:d.default,arrowRight:h.default,playbackRate:dt.default,aspectRatio:g.default,config:b.default,lock:K.default,flip:N.default,unlock:be.default,fullscreenOff:P.default,fullscreenOn:M.default,fullscreenWebOff:tt.default,fullscreenWebOn:H.default,switchOn:bt.default,switchOff:Ce.default,error:C.default,close:T.default,airplay:l.default,...ne.option.icons};for(let Xe in un)(0,He.def)(this,Xe,{get:()=>(0,He.getIcon)(Xe,un[Xe])})}}},{"bundle-text:./airplay.svg":"gkZgZ","bundle-text:./arrow-left.svg":"kQyD4","bundle-text:./arrow-right.svg":"64ztm","bundle-text:./aspect-ratio.svg":"72LvA","bundle-text:./check.svg":"4QmBo","bundle-text:./close.svg":"j1hoe","bundle-text:./config.svg":"hNZaT","bundle-text:./error.svg":"dKh4l","bundle-text:./flip.svg":"lIEIE","bundle-text:./fullscreen-off.svg":"1533e","bundle-text:./fullscreen-on.svg":"76ut3","bundle-text:./fullscreen-web-off.svg":"3NzMk","bundle-text:./fullscreen-web-on.svg":"12xHc","bundle-text:./loading.svg":"iVcUF","bundle-text:./lock.svg":"1J4so","bundle-text:./pause.svg":"1KgkK","bundle-text:./pip.svg":"4h4tM","bundle-text:./play.svg":"jecAY","bundle-text:./playback-rate.svg":"anPe9","bundle-text:./screenshot.svg":"9BPYQ","bundle-text:./setting.svg":"hsI9k","bundle-text:./state.svg":"gr1ZU","bundle-text:./switch-off.svg":"6kdAr","bundle-text:./switch-on.svg":"ksdMo","bundle-text:./unlock.svg":"iz5Qc","bundle-text:./volume-close.svg":"3OZoa","bundle-text:./volume.svg":"hRYA4","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],gkZgZ:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/><path d="M4 17h10l-5-6Z"/></svg>'},{}],kQyD4:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6Z"/></svg>'},{}],"64ztm":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6Z"/></svg>'},{}],"72LvA":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;transform:translate(0)" viewBox="0 0 88 88"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0Z"/></clipPath></defs><g clip-path="url(#__lottie_element_216)"><g style="display:block"><path d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 1.4495849676166017e-7l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31C14.488-13.492 13.228-13.492 12.438-12.702m-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13ZM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8Z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></g></svg>'},{}],"4QmBo":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%" viewBox="0 0 24 24"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4Z"/></svg>'},{}],j1hoe:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733C823.467 166.4 797.867 166.4 780.8 183.466L512 452.267l-268.8-268.8C226.133 166.4 200.533 166.4 183.467 183.466c-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733Z"/></svg>'},{}],hNZaT:[function(r,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M15 17h6v1h-6Zm-4 0H3v1h8v2h1v-5h-1Zm3-9h1V3h-1v2H3v1h11Zm4-3v1h3V5ZM6 14h1V9H6v2H3v1h3Zm4-2h11v-1H10Z" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],dKh4l:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.1 93.1 0 0 1 34.447 33.341M512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88m0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2"/></svg>'},{}],lIEIE:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon" viewBox="0 0 1024 1024"><path d="M554.667 810.667V896h-85.333v-85.333Zm-384-632.662a42.67 42.67 0 0 1 34.987 18.219l203.903 291.328a42.67 42.67 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667m682.666 0a42.667 42.667 0 0 1 42.368 37.717l.299 4.95v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.67 42.67 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.67 42.67 0 0 1 34.944-18.219M554.667 640v85.333h-85.333V640Zm-358.4-320.896V716.8L335.957 512 196.31 319.104Zm358.4 150.23v85.333h-85.333v-85.333Zm0-170.667V384h-85.333v-85.333Zm0-170.667v85.333h-85.333V128Z"/></svg>'},{}],"1533e":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M768 298.667h170.667V384h-256V128H768ZM341.333 384h-256v-85.333H256V128h85.333ZM768 725.333V896h-85.333V640h256v85.333ZM341.333 640v256H256V725.333H85.333V640Z"/></svg>'},{}],"76ut3":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M625.778 256H768v142.222h113.778v-256h-256ZM256 398.222V256h142.222V142.222h-256v256Zm512 227.556V768H625.778v113.778h256v-256ZM398.222 768H256V625.778H142.222v256h256Z"/></svg>'},{}],"3NzMk":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128ZM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384Zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448Z"/></svg>'},{}],"12xHc":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128Zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448Zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384Z"/></svg>'},{}],iVcUF:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" class="uil-default" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><path fill="none" d="M0 0h100v100H0Z" class="bk"/><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="translate(0 -30)"><animate attributeName="opacity" begin="-1s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(30 105.98 65)"><animate attributeName="opacity" begin="-0.9166666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(60 75.98 65)"><animate attributeName="opacity" begin="-0.8333333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(90 65 65)"><animate attributeName="opacity" begin="-0.75s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(120 58.66 65)"><animate attributeName="opacity" begin="-0.6666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(150 54.02 65)"><animate attributeName="opacity" begin="-0.5833333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="matrix(-1 0 0 -1 100 130)"><animate attributeName="opacity" begin="-0.5s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(210 45.98 65)"><animate attributeName="opacity" begin="-0.4166666666666667s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(240 41.34 65)"><animate attributeName="opacity" begin="-0.3333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-90 35 65)"><animate attributeName="opacity" begin="-0.25s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" begin="-0.16666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" begin="-0.08333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect></svg>'},{}],"1J4so":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="M298.667 426.667v-85.333a213.333 213.333 0 1 1 426.667 0v85.333H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667ZM512 213.333a128 128 0 0 0-128 128v85.333h256v-85.333a128 128 0 0 0-128-128"/></svg>'},{}],"1KgkK":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2m8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2"/></svg>'},{}],"4h4tM":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 1024 1024"><path d="M844.8 219.648H179.2c-6.144 0-10.24 4.608-10.24 10.752v563.2c0 5.632 4.096 10.24 10.24 10.24h256V896h-256A102.4 102.4 0 0 1 76.8 793.6V230.4c0-56.832 45.568-102.4 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v204.8h-92.16V230.4c0-6.144-4.608-10.752-10.24-10.752M614.4 588.8c-28.672 0-51.2 22.528-51.2 51.2v204.8c0 28.16 22.528 51.2 51.2 51.2H896c28.16 0 51.2-23.04 51.2-51.2V640c0-28.672-23.04-51.2-51.2-51.2Z"/></svg>'},{}],jecAY:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45"/></svg>'},{}],anPe9:[function(r,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M10 8v8l6-4ZM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2M5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8m0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4Zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22ZM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"9BPYQ":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10m0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8"/></svg>'},{}],hsI9k:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a7 7 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1 1 0 0 0-1.272.23l-1.008 1.225a7 7 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A7 7 0 0 0 4.4 8.6l-1.564.261A1 1 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.1 7.1 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a1 1 0 0 0 .835-.986V9.847a1 1 0 0 0-.836-.986M11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8"/></svg>'},{}],gr1ZU:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><path d="M9.5 9.325v5.35q0 .575.525.875t1.025-.05l4.15-2.65q.475-.3.475-.85t-.475-.85L11.05 8.5q-.5-.35-1.025-.05t-.525.875M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12t.788-3.9 2.137-3.175q1.35-1.35 3.175-2.137T12 2t3.9.788 3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22"/></svg>'},{}],"6kdAr":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1740 1024"><path d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898m-.564-975.36A464.589 464.589 0 1 1 48.025 513.024 463.87 463.87 0 0 1 511.335 48.435Z"/></svg>'},{}],ksdMo:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1664 1024"><path fill="#648ffc" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448"/></svg>'},{}],iz5Qc:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.333a213.333 213.333 0 0 1 368.085-146.816"/></svg>'},{}],"3OZoa":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M15 11a4 4 0 0 0-2-3.465v2.636l1.865 1.865A4 4 0 0 0 15 11"/><path d="M13.583 5.583A6 6 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8 8 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805m5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806q.322-.154.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416M11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172Z"/></svg>'},{}],hRYA4:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39m4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8 8 0 0 0 19 11a8 8 0 0 0-4.554-7.222"/><path d="M15 11a4 4 0 0 0-2-3.465v6.93A4 4 0 0 0 15 11"/></svg>'},{}],kZ0F8:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="info",a.isMobile||this.init()}init(){let{proxy:h,constructor:p,template:{$infoPanel:g,$infoClose:v,$video:y}}=this.art;h(v,"click",()=>{this.show=!1});let S=null,T=(0,a.queryAll)("[data-video]",g)||[];this.art.on("destroy",()=>clearTimeout(S)),(function A(){for(let b=0;b<T.length;b++){let R=T[b],C=y[R.dataset.video],D=typeof C=="number"?C.toFixed(2):C;R.textContent!==D&&(R.textContent=D)}S=setTimeout(A,p.INFO_LOOP_TIME)})()}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j9lbi:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils/component"),l=s.interopDefault(a);class u extends l.default{constructor(f){super(f);let{option:h,template:{$layer:p}}=f;this.name="layer",this.$parent=p;for(let g=0;g<h.layers.length;g++)this.add(h.layers[g])}}e.default=u},{"./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bMjWd:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="loading",(0,a.append)(h.template.$loading,h.icons.loading)}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k1nkQ:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="mask";let{template:p,icons:g,events:v}=h,y=(0,a.append)(p.$state,g.state),S=(0,a.append)(p.$state,g.error);(0,a.setStyle)(S,"display","none"),h.on("destroy",()=>{(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(S,"display",null)}),v.proxy(p.$state,"click",()=>h.play())}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fPVaU:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("./utils");e.default=class{constructor(a){this.art=a,this.timer=null}set show(a){let{constructor:l,template:{$player:u,$noticeInner:d}}=this.art;a?(d.textContent=a instanceof Error?a.message.trim():a,(0,s.addClass)(u,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{d.textContent="",(0,s.removeClass)(u,"art-notice-show")},l.NOTICE_TIME)):(0,s.removeClass)(u,"art-notice-show")}get show(){let{template:{$player:a}}=this.art;return a.classList.contains("art-notice-show")}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],uR0Sw:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./airplayMix"),l=s.interopDefault(a),u=r("./aspectRatioMix"),d=s.interopDefault(u),f=r("./attrMix"),h=s.interopDefault(f),p=r("./autoHeightMix"),g=s.interopDefault(p),v=r("./autoSizeMix"),y=s.interopDefault(v),S=r("./cssVarMix"),T=s.interopDefault(S),A=r("./currentTimeMix"),b=s.interopDefault(A),R=r("./durationMix"),C=s.interopDefault(R),D=r("./eventInit"),N=s.interopDefault(D),w=r("./flipMix"),P=s.interopDefault(w),B=r("./fullscreenMix"),M=s.interopDefault(B),q=r("./fullscreenWebMix"),tt=s.interopDefault(q),V=r("./loadedMix"),H=s.interopDefault(V),X=r("./miniMix"),O=s.interopDefault(X),G=r("./optionInit"),K=s.interopDefault(G),nt=r("./pauseMix"),ut=s.interopDefault(nt),k=r("./pipMix"),j=s.interopDefault(k),st=r("./playbackRateMix"),ct=s.interopDefault(st),ft=r("./playedMix"),dt=s.interopDefault(ft),Et=r("./playingMix"),Lt=s.interopDefault(Et),_t=r("./playMix"),ie=s.interopDefault(_t),pe=r("./posterMix"),_e=s.interopDefault(pe),Oe=r("./qualityMix"),Ce=s.interopDefault(Oe),$i=r("./rectMix"),bt=s.interopDefault($i),pt=r("./screenshotMix"),be=s.interopDefault(pt),le=r("./seekMix"),ue=s.interopDefault(le),ke=r("./stateMix"),je=s.interopDefault(ke),He=r("./subtitleOffsetMix"),ne=s.interopDefault(He),un=r("./switchMix"),Xe=s.interopDefault(un),ys=r("./themeMix"),Bn=s.interopDefault(ys),Qs=r("./thumbnailsMix"),vs=s.interopDefault(Qs),cn=r("./toggleMix"),Bu=s.interopDefault(cn),Es=r("./typeMix"),ze=s.interopDefault(Es),ji=r("./urlMix"),Ve=s.interopDefault(ji),Uu=r("./volumeMix"),$u=s.interopDefault(Uu);e.default=class{constructor(Ot){(0,Ve.default)(Ot),(0,h.default)(Ot),(0,ie.default)(Ot),(0,ut.default)(Ot),(0,Bu.default)(Ot),(0,ue.default)(Ot),(0,$u.default)(Ot),(0,b.default)(Ot),(0,C.default)(Ot),(0,Xe.default)(Ot),(0,ct.default)(Ot),(0,d.default)(Ot),(0,be.default)(Ot),(0,M.default)(Ot),(0,tt.default)(Ot),(0,j.default)(Ot),(0,H.default)(Ot),(0,dt.default)(Ot),(0,Lt.default)(Ot),(0,y.default)(Ot),(0,bt.default)(Ot),(0,P.default)(Ot),(0,O.default)(Ot),(0,_e.default)(Ot),(0,g.default)(Ot),(0,T.default)(Ot),(0,Bn.default)(Ot),(0,ze.default)(Ot),(0,je.default)(Ot),(0,ne.default)(Ot),(0,l.default)(Ot),(0,Ce.default)(Ot),(0,vs.default)(Ot),(0,N.default)(Ot),(0,K.default)(Ot)}}},{"./airplayMix":"d8BTB","./aspectRatioMix":"aQNJl","./attrMix":"5DA9e","./autoHeightMix":"1swKn","./autoSizeMix":"lSbiD","./cssVarMix":"32Hp1","./currentTimeMix":"kfZbu","./durationMix":"eV1ag","./eventInit":"f8NQq","./flipMix":"ea3Qm","./fullscreenMix":"ffXE3","./fullscreenWebMix":"8tarF","./loadedMix":"f9syH","./miniMix":"dLuS7","./optionInit":"d1F69","./pauseMix":"kewk9","./pipMix":"4XzDs","./playbackRateMix":"jphfi","./playedMix":"iNpeS","./playingMix":"aBIWL","./playMix":"hRBri","./posterMix":"fgfXC","./qualityMix":"17rUP","./rectMix":"55qzI","./screenshotMix":"bC6TG","./seekMix":"j8GRO","./stateMix":"cn7iR","./subtitleOffsetMix":"2k4nP","./switchMix":"6SU6j","./themeMix":"7iMuh","./thumbnailsMix":"6P0RS","./toggleMix":"eNi78","./typeMix":"7AUBD","./urlMix":"cnlLL","./volumeMix":"iX66j","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d8BTB:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,proxy:h,template:{$video:p}}=u,g=!0;window.WebKitPlaybackTargetAvailabilityEvent&&p.webkitShowPlaybackTargetPicker?h(p,"webkitplaybacktargetavailabilitychanged",v=>{switch(v.availability){case"available":g=!0;break;case"not-available":g=!1}}):g=!1,(0,a.def)(u,"airplay",{value(){g?(p.webkitShowPlaybackTargetPicker(),u.emit("airplay")):f.show=d.get("AirPlay Not Available")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aQNJl:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,template:{$video:h,$player:p}}=u;(0,a.def)(u,"aspectRatio",{get:()=>p.dataset.aspectRatio||"default",set(g){if(g||(g="default"),g==="default")(0,a.setStyle)(h,"width",null),(0,a.setStyle)(h,"height",null),(0,a.setStyle)(h,"margin",null),delete p.dataset.aspectRatio;else{let v=g.split(":").map(Number),{clientWidth:y,clientHeight:S}=p,T=v[0]/v[1];y/S>T?((0,a.setStyle)(h,"width",`${T*S}px`),(0,a.setStyle)(h,"height","100%"),(0,a.setStyle)(h,"margin","0 auto")):((0,a.setStyle)(h,"width","100%"),(0,a.setStyle)(h,"height",`${y/T}px`),(0,a.setStyle)(h,"margin","auto 0")),p.dataset.aspectRatio=g}f.show=`${d.get("Aspect Ratio")}: ${g==="default"?d.get("Default"):g}`,u.emit("aspectRatio",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"5DA9e":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d}}=u;(0,a.def)(u,"attr",{value(f,h){if(h===void 0)return d[f];d[f]=h}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1swKn":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$container:d,$video:f}}=u;(0,a.def)(u,"autoHeight",{value(){let{clientWidth:h}=d,{videoHeight:p,videoWidth:g}=f,v=h/g*p;(0,a.setStyle)(d,"height",`${v}px`),u.emit("autoHeight",v)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],lSbiD:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$container:d,$player:f,$video:h}=u.template;(0,a.def)(u,"autoSize",{value(){let{videoWidth:p,videoHeight:g}=h,{width:v,height:y}=(0,a.getRect)(d),S=p/g;v/y>S?((0,a.setStyle)(f,"width",`${y*S/v*100}%`),(0,a.setStyle)(f,"height","100%")):((0,a.setStyle)(f,"width","100%"),(0,a.setStyle)(f,"height",`${v/S/y*100}%`)),u.emit("autoSize",{width:u.width,height:u.height})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"32Hp1":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$player:d}=u.template;(0,a.def)(u,"cssVar",{value:(f,h)=>h?d.style.setProperty(f,h):getComputedStyle(d).getPropertyValue(f)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kfZbu:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"currentTime",{get:()=>d.currentTime||0,set:f=>{Number.isNaN(f=Number.parseFloat(f))||(d.currentTime=(0,a.clamp)(f,0,u.duration))}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eV1ag:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"duration",{get:()=>{let{duration:d}=u.template.$video;return d===1/0?0:d||0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f8NQq:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>d);var a=r("../config"),l=s.interopDefault(a),u=r("../utils");function d(f){let{i18n:h,notice:p,option:g,constructor:v,proxy:y,template:{$player:S,$video:T,$poster:A}}=f,b=0;for(let R=0;R<l.default.events.length;R++)y(T,l.default.events[R],C=>{f.emit(`video:${C.type}`,C)});f.on("video:canplay",()=>{b=0,f.loading.show=!1}),f.once("video:canplay",()=>{f.loading.show=!1,f.controls.show=!0,f.mask.show=!0,f.isReady=!0,f.emit("ready")}),f.on("video:ended",()=>{g.loop?(f.seek=0,f.play(),f.controls.show=!1,f.mask.show=!1):(f.controls.show=!0,f.mask.show=!0)}),f.on("video:error",async R=>{b<v.RECONNECT_TIME_MAX?(await(0,u.sleep)(v.RECONNECT_SLEEP_TIME),b+=1,f.url=g.url,p.show=`${h.get("Reconnect")}: ${b}`,f.emit("error",R,b)):(f.mask.show=!0,f.loading.show=!1,f.controls.show=!0,(0,u.addClass)(S,"art-error"),await(0,u.sleep)(v.RECONNECT_SLEEP_TIME),p.show=h.get("Video Load Failed"))}),f.on("video:loadedmetadata",()=>{f.emit("resize"),u.isMobile&&(f.loading.show=!1,f.controls.show=!0,f.mask.show=!0)}),f.on("video:loadstart",()=>{f.loading.show=!0,f.mask.show=!1,f.controls.show=!0}),f.on("video:pause",()=>{f.controls.show=!0,f.mask.show=!0}),f.on("video:play",()=>{f.mask.show=!1,(0,u.setStyle)(A,"display","none")}),f.on("video:playing",()=>{f.mask.show=!1}),f.on("video:progress",()=>{f.playing&&(f.loading.show=!1)}),f.on("video:seeked",()=>{f.loading.show=!1,f.mask.show=!0}),f.on("video:seeking",()=>{f.loading.show=!0,f.mask.show=!1}),f.on("video:timeupdate",()=>{f.mask.show=!1}),f.on("video:waiting",()=>{f.loading.show=!0,f.mask.show=!1})}},{"../config":"eJfh8","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ea3Qm:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$player:d},i18n:f,notice:h}=u;(0,a.def)(u,"flip",{get:()=>d.dataset.flip||"normal",set(p){p||(p="normal"),p==="normal"?delete d.dataset.flip:d.dataset.flip=p,h.show=`${f.get("Video Flip")}: ${f.get((0,a.capitalize)(p))}`,u.emit("flip",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ffXE3:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>d);var a=r("../libs/screenfull"),l=s.interopDefault(a),u=r("../utils");function d(f){let{i18n:h,notice:p,template:{$video:g,$player:v}}=f;f.once("video:loadedmetadata",()=>{l.default.isEnabled?(l.default.on("change",()=>{f.emit("fullscreen",l.default.isFullscreen),l.default.isFullscreen?(f.state="fullscreen",(0,u.addClass)(v,"art-fullscreen")):(0,u.removeClass)(v,"art-fullscreen"),f.emit("resize")}),l.default.on("error",y=>{f.emit("fullscreenError",y)}),(0,u.def)(f,"fullscreen",{get:()=>l.default.isFullscreen,async set(y){y?await l.default.request(v):await l.default.exit()}})):g.webkitSupportsFullscreen?(f.on("document:webkitfullscreenchange",()=>{f.emit("fullscreen",f.fullscreen),f.emit("resize")}),(0,u.def)(f,"fullscreen",{get:()=>document.fullscreenElement===g,set(y){y?(f.state="fullscreen",g.webkitEnterFullscreen()):g.webkitExitFullscreen()}})):(0,u.def)(f,"fullscreen",{get:()=>!1,set(){p.show=h.get("Fullscreen Not Supported")}}),(0,u.def)(f,"fullscreen",(0,u.get)(f,"fullscreen"))})}},{"../libs/screenfull":"iSPAQ","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iSPAQ:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let s=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{if(typeof document>"u")return!1;let d=s[0],f={};for(let h of s)if(h[1]in document){for(let[p,g]of h.entries())f[d[p]]=g;return f}return!1})(),l={change:a.fullscreenchange,error:a.fullscreenerror},u={request:(d=document.documentElement,f)=>new Promise((h,p)=>{let g=()=>{u.off("change",g),h()};u.on("change",g);let v=d[a.requestFullscreen](f);v instanceof Promise&&v.then(g).catch(p)}),exit:()=>new Promise((d,f)=>{if(!u.isFullscreen)return void d();let h=()=>{u.off("change",h),d()};u.on("change",h);let p=document[a.exitFullscreen]();p instanceof Promise&&p.then(h).catch(f)}),toggle:(d,f)=>u.isFullscreen?u.exit():u.request(d,f),onchange(d){u.on("change",d)},onerror(d){u.on("error",d)},on(d,f){let h=l[d];h&&document.addEventListener(h,f,!1)},off(d,f){let h=l[d];h&&document.removeEventListener(h,f,!1)},raw:a};Object.defineProperties(u,{isFullscreen:{get:()=>!!document[a.fullscreenElement]},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>!!document[a.fullscreenEnabled]}}),e.default=u},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"8tarF":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{constructor:d,template:{$container:f,$player:h}}=u,p="";(0,a.def)(u,"fullscreenWeb",{get:()=>(0,a.hasClass)(h,"art-fullscreen-web"),set(g){g?(p=h.style.cssText,d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(document.body,h),u.state="fullscreenWeb",(0,a.setStyle)(h,"width","100%"),(0,a.setStyle)(h,"height","100%"),(0,a.addClass)(h,"art-fullscreen-web"),u.emit("fullscreenWeb",!0)):(d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(f,h),p&&(h.style.cssText=p,p=""),(0,a.removeClass)(h,"art-fullscreen-web"),u.emit("fullscreenWeb",!1)),u.emit("resize")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f9syH:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"loaded",{get:()=>u.loadedTime/d.duration}),(0,a.def)(u,"loadedTime",{get:()=>d.buffered.length?d.buffered.end(d.buffered.length-1):0})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dLuS7:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{icons:d,proxy:f,storage:h,template:{$player:p,$video:g}}=u,v=!1,y=0,S=0;function T(){let{$mini:R}=u.template;R&&((0,a.removeClass)(p,"art-mini"),(0,a.setStyle)(R,"display","none"),p.prepend(g),u.emit("mini",!1))}function A(R,C){u.playing?((0,a.setStyle)(R,"display","none"),(0,a.setStyle)(C,"display","flex")):((0,a.setStyle)(R,"display","flex"),(0,a.setStyle)(C,"display","none"))}function b(){let{$mini:R}=u.template,C=(0,a.getRect)(R),D=window.innerHeight-C.height-50,N=window.innerWidth-C.width-50;h.set("top",D),h.set("left",N),(0,a.setStyle)(R,"top",`${D}px`),(0,a.setStyle)(R,"left",`${N}px`)}(0,a.def)(u,"mini",{get:()=>(0,a.hasClass)(p,"art-mini"),set(R){if(R){u.state="mini",(0,a.addClass)(p,"art-mini");let C=(function(){let{$mini:w}=u.template;if(w)return(0,a.append)(w,g),(0,a.setStyle)(w,"display","flex");{let P=(0,a.createElement)("div");(0,a.addClass)(P,"art-mini-popup"),(0,a.append)(document.body,P),u.template.$mini=P,(0,a.append)(P,g);let B=(0,a.append)(P,'<div class="art-mini-close"></div>');(0,a.append)(B,d.close),f(B,"click",T);let M=(0,a.append)(P,'<div class="art-mini-state"></div>'),q=(0,a.append)(M,d.play),tt=(0,a.append)(M,d.pause);return f(q,"click",()=>u.play()),f(tt,"click",()=>u.pause()),A(q,tt),u.on("video:playing",()=>A(q,tt)),u.on("video:pause",()=>A(q,tt)),u.on("video:timeupdate",()=>A(q,tt)),f(P,"mousedown",V=>{v=V.button===0,y=V.pageX,S=V.pageY}),u.on("document:mousemove",V=>{if(v){(0,a.addClass)(P,"art-mini-dragging");let H=V.pageX-y,X=V.pageY-S;(0,a.setStyle)(P,"transform",`translate(${H}px, ${X}px)`)}}),u.on("document:mouseup",()=>{if(v){v=!1,(0,a.removeClass)(P,"art-mini-dragging");let V=(0,a.getRect)(P);h.set("left",V.left),h.set("top",V.top),(0,a.setStyle)(P,"left",`${V.left}px`),(0,a.setStyle)(P,"top",`${V.top}px`),(0,a.setStyle)(P,"transform",null)}}),P}})(),D=h.get("top"),N=h.get("left");typeof D=="number"&&typeof N=="number"?((0,a.setStyle)(C,"top",`${D}px`),(0,a.setStyle)(C,"left",`${N}px`),(0,a.isInViewport)(C)||b()):b(),u.emit("mini",!0)}else T()}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d1F69:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,storage:f,template:{$video:h,$poster:p}}=u;for(let v in d.moreVideoAttr)u.attr(v,d.moreVideoAttr[v]);d.muted&&(u.muted=d.muted),d.volume&&(h.volume=(0,a.clamp)(d.volume,0,1));let g=f.get("volume");for(let v in typeof g=="number"&&(h.volume=(0,a.clamp)(g,0,1)),d.poster&&(0,a.setStyle)(p,"backgroundImage",`url(${d.poster})`),d.autoplay&&(h.autoplay=d.autoplay),d.playsInline&&(h.playsInline=!0,h["webkit-playsinline"]=!0),d.theme&&(d.cssVar["--art-theme"]=d.theme),d.cssVar)u.cssVar(v,d.cssVar[v]);u.url=d.url}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kewk9:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h}=u;(0,a.def)(u,"pause",{value(){let p=d.pause();return h.show=f.get("Pause"),u.emit("pause"),p}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4XzDs":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,template:{$video:h}}=u;if(document.pictureInPictureEnabled){let{template:{$video:p},proxy:g,notice:v}=u;p.disablePictureInPicture=!1,(0,a.def)(u,"pip",{get:()=>document.pictureInPictureElement,set(y){y?(u.state="pip",p.requestPictureInPicture().catch(S=>{throw v.show=S,S})):document.exitPictureInPicture().catch(S=>{throw v.show=S,S})}}),g(p,"enterpictureinpicture",()=>{u.emit("pip",!0)}),g(p,"leavepictureinpicture",()=>{u.emit("pip",!1)})}else if(h.webkitSupportsPresentationMode){let{$video:p}=u.template;p.webkitSetPresentationMode("inline"),(0,a.def)(u,"pip",{get:()=>p.webkitPresentationMode==="picture-in-picture",set(g){g?(u.state="pip",p.webkitSetPresentationMode("picture-in-picture"),u.emit("pip",!0)):(p.webkitSetPresentationMode("inline"),u.emit("pip",!1))}})}else(0,a.def)(u,"pip",{get:()=>!1,set(){f.show=d.get("PIP Not Supported")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jphfi:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h}=u;(0,a.def)(u,"playbackRate",{get:()=>d.playbackRate,set(p){p?p!==d.playbackRate&&(d.playbackRate=p,h.show=`${f.get("Rate")}: ${p===1?f.get("Normal"):`${p}x`}`):u.playbackRate=1}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iNpeS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"played",{get:()=>u.currentTime/u.duration})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBIWL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"playing",{get:()=>typeof d.playing=="boolean"?d.playing:d.currentTime>0&&!d.paused&&!d.ended&&d.readyState>2})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hRBri:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,option:h,constructor:{instances:p},template:{$video:g}}=u;(0,a.def)(u,"play",{async value(){let v=await g.play();if(f.show=d.get("Play"),u.emit("play"),h.mutex)for(let y=0;y<p.length;y++){let S=p[y];S!==u&&S.pause()}return v}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fgfXC:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$poster:d}}=u;(0,a.def)(u,"poster",{get:()=>{try{return d.style.backgroundImage.match(/"(.*)"/)[1]}catch{return""}},set(f){(0,a.setStyle)(d,"backgroundImage",`url(${f})`)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"17rUP":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"quality",{set(d){let{controls:f,notice:h,i18n:p}=u,g=d.find(v=>v.default)||d[0];f.update({name:"quality",position:"right",index:10,style:{marginRight:"10px"},html:g?.html||"",selector:d,onSelect:async v=>(await u.switchQuality(v.url),h.show=`${p.get("Switch Video")}: ${v.html}`,v.html)})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"55qzI":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"rect",{get:()=>(0,a.getRect)(u.template.$player)});let d=["bottom","height","left","right","top","width"];for(let f=0;f<d.length;f++){let h=d[f];(0,a.def)(u,h,{get:()=>u.rect[h]})}(0,a.def)(u,"x",{get:()=>u.left+window.pageXOffset}),(0,a.def)(u,"y",{get:()=>u.top+window.pageYOffset})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bC6TG:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,template:{$video:f}}=u,h=(0,a.createElement)("canvas");(0,a.def)(u,"getDataURL",{value:()=>new Promise((p,g)=>{try{h.width=f.videoWidth,h.height=f.videoHeight,h.getContext("2d").drawImage(f,0,0),p(h.toDataURL("image/png"))}catch(v){d.show=v,g(v)}})}),(0,a.def)(u,"getBlobUrl",{value:()=>new Promise((p,g)=>{try{h.width=f.videoWidth,h.height=f.videoHeight,h.getContext("2d").drawImage(f,0,0),h.toBlob(v=>{p(URL.createObjectURL(v))})}catch(v){d.show=v,g(v)}})}),(0,a.def)(u,"screenshot",{value:async p=>{let g=await u.getDataURL(),v=p||`artplayer_${(0,a.secondToTime)(f.currentTime)}`;return(0,a.download)(g,`${v}.png`),u.emit("screenshot",g),g}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j8GRO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d}=u;(0,a.def)(u,"seek",{set(f){u.currentTime=f,u.duration&&(d.show=`${(0,a.secondToTime)(u.currentTime)} / ${(0,a.secondToTime)(u.duration)}`),u.emit("seek",u.currentTime)}}),(0,a.def)(u,"forward",{set(f){u.seek=u.currentTime+f}}),(0,a.def)(u,"backward",{set(f){u.seek=u.currentTime-f}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cn7iR:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let d=["mini","pip","fullscreen","fullscreenWeb"];(0,a.def)(u,"state",{get:()=>d.find(f=>u[f])||"standard",set(f){for(let h=0;h<d.length;h++){let p=d[h];p!==f&&u[p]&&(u[p]=!1)}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2k4nP":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,i18n:f,template:h}=u;(0,a.def)(u,"subtitleOffset",{get:()=>h.$track?.offset||0,set(p){let{cues:g}=u.subtitle;if(!h.$track||g.length===0)return;let v=(0,a.clamp)(p,-10,10);h.$track.offset=v;for(let y=0;y<g.length;y++){let S=g[y];S.originalStartTime=S.originalStartTime??S.startTime,S.originalEndTime=S.originalEndTime??S.endTime,S.startTime=(0,a.clamp)(S.originalStartTime+v,0,u.duration),S.endTime=(0,a.clamp)(S.originalEndTime+v,0,u.duration)}u.subtitle.update(),d.show=`${f.get("Subtitle Offset")}: ${p}s`,u.emit("subtitleOffset",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6SU6j":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){function d(f,h){return new Promise((p,g)=>{if(f===u.url)return;let{playing:v,aspectRatio:y,playbackRate:S}=u;u.pause(),u.url=f,u.notice.show="",u.once("video:error",g),u.once("video:loadedmetadata",()=>{u.currentTime=h}),u.once("video:canplay",async()=>{u.playbackRate=S,u.aspectRatio=y,v&&await u.play(),u.notice.show="",p()})})}(0,a.def)(u,"switchQuality",{value:f=>d(f,u.currentTime)}),(0,a.def)(u,"switchUrl",{value:f=>d(f,0)}),(0,a.def)(u,"switch",{set:u.switchUrl})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7iMuh":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"theme",{get:()=>u.cssVar("--art-theme"),set(d){u.cssVar("--art-theme",d)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6P0RS":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{events:d,option:f,template:{$progress:h,$video:p}}=u,g=null,v=null,y=!1,S=!1,T=!1;d.hover(h,()=>{T=!0},()=>{T=!1}),u.on("setBar",async(A,b,R)=>{let C=u.controls?.thumbnails,{url:D,scale:N}=f.thumbnails;if(!C||!D)return;let w=A==="played"&&R&&a.isMobile;if(A==="hover"||w){if(y||(y=!0,v=await(0,a.loadImg)(D,N),S=!0),!S||!T)return;let P=h.clientWidth*b;(0,a.setStyle)(C,"display","flex"),P>0&&P<h.clientWidth?(function(B){let M=u.controls?.thumbnails;if(!M)return;let{number:q,column:tt,width:V,height:H,scale:X}=f.thumbnails,O=V*X||v.naturalWidth/tt,G=H*X||O/(p.videoWidth/p.videoHeight),K=Math.floor(B/(h.clientWidth/q)),nt=Math.ceil(K/tt)-1;(0,a.setStyle)(M,"backgroundImage",`url(${v.src})`),(0,a.setStyle)(M,"height",`${G}px`),(0,a.setStyle)(M,"width",`${O}px`),(0,a.setStyle)(M,"backgroundPosition",`-${(K%tt||tt-1)*O}px -${nt*G}px`),B<=O/2?(0,a.setStyle)(M,"left",0):B>h.clientWidth-O/2?(0,a.setStyle)(M,"left",`${h.clientWidth-O}px`):(0,a.setStyle)(M,"left",`${B-O/2}px`)})(P):a.isMobile||(0,a.setStyle)(C,"display","none"),w&&(clearTimeout(g),g=setTimeout(()=>{(0,a.setStyle)(C,"display","none")},500))}}),(0,a.def)(u,"thumbnails",{get:()=>u.option.thumbnails,set(A){A.url&&!u.option.isLive&&(u.option.thumbnails=A,clearTimeout(g),g=null,v=null,y=!1,S=!1)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eNi78:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"toggle",{value:()=>u.playing?u.pause():u.play()})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7AUBD":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"type",{get:()=>u.option.type,set(d){u.option.type=d}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cnlLL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,template:{$video:f}}=u;(0,a.def)(u,"url",{get:()=>f.src,async set(h){if(h){let p=u.url,g=d.type||(0,a.getExt)(h),v=d.customType[g];g&&v?(await(0,a.sleep)(),u.loading.show=!0,v.call(u,f,h,u)):(URL.revokeObjectURL(p),f.src=h),p!==u.url&&(u.option.url=h,u.isReady&&p&&u.once("video:canplay",()=>{u.emit("restart",h)}))}else await(0,a.sleep)(),u.loading.show=!0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iX66j:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h,storage:p}=u;(0,a.def)(u,"volume",{get:()=>d.volume||0,set:g=>{d.volume=(0,a.clamp)(g,0,1),h.show=`${f.get("Volume")}: ${Number.parseInt(100*d.volume,10)}`,d.volume!==0&&p.set("volume",d.volume)}}),(0,a.def)(u,"muted",{get:()=>d.muted,set:g=>{d.muted=g,u.emit("muted",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cjxJL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("./autoOrientation"),u=s.interopDefault(l),d=r("./autoPlayback"),f=s.interopDefault(d),h=r("./fastForward"),p=s.interopDefault(h),g=r("./lock"),v=s.interopDefault(g),y=r("./miniProgressBar"),S=s.interopDefault(y);e.default=class{constructor(T){this.art=T,this.id=0;let{option:A}=T;A.miniProgressBar&&!A.isLive&&this.add(S.default),A.lock&&a.isMobile&&this.add(v.default),A.autoPlayback&&!A.isLive&&this.add(f.default),A.autoOrientation&&a.isMobile&&this.add(u.default),A.fastForward&&a.isMobile&&!A.isLive&&this.add(p.default);for(let b=0;b<A.plugins.length;b++)this.add(A.plugins[b])}add(T){this.id+=1;let A=T.call(this.art,this.art);return A instanceof Promise?A.then(b=>this.next(T,b)):this.next(T,A)}next(T,A){let b=A&&A.name||T.name||`plugin${this.id}`;return(0,a.errorHandle)(!(0,a.has)(this,b),`Cannot add a plugin that already has the same name: ${b}`),(0,a.def)(this,b,{value:A}),this}}},{"../utils":"aBlEo","./autoOrientation":"jb9jb","./autoPlayback":"21HWM","./fastForward":"4sxBO","./lock":"fjy9V","./miniProgressBar":"d0xRp","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jb9jb:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,constructor:f,template:{$player:h,$video:p}}=u,g="art-auto-orientation",v="art-auto-orientation-fullscreen",y=!1;function S(){let{videoWidth:T,videoHeight:A}=p,b=document.documentElement.clientWidth,R=document.documentElement.clientHeight;return T>A&&b<R||T<A&&b>R}return u.on("fullscreenWeb",T=>{T?S()&&setTimeout(()=>{u.fullscreenWeb&&!(0,a.hasClass)(h,g)&&(function(){let A=document.documentElement.clientWidth,b=document.documentElement.clientHeight;(0,a.setStyle)(h,"width",`${b}px`),(0,a.setStyle)(h,"height",`${A}px`),(0,a.setStyle)(h,"transform-origin","0 0"),(0,a.setStyle)(h,"transform",`rotate(90deg) translate(0, -${A}px)`),(0,a.addClass)(h,g),u.isRotate=!0,u.emit("resize")})()},Number(f.AUTO_ORIENTATION_TIME??0)):(0,a.hasClass)(h,g)&&((0,a.setStyle)(h,"width",""),(0,a.setStyle)(h,"height",""),(0,a.setStyle)(h,"transform-origin",""),(0,a.setStyle)(h,"transform",""),(0,a.removeClass)(h,g),u.isRotate=!1,u.emit("resize"))}),u.on("fullscreen",async T=>{let A=!!screen?.orientation?.lock;if(T){if(A&&S())try{let b=screen.orientation.type.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(b),y=!0,(0,a.addClass)(h,v)}catch(b){y=!1,d.show=b}}else if((0,a.hasClass)(h,v)&&(0,a.removeClass)(h,v),A&&y){try{screen.orientation.unlock()}catch{}y=!1}}),{name:"autoOrientation",get state(){return(0,a.hasClass)(h,g)}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"21HWM":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,icons:f,storage:h,constructor:p,proxy:g,template:{$poster:v}}=u,y=u.layers.add({name:"auto-playback",html:'<div class="art-auto-playback-close"></div><div class="art-auto-playback-last"></div><div class="art-auto-playback-jump"></div>'}),S=(0,a.query)(".art-auto-playback-last",y),T=(0,a.query)(".art-auto-playback-jump",y),A=(0,a.query)(".art-auto-playback-close",y);(0,a.append)(A,f.close);let b=null;function R(){let C=(h.get("times")||{})[u.option.id||u.option.url];clearTimeout(b),(0,a.setStyle)(y,"display","none"),C&&C>=p.AUTO_PLAYBACK_MIN&&((0,a.setStyle)(y,"display","flex"),S.textContent=`${d.get("Last Seen")} ${(0,a.secondToTime)(C)}`,T.textContent=d.get("Jump Play"),g(A,"click",()=>{(0,a.setStyle)(y,"display","none")}),g(T,"click",()=>{u.seek=C,u.play(),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(y,"display","none")}),u.once("video:timeupdate",()=>{b=setTimeout(()=>{(0,a.setStyle)(y,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}return u.on("video:timeupdate",()=>{if(u.playing){let C=h.get("times")||{},D=Object.keys(C);D.length>p.AUTO_PLAYBACK_MAX&&delete C[D[0]],C[u.option.id||u.option.url]=u.currentTime,h.set("times",C)}}),u.on("ready",R),u.on("restart",R),{name:"auto-playback",get times(){return h.get("times")||{}},clear:()=>h.del("times"),delete(C){let D=h.get("times")||{};return delete D[C],h.set("times",D),D}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4sxBO":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{constructor:d,proxy:f,template:{$player:h,$video:p}}=u,g=null,v=!1,y=1,S=()=>{clearTimeout(g),v&&(v=!1,u.playbackRate=y,(0,a.removeClass)(h,"art-fast-forward"))};return f(p,"touchstart",T=>{T.touches.length===1&&u.playing&&!u.isLock&&(g=setTimeout(()=>{v=!0,y=u.playbackRate,u.playbackRate=d.FAST_FORWARD_VALUE,(0,a.addClass)(h,"art-fast-forward")},d.FAST_FORWARD_TIME))}),u.on("document:touchmove",S),u.on("document:touchend",S),{name:"fastForward",get state(){return(0,a.hasClass)(h,"art-fast-forward")}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjy9V:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{layers:d,icons:f,template:{$player:h}}=u;function p(){return(0,a.hasClass)(h,"art-lock")}function g(){(0,a.addClass)(h,"art-lock"),u.isLock=!0,u.emit("lock",!0)}function v(){(0,a.removeClass)(h,"art-lock"),u.isLock=!1,u.emit("lock",!1)}return d.add({name:"lock",mounted(y){let S=(0,a.append)(y,f.lock),T=(0,a.append)(y,f.unlock);(0,a.setStyle)(S,"display","none"),u.on("lock",A=>{A?((0,a.setStyle)(S,"display","inline-flex"),(0,a.setStyle)(T,"display","none")):((0,a.setStyle)(S,"display","none"),(0,a.setStyle)(T,"display","inline-flex"))})},click(){p()?v():g()}}),{name:"lock",get state(){return p()},set state(y){y?g():v()}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d0xRp:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return u.on("control",d=>{d?(0,a.removeClass)(u.template.$player,"art-mini-progress-bar"):(0,a.addClass)(u.template.$player,"art-mini-progress-bar")}),{name:"mini-progress-bar"}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bwLGT:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./aspectRatio"),f=s.interopDefault(d),h=r("./flip"),p=s.interopDefault(h),g=r("./playbackRate"),v=s.interopDefault(g),y=r("./subtitleOffset"),S=s.interopDefault(y);class T extends u.default{constructor(b){super(b);let{option:R,controls:C,template:{$setting:D}}=b;this.name="setting",this.$parent=D,this.id=0,this.active=null,this.cache=new Map,this.option=[...this.builtin,...R.settings],R.setting&&(this.format(),this.render(),b.on("blur",()=>{this.show&&(this.show=!1,this.render())}),b.on("focus",N=>{let w=(0,a.includeFromEvent)(N,C.setting),P=(0,a.includeFromEvent)(N,this.$parent);!this.show||w||P||(this.show=!1,this.render())}),b.on("resize",()=>this.resize()))}get builtin(){let b=[],{option:R}=this.art;return R.playbackRate&&b.push((0,v.default)(this.art)),R.aspectRatio&&b.push((0,f.default)(this.art)),R.flip&&b.push((0,p.default)(this.art)),R.subtitleOffset&&b.push((0,S.default)(this.art)),b}traverse(b,R=this.option){for(let C=0;C<R.length;C++){let D=R[C];b(D),D.selector?.length&&this.traverse(b,D.selector)}}check(b){b.$parent.tooltip=b.html,this.traverse(R=>{R.default=R===b,R.default&&R.$item&&(0,a.inverseClass)(R.$item,"art-current")},b.$option),this.render(b.$parents)}format(b=this.option,R,C,D=[]){for(let N=0;N<b.length;N++){let w=b[N];if(w?.name?((0,a.errorHandle)(!D.includes(w.name),`The [${w.name}] already exists in [setting]`),D.push(w.name)):w.name=`setting-${this.id++}`,!w.$formatted){(0,a.def)(w,"$parent",{get:()=>R}),(0,a.def)(w,"$parents",{get:()=>C}),(0,a.def)(w,"$option",{get:()=>b});let P=[];(0,a.def)(w,"$events",{get:()=>P}),(0,a.def)(w,"$formatted",{get:()=>!0})}this.format(w.selector||[],w,b,D)}this.option=b}find(b=""){let R=null;return this.traverse(C=>{C.name===b&&(R=C)}),R}resize(){let{controls:b,constructor:{SETTING_WIDTH:R,SETTING_ITEM_HEIGHT:C},template:{$player:D,$setting:N}}=this.art;if(b.setting&&this.show){let w=this.active[0]?.$parent?.width||R,{left:P,width:B}=(0,a.getRect)(b.setting),{left:M,width:q}=(0,a.getRect)(D),tt=P-M+B/2-w/2,V=this.active===this.option?this.active.length*C:(this.active.length+1)*C;if((0,a.setStyle)(N,"height",`${V}px`),(0,a.setStyle)(N,"width",`${w}px`),this.art.isRotate||a.isMobile)return;tt+w>q?((0,a.setStyle)(N,"left",null),(0,a.setStyle)(N,"right",null)):((0,a.setStyle)(N,"left",`${tt}px`),(0,a.setStyle)(N,"right","auto"))}}inactivate(b){for(let R=0;R<b.$events.length;R++)this.art.events.remove(b.$events[R]);b.$events.length=0}remove(b){let R=this.find(b);(0,a.errorHandle)(R,`Can't find [${b}] in the [setting]`);let C=R.$option.indexOf(R);R.$option.splice(C,1),this.inactivate(R),R.$item&&(0,a.remove)(R.$item),this.render()}update(b){let R=this.find(b.name);return R?(this.inactivate(R),Object.assign(R,b),this.format(),this.createItem(R,!0),this.render(),R):this.add(b)}add(b,R=this.option){return R.push(b),this.format(),this.createItem(b),this.render(),b}createHeader(b){if(!this.cache.has(b.$option))return;let R=this.cache.get(b.$option),{proxy:C,icons:{arrowLeft:D},constructor:{SETTING_ITEM_HEIGHT:N}}=this.art,w=(0,a.createElement)("div");(0,a.setStyle)(w,"height",`${N}px`),(0,a.addClass)(w,"art-setting-item"),(0,a.addClass)(w,"art-setting-item-back");let P=(0,a.append)(w,'<div class="art-setting-item-left"></div>'),B=(0,a.createElement)("div");(0,a.addClass)(B,"art-setting-item-left-icon"),(0,a.append)(B,D),(0,a.append)(P,B),(0,a.append)(P,b.$parent.html);let M=C(w,"click",()=>this.render(b.$parents));b.$parent.$events.push(M),(0,a.append)(R,w)}createItem(b,R=!1){if(!this.cache.has(b.$option))return;let C=this.cache.get(b.$option),D=b.$item,N="selector";(0,a.has)(b,"switch")&&(N="switch"),(0,a.has)(b,"range")&&(N="range"),(0,a.has)(b,"onClick")&&(N="button");let{icons:w,proxy:P,constructor:B}=this.art,M=(0,a.createElement)("div");(0,a.addClass)(M,"art-setting-item"),(0,a.setStyle)(M,"height",`${B.SETTING_ITEM_HEIGHT}px`),M.dataset.name=b.name||"",M.dataset.value=b.value||"";let q=(0,a.append)(M,'<div class="art-setting-item-left"></div>'),tt=(0,a.append)(M,'<div class="art-setting-item-right"></div>'),V=(0,a.createElement)("div");switch((0,a.addClass)(V,"art-setting-item-left-icon"),N){case"button":case"switch":case"range":(0,a.append)(V,b.icon||w.config);break;case"selector":b.selector?.length?(0,a.append)(V,b.icon||w.config):(0,a.append)(V,w.check)}(0,a.append)(q,V),(0,a.def)(b,"$icon",{configurable:!0,get:()=>V}),(0,a.def)(b,"icon",{configurable:!0,get:()=>V.innerHTML,set(O){V.innerHTML="",(0,a.append)(V,O)}});let H=(0,a.createElement)("div");(0,a.addClass)(H,"art-setting-item-left-text"),(0,a.append)(H,b.html||""),(0,a.append)(q,H),(0,a.def)(b,"$html",{configurable:!0,get:()=>H}),(0,a.def)(b,"html",{configurable:!0,get:()=>H.innerHTML,set(O){H.innerHTML="",(0,a.append)(H,O)}});let X=(0,a.createElement)("div");switch((0,a.addClass)(X,"art-setting-item-right-tooltip"),(0,a.append)(X,b.tooltip||""),(0,a.append)(tt,X),(0,a.def)(b,"$tooltip",{configurable:!0,get:()=>X}),(0,a.def)(b,"tooltip",{configurable:!0,get:()=>X.innerHTML,set(O){X.innerHTML="",(0,a.append)(X,O)}}),N){case"switch":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let G=(0,a.append)(O,w.switchOn),K=(0,a.append)(O,w.switchOff);(0,a.setStyle)(b.switch?K:G,"display","none"),(0,a.append)(tt,O),(0,a.def)(b,"$switch",{configurable:!0,get:()=>O});let nt=b.switch;(0,a.def)(b,"switch",{configurable:!0,get:()=>nt,set(ut){nt=ut,ut?((0,a.setStyle)(K,"display","none"),(0,a.setStyle)(G,"display",null)):((0,a.setStyle)(K,"display",null),(0,a.setStyle)(G,"display","none"))}});break}case"range":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let G=(0,a.append)(O,'<input type="range">');G.value=b.range[0],G.min=b.range[1],G.max=b.range[2],G.step=b.range[3],(0,a.addClass)(G,"art-setting-range"),(0,a.append)(tt,O),(0,a.def)(b,"$range",{configurable:!0,get:()=>G});let K=[...b.range];(0,a.def)(b,"range",{configurable:!0,get:()=>K,set(nt){K=[...nt],G.value=nt[0],G.min=nt[1],G.max=nt[2],G.step=nt[3]}})}break;case"selector":if(b.selector?.length){let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon"),(0,a.append)(O,w.arrowRight),(0,a.append)(tt,O)}}switch(N){case"switch":if(b.onSwitch){let O=P(M,"click",async G=>{b.switch=await b.onSwitch.call(this.art,b,M,G)});b.$events.push(O)}break;case"range":if(b.$range){if(b.onRange){let O=P(b.$range,"change",async G=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onRange.call(this.art,b,M,G)});b.$events.push(O)}if(b.onChange){let O=P(b.$range,"input",async G=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onChange.call(this.art,b,M,G)});b.$events.push(O)}}break;case"selector":{let O=P(M,"click",async G=>{b.selector?.length?this.render(b.selector):(this.check(b),b.$parent.onSelect&&(b.$parent.tooltip=await b.$parent.onSelect.call(this.art,b,M,G)))});b.$events.push(O),b.default&&(0,a.addClass)(M,"art-current")}break;case"button":if(b.onClick){let O=P(M,"click",async G=>{b.tooltip=await b.onClick.call(this.art,b,M,G)});b.$events.push(O)}}(0,a.def)(b,"$item",{configurable:!0,get:()=>M}),R?(0,a.replaceElement)(M,D):(0,a.append)(C,M),b.mounted&&setTimeout(()=>b.mounted.call(this.art,b.$item,b),0)}render(b=this.option){if(this.active=b,this.cache.has(b)){let R=this.cache.get(b);(0,a.inverseClass)(R,"art-current")}else{let R=(0,a.createElement)("div");this.cache.set(b,R),(0,a.addClass)(R,"art-setting-panel"),(0,a.append)(this.$parent,R),(0,a.inverseClass)(R,"art-current"),b[0]?.$parent&&this.createHeader(b[0]);for(let C=0;C<b.length;C++)this.createItem(b[C])}this.resize()}}e.default=T},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"cb8VK","./flip":"ljJTO","./playbackRate":"3QcSQ","./subtitleOffset":"eB5hg","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cb8VK:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:{SETTING_ITEM_WIDTH:f,ASPECT_RATIO:h}}=l;function p(v){return v==="default"?u.get("Default"):v}function g(){let v=l.setting.find(`aspect-ratio-${l.aspectRatio}`);l.setting.check(v)}return{width:f,name:"aspect-ratio",html:u.get("Aspect Ratio"),icon:d.aspectRatio,tooltip:p(l.aspectRatio),selector:h.map(v=>({value:v,name:`aspect-ratio-${v}`,default:v===l.aspectRatio,html:p(v)})),onSelect:v=>(l.aspectRatio=v.value,v.html),mounted:()=>{g(),l.on("aspectRatio",()=>g())}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ljJTO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,icons:f,constructor:{SETTING_ITEM_WIDTH:h,FLIP:p}}=u;function g(y){return d.get((0,a.capitalize)(y))}function v(){let y=u.setting.find(`flip-${u.flip}`);u.setting.check(y)}return{width:h,name:"flip",html:d.get("Video Flip"),tooltip:g(u.flip),icon:f.flip,selector:p.map(y=>({value:y,name:`flip-${y}`,default:y===u.flip,html:g(y)})),onSelect:y=>(u.flip=y.value,y.html),mounted:()=>{v(),u.on("flip",()=>v())}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3QcSQ":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:{SETTING_ITEM_WIDTH:f,PLAYBACK_RATE:h}}=l;function p(v){return v===1?u.get("Normal"):v.toFixed(1)}function g(){let v=l.setting.find(`playback-rate-${l.playbackRate}`);l.setting.check(v)}return{width:f,name:"playback-rate",html:u.get("Play Speed"),tooltip:p(l.playbackRate),icon:d.playbackRate,selector:h.map(v=>({value:v,name:`playback-rate-${v}`,default:v===l.playbackRate,html:p(v)})),onSelect:v=>(l.playbackRate=v.value,v.html),mounted:()=>{g(),l.on("video:ratechange",()=>g())}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eB5hg:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:f}=l;return{width:f.SETTING_ITEM_WIDTH,name:"subtitle-offset",html:u.get("Subtitle Offset"),icon:d.subtitle,tooltip:"0s",range:[0,-10,10,.1],onChange:h=>(l.subtitleOffset=h.range[0],`${h.range[0]}s`),mounted:(h,p)=>{l.on("subtitleOffset",g=>{p.$range.value=g,p.tooltip=`${g}s`})}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kwqbK:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(s){try{let a=JSON.parse(window.localStorage.getItem(this.name))||{};return s?a[s]:a}catch{return s?this.settings[s]:this.settings}}set(s,a){try{let l=Object.assign({},this.get(),{[s]:a});window.localStorage.setItem(this.name,JSON.stringify(l))}catch{this.settings[s]=a}}del(s){try{let a=this.get();delete a[s],window.localStorage.setItem(this.name,JSON.stringify(a))}catch{delete this.settings[s]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k5613:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("option-validator"),l=s.interopDefault(a),u=r("./scheme"),d=s.interopDefault(u),f=r("./utils"),h=r("./utils/component"),p=s.interopDefault(h);class g extends p.default{constructor(y){super(y),this.name="subtitle",this.option=null,this.destroyEvent=()=>null,this.init(y.option.subtitle);let S=!1;y.on("video:timeupdate",()=>{if(!this.url)return;let T=this.art.template.$video.webkitDisplayingFullscreen;typeof T=="boolean"&&T!==S&&(S=T,this.createTrack(T?"subtitles":"metadata",this.url))})}get url(){return this.art.template.$track.src}set url(y){this.switch(y)}get textTrack(){return this.art.template.$video?.textTracks?.[0]}get activeCues(){return this.textTrack?Array.from(this.textTrack.activeCues):[]}get cues(){return this.textTrack?Array.from(this.textTrack.cues):[]}style(y,S){let{$subtitle:T}=this.art.template;return typeof y=="object"?(0,f.setStyles)(T,y):(0,f.setStyle)(T,y,S)}update(){let{option:{subtitle:y},template:{$subtitle:S}}=this.art;S.innerHTML="",this.activeCues.length&&(this.art.emit("subtitleBeforeUpdate",this.activeCues),S.innerHTML=this.activeCues.map((T,A)=>T.text.split(/\r?\n/).filter(b=>b.trim()).map(b=>`<div class="art-subtitle-line" data-group="${A}">${y.escape?(0,f.escape)(b):b}</div>`).join("")).join(""),this.art.emit("subtitleAfterUpdate",this.activeCues))}async switch(y,S={}){let{i18n:T,notice:A,option:b}=this.art,R={...b.subtitle,...S,url:y},C=await this.init(R);return S.name&&(A.show=`${T.get("Switch Subtitle")}: ${S.name}`),C}createTrack(y,S){let{template:T,proxy:A,option:b}=this.art,{$video:R,$track:C}=T,D=(0,f.createElement)("track");D.default=!0,D.kind=y,D.src=S,D.label=b.subtitle.name||"Artplayer",D.track.mode="hidden",D.onload=()=>{this.art.emit("subtitleLoad",this.cues,this.option)},this.art.events.remove(this.destroyEvent),C.onload=null,(0,f.remove)(C),(0,f.append)(R,D),T.$track=D,this.destroyEvent=A(this.textTrack,"cuechange",()=>this.update())}async init(y){let{notice:S,template:{$subtitle:T}}=this.art;return this.textTrack?((0,l.default)(y,d.default.subtitle),y.url?(this.option=y,this.style(y.style),fetch(y.url).then(A=>A.arrayBuffer()).then(A=>{let b=new TextDecoder(y.encoding).decode(A);switch(y.type||(0,f.getExt)(y.url)){case"srt":{let R=(0,f.srtToVtt)(b),C=y.onVttLoad(R);return(0,f.vttToBlob)(C)}case"ass":{let R=(0,f.assToVtt)(b),C=y.onVttLoad(R);return(0,f.vttToBlob)(C)}case"vtt":{let R=y.onVttLoad(b);return(0,f.vttToBlob)(R)}default:return y.url}}).then(A=>(T.innerHTML="",this.url===A||(URL.revokeObjectURL(this.url),this.createTrack("metadata",A)),A)).catch(A=>{throw T.innerHTML="",S.show=A,A})):void 0):null}}e.default=g},{"option-validator":"g7VGh","./scheme":"biLjm","./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fwOA1:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("../package.json"),a=r("./utils");class l{constructor(d){this.art=d;let{option:f,constructor:h}=d;f.container instanceof Element?this.$container=f.container:(this.$container=(0,a.query)(f.container),(0,a.errorHandle)(this.$container,`No container element found by ${f.container}`)),(0,a.errorHandle)((0,a.supportsFlex)(),"The current browser does not support flex layout");let p=this.$container.tagName.toLowerCase();(0,a.errorHandle)(p==="div",`Unsupported container element type, only support 'div' but got '${p}'`),(0,a.errorHandle)(h.instances.every(g=>g.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=d.id,this.init()}static get html(){return`<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"><track default kind="metadata" src=""></track></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">${s.version}</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span>x<span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-contextmenus"></div></div>`}query(d){return(0,a.query)(d,this.$container)}init(){let{option:d}=this.art;if(d.useSSR||(this.$container.innerHTML=l.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$track=this.query("track"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$contextmenu=this.query(".art-contextmenus"),d.proxy){let f=d.proxy.call(this.art,this.art);(0,a.errorHandle)(f instanceof HTMLVideoElement||f instanceof HTMLCanvasElement,"Function 'option.proxy' needs to return 'HTMLVideoElement' or 'HTMLCanvasElement'"),(0,a.replaceElement)(f,this.$video),f.className="art-video",this.$video=f}d.backdrop&&(0,a.addClass)(this.$player,"art-backdrop"),a.isMobile&&(0,a.addClass)(this.$player,"art-mobile")}destroy(d){d?this.$container.innerHTML="":(0,a.addClass)(this.$player,"art-destroy")}}e.default=l},{"../package.json":"lh3R5","./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4NM7P":[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{on(s,a,l){let u=this.e||(this.e={});return(u[s]||(u[s]=[])).push({fn:a,ctx:l}),this}once(s,a,l){let u=this;function d(...f){u.off(s,d),a.apply(l,f)}return d._=a,this.on(s,d,l)}emit(s,...a){let l=((this.e||(this.e={}))[s]||[]).slice();for(let u=0;u<l.length;u+=1)l[u].fn.apply(l[u].ctx,a);return this}off(s,a){let l=this.e||(this.e={}),u=l[s],d=[];if(u&&a)for(let f=0,h=u.length;f<h;f+=1)u[f].fn!==a&&u[f].fn._!==a&&d.push(u[f]);return d.length?l[s]=d:delete l[s],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}]},["esqvp"],"esqvp","parcelRequire4dc0",{});let{default:YL}=parcelRequire4dc0("esqvp");const ht=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},XL=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=WL},WL=Number.MAX_SAFE_INTEGER||9007199254740991;let vt=(function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r})({}),Q=(function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",r.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",r.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.ASSET_LIST_LOAD_ERROR="assetListLoadError",r.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",r.ASSET_LIST_PARSING_ERROR="assetListParsingError",r.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.ATTACH_MEDIA_ERROR="attachMediaError",r.UNKNOWN="unknown",r})({}),_=(function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.MEDIA_ENDED="hlsMediaEnded",r.STALL_RESOLVED="hlsStallResolved",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFERED_TO_END="hlsBufferedToEnd",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r.ASSET_LIST_LOADING="hlsAssetListLoading",r.ASSET_LIST_LOADED="hlsAssetListLoaded",r.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",r.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",r.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",r.INTERSTITIAL_STARTED="hlsInterstitialStarted",r.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",r.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",r.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",r.INTERSTITIAL_ENDED="hlsInterstitialEnded",r.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",r.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",r.EVENT_CUE_ENTER="hlsEventCueEnter",r})({});var It={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},mt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Nr{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class QL{constructor(t,e,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Nr(t),this.fast_=new Nr(e),this.defaultTTFB_=s,this.ttfb_=new Nr(t)}update(t,e){const{slow_:i,fast_:s,ttfb_:a}=this;i.halfLife!==t&&(this.slow_=new Nr(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.fast_=new Nr(e,s.getEstimate(),s.getTotalWeight())),a.halfLife!==t&&(this.ttfb_=new Nr(t,a.getEstimate(),a.getTotalWeight()))}sample(t,e){t=Math.max(t,this.minDelayMs_);const i=8*e,s=t/1e3,a=i/s;this.fast_.sample(s,a),this.slow_.sample(s,a)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function ZL(r,t,e){return(t=t_(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function Wt(){return Wt=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Wt.apply(null,arguments)}function Ay(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),e.push.apply(e,i)}return e}function Vt(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Ay(Object(e),!0).forEach(function(i){ZL(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):Ay(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function JL(r,t){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function t_(r){var t=JL(r,"string");return typeof t=="symbol"?t:t+""}class Oi{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${t}]:`;this.trace=fs,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}}const fs=function(){},e_={trace:fs,debug:fs,log:fs,warn:fs,info:fs,error:fs};function zd(){return Wt({},e_)}function i_(r,t){const e=self.console[r];return e?e.bind(self.console,`${t?"["+t+"] ":""}[${r}] >`):fs}function Ry(r,t,e){return t[r]?t[r].bind(t):i_(r,e)}const Vd=zd();function n_(r,t,e){const i=zd();if(typeof console=="object"&&r===!0||typeof r=="object"){const s=["debug","log","info","warn","error"];s.forEach(a=>{i[a]=Ry(a,r,e)});try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.14`)}catch{return zd()}s.forEach(a=>{Vd[a]=Ry(a,r)})}else Wt(Vd,i);return i}const Kt=Vd;function ps(r=!0){return typeof self>"u"?void 0:(r||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function s_(r){return typeof self<"u"&&r===self.ManagedMediaSource}function VE(r,t){const e=Object.keys(r),i=Object.keys(t),s=e.length,a=i.length;return!s||!a||s===a&&!e.some(l=>i.indexOf(l)===-1)}function Ei(r,t=!1){if(typeof TextDecoder<"u"){const f=new TextDecoder("utf-8").decode(r);if(t){const h=f.indexOf("\0");return h!==-1?f.substring(0,h):f}return f.replace(/\0/g,"")}const e=r.length;let i,s,a,l="",u=0;for(;u<e;){if(i=r[u++],i===0&&t)return l;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:s=r[u++],l+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=r[u++],a=r[u++],l+=String.fromCharCode((i&15)<<12|(s&63)<<6|(a&63)<<0);break}}return l}function qe(r){let t="";for(let e=0;e<r.length;e++){let i=r[e].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function KE(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function r_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var hd={exports:{}},Ly;function a_(){return Ly||(Ly=1,(function(r,t){(function(e){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(d,f,h){if(h=h||{},d=d.trim(),f=f.trim(),!f){if(!h.alwaysNormalize)return d;var p=u.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=u.normalizePath(p.path),u.buildURLFromParts(p)}var g=u.parseURL(f);if(!g)throw new Error("Error trying to parse relative URL.");if(g.scheme)return h.alwaysNormalize?(g.path=u.normalizePath(g.path),u.buildURLFromParts(g)):f;var v=u.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var y=s.exec(v.path);v.netLoc=y[1],v.path=y[2]}v.netLoc&&!v.path&&(v.path="/");var S={scheme:v.scheme,netLoc:g.netLoc,path:null,params:g.params,query:g.query,fragment:g.fragment};if(!g.netLoc&&(S.netLoc=v.netLoc,g.path[0]!=="/"))if(!g.path)S.path=v.path,g.params||(S.params=v.params,g.query||(S.query=v.query));else{var T=v.path,A=T.substring(0,T.lastIndexOf("/")+1)+g.path;S.path=u.normalizePath(A)}return S.path===null&&(S.path=h.alwaysNormalize?u.normalizePath(g.path):g.path),u.buildURLFromParts(S)},parseURL:function(d){var f=i.exec(d);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(a,"");d.length!==(d=d.replace(l,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};r.exports=u})()})(hd)),hd.exports}var Ch=a_();class wh{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Zt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class qE{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof t=="string"&&(t={url:t}),this.base=t,l_(this,"stats")}setByteRange(t,e){const i=t.split("@",2);let s;i.length===1?s=e?.byteRangeEndOffset||0:s=parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Zt.AUDIO]:null,[Zt.VIDEO]:null,[Zt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new wh),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Ch.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Zt.AUDIO]=null,t[Zt.VIDEO]=null,t[Zt.AUDIOVIDEO]=null}}function Te(r){return r.sn!=="initSegment"}class md extends qE{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(ht(t)&&ht(e))return e-t}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){var t;const{levelkeys:e}=this;if(!e||e.NONE)return null;if(e.identity)this._decryptdata||(this._decryptdata=e.identity.getDecryptData(this.sn));else if(!((t=this._decryptdata)!=null&&t.keyId)){const i=Object.keys(e);if(i.length===1){const s=this._decryptdata=e[i[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,e))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const t=ht(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){var e;const i=Object.keys(this.levelkeys),s=i.length;if(s>1||s===1&&(e=this.levelkeys[i[0]])!=null&&e.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){if(!ht(t)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=t}get ref(){return Te(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){const e=this.levelkeys;if(e){var i;const s=e[t];s&&!((i=this._decryptdata)!=null&&i.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,e))}}abortRequests(){var t,e;(t=this.loader)==null||t.abort(),(e=this.keyLoader)==null||e.abort()}setElementaryStreamInfo(t,e,i,s,a,l=!1){const{elementaryStreams:u}=this,d=u[t];if(!d){u[t]={startPTS:e,endPTS:i,startDTS:s,endDTS:a,partial:l};return}d.startPTS=Math.min(d.startPTS,e),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,s),d.endDTS=Math.max(d.endDTS,a)}}class o_ extends qE{constructor(t,e,i,s,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=s;const l=t.enumeratedString("BYTERANGE");l&&this.setByteRange(l,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function YE(r,t){const e=Object.getPrototypeOf(r);if(e){const i=Object.getOwnPropertyDescriptor(e,t);return i||YE(e,t)}}function l_(r,t){const e=YE(r,t);e&&(e.enumerable=!0,Object.defineProperty(r,t,e))}const _y=Math.pow(2,32)-1,u_=[].push,XE={video:1,audio:2,id3:3,text:4};function Re(r){return String.fromCharCode.apply(null,r)}function WE(r,t){const e=r[t]<<8|r[t+1];return e<0?65536+e:e}function Tt(r,t){const e=QE(r,t);return e<0?4294967296+e:e}function Cy(r,t){let e=Tt(r,t);return e*=Math.pow(2,32),e+=Tt(r,t+4),e}function QE(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]}function c_(r){const t=r.byteLength;for(let e=0;e<t;){const i=Tt(r,e);if(i>8&&r[e+4]===109&&r[e+5]===111&&r[e+6]===111&&r[e+7]===102)return!0;e=i>1?e+i:t}return!1}function Dt(r,t){const e=[];if(!t.length)return e;const i=r.byteLength;for(let s=0;s<i;){const a=Tt(r,s),l=Re(r.subarray(s+4,s+8)),u=a>1?s+a:i;if(l===t[0])if(t.length===1)e.push(r.subarray(s+8,u));else{const d=Dt(r.subarray(s+8,u),t.slice(1));d.length&&u_.apply(e,d)}s=u}return e}function f_(r){const t=[],e=r[0];let i=8;const s=Tt(r,i);i+=4;let a=0,l=0;e===0?(a=Tt(r,i),l=Tt(r,i+4),i+=8):(a=Cy(r,i),l=Cy(r,i+8),i+=16),i+=2;let u=r.length+l;const d=WE(r,i);i+=2;for(let f=0;f<d;f++){let h=i;const p=Tt(r,h);h+=4;const g=p&2147483647;if((p&2147483648)>>>31===1)return Kt.warn("SIDX has hierarchical references (not supported)"),null;const y=Tt(r,h);h+=4,t.push({referenceSize:g,subsegmentDuration:y,info:{duration:y/s,start:u,end:u+g-1}}),u+=g,h+=4,i=h}return{earliestPresentationTime:a,timescale:s,version:e,referencesCount:d,references:t}}function ZE(r){const t=[],e=Dt(r,["moov","trak"]);for(let s=0;s<e.length;s++){const a=e[s],l=Dt(a,["tkhd"])[0];if(l){let u=l[0];const d=Tt(l,u===0?12:20),f=Dt(a,["mdia","mdhd"])[0];if(f){u=f[0];const h=Tt(f,u===0?12:20),p=Dt(a,["mdia","hdlr"])[0];if(p){const g=Re(p.subarray(8,12)),v={soun:Zt.AUDIO,vide:Zt.VIDEO}[g],y=Dt(a,["mdia","minf","stbl","stsd"])[0],S=d_(y);v?(t[d]={timescale:h,type:v,stsd:S},t[v]=Vt({timescale:h,id:d},S)):t[d]={timescale:h,type:g,stsd:S}}}}}return Dt(r,["moov","mvex","trex"]).forEach(s=>{const a=Tt(s,4),l=t[a];l&&(l.default={duration:Tt(s,12),flags:Tt(s,20)})}),t}function d_(r){const t=r.subarray(8),e=t.subarray(86),i=Re(t.subarray(4,8));let s=i,a;const l=i==="enca"||i==="encv";if(l){const f=Dt(t,[i])[0].subarray(i==="enca"?28:78);Dt(f,["sinf"]).forEach(p=>{const g=Dt(p,["schm"])[0];if(g){const v=Re(g.subarray(4,8));if(v==="cbcs"||v==="cenc"){const y=Dt(p,["frma"])[0];y&&(s=Re(y))}}})}const u=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Dt(e,["avcC"])[0];d&&d.length>3&&(s+="."+Pl(d[1])+Pl(d[2])+Pl(d[3]),a=Ml(u==="avc1"?"dva1":"dvav",e));break}case"mp4a":{const d=Dt(t,[i])[0],f=Dt(d.subarray(28),["esds"])[0];if(f&&f.length>7){let h=4;if(f[h++]!==3)break;h=pd(f,h),h+=2;const p=f[h++];if(p&128&&(h+=2),p&64&&(h+=f[h++]),f[h++]!==4)break;h=pd(f,h);const g=f[h++];if(g===64)s+="."+Pl(g);else break;if(h+=12,f[h++]!==5)break;h=pd(f,h);const v=f[h++];let y=(v&248)>>3;y===31&&(y+=1+((v&7)<<3)+((f[h]&224)>>5)),s+="."+y}break}case"hvc1":case"hev1":{const d=Dt(e,["hvcC"])[0];if(d&&d.length>12){const f=d[1],h=["","A","B","C"][f>>6],p=f&31,g=Tt(d,2),v=(f&32)>>5?"H":"L",y=d[12],S=d.subarray(6,12);s+="."+h+p,s+="."+h_(g).toString(16).toUpperCase(),s+="."+v+y;let T="";for(let A=S.length;A--;){const b=S[A];(b||T)&&(T="."+b.toString(16).toUpperCase()+T)}s+=T}a=Ml(u=="hev1"?"dvhe":"dvh1",e);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=Ml(s,e)||s;break}case"vp09":{const d=Dt(e,["vpcC"])[0];if(d&&d.length>6){const f=d[4],h=d[5],p=d[6]>>4&15;s+="."+Xi(f)+"."+Xi(h)+"."+Xi(p)}break}case"av01":{const d=Dt(e,["av1C"])[0];if(d&&d.length>2){const f=d[1]>>>5,h=d[1]&31,p=d[2]>>>7?"H":"M",g=(d[2]&64)>>6,v=(d[2]&32)>>5,y=f===2&&g?v?12:10:g?10:8,S=(d[2]&16)>>4,T=(d[2]&8)>>3,A=(d[2]&4)>>2,b=d[2]&3;s+="."+f+"."+Xi(h)+p+"."+Xi(y)+"."+S+"."+T+A+b+"."+Xi(1)+"."+Xi(1)+"."+Xi(1)+"."+0,a=Ml("dav1",e)}break}}return{codec:s,encrypted:l,supplemental:a}}function Ml(r,t){const e=Dt(t,["dvvC"]),i=e.length?e[0]:Dt(t,["dvcC"])[0];if(i){const s=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return r+"."+Xi(s)+"."+Xi(a)}}function h_(r){let t=0;for(let e=0;e<32;e++)t|=(r>>e&1)<<31-e;return t>>>0}function pd(r,t){const e=t+5;for(;r[t++]&128&&t<e;);return t}function Pl(r){return("0"+r.toString(16).toUpperCase()).slice(-2)}function Xi(r){return(r<10?"0":"")+r}function m_(r,t){if(!r||!t)return;const e=t.keyId;e&&t.isCommonEncryption&&JE(r,(i,s)=>{const a=i.subarray(8,24);a.some(l=>l!==0)||(Kt.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${qe(a)} -> ${qe(e)}`),i.set(e,8))})}function p_(r){const t=[];return JE(r,e=>t.push(e.subarray(8,24))),t}function JE(r,t){Dt(r,["moov","trak"]).forEach(i=>{const s=Dt(i,["mdia","minf","stbl","stsd"])[0];if(!s)return;const a=s.subarray(8);let l=Dt(a,["enca"]);const u=l.length>0;u||(l=Dt(a,["encv"])),l.forEach(d=>{const f=u?d.subarray(28):d.subarray(78);Dt(f,["sinf"]).forEach(p=>{const g=tx(p);g&&t(g,u)})})})}function tx(r){const t=Dt(r,["schm"])[0];if(t){const e=Re(t.subarray(4,8));if(e==="cbcs"||e==="cenc"){const i=Dt(r,["schi","tenc"])[0];if(i)return i}}}function g_(r,t,e){const i={},s=Dt(r,["moof","traf"]);for(let a=0;a<s.length;a++){const l=s[a],u=Dt(l,["tfhd"])[0],d=Tt(u,4),f=t[d];if(!f)continue;i[d]||(i[d]={start:NaN,duration:0,sampleCount:0,timescale:f.timescale,type:f.type});const h=i[d],p=Dt(l,["tfdt"])[0];if(p){const R=p[0];let C=Tt(p,4);R===1&&(C===_y?e.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(C*=_y+1,C+=Tt(p,8))),ht(C)&&(!ht(h.start)||C<h.start)&&(h.start=C)}const g=f.default,v=Tt(u,0)|g?.flags;let y=g?.duration||0;v&8&&(v&2?y=Tt(u,12):y=Tt(u,8));const S=Dt(l,["trun"]);let T=h.start||0,A=0,b=y;for(let R=0;R<S.length;R++){const C=S[R],D=Tt(C,4),N=h.sampleCount;h.sampleCount+=D;const w=C[3]&1,P=C[3]&4,B=C[2]&1,M=C[2]&2,q=C[2]&4,tt=C[2]&8;let V=8,H=D;for(w&&(V+=4),P&&D&&(!(C[V+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=N),V+=4,B?(b=Tt(C,V),V+=4):b=y,M&&(V+=4),tt&&(V+=4),T+=b,A+=b,H--);H--;)B?(b=Tt(C,V),V+=4):b=y,M&&(V+=4),q&&(C[V+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(H+1),h.keyFrameStart=T),V+=4),tt&&(V+=4),T+=b,A+=b;!A&&y&&(A+=y*D)}h.duration+=A}if(!Object.keys(i).some(a=>i[a].duration)){let a=1/0,l=0;const u=Dt(r,["sidx"]);for(let d=0;d<u.length;d++){const f=f_(u[d]);if(f!=null&&f.references){a=Math.min(a,f.earliestPresentationTime/f.timescale);const h=f.references.reduce((p,g)=>p+g.info.duration||0,0);l=Math.max(l,h+f.earliestPresentationTime/f.timescale)}}l&&ht(l)&&Object.keys(i).forEach(d=>{i[d].duration||(i[d].duration=l*i[d].timescale-i[d].start)})}return i}function y_(r){const t={valid:null,remainder:null},e=Dt(r,["moof"]);if(e.length<2)return t.remainder=r,t;const i=e[e.length-1];return t.valid=r.slice(0,i.byteOffset-8),t.remainder=r.slice(i.byteOffset-8),t}function Ii(r,t){const e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function wy(r,t){const e=[],i=t.samples,s=t.timescale,a=t.id;let l=!1;return Dt(i,["moof"]).map(d=>{const f=d.byteOffset-8;Dt(d,["traf"]).map(p=>{const g=Dt(p,["tfdt"]).map(v=>{const y=v[0];let S=Tt(v,4);return y===1&&(S*=Math.pow(2,32),S+=Tt(v,8)),S/s})[0];return g!==void 0&&(r=g),Dt(p,["tfhd"]).map(v=>{const y=Tt(v,4),S=Tt(v,0)&16777215,T=(S&1)!==0,A=(S&2)!==0,b=(S&8)!==0;let R=0;const C=(S&16)!==0;let D=0;const N=(S&32)!==0;let w=8;y===a&&(T&&(w+=8),A&&(w+=4),b&&(R=Tt(v,w),w+=4),C&&(D=Tt(v,w),w+=4),N&&(w+=4),t.type==="video"&&(l=Pu(t.codec)),Dt(p,["trun"]).map(P=>{const B=P[0],M=Tt(P,0)&16777215,q=(M&1)!==0;let tt=0;const V=(M&4)!==0,H=(M&256)!==0;let X=0;const O=(M&512)!==0;let G=0;const K=(M&1024)!==0,nt=(M&2048)!==0;let ut=0;const k=Tt(P,4);let j=8;q&&(tt=Tt(P,j),j+=4),V&&(j+=4);let st=tt+f;for(let ct=0;ct<k;ct++){if(H?(X=Tt(P,j),j+=4):X=R,O?(G=Tt(P,j),j+=4):G=D,K&&(j+=4),nt&&(B===0?ut=Tt(P,j):ut=QE(P,j),j+=4),t.type===Zt.VIDEO){let ft=0;for(;ft<G;){const dt=Tt(i,st);if(st+=4,v_(l,i[st])){const Et=i.subarray(st,st+dt);Dh(Et,l?2:1,r+ut/s,e)}st+=dt,ft+=dt+4}}r+=X/s}}))})})}),e}function Pu(r){if(!r)return!1;const t=r.substring(0,4);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function v_(r,t){if(r){const e=t>>1&63;return e===39||e===40}else return(t&31)===6}function Dh(r,t,e,i){const s=ex(r);let a=0;a+=t;let l=0,u=0,d=0;for(;a<s.length;){l=0;do{if(a>=s.length)break;d=s[a++],l+=d}while(d===255);u=0;do{if(a>=s.length)break;d=s[a++],u+=d}while(d===255);const f=s.length-a;let h=a;if(u<f)a+=u;else if(u>f){Kt.error(`Malformed SEI payload. ${u} is too small, only ${f} bytes left to parse.`);break}if(l===4){if(s[h++]===181){const g=WE(s,h);if(h+=2,g===49){const v=Tt(s,h);if(h+=4,v===1195456820){const y=s[h++];if(y===3){const S=s[h++],T=31&S,A=64&S,b=A?2+T*3:0,R=new Uint8Array(b);if(A){R[0]=S;for(let C=1;C<b;C++)R[C]=s[h++]}i.push({type:y,payloadType:l,pts:e,bytes:R})}}}}}else if(l===5&&u>16){const p=[];for(let y=0;y<16;y++){const S=s[h++].toString(16);p.push(S.length==1?"0"+S:S),(y===3||y===5||y===7||y===9)&&p.push("-")}const g=u-16,v=new Uint8Array(g);for(let y=0;y<g;y++)v[y]=s[h++];i.push({payloadType:l,pts:e,uuid:p.join(""),userData:Ei(v),userDataBytes:v})}}}function ex(r){const t=r.byteLength,e=[];let i=1;for(;i<t-2;)r[i]===0&&r[i+1]===0&&r[i+2]===3?(e.push(i+2),i+=2):i++;if(e.length===0)return r;const s=t-e.length,a=new Uint8Array(s);let l=0;for(i=0;i<s;l++,i++)l===e[0]&&(l++,e.shift()),a[i]=r[l];return a}function E_(r){const t=r[0];let e="",i="",s=0,a=0,l=0,u=0,d=0,f=0;if(t===0){for(;Re(r.subarray(f,f+1))!=="\0";)e+=Re(r.subarray(f,f+1)),f+=1;for(e+=Re(r.subarray(f,f+1)),f+=1;Re(r.subarray(f,f+1))!=="\0";)i+=Re(r.subarray(f,f+1)),f+=1;i+=Re(r.subarray(f,f+1)),f+=1,s=Tt(r,12),a=Tt(r,16),u=Tt(r,20),d=Tt(r,24),f=28}else if(t===1){f+=4,s=Tt(r,f),f+=4;const p=Tt(r,f);f+=4;const g=Tt(r,f);for(f+=4,l=2**32*p+g,XL(l)||(l=Number.MAX_SAFE_INTEGER,Kt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Tt(r,f),f+=4,d=Tt(r,f),f+=4;Re(r.subarray(f,f+1))!=="\0";)e+=Re(r.subarray(f,f+1)),f+=1;for(e+=Re(r.subarray(f,f+1)),f+=1;Re(r.subarray(f,f+1))!=="\0";)i+=Re(r.subarray(f,f+1)),f+=1;i+=Re(r.subarray(f,f+1)),f+=1}const h=r.subarray(f,r.byteLength);return{schemeIdUri:e,value:i,timeScale:s,presentationTime:l,presentationTimeDelta:a,eventDuration:u,id:d,payload:h}}function x_(r,...t){const e=t.length;let i=8,s=e;for(;s--;)i+=t[s].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(r,4),s=0,i=8;s<e;s++)a.set(t[s],i),i+=t[s].byteLength;return a}function S_(r,t,e){if(r.byteLength!==16)throw new RangeError("Invalid system id");let i,s;i=0,s=new Uint8Array;let a;i>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;const l=new Uint8Array(4);return e.byteLength>0&&new DataView(l.buffer).setUint32(0,e.byteLength,!1),x_([112,115,115,104],new Uint8Array([i,0,0,0]),r,a,s,l,e)}function T_(r){const t=[];if(r instanceof ArrayBuffer){const e=r.byteLength;let i=0;for(;i+32<e;){const s=new DataView(r,i),a=b_(s);t.push(a),i+=a.size}}return t}function b_(r){const t=r.getUint32(0),e=r.byteOffset,i=r.byteLength;if(i<t)return{offset:e,size:i};if(r.getUint32(4)!==1886614376)return{offset:e,size:t};const a=r.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:e,size:t};const l=r.buffer,u=qe(new Uint8Array(l,e+12,16));let d=null,f=null,h=0;if(a===0)h=28;else{const g=r.getUint32(28);if(!g||i<32+g*16)return{offset:e,size:t};d=[];for(let v=0;v<g;v++)d.push(new Uint8Array(l,e+32+v*16,16));h=32+g*16}if(!h)return{offset:e,size:t};const p=r.getUint32(h);return t-32<p?{offset:e,size:t}:(f=new Uint8Array(l,e+h+4,p),{version:a,systemId:u,kids:d,data:f,offset:e,size:t})}const ix=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Yr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ih(r,t){const e=Yr[t];return!!e&&!!e[r.slice(0,4)]}function no(r,t,e=!0){return!r.split(",").some(i=>!Oh(i,t,e))}function Oh(r,t,e=!0){var i;const s=ps(e);return(i=s?.isTypeSupported(so(r,t)))!=null?i:!1}function so(r,t){return`${t}/mp4;codecs=${r}`}function Dy(r){if(r){const t=r.substring(0,4);return Yr.video[t]}return 2}function mu(r){const t=ix();return r.split(",").reduce((e,i)=>{const a=t&&Pu(i)?9:Yr.video[i];return a?(a*2+e)/(e?3:2):(Yr.audio[i]+e)/(e?2:1)},0)}const gd={};function A_(r,t=!0){if(gd[r])return gd[r];const e={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[r];for(let s=0;s<e.length;s++){var i;if(Oh(e[s],"audio",t))return gd[r]=e[s],e[s];if(e[s]==="mp3"&&(i=ps(t))!=null&&i.isTypeSupported("audio/mpeg"))return""}return r}const R_=/flac|opus|mp4a\.40\.34/i;function pu(r,t=!0){return r.replace(R_,e=>A_(e.toLowerCase(),t))}function L_(r,t){const e=[];if(r){const i=r.split(",");for(let s=0;s<i.length;s++)Ih(i[s],"video")||e.push(i[s])}return t&&e.push(t),e.join(",")}function Jl(r,t){if(r&&(r.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(r)!==-1)&&(Iy(r,"audio")||Iy(r,"video")))return r;if(t){const e=t.split(",");if(e.length>1){if(r){for(let i=e.length;i--;)if(e[i].substring(0,4)===r.substring(0,4))return e[i]}return e[0]}}return t||r}function Iy(r,t){return Ih(r,t)&&Oh(r,t)}function __(r){const t=r.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(".");i.length>2&&i[0]==="avc1"&&(t[e]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return t.join(",")}function C_(r){if(r.startsWith("av01.")){const t=r.split("."),e=["0","111","01","01","01","0"];for(let i=t.length;i>4&&i<10;i++)t[i]=e[i-4];return t.join(".")}return r}function Oy(r){const t=ps(r)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Kd(r){return r.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const w_={supported:!0,powerEfficient:!0,smooth:!0},D_={supported:!1,smooth:!1,powerEfficient:!1},nx={supported:!0,configurations:[],decodingInfoResults:[w_]};function sx(r,t){return{supported:!1,configurations:t,decodingInfoResults:[D_],error:r}}function I_(r,t,e,i,s,a){const l=r.videoCodec,u=r.audioCodec?r.audioGroups:null,d=a?.audioCodec,f=a?.channels,h=f?parseInt(f):d?1/0:2;let p=null;if(u!=null&&u.length)try{u.length===1&&u[0]?p=t.groups[u[0]].channels:p=u.reduce((g,v)=>{if(v){const y=t.groups[v];if(!y)throw new Error(`Audio track group ${v} not found`);Object.keys(y.channels).forEach(S=>{g[S]=(g[S]||0)+y.channels[S]})}return g},{2:0})}catch{return!0}return l!==void 0&&(l.split(",").some(g=>Pu(g))||r.width>1920&&r.height>1088||r.height>1920&&r.width>1088||r.frameRate>Math.max(i,30)||r.videoRange!=="SDR"&&r.videoRange!==e||r.bitrate>Math.max(s,8e6))||!!p&&ht(h)&&Object.keys(p).some(g=>parseInt(g)>h)}function rx(r,t,e,i={}){const s=r.videoCodec;if(!s&&!r.audioCodec||!e)return Promise.resolve(nx);const a=[],l=O_(r),u=l.length,d=k_(r,t,u>0),f=d.length;for(let h=u||1*f||1;h--;){const p={type:"media-source"};if(u&&(p.video=l[h%u]),f){p.audio=d[h%f];const g=p.audio.bitrate;p.video&&g&&(p.video.bitrate-=g)}a.push(p)}if(s){const h=navigator.userAgent;if(s.split(",").some(p=>Pu(p))&&ix())return Promise.resolve(sx(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${h})`),a))}return Promise.all(a.map(h=>{const p=P_(h);return i[p]||(i[p]=e.decodingInfo(h))})).then(h=>({supported:!h.some(p=>!p.supported),configurations:a,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:a,decodingInfoResults:[],error:h}))}function O_(r){var t;const e=(t=r.videoCodec)==null?void 0:t.split(","),i=ax(r),s=r.width||640,a=r.height||480,l=r.frameRate||30,u=r.videoRange.toLowerCase();return e?e.map(d=>{const f={contentType:so(C_(d),"video"),width:s,height:a,bitrate:i,framerate:l};return u!=="sdr"&&(f.transferFunction=u),f}):[]}function k_(r,t,e){var i;const s=(i=r.audioCodec)==null?void 0:i.split(","),a=ax(r);return s&&r.audioGroups?r.audioGroups.reduce((l,u)=>{var d;const f=u?(d=t.groups[u])==null?void 0:d.tracks:null;return f?f.reduce((h,p)=>{if(p.groupId===u){const g=parseFloat(p.channels||"");s.forEach(v=>{const y={contentType:so(v,"audio"),bitrate:e?M_(v,a):a};g&&(y.channels=""+g),h.push(y)})}return h},l):l},[]):[]}function M_(r,t){if(t<=1)return 1;let e=128e3;return r==="ec-3"?e=768e3:r==="ac-3"&&(e=64e4),Math.min(t/2,e)}function ax(r){return Math.ceil(Math.max(r.bitrate*.9,r.averageBitrate)/1e3)*1e3||1}function P_(r){let t="";const{audio:e,video:i}=r;if(i){const s=Kd(i.contentType);t+=`${s}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(e){const s=Kd(e.contentType);t+=`${i?"_":""}${s}_c${e.channels}`}return t}const qd=["NONE","TYPE-0","TYPE-1",null];function N_(r){return qd.indexOf(r)>-1}const gu=["SDR","PQ","HLG"];function F_(r){return!!r&&gu.indexOf(r)>-1}var tu={No:"",Yes:"YES",v2:"v2"};function ky(r){const{canSkipUntil:t,canSkipDateRanges:e,age:i}=r,s=i<t/2;return t&&s?e?tu.v2:tu.Yes:tu.No}class My{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return this.msn!==void 0&&e.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class ro{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const i=(e=t.supplemental)==null?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return Py(this._audioGroups,t)}hasSubtitleGroup(t){return Py(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e){if(t==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(e)===-1&&i.push(e)}else if(t==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(e)===-1&&i.push(e)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function Py(r,t){return!t||!r?!1:r.indexOf(t)!==-1}function B_(){if(typeof matchMedia=="function"){const r=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(r.media!==t.media)return r.matches===!0}return!1}function U_(r,t){let e=!1,i=[];if(r&&(e=r!=="SDR",i=[r]),t){i=t.allowedVideoRanges||gu.slice(0);const s=i.join("")!=="SDR"&&!t.videoCodec;e=t.preferHDR!==void 0?t.preferHDR:s&&B_(),e||(i=["SDR"])}return{preferHDR:e,allowedVideoRanges:i}}const $_=r=>{const t=new WeakSet;return(e,i)=>{if(r&&(i=r(e,i)),typeof i=="object"&&i!==null){if(t.has(i))return;t.add(i)}return i}},Jt=(r,t)=>JSON.stringify(r,$_(t));function j_(r,t,e,i,s){const a=Object.keys(r),l=i?.channels,u=i?.audioCodec,d=s?.videoCodec,f=l&&parseInt(l)===2;let h=!1,p=!1,g=1/0,v=1/0,y=1/0,S=1/0,T=0,A=[];const{preferHDR:b,allowedVideoRanges:R}=U_(t,s);for(let P=a.length;P--;){const B=r[a[P]];h||(h=B.channels[2]>0),g=Math.min(g,B.minHeight),v=Math.min(v,B.minFramerate),y=Math.min(y,B.minBitrate),R.filter(q=>B.videoRanges[q]>0).length>0&&(p=!0)}g=ht(g)?g:0,v=ht(v)?v:0;const C=Math.max(1080,g),D=Math.max(30,v);y=ht(y)?y:e,e=Math.max(y,e),p||(t=void 0);const N=a.length>1;return{codecSet:a.reduce((P,B)=>{const M=r[B];if(B===P)return P;if(A=p?R.filter(q=>M.videoRanges[q]>0):[],N){if(M.minBitrate>e)return qi(B,`min bitrate of ${M.minBitrate} > current estimate of ${e}`),P;if(!M.hasDefaultAudio)return qi(B,"no renditions with default or auto-select sound found"),P;if(u&&B.indexOf(u.substring(0,4))%5!==0)return qi(B,`audio codec preference "${u}" not found`),P;if(l&&!f){if(!M.channels[l])return qi(B,`no renditions with ${l} channel sound found (channels options: ${Object.keys(M.channels)})`),P}else if((!u||f)&&h&&M.channels[2]===0)return qi(B,"no renditions with stereo sound found"),P;if(M.minHeight>C)return qi(B,`min resolution of ${M.minHeight} > maximum of ${C}`),P;if(M.minFramerate>D)return qi(B,`min framerate of ${M.minFramerate} > maximum of ${D}`),P;if(!A.some(q=>M.videoRanges[q]>0))return qi(B,`no variants with VIDEO-RANGE of ${Jt(A)} found`),P;if(d&&B.indexOf(d.substring(0,4))%5!==0)return qi(B,`video codec preference "${d}" not found`),P;if(M.maxScore<T)return qi(B,`max score of ${M.maxScore} < selected max of ${T}`),P}return P&&(mu(B)>=mu(P)||M.fragmentError>r[P].fragmentError)?P:(S=M.minIndex,T=M.maxScore,B)},void 0),videoRanges:A,preferHDR:b,minFramerate:v,minBitrate:y,minIndex:S}}function qi(r,t){Kt.log(`[abr] start candidates with "${r}" ignored because ${t}`)}function ox(r){return r.reduce((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const s=e.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function G_(r,t,e,i){return r.slice(e,i+1).reduce((s,a,l)=>{if(!a.codecSet)return s;const u=a.audioGroups;let d=s[a.codecSet];d||(s[a.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,a.bitrate);const f=Math.min(a.height,a.width);return d.minHeight=Math.min(d.minHeight,f),d.minFramerate=Math.min(d.minFramerate,a.frameRate),d.minIndex=Math.min(d.minIndex,l),d.maxScore=Math.max(d.maxScore,a.score),d.fragmentError+=a.fragmentError,d.videoRanges[a.videoRange]=(d.videoRanges[a.videoRange]||0)+1,u&&u.forEach(h=>{if(!h)return;const p=t.groups[h];p&&(d.hasDefaultAudio=d.hasDefaultAudio||t.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(p.channels).forEach(g=>{d.channels[g]=(d.channels[g]||0)+p.channels[g]}))}),s},{})}function Ny(r){if(!r)return r;const{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:a}=r;return{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:a}}function Zi(r,t,e){if("attrs"in r){const i=t.indexOf(r);if(i!==-1)return i}for(let i=0;i<t.length;i++){const s=t[i];if(Hs(r,s,e))return i}return-1}function Hs(r,t,e){const{groupId:i,name:s,lang:a,assocLang:l,default:u}=r,d=r.forced;return(i===void 0||t.groupId===i)&&(s===void 0||t.name===s)&&(a===void 0||H_(a,t.lang))&&(a===void 0||t.assocLang===l)&&(u===void 0||t.default===u)&&(d===void 0||t.forced===d)&&(!("characteristics"in r)||z_(r.characteristics||"",t.characteristics))&&(e===void 0||e(r,t))}function H_(r,t="--"){return r.length===t.length?r===t:r.startsWith(t)||t.startsWith(r)}function z_(r,t=""){const e=r.split(","),i=t.split(",");return e.length===i.length&&!e.some(s=>i.indexOf(s)===-1)}function js(r,t){const{audioCodec:e,channels:i}=r;return(e===void 0||(t.audioCodec||"").substring(0,4)===e.substring(0,4))&&(i===void 0||i===(t.channels||"2"))}function V_(r,t,e,i,s){const a=t[i],u=t.reduce((g,v,y)=>{const S=v.uri;return(g[S]||(g[S]=[])).push(y),g},{})[a.uri];u.length>1&&(i=Math.max.apply(Math,u));const d=a.videoRange,f=a.frameRate,h=a.codecSet.substring(0,4),p=Fy(t,i,g=>{if(g.videoRange!==d||g.frameRate!==f||g.codecSet.substring(0,4)!==h)return!1;const v=g.audioGroups,y=e.filter(S=>!v||v.indexOf(S.groupId)!==-1);return Zi(r,y,s)>-1});return p>-1?p:Fy(t,i,g=>{const v=g.audioGroups,y=e.filter(S=>!v||v.indexOf(S.groupId)!==-1);return Zi(r,y,s)>-1})}function Fy(r,t,e){for(let i=t;i>-1;i--)if(e(r[i]))return i;for(let i=t+1;i<r.length;i++)if(e(r[i]))return i;return-1}function yu(r,t){var e;return!!r&&r!==((e=t.loadLevelObj)==null?void 0:e.uri)}class K_ extends Oi{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var i;const{fragCurrent:s,partCurrent:a,hls:l}=this,{autoLevelEnabled:u,media:d}=l;if(!s||!d)return;const f=performance.now(),h=a?a.stats:s.stats,p=a?a.duration:s.duration,g=f-h.loading.start,v=l.minAutoLevel,y=s.level,S=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||y<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const T=S>-1&&S!==y,A=!!e||T;if(!A&&(d.paused||!d.playbackRate||!d.readyState))return;const b=l.mainForwardBufferInfo;if(!A&&b===null)return;const R=this.bwEstimator.getEstimateTTFB(),C=Math.abs(d.playbackRate);if(g<=Math.max(R,1e3*(p/(C*2))))return;const D=b?b.len/C:0,N=h.loading.first?h.loading.first-h.loading.start:-1,w=h.loaded&&N>-1,P=this.getBwEstimate(),B=l.levels,M=B[y],q=Math.max(h.loaded,Math.round(p*(s.bitrate||M.averageBitrate)/8));let tt=w?g-N:g;tt<1&&w&&(tt=Math.min(g,h.loaded*8/P));const V=w?h.loaded*1e3/tt:0,H=R/1e3,X=V?(q-h.loaded)/V:q*8/P+H;if(X<=D)return;const O=V?V*8:P,G=((i=e?.details||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,K=this.hls.config.abrBandWidthUpFactor;let nt=Number.POSITIVE_INFINITY,ut;for(ut=y-1;ut>v;ut--){const ct=B[ut].maxBitrate,ft=!B[ut].details||G;if(nt=this.getTimeToLoadFrag(H,O,p*ct,ft),nt<Math.min(D,p+H))break}if(nt>=X||nt>p*10)return;w?this.bwEstimator.sample(g-Math.min(R,N),h.loaded):this.bwEstimator.sampleTTFB(g);const k=B[ut].maxBitrate;this.getBwEstimate()*K>k&&this.resetEstimator(k);const j=this.findBestLevel(k,v,ut,0,D,1,1);j>-1&&(ut=j),this.warn(`Fragment ${s.sn}${a?" part "+a.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${D.toFixed(3)} s
      Estimated load time for current fragment: ${X.toFixed(3)} s
      Estimated load time for down switch fragment: ${nt.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${ht(P)?P|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${ut} @ ${k|0} bps`),l.nextLoadLevel=l.nextAutoLevel=ut,this.clearTimer();const st=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===ut&&ut>0){const ct=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ut>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${ct.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,ut>v){let ft=this.findBestLevel(this.hls.levels[v].bitrate,v,ut,0,ct,1,1);ft===-1&&(ft=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ft,this.resetEstimator(this.hls.levels[ft].bitrate)}}};T||X>nt*2?st():this.timer=self.setInterval(st,nt*1e3),l.trigger(_.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:a,stats:h})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new QL(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(_.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var s;this.fragCurrent=i,this.partCurrent=(s=e.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const i=e.frag,{fragCurrent:s,partCurrent:a}=this;if(i&&s&&i.sn===s.sn&&i.level===s.level){const l=performance.now(),u=a?a.stats:i.stats,d=l-u.loading.start,f=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&f>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,f),u.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(t,e,i,s){const a=t+i/e,l=s?t+this.lastLevelLoadSec:0;return a+l}onLevelLoaded(t,e){const i=this.hls.config,{loading:s}=e.stats,a=s.end-s.first;ht(a)&&(this.lastLevelLoadSec=a/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:i}){const s=i?i.stats:e.stats;if(e.type===mt.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=i?i.duration:e.duration,l=this.hls.levels[e.level],u=(l.loaded?l.loaded.bytes:0)+s.loaded,d=(l.loaded?l.loaded.duration:0)+a;l.loaded={bytes:u,duration:d},l.realBitrate=Math.round(8*u/d)}if(e.bitrateTest){const a={stats:s,frag:e,part:i,id:e.type};this.onFragBuffered(_.FRAG_BUFFERED,a),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:i,part:s}=e,a=s!=null&&s.stats.loaded?s.stats:i.stats;if(a.aborted||this.ignoreFragment(i))return;const l=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==mt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,e,t,0,s,1,1);if(a>-1)return a;const l=this.hls.firstLevel,u=Math.min(Math.max(l,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(t!==-1&&(!i||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const a=i&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const l=this.hls.levels;if(l.length>Math.max(t,a)&&l[t].loadError<=l[a].loadError)return t}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:s,config:a,minAutoLevel:l}=i,u=e?e.duration:t?t.duration:0,d=this.getBwEstimate(),f=this.getStarvationDelay();let h=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(f){const T=this.findBestLevel(d,l,s,f,0,h,p);if(T>=0)return this.rebufferNotice=-1,T}let g=u?Math.min(u,a.maxStarvationDelay):a.maxStarvationDelay;if(!f){const T=this.bitrateTestDelay;T&&(g=(u?Math.min(u,a.maxLoadingDelay):a.maxLoadingDelay)-T,this.info(`bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),h=p=1)}const v=this.findBestLevel(d,l,s,f,g,h,p);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const y=i.levels[l],S=i.loadLevelObj;return S&&y?.bitrate<S.bitrate?l:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&e.playbackRate!==0?Math.abs(e.playbackRate):1,s=t.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,s,a,l,u){var d;const f=s+a,h=this.lastLoadedFragLevel,p=h===-1?this.hls.firstLevel:h,{fragCurrent:g,partCurrent:v}=this,{levels:y,allAudioTracks:S,loadLevel:T,config:A}=this.hls;if(y.length===1)return 0;const b=y[p],R=!!((d=this.hls.latestLevelDetails)!=null&&d.live),C=T===-1||h===-1;let D,N="SDR",w=b?.frameRate||0;const{audioPreference:P,videoPreference:B}=A,M=this.audioTracksByGroup||(this.audioTracksByGroup=ox(S));let q=-1;if(C){if(this.firstSelection!==-1)return this.firstSelection;const O=this.codecTiers||(this.codecTiers=G_(y,M,e,i)),G=j_(O,N,t,P,B),{codecSet:K,videoRanges:nt,minFramerate:ut,minBitrate:k,minIndex:j,preferHDR:st}=G;q=j,D=K,N=st?nt[nt.length-1]:nt[0],w=ut,t=Math.max(t,k),this.log(`picked start tier ${Jt(G)}`)}else D=b?.codecSet,N=b?.videoRange;const tt=v?v.duration:g?g.duration:0,V=this.bwEstimator.getEstimateTTFB()/1e3,H=[];for(let O=i;O>=e;O--){var X;const G=y[O],K=O>p;if(!G)continue;if(A.useMediaCapabilities&&!G.supportedResult&&!G.supportedPromise){const ft=navigator.mediaCapabilities;typeof ft?.decodingInfo=="function"&&I_(G,M,N,w,t,P)?(G.supportedPromise=rx(G,M,ft,this.supportedCache),G.supportedPromise.then(dt=>{if(!this.hls)return;G.supportedResult=dt;const Et=this.hls.levels,Lt=Et.indexOf(G);dt.error?this.warn(`MediaCapabilities decodingInfo error: "${dt.error}" for level ${Lt} ${Jt(dt)}`):dt.supported?dt.decodingInfoResults.some(_t=>_t.smooth===!1||_t.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Lt} not smooth or powerEfficient: ${Jt(dt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Lt} ${Jt(dt)}`),Lt>-1&&Et.length>1&&(this.log(`Removing unsupported level ${Lt}`),this.hls.removeLevel(Lt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(dt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${dt}`)})):G.supportedResult=nx}if((D&&G.codecSet!==D||N&&G.videoRange!==N||K&&w>G.frameRate||!K&&w>0&&w<G.frameRate||(X=G.supportedResult)!=null&&(X=X.decodingInfoResults)!=null&&X.some(ft=>ft.smooth===!1))&&(!C||O!==q)){H.push(O);continue}const nt=G.details,ut=(v?nt?.partTarget:nt?.averagetargetduration)||tt;let k;K?k=u*t:k=l*t;const j=tt&&s>=tt*2&&a===0?G.averageBitrate:G.maxBitrate,st=this.getTimeToLoadFrag(V,k,j*ut,nt===void 0);if(k>=j&&(O===h||G.loadError===0&&G.fragmentError===0)&&(st<=V||!ht(st)||R&&!this.bitrateTestDelay||st<f)){const ft=this.forcedAutoLevel;return O!==T&&(ft===-1||ft!==T)&&(H.length&&this.trace(`Skipped level(s) ${H.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${y[H[0]].codecs}" ${y[H[0]].videoRange}; not compatible with "${D}" ${N}`),this.info(`switch candidate:${p}->${O} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-j)} ttfb:${V.toFixed(1)} avgDuration:${ut.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${st.toFixed(1)} firstSelection:${C} codecSet:${G.codecSet} videoRange:${G.videoRange} hls.loadLevel:${T}`)),C&&(this.firstSelection=O),O}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}}const lx={search:function(r,t){let e=0,i=r.length-1,s=null,a=null;for(;e<=i;){s=(e+i)/2|0,a=r[s];const l=t(a);if(l>0)e=s+1;else if(l<0)i=s-1;else return a}return null}};function q_(r,t,e){if(t===null||!Array.isArray(r)||!r.length||!ht(t))return null;const i=r[0].programDateTime;if(t<(i||0))return null;const s=r[r.length-1].endProgramDateTime;if(t>=(s||0))return null;for(let a=0;a<r.length;++a){const l=r[a];if(X_(t,e,l))return l}return null}function qs(r,t,e=0,i=0,s=.005){let a=null;if(r){a=t[1+r.sn-t[0].sn]||null;const u=r.endDTS-e;u>0&&u<15e-7&&(e+=15e-7),a&&r.level!==a.level&&a.end<=r.end&&(a=t[2+r.sn-t[0].sn]||null)}else e===0&&t[0].start===0&&(a=t[0]);if(a&&((!r||r.level===a.level)&&By(e,i,a)===0||Y_(a,r,Math.min(s,i))))return a;const l=lx.search(t,By.bind(null,e,i));return l&&(l!==r||!a)?l:a}function Y_(r,t,e){if(t&&t.start===0&&t.level<r.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((s,a)=>(a[0]==="INF"&&(s+=parseFloat(a[1])),s),e);return r.start<=i}return!1}function By(r=0,t=0,e){if(e.start<=r&&e.start+e.duration>r)return 0;const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-i<=r?1:e.start-i>r&&e.start?-1:0}function X_(r,t,e){const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0))*1e3;return(e.endProgramDateTime||0)-i>r}function ux(r,t,e){if(r&&r.startCC<=t&&r.endCC>=t){let i=r.fragments;const{fragmentHint:s}=r;s&&(i=i.concat(s));let a;return lx.search(i,l=>l.cc<t?1:l.cc>t?-1:(a=l,l.end<=e?1:l.start>e?-1:0)),a||null}return null}function vu(r){switch(r.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function cx(r){return r.details.startsWith("key")}function fx(r){return cx(r)&&!!r.frag&&!r.frag.decryptdata}function Uy(r,t){const e=vu(t);return r.default[`${e?"timeout":"error"}Retry`]}function kh(r,t){const e=r.backoff==="linear"?1:Math.pow(2,t);return Math.min(e*r.retryDelayMs,r.maxRetryDelayMs)}function $y(r){return Vt(Vt({},r),{errorRetry:null,timeoutRetry:null})}function Eu(r,t,e,i){if(!r)return!1;const s=i?.code,a=t<r.maxNumRetry&&(W_(s)||!!e);return r.shouldRetry?r.shouldRetry(r,t,e,i,a):a}function W_(r){return Yd(r)||!!r&&(r<400||r>499)}function Yd(r){return r===0&&navigator.onLine===!1}var Ue={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},mi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class Q_ extends Oi{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(_.ERROR,this.onError,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(_.ERROR,this.onError,this),t.off(_.ERROR,this.onErrorOut,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return t?.type===mt.MAIN?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,i=e.currentLevel;return(t=e.loadLevelObj)!=null&&t.details||i===-1?e.loadLevel:i}variantHasKey(t,e){if(t){var i;if((i=t.details)!=null&&i.hasKey(e))return!0;const s=t.audioGroups;if(s)return this.hls.allAudioTracks.filter(l=>s.indexOf(l.groupId)>=0).some(l=>{var u;return(u=l.details)==null?void 0:u.hasKey(e)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;const s=this.hls,a=e.context;switch(e.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:e.errorAction=this.getFragRetryOrSwitchAction(e);return;case Q.FRAG_PARSING_ERROR:if((i=e.frag)!=null&&i.gap){e.errorAction=Hr();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{e.errorAction=this.getFragRetryOrSwitchAction(e),e.errorAction.action=Ue.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var l;const d=e.parent===mt.MAIN?e.level:s.loadLevel;e.details===Q.LEVEL_EMPTY_ERROR&&((l=e.context)!=null&&(l=l.levelDetails)!=null&&l.live)?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,d):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,d))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof a?.level=="number"&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,a.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const d=s.loadLevelObj;if(d&&(a.type===It.AUDIO_TRACK&&d.hasAudioGroup(a.groupId)||a.type===It.SUBTITLE_TRACK&&d.hasSubtitleGroup(a.groupId))){e.errorAction=this.getPlaylistRetryOrSwitchAction(e,s.loadLevel),e.errorAction.action=Ue.SendAlternateToPenaltyBox,e.errorAction.flags=mi.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:e.errorAction={action:Ue.SendAlternateToPenaltyBox,flags:mi.MoveAllAlternatesMatchingHDCP};return;case Q.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Q.KEY_SYSTEM_NO_SESSION:e.errorAction={action:Ue.SendAlternateToPenaltyBox,flags:mi.MoveAllAlternatesMatchingKey};return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!e.errorAction){var u;e.errorAction=this.getLevelSwitchAction(e,(u=e.level)!=null?u:s.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:e.errorAction=Hr();return}e.type===vt.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=Hr())}getPlaylistRetryOrSwitchAction(t,e){const i=this.hls,s=Uy(i.config.playlistLoadPolicy,t),a=this.playlistError++;if(Eu(s,a,vu(t),t.response))return{action:Ue.RetryRequest,flags:mi.None,retryConfig:s,retryCount:a};const u=this.getLevelSwitchAction(t,e);return s&&(u.retryConfig=s,u.retryCount=a),u}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),s=e.levels[i],{fragLoadPolicy:a,keyLoadPolicy:l}=e.config,u=Uy(cx(t)?l:a,t),d=e.levels.reduce((h,p)=>h+p.fragmentError,0);if(s&&(t.details!==Q.FRAG_GAP&&s.fragmentError++,!fx(t)&&Eu(u,d,vu(t),t.response)))return{action:Ue.RetryRequest,flags:mi.None,retryConfig:u,retryCount:d};const f=this.getLevelSwitchAction(t,i);return u&&(f.retryConfig=u,f.retryCount=d),f}getLevelSwitchAction(t,e){const i=this.hls;e==null&&(e=i.loadLevel);const s=this.hls.levels[e];if(s){var a,l;const f=t.details;s.loadError++,f===Q.BUFFER_APPEND_ERROR&&s.fragmentError++;let h=-1;const{levels:p,loadLevel:g,minAutoLevel:v,maxAutoLevel:y}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const S=(a=t.frag)==null?void 0:a.type,A=(S===mt.AUDIO&&f===Q.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:N})=>s.audioCodec!==N),R=t.sourceBufferName==="video"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR)&&p.some(({codecSet:N,audioCodec:w})=>s.codecSet!==N&&s.audioCodec===w),{type:C,groupId:D}=(l=t.context)!=null?l:{};for(let N=p.length;N--;){const w=(N+g)%p.length;if(w!==g&&w>=v&&w<=y&&p[w].loadError===0){var u,d;const P=p[w];if(f===Q.FRAG_GAP&&S===mt.MAIN&&t.frag){const B=p[w].details;if(B){const M=qs(t.frag,B.fragments,t.frag.start);if(M!=null&&M.gap)continue}}else{if(C===It.AUDIO_TRACK&&P.hasAudioGroup(D)||C===It.SUBTITLE_TRACK&&P.hasSubtitleGroup(D))continue;if(S===mt.AUDIO&&(u=s.audioGroups)!=null&&u.some(B=>P.hasAudioGroup(B))||S===mt.SUBTITLE&&(d=s.subtitleGroups)!=null&&d.some(B=>P.hasSubtitleGroup(B))||A&&s.audioCodec===P.audioCodec||R&&s.codecSet===P.codecSet||!A&&s.codecSet!==P.codecSet)continue}h=w;break}}if(h>-1&&i.loadLevel!==h)return t.levelRetry=!0,this.playlistError=0,{action:Ue.SendAlternateToPenaltyBox,flags:mi.None,nextAutoLevel:h}}return{action:Ue.SendAlternateToPenaltyBox,flags:mi.MoveAllAlternatesMatchingHost}}onErrorOut(t,e){var i;switch((i=e.errorAction)==null?void 0:i.action){case Ue.DoNothing:break;case Ue.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(e),!e.errorAction.resolved&&e.details!==Q.FRAG_GAP?e.fatal=!0:/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(e.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:s}=i,a=i.nextAutoLevel;switch(s){case mi.None:this.switchLevel(t,a);break;case mi.MoveAllAlternatesMatchingHDCP:{const d=this.getVariantLevelIndex(t.frag),f=e.levels[d],h=f?.attrs["HDCP-LEVEL"];if(i.hdcpLevel=h,h==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(h){e.maxHdcpLevel=qd[qd.indexOf(h)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}}case mi.MoveAllAlternatesMatchingKey:{const d=t.decryptdata;if(d){const f=this.hls.levels,h=f.length;for(let g=h;g--;)if(this.variantHasKey(f[g],d)){var l,u;this.log(`Banned key found in level ${g} (${f[g].bitrate}bps) or audio group "${(l=f[g].audioGroups)==null?void 0:l.join(",")}" (${(u=t.frag)==null?void 0:u.type} fragment) ${qe(d.keyId||[])}`),f[g].fragmentError++,f[g].loadError++,this.log(`Removing level ${g} with key error (${t.error})`),this.hls.removeLevel(g)}const p=t.frag;if(this.hls.levels.length<h)i.resolved=!0;else if(p&&p.type!==mt.MAIN){const g=p.decryptdata;g&&!d.matches(g)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(t,a)}switchLevel(t,e){if(e!==void 0&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===Q.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&t.sourceBufferName!=="audiovideo")){const i=Kd(t.mimeType),s=this.hls.levels;for(let a=s.length;a--;)s[a][`${t.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${a} for ${t.details} ("${i}" not supported)`),this.hls.removeLevel(a))}}}function Hr(r){const t={action:Ue.DoNothing,flags:mi.None};return r&&(t.resolved=!0),t}var Le={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Z_{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let s=i.length;s--;){const a=i[s];if(!a)break;if(a.start<=t&&t<=a.end&&a.loaded)return a}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){const{fragments:s}=this,a=Object.keys(s);for(let l=a.length;l--;){const u=s[a[l]];if(u?.body.type===e&&(!i||u.buffered)){const d=u.body;if(d.start<=t&&t<=d.end)return d}}return null}detectEvictedFragments(t,e,i,s,a){this.timeRanges&&(this.timeRanges[t]=e);const l=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(u=>{const d=this.fragments[u];if(!d||l>=d.body.sn)return;if(!d.buffered&&(!d.loaded||a)){d.body.type===i&&this.removeFragment(d.body);return}const f=d.range[t];if(f){if(f.time.length===0){this.removeFragment(d.body);return}f.time.some(h=>{const p=!this.isTimeBuffered(h.startPTS,h.endPTS,e);return p&&this.removeFragment(d.body),p})}})}detectPartialFragments(t){const e=this.timeRanges;if(!e||t.frag.sn==="initSegment")return;const i=t.frag,s=Fr(i),a=this.fragments[s];if(!a||a.buffered&&i.gap)return;const l=!i.relurl;Object.keys(e).forEach(u=>{const d=i.elementaryStreams[u];if(!d)return;const f=e[u],h=l||d.partial===!0;a.range[u]=this.getBufferedTimes(i,t.part,h,f)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),Nl(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=jy(i,s=>s.fragment.sn>=t))}fragBuffered(t,e){const i=Fr(t);let s=this.fragments[i];!s&&e&&(s=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(t,e,i,s){const a={time:[],partial:i},l=t.start,u=t.end,d=t.minEndPTS||u,f=t.maxStartPTS||l;for(let h=0;h<s.length;h++){const p=s.start(h)-this.bufferPadding,g=s.end(h)+this.bufferPadding;if(f>=p&&d<=g){a.time.push({startPTS:Math.max(l,s.start(h)),endPTS:Math.min(u,s.end(h))});break}else if(l<g&&u>p){const v=Math.max(l,s.start(h)),y=Math.min(u,s.end(h));y>v&&(a.partial=!0,a.time.push({startPTS:v,endPTS:y}))}else if(u<=p)break}return a}getPartialFragment(t){let e=null,i,s,a,l=0;const{bufferPadding:u,fragments:d}=this;return Object.keys(d).forEach(f=>{const h=d[f];h&&Nl(h)&&(s=h.body.start-u,a=h.body.end+u,t>=s&&t<=a&&(i=Math.min(t-s,a-t),l<=i&&(e=h.body,l=i)))}),e}isEndListAppended(t){const e=this.endListFragments[t];return e!==void 0&&(e.buffered||Nl(e))}getState(t){const e=Fr(t),i=this.fragments[e];return i?i.buffered?Nl(i)?Le.PARTIAL:Le.OK:Le.APPENDING:Le.NOT_LOADED}isTimeBuffered(t,e,i){let s,a;for(let l=0;l<i.length;l++){if(s=i.start(l)-this.bufferPadding,a=i.end(l)+this.bufferPadding,t>=s&&e<=a)return!0;if(e<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if(e.frag.sn==="initSegment"||e.frag.bitrateTest)return;const i=e.frag,s=e.part?null:e,a=Fr(i);this.fragments[a]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:s,timeRanges:a,type:l}=e;if(i.sn==="initSegment")return;const u=i.type;if(s){let f=this.activePartLists[u];f||(this.activePartLists[u]=f=[]),f.push(s)}this.timeRanges=a;const d=a[l];this.detectEvictedFragments(l,d,u,s)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=Fr(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let s=i.length;s--;){const a=e[i[s]];if(a?.body.type===t)return!0}return!1}hasParts(t){var e;return!!((e=this.activePartLists[t])!=null&&e.length)}removeFragmentsInRange(t,e,i,s,a){s&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u)return;const d=u.body;d.type!==i||s&&!d.gap||d.start<e&&d.end>t&&(u.buffered||a)&&this.removeFragment(d)})}removeFragment(t){const e=Fr(t);t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const s=t.sn;this.activePartLists[t.type]=jy(i,a=>a.fragment.sn!==s)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=(t=this.hls)==null||(t=t.latestLevelDetails)==null?void 0:t.partList;e&&e.forEach(i=>i.clearElementaryStreamInfo())}}function Nl(r){var t,e,i;return r.buffered&&!!(r.body.gap||(t=r.range.video)!=null&&t.partial||(e=r.range.audio)!=null&&e.partial||(i=r.range.audiovideo)!=null&&i.partial)}function Fr(r){return`${r.type}_${r.level}_${r.sn}`}function jy(r,t){return r.filter(e=>{const i=t(e);return i||e.clearElementaryStreamInfo(),i})}var gs={cbc:0,ctr:1};class J_{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case gs.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case gs.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function tC(r){const t=r.byteLength,e=t&&new DataView(r.buffer).getUint8(t-1);return e?r.slice(0,t-e):r}class eC{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let s=0;s<4;s++)i[s]=e.getUint32(s*4);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,s=i[0],a=i[1],l=i[2],u=i[3],d=this.invSubMix,f=d[0],h=d[1],p=d[2],g=d[3],v=new Uint32Array(256);let y=0,S=0,T=0;for(T=0;T<256;T++)T<128?v[T]=T<<1:v[T]=T<<1^283;for(T=0;T<256;T++){let A=S^S<<1^S<<2^S<<3^S<<4;A=A>>>8^A&255^99,t[y]=A,e[A]=y;const b=v[y],R=v[b],C=v[R];let D=v[A]*257^A*16843008;s[y]=D<<24|D>>>8,a[y]=D<<16|D>>>16,l[y]=D<<8|D>>>24,u[y]=D,D=C*16843009^R*65537^b*257^y*16843008,f[A]=D<<24|D>>>8,h[A]=D<<16|D>>>16,p[A]=D<<8|D>>>24,g[A]=D,y?(y=b^v[v[v[C^b]]],S^=v[v[S]]):y=S=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,s=0;for(;s<e.length&&i;)i=e[s]===this.key[s],s++;if(i)return;this.key=e;const a=this.keySize=e.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const l=this.ksRows=(a+6+1)*4;let u,d;const f=this.keySchedule=new Uint32Array(l),h=this.invKeySchedule=new Uint32Array(l),p=this.sBox,g=this.rcon,v=this.invSubMix,y=v[0],S=v[1],T=v[2],A=v[3];let b,R;for(u=0;u<l;u++){if(u<a){b=f[u]=e[u];continue}R=b,u%a===0?(R=R<<8|R>>>24,R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255],R^=g[u/a|0]<<24):a>6&&u%a===4&&(R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255]),f[u]=b=(f[u-a]^R)>>>0}for(d=0;d<l;d++)u=l-d,d&3?R=f[u]:R=f[u-4],d<4||u<=4?h[d]=R:h[d]=y[p[R>>>24]]^S[p[R>>>16&255]]^T[p[R>>>8&255]]^A[p[R&255]],h[d]=h[d]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,e,i){const s=this.keySize+6,a=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,d=u[0],f=u[1],h=u[2],p=u[3],g=this.uint8ArrayToUint32Array_(i);let v=g[0],y=g[1],S=g[2],T=g[3];const A=new Int32Array(t),b=new Int32Array(A.length);let R,C,D,N,w,P,B,M,q,tt,V,H,X,O;const G=this.networkToHostOrderSwap;for(;e<A.length;){for(q=G(A[e]),tt=G(A[e+1]),V=G(A[e+2]),H=G(A[e+3]),w=q^a[0],P=H^a[1],B=V^a[2],M=tt^a[3],X=4,O=1;O<s;O++)R=d[w>>>24]^f[P>>16&255]^h[B>>8&255]^p[M&255]^a[X],C=d[P>>>24]^f[B>>16&255]^h[M>>8&255]^p[w&255]^a[X+1],D=d[B>>>24]^f[M>>16&255]^h[w>>8&255]^p[P&255]^a[X+2],N=d[M>>>24]^f[w>>16&255]^h[P>>8&255]^p[B&255]^a[X+3],w=R,P=C,B=D,M=N,X=X+4;R=l[w>>>24]<<24^l[P>>16&255]<<16^l[B>>8&255]<<8^l[M&255]^a[X],C=l[P>>>24]<<24^l[B>>16&255]<<16^l[M>>8&255]<<8^l[w&255]^a[X+1],D=l[B>>>24]<<24^l[M>>16&255]<<16^l[w>>8&255]<<8^l[P&255]^a[X+2],N=l[M>>>24]<<24^l[w>>16&255]<<16^l[P>>8&255]<<8^l[B&255]^a[X+3],b[e]=G(R^v),b[e+1]=G(N^y),b[e+2]=G(D^S),b[e+3]=G(C^T),v=q,y=tt,S=V,T=H,e=e+4}return b.buffer}}class iC{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){const t=nC(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}function nC(r){switch(r){case gs.cbc:return"AES-CBC";case gs.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${r}`)}}const sC=16;class Mh{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?tC(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,s){return this.useSoftware?new Promise((a,l)=>{const u=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(u,e,i,s);const d=this.flush();d?a(d.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,s)}softwareDecrypt(t,e,i,s){const{currentIV:a,currentResult:l,remainderData:u}=this;if(s!==gs.cbc||e.byteLength!==16)return Kt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(t=Ii(u,t),this.remainderData=null);const d=this.getValidChunk(t);if(!d.length)return null;a&&(i=a);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new eC),f.expandKey(e);const h=l;return this.currentResult=f.decrypt(d.buffer,0,i),this.currentIV=d.slice(-16).buffer,h||null}webCryptoDecrypt(t,e,i,s){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,s));this.key=e,this.fastAesKey=new iC(this.subtle,e,s)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new J_(this.subtle,new Uint8Array(i),s).decrypt(t.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Kt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(t,e,i,s)))}onWebCryptoError(t,e,i,s){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,s);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%sC;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){this.logEnabled&&(Kt.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const Gy=Math.pow(2,17);class rC{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new In({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,a=s.fLoader,l=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(y=>y[0]==="GAP")){d(zy(t));return}else t.gap=!1;const f=this.loader=a?new a(s):new l(s),h=Hy(t);t.loader=f;const p=$y(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:Gy};t.stats=f.stats;const v={onSuccess:(y,S,T,A)=>{this.resetLoader(t,f);let b=y.data;T.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(b.slice(0,16)),b=b.slice(16)),u({frag:t,part:null,payload:b,networkDetails:A})},onError:(y,S,T,A)=>{this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:Vt({url:i,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:T,stats:A}))},onAbort:(y,S,T)=>{this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:T,stats:y}))},onTimeout:(y,S,T)=>{this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:T,stats:y}))}};e&&(v.onProgress=(y,S,T,A)=>e({frag:t,part:null,payload:T,networkDetails:A})),f.load(h,g,v)})}loadPart(t,e,i){this.abort();const s=this.config,a=s.fLoader,l=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap){d(zy(t,e));return}const f=this.loader=a?new a(s):new l(s),h=Hy(t,e);t.loader=f;const p=$y(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Gy};e.stats=f.stats,f.load(h,g,{onSuccess:(v,y,S,T)=>{this.resetLoader(t,f),this.updateStatsFromPart(t,e);const A={frag:t,part:e,payload:v.data,networkDetails:T};i(A),u(A)},onError:(v,y,S,T)=>{this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:Vt({url:h.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:S,stats:T}))},onAbort:(v,y,S)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:S,stats:v}))},onTimeout:(v,y,S)=>{this.resetLoader(t,f),d(new In({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:S,stats:v}))}})})}updateStatsFromPart(t,e){const i=t.stats,s=e.stats,a=s.total;if(i.loaded+=s.loaded,a){const d=Math.round(t.duration/e.duration),f=Math.min(Math.round(i.loaded/a),d),p=(d-f)*Math.round(i.loaded/f);i.total=i.loaded+p}else i.total=Math.max(i.loaded,i.total);const l=i.loading,u=s.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function Hy(r,t=null){const e=t||r,i={frag:r,part:t,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},s=e.byteRangeStartOffset,a=e.byteRangeEndOffset;if(ht(s)&&ht(a)){var l;let u=s,d=a;if(r.sn==="initSegment"&&aC((l=r.decryptdata)==null?void 0:l.method)){const f=a-s;f%16&&(d=a+(16-f%16)),s!==0&&(i.resetIV=!0,u=s-16)}i.rangeStart=u,i.rangeEnd=d}return i}function zy(r,t){const e=new Error(`GAP ${r.gap?"tag":"attribute"} found`),i={type:vt.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:r,error:e,networkDetails:null};return t&&(i.part=t),(t||r).stats.aborted=!0,new In(i)}function aC(r){return r==="AES-128"||r==="AES-256"}class In extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class dx extends Oi{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Ph{constructor(t,e,i,s=0,a=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Fl(),this.buffering={audio:Fl(),video:Fl(),audiovideo:Fl()},this.level=t,this.sn=e,this.id=i,this.size=s,this.part=a,this.partial=l}}function Fl(){return{start:0,executeStart:0,executeEnd:0,end:0}}const Vy={length:0,start:()=>0,end:()=>0};class At{static isBuffered(t,e){if(t){const i=At.getBuffered(t);for(let s=i.length;s--;)if(e>=i.start(s)&&e<=i.end(s))return!0}return!1}static bufferedRanges(t){if(t){const e=At.getBuffered(t);return At.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){const s=At.bufferedRanges(t);if(s.length)return At.bufferedInfo(s,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort((h,p)=>h.start-p.start||p.end-h.end);let s=-1,a=[];if(i)for(let h=0;h<t.length;h++){e>=t[h].start&&e<=t[h].end&&(s=h);const p=a.length;if(p){const g=a[p-1].end;t[h].start-g<i?t[h].end>g&&(a[p-1].end=t[h].end):a.push(t[h])}else a.push(t[h])}else a=t;let l=0,u,d=e,f=e;for(let h=0;h<a.length;h++){const p=a[h].start,g=a[h].end;if(s===-1&&e>=p&&e<=g&&(s=h),e+i>=p&&e<g)d=p,f=g,l=f-e;else if(e+i<p){u=p;break}}return{len:l,start:d||0,end:f||0,nextStart:u,buffered:t,bufferedIndex:s}}static getBuffered(t){try{return t.buffered||Vy}catch(e){return Kt.log("failed to get media.buffered",e),Vy}}}const hx=/\{\$([a-zA-Z0-9-_]+)\}/g;function Ky(r){return hx.test(r)}function Xd(r,t){if(r.variableList!==null||r.hasVariableRefs){const e=r.variableList;return t.replace(hx,i=>{const s=i.substring(2,i.length-1),a=e?.[s];return a===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),i):a})}return t}function qy(r,t,e){let i=r.variableList;i||(r.variableList=i={});let s,a;if("QUERYPARAM"in t){s=t.QUERYPARAM;try{const l=new self.URL(e).searchParams;if(l.has(s))a=l.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${e}"`)}catch(l){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else s=t.NAME,a=t.VALUE;s in i?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):i[s]=a||""}function oC(r,t,e){const i=t.IMPORT;if(e&&i in e){let s=r.variableList;s||(r.variableList=s={}),s[i]=e[i]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const lC=/^(\d+)x(\d+)$/,Yy=/(.+?)=(".*?"|.*?)(?:,|$)/g;class re{constructor(t,e){typeof t=="string"&&(t=re.parseAttrList(t,e)),Wt(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(e.length&1?"0":"")+e;const i=new Uint8Array(e.length/2);for(let s=0;s<e.length/2;s++)i[s]=parseInt(e.slice(s*2,s*2+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const i=this[t];return(i?i.split(/[ ,]+/):[]).reduce((s,a)=>(s[a.toLowerCase()]=!0,s),e)}bool(t){return this[t]==="YES"}decimalResolution(t){const e=lC.exec(this[t]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i;const s={};for(Yy.lastIndex=0;(i=Yy.exec(t))!==null;){const l=i[1].trim();let u=i[2];const d=u.indexOf('"')===0&&u.lastIndexOf('"')===u.length-1;let f=!1;if(d)u=u.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":f=!0}if(e&&(d||f))u=Xd(e,u);else if(!f&&!d)switch(l){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Kt.warn(`${t}: attribute ${l} is missing quotes`)}s[l]=u}return s}}const uC="com.apple.hls.interstitial";function cC(r){return r!=="ID"&&r!=="CLASS"&&r!=="CUE"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function fC(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"||r==="SCTE35-CMD"}class mx{constructor(t,e,i=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=e?.tagAnchor||null,this.tagOrder=(s=e?.tagOrder)!=null?s:i,e){const a=e.attr;for(const l in a)if(Object.prototype.hasOwnProperty.call(t,l)&&t[l]!==a[l]){Kt.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=l;break}t=Wt(new re({}),a,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=e?.endDate||new Date(this.attr["END-DATE"]);ht(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return t===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return t===null||t.programDateTime===null?(Kt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return e!==null?this._dateAtEnd=new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(ht(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===uC}get isValid(){return!!this.id&&!this._badValueForSameId&&ht(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const dC=10;class hC{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||e===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1}hasKey(t){return this.encryptedFragments.some(e=>{let i=e.decryptdata;return i||(e.setKeyFormat(t.keyFormat),i=e.decryptdata),!!i&&t.matches(i)})}get hasProgramDateTime(){return this.fragments.length?ht(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||dC}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(e!==-1){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function xu(r,t){return r.length===t.length?!r.some((e,i)=>e!==t[i]):!1}function Xy(r,t){return!r&&!t?!0:!r||!t?!1:xu(r,t)}function zr(r){return r==="AES-128"||r==="AES-256"||r==="AES-256-CTR"}function Nh(r){switch(r){case"AES-128":case"AES-256":return gs.cbc;case"AES-256-CTR":return gs.ctr;default:throw new Error(`invalid full segment method ${r}`)}}function Fh(r){return Uint8Array.from(atob(r),t=>t.charCodeAt(0))}function Wd(r){return Uint8Array.from(unescape(encodeURIComponent(r)),t=>t.charCodeAt(0))}function mC(r){const t=Wd(r).subarray(0,16),e=new Uint8Array(16);return e.set(t,16-t.length),e}function px(r){const t=function(i,s,a){const l=i[s];i[s]=i[a],i[a]=l};t(r,0,3),t(r,1,2),t(r,4,5),t(r,6,7)}function gx(r){const t=r.split(":");let e=null;if(t[0]==="data"&&t.length===2){const i=t[1].split(";"),s=i[i.length-1].split(",");if(s.length===2){const a=s[0]==="base64",l=s[1];a?(i.splice(-1,1),e=Fh(l)):e=mC(l)}}return e}const Su=typeof self<"u"?self:void 0;var ae={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},$e={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function eu(r){switch(r){case $e.FAIRPLAY:return ae.FAIRPLAY;case $e.PLAYREADY:return ae.PLAYREADY;case $e.WIDEVINE:return ae.WIDEVINE;case $e.CLEARKEY:return ae.CLEARKEY}}function yd(r){switch(r){case ae.FAIRPLAY:return $e.FAIRPLAY;case ae.PLAYREADY:return $e.PLAYREADY;case ae.WIDEVINE:return $e.WIDEVINE;case ae.CLEARKEY:return $e.CLEARKEY}}function Wa(r){const{drmSystems:t,widevineLicenseUrl:e}=r,i=t?[ae.FAIRPLAY,ae.WIDEVINE,ae.PLAYREADY,ae.CLEARKEY].filter(s=>!!t[s]):[];return!i[ae.WIDEVINE]&&e&&i.push(ae.WIDEVINE),i}const yx=(function(r){return Su!=null&&(r=Su.navigator)!=null&&r.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function pC(r,t,e,i){let s;switch(r){case ae.FAIRPLAY:s=["cenc","sinf"];break;case ae.WIDEVINE:case ae.PLAYREADY:s=["cenc"];break;case ae.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return gC(s,t,e,i)}function gC(r,t,e,i){return[{initDataTypes:r,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:e.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function yC(r){var t;return!!r&&(r.sessionType==="persistent-license"||!!((t=r.sessionTypes)!=null&&t.some(e=>e==="persistent-license")))}function vx(r){const t=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),e=String.fromCharCode.apply(null,Array.from(t)),i=e.substring(e.indexOf("<"),e.length),l=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(l){const u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){const d=Fh(u).subarray(0,16);return px(d),d}}return null}let Bl={};class zs{static clearKeyUriToKeyIdMap(){Bl={}}static setKeyIdForUri(t,e){Bl[t]=e}constructor(t,e,i,s=[1],a=null,l){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=s,this.iv=a,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!zr(t),l!=null&&l.startsWith("0x")&&(this.keyId=new Uint8Array(KE(l)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&xu(t.keyFormatVersions,this.keyFormatVersions)&&Xy(t.iv,this.iv)&&Xy(t.keyId,this.keyId)}isSupported(){if(this.method){if(zr(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case $e.FAIRPLAY:case $e.WIDEVINE:case $e.PLAYREADY:case $e.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t,e){if(!this.encrypted||!this.uri)return null;if(zr(this.method)){let a=this.iv;return a||(typeof t!="number"&&(Kt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0),a=EC(t)),new zs(this.method,this.uri,"identity",this.keyFormatVersions,a)}if(this.keyId){const a=Bl[this.uri];if(a&&!xu(this.keyId,a)&&zs.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=gx(this.uri);if(i)switch(this.keyFormat){case $e.WIDEVINE:if(this.pssh=i,!this.keyId){const a=T_(i.buffer);if(a.length){var s;const l=a[0];this.keyId=(s=l.kids)!=null&&s.length?l.kids[0]:null}}this.keyId||(this.keyId=Wy(e));break;case $e.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=S_(a,null,i),this.keyId=vx(i);break}default:{let a=i.subarray(0,16);if(a.length!==16){const l=new Uint8Array(16);l.set(a,16-a.length),a=l}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a;a=vC(e),a||(a=Wy(e),a||(a=Bl[this.uri])),a&&(this.keyId=a,zs.setKeyIdForUri(this.uri,a))}return this}}function vC(r){const t=r?.[$e.WIDEVINE];return t?t.keyId:null}function Wy(r){const t=r?.[$e.PLAYREADY];if(t){const e=gx(t.uri);if(e)return vx(e)}return null}function EC(r){const t=new Uint8Array(16);for(let e=12;e<16;e++)t[e]=r>>8*(15-e)&255;return t}const Qy=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Zy=/#EXT-X-MEDIA:(.*)/g,xC=/^#EXT(?:INF|-X-TARGETDURATION):/m,vd=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),SC=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Ji{static findGroup(t,e){for(let i=0;i<t.length;i++){const s=t[i];if(s.id===e)return s}}static resolve(t,e){return Ch.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return xC.test(t)}static parseMasterPlaylist(t,e){const i=Ky(t),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},a=[];if(Qy.lastIndex=0,!t.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let l;for(;(l=Qy.exec(t))!=null;)if(l[1]){var u;const f=new re(l[1],s),h=Xd(s,l[2]),p={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:Ji.resolve(h,e)},g=f.decimalResolution("RESOLUTION");g&&(p.width=g.width,p.height=g.height),ev(f.CODECS,p);const v=f["SUPPLEMENTAL-CODECS"];v&&(p.supplemental={},ev(v,p.supplemental)),(u=p.unknownCodecs)!=null&&u.length||a.push(p),s.levels.push(p)}else if(l[3]){const f=l[3],h=l[4];switch(f){case"SESSION-DATA":{const p=new re(h,s),g=p["DATA-ID"];g&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[g]=p);break}case"SESSION-KEY":{const p=Jy(h,e,s);p.encrypted&&p.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(p)):Kt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const p=new re(h,s);qy(s,p,e)}break}case"CONTENT-STEERING":{const p=new re(h,s);s.contentSteering={uri:Ji.resolve(p["SERVER-URI"],e),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=tv(h);break}}}const d=a.length>0&&a.length<s.levels.length;return s.levels=d?a:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(t,e,i){let s;const a={},l=i.levels,u={AUDIO:l.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:l.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(Zy.lastIndex=0;(s=Zy.exec(t))!==null;){const f=new re(s[1],i),h=f.TYPE;if(h){const p=u[h],g=a[h]||[];a[h]=g;const v=f.LANGUAGE,y=f["ASSOC-LANGUAGE"],S=f.CHANNELS,T=f.CHARACTERISTICS,A=f["INSTREAM-ID"],b={attrs:f,bitrate:0,id:d++,groupId:f["GROUP-ID"]||"",name:f.NAME||v||"",type:h,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:v,url:f.URI?Ji.resolve(f.URI,e):""};if(y&&(b.assocLang=y),S&&(b.channels=S),T&&(b.characteristics=T),A&&(b.instreamId=A),p!=null&&p.length){const R=Ji.findGroup(p,b.groupId)||p[0];iv(b,R,"audioCodec"),iv(b,R,"textCodec")}g.push(b)}}return a}static parseLevelPlaylist(t,e,i,s,a,l){var u;const d={url:e},f=new hC(e),h=f.fragments,p=[];let g=null,v=0,y=0,S=0,T=0,A=0,b=null,R=new md(s,d),C,D,N,w=-1,P=!1,B=null,M;if(vd.lastIndex=0,f.m3u8=t,f.hasVariableRefs=Ky(t),((u=vd.exec(t))==null?void 0:u[0])!=="#EXTM3U")return f.playlistParsingError=new Error("Missing format identifier #EXTM3U"),f;for(;(C=vd.exec(t))!==null;){P&&(P=!1,R=new md(s,d),R.playlistOffset=S,R.setStart(S),R.sn=v,R.cc=T,A&&(R.bitrate=A),R.level=i,g&&(R.initSegment=g,g.rawProgramDateTime&&(R.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),B&&(R.setByteRange(B),B=null)));const H=C[1];if(H){R.duration=parseFloat(H);const X=(" "+C[2]).slice(1);R.title=X||null,R.tagList.push(X?["INF",H,X]:["INF",H])}else if(C[3]){if(ht(R.duration)){R.playlistOffset=S,R.setStart(S),N&&sv(R,N,f),R.sn=v,R.level=i,R.cc=T,h.push(R);const X=(" "+C[3]).slice(1);R.relurl=Xd(f,X),Qd(R,b,p),b=R,S+=R.duration,v++,y=0,P=!0}}else{if(C=C[0].match(SC),!C){Kt.warn("No matches on slow regex match for level playlist!");continue}for(D=1;D<C.length&&C[D]===void 0;D++);const X=(" "+C[D]).slice(1),O=(" "+C[D+1]).slice(1),G=C[D+2]?(" "+C[D+2]).slice(1):null;switch(X){case"BYTERANGE":b?R.setByteRange(O,b):R.setByteRange(O);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=O,R.tagList.push(["PROGRAM-DATE-TIME",O]),w===-1&&(w=h.length);break;case"PLAYLIST-TYPE":f.type&&wn(f,X,C),f.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":f.startSN!==0?wn(f,X,C):h.length>0&&rv(f,X,C),v=f.startSN=parseInt(O);break;case"SKIP":{f.skippedSegments&&wn(f,X,C);const K=new re(O,f),nt=K.decimalInteger("SKIPPED-SEGMENTS");if(ht(nt)){f.skippedSegments+=nt;for(let k=nt;k--;)h.push(null);v+=nt}const ut=K.enumeratedString("RECENTLY-REMOVED-DATERANGES");ut&&(f.recentlyRemovedDateranges=(f.recentlyRemovedDateranges||[]).concat(ut.split("	")));break}case"TARGETDURATION":f.targetduration!==0&&wn(f,X,C),f.targetduration=Math.max(parseInt(O),1);break;case"VERSION":f.version!==null&&wn(f,X,C),f.version=parseInt(O);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":f.live||wn(f,X,C),f.live=!1;break;case"#":(O||G)&&R.tagList.push(G?[O,G]:[O]);break;case"DISCONTINUITY":T++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([X]);break;case"BITRATE":R.tagList.push([X,O]),A=parseInt(O)*1e3,ht(A)?R.bitrate=A:A=0;break;case"DATERANGE":{const K=new re(O,f),nt=new mx(K,f.dateRanges[K.ID],f.dateRangeTagCount);f.dateRangeTagCount++,nt.isValid||f.skippedSegments?f.dateRanges[nt.id]=nt:Kt.warn(`Ignoring invalid DATERANGE tag: "${O}"`),R.tagList.push(["EXT-X-DATERANGE",O]);break}case"DEFINE":{{const K=new re(O,f);"IMPORT"in K?oC(f,K,l):qy(f,K,e)}break}case"DISCONTINUITY-SEQUENCE":f.startCC!==0?wn(f,X,C):h.length>0&&rv(f,X,C),f.startCC=T=parseInt(O);break;case"KEY":{const K=Jy(O,e,f);if(K.isSupported()){if(K.method==="NONE"){N=void 0;break}N||(N={});const nt=N[K.keyFormat];nt!=null&&nt.matches(K)||(nt&&(N=Wt({},N)),N[K.keyFormat]=K)}else Kt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${O}"`);break}case"START":f.startTimeOffset=tv(O);break;case"MAP":{const K=new re(O,f);if(R.duration){const nt=new md(s,d);nv(nt,K,i,N),g=nt,R.initSegment=g,g.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=g.rawProgramDateTime)}else{const nt=R.byteRangeEndOffset;if(nt){const ut=R.byteRangeStartOffset;B=`${nt-ut}@${ut}`}else B=null;nv(R,K,i,N),g=R,P=!0}g.cc=T;break}case"SERVER-CONTROL":{M&&wn(f,X,C),M=new re(O),f.canBlockReload=M.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=M.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&M.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=M.optionalFloat("PART-HOLD-BACK",0),f.holdBack=M.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{f.partTarget&&wn(f,X,C);const K=new re(O);f.partTarget=K.decimalFloatingPoint("PART-TARGET");break}case"PART":{let K=f.partList;K||(K=f.partList=[]);const nt=y>0?K[K.length-1]:void 0,ut=y++,k=new re(O,f),j=new o_(k,R,d,ut,nt);K.push(j),R.duration+=j.duration;break}case"PRELOAD-HINT":{const K=new re(O,f);f.preloadHint=K;break}case"RENDITION-REPORT":{const K=new re(O,f);f.renditionReports=f.renditionReports||[],f.renditionReports.push(K);break}default:Kt.warn(`line parsed but not handled: ${C}`);break}}}b&&!b.relurl?(h.pop(),S-=b.duration,f.partList&&(f.fragmentHint=b)):f.partList&&(Qd(R,b,p),R.cc=T,f.fragmentHint=R,N&&sv(R,N,f)),f.targetduration||(f.playlistParsingError=new Error("Missing Target Duration"));const q=h.length,tt=h[0],V=h[q-1];if(S+=f.skippedSegments*f.targetduration,S>0&&q&&V){f.averagetargetduration=S/q;const H=V.sn;f.endSN=H!=="initSegment"?H:0,f.live||(V.endList=!0),w>0&&(bC(h,w),tt&&p.unshift(tt))}return f.fragmentHint&&(S+=f.fragmentHint.duration),f.totalduration=S,p.length&&f.dateRangeTagCount&&tt&&Ex(p,f),f.endCC=T,f}}function Ex(r,t){let e=r.length;if(!e)if(t.hasProgramDateTime){const u=t.fragments[t.fragments.length-1];r.push(u),e++}else return;const i=r[e-1],s=t.live?1/0:t.totalduration,a=Object.keys(t.dateRanges);for(let u=a.length;u--;){const d=t.dateRanges[a[u]],f=d.startDate.getTime();d.tagAnchor=i.ref;for(let h=e;h--;){var l;if(((l=r[h])==null?void 0:l.sn)<t.startSN)break;const p=TC(t,f,r,h,s);if(p!==-1){d.tagAnchor=t.fragments[p].ref;break}}}}function TC(r,t,e,i,s){const a=e[i];if(a){const u=a.programDateTime;if(t>=u||i===0){var l;const d=(((l=e[i+1])==null?void 0:l.start)||s)-a.start;if(t<=u+d*1e3){const f=e[i].sn-r.startSN;if(f<0)return-1;const h=r.fragments;if(h.length>e.length){const g=(e[i+1]||h[h.length-1]).sn-r.startSN;for(let v=g;v>f;v--){const y=h[v].programDateTime;if(t>=y&&t<y+h[v].duration*1e3)return v}}return f}}}return-1}function Jy(r,t,e){var i,s;const a=new re(r,e),l=(i=a.METHOD)!=null?i:"",u=a.URI,d=a.hexadecimalInteger("IV"),f=a.KEYFORMATVERSIONS,h=(s=a.KEYFORMAT)!=null?s:"identity";u&&a.IV&&!d&&Kt.error(`Invalid IV: ${a.IV}`);const p=u?Ji.resolve(u,t):"",g=(f||"1").split("/").map(Number).filter(Number.isFinite);return new zs(l,p,h,g,d,a.KEYID)}function tv(r){const e=new re(r).decimalFloatingPoint("TIME-OFFSET");return ht(e)?e:null}function ev(r,t){let e=(r||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const s=e.filter(a=>Ih(a,i));s.length&&(t[`${i}Codec`]=s.map(a=>a.split("/")[0]).join(","),e=e.filter(a=>s.indexOf(a)===-1))}),t.unknownCodecs=e}function iv(r,t,e){const i=t[e];i&&(r[e]=i)}function bC(r,t){let e=r[t];for(let i=t;i--;){const s=r[i];if(!s)return;s.programDateTime=e.programDateTime-s.duration*1e3,e=s}}function Qd(r,t,e){r.rawProgramDateTime?e.push(r):t!=null&&t.programDateTime&&(r.programDateTime=t.endProgramDateTime)}function nv(r,t,e,i){r.relurl=t.URI,t.BYTERANGE&&r.setByteRange(t.BYTERANGE),r.level=e,r.sn="initSegment",i&&(r.levelkeys=i),r.initSegment=null}function sv(r,t,e){r.levelkeys=t;const{encryptedFragments:i}=e;(!i.length||i[i.length-1].levelkeys!==t)&&Object.keys(t).some(s=>t[s].isCommonEncryption)&&i.push(r)}function wn(r,t,e){r.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${e[0]})`)}function rv(r,t,e){r.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${e[0]})`)}function Ed(r,t){const e=t.startPTS;if(ht(e)){let i=0,s;t.sn>r.sn?(i=e-r.start,s=r):(i=r.start-e,s=t),s.duration!==i&&s.setDuration(i)}else t.sn>r.sn?r.cc===t.cc&&r.minEndPTS?t.setStart(r.start+(r.minEndPTS-r.start)):t.setStart(r.start+r.duration):t.setStart(Math.max(r.start-t.duration,0))}function xx(r,t,e,i,s,a,l){i-e<=0&&(l.warn("Fragment should have a positive duration",t),i=e+t.duration,a=s+t.duration);let d=e,f=i;const h=t.startPTS,p=t.endPTS;if(ht(h)){const A=Math.abs(h-e);r&&A>r.totalduration?l.warn(`media timestamps and playlist times differ by ${A}s for level ${t.level} ${r.url}`):ht(t.deltaPTS)?t.deltaPTS=Math.max(A,t.deltaPTS):t.deltaPTS=A,d=Math.max(e,h),e=Math.min(e,h),s=t.startDTS!==void 0?Math.min(s,t.startDTS):s,f=Math.min(i,p),i=Math.max(i,p),a=t.endDTS!==void 0?Math.max(a,t.endDTS):a}const g=e-t.start;t.start!==0&&t.setStart(e),t.setDuration(i-t.start),t.startPTS=e,t.maxStartPTS=d,t.startDTS=s,t.endPTS=i,t.minEndPTS=f,t.endDTS=a;const v=t.sn;if(!r||v<r.startSN||v>r.endSN)return 0;let y;const S=v-r.startSN,T=r.fragments;for(T[S]=t,y=S;y>0;y--)Ed(T[y],T[y-1]);for(y=S;y<T.length-1;y++)Ed(T[y],T[y+1]);return r.fragmentHint&&Ed(T[T.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,g}function AC(r,t,e){if(r===t)return;let i=null;const s=r.fragments;for(let h=s.length-1;h>=0;h--){const p=s[h].initSegment;if(p){i=p;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let a;_C(r,t,(h,p,g,v)=>{if((!t.startCC||t.skippedSegments)&&p.cc!==h.cc){const y=h.cc-p.cc;for(let S=g;S<v.length;S++)v[S].cc+=y;t.endCC=v[v.length-1].cc}ht(h.startPTS)&&ht(h.endPTS)&&(p.setStart(p.startPTS=h.startPTS),p.startDTS=h.startDTS,p.maxStartPTS=h.maxStartPTS,p.endPTS=h.endPTS,p.endDTS=h.endDTS,p.minEndPTS=h.minEndPTS,p.setDuration(h.endPTS-h.startPTS),p.duration&&(a=p),t.PTSKnown=t.alignedSliding=!0),h.hasStreams&&(p.elementaryStreams=h.elementaryStreams),p.loader=h.loader,h.hasStats&&(p.stats=h.stats),h.initSegment&&(p.initSegment=h.initSegment,i=h.initSegment)});const l=t.fragments,u=t.fragmentHint?l.concat(t.fragmentHint):l;if(i&&u.forEach(h=>{var p;h&&(!h.initSegment||h.initSegment.relurl===((p=i)==null?void 0:p.relurl))&&(h.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=l.some(h=>!h),t.deltaUpdateFailed){e.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=t.skippedSegments;h--;)l.shift();t.startSN=l[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=RC(r.dateRanges,t,e));const h=r.fragments.filter(p=>p.rawProgramDateTime);if(r.hasProgramDateTime&&!t.hasProgramDateTime)for(let p=1;p<u.length;p++)u[p].programDateTime===null&&Qd(u[p],u[p-1],h);Ex(h,t)}t.endCC=l[l.length-1].cc}if(!t.startCC){var d;const h=bx(r,t.startSN-1);t.startCC=(d=h?.cc)!=null?d:l[0].cc}LC(r.partList,t.partList,(h,p)=>{p.elementaryStreams=h.elementaryStreams,p.stats=h.stats}),a?xx(t,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS,e):Sx(r,t),l.length&&(t.totalduration=t.edge-l[0].start),t.driftStartTime=r.driftStartTime,t.driftStart=r.driftStart;const f=t.advancedDateTime;if(t.advanced&&f){const h=t.edge;t.driftStart||(t.driftStartTime=f,t.driftStart=h),t.driftEndTime=f,t.driftEnd=h}else t.driftEndTime=r.driftEndTime,t.driftEnd=r.driftEnd,t.advancedDateTime=r.advancedDateTime;t.requestScheduled===-1&&(t.requestScheduled=r.requestScheduled)}function RC(r,t,e){const{dateRanges:i,recentlyRemovedDateranges:s}=t,a=Wt({},r);s&&s.forEach(d=>{delete a[d]});const u=Object.keys(a).length;return u?(Object.keys(i).forEach(d=>{const f=a[d],h=new mx(i[d].attr,f);h.isValid?(a[d]=h,f||(h.tagOrder+=u)):e.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Jt(i[d].attr)}"`)}),a):i}function LC(r,t,e){if(r&&t){let i=0;for(let s=0,a=r.length;s<=a;s++){const l=r[s],u=t[s+i];l&&u&&l.index===u.index&&l.fragment.sn===u.fragment.sn?e(l,u):i--}}}function _C(r,t,e){const i=t.skippedSegments,s=Math.max(r.startSN,t.startSN)-t.startSN,a=(r.fragmentHint?1:0)+(i?t.endSN:Math.min(r.endSN,t.endSN))-t.startSN,l=t.startSN-r.startSN,u=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,d=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let f=s;f<=a;f++){const h=d[l+f];let p=u[f];if(i&&!p&&h&&(p=t.fragments[f]=h),h&&p){e(h,p,f,u);const g=h.relurl,v=p.relurl;if(g&&CC(g,v)){t.playlistParsingError=av(`media sequence mismatch ${p.sn}:`,r,t,h,p);return}else if(h.cc!==p.cc){t.playlistParsingError=av(`discontinuity sequence mismatch (${h.cc}!=${p.cc})`,r,t,h,p);return}}}}function av(r,t,e,i,s){return new Error(`${r} ${s.url}
Playlist starting @${t.startSN}
${t.m3u8}

Playlist starting @${e.startSN}
${e.m3u8}`)}function Sx(r,t,e=!0){const i=t.startSN+t.skippedSegments-r.startSN,s=r.fragments,a=i>=0;let l=0;if(a&&i<s.length)l=s[i].start;else if(a&&t.startSN===r.endSN+1)l=r.fragmentEnd;else if(a&&e)l=r.fragmentStart+i*t.levelTargetDuration;else if(!t.skippedSegments&&t.fragmentStart===0)l=r.fragmentStart;else return;Zd(t,l)}function Zd(r,t){if(t){const e=r.fragments;for(let i=r.skippedSegments;i<e.length;i++)e[i].addStart(t);r.fragmentHint&&r.fragmentHint.addStart(t)}}function Tx(r,t=1/0){let e=1e3*r.targetduration;if(r.updated){const i=r.fragments;if(i.length&&e*4>t){const a=i[i.length-1].duration*1e3;a<e&&(e=a)}}else e/=2;return Math.round(e)}function bx(r,t,e){if(!r)return null;let i=r.fragments[t-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===t)?i:t<r.startSN&&e&&e.sn===t?e:null}function ov(r,t,e){return r?Ax(r.partList,t,e):null}function Ax(r,t,e){if(r)for(let i=r.length;i--;){const s=r[i];if(s.index===e&&s.fragment.sn===t)return s}return null}function Rx(r){r.forEach((t,e)=>{var i;(i=t.details)==null||i.fragments.forEach(s=>{s.level=e,s.initSegment&&(s.initSegment.level=e)})})}function CC(r,t){return r!==t&&t?lv(r)!==lv(t):!1}function lv(r){return r.replace(/\?[^?]*$/,"")}function Qa(r,t){for(let i=0,s=r.length;i<s;i++){var e;if(((e=r[i])==null?void 0:e.cc)===t)return r[i]}return null}function wC(r,t){return!!(r&&t.startCC<r.endCC&&t.endCC>r.startCC)}function uv(r,t){const e=r.start+t;r.startPTS=e,r.setStart(e),r.endPTS=e+r.duration}function Lx(r,t){const e=t.fragments;for(let i=0,s=e.length;i<s;i++)uv(e[i],r);t.fragmentHint&&uv(t.fragmentHint,r),t.alignedSliding=!0}function DC(r,t){r&&(_x(t,r),t.alignedSliding||Tu(t,r),!t.alignedSliding&&!t.skippedSegments&&Sx(r,t,!1))}function _x(r,t){if(!wC(t,r))return;const e=Math.min(t.endCC,r.endCC),i=Qa(t.fragments,e),s=Qa(r.fragments,e);if(!i||!s)return;Kt.log(`Aligning playlist at start of dicontinuity sequence ${e}`);const a=i.start-s.start;Lx(a,r)}function Tu(r,t){if(!r.hasProgramDateTime||!t.hasProgramDateTime)return;const e=r.fragments,i=t.fragments;if(!e.length||!i.length)return;let s,a;const l=Math.min(t.endCC,r.endCC);t.startCC<l&&r.startCC<l&&(s=Qa(i,l),a=Qa(e,l)),(!s||!a)&&(s=i[Math.floor(i.length/2)],a=Qa(e,s.cc)||e[Math.floor(e.length/2)]);const u=s.programDateTime,d=a.programDateTime;if(!u||!d)return;const f=(d-u)/1e3-(a.start-s.start);Lx(f,r)}function Ye(r,t,e){si(r,t,e),r.addEventListener(t,e)}function si(r,t,e){r.removeEventListener(t,e)}const IC={toString:function(r){let t="";const e=r.length;for(let i=0;i<e;i++)t+=`[${r.start(i).toFixed(3)}-${r.end(i).toFixed(3)}]`;return t}},at={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Bh extends dx{constructor(t,e,i,s,a){super(s,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=at.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:u,media:d,mediaBuffer:f,state:h}=this,p=d?d.currentTime:0,g=At.bufferInfo(f||d,p,l.maxBufferHole),v=!g.len;if(this.log(`Media seeking to ${ht(p)?p.toFixed(3):p}, state: ${h}, ${v?"out of":"in"} buffer`),this.state===at.ENDED)this.resetLoadingState();else if(u){const y=l.maxFragLookUpTolerance,S=u.start-y,T=u.start+u.duration+y;if(v||T<g.start||S>g.end){const A=p>T;(p<S||A)&&(A&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(p>y&&(this.lastCurrentTime=p),!this.loadingParts){const S=Math.max(g.end,p),T=this.shouldLoadParts(this.getLevelDetails(),S);T&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=T)}}this.hls.hasEnoughToStart||(this.log(`Setting ${v?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,v&&(this.startPosition=p)),v&&this.state===at.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=t,this.fragmentLoader=new rC(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Mh(t.config)}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===at.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=at.STOPPED}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return e===-1&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const i=t.end||0,s=this.config.timelineOffset||0;if(i<=s)return!1;const a=t.buffered;this.config.maxBufferHole&&a&&a.length>1&&(t=At.bufferedInfo(a,t.start,0));const l=t.nextStart;if(l&&l>s&&l<e.edge||this.media.currentTime<t.start)return!1;const d=e.partList;if(d!=null&&d.length){const h=d[d.length-1];return At.isBuffered(this.media,h.start+h.duration/2)}const f=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(f)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;if(t){var e;return((e=this.getLevelDetails())==null?void 0:e.appliedTimelineOffset)||t}return 0}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;Ye(i,"seeking",this.onMediaSeeking),Ye(i,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===at.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(t,e){const i=!!e.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),si(s,"seeking",this.onMediaSeeking),si(s,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=at.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){const s=a=>{const l=a.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(l,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(t,e,i,s).then(a=>{if(!a)return;const l=this.state,u=a.frag;if(this.fragContextChanged(u)){(l===at.FRAG_LOADING||!this.fragCurrent&&l===at.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=at.IDLE);return}"payload"in a&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(_.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(`Frag error: ${a?.message||a}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if(i.getState(t)===Le.APPENDING){const a=t.type,l=this.getFwdBufferInfo(this.mediaBuffer,a),u=Math.max(t.duration,l?l.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?t.sn-d.sn:0)===1||this.reduceMaxBufferLength(u,t.duration))&&i.removeFragment(t)}else((e=this.mediaBuffer)==null?void 0:e.buffered.length)===0?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===Le.PARTIAL&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return e?.live&&e.type!=="EVENT"&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,i=null){if(!(t-e))return;const s={startOffset:t,endOffset:e,type:i};this.hls.trigger(_.BUFFER_FLUSHING,s)}_loadInitSegment(t,e){this._doFragLoad(t,e).then(i=>{const s=i?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:s}=this,{frag:a,payload:l}=i,u=a.decryptdata;if(l&&l.byteLength>0&&u!=null&&u.key&&u.iv&&zr(u.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),u.key.buffer,u.iv.buffer,Nh(u.method)).catch(f=>{throw s.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:a}),f}).then(f=>{const h=self.performance.now();return s.trigger(_.FRAG_DECRYPTED,{frag:a,payload:f,stats:{tstart:d,tdecrypt:h}}),i.payload=f,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;this.state!==at.STOPPED&&(this.state=at.IDLE),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var i,s;const a=t.tracks;if(a&&!e.encrypted&&((i=a.audio)!=null&&i.encrypted||(s=a.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const l=this.media,u=new Error(`Encrypted track with no key in ${this.fragInfo(e)} (media ${l?"attached mediaKeys: "+l.mediaKeys:"detached"})`);return this.warn(u.message),!l||l.mediaKeys?!1:(this.hls.trigger(_.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,fatal:!1,error:u,frag:e}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?IC.toString(At.getBuffered(i)):"(detached)"})`),Te(t)){var s;if(t.type!==mt.SUBTITLE){const l=t.elementaryStreams;if(!Object.keys(l).some(u=>!!l[u])){this.state=at.IDLE;return}}const a=(s=this.levels)==null?void 0:s[t.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=at.IDLE}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:s,partsLoaded:a}=t,l=!a||a.length===0||a.some(d=>!d),u=new Ph(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!l);e.flush(u)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,s){var a;this.fragCurrent=t;const l=e.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let u=null;if(t.encrypted&&!((a=t.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${t.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=at.KEY_LOADING,this.fragCurrent=t,u=this.keyLoader.load(t).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(_.KEY_LOADED,g),this.state===at.KEY_LOADING&&(this.state=at.IDLE),g}),this.hls.trigger(_.KEY_LOADING,{frag:t}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else t.encrypted||(u=this.keyLoader.loadClear(t,l.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(Te(t)&&(!d||t.sn!==d.sn)){const g=this.shouldLoadParts(e.details,t.end);g!==this.loadingParts&&(this.log(`LL-Part loading ${g?"ON":"OFF"} loading sn ${d?.sn}->${t.sn}`),this.loadingParts=g)}if(i=Math.max(t.start,i||0),this.loadingParts&&Te(t)){const g=l.partList;if(g&&s){i>l.fragmentEnd&&l.fragmentHint&&(t=l.fragmentHint);const v=this.getNextPart(g,t,i);if(v>-1){const y=g[v];t=this.fragCurrent=y.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${y.index} (${v}/${g.length-1}) of ${this.fragInfo(t,!1,y)}) cc: ${t.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=at.FRAG_LOADING;let S;return u?S=u.then(T=>!T||this.fragContextChanged(T.frag)?null:this.doFragPartsLoad(t,y,e,s)).catch(T=>this.handleFragLoadError(T)):S=this.doFragPartsLoad(t,y,e,s).catch(T=>this.handleFragLoadError(T)),this.hls.trigger(_.FRAG_LOADING,{frag:t,part:y,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!t.url||this.loadedEndOfParts(g,i))return Promise.resolve(null)}}if(Te(t)&&this.loadingParts){var f;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${t.sn} loaded parts: ${(f=l.partList)==null?void 0:f.filter(g=>g.loaded).map(g=>`[${g.start}-${g.end}]`)}`),this.loadingParts=!1}else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${"["+l.startSN+"-"+l.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),ht(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=at.FRAG_LOADING;const h=this.config.progressive;let p;return h&&u?p=u.then(g=>!g||this.fragContextChanged(g.frag)?null:this.fragmentLoader.load(t,s)).catch(g=>this.handleFragLoadError(g)):p=Promise.all([this.fragmentLoader.load(t,h?s:void 0),u]).then(([g])=>(!h&&s&&s(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(_.FRAG_LOADING,{frag:t,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(t,e,i,s){return new Promise((a,l)=>{var u;const d=[],f=(u=i.details)==null?void 0:u.partList,h=p=>{this.fragmentLoader.loadPart(t,p,s).then(g=>{d[p.index]=g;const v=g.part;this.hls.trigger(_.FRAG_LOADED,g);const y=ov(i.details,t.sn,p.index+1)||Ax(f,t.sn,p.index+1);if(y)h(y);else return a({frag:t,part:v,partsLoaded:d})}).catch(l)};h(e)})}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===vt.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(e.frag)):this.hls.trigger(_.ERROR,e)}else this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==at.PARSING){!this.fragCurrent&&this.state!==at.STOPPED&&this.state!==at.ERROR&&(this.state=at.IDLE);return}const{frag:i,part:s,level:a}=e,l=self.performance.now();i.stats.parsing.end=l,s&&(s.stats.parsing.end=l);const u=this.getLevelDetails(),f=u&&i.sn>u.endSN||this.shouldLoadParts(u,i.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=f),this.updateLevelTiming(i,s,a,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var i;const a=t.partList[0];if(a.fragment.type===mt.SUBTITLE)return!1;const l=a.end+(((i=t.fragmentHint)==null?void 0:i.duration)||0);if(e>=l){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:s,sn:a,part:l}=t;if(!(e!=null&&e[s]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const u=e[s],d=u.details,f=l>-1?ov(d,a,l):null,h=f?f.fragment:bx(d,a,i);return h?(i&&i!==h&&(h.stats=i.stats),{frag:h,part:f,level:u}):null}bufferFragmentData(t,e,i,s,a){if(this.state!==at.PARSING)return;const{data1:l,data2:u}=t;let d=l;if(u&&(d=Ii(l,u)),!d.length)return;const f=this.initPTS[e.cc],h=f?-f.baseTime/f.timescale:void 0,p={type:t.type,frag:e,part:i,chunkMeta:s,offset:h,parent:e.type,data:d};if(this.hls.trigger(_.BUFFER_APPENDING,p),t.dropped&&t.independent&&!i){if(a)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!At.isBuffered(e,e.currentTime)){this.flushMainBuffer(0,t.start);return}const i=e.currentTime,s=At.bufferInfo(e,i,0),a=t.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),u=Math.max(Math.min(t.start-l,s.end-l),i+l);t.start-u>l&&this.flushMainBuffer(u,t.start)}getFwdBufferInfo(t,e){var i;const s=this.getLoadPosition();if(!ht(s))return null;const l=this.lastCurrentTime>s||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,s,e,l)}getFwdBufferInfoAtPos(t,e,i,s){const a=At.bufferInfo(t,e,s);if(a.len===0&&a.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(e,i);if(l&&(a.nextStart<=l.end||l.gap)){const u=Math.max(Math.min(a.nextStart,l.end)-e,s);return At.bufferInfo(t,e,u)}}return a}getMaxBufferLength(t){const{config:e}=this;let i;return t?i=Math.max(8*e.maxBufferSize/t,e.maxBufferLength):i=e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const i=this.config,s=Math.max(Math.min(t-e,i.maxBufferLength),e),a=Math.max(t-e*3,i.maxMaxBufferLength/2,s);return a>=s?(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(t,e=mt.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(t,e){const i=e.fragments,s=i.length;if(!s)return null;const{config:a}=this,l=i[0].start,u=a.lowLatencyMode&&!!e.partList;let d=null;if(e.live){const p=a.initialLiveManifestSize;if(s<p)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${p})`),null;if(!e.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<l){var f;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(e);const g=this.hls.startPosition,v=this.hls.liveSyncPosition,y=d?(g!==-1&&g>=l?g:v)||d.start:t;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${g} liveSyncPosition: ${v} frag.start: ${(f=d)==null?void 0:f.start}`),this.startPosition=this.nextLoadPosition=y}}else t<=l&&(d=i[0]);if(!d){const p=this.loadingParts?e.partEnd:e.fragmentEnd;d=this.getFragmentAtPosition(t,p,e)}let h=this.filterReplacedPrimary(d,e);if(!h&&d){const p=d.sn-e.startSN;h=this.filterReplacedPrimary(i[p+1]||null,e)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return(i===Le.OK||i===Le.PARTIAL&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,s,a){let l=null;if(t.gap&&(l=this.getNextFragment(this.nextLoadPosition,e),l&&!l.gap&&i.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s,0);if(u!==null&&i.len+u.len>=a){const d=l.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(cv(this.config)){var t;if((t=this.hls.interstitialsManager)==null||(t=t.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(cv(this.config)&&t.type!==mt.SUBTITLE){const i=this.hls.interstitialsManager,s=i?.bufferingItem;if(s){const l=s.event;if(l){if(l.appendInPlace||Math.abs(t.start-s.start)>1||s.start===0)return null}else if(t.end<=s.start&&e?.live===!1||t.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||t.start-s.end>1))return null}const a=i?.playerQueue;if(a)for(let l=a.length;l--;){const u=a[l].interstitial;if(u.appendInPlace&&t.start>=u.startTime&&t.end<=u.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!t.initSegment.data&&!this.bitrateTest?t.initSegment:t}getNextPart(t,e,i){let s=-1,a=!1,l=!0;for(let u=0,d=t.length;u<d;u++){const f=t[u];if(l=l&&!f.independent,s>-1&&i<f.start)break;const h=f.loaded;h?s=-1:(a||(f.independent||l)&&f.fragment===e)&&(f.fragment!==e&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${f.start}`),s=u),a=h}return s}loadedEndOfParts(t,e){let i;for(let s=t.length;s--;){if(i=t[s],!i.loaded)return!1;if(e>i.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,i=this.fragPrevious;let s=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=q_(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const a=i.sn+1;if(a>=t.startSN&&a<=t.endSN){const l=e[a-t.startSN];i.cc===l.cc&&(s=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=ux(t,i.cc,i.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(s=this.getFragmentAtPosition(a,this.bitrateTest?t.fragmentEnd:t.edge,t))}return s}getFragmentAtPosition(t,e,i){const{config:s}=this;let{fragPrevious:a}=this,{fragments:l,endSN:u}=i;const{fragmentHint:d}=i,{maxFragLookUpTolerance:f}=s,h=i.partList,p=!!(this.loadingParts&&h!=null&&h.length&&d);p&&!this.bitrateTest&&h[h.length-1].fragment.sn===d.sn&&(l=l.concat(d),u=d.sn);let g;if(t<e){var v;const S=t<this.lastCurrentTime||t>e-f||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:f;g=qs(a,l,t,S)}else g=l[l.length-1];if(g){const y=g.sn-i.startSN,S=this.fragmentTracker.getState(g);if((S===Le.OK||S===Le.PARTIAL&&g.gap)&&(a=g),a&&g.sn===a.sn&&(!p||h[0].fragment.sn>g.sn||!i.live)&&g.level===a.level){const A=l[y+1];g.sn<u&&this.fragmentTracker.getState(A)!==Le.OK?g=A:g=null}}return g}alignPlaylists(t,e,i){const s=t.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const a=t.fragmentStart,l=!e,u=t.alignedSliding&&ht(a);if(l||!u&&!a){DC(i,t);const d=t.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${s}`),d}return a}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*3)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);const s=this.timelineOffset;if(i===-1){const a=this.startTimeOffset!==null,l=a?this.startTimeOffset:t.startTimeOffset;l!==null&&ht(l)?(i=e+l,l<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${l} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+s}this.nextLoadPosition=i+s}getLoadPosition(){var t;const{media:e}=this;let i=0;return(t=this.hls)!=null&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&Te(t)&&t.stats.aborted&&(this.log(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==at.FRAG_LOADING_WAITING_RETRY)&&(this.state=at.IDLE)}onFragmentOrKeyLoadError(t,e){var i;if(e.chunkMeta&&!e.frag){const A=this.getCurrentContext(e.chunkMeta);A&&(e.frag=A.frag)}const s=e.frag;if(!s||s.type!==t||!this.levels)return;if(this.fragContextChanged(s)){var a;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const l=e.details===Q.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(s,!0);const u=e.errorAction;if(!u){this.state=at.ERROR;return}const{action:d,flags:f,retryCount:h=0,retryConfig:p}=u,g=!!p,v=g&&d===Ue.RetryRequest,y=g&&!u.resolved&&f===mi.MoveAllAlternatesMatchingHost,S=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!v&&y&&Te(s)&&!s.endList&&S&&!fx(e))this.resetFragmentErrors(t),this.treatAsGap(s),u.resolved=!0;else if((v||y)&&h<p.maxNumRetry){var T;const A=Yd((T=e.response)==null?void 0:T.code),b=kh(p,h);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+b,this.state=at.FRAG_LOADING_WAITING_RETRY,u.resolved=!0,A){this.log("Waiting for connection (offline)"),this.retryDate=1/0,e.reason="offline";return}this.warn(`Fragment ${s.sn} of ${t} ${s.level} errored with ${e.details}, retrying loading ${h+1}/${p.maxNumRetry} in ${b}ms`)}else if(p)if(this.resetFragmentErrors(t),h<p.maxNumRetry)!l&&d!==Ue.RemoveAlternatePermanently&&(u.resolved=!0);else{this.warn(`${e.details} reached or exceeded max retry (${h})`);return}else d===Ue.SendAlternateToPenaltyBox?this.state=at.WAITING_LEVEL:this.state=at.ERROR;this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,i=e===1/0;(!e||t>=e||i&&!Yd(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=at.IDLE)}reduceLengthAndFlushBuffer(t){if(this.state===at.PARSING||this.state===at.PARSED){const e=t.frag,i=t.parent,s=this.getFwdBufferInfo(this.mediaBuffer,i),a=s&&s.len>.5;a&&this.reduceMaxBufferLength(s.len,e?.duration||10);const l=!a;return l&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(t){t===mt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==at.STOPPED&&(this.state=at.IDLE)}afterBufferFlushed(t,e,i){if(!t)return;const s=At.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,s,i),this.state===at.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==at.STOPPED&&(this.state=at.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;e!=null&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log(`Loading context changed while buffering sn ${t.sn} of ${this.playlistLabel()} ${t.level===-1?"<removed>":t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,s){const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((d,f)=>{const h=t.elementaryStreams[f];if(h){const p=h.endPTS-h.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${t.sn} ${f} duration reliably (${p})`),d||!1;const g=s?0:xx(a,t,h.startPTS,h.endPTS,h.startDTS,h.endDTS,this);return this.hls.trigger(_.LEVEL_PTS_UPDATED,{details:a,level:i,drift:g,type:f,frag:t,start:h.startPTS,end:h.endPTS}),!0}return d},!1)){var u;if(i.fragmentError===0&&this.treatAsGap(t,i),((u=this.transmuxer)==null?void 0:u.error)===null){const d=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=at.PARSED,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(_.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===mt.MAIN?"level":"track"}fragInfo(t,e=!0,i){var s,a;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${((s=e&&!i?t.startPTS:(i||t).start)!=null?s:NaN).toFixed(3)}-${((a=e&&!i?t.endPTS:(i||t).end)!=null?a:NaN).toFixed(3)}]${i&&t.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;(t=this.transmuxer)==null||t.reset()}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function cv(r){return!!r.interstitialsController&&r.enableInterstitialPlayback!==!1}class Cx{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;if(t.length)t.length===1?i=t[0]:i=OC(t,e);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function OC(r,t){const e=new Uint8Array(t);let i=0;for(let s=0;s<r.length;s++){const a=r[s];e.set(a,i),i+=a.length}return e}var xd={exports:{}},fv;function kC(){return fv||(fv=1,(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function a(d,f,h,p,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new s(h,p||d,g),y=e?e+f:f;return d._events[y]?d._events[y].fn?d._events[y]=[d._events[y],v]:d._events[y].push(v):(d._events[y]=v,d._eventsCount++),d}function l(d,f){--d._eventsCount===0?d._events=new i:delete d._events[f]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,p;if(this._eventsCount===0)return f;for(p in h=this._events)t.call(h,p)&&f.push(e?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=e?e+f:f,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,v=p.length,y=new Array(v);g<v;g++)y[g]=p[g].fn;return y},u.prototype.listenerCount=function(f){var h=e?e+f:f,p=this._events[h];return p?p.fn?1:p.length:0},u.prototype.emit=function(f,h,p,g,v,y){var S=e?e+f:f;if(!this._events[S])return!1;var T=this._events[S],A=arguments.length,b,R;if(T.fn){switch(T.once&&this.removeListener(f,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,p),!0;case 4:return T.fn.call(T.context,h,p,g),!0;case 5:return T.fn.call(T.context,h,p,g,v),!0;case 6:return T.fn.call(T.context,h,p,g,v,y),!0}for(R=1,b=new Array(A-1);R<A;R++)b[R-1]=arguments[R];T.fn.apply(T.context,b)}else{var C=T.length,D;for(R=0;R<C;R++)switch(T[R].once&&this.removeListener(f,T[R].fn,void 0,!0),A){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,h);break;case 3:T[R].fn.call(T[R].context,h,p);break;case 4:T[R].fn.call(T[R].context,h,p,g);break;default:if(!b)for(D=1,b=new Array(A-1);D<A;D++)b[D-1]=arguments[D];T[R].fn.apply(T[R].context,b)}}return!0},u.prototype.on=function(f,h,p){return a(this,f,h,p,!1)},u.prototype.once=function(f,h,p){return a(this,f,h,p,!0)},u.prototype.removeListener=function(f,h,p,g){var v=e?e+f:f;if(!this._events[v])return this;if(!h)return l(this,v),this;var y=this._events[v];if(y.fn)y.fn===h&&(!g||y.once)&&(!p||y.context===p)&&l(this,v);else{for(var S=0,T=[],A=y.length;S<A;S++)(y[S].fn!==h||g&&!y[S].once||p&&y[S].context!==p)&&T.push(y[S]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=e?e+f:f,this._events[h]&&l(this,h)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,r.exports=u})(xd)),xd.exports}var MC=kC(),Uh=r_(MC);const ao="1.6.14",Xr={};function PC(){return typeof __HLS_WORKER_BUNDLE__=="function"}function NC(){const r=Xr[ao];if(r)return r.clientCount++,r;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t),s={worker:new self.Worker(e),objectURL:e,clientCount:1};return Xr[ao]=s,s}function FC(r){const t=Xr[r];if(t)return t.clientCount++,t;const e=new self.URL(r,self.location.href).href,s={worker:new self.Worker(e),scriptURL:e,clientCount:1};return Xr[r]=s,s}function BC(r){const t=Xr[r||ao];if(t&&t.clientCount--===1){const{worker:i,objectURL:s}=t;delete Xr[r||ao],s&&self.URL.revokeObjectURL(s),i.terminate()}}function wx(r,t){return t+10<=r.length&&r[t]===51&&r[t+1]===68&&r[t+2]===73&&r[t+3]<255&&r[t+4]<255&&r[t+6]<128&&r[t+7]<128&&r[t+8]<128&&r[t+9]<128}function $h(r,t){return t+10<=r.length&&r[t]===73&&r[t+1]===68&&r[t+2]===51&&r[t+3]<255&&r[t+4]<255&&r[t+6]<128&&r[t+7]<128&&r[t+8]<128&&r[t+9]<128}function Nu(r,t){let e=0;return e=(r[t]&127)<<21,e|=(r[t+1]&127)<<14,e|=(r[t+2]&127)<<7,e|=r[t+3]&127,e}function oo(r,t){const e=t;let i=0;for(;$h(r,t);){i+=10;const s=Nu(r,t+6);i+=s,wx(r,t+10)&&(i+=10),t+=i}if(i>0)return r.subarray(e,e+i)}function UC(r,t,e,i){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=t[e+2],l=a>>2&15;if(l>12){const v=new Error(`invalid ADTS sampling index:${l}`);r.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const u=(a>>6&3)+1,d=t[e+3]>>6&3|(a&1)<<2,f="mp4a.40."+u,h=s[l];let p=l;(u===5||u===29)&&(p-=3);const g=[u<<3|(p&14)>>1,(p&1)<<7|d<<3];return Kt.log(`manifest codec:${i}, parsed codec:${f}, channels:${d}, rate:${h} (ADTS object type:${u} sampling index:${l})`),{config:g,samplerate:h,channelCount:d,codec:f,parsedCodec:f,manifestCodec:i}}function Dx(r,t){return r[t]===255&&(r[t+1]&246)===240}function Ix(r,t){return r[t+1]&1?7:9}function jh(r,t){return(r[t+3]&3)<<11|r[t+4]<<3|(r[t+5]&224)>>>5}function $C(r,t){return t+5<r.length}function bu(r,t){return t+1<r.length&&Dx(r,t)}function jC(r,t){return $C(r,t)&&Dx(r,t)&&jh(r,t)<=r.length-t}function GC(r,t){if(bu(r,t)){const e=Ix(r,t);if(t+e>=r.length)return!1;const i=jh(r,t);if(i<=e)return!1;const s=t+i;return s===r.length||bu(r,s)}return!1}function Ox(r,t,e,i,s){if(!r.samplerate){const a=UC(t,e,i,s);if(!a)return;Wt(r,a)}}function kx(r){return 1024*9e4/r}function HC(r,t){const e=Ix(r,t);if(t+e<=r.length){const i=jh(r,t)-e;if(i>0)return{headerLength:e,frameLength:i}}}function Mx(r,t,e,i,s){const a=kx(r.samplerate),l=i+s*a,u=HC(t,e);let d;if(u){const{frameLength:p,headerLength:g}=u,v=g+p,y=Math.max(0,e+v-t.length);y?(d=new Uint8Array(v-g),d.set(t.subarray(e+g,t.length),0)):d=t.subarray(e+g,e+v);const S={unit:d,pts:l};return y||r.samples.push(S),{sample:S,length:v,missing:y}}const f=t.length-e;return d=new Uint8Array(f),d.set(t.subarray(e,t.length),0),{sample:{unit:d,pts:l},length:f,missing:-1}}function zC(r,t){return $h(r,t)&&Nu(r,t+6)+10<=r.length-t}function VC(r){return r instanceof ArrayBuffer?r:r.byteOffset==0&&r.byteLength==r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}function Sd(r,t=0,e=1/0){return KC(r,t,e,Uint8Array)}function KC(r,t,e,i){const s=qC(r);let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const l=YC(r)?r.byteOffset:0,u=(l+r.byteLength)/a,d=(l+t)/a,f=Math.floor(Math.max(0,Math.min(d,u))),h=Math.floor(Math.min(f+Math.max(e,0),u));return new i(s,f,h-f)}function qC(r){return r instanceof ArrayBuffer?r:r.buffer}function YC(r){return r&&r.buffer instanceof ArrayBuffer&&r.byteLength!==void 0&&r.byteOffset!==void 0}function XC(r){const t={key:r.type,description:"",data:"",mimeType:null,pictureType:null},e=3;if(r.size<2)return;if(r.data[0]!==e){console.log("Ignore frame with unrecognized character encoding");return}const i=r.data.subarray(1).indexOf(0);if(i===-1)return;const s=Ei(Sd(r.data,1,i)),a=r.data[2+i],l=r.data.subarray(3+i).indexOf(0);if(l===-1)return;const u=Ei(Sd(r.data,3+i,l));let d;return s==="-->"?d=Ei(Sd(r.data,4+i+l)):d=VC(r.data.subarray(4+i+l)),t.mimeType=s,t.pictureType=a,t.description=u,t.data=d,t}function WC(r){if(r.size<2)return;const t=Ei(r.data,!0),e=new Uint8Array(r.data.subarray(t.length+1));return{key:r.type,info:t,data:e.buffer}}function QC(r){if(r.size<2)return;if(r.type==="TXXX"){let e=1;const i=Ei(r.data.subarray(e),!0);e+=i.length+1;const s=Ei(r.data.subarray(e));return{key:r.type,info:i,data:s}}const t=Ei(r.data.subarray(1));return{key:r.type,info:"",data:t}}function ZC(r){if(r.type==="WXXX"){if(r.size<2)return;let e=1;const i=Ei(r.data.subarray(e),!0);e+=i.length+1;const s=Ei(r.data.subarray(e));return{key:r.type,info:i,data:s}}const t=Ei(r.data);return{key:r.type,info:"",data:t}}function JC(r){return r.type==="PRIV"?WC(r):r.type[0]==="W"?ZC(r):r.type==="APIC"?XC(r):QC(r)}function tw(r){const t=String.fromCharCode(r[0],r[1],r[2],r[3]),e=Nu(r,4),i=10;return{type:t,size:e,data:r.subarray(i,i+e)}}const Ul=10,ew=10;function Px(r){let t=0;const e=[];for(;$h(r,t);){const i=Nu(r,t+6);r[t+5]>>6&1&&(t+=Ul),t+=Ul;const s=t+i;for(;t+ew<s;){const a=tw(r.subarray(t)),l=JC(a);l&&e.push(l),t+=a.size+Ul}wx(r,t)&&(t+=Ul)}return e}function Nx(r){return r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp"}function iw(r){if(r.data.byteLength===8){const t=new Uint8Array(r.data),e=t[3]&1;let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,e&&(i+=4772185884e-2),Math.round(i)}}function Gh(r){const t=Px(r);for(let e=0;e<t.length;e++){const i=t[e];if(Nx(i))return iw(i)}}let yi=(function(r){return r.audioId3="org.id3",r.dateRange="com.apple.quicktime.HLS",r.emsg="https://aomedia.org/emsg/ID3",r.misbklv="urn:misb:KLV:bin:1910.1",r})({});function Wi(r="",t=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Hh{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=Ii(this.cachedData,t),this.cachedData=null);let i=oo(t,0),s=i?i.length:0,a;const l=this._audioTrack,u=this._id3Track,d=i?Gh(i):void 0,f=t.length;for((this.basePTS===null||this.frameIndex===0&&ht(d))&&(this.basePTS=nw(d,e,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:yi.audioId3,duration:Number.POSITIVE_INFINITY});s<f;){if(this.canParse(t,s)){const h=this.appendFrame(l,t,s);h?(this.frameIndex++,this.lastPTS=h.sample.pts,s+=h.length,a=s):s=f}else zC(t,s)?(i=oo(t,s),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:yi.audioId3,duration:Number.POSITIVE_INFINITY}),s+=i.length,a=s):s++;if(s===f&&a!==f){const h=t.slice(a);this.cachedData?this.cachedData=Ii(this.cachedData,h):this.cachedData=h}}return{audioTrack:l,videoTrack:Wi(),id3Track:u,textTrack:Wi()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Wi(),id3Track:this._id3Track,textTrack:Wi()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const nw=(r,t,e)=>{if(ht(r))return r*90;const i=e?e.baseTime*9e4/e.timescale:0;return t*9e4+i};let $l=null;const sw=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],rw=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],aw=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ow=[0,1,1,4];function Fx(r,t,e,i,s){if(e+24>t.length)return;const a=Bx(t,e);if(a&&e+a.frameLength<=t.length){const l=a.samplesPerFrame*9e4/a.sampleRate,u=i+s*l,d={unit:t.subarray(e,e+a.frameLength),pts:u,dts:u};return r.config=[],r.channelCount=a.channelCount,r.samplerate=a.sampleRate,r.samples.push(d),{sample:d,length:a.frameLength,missing:0}}}function Bx(r,t){const e=r[t+1]>>3&3,i=r[t+1]>>1&3,s=r[t+2]>>4&15,a=r[t+2]>>2&3;if(e!==1&&s!==0&&s!==15&&a!==3){const l=r[t+2]>>1&1,u=r[t+3]>>6,d=e===3?3-i:i===3?3:4,f=sw[d*14+s-1]*1e3,p=rw[(e===3?0:e===2?1:2)*3+a],g=u===3?1:2,v=aw[e][i],y=ow[i],S=v*8*y,T=Math.floor(v*f/p+l)*y;if($l===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);$l=R?parseInt(R[1]):0}return!!$l&&$l<=87&&i===2&&f>=224e3&&u===0&&(r[t+3]=r[t+3]|128),{sampleRate:p,channelCount:g,frameLength:T,samplesPerFrame:S}}}function zh(r,t){return r[t]===255&&(r[t+1]&224)===224&&(r[t+1]&6)!==0}function Ux(r,t){return t+1<r.length&&zh(r,t)}function lw(r,t){return zh(r,t)&&4<=r.length-t}function $x(r,t){if(t+1<r.length&&zh(r,t)){const i=Bx(r,t);let s=4;i!=null&&i.frameLength&&(s=i.frameLength);const a=t+s;return a===r.length||Ux(r,a)}return!1}class uw extends Hh{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const i=oo(t,0);let s=i?.length||0;if($x(t,s))return!1;for(let a=t.length;s<a;s++)if(GC(t,s))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return jC(t,e)}appendFrame(t,e,i){Ox(t,this.observer,e,i,t.manifestCodec);const s=Mx(t,e,i,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const jx=(r,t)=>{let e=0,i=5;t+=i;const s=new Uint32Array(1),a=new Uint32Array(1),l=new Uint8Array(1);for(;i>0;){l[0]=r[t];const u=Math.min(i,8),d=8-u;a[0]=4278190080>>>24+d<<d,s[0]=(l[0]&a[0])>>d,e=e?e<<u|s[0]:s[0],t+=1,i-=u}return e};class cw extends Hh{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const s=Gx(t,e,i,this.basePTS,this.frameIndex);if(s!==-1)return{sample:t.samples[t.samples.length-1],length:s,missing:0}}static probe(t){if(!t)return!1;const e=oo(t,0);if(!e)return!1;const i=e.length;return t[i]===11&&t[i+1]===119&&Gh(e)!==void 0&&jx(t,i)<16}}function Gx(r,t,e,i,s){if(e+8>t.length||t[e]!==11||t[e+1]!==119)return-1;const a=t[e+4]>>6;if(a>=3)return-1;const u=[48e3,44100,32e3][a],d=t[e+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+a]*2;if(e+h>t.length)return-1;const p=t[e+6]>>5;let g=0;p===2?g+=2:(p&1&&p!==1&&(g+=2),p&4&&(g+=2));const v=(t[e+6]<<8|t[e+7])>>12-g&1,S=[2,1,2,3,3,4,4,5][p]+v,T=t[e+5]>>3,A=t[e+5]&7,b=new Uint8Array([a<<6|T<<1|A>>2,(A&3)<<6|p<<3|v<<2|d>>4,d<<4&224]),R=1536/u*9e4,C=i+s*R,D=t.subarray(e,e+h);return r.config=b,r.channelCount=S,r.samplerate=u,r.samples.push({unit:D,pts:C}),h}class fw extends Hh{resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=oo(t,0);let i=e?.length||0;if(e&&t[i]===11&&t[i+1]===119&&Gh(e)!==void 0&&jx(t,i)<=16)return!1;for(let s=t.length;i<s;i++)if($x(t,i))return Kt.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return lw(t,e)}appendFrame(t,e,i){if(this.basePTS!==null)return Fx(t,e,i,this.basePTS,this.frameIndex)}}const dw=/\/emsg[-/]ID3/i;class hw{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,s){const a=this.videoTrack=Wi("video",1),l=this.audioTrack=Wi("audio",1),u=this.txtTrack=Wi("text",1);if(this.id3Track=Wi("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const d=ZE(t);if(d.video){const{id:f,timescale:h,codec:p,supplemental:g}=d.video;a.id=f,a.timescale=u.timescale=h,a.codec=p,a.supplemental=g}if(d.audio){const{id:f,timescale:h,codec:p}=d.audio;l.id=f,l.timescale=h,l.codec=p}u.id=XE.text,a.sampleDuration=0,a.duration=l.duration=s}resetContiguity(){this.remainderData=null}static probe(t){return c_(t)}demux(t,e){this.timeOffset=e;let i=t;const s=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Ii(this.remainderData,t));const u=y_(i);this.remainderData=u.remainder,s.samples=u.valid||new Uint8Array}else s.samples=i;const l=this.extractID3Track(s,e);return a.samples=wy(e,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(e,this.timeOffset);return i.samples=wy(t,e),{videoTrack:e,audioTrack:Wi(),id3Track:s,textTrack:Wi()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const s=Dt(t.samples,["emsg"]);s&&s.forEach(a=>{const l=E_(a);if(dw.test(l.schemeIdUri)){const u=dv(l,e);let d=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const f=l.payload;i.samples.push({data:f,len:f.byteLength,dts:u,pts:u,type:yi.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=dv(l,e);i.samples.push({data:l.payload,len:l.payload.byteLength,dts:u,pts:u,type:yi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function dv(r,t){return ht(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale}class mw{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Mh(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,gs.cbc)}decryptAacSample(t,e,i){const s=t[e].unit;if(s.length<=16)return;const a=s.subarray(16,s.length-s.length%16),l=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(l).then(u=>{const d=new Uint8Array(u);s.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}).catch(i)}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length){i();return}if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=Math.floor((t.length-48)/160)*16+16,i=new Int8Array(e);let s=0;for(let a=32;a<t.length-16;a+=160,s+=16)i.set(t.subarray(a,a+16),s);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let s=0;for(let a=32;a<t.length-16;a+=160,s+=16)t.set(i.subarray(s,s+16),a);return t}decryptAvcSample(t,e,i,s,a){const l=ex(a.data),u=this.getAvcEncryptedData(l);this.decryptBuffer(u.buffer).then(d=>{a.data=this.getAvcDecryptedUnit(l,d),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,s)}).catch(s)}decryptAvcSamples(t,e,i,s){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length){s();return}const a=t[e].units;for(;!(i>=a.length);i++){const l=a[i];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(t,e,i,s,l),!this.decrypter.isSync()))return}}}}class Hx{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let i=this.VideoSample,s;if((!i||i.units.length===0)&&(i=t[t.length-1]),(e=i)!=null&&e.units){const a=i.units;s=a[a.length-1]}return s}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(t.pts===void 0){const i=e.samples,s=i.length;if(s){const a=i[s-1];t.pts=a.pts,t.dts=a.dts}else{e.dropped++;return}}e.samples.push(t)}}parseNALu(t,e,i){const s=e.byteLength;let a=t.naluState||0;const l=a,u=[];let d=0,f,h,p,g=-1,v=0;for(a===-1&&(g=0,v=this.getNALuType(e,0),a=0,d=1);d<s;){if(f=e[d++],!a){a=f?0:1;continue}if(a===1){a=f?0:2;continue}if(!f)a=3;else if(f===1){if(h=d-a-1,g>=0){const y={data:e.subarray(g,h),type:v};u.push(y)}else{const y=this.getLastNalUnit(t.samples);y&&(l&&d<=4-l&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-l)),h>0&&(y.data=Ii(y.data,e.subarray(0,h)),y.state=0))}d<s?(p=this.getNALuType(e,d),g=d,v=p,a=0):a=-1}else a=0}if(g>=0&&a>=0){const y={data:e.subarray(g,s),type:v,state:a};u.push(y)}if(u.length===0){const y=this.getLastNalUnit(t.samples);y&&(y.data=Ii(y.data,e))}return t.naluState=a,u}}class Za{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,s=new Uint8Array(4),a=Math.min(4,e);if(a===0)throw new Error("no bytes available");s.set(t.subarray(i,i+a)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(t){let e;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&Kt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!==0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class pw extends Hx{parsePES(t,e,i,s){const a=this.parseNALu(t,i.data,s);let l=this.VideoSample,u,d=!1;i.data=null,l&&a.length&&!t.audFound&&(this.pushAccessUnit(l,t),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var h,p;switch(f.type){case 1:{let S=!1;u=!0;const T=f.data;if(d&&T.length>4){const A=this.readSliceType(T);(A===2||A===4||A===7||A===9)&&(S=!0)}if(S){var g;(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.frame=!0,l.key=S;break}case 5:u=!0,(h=l)!=null&&h.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 6:{u=!0,Dh(f.data,1,i.pts,e.samples);break}case 7:{var v,y;u=!0,d=!0;const S=f.data,T=this.readSPS(S);if(!t.sps||t.width!==T.width||t.height!==T.height||((v=t.pixelRatio)==null?void 0:v[0])!==T.pixelRatio[0]||((y=t.pixelRatio)==null?void 0:y[1])!==T.pixelRatio[1]){t.width=T.width,t.height=T.height,t.pixelRatio=T.pixelRatio,t.sps=[S];const A=S.subarray(1,4);let b="avc1.";for(let R=0;R<3;R++){let C=A[R].toString(16);C.length<2&&(C="0"+C),b+=C}t.codec=b}break}case 8:u=!0,t.pps=[f.data];break;case 9:u=!0,t.audFound=!0,(p=l)!=null&&p.frame&&(this.pushAccessUnit(l,t),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:u=!0;break;default:u=!1;break}l&&u&&l.units.push(f)}),s&&l&&(this.pushAccessUnit(l,t),this.VideoSample=null)}getNALuType(t,e){return t[e]&31}readSliceType(t){const e=new Za(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let i=8,s=8,a;for(let l=0;l<t;l++)s!==0&&(a=e.readEG(),s=(i+a+256)%256),i=s===0?i:s}readSPS(t){const e=new Za(t);let i=0,s=0,a=0,l=0,u,d,f;const h=e.readUByte.bind(e),p=e.readBits.bind(e),g=e.readUEG.bind(e),v=e.readBoolean.bind(e),y=e.skipBits.bind(e),S=e.skipEG.bind(e),T=e.skipUEG.bind(e),A=this.skipScalingList.bind(this);h();const b=h();if(p(5),y(3),h(),T(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){const P=g();if(P===3&&y(1),T(),T(),y(1),v())for(d=P!==3?8:12,f=0;f<d;f++)v()&&(f<6?A(16,e):A(64,e))}T();const R=g();if(R===0)g();else if(R===1)for(y(1),S(),S(),u=g(),f=0;f<u;f++)S();T(),y(1);const C=g(),D=g(),N=p(1);N===0&&y(1),y(1),v()&&(i=g(),s=g(),a=g(),l=g());let w=[1,1];if(v()&&v())switch(h()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:{w=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((C+1)*16-i*2-s*2),height:(2-N)*(D+1)*16-(N?2:4)*(a+l),pixelRatio:w}}}class gw extends Hx{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,i,s){const a=this.parseNALu(t,i.data,s);let l=this.VideoSample,u,d=!1;i.data=null,l&&a.length&&!t.audFound&&(this.pushAccessUnit(l,t),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var h,p;switch(f.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),l.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,d){var g;(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:u=!0,(h=l)!=null&&h.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 39:u=!0,Dh(f.data,2,i.pts,e.samples);break;case 32:u=!0,t.vps||(typeof t.params!="object"&&(t.params={}),t.params=Wt(t.params,this.readVPS(f.data)),this.initVPS=f.data),t.vps=[f.data];break;case 33:if(u=!0,d=!0,t.vps!==void 0&&t.vps[0]!==this.initVPS&&t.sps!==void 0&&!this.matchSPS(t.sps[0],f.data)&&(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const v=this.readSPS(f.data);t.width=v.width,t.height=v.height,t.pixelRatio=v.pixelRatio,t.codec=v.codecString,t.sps=[],typeof t.params!="object"&&(t.params={});for(const y in v.params)t.params[y]=v.params[y]}this.pushParameterSet(t.sps,f.data,t.vps),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0;break;case 34:if(u=!0,typeof t.params=="object"){if(!t.pps){t.pps=[];const v=this.readPPS(f.data);for(const y in v)t.params[y]=v[y]}this.pushParameterSet(t.pps,f.data,t.vps)}break;case 35:u=!0,t.audFound=!0,(p=l)!=null&&p.frame&&(this.pushAccessUnit(l,t),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:u=!1;break}l&&u&&l.units.push(f)}),s&&l&&(this.pushAccessUnit(l,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(t[e]&126)>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let i=0;for(let s=0;s<t.byteLength;s++)s>=2&&t[s]===3&&t[s-1]===0&&t[s-2]===0||(e[i]=t[s],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new Za(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);const i=e.readBits(3),s=e.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:s}}readSPS(t){const e=new Za(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const i=e.readBits(3);e.readBoolean();const s=e.readBits(2),a=e.readBoolean(),l=e.readBits(5),u=e.readUByte(),d=e.readUByte(),f=e.readUByte(),h=e.readUByte(),p=e.readUByte(),g=e.readUByte(),v=e.readUByte(),y=e.readUByte(),S=e.readUByte(),T=e.readUByte(),A=e.readUByte(),b=[],R=[];for(let bt=0;bt<i;bt++)b.push(e.readBoolean()),R.push(e.readBoolean());if(i>0)for(let bt=i;bt<8;bt++)e.readBits(2);for(let bt=0;bt<i;bt++)b[bt]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),R[bt]&&e.readUByte();e.readUEG();const C=e.readUEG();C==3&&e.skipBits(1);const D=e.readUEG(),N=e.readUEG(),w=e.readBoolean();let P=0,B=0,M=0,q=0;w&&(P+=e.readUEG(),B+=e.readUEG(),M+=e.readUEG(),q+=e.readUEG());const tt=e.readUEG(),V=e.readUEG(),H=e.readUEG(),X=e.readBoolean();for(let bt=X?0:i;bt<=i;bt++)e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.readBoolean()&&e.readBoolean())for(let pt=0;pt<4;pt++)for(let be=0;be<(pt===3?2:6);be++)if(!e.readBoolean())e.readUEG();else{const ue=Math.min(64,1<<4+(pt<<1));pt>1&&e.readEG();for(let ke=0;ke<ue;ke++)e.readEG()}e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const K=e.readUEG();let nt=0;for(let bt=0;bt<K;bt++){let pt=!1;if(bt!==0&&(pt=e.readBoolean()),pt){bt===K&&e.readUEG(),e.readBoolean(),e.readUEG();let be=0;for(let le=0;le<=nt;le++){const ue=e.readBoolean();let ke=!1;ue||(ke=e.readBoolean()),(ue||ke)&&be++}nt=be}else{const be=e.readUEG(),le=e.readUEG();nt=be+le;for(let ue=0;ue<be;ue++)e.readUEG(),e.readBoolean();for(let ue=0;ue<le;ue++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const bt=e.readUEG();for(let pt=0;pt<bt;pt++){for(let be=0;be<H+4;be++)e.readBits(1);e.readBits(1)}}let k=0,j=1,st=1,ct=!0,ft=1,dt=0;e.readBoolean(),e.readBoolean();let Et=!1;if(e.readBoolean()){if(e.readBoolean()){const je=e.readUByte(),He=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ne=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];je>0&&je<16?(j=He[je-1],st=ne[je-1]):je===255&&(j=e.readBits(16),st=e.readBits(16))}if(e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())),e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),Et=e.readBoolean(),Et&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG()),e.readBoolean()&&(ft=e.readBits(32),dt=e.readBits(32),e.readBoolean()&&e.readUEG(),e.readBoolean())){const ne=e.readBoolean(),un=e.readBoolean();let Xe=!1;(ne||un)&&(Xe=e.readBoolean(),Xe&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),Xe&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let ys=0;ys<=i;ys++){ct=e.readBoolean();const Bn=ct||e.readBoolean();let Qs=!1;Bn?e.readEG():Qs=e.readBoolean();const vs=Qs?1:e.readUEG()+1;if(ne)for(let cn=0;cn<vs;cn++)e.readUEG(),e.readUEG(),Xe&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(un)for(let cn=0;cn<vs;cn++)e.readUEG(),e.readUEG(),Xe&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),k=e.readUEG())}let _t=D,ie=N;if(w){let bt=1,pt=1;C===1?bt=pt=2:C==2&&(bt=2),_t=D-bt*B-bt*P,ie=N-pt*q-pt*M}const pe=s?["A","B","C"][s]:"",_e=u<<24|d<<16|f<<8|h;let Oe=0;for(let bt=0;bt<32;bt++)Oe=(Oe|(_e>>bt&1)<<31-bt)>>>0;let Ce=Oe.toString(16);return l===1&&Ce==="2"&&(Ce="6"),{codecString:`hvc1.${pe}${l}.${Ce}.${a?"H":"L"}${A}.B0`,params:{general_tier_flag:a,general_profile_idc:l,general_profile_space:s,general_profile_compatibility_flags:[u,d,f,h],general_constraint_indicator_flags:[p,g,v,y,S,T],general_level_idc:A,bit_depth:tt+8,bit_depth_luma_minus8:tt,bit_depth_chroma_minus8:V,min_spatial_segmentation_idc:k,chroma_format_idc:C,frame_rate:{fixed:ct,fps:dt/ft}},width:_t,height:ie,pixelRatio:[j,st]}}readPPS(t){const e=new Za(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2),e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const s=e.readBoolean(),a=e.readBoolean();let l=1;return a&&s?l=0:a?l=3:s&&(l=2),{parallelismType:l}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const Ie=188;class ds{constructor(t,e,i,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=s,this.videoParser=null}static probe(t,e){const i=ds.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(t){const e=t.length;let i=Math.min(Ie*5,e-Ie)+1,s=0;for(;s<i;){let a=!1,l=-1,u=0;for(let d=s;d<e;d+=Ie)if(t[d]===71&&(e-d===Ie||t[d+Ie]===71)){if(u++,l===-1&&(l=d,l!==0&&(i=Math.min(l+Ie*99,t.length-Ie)+1)),a||(a=Jd(t,d)===0),a&&u>1&&(l===0&&u>2||d+Ie>i))return l}else{if(u)return-1;break}s++}return-1}static createTrack(t,e){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:XE[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?e:void 0}}resetInitSegment(t,e,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ds.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=ds.createTrack("audio",s),this._id3Track=ds.createTrack("id3"),this._txtTrack=ds.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,s=!1){i||(this.sampleAes=null);let a;const l=this._videoTrack,u=this._audioTrack,d=this._id3Track,f=this._txtTrack;let h=l.pid,p=l.pesData,g=u.pid,v=d.pid,y=u.pesData,S=d.pesData,T=null,A=this.pmtParsed,b=this._pmtId,R=t.length;if(this.remainderData&&(t=Ii(this.remainderData,t),R=t.length,this.remainderData=null),R<Ie&&!s)return this.remainderData=t,{audioTrack:u,videoTrack:l,id3Track:d,textTrack:f};const C=Math.max(0,ds.syncOffset(t));R-=(R-C)%Ie,R<t.byteLength&&!s&&(this.remainderData=new Uint8Array(t.buffer,R,t.buffer.byteLength-R));let D=0;for(let w=C;w<R;w+=Ie)if(t[w]===71){const P=!!(t[w+1]&64),B=Jd(t,w),M=(t[w+3]&48)>>4;let q;if(M>1){if(q=w+5+t[w+4],q===w+Ie)continue}else q=w+4;switch(B){case h:P&&(p&&(a=Br(p,this.logger))&&(this.readyVideoParser(l.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(l,f,a,!1)),p={data:[],size:0}),p&&(p.data.push(t.subarray(q,w+Ie)),p.size+=w+Ie-q);break;case g:if(P){if(y&&(a=Br(y,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,a);break;case"mp3":this.parseMPEGPES(u,a);break;case"ac3":this.parseAC3PES(u,a);break}y={data:[],size:0}}y&&(y.data.push(t.subarray(q,w+Ie)),y.size+=w+Ie-q);break;case v:P&&(S&&(a=Br(S,this.logger))&&this.parseID3PES(d,a),S={data:[],size:0}),S&&(S.data.push(t.subarray(q,w+Ie)),S.size+=w+Ie-q);break;case 0:P&&(q+=t[q]+1),b=this._pmtId=yw(t,q);break;case b:{P&&(q+=t[q]+1);const tt=vw(t,q,this.typeSupported,i,this.observer,this.logger);h=tt.videoPid,h>0&&(l.pid=h,l.segmentCodec=tt.segmentVideoCodec),g=tt.audioPid,g>0&&(u.pid=g,u.segmentCodec=tt.segmentAudioCodec),v=tt.id3Pid,v>0&&(d.pid=v),T!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${w} after unknown PID '${T}'. Backtracking to sync byte @${C} to parse all TS packets.`),T=null,w=C-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=B;break}}else D++;D>0&&th(this.observer,new Error(`Found ${D} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=p,u.pesData=y,d.pesData=S;const N={audioTrack:u,videoTrack:l,id3Track:d,textTrack:f};return s&&this.extractRemainingSamples(N),N}flush(){const{remainderData:t}=this;this.remainderData=null;let e;return t?e=this.demux(t,-1,!1,!0):e={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:s,textTrack:a}=t,l=i.pesData,u=e.pesData,d=s.pesData;let f;if(l&&(f=Br(l,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,a,f,!0),i.pesData=null)):i.pesData=l,u&&(f=Br(u,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,f);break;case"mp3":this.parseMPEGPES(e,f);break;case"ac3":this.parseAC3PES(e,f);break}e.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=u;d&&(f=Br(d,this.logger))?(this.parseID3PES(s,f),s.pesData=null):s.pesData=d}demuxSampleAes(t,e,i){const s=this.demux(t,i,!0,!this.config.progressive),a=this.sampleAes=new mw(this.observer,this.config,e);return this.decrypt(s,a)}readyVideoParser(t){this.videoParser===null&&(t==="avc"?this.videoParser=new pw:t==="hevc"&&(this.videoParser=new gw))}decrypt(t,e){return new Promise(i=>{const{audioTrack:s,videoTrack:a}=t;s.samples&&s.segmentCodec==="aac"?e.decryptAacSamples(s.samples,0,()=>{a.samples?e.decryptAvcSamples(a.samples,0,0,()=>{i(t)}):i(t)}):a.samples&&e.decryptAvcSamples(a.samples,0,0,()=>{i(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0;const s=this.aacOverFlow;let a=e.data;if(s){this.aacOverFlow=null;const p=s.missing,g=s.sample.unit.byteLength;if(p===-1)a=Ii(s.sample.unit,a);else{const v=g-p;s.sample.unit.set(a.subarray(0,p),v),t.samples.push(s.sample),i=s.missing}}let l,u;for(l=i,u=a.length;l<u-1&&!bu(a,l);l++);if(l!==i){let p;const g=l<u-1;if(g?p=`AAC PES did not start with ADTS header,offset:${l}`:p="No ADTS header found in AAC PES",th(this.observer,new Error(p),g,this.logger),!g)return}Ox(t,this.observer,a,l,this.audioCodec);let d;if(e.pts!==void 0)d=e.pts;else if(s){const p=kx(t.samplerate);d=s.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,h;for(;l<u;)if(h=Mx(t,a,l,d,f),l+=h.length,h.missing){this.aacOverFlow=h;break}else for(f++;l<u-1&&!bu(a,l);l++);}parseMPEGPES(t,e){const i=e.data,s=i.length;let a=0,l=0;const u=e.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<s;)if(Ux(i,l)){const d=Fx(t,i,l,u,a);if(d)l+=d.length,a++;else break}else l++}parseAC3PES(t,e){{const i=e.data,s=e.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=i.length;let l=0,u=0,d;for(;u<a&&(d=Gx(t,i,u,s,l++))>0;)u+=d}}parseID3PES(t,e){if(e.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Wt({},e,{type:this._videoTrack?yi.emsg:yi.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function Jd(r,t){return((r[t+1]&31)<<8)+r[t+2]}function yw(r,t){return(r[t+10]&31)<<8|r[t+11]}function vw(r,t,e,i,s,a){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(r[t+1]&15)<<8|r[t+2],d=t+3+u-4,f=(r[t+10]&15)<<8|r[t+11];for(t+=12+f;t<d;){const h=Jd(r,t),p=(r[t+3]&15)<<8|r[t+4];switch(r[t]){case 207:if(!i){Td("ADTS AAC",a);break}case 15:l.audioPid===-1&&(l.audioPid=h);break;case 21:l.id3Pid===-1&&(l.id3Pid=h);break;case 219:if(!i){Td("H.264",a);break}case 27:l.videoPid===-1&&(l.videoPid=h);break;case 3:case 4:!e.mpeg&&!e.mp3?a.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="mp3");break;case 193:if(!i){Td("AC-3",a);break}case 129:e.ac3?l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&p>0){let g=t+5,v=p;for(;v>2;){switch(r[g]){case 106:e.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=h,l.segmentAudioCodec="ac3");break}const S=r[g+1]+2;g+=S,v-=S}}break;case 194:case 135:return th(s,new Error("Unsupported EC-3 in M2TS found"),void 0,a),l;case 36:l.videoPid===-1&&(l.videoPid=h,l.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}t+=p+5}return l}function th(r,t,e,i){i.warn(`parsing error: ${t.message}`),r.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:t,reason:t.message})}function Td(r,t){t.log(`${r} with AES-128-CBC encryption found in unencrypted stream`)}function Br(r,t){let e=0,i,s,a,l,u;const d=r.data;if(!r||r.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Ii(d[0],d[1]),d.splice(1,1);if(i=d[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(s=(i[4]<<8)+i[5],s&&s>r.size-6)return null;const h=i[7];h&192&&(l=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,h&64?(u=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,l-u>60*9e4&&(t.warn(`${Math.round((l-u)/9e4)}s delta between PTS and DTS, align them`),l=u)):u=l),a=i[8];let p=a+9;if(r.size<=p)return null;r.size-=p;const g=new Uint8Array(r.size);for(let v=0,y=d.length;v<y;v++){i=d[v];let S=i.byteLength;if(p)if(p>S){p-=S;continue}else i=i.subarray(p),S-=p,p=0;g.set(i,e),e+=S}return s&&(s-=a+3),{data:g,pts:l,dts:u,len:s}}return null}class Ew{static getSilentFrame(t,e){switch(t){case"mp4a.40.2":if(e===1)return new Uint8Array([0,200,0,128,35,128]);if(e===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(e===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(e===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(e===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(e===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(e===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const us=Math.pow(2,32)-1;class W{static init(){W.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in W.types)W.types.hasOwnProperty(t)&&(W.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);W.HDLR_TYPES={video:e,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);W.STTS=W.STSC=W.STCO=a,W.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),W.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),W.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);W.FTYP=W.box(W.types.ftyp,l,d,l,u),W.DINF=W.box(W.types.dinf,W.box(W.types.dref,s))}static box(t,...e){let i=8,s=e.length;const a=s;for(;s--;)i+=e[s].byteLength;const l=new Uint8Array(i);for(l[0]=i>>24&255,l[1]=i>>16&255,l[2]=i>>8&255,l[3]=i&255,l.set(t,4),s=0,i=8;s<a;s++)l.set(e[s],i),i+=e[s].byteLength;return l}static hdlr(t){return W.box(W.types.hdlr,W.HDLR_TYPES[t])}static mdat(t){return W.box(W.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(us+1)),s=Math.floor(e%(us+1));return W.box(W.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(t){return W.box(W.types.mdia,W.mdhd(t.timescale||0,t.duration||0),W.hdlr(t.type),W.minf(t))}static mfhd(t){return W.box(W.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?W.box(W.types.minf,W.box(W.types.smhd,W.SMHD),W.DINF,W.stbl(t)):W.box(W.types.minf,W.box(W.types.vmhd,W.VMHD),W.DINF,W.stbl(t))}static moof(t,e,i){return W.box(W.types.moof,W.mfhd(t),W.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=W.trak(t[e]);return W.box.apply(null,[W.types.moov,W.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(W.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=W.trex(t[e]);return W.box.apply(null,[W.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(us+1)),s=Math.floor(e%(us+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return W.box(W.types.mvhd,a)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let s,a;for(s=0;s<e.length;s++)a=e[s].flags,i[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return W.box(W.types.sdtp,i)}static stbl(t){return W.box(W.types.stbl,W.stsd(t),W.box(W.types.stts,W.STTS),W.box(W.types.stsc,W.STSC),W.box(W.types.stsz,W.STSZ),W.box(W.types.stco,W.STCO))}static avc1(t){let e=[],i=[],s,a,l;for(s=0;s<t.sps.length;s++)a=t.sps[s],l=a.byteLength,e.push(l>>>8&255),e.push(l&255),e=e.concat(Array.prototype.slice.call(a));for(s=0;s<t.pps.length;s++)a=t.pps[s],l=a.byteLength,i.push(l>>>8&255),i.push(l&255),i=i.concat(Array.prototype.slice.call(a));const u=W.box(W.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(i))),d=t.width,f=t.height,h=t.pixelRatio[0],p=t.pixelRatio[1];return W.box(W.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,e&255,0,0])}static mp4a(t){return W.box(W.types.mp4a,W.audioStsd(t),W.box(W.types.esds,W.esds(t)))}static mp3(t){return W.box(W.types[".mp3"],W.audioStsd(t))}static ac3(t){return W.box(W.types["ac-3"],W.audioStsd(t),W.box(W.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if(t.type==="audio"){if(e==="aac")return W.box(W.types.stsd,W.STSD,W.mp4a(t));if(e==="ac3"&&t.config)return W.box(W.types.stsd,W.STSD,W.ac3(t));if(e==="mp3"&&t.codec==="mp3")return W.box(W.types.stsd,W.STSD,W.mp3(t))}else if(t.pps&&t.sps){if(e==="avc")return W.box(W.types.stsd,W.STSD,W.avc1(t));if(e==="hevc"&&t.vps)return W.box(W.types.stsd,W.STSD,W.hvc1(t))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){const e=t.id,i=(t.duration||0)*(t.timescale||0),s=t.width||0,a=t.height||0,l=Math.floor(i/(us+1)),u=Math.floor(i%(us+1));return W.box(W.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,a>>8&255,a&255,0,0]))}static traf(t,e){const i=W.sdtp(t),s=t.id,a=Math.floor(e/(us+1)),l=Math.floor(e%(us+1));return W.box(W.types.traf,W.box(W.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),W.box(W.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255])),W.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,W.box(W.types.trak,W.tkhd(t),W.mdia(t))}static trex(t){const e=t.id;return W.box(W.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],s=i.length,a=12+16*s,l=new Uint8Array(a);let u,d,f,h,p,g;for(e+=8+a,l.set([t.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255],0),u=0;u<s;u++)d=i[u],f=d.duration,h=d.size,p=d.flags,g=d.cts,l.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*u);return W.box(W.types.trun,l)}static initSegment(t){W.types||W.init();const e=W.moov(t);return Ii(W.FTYP,e)}static hvc1(t){const e=t.params,i=[t.vps,t.sps,t.pps],s=4,a=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),s-1|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),i.length]);let l=a.length;for(let y=0;y<i.length;y+=1){l+=3;for(let S=0;S<i[y].length;S+=1)l+=2+i[y][S].length}const u=new Uint8Array(l);u.set(a,0),l=a.length;const d=i.length-1;for(let y=0;y<i.length;y+=1){u.set(new Uint8Array([32+y|(y===d?128:0),0,i[y].length]),l),l+=3;for(let S=0;S<i[y].length;S+=1)u.set(new Uint8Array([i[y][S].length>>8,i[y][S].length&255]),l),l+=2,u.set(i[y][S],l),l+=i[y][S].length}const f=W.box(W.types.hvcC,u),h=t.width,p=t.height,g=t.pixelRatio[0],v=t.pixelRatio[1];return W.box(W.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,v>>24,v>>16&255,v>>8&255,v&255])))}}W.types=void 0;W.HDLR_TYPES=void 0;W.STTS=void 0;W.STSC=void 0;W.STCO=void 0;W.STSZ=void 0;W.VMHD=void 0;W.SMHD=void 0;W.STSD=void 0;W.FTYP=void 0;W.DINF=void 0;const zx=9e4;function Vh(r,t,e=1,i=!1){const s=r*t*e;return i?Math.round(s):s}function xw(r,t,e=1,i=!1){return Vh(r,t,1/e,i)}function Xa(r,t=!1){return Vh(r,1e3,1/zx,t)}function Sw(r,t=1){return Vh(r,zx,1/t)}function hv(r){const{baseTime:t,timescale:e,trackId:i}=r;return`${t/e} (${t}/${e}) trackId: ${i}`}const Tw=10*1e3,bw=1024,Aw=1152,Rw=1536;let Ur=null,bd=null;function mv(r,t,e,i){return{duration:t,size:e,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:r?2:1,isNonSync:r?0:1}}}class iu extends Oi{constructor(t,e,i,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,Ur===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ur=l?parseInt(l[1]):0}if(bd===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);bd=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){const e=this._initPTS;(!e||!t||t.trackId!==e.trackId||t.baseTime!==e.baseTime||t.timescale!==e.timescale)&&this.log(`Reset initPTS: ${e&&hv(e)} > ${t&&hv(t)}`),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t[0].pts,s=t.reduce((a,l)=>{let u=l.pts,d=u-a;return d<-4294967296&&(e=!0,u=pi(u,i),d=u-a),d>0?a:u},i);return e&&this.debug("PTS rollover detected"),s}remux(t,e,i,s,a,l,u,d){let f,h,p,g,v,y,S=a,T=a;const A=t.pid>-1,b=e.pid>-1,R=e.samples.length,C=t.samples.length>0,D=u&&R>0||R>1;if((!A||C)&&(!b||D)||this.ISGenerated||u){if(this.ISGenerated){var w,P,B,M;const H=this.videoTrackConfig;(H&&(e.width!==H.width||e.height!==H.height||((w=e.pixelRatio)==null?void 0:w[0])!==((P=H.pixelRatio)==null?void 0:P[0])||((B=e.pixelRatio)==null?void 0:B[1])!==((M=H.pixelRatio)==null?void 0:M[1]))||!H&&D||this.nextAudioTs===null&&C)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(t,e,a,l));const q=this.isVideoContiguous;let tt=-1,V;if(D&&(tt=Lw(e.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,tt>0){this.warn(`Dropped ${tt} out of ${R} video samples due to a missing keyframe`);const H=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(tt),e.dropped+=tt,T+=(e.samples[0].pts-H)/e.inputTimeScale,V=T}else tt===-1&&(this.warn(`No keyframe found out of ${R} video samples`),y=!1);if(this.ISGenerated){if(C&&D){const H=this.getVideoStartPts(e.samples),O=(pi(t.samples[0].pts,H)-H)/e.inputTimeScale;S+=Math.max(0,O),T+=Math.max(0,-O)}if(C){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(t,e,a,l)),h=this.remuxAudio(t,S,this.isAudioContiguous,l,b||D||d===mt.AUDIO?T:void 0),D){const H=h?h.endPTS-h.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(t,e,a,l)),f=this.remuxVideo(e,T,q,H)}}else D&&(f=this.remuxVideo(e,T,q,0));f&&(f.firstKeyFrame=tt,f.independent=tt!==-1,f.firstKeyFramePTS=V)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(v=Vx(i,a,this._initPTS,this._initDTS)),s.samples.length&&(g=Kx(s,a,this._initPTS))),{audio:h,video:f,initSegment:p,independent:y,text:g,id3:v}}computeInitPts(t,e,i,s){const a=Math.round(i*e);let l=pi(t,a);if(l<a+e)for(this.log(`Adjusting PTS for rollover in timeline near ${(a-l)/e} ${s}`);l<a+e;)l+=8589934592;return l-a}generateIS(t,e,i,s){const a=t.samples,l=e.samples,u=this.typeSupported,d={},f=this._initPTS;let h=!f||s,p="audio/mp4",g,v,y,S=-1;if(h&&(g=v=1/0),t.config&&a.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":u.mpeg?(p="audio/mpeg",t.codec=""):u.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}d.audio={id:"audio",container:p,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):W.initSegment([t]),metadata:{channelCount:t.channelCount}},h&&(S=t.id,y=t.inputTimeScale,!f||y!==f.timescale?g=v=this.computeInitPts(a[0].pts,y,i,"audio"):h=!1)}if(e.sps&&e.pps&&l.length){if(e.timescale=e.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:W.initSegment([e]),metadata:{width:e.width,height:e.height}},h)if(S=e.id,y=e.inputTimeScale,!f||y!==f.timescale){const T=this.getVideoStartPts(l),A=pi(l[0].dts,T),b=this.computeInitPts(A,y,i,"video"),R=this.computeInitPts(T,y,i,"video");v=Math.min(v,b),g=Math.min(g,R)}else h=!1;this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,h?(f&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${i} ${g/y} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${g/y} (${g}/${y}) trackId: ${S}`),this._initPTS={baseTime:g,timescale:y,trackId:S},this._initDTS={baseTime:v,timescale:y,trackId:S}):g=y=void 0,{tracks:d,initPTS:g,timescale:y,trackId:S}}remuxVideo(t,e,i,s){const a=t.inputTimeScale,l=t.samples,u=[],d=l.length,f=this._initPTS,h=f.baseTime*a/f.timescale;let p=this.nextVideoTs,g=8,v=this.videoSampleDuration,y,S,T=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,b=!1;if(!i||p===null){const k=h+e*a,j=l[0].pts-pi(l[0].dts,l[0].pts);Ur&&p!==null&&Math.abs(k-j-(p+h))<15e3?i=!0:p=k-j-h}const R=p+h;for(let k=0;k<d;k++){const j=l[k];j.pts=pi(j.pts,R),j.dts=pi(j.dts,R),j.dts<l[k>0?k-1:k].dts&&(b=!0)}b&&l.sort(function(k,j){const st=k.dts-j.dts,ct=k.pts-j.pts;return st||ct}),y=l[0].dts,S=l[l.length-1].dts;const C=S-y,D=C?Math.round(C/(d-1)):v||t.inputTimeScale/30;if(i){const k=y-R,j=k>D,st=k<-1;if((j||st)&&(j?this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Xa(k,!0)} ms (${k}dts) hole between fragments detected at ${e.toFixed(3)}`):this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Xa(-k,!0)} ms (${k}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!st||R>=l[0].pts||Ur)){y=R;const ct=l[0].pts-k;if(j)l[0].dts=y,l[0].pts=ct;else{let ft=!0;for(let dt=0;dt<l.length&&!(l[dt].dts>ct&&ft);dt++){const Et=l[dt].pts;if(l[dt].dts-=k,l[dt].pts-=k,dt<l.length-1){const Lt=l[dt+1].pts,_t=l[dt].pts,ie=Lt<=_t,pe=Lt<=Et;ft=ie==pe}}}this.log(`Video: Initial PTS/DTS adjusted: ${Xa(ct,!0)}/${Xa(y,!0)}, delta: ${Xa(k,!0)} ms`)}}y=Math.max(0,y);let N=0,w=0,P=y;for(let k=0;k<d;k++){const j=l[k],st=j.units,ct=st.length;let ft=0;for(let dt=0;dt<ct;dt++)ft+=st[dt].data.length;w+=ft,N+=ct,j.length=ft,j.dts<P?(j.dts=P,P+=D/4|0||1):P=j.dts,T=Math.min(j.pts,T),A=Math.max(j.pts,A)}S=l[d-1].dts;const B=w+4*N+8;let M;try{M=new Uint8Array(B)}catch(k){this.observer.emit(_.ERROR,_.ERROR,{type:vt.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:B,reason:`fail allocating video mdat ${B}`});return}const q=new DataView(M.buffer);q.setUint32(0,B),M.set(W.types.mdat,4);let tt=!1,V=Number.POSITIVE_INFINITY,H=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let k=0;k<d;k++){const j=l[k],st=j.units;let ct=0;for(let Et=0,Lt=st.length;Et<Lt;Et++){const _t=st[Et],ie=_t.data,pe=_t.data.byteLength;q.setUint32(g,pe),g+=4,M.set(ie,g),g+=pe,ct+=4+pe}let ft;if(k<d-1)v=l[k+1].dts-j.dts,ft=l[k+1].pts-j.pts;else{const Et=this.config,Lt=k>0?j.dts-l[k-1].dts:D;if(ft=k>0?j.pts-l[k-1].pts:D,Et.stretchShortVideoTrack&&this.nextAudioTs!==null){const _t=Math.floor(Et.maxBufferHole*a),ie=(s?T+s*a:this.nextAudioTs+h)-j.pts;ie>_t?(v=ie-Lt,v<0?v=Lt:tt=!0,this.log(`It is approximately ${ie/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=Lt}else v=Lt}const dt=Math.round(j.pts-j.dts);V=Math.min(V,v),X=Math.max(X,v),H=Math.min(H,ft),O=Math.max(O,ft),u.push(mv(j.key,v,ct,dt))}if(u.length){if(Ur){if(Ur<70){const k=u[0].flags;k.dependsOn=2,k.isNonSync=0}}else if(bd&&O-H<X-V&&D/X<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let k=y;for(let j=0,st=u.length;j<st;j++){const ct=k+u[j].duration,ft=k+u[j].cts;if(j<st-1){const dt=ct+u[j+1].cts;u[j].duration=dt-ft}else u[j].duration=j?u[j-1].duration:D;u[j].cts=0,k=ct}}}v=tt||!v?D:v;const G=S+v;this.nextVideoTs=p=G-h,this.videoSampleDuration=v,this.isVideoContiguous=!0;const ut={data1:W.moof(t.sequenceNumber++,y,Wt(t,{samples:u})),data2:M,startPTS:(T-h)/a,endPTS:(A+v-h)/a,startDTS:(y-h)/a,endDTS:p/a,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:t.dropped};return t.samples=[],t.dropped=0,ut}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return Aw;case"ac3":return Rw;default:return bw}}remuxAudio(t,e,i,s,a){const l=t.inputTimeScale,u=t.samplerate?t.samplerate:l,d=l/u,f=this.getSamplesPerFrame(t),h=f*d,p=this._initPTS,g=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],y=a!==void 0;let S=t.samples,T=g?0:8,A=this.nextAudioTs||-1;const b=p.baseTime*l/p.timescale,R=b+e*l;if(this.isAudioContiguous=i=i||S.length&&A>0&&(s&&Math.abs(R-(A+b))<9e3||Math.abs(pi(S[0].pts,R)-(A+b))<20*h),S.forEach(function(O){O.pts=pi(O.pts,R)}),!i||A<0){const O=S.length;if(S=S.filter(G=>G.pts>=0),O!==S.length&&this.warn(`Removed ${S.length-O} of ${O} samples (initPTS ${b} / ${l})`),!S.length)return;a===0?A=0:s&&!y?A=Math.max(0,R-b):A=S[0].pts-b}if(t.segmentCodec==="aac"){const O=this.config.maxAudioFramesDrift;for(let G=0,K=A+b;G<S.length;G++){const nt=S[G],ut=nt.pts,k=ut-K,j=Math.abs(1e3*k/l);if(k<=-O*h&&y)G===0&&(this.warn(`Audio frame @ ${(ut/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*k/l)} ms.`),this.nextAudioTs=A=ut-b,K=ut);else if(k>=O*h&&j<Tw&&y){let st=Math.round(k/h);for(K=ut-st*h;K<0&&st&&h;)st--,K+=h;G===0&&(this.nextAudioTs=A=K-b),this.warn(`Injecting ${st} audio frames @ ${((K-b)/l).toFixed(3)}s due to ${Math.round(1e3*k/l)} ms gap.`);for(let ct=0;ct<st;ct++){let ft=Ew.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);ft||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ft=nt.unit.subarray()),S.splice(G,0,{unit:ft,pts:K}),K+=h,G++}}nt.pts=K,K+=h}}let C=null,D=null,N,w=0,P=S.length;for(;P--;)w+=S[P].unit.byteLength;for(let O=0,G=S.length;O<G;O++){const K=S[O],nt=K.unit;let ut=K.pts;if(D!==null){const j=v[O-1];j.duration=Math.round((ut-D)/d)}else if(i&&t.segmentCodec==="aac"&&(ut=A+b),C=ut,w>0){w+=T;try{N=new Uint8Array(w)}catch(j){this.observer.emit(_.ERROR,_.ERROR,{type:vt.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:j,bytes:w,reason:`fail allocating audio mdat ${w}`});return}g||(new DataView(N.buffer).setUint32(0,w),N.set(W.types.mdat,4))}else return;N.set(nt,T);const k=nt.byteLength;T+=k,v.push(mv(!0,f,k,0)),D=ut}const B=v.length;if(!B)return;const M=v[v.length-1];A=D-b,this.nextAudioTs=A+d*M.duration;const q=g?new Uint8Array(0):W.moof(t.sequenceNumber++,C/d,Wt({},t,{samples:v}));t.samples=[];const tt=(C-b)/l,V=A/l,X={data1:q,data2:N,startPTS:tt,endPTS:V,startDTS:tt,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,X}}function pi(r,t){let e;if(t===null)return r;for(t<r?e=-8589934592:e=8589934592;Math.abs(r-t)>4294967296;)r+=e;return r}function Lw(r){for(let t=0;t<r.length;t++)if(r[t].key)return t;return-1}function Vx(r,t,e,i){const s=r.samples.length;if(!s)return;const a=r.inputTimeScale;for(let u=0;u<s;u++){const d=r.samples[u];d.pts=pi(d.pts-e.baseTime*a/e.timescale,t*a)/a,d.dts=pi(d.dts-i.baseTime*a/i.timescale,t*a)/a}const l=r.samples;return r.samples=[],{samples:l}}function Kx(r,t,e){const i=r.samples.length;if(!i)return;const s=r.inputTimeScale;for(let l=0;l<i;l++){const u=r.samples[l];u.pts=pi(u.pts-e.baseTime*s/e.timescale,t*s)/s}r.samples.sort((l,u)=>l.pts-u.pts);const a=r.samples;return r.samples=[],{samples:a}}class _w extends Oi{constructor(t,e,i,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,i,s){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(t,s),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:i,videoCodec:s}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:a,video:l}=this.initData=ZE(t);if(e)m_(t,e);else{const d=a||l;d!=null&&d.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${d.codec}")!`)}a&&(i=pv(a,Zt.AUDIO,this)),l&&(s=pv(l,Zt.VIDEO,this));const u={};a&&l?u.audiovideo={container:"video/mp4",codec:i+","+s,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:t,id:"main"}:a?u.audio={container:"audio/mp4",codec:i,encrypted:a.encrypted,initSegment:t,id:"audio"}:l?u.video={container:"video/mp4",codec:s,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(t,e,i,s,a,l){var u,d;let{initPTS:f,lastEndTime:h}=this;const p={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};ht(h)||(h=this.lastEndTime=a||0);const g=e.samples;if(!g.length)return p;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((u=y)!=null&&u.length||(this.generateInitSegment(g),y=this.initData),!((d=y)!=null&&d.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const S=g_(g,y,this),T=y.audio?S[y.audio.id]:null,A=y.video?S[y.video.id]:null,b=jl(A,1/0),R=jl(T,1/0),C=jl(A,0,!0),D=jl(T,0,!0);let N=a,w=0;const P=T&&(!A||!f&&R<b||f&&f.trackId===y.audio.id),B=P?T:A;if(B){const K=B.timescale,nt=B.start-a*K,ut=P?y.audio.id:y.video.id;N=B.start/K,w=P?D-R:C-b,(l||!f)&&(Cw(f,N,a,w)||K!==f.timescale)&&(f&&this.warn(`Timestamps at playlist time: ${l?"":"~"}${a} ${nt/K} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${N-a} (${nt}/${K}) trackId: ${ut}`),f=null,v.initPTS=nt,v.timescale=K,v.trackId=ut)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);f?(v.initPTS=f.baseTime,v.timescale=f.timescale,v.trackId=f.trackId):((!v.timescale||v.trackId===void 0||v.initPTS===void 0)&&(this.warn("Could not set initPTS"),v.initPTS=N,v.timescale=1,v.trackId=-1),this.initPTS=f={baseTime:v.initPTS,timescale:v.timescale,trackId:v.trackId});const M=N-f.baseTime/f.timescale,q=M+w;w>0?this.lastEndTime=q:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const tt=!!y.audio,V=!!y.video;let H="";tt&&(H+="audio"),V&&(H+="video");const X=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),O={data1:g,startPTS:M,startDTS:M,endPTS:q,endDTS:q,type:H,hasAudio:tt,hasVideo:V,nb:1,dropped:0,encrypted:X};p.audio=tt&&!V?O:void 0,p.video=V?O:void 0;const G=A?.sampleCount;if(G){const K=A.keyFrameIndex,nt=K!==-1;O.nb=G,O.dropped=K===0||this.isVideoContiguous?0:nt?K:G,O.independent=nt,O.firstKeyFrame=K,nt&&A.keyFrameStart&&(O.firstKeyFramePTS=(A.keyFrameStart-f.baseTime)/f.timescale),this.isVideoContiguous||(p.independent=nt),this.isVideoContiguous||(this.isVideoContiguous=nt),O.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${K}/${G} dropped: ${O.dropped} start: ${O.firstKeyFramePTS||"NA"}`)}return p.initSegment=v,p.id3=Vx(i,a,f,f),s.samples.length&&(p.text=Kx(s,a,f)),p}}function jl(r,t,e=!1){return r?.start!==void 0?(r.start+(e?r.duration:0))/r.timescale:t}function Cw(r,t,e,i){if(r===null)return!0;const s=Math.max(i,1),a=t-r.baseTime/r.timescale;return Math.abs(a-e)>s}function pv(r,t,e){const i=r.codec;return i&&i.length>4?i:t===Zt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?pu(i,!1):(e.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(e.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let On;try{On=self.performance.now.bind(self.performance)}catch{On=Date.now}const nu=[{demux:hw,remux:_w},{demux:ds,remux:iu},{demux:uw,remux:iu},{demux:fw,remux:iu}];nu.splice(2,0,{demux:cw,remux:iu});class gv{constructor(t,e,i,s,a,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=a,this.logger=l}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,s){const a=i.transmuxing;a.executeStart=On();let l=new Uint8Array(t);const{currentTransmuxState:u,transmuxConfig:d}=this;s&&(this.currentTransmuxState=s);const{contiguous:f,discontinuity:h,trackSwitch:p,accurateTimeOffset:g,timeOffset:v,initSegmentChange:y}=s||u,{audioCodec:S,videoCodec:T,defaultInitPts:A,duration:b,initSegmentData:R}=d,C=ww(l,e);if(C&&zr(C.method)){const P=this.getDecrypter(),B=Nh(C.method);if(P.isSync()){let M=P.softwareDecrypt(l,C.key.buffer,C.iv.buffer,B);if(i.part>-1){const tt=P.flush();M=tt&&tt.buffer}if(!M)return a.executeEnd=On(),Ad(i);l=new Uint8Array(M)}else return this.asyncResult=!0,this.decryptionPromise=P.webCryptoDecrypt(l,C.key.buffer,C.iv.buffer,B).then(M=>{const q=this.push(M,null,i);return this.decryptionPromise=null,q}),this.decryptionPromise}const D=this.needsProbing(h,p);if(D){const P=this.configureTransmuxer(l);if(P)return this.logger.warn(`[transmuxer] ${P.message}`),this.observer.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),a.executeEnd=On(),Ad(i)}(h||p||y||D)&&this.resetInitSegment(R,S,T,b,e),(h||y||D)&&this.resetInitialTimestamp(A),f||this.resetContiguity();const N=this.transmux(l,C,v,g,i);this.asyncResult=lo(N);const w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,a.executeEnd=On(),N}flush(t){const e=t.transmuxing;e.executeStart=On();const{decrypter:i,currentTransmuxState:s,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(t));const l=[],{timeOffset:u}=s;if(i){const p=i.flush();p&&l.push(this.push(p.buffer,null,t))}const{demuxer:d,remuxer:f}=this;if(!d||!f){e.executeEnd=On();const p=[Ad(t)];return this.asyncResult?Promise.resolve(p):p}const h=d.flush(u);return lo(h)?(this.asyncResult=!0,h.then(p=>(this.flushRemux(l,p,t),l))):(this.flushRemux(l,h,t),this.asyncResult?Promise.resolve(l):l)}flushRemux(t,e,i){const{audioTrack:s,videoTrack:a,id3Track:l,textTrack:u}=e,{accurateTimeOffset:d,timeOffset:f}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===mt.MAIN?"level":"track"} ${i.level}`);const h=this.remuxer.remux(s,a,l,u,f,d,!0,this.id);t.push({remuxResult:h,chunkMeta:i}),i.transmuxing.executeEnd=On()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;!e||!i||(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;!t||!e||(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,s,a){const{demuxer:l,remuxer:u}=this;!l||!u||(l.resetInitSegment(t,e,i,s),u.resetInitSegment(t,e,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,s,a){let l;return e&&e.method==="SAMPLE-AES"?l=this.transmuxSampleAes(t,e,i,s,a):l=this.transmuxUnencrypted(t,i,s,a),l}transmuxUnencrypted(t,e,i,s){const{audioTrack:a,videoTrack:l,id3Track:u,textTrack:d}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,l,u,d,e,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(t,e,i,s,a){return this.demuxer.demuxSampleAes(t,e,i).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,i,s,!1,this.id),chunkMeta:a}))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:s}=this;let a;for(let p=0,g=nu.length;p<g;p++){var l;if((l=nu[p].demux)!=null&&l.probe(t,this.logger)){a=nu[p];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,d=this.remuxer,f=a.remux,h=a.demux;(!d||!(d instanceof f))&&(this.remuxer=new f(i,e,s,this.logger)),(!u||!(u instanceof h))&&(this.demuxer=new h(i,e,s,this.logger),this.probe=h.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Mh(this.config)),t}}function ww(r,t){let e=null;return r.byteLength>0&&t?.key!=null&&t.iv!==null&&t.method!=null&&(e=t),e}const Ad=r=>({remuxResult:{},chunkMeta:r});function lo(r){return"then"in r&&r.then instanceof Function}class Dw{constructor(t,e,i,s,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=s,this.defaultInitPts=a||null}}class Iw{constructor(t,e,i,s,a,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=a,this.initSegmentChange=l}}let yv=0;class qx{constructor(t,e,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=yv++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const f=d.data,h=this.hls;if(!(!h||!(f!=null&&f.event)||f.instanceNo!==this.instanceNo))switch(f.event){case"init":{var p;const g=(p=this.workerContext)==null?void 0:p.objectURL;g&&self.URL.revokeObjectURL(g);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":{h.logger[f.data.logType]&&h.logger[f.data.logType](f.data.message);break}default:{f.data=f.data||{},f.data.frag=this.frag,f.data.part=this.part,f.data.id=this.id,h.trigger(f.event,f.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})};const a=t.config;this.hls=t,this.id=e,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const l=(d,f)=>{f=f||{},f.frag=this.frag||void 0,d===_.ERROR&&(f=f,f.parent=this.id,f.part=this.part,this.error=f.error),this.hls.trigger(d,f)};this.observer=new Uh,this.observer.on(_.FRAG_DECRYPTED,l),this.observer.on(_.ERROR,l);const u=Oy(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(a.workerPath||PC()){try{a.workerPath?(d.log(`loading Web Worker ${a.workerPath} for "${e}"`),this.workerContext=FC(a.workerPath)):(d.log(`injecting Web Worker for "${e}"`),this.workerContext=NC());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:e,config:Jt(a)})}catch(h){d.warn(`Error setting up "${e}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new gv(this.observer,u,a,"",e,t.logger)}return}}this.transmuxer=new gv(this.observer,u,a,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=yv++;const e=this.hls.config,i=Oy(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:Jt(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),BC(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,s,a,l,u,d,f,h){var p,g;f.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:y}=this,S=l?l.start:a.start,T=a.decryptdata,A=this.frag,b=!(A&&a.cc===A.cc),R=!(A&&f.level===A.level),C=A?f.sn-A.sn:-1,D=this.part?f.part-this.part.index:-1,N=C===0&&f.id>1&&f.id===A?.stats.chunkCount,w=!R&&(C===1||C===0&&(D===1||N&&D<=0)),P=self.performance.now();(R||C||a.stats.parsing.start===0)&&(a.stats.parsing.start=P),l&&(D||!w)&&(l.stats.parsing.start=P);const B=!(A&&((p=a.initSegment)==null?void 0:p.url)===((g=A.initSegment)==null?void 0:g.url)),M=new Iw(b,w,d,R,S,B);if(!w||b||B){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${f.sn}${f.part>-1?" part: "+f.part:""} ${this.id===mt.MAIN?"level":"track"}: ${f.level} id: ${f.id}
        discontinuity: ${b}
        trackSwitch: ${R}
        contiguous: ${w}
        accurateTimeOffset: ${d}
        timeOffset: ${S}
        initSegmentChange: ${B}`);const q=new Dw(i,s,e,u,h);this.configureTransmuxer(q)}if(this.frag=a,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:t,decryptdata:T,chunkMeta:f,state:M},t instanceof ArrayBuffer?[t]:[]);else if(y){const q=y.push(t,T,f,M);lo(q)?q.then(tt=>{this.handleTransmuxComplete(tt)}).catch(tt=>{this.transmuxerError(tt,f,"transmuxer-interface push error")}):this.handleTransmuxComplete(q)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){const s=i.flush(t);lo(s)?s.then(a=>{this.handleFlushResult(a,t)}).catch(a=>{this.transmuxerError(a,t,"transmuxer-interface flush error")}):this.handleFlushResult(s,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}const vv=100;class Ow extends Bh{constructor(t,e,i){super(t,e,i,"audio-stream-controller",mt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(_.BUFFER_RESET,this.onBufferReset,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(_.BUFFER_RESET,this.onBufferReset,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:a,trackId:l}){if(i===mt.MAIN){const u=e.cc,d=this.fragCurrent;if(this.initPTS[u]={baseTime:s,timescale:a,trackId:l},this.log(`InitPTS for cc: ${u} found from main: ${s/a} (${s}/${a}) trackId: ${l}`),this.mainAnchor=e,this.state===at.WAITING_INIT_PTS){const f=this.waitingData;(!f&&!this.loadingParts||f&&f.frag.cc!==u)&&this.syncWithAnchor(e,f?.frag)}else!this.hls.hasEnoughToStart&&d&&d.cc!==u?(d.abortRequests(),this.syncWithAnchor(e,d)):this.state===at.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var i;const s=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(e&&s?.cc===e.cc)return;const a=(s||t).cc,l=this.getLevelDetails(),u=this.getLoadPosition(),d=ux(l,a,u);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===at.IDLE&&this.doTickIdle())}startLoad(t,e){if(!this.levels){this.startPosition=t,this.state=at.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(vv),i>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=at.IDLE):this.state=at.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case at.IDLE:this.doTickIdle();break;case at.WAITING_TRACK:{const{levels:t,trackId:e}=this,i=t?.[e],s=i?.details;if(s&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(s))break;this.state=at.WAITING_INIT_PTS}break}case at.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case at.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:e,part:i,cache:s,complete:a}=t,l=this.mainAnchor;if(this.initPTS[e.cc]!==void 0){this.waitingData=null,this.state=at.FRAG_LOADING;const u=s.flush().buffer,d={frag:e,part:i,payload:u,networkDetails:null};this._handleFragmentLoadProgress(d),a&&super._handleFragmentLoadComplete(d)}else l&&l.cc!==t.frag.cc&&this.syncWithAnchor(l,t.frag)}else this.state=at.IDLE}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;t!=null&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:i,media:s,trackId:a}=this,l=e.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(i!=null&&i[a]))return;const u=i[a],d=u.details;if(!d||this.waitForLive(u)||this.waitForCdnTuneIn(d)){this.state=at.WAITING_TRACK,this.startFragRequested=!1;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,Zt.AUDIO,mt.AUDIO));const h=this.getFwdBufferInfo(f,mt.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,d)){e.trigger(_.BUFFER_EOS,{type:"audio"}),this.state=at.ENDED;return}const p=h.len,g=e.maxBufferLength,v=d.fragments,y=v[0].start,S=this.getLoadPosition(),T=this.flushing?S:h.end;if(this.switchingTrack&&s){const R=S;d.PTSKnown&&R<y&&(h.end>y||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=y+.05)}if(p>=g&&!this.switchingTrack&&T<v[v.length-1].start)return;let A=this.getNextFragment(T,d);if(A&&this.isLoopLoading(A,T)&&(A=this.getNextFragmentLoopLoading(A,d,h,mt.MAIN,g)),!A){this.bufferFlushed=!0;return}let b=((t=this.mainFragLoading)==null?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&Te(A)&&!A.endList&&(!d.live||!this.loadingParts&&T<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===Le.OK&&(this.mainFragLoading=b=null),b&&Te(b))){if(A.start>b.end){const C=this.fragmentTracker.getFragAtPos(T,mt.MAIN);C&&C.end>b.end&&(b=C,this.mainFragLoading={frag:C,targetBufferTime:null})}if(A.start>b.end)return}this.loadFragment(A,u,T)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(i=>new ro(i))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==at.STOPPED&&(this.setInterval(vv),this.state=at.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(_.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;const{levels:s}=this,{details:a,id:l,groupId:u,track:d}=e;if(!s){this.warn(`Audio tracks reset while loading track ${l} "${d.name}" of "${u}"`);return}const f=this.mainDetails;if(!f||a.endCC>f.endCC||f.expired){this.cachedTrackLoadedData=e,this.state!==at.STOPPED&&(this.state=at.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${d.name}" of "${u}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const h=s[l];let p=0;if(a.live||(i=h.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(h.details){var g;p=this.alignPlaylists(a,h.details,(g=this.levelLastLoaded)==null?void 0:g.details)}a.alignedSliding||(_x(a,f),a.alignedSliding||Tu(a,f),p=a.fragmentStart)}h.details=a,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(f,p),this.hls.trigger(_.AUDIO_TRACK_UPDATED,{details:a,id:l,groupId:e.groupId}),this.state===at.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=at.IDLE),this.tick()}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:s,payload:a}=t,{config:l,trackId:u,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const f=d[u];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const h=f.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const p=l.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let g=this.transmuxer;g||(g=this.transmuxer=new qx(this.hls,mt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[i.cc],y=(e=i.initSegment)==null?void 0:e.data;if(v!==void 0){const T=s?s.index:-1,A=T!==-1,b=new Ph(i.level,i.sn,i.stats.chunkCount,a.byteLength,T,A);g.push(a,y,p,"",i,s,h.totalduration,!1,b,v)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${h.startSN} ,${h.endSN}],track ${u}`);const{cache:S}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new Cx,complete:!1};S.push(new Uint8Array(a)),this.state!==at.STOPPED&&(this.state=at.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===mt.MAIN&&Te(e.frag)&&(this.mainFragLoading=e,this.state===at.IDLE&&this.tick())}onFragBuffered(t,e){const{frag:i,part:s}=e;if(i.type!==mt.AUDIO){!this.audioOnly&&i.type===mt.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Te(i)){this.fragPrevious=i;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(_.AUDIO_TRACK_SWITCHED,Vt({},a)))}this.fragBufferedComplete(i,s),this.media&&this.tick()}onError(t,e){var i;if(e.fatal){this.state=at.ERROR;return}switch(e.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.AUDIO,e);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===at.WAITING_TRACK&&((i=e.context)==null?void 0:i.type)===It.AUDIO_TRACK&&(this.state=at.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onBufferFlushing(t,{type:e}){e!==Zt.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==Zt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===at.ENDED&&(this.state=at.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,e,mt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:s}=this,{remuxResult:a,chunkMeta:l}=t,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:d,part:f,level:h}=u,{details:p}=h,{audio:g,text:v,id3:y,initSegment:S}=a;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=at.PARSING,this.switchingTrack&&g&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const T=d.initSegment||d;if(this.unhandledEncryptionError(S,d))return;this._bufferInitSegment(h,S.tracks,T,l),s.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:i,tracks:S.tracks})}if(g){const{startPTS:T,endPTS:A,startDTS:b,endDTS:R}=g;f&&(f.elementaryStreams[Zt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:R}),d.setElementaryStreamInfo(Zt.AUDIO,T,A,b,R),this.bufferFragmentData(g,d,f,l)}if(y!=null&&(e=y.samples)!=null&&e.length){const T=Wt({id:i,frag:d,details:p},y);s.trigger(_.FRAG_PARSING_METADATA,T)}if(v){const T=Wt({id:i,frag:d,details:p},v);s.trigger(_.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(t,e,i,s){if(this.state!==at.PARSING||(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio))return;const a=e.audio;a.id=mt.AUDIO;const l=t.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${l}/${a.codec}]`),l&&l.split(",").length===1&&(a.levelCodec=l),this.hls.trigger(_.BUFFER_CODECS,e);const u=a.initSegment;if(u!=null&&u.byteLength){const d={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:u};this.hls.trigger(_.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);if(this.switchingTrack||s===Le.NOT_LOADED||s===Le.PARTIAL){var a;if(!Te(t))this._loadInitSegment(t,e);else if((a=e.details)!=null&&a.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=at.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==e.details.fragmentStart&&Tu(e.details,l)}else super.loadFragment(t,e,i)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:i,assocLang:s,characteristics:a,audioCodec:l,channels:u}=this.bufferedTrack;Hs({name:e,lang:i,assocLang:s,characteristics:a,audioCodec:l,channels:u},t,js)||(yu(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(_.AUDIO_TRACK_SWITCHED,Vt({},t))}}class Kh extends Oi{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const s=e?.renditionReports;if(s){let a=-1;for(let l=0;l<s.length;l++){const u=s[l];let d;try{d=new self.URL(u.URI,e.url).href}catch(f){this.warn(`Could not construct new URL for Rendition Report: ${f}`),d=u.URI||""}if(d===t){a=l;break}else d===t.substring(0,d.length)&&(a=l)}if(a!==-1){const l=s[a],u=parseInt(l["LAST-MSN"])||e.lastPartSn;let d=parseInt(l["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(e.age-e.partTarget,e.targetduration);d>=0&&h>e.partTarget&&(d+=1)}const f=i&&ky(i);return new My(u,d>=0?d:void 0,f)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){const{details:s,stats:a}=e,l=self.performance.now(),u=a.loading.first?Math.max(0,l-a.loading.first):0;s.advancedDateTime=Date.now()-u;const d=this.hls.config.timelineOffset;if(d!==s.appliedTimelineOffset){const h=Math.max(d||0,0);s.appliedTimelineOffset=h,s.fragments.forEach(p=>{p.setStart(p.playlistOffset+h)})}if(s.live||i!=null&&i.live){const h="levelInfo"in e?e.levelInfo:e.track;if(s.reloaded(i),i&&s.fragments.length>0){AC(i,s,this);const b=s.playlistParsingError;if(b){this.warn(b);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var f;const{networkDetails:C}=e;R.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:b,reason:b.message,level:e.level||void 0,parent:(f=s.fragments[0])==null?void 0:f.type,networkDetails:C,stats:a});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=a.loading.start);const p=this.hls.mainForwardBufferInfo,g=p?p.end-p.len:0,v=(s.edge-g)*1e3,y=Tx(s,v);if(s.requestScheduled+y<l?s.requestScheduled=l:s.requestScheduled+=y,this.log(`live playlist ${t} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let S,T,A;if(s.canBlockReload&&s.endSN&&s.advanced){const b=this.hls.config.lowLatencyMode,R=s.lastPartSn,C=s.endSN,D=s.lastPartIndex,N=D!==-1,w=R===C;N?w?(T=C+1,A=b?0:D):(T=R,A=b?D+1:s.maxPartIndex):T=C+1;const P=s.age,B=P+s.ageHeader;let M=Math.min(B-s.partTarget,s.targetduration*1.5);if(M>0){if(B>s.targetduration*3)this.log(`Playlist last advanced ${P.toFixed(2)}s ago. Omitting segment and part directives.`),T=void 0,A=void 0;else if(i!=null&&i.tuneInGoal&&B-s.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${M} with playlist age: ${s.age}`),M=0;else{const q=Math.floor(M/s.targetduration);if(T+=q,A!==void 0){const tt=Math.round(M%s.targetduration/s.partTarget);A+=tt}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${P.toFixed(2)}s goal: ${M} skip sn ${q} to part ${A}`)}s.tuneInGoal=M}if(S=this.getDeliveryDirectives(s,e.deliveryDirectives,T,A),b||!w){s.requestScheduled=l,this.loadingPlaylist(h,S);return}}else(s.canBlockReload||s.canSkipUntil)&&(S=this.getDeliveryDirectives(s,e.deliveryDirectives,T,A));S&&T!==void 0&&s.canBlockReload&&(s.requestScheduled=a.loading.first+Math.max(y-u*2,y/2)),this.scheduleLoading(h,S,s)}else this.clearTimer()}scheduleLoading(t,e,i){const s=i||t.details;if(!s){this.loadingPlaylist(t,e);return}const a=self.performance.now(),l=s.requestScheduled;if(a>=l){this.loadingPlaylist(t,e);return}const u=l-a;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),u)}getDeliveryDirectives(t,e,i,s){let a=ky(t);return e!=null&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,s=e.part,a=tu.No),new My(i,s,a)}checkRetry(t){const e=t.details,i=vu(t),s=t.errorAction,{action:a,retryCount:l=0,retryConfig:u}=s||{},d=!!s&&!!u&&(a===Ue.RetryRequest||!s.resolved&&a===Ue.SendAlternateToPenaltyBox);if(d){var f;if(l>=u.maxNumRetry)return!1;if(i&&(f=t.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const h=kh(u,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${e}" in ${h}ms`)}t.levelRetry=!0,s.resolved=!0}return d}}function Yx(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(!uo(r[e].attrs,t[e].attrs))return!1;return!0}function uo(r,t,e){const i=r["STABLE-RENDITION-ID"];return i&&!e?i===t["STABLE-RENDITION-ID"]:!(e||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>r[s]!==t[s])}function eh(r,t){return t.label.toLowerCase()===r.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(r.lang||"").toLowerCase())}class kw extends Kh{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(_.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:s,details:a}=e,l=this.tracksInGroup[i];if(!l||l.groupId!==s){this.warn(`Audio track with id:${i} and group:${s} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=e.details,this.log(`Audio track ${i} "${l.name}" lang:${l.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,u)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(u=>s?.indexOf(u)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(g=>!i||i.indexOf(g.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(g=>g.default)&&(this.selectDefaultTrack=!1),u.forEach((g,v)=>{g.id=v});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const d=this.hls.config.audioPreference;if(!a&&d){const g=Zi(d,u,js);if(g>-1)a=u[g];else{const v=Zi(d,this.tracks);a=this.tracks[v]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const h={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${i?.join(",")}`),this.hls.trigger(_.AUDIO_TRACKS_UPDATED,h);const p=this.trackId;if(f!==-1&&p===-1)this.setAudioTrack(f);else if(u.length&&p===-1){var l;const g=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${u.length}`);this.warn(g.message),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:g})}}}onError(t,e){e.fatal||!e.context||e.context.type===It.AUDIO_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&Hs(t,s,js))return s;const a=Zi(t,this.tracksInGroup,js);if(a>-1){const l=this.tracksInGroup[a];return this.setAudioTrack(a),l}else if(s){let l=e.loadLevel;l===-1&&(l=e.firstAutoLevel);const u=V_(t,e.levels,i,l,js);if(u===-1)return null;e.nextLoadLevel=u}if(t.channels||t.audioCodec){const l=Zi(t,i);if(l>-1)return i[l]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length){this.warn(`Invalid audio track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t],a=s.details&&!s.details.live;if(t===this.trackId&&s===i&&a||(this.log(`Switching to audio-track ${t} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=t,this.currentTrack=s,this.hls.trigger(_.AUDIO_TRACK_SWITCHING,Vt({},s)),a))return;const l=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(l)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const s=e[i];if(!(this.selectDefaultTrack&&!s.default)&&(!t||Hs(t,s,js)))return i}if(t){const{name:i,lang:s,assocLang:a,characteristics:l,audioCodec:u,channels:d}=t;for(let f=0;f<e.length;f++){const h=e[f];if(Hs({name:i,lang:s,assocLang:a,characteristics:l,audioCodec:u,channels:d},h,js))return f}for(let f=0;f<e.length;f++){const h=e[f];if(uo(t.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<e.length;f++){const h=e[f];if(uo(t.attrs,h.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&yu(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,s=t.groupId,a=this.getUrlWithDirectives(t.url,e),l=t.details,u=l?.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(_.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:e||null,track:t})}}class Mw{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(this.queues===null||this.tracks===null)return;const s=this.queues[e];s.push(t),s.length===1&&!i&&this.executeNext(e)}appendBlocker(t){return new Promise(e=>{const i={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,t)})}prependBlocker(t){return new Promise(e=>{if(this.queues){const i={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;const i=(e=t[0])==null?void 0:e.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(t[0].execute(),t.splice(0,1))})}unblockAudio(t){if(this.queues===null)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(this.queues===null||this.tracks===null)return;const e=this.queues[t];if(e.length){const s=e[0];try{s.execute()}catch(a){var i;if(s.onError(a),this.queues===null||this.tracks===null)return;const l=(i=this.tracks[t])==null?void 0:i.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues!==null&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return((e=this.queues)==null?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return t===null||e===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(t){var e,i;return(e=this.queues)!=null&&e[t]||(i=this.tracks)!=null&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const i=(e=this.tracks)==null?void 0:e[t],s=i?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return((e=this.queues)==null?void 0:e[t].map(i=>i.label).join(", "))||""}}const Ev=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Xx="HlsJsTrackRemovedError";class Pw extends Error{constructor(t){super(t),this.name=Xx}}class Nw extends Oi{constructor(t,e){super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:s,mediaSource:a}=this;i&&this.log("Media source opened"),!(!s||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(_.MEDIA_ATTACHED,{media:s,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:s}=this;i!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${i})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=s_(ps(t.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.BUFFER_RESET,this.onBufferReset,this),t.on(_.BUFFER_APPENDING,this.onBufferAppending,this),t.on(_.BUFFER_CODECS,this.onBufferCodecs,this),t.on(_.BUFFER_EOS,this.onBufferEos,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.FRAG_PARSED,this.onFragParsed,this),t.on(_.FRAG_CHANGED,this.onFragChanged,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.BUFFER_RESET,this.onBufferReset,this),t.off(_.BUFFER_APPENDING,this.onBufferAppending,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.BUFFER_EOS,this.onBufferEos,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.FRAG_PARSED,this.onFragParsed,this),t.off(_.FRAG_CHANGED,this.onFragChanged,this),t.off(_.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const i={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const l=this.isQueued();(a||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===e?Wt(i,s.tracks):this.sourceBuffers.forEach(a=>{const[l]=a;l&&(i[l]=Wt({},this.tracks[l]),this.removeBuffer(l)),a[0]=a[1]=null}),{media:t,mediaSource:e,tracks:i}}initTracks(){const t={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=t,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let s=2;(e.audio&&!e.video||!e.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(t,e){const i=this.media=e.media;this.transferData=this.overrides=void 0;const s=ps(this.appendSource);if(s){const a=!!e.mediaSource;(a||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const l=this.mediaSource=e.mediaSource||new s;if(this.assignMediaSource(l),a)this._objectUrl=i.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{i.removeAttribute("src");const d=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||d&&l instanceof d,xv(i),Fw(i,u),i.load()}catch{i.src=u}else i.src=u}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${((e=this.transferData)==null?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${(i=t.constructor)==null?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const i=this.tracks,s=e.tracks,a=s?Object.keys(s):null,l=a?a.length:0,u=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&a&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Jt(i,(d,f)=>d==="initSegment"?void 0:f)};
transfer tracks: ${Jt(s,(d,f)=>d==="initSegment"?void 0:f)}}`),!VE(s,i)){e.mediaSource=null,e.tracks=void 0;const d=t.currentTime,f=this.details,h=Math.max(d,f?.fragments[0].start||0);if(h-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(i)}") start time: ${h} currentTime: ${d}`),this.onMediaDetaching(_.MEDIA_DETACHING,{}),this.onMediaAttaching(_.MEDIA_ATTACHING,e),t.currentTime=h;return}this.transferData=void 0,a.forEach(d=>{const f=d,h=s[f];if(h){const p=h.buffer;if(p){const g=this.fragmentTracker,v=h.id;if(g.hasFragments(v)||g.hasParts(v)){const T=At.getBuffered(p);g.detectEvictedFragments(f,T,v,null,!0)}const y=Rd(f),S=[f,p];this.sourceBuffers[y]=S,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(f),this.trackSourceBuffer(f,h)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var t;const e=(t=this.mediaSource)==null?void 0:t.readyState;return e==="open"||e==="ended"}onMediaDetaching(t,e){const i=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:a,_objectUrl:l}=this;if(a){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=a.readyState==="open";try{const d=a.sourceBuffers;for(let f=d.length;f--;)u&&d[f].abort(),a.removeSourceBuffer(d[f]);u&&a.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),i||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(s.removeAttribute("src"),this.appendSource&&xv(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(_.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(([t])=>{t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(t){var e;const i=(e=this.tracks[t])==null?void 0:e.buffer;if(this.removeBuffer(t),i)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${t}`,a)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[Rd(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Mw(this.tracks)}onBufferCodecs(t,e){var i;const s=this.tracks,a=Object.keys(e);this.log(`BUFFER_CODECS: "${a}" (current SB count ${this.sourceBufferCount})`);const l="audiovideo"in e&&(s.audio||s.video)||s.audiovideo&&("audio"in e||"video"in e),u=!l&&this.sourceBufferCount&&this.media&&a.some(d=>!s[d]);if(l||u){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${a}" SourceBuffers`);return}a.forEach(d=>{var f,h;const p=e[d],{id:g,codec:v,levelCodec:y,container:S,metadata:T,supplemental:A}=p;let b=s[d];const R=(f=this.transferData)==null||(f=f.tracks)==null?void 0:f[d],C=R!=null&&R.buffer?R:b,D=C?.pendingCodec||C?.codec,N=C?.levelCodec;b||(b=s[d]={buffer:void 0,listeners:[],codec:v,supplemental:A,container:S,levelCodec:y,metadata:T,id:g});const w=Jl(D,N),P=w?.replace(Ev,"$1");let B=Jl(v,y);const M=(h=B)==null?void 0:h.replace(Ev,"$1");B&&w&&P!==M&&(d.slice(0,5)==="audio"&&(B=pu(B,this.appendSource)),this.log(`switching codec ${D} to ${B}`),B!==(b.pendingCodec||b.codec)&&(b.pendingCodec=B),b.container=S,this.appendChangeType(d,S,B))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!e.video&&((i=e.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{const i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t},{})}appendChangeType(t,e,i){const s=`${e};codecs=${i}`,a={label:`change-type=${s}`,execute:()=>{const l=this.tracks[t];if(l){const u=l.buffer;u!=null&&u.changeType&&(this.log(`changing ${t} sourceBuffer type to ${s}`),u.changeType(s),l.codec=i,l.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${t} SourceBuffer type`,l)}};this.append(a,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const i=t.start,s=i+t.duration*.05;if(((e=this.fragmentTracker.getAppendedFrag(i,mt.MAIN))==null?void 0:e.gap)===!0)return;const l={label:"block-audio",execute:()=>{var u;const d=this.tracks.video;(this.lastVideoAppendEnd>s||d!=null&&d.buffer&&At.isBuffered(d.buffer,s)||((u=this.fragmentTracker.getAppendedFrag(s,mt.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:l,frag:t},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:i}=this,{data:s,type:a,parent:l,frag:u,part:d,chunkMeta:f,offset:h}=e,p=f.buffering[a],{sn:g,cc:v}=u,y=self.performance.now();p.start=y;const S=u.stats.buffering,T=d?d.stats.buffering:null;S.start===0&&(S.start=y),T&&T.start===0&&(T.start=y);const A=i.audio;let b=!1;a==="audio"&&A?.container==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||f.id===1||this.lastMpegAudioChunk.sn!==f.sn,this.lastMpegAudioChunk=f);const R=i.video,C=R?.buffer;if(C&&g!=="initSegment"){const w=d||u,P=this.blockedAudioAppend;if(a==="audio"&&l!=="main"&&!this.blockedAudioAppend&&!(R.ending||R.ended)){const M=w.start+w.duration*.05,q=C.buffered,tt=this.currentOp("video");!q.length&&!tt?this.blockAudio(w):!tt&&!At.isBuffered(C,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(w)}else if(a==="video"){const B=w.end;if(P){const M=P.frag.start;(B>M||B<this.lastVideoAppendEnd||At.isBuffered(C,M))&&this.unblockAudio()}this.lastVideoAppendEnd=B}}const D=(d||u).start,N={label:`append-${a}`,execute:()=>{var w;p.executeStart=self.performance.now();const P=(w=this.tracks[a])==null?void 0:w.buffer;P&&(b?this.updateTimestampOffset(P,D,.1,a,g,v):h!==void 0&&ht(h)&&this.updateTimestampOffset(P,h,1e-6,a,g,v)),this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const w=self.performance.now();p.executeEnd=p.end=w,S.first===0&&(S.first=w),T&&T.first===0&&(T.first=w);const P={};this.sourceBuffers.forEach(([B,M])=>{B&&(P[B]=At.getBuffered(M))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(_.BUFFER_APPENDED,{type:a,frag:u,part:d,chunkMeta:f,parent:u.type,timeRanges:P})},onError:w=>{var P;const B={type:vt.MEDIA_ERROR,parent:u.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:u,part:d,chunkMeta:f,error:w,err:w,fatal:!1},M=(P=this.media)==null?void 0:P.error;if(w.code===DOMException.QUOTA_EXCEEDED_ERR||w.name=="QuotaExceededError"||"quota"in w)B.details=Q.BUFFER_FULL_ERROR;else if(w.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)B.errorAction=Hr(!0);else if(w.name===Xx&&this.sourceBufferCount===0)B.errorAction=Hr(!0);else{const q=++this.appendErrors[a];this.warn(`Failed ${q}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${M||"no media error"})`),(q>=this.hls.config.appendErrorMaxRetry||M)&&(B.fatal=!0)}this.hls.trigger(_.ERROR,B)}};this.log(`queuing "${a}" append sn: ${g}${d?" p: "+d.index:""} of ${u.type===mt.MAIN?"level":"track"} ${u.level} cc: ${v}`),this.append(N,a,this.isPending(this.tracks[a]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(_.BUFFER_FLUSHED,{type:t})},onError:s=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,s)}}}onBufferFlushing(t,e){const{type:i,startOffset:s,endOffset:a}=e;i?this.append(this.getFlushOp(i,s,a),i):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,s,a),l)})}onFragParsed(t,e){const{frag:i,part:s}=e,a=[],l=s?s.elementaryStreams:i.elementaryStreams;l[Zt.AUDIOVIDEO]?a.push("audiovideo"):(l[Zt.AUDIO]&&a.push("audio"),l[Zt.VIDEO]&&a.push("video"));const u=()=>{const d=self.performance.now();i.stats.buffering.end=d,s&&(s.stats.buffering.end=d);const f=s?s.stats:i.stats;this.hls.trigger(_.FRAG_BUFFERED,{frag:i,part:s,stats:f,id:i.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(u,a).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([t])=>{if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1})}onBufferEos(t,e){var i;this.sourceBuffers.forEach(([l])=>{if(l){const u=this.tracks[l];(!e.type||e.type===l)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${l} buffer reached EOS`)))}});const s=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var u;return l&&!((u=this.tracks[l])!=null&&u.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(_.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(_.BUFFERED_TO_END,void 0)):e.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([t])=>{if(t!==null){const e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)})}onError(t,e){if(e.details===Q.BUFFER_APPEND_ERROR&&e.frag){var i;const s=(i=e.errorAction)==null?void 0:i.nextAutoLevel;ht(s)&&s!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||e===null||!this.sourceBufferCount)return;const s=t.config,a=i.currentTime,l=e.levelTargetDuration,u=e.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(ht(u)&&u>=0){const f=Math.max(u,l),h=Math.floor(a/l)*l-f;this.flushBackBuffer(a,l,h)}const d=s.frontBufferFlushThreshold;if(ht(d)&&d>0){const f=Math.max(s.maxBufferLength,d),h=Math.max(f,l),p=Math.floor(a/l)*l+h;this.flushFrontBuffer(a,l,p)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach(([s,a])=>{if(a){const u=At.getBuffered(a);if(u.length>0&&i>u.start(0)){var l;this.hls.trigger(_.BACK_BUFFER_REACHED,{bufferEnd:i});const d=this.tracks[s];if((l=this.details)!=null&&l.live)this.hls.trigger(_.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(d!=null&&d.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:s})}}})}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach(([s,a])=>{if(a){const l=At.getBuffered(a),u=l.length;if(u<2)return;const d=l.start(u-1),f=l.end(u-1);if(i>d||t>=d&&t<=f)return;this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:s})}})}getDurationAndRange(){var t;const{details:e,mediaSource:i}=this;if(!e||!this.media||i?.readyState!=="open")return null;const s=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&i.setLiveSeekableRange){const f=Math.max(0,e.fragmentStart),h=Math.max(f,s);return{duration:1/0,start:f,end:h}}return{duration:1/0}}const a=(t=this.overrides)==null?void 0:t.duration;if(a)return ht(a)?{duration:a}:null;const l=this.media.duration,u=ht(i.duration)?i.duration:0;return s>u&&s>l||!ht(l)?{duration:s}:null}updateMediaSource({duration:t,start:e,end:i}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==t&&(ht(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),s.duration=t),e!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${e}-${i}.`),s.setLiveSeekableRange(e,i)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${Jt(i)}`),this.tracksReady){var s;const a=(s=this.transferData)==null?void 0:s.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach(([e,i])=>{if(e){const s=this.tracks[e];t[e]={buffer:i,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(_.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in t){const l=a,u=t[l];if(this.isPending(u)){const d=this.getTrackCodec(u,l),f=`${u.container};codecs=${d}`;u.codec=d,this.log(`creating sourceBuffer(${f})${this.currentOp(l)?" Queued":""} ${Jt(u)}`);try{const h=i.addSourceBuffer(f),p=Rd(l),g=[l,h];e[p]=g,u.buffer=h}catch(h){var s;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(l),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[l],this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:l,mimeType:f,parent:u.id});return}this.trackSourceBuffer(l,u)}}this.bufferCreated()}getTrackCodec(t,e){const i=t.supplemental;let s=t.codec;i&&(e==="video"||e==="audiovideo")&&no(i,"video")&&(s=L_(s,i));const a=Jl(s,t.levelCodec);return a?e.slice(0,5)==="audio"?pu(a,this.appendSource):a:""}trackSourceBuffer(t,e){const i=e.buffer;if(!i)return;const s=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:s,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(a,l)=>{const u=l.removedRanges;u!=null&&u.length&&this.hls.trigger(_.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var t,e;const i=((t=this.media)==null||(e=t.querySelector)==null?void 0:e.call(t,"source"))||this.media;return i?.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if(((e=this.mediaSource)==null?void 0:e.readyState)==="closed"){this.resetBuffer(t);return}const i=this.currentOp(t);i&&(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;const s=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${s}`,e),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:s,fatal:!1});const a=this.currentOp(t);a&&a.onError(s)}updateTimestampOffset(t,e,i,s,a,l){const u=e-t.timestampOffset;Math.abs(u)>=i&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${e} (sn: ${a} cc: ${l})`),t.timestampOffset=e)}removeExecutor(t,e,i){const{media:s,mediaSource:a}=this,l=this.tracks[t],u=l?.buffer;if(!s||!a||!u){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(t);return}const d=ht(s.duration)?s.duration:1/0,f=ht(a.duration)?a.duration:1/0,h=Math.max(0,e),p=Math.min(i,d,f);p>h&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${h},${p}] from the ${t} SourceBuffer`),u.remove(h,p)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.tracks[e],s=i?.buffer;if(!s)throw new Pw(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,s.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([t,e])=>t&&e.updating)}isQueued(){return this.sourceBuffers.some(([t])=>t&&!!this.currentOp(t))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:i}=this,s=e.map(l=>this.appendBlocker(l));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(l=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(e=>{var i;const s=(i=this.tracks[e])==null?void 0:i.buffer;!s||s.updating||this.shiftAndExecuteNext(e)})}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,[e])=>t+(e?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([t])=>t).filter(t=>!!t)}addBufferListener(t,e,i){const s=this.tracks[t];if(!s)return;const a=s.buffer;if(!a)return;const l=i.bind(this,t);s.listeners.push({event:e,listener:l}),a.addEventListener(e,l)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const i=e.buffer;i&&(e.listeners.forEach(s=>{i.removeEventListener(s.event,s.listener)}),e.listeners.length=0)}}function xv(r){const t=r.querySelectorAll("source");[].slice.call(t).forEach(e=>{r.removeChild(e)})}function Fw(r,t){const e=self.document.createElement("source");e.type="video/mp4",e.src=t,r.appendChild(e)}function Rd(r){return r==="audio"?1:0}class qh{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.BUFFER_CODECS,this.onBufferCodecs,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&ht(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter((s,a)=>this.isLevelAllowed(s)&&a<=t);return this.clientRect=null,qh.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,!e.width&&!e.height&&(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch{}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(i=>t.bitrate===i.bitrate&&t.width===i.width&&t.height===i.height)}static getMaxLevelByMediaSize(t,e,i){if(!(t!=null&&t.length))return-1;const s=(u,d)=>d?u.width!==d.width||u.height!==d.height:!0;let a=t.length-1;const l=Math.max(e,i);for(let u=0;u<t.length;u+=1){const d=t[u];if((d.width>=l||d.height>=l)&&s(d,t[u+1])){a=u;break}}return a}}const Bw={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ni=Bw,Uw={HLS:"h"},$w=Uw;class sn{constructor(t,e){Array.isArray(t)&&(t=t.map(i=>i instanceof sn?i:new sn(i))),this.value=t,this.params=e}}const jw="Dict";function Gw(r){return Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":typeof r=="object"?JSON.stringify(r):String(r)}function Hw(r,t,e,i){return new Error(`failed to ${r} "${Gw(t)}" as ${e}`,{cause:i})}function rn(r,t,e){return Hw("serialize",r,t,e)}class Wx{constructor(t){this.description=t}}const Sv="Bare Item",zw="Boolean";function Vw(r){if(typeof r!="boolean")throw rn(r,zw);return r?"?1":"?0"}function Kw(r){return btoa(String.fromCharCode(...r))}const qw="Byte Sequence";function Yw(r){if(ArrayBuffer.isView(r)===!1)throw rn(r,qw);return`:${Kw(r)}:`}const Xw="Integer";function Ww(r){return r<-999999999999999||999999999999999<r}function Qx(r){if(Ww(r))throw rn(r,Xw);return r.toString()}function Qw(r){return`@${Qx(r.getTime()/1e3)}`}function Zx(r,t){if(r<0)return-Zx(-r,t);const e=Math.pow(10,t);if(Math.abs(r*e%1-.5)<Number.EPSILON){const s=Math.floor(r*e);return(s%2===0?s:s+1)/e}else return Math.round(r*e)/e}const Zw="Decimal";function Jw(r){const t=Zx(r,3);if(Math.floor(Math.abs(t)).toString().length>12)throw rn(r,Zw);const e=t.toString();return e.includes(".")?e:`${e}.0`}const tD="String",eD=/[\x00-\x1f\x7f]+/;function iD(r){if(eD.test(r))throw rn(r,tD);return`"${r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function nD(r){return r.description||r.toString().slice(7,-1)}const sD="Token";function Tv(r){const t=nD(r);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw rn(t,sD);return t}function ih(r){switch(typeof r){case"number":if(!ht(r))throw rn(r,Sv);return Number.isInteger(r)?Qx(r):Jw(r);case"string":return iD(r);case"symbol":return Tv(r);case"boolean":return Vw(r);case"object":if(r instanceof Date)return Qw(r);if(r instanceof Uint8Array)return Yw(r);if(r instanceof Wx)return Tv(r);default:throw rn(r,Sv)}}const rD="Key";function nh(r){if(/^[a-z*][a-z0-9\-_.*]*$/.test(r)===!1)throw rn(r,rD);return r}function Yh(r){return r==null?"":Object.entries(r).map(([t,e])=>e===!0?`;${nh(t)}`:`;${nh(t)}=${ih(e)}`).join("")}function Jx(r){return r instanceof sn?`${ih(r.value)}${Yh(r.params)}`:ih(r)}function aD(r){return`(${r.value.map(Jx).join(" ")})${Yh(r.params)}`}function oD(r,t={whitespace:!0}){if(typeof r!="object"||r==null)throw rn(r,jw);const e=r instanceof Map?r.entries():Object.entries(r),i=t?.whitespace?" ":"";return Array.from(e).map(([s,a])=>{a instanceof sn||(a=new sn(a));let l=nh(s);return a.value===!0?l+=Yh(a.params):(l+="=",Array.isArray(a.value)?l+=aD(a):l+=Jx(a)),l}).join(`,${i}`)}function tS(r,t){return oD(r,t)}const Yi="CMCD-Object",he="CMCD-Request",Us="CMCD-Session",cs="CMCD-Status",lD={br:Yi,ab:Yi,d:Yi,ot:Yi,tb:Yi,tpb:Yi,lb:Yi,tab:Yi,lab:Yi,url:Yi,pb:he,bl:he,tbl:he,dl:he,ltc:he,mtp:he,nor:he,nrr:he,rc:he,sn:he,sta:he,su:he,ttfb:he,ttfbb:he,ttlb:he,cmsdd:he,cmsds:he,smrt:he,df:he,cs:he,ts:he,cid:Us,pr:Us,sf:Us,sid:Us,st:Us,v:Us,msd:Us,bs:cs,bsd:cs,cdn:cs,rtp:cs,bg:cs,pt:cs,ec:cs,e:cs},uD={REQUEST:he};function cD(r){return Object.keys(r).reduce((t,e)=>{var i;return(i=r[e])===null||i===void 0||i.forEach(s=>t[s]=e),t},{})}function fD(r,t){const e={};if(!r)return e;const i=Object.keys(r),s=t?cD(t):{};return i.reduce((a,l)=>{var u;const d=lD[l]||s[l]||uD.REQUEST,f=(u=a[d])!==null&&u!==void 0?u:a[d]={};return f[l]=r[l],a},e)}function dD(r){return["ot","sf","st","e","sta"].includes(r)}function hD(r){return typeof r=="number"?ht(r):r!=null&&r!==""&&r!==!1}const eS="event";function mD(r,t){const e=new URL(r),i=new URL(t);if(e.origin!==i.origin)return r;const s=e.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);for(;s[0]===a[0];)s.shift(),a.shift();for(;a.length;)a.shift(),s.unshift("..");return s.join("/")+e.search+e.hash}const su=r=>Math.round(r),sh=(r,t)=>Array.isArray(r)?r.map(e=>sh(e,t)):r instanceof sn&&typeof r.value=="string"?new sn(sh(r.value,t),r.params):(t.baseUrl&&(r=mD(r,t.baseUrl)),t.version===1?encodeURIComponent(r):r),Gl=r=>su(r/100)*100,pD=(r,t)=>{let e=r;return t.version>=2&&(r instanceof sn&&typeof r.value=="string"?e=new sn([r]):typeof r=="string"&&(e=[r])),sh(e,t)},gD={br:su,d:su,bl:Gl,dl:Gl,mtp:Gl,nor:pD,rtp:Gl,tb:su},iS="request",nS="response",Xh=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],yD=["e"],vD=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Fu(r){return vD.test(r)}function ED(r){return Xh.includes(r)||yD.includes(r)||Fu(r)}const sS=["d","dl","nor","ot","rtp","su"];function xD(r){return Xh.includes(r)||sS.includes(r)||Fu(r)}const SD=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function TD(r){return Xh.includes(r)||sS.includes(r)||SD.includes(r)||Fu(r)}const bD=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function AD(r){return bD.includes(r)||Fu(r)}const RD={[nS]:TD,[eS]:ED,[iS]:xD};function rS(r,t={}){const e={};if(r==null||typeof r!="object")return e;const i=t.version||r.v||1,s=t.reportingMode||iS,a=i===1?AD:RD[s];let l=Object.keys(r).filter(a);const u=t.filter;typeof u=="function"&&(l=l.filter(u));const d=s===nS||s===eS;d&&!l.includes("ts")&&l.push("ts"),i>1&&!l.includes("v")&&l.push("v");const f=Wt({},gD,t.formatters),h={version:i,reportingMode:s,baseUrl:t.baseUrl};return l.sort().forEach(p=>{let g=r[p];const v=f[p];if(typeof v=="function"&&(g=v(g,h)),p==="v"){if(i===1)return;g=i}p=="pr"&&g===1||(d&&p==="ts"&&!ht(g)&&(g=Date.now()),hD(g)&&(dD(p)&&typeof g=="string"&&(g=new Wx(g)),e[p]=g))}),e}function LD(r,t={}){const e={};if(!r)return e;const i=rS(r,t),s=fD(i,t?.customHeaderMap);return Object.entries(s).reduce((a,[l,u])=>{const d=tS(u,{whitespace:!1});return d&&(a[l]=d),a},e)}function _D(r,t,e){return Wt(r,LD(t,e))}const CD="CMCD";function wD(r,t={}){return r?tS(rS(r,t),{whitespace:!1}):""}function DD(r,t={}){if(!r)return"";const e=wD(r,t);return encodeURIComponent(e)}function ID(r,t={}){if(!r)return"";const e=DD(r,t);return`${CD}=${e}`}const bv=/CMCD=[^&#]+/;function OD(r,t,e){const i=ID(t,e);if(!i)return r;if(bv.test(r))return r.replace(bv,i);const s=r.includes("?")?"&":"?";return`${r}${s}${i}`}class kD{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:ni.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=s=>{try{const{frag:a,part:l}=s,u=this.hls.levels[a.level],d=this.getObjectType(a),f={d:(l||a).duration*1e3,ot:d};(d===ni.VIDEO||d===ni.AUDIO||d==ni.MUXED)&&(f.br=u.bitrate/1e3,f.tb=this.getTopBandwidth(d)/1e3,f.bl=this.getBufferLength(d));const h=l?this.getNextPart(l):this.getNextFrag(a);h!=null&&h.url&&h.url!==a.url&&(f.nor=h.url),this.apply(s,f)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;i!=null&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHED,this.onMediaDetached,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHED,this.onMediaDetached,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,s;this.audioBuffer=(i=e.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(s=e.tracks.video)==null?void 0:s.buffer}createData(){var t;return{v:1,sf:$w.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){Wt(e,this.createData());const i=e.ot===ni.INIT||e.ot===ni.VIDEO||e.ot===ni.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),e.su==null&&(e.su=this.buffering);const{includeKeys:s}=this;s&&(e=Object.keys(e).reduce((l,u)=>(s.includes(u)&&(l[u]=e[u]),l),{}));const a={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),_D(t.headers,e,a)):t.url=OD(t.url,e,a)}getNextFrag(t){var e;const i=(e=this.hls.levels[t.level])==null?void 0:e.details;if(i){const s=t.sn-i.startSN;return i.fragments[s+1]}}getNextPart(t){var e;const{index:i,fragment:s}=t,a=(e=this.hls.levels[s.level])==null||(e=e.details)==null?void 0:e.partList;if(a){const{sn:l}=s;for(let u=a.length-1;u>=0;u--){const d=a[u];if(d.index===i&&d.fragment.sn===l)return a[u+1]}}}getObjectType(t){const{type:e}=t;if(e==="subtitle")return ni.TIMED_TEXT;if(t.sn==="initSegment")return ni.INIT;if(e==="audio")return ni.AUDIO;if(e==="main")return this.hls.audioTracks.length?ni.VIDEO:ni.MUXED}getTopBandwidth(t){let e=0,i;const s=this.hls;if(t===ni.AUDIO)i=s.audioTracks;else{const a=s.maxAutoLevel,l=a>-1?a+1:s.levels.length;i=s.levels.slice(0,l)}return i.forEach(a=>{a.bitrate>e&&(e=a.bitrate)}),e>0?e:NaN}getBufferLength(t){const e=this.media,i=t===ni.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!e?NaN:At.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){e(a),this.loader.load(a,l,u)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){e(a),this.loader.load(a,l,u)}}}}const MD=3e5;class PD extends Oi{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(t.indexOf(e.pathwayId)===-1&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter(i=>i!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if(i?.action===Ue.SendAlternateToPenaltyBox&&i.flags===mi.MoveAllAlternatesMatchingHost){const s=this.levels;let a=this._pathwayPriority,l=this.pathwayId;if(e.context){const{groupId:u,pathwayId:d,type:f}=e.context;u&&s?l=this.getPathwayForGroupId(u,f,l):d&&(l=d)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!a&&s&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),i.resolved=this.pathwayId!==l),e.details===Q.BUFFER_APPEND_ERROR&&!e.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${l} levels: ${s&&s.length} priorities: ${Jt(a)} penalized: ${Jt(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(e.length===0){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){this._pathwayPriority=t;let e;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach(a=>{s-i[a]>MD&&delete i[a]});for(let a=0;a<t.length;a++){const l=t[a];if(l in i)continue;if(l===this.pathwayId)return;const u=this.hls.nextLoadLevel,d=this.hls.levels[u];if(e=this.getLevelsForPathway(l),e.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,Rx(e),this.hls.trigger(_.LEVELS_UPDATED,{levels:e});const f=this.hls.levels[u];d&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(t,e,i){const s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let a=0;a<s.length;a++)if(e===It.AUDIO_TRACK&&s[a].hasAudioGroup(t)||e===It.SUBTITLE_TRACK&&s[a].hasSubtitleGroup(t))return s[a].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},s={};t.forEach(a=>{const{ID:l,"BASE-ID":u,"URI-REPLACEMENT":d}=a;if(e.some(h=>h.pathwayId===l))return;const f=this.getLevelsForPathway(u).map(h=>{const p=new re(h.attrs);p["PATHWAY-ID"]=l;const g=p.AUDIO&&`${p.AUDIO}_clone_${l}`,v=p.SUBTITLES&&`${p.SUBTITLES}_clone_${l}`;g&&(i[p.AUDIO]=g,p.AUDIO=g),v&&(s[p.SUBTITLES]=v,p.SUBTITLES=v);const y=aS(h.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),S=new ro({attrs:p,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:y,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let T=1;T<h.audioGroups.length;T++)S.addGroupId("audio",`${h.audioGroups[T]}_clone_${l}`);if(h.subtitleGroups)for(let T=1;T<h.subtitleGroups.length;T++)S.addGroupId("text",`${h.subtitleGroups[T]}_clone_${l}`);return S});e.push(...f),Av(this.audioTracks,i,d,l),Av(this.subtitleTracks,s,d,l)})}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;this.loader&&this.loader.destroy(),this.loader=new i(e);let s;try{s=new self.URL(t)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(s.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+h)}const a={responseType:"json",url:s.href},l=e.steeringManifestLoadPolicy.default,u=l.errorRetry||l.timeoutRetry||{},d={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},f={onSuccess:(h,p,g,v)=>{this.log(`Loaded steering manifest: "${s}"`);const y=h.data;if(y?.VERSION!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":A}=y;if(S)try{this.uri=new self.URL(S,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||g.url),T&&this.clonePathways(T);const b={steeringManifest:y,url:s.toString()};this.hls.trigger(_.STEERING_MANIFEST_LOADED,b),A&&this.updatePathwayPriority(A)},onError:(h,p,g,v)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${p.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let y=this.timeToLoad*1e3;if(h.code===429){const S=this.loader;if(typeof S?.getResponseHeader=="function"){const T=S.getResponseHeader("Retry-After");T&&(y=parseFloat(T)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,y)},onTimeout:(h,p,g)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(a,d,f)}scheduleRefresh(t,e=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const s=(i=this.hls)==null?void 0:i.media;if(s&&!s.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},e)}}function Av(r,t,e,i){r&&Object.keys(t).forEach(s=>{const a=r.filter(l=>l.groupId===s).map(l=>{const u=Wt({},l);return u.details=void 0,u.attrs=new re(u.attrs),u.url=u.attrs.URI=aS(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",e),u.groupId=u.attrs["GROUP-ID"]=t[s],u.attrs["PATHWAY-ID"]=i,u});r.push(...a)})}function aS(r,t,e,i){const{HOST:s,PARAMS:a,[e]:l}=i;let u;t&&(u=l?.[t],u&&(r=u));const d=new self.URL(r);return s&&!u&&(d.host=s),a&&Object.keys(a).sort().forEach(f=>{f&&d.searchParams.set(f,a[f])}),d.href}class Vr extends Oi{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Vr.CDMCleanupPromise?[Vr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=e=>{const{initDataType:i,initData:s}=e,a=`"${e.type}" event: init data type: "${i}"`;if(this.debug(a),s!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Wa(this.config));const u=l.map(yd).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(l=>{const u=eu(l);if(i!=="sinf"||u!==ae.FAIRPLAY){this.log(`Ignoring "${e.type}" event with init data type: "${i}" for selected key-system ${u}`);return}let d;try{const v=Re(new Uint8Array(s)),y=Fh(JSON.parse(v).sinf),S=tx(y);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(S.subarray(8,24))}catch(v){this.warn(`${a} Failed to parse sinf: ${v}`);return}const f=qe(d),{keyIdToKeySessionPromise:h,mediaKeySessions:p}=this;let g=h[f];for(let v=0;v<p.length;v++){const y=p[v],S=y.decryptdata;if(!S.keyId)continue;const T=qe(S.keyId);if(xu(d,S.keyId)||S.uri.replace(/-/g,"").indexOf(f)!==-1){if(g=h[T],!g)continue;if(S.pssh)break;delete h[T],S.pssh=new Uint8Array(s),S.keyId=d,g=h[f]=g.then(()=>this.generateRequestWithPreferredKeySession(y,i,s,"encrypted-event-key-match")),g.catch(A=>this.handleError(A));break}}g||this.handleError(new Error(`Key ID ${f} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(l=>this.handleError(l))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(_.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(_.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:i}=this.config,s=e?.[t];if(s)return s.licenseUrl;if(t===ae.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(e===void 0)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,i=e?.[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,i=(l,u,d)=>!!l&&d.indexOf(l)===u,s=e.map(l=>l.audioCodec).filter(i),a=e.map(l=>l.videoCodec).filter(i);return s.length+a.length===0&&a.push("avc1.42e01e"),new Promise((l,u)=>{const d=f=>{const h=f.shift();this.getMediaKeysPromise(h,s,a).then(p=>l({keySystem:h,mediaKeys:p})).catch(p=>{f.length?d(f):p instanceof hi?u(p):u(new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(t)})}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${i}`;return yx===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return i(t,e)}getMediaKeysPromise(t,e,i){var s;const a=pC(t,e,i,this.config.drmSystemOptions||{});let l=this.keySystemAccessPromises[t],u=(s=l)==null?void 0:s.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${t}" key-system access with config: ${Jt(a)}`),u=this.requestMediaKeySystemAccess(t,a);const d=l=this.keySystemAccessPromises[t]={keySystemAccess:u};return u.catch(f=>{this.log(`Failed to obtain access to key-system "${t}": ${f}`)}),u.then(f=>{this.log(`Access for key-system "${f.keySystem}" obtained`);const h=this.fetchServerCertificate(t);this.log(`Create media-keys for "${t}"`);const p=d.mediaKeys=f.createMediaKeys().then(g=>(this.log(`Media-keys created for "${t}"`),d.hasMediaKeys=!0,h.then(v=>v?this.setMediaKeysServerCertificate(g,t,v):g)));return p.catch(g=>{this.error(`Failed to create media-keys for "${t}"}: ${g}`)}),p})}return u.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:i}){this.log(`Creating key-system session "${e}" keyId: ${qe(t.keyId||[])} keyUri: ${t.uri}`);const s=i.createSession(),a={decryptdata:t,keySystem:e,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const i=this.createMediaKeySessionContext(t),s=Hl(e),a="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,a,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}updateKeySession(t,e){const i=t.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${qe(t.decryptdata.keyId||[])}
      } (data length: ${e.byteLength})`),i.update(e)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(t=>({keySystem:t,hasMediaKeys:this.keySystemAccessPromises[t].hasMediaKeys})).filter(({hasMediaKeys:t})=>!!t).map(({keySystem:t})=>yd(t)).filter(t=>!!t)}getKeySystemAccess(t){return this.getKeySystemSelectionPromise(t).then(({keySystem:e,mediaKeys:i})=>this.attemptSetMediaKeys(e,i))}selectKeySystem(t){return new Promise((e,i)=>{this.getKeySystemSelectionPromise(t).then(({keySystem:s})=>{const a=yd(s);a?e(a):i(new Error(`Unable to find format for key-system "${s}"`))}).catch(i)})}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){const e=Wa(this.config),i=t.map(eu).filter(s=>!!s&&e.indexOf(s)!==-1);return this.selectKeySystem(i)}getKeyStatus(t){const{mediaKeySessions:e}=this;for(let i=0;i<e.length;i++){const s=ND(t,e[i]);if(s)return s}}loadKey(t){const e=t.keyInfo.decryptdata,i=Hl(e),s=this.bannedKeyIds[i];if(s||this.getKeyStatus(e)==="internal-error"){const u=Rv(s||"internal-error",e);return this.handleError(u,t.frag),Promise.reject(u)}const a=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${a}`);const l=this.keyIdToKeySessionPromise[i];if(!l){const u=this.getKeySystemForKeyPromise(e).then(({keySystem:d,mediaKeys:f})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${a}`),this.attemptSetMediaKeys(d,f).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:d,mediaKeys:f,decryptdata:e}))))).then(d=>{const f="cenc",h=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(d,f,h,"playlist-key")});return u.catch(d=>this.handleError(d,t.frag)),this.keyIdToKeySessionPromise[i]=u,u}return l.catch(u=>{if(u instanceof hi){const d=Vt({},u.data);this.getKeyStatus(e)==="internal-error"&&(d.decryptdata=e);const f=new hi(d,u.message);this.handleError(f,t.frag)}}),l}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t,e){if(this.hls)if(t instanceof hi){e&&(t.data.frag=e);const i=t.data.decryptdata;this.error(`${t.message}${i?` (${qe(i.keyId||[])})`:""}`),this.hls.trigger(_.ERROR,t.data)}else this.error(t.message),this.hls.trigger(_.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0})}getKeySystemForKeyPromise(t){const e=Hl(t),i=this.keyIdToKeySessionPromise[e];if(!i){const s=eu(t.keyFormat),a=s?[s]:Wa(this.config);return this.attemptKeySystemAccess(a)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=Wa(this.config)),t.length===0)throw new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Jt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){if(this.mediaResolved=void 0,this.mediaKeys===e)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const s=Promise.all(i).then(()=>this.media?this.media.setMediaKeys(e):new Promise((a,l)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return l(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=e,this.media.setMediaKeys(e).then(a).catch(l)}}));return this.mediaKeys=e,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>i.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(t,e,i,s){var a;const l=(a=this.config.drmSystems)==null||(a=a[t.keySystem])==null?void 0:a.generateRequest;if(l)try{const y=l.call(this.hls,e,i,t);if(!y)throw new Error("Invalid response from configured generateRequest filter");e=y.initDataType,i=y.initData?y.initData:null,t.decryptdata.pssh=i?new Uint8Array(i):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(i===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);const u=Hl(t.decryptdata),d=t.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${u} URI: ${d} (init data type: ${e} length: ${i.byteLength})`);const f=new Uh,h=t._onmessage=y=>{const S=t.mediaKeysSession;if(!S){f.emit("error",new Error("invalid state"));return}const{messageType:T,message:A}=y;this.log(`"${T}" message event for session "${S.sessionId}" message size: ${A.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(t,A).catch(b=>{f.eventNames().length?f.emit("error",b):this.handleError(b)}):T==="license-release"?t.keySystem===ae.FAIRPLAY&&this.updateKeySession(t,Wd("acknowledged")).then(()=>this.removeSession(t)).catch(b=>this.handleError(b)):this.warn(`unhandled media key message type "${T}"`)},p=(y,S)=>{S.keyStatus=y;let T;y.startsWith("usable")?f.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?T=Rv(y,S.decryptdata):y==="expired"?T=new Error(`key expired (keyId: ${u})`):y==="released"?T=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${u})`),T&&(f.eventNames().length?f.emit("error",T):this.handleError(T))},g=t._onkeystatuseschange=y=>{if(!t.mediaKeysSession){f.emit("error",new Error("invalid state"));return}const T=this.getKeyStatuses(t);if(!Object.keys(T).some(C=>T[C]!=="status-pending"))return;if(T[u]==="expired"){this.log(`Expired key ${Jt(T)} in key-session "${t.mediaKeysSession.sessionId}"`),this.renewKeySession(t);return}let b=T[u];if(b)p(b,t);else{var R;t.keyStatusTimeouts||(t.keyStatusTimeouts={}),(R=t.keyStatusTimeouts)[u]||(R[u]=self.setTimeout(()=>{if(!t.mediaKeysSession||!this.mediaKeys)return;const D=this.getKeyStatus(t.decryptdata);if(D&&D!=="status-pending")return this.log(`No status for keyId ${u} in key-session "${t.mediaKeysSession.sessionId}". Using session key-status ${D} from other session.`),p(D,t);this.log(`key status for ${u} in key-session "${t.mediaKeysSession.sessionId}" timed out after 1000ms`),b="internal-error",p(b,t)},1e3)),this.log(`No status for keyId ${u} (${Jt(T)}).`)}};Ye(t.mediaKeysSession,"message",h),Ye(t.mediaKeysSession,"keystatuseschange",g);const v=new Promise((y,S)=>{f.on("error",S),f.on("resolved",y)});return t.mediaKeysSession.generateRequest(e,i).then(()=>{this.log(`Request generated for key-session "${t.mediaKeysSession.sessionId}" keyId: ${u} URI: ${d}`)}).catch(y=>{throw new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:t.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>v).catch(y=>(f.removeAllListeners(),this.removeSession(t).then(()=>{throw y}))).then(()=>(f.removeAllListeners(),t))}getKeyStatuses(t){const e={};return t.mediaKeysSession.keyStatuses.forEach((i,s)=>{if(typeof s=="string"&&typeof i=="object"){const u=s;s=i,i=u}const a="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);t.keySystem===ae.PLAYREADY&&a.length===16&&px(a);const l=qe(a);i==="internal-error"&&(this.bannedKeyIds[l]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${l} key-session "${t.mediaKeysSession.sessionId}"`),e[l]=i}),e}fetchServerCertificate(t){const e=this.config,i=e.loader,s=new i(e),a=this.getServerCertificateUrl(t);return a?(this.log(`Fetching server certificate for "${t}"`),new Promise((l,u)=>{const d={responseType:"arraybuffer",url:a},f=e.certLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,y,S)=>{l(g.data)},onError:(g,v,y,S)=>{u(new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Vt({url:d.url,data:void 0},g)},`"${t}" certificate request failed (${a}). Status: ${g.code} (${g.text})`))},onTimeout:(g,v,y)=>{u(new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:d.url,data:void 0}},`"${t}" certificate request timed out (${a})`))},onAbort:(g,v,y)=>{u(new Error("aborted"))}};s.load(d,h,p)})):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise((s,a)=>{t.setServerCertificate(i).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${i.byteLength}) on "${e}"`),s(t)}).catch(l=>{a(new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then(i=>this.updateKeySession(t,new Uint8Array(i)).catch(s=>{throw new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:t.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(t,e){const i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const s=new DOMParser().parseFromString(i,"application/xml"),a=s.querySelectorAll("HttpHeader");if(a.length>0){let h;for(let p=0,g=a.length;p<g;p++){var l,u;h=a[p];const v=(l=h.querySelector("name"))==null?void 0:l.textContent,y=(u=h.querySelector("value"))==null?void 0:u.textContent;v&&y&&t.setRequestHeader(v,y)}}const d=s.querySelector("Challenge"),f=d?.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return Wd(atob(f))}setupLicenseXHR(t,e,i,s){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,t,e,i,s)}).catch(l=>{if(!i.decryptdata)throw l;return t.open("POST",e,!0),a.call(this.hls,t,e,i,s)}).then(l=>(t.readyState||t.open("POST",e,!0),{xhr:t,licenseChallenge:l||s})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,e){const i=this.config.keyLoadPolicy.default;return new Promise((s,a)=>{const l=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${l}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return a(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let d=u.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const f=this.config.licenseResponseCallback;if(f)try{d=f.call(this.hls,u,l,t)}catch(h){this.error(h)}s(d)}else{const d=i.errorRetry,f=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||u.status>=400&&u.status<500)a(new hi({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:t.decryptdata,fatal:!0,networkDetails:u,response:{url:l,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${l}). Status: ${u.status} (${u.statusText})`));else{const h=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(t,e).then(s,a)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=u,this.setupLicenseXHR(u,l,t,e).then(({xhr:d,licenseChallenge:f})=>{t.keySystem==ae.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(d,f)),d.send(f)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const i=e.media;this.media=i,Ye(i,"encrypted",this.onMediaEncrypted),Ye(i,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=i.mediaKeys}onMediaDetached(){const t=this.media;t&&(si(t,"encrypted",this.onMediaEncrypted),si(t,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var t;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const e=this.mediaResolved;if(e&&e(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const i=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,zs.clearKeyUriToKeyIdMap();const a=s.length;Vr.CDMCleanupPromise=Promise.all(s.map(l=>this.removeSession(l)).concat((i==null||(t=i.setMediaKeys(null))==null?void 0:t.catch(l=>{this.log(`Could not clear media keys: ${l}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${l}`)})}))||Promise.resolve())).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${l}`)})}).then(()=>{a&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(t,{sessionKeys:e}){if(!(!e||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=e.reduce((s,a)=>(s.indexOf(a.keyFormat)===-1&&s.push(a.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:i,decryptdata:s}=t;if(e){this.log(`Remove licenses and keys and close session "${e.sessionId}" keyId: ${qe(s?.keyId||[])}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(t);a>-1&&this.mediaKeySessions.splice(a,1);const{keyStatusTimeouts:l}=t;l&&Object.keys(l).forEach(f=>self.clearTimeout(l[f]));const{drmSystemOptions:u}=this.config;return(yC(u)?new Promise((f,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),e.remove().then(f).catch(h)}):Promise.resolve()).catch(f=>{this.log(`Could not remove session: ${f}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${f}`)})}).then(()=>e.close()).catch(f=>{this.log(`Could not close session: ${f}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${f}`)})})}return Promise.resolve()}}Vr.CDMCleanupPromise=void 0;function Hl(r){if(!r)throw new Error("Could not read keyId of undefined decryptdata");if(r.keyId===null)throw new Error("keyId is null");return qe(r.keyId)}function ND(r,t){if(r.keyId&&t.mediaKeysSession.keyStatuses.has(r.keyId))return t.mediaKeysSession.keyStatuses.get(r.keyId);if(r.matches(t.decryptdata))return t.keyStatus}class hi extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function Rv(r,t){const e=r==="output-restricted",i=e?Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new hi({type:vt.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},e?"HDCP level output restricted":`key status changed to "${r}"`)}class FD{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const s=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){const s=performance.now();if(e){if(this.lastTime){const a=s-this.lastTime,l=i-this.lastDroppedFrames,u=e-this.lastDecodedFrames,d=1e3*l/a,f=this.hls;if(f.trigger(_.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:i}),d>0&&l>f.config.fpsDroppedMonitoringThreshold*u){let h=f.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=h)&&(h=h-1,f.trigger(_.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:f.currentLevel}),f.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}function oS(r,t){let e;try{e=new Event("addtrack")}catch{e=document.createEvent("Event"),e.initEvent("addtrack",!1,!1)}e.track=r,t.dispatchEvent(e)}function lS(r,t){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(t.id))try{if(r.addCue(t),!r.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){Kt.debug(`[texttrack-utils]: ${i}`);try{const s=new self.TextTrackCue(t.startTime,t.endTime,t.text);s.id=t.id,r.addCue(s)}catch(s){Kt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}e==="disabled"&&(r.mode=e)}function jr(r,t){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let i=r.cues.length;i--;)t&&r.cues[i].removeEventListener("enter",t),r.removeCue(r.cues[i]);e==="disabled"&&(r.mode=e)}function rh(r,t,e,i){const s=r.mode;if(s==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const a=UD(r.cues,t,e);for(let l=0;l<a.length;l++)(!i||i(a[l]))&&r.removeCue(a[l])}s==="disabled"&&(r.mode=s)}function BD(r,t){if(t<=r[0].startTime)return 0;const e=r.length-1;if(t>r[e].endTime)return-1;let i=0,s=e,a;for(;i<=s;)if(a=Math.floor((s+i)/2),t<r[a].startTime)s=a-1;else if(t>r[a].startTime&&i<e)i=a+1;else return a;return r[i].startTime-t<t-r[s].startTime?i:s}function UD(r,t,e){const i=[],s=BD(r,t);if(s>-1)for(let a=s,l=r.length;a<l;a++){const u=r[a];if(u.startTime>=t&&u.endTime<=e)i.push(u);else if(u.startTime>e)return i}return i}function ru(r){const t=[];for(let e=0;e<r.length;e++){const i=r[e];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&t.push(r[e])}return t}class $D extends Kh{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const i=ru(this.media.textTracks);for(let a=0;a<i.length;a++)if(i[a].mode==="hidden")e=i[a];else if(i[a].mode==="showing"){e=i[a];break}const s=this.findTrackForTextTrack(e);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(_.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const i=this.media;if(!i)return;const s=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;ru(i.textTracks).forEach(l=>{jr(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:s,details:a}=e,l=this.tracksInGroup[i];if(!l||l.groupId!==s){this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=e.details,this.log(`Subtitle track ${i} "${l.name}" lang:${l.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,u)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(l=>s?.indexOf(l)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(h=>!i||i.indexOf(h.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(h=>h.default)&&(this.selectDefaultTrack=!1),l.forEach((h,p)=>{h.id=p});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.subtitlePreference;if(!a&&u){this.selectDefaultTrack=!1;const h=Zi(u,l);if(h>-1)a=l[h];else{const p=Zi(u,this.tracks);a=this.tracks[p]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const f={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${i?.join(",")}" group-id`),this.hls.trigger(_.SUBTITLE_TRACKS_UPDATED,f),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<e.length;s++){const a=e[s];if(!(i&&!a.default||!i&&!t)&&(!t||Hs(a,t)))return s}if(t){for(let s=0;s<e.length;s++){const a=e[s];if(uo(t.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<e.length;s++){const a=e[s];if(uo(t.attrs,a.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const s=e[i];if(eh(s,t))return i}}return-1}onError(t,e){e.fatal||!e.context||e.context.type===It.SUBTITLE_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(t.id===-1)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&Hs(t,i))return i;const s=Zi(t,this.tracksInGroup);if(s>-1){const a=this.tracksInGroup[s];return this.setSubtitleTrack(s),a}else{if(i)return null;{const a=Zi(t,e);if(a>-1)return e[a]}}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,s=t.groupId,a=this.getUrlWithDirectives(t.url,e),l=t.details,u=l?.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(_.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=ru(t.textTracks),i=this.currentTrack;let s;if(i&&(s=e.filter(a=>eh(i,a))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach(a=>{a.mode!=="disabled"&&a!==s&&(a.mode="disabled")}),s){const a=this.subtitleDisplay?"showing":"hidden";s.mode!==a&&(s.mode=a)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=e.length||!ht(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t]||null;if(this.trackId=t,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:t});return}const a=!!s.details&&!s.details.live;if(t===this.trackId&&s===i&&a)return;this.log(`Switching to subtitle-track ${t}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:l,groupId:u="",name:d,type:f,url:h}=s;this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:l,groupId:u,name:d,type:f,url:h});const p=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(p)}}function jD(){try{return crypto.randomUUID()}catch{try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch{let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const a=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(s=="x"?a:a&3|8).toString(16)})}}}function Ja(r){let t=5381,e=r.length;for(;e;)t=t*33^r.charCodeAt(--e);return(t>>>0).toString()}const Kr=.025;let Au=(function(r){return r[r.Point=0]="Point",r[r.Range=1]="Range",r})({});function GD(r,t,e){return`${r.identifier}-${e+1}-${Ja(t)}`}class HD{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,(t=this.assetListLoader)==null||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const i=this.playoutLimit;return t<=0||isNaN(i)?!1:i===0?!0:(((e=this.assetList[t])==null?void 0:e.startOffset)||0)>i}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return Ld(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime,i=Ld(e,t);return e-i<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=ht(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return Ld(t,e)}return t}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Kr))}set appendInPlace(t){if(this.appendInPlaceStarted){this.resetOnResume=!t;return}this.appendInPlaceDisabled=!t}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return this._duration!==null?e=this._duration:this.dateRange.duration?e=this.dateRange.duration:e=this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Au.Range:Au.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return zD(this)}}function Ld(r,t){return r-t.start<t.duration/2&&!(Math.abs(r-(t.start+t.duration))<Kr)?t.start:t.start+t.duration}function uS(r,t,e){const i=new self.URL(r,e);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",t),i}function _d(r,t){for(;(e=r.assetList[++t])!=null&&e.error;)var e;return t}function zD(r){return`["${r.identifier}" ${r.cue.pre?"<pre>":r.cue.post?"<post>":""}${r.timelineStart.toFixed(2)}-${r.resumeTime.toFixed(2)}]`}function $r(r){const t=r.timelineStart,e=r.duration||0;return`["${r.identifier}" ${t.toFixed(2)}-${(t+e).toFixed(2)}]`}class VD{constructor(t,e,i,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(_.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new t(e);this.interstitial=i,this.assetItem=s;const l=()=>{this.hasDetails=!0};a.once(_.LEVEL_LOADED,l),a.once(_.AUDIO_TRACK_LOADED,l),a.once(_.SUBTITLE_TRACK_LOADED,l),a.on(_.MEDIA_ATTACHING,(u,{media:d})=>{this.removeMediaListeners(),this.mediaAttached=d,this.interstitial.playoutLimit&&(d.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(_.BUFFER_APPENDED,()=>{const h=this.bufferedEnd;this.reachedPlayout(h)&&(this._bufferedEosTime=h,a.trigger(_.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=uS(e,t.config.primarySessionId||"").href}catch{}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if((e=this.hls)!=null&&e.bufferedToEnd)return!0;if(!t)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,a=At.bufferInfo(t,s,0);return this.getAssetTime(a.end)>=i-.02}reachedPlayout(t){const i=this.interstitial.playoutLimit;return this.startOffset+t>=i}get destroyed(){var t;return!((t=this.hls)!=null&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return((t=this.hls)==null?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=At.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const i=e-this.startOffset;if(i>0&&i<t)return i}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return((t=this.hls)==null?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const i=t-e;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,t-e),i)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var t;(t=this.hls)!=null&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),(e=this.hls)==null||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,(t=this.hls)==null||t.detachMedia()}resumeBuffering(){var t;(t=this.hls)==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.hls)==null||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),((t=this.hls)==null?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=i=>delete i.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,i){var s;(s=this.hls)==null||s.on(t,e)}once(t,e,i){var s;(s=this.hls)==null||s.once(t,e)}off(t,e,i){var s;(s=this.hls)==null||s.off(t,e)}toString(){var t;return`HlsAssetPlayer: ${$r(this.assetItem)} ${(t=this.hls)==null?void 0:t.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Lv=.033;class KD extends Oi{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((i,s)=>t<=s.startOffset&&e>s.startOffset?(delete s.error,i+1):i,0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);const s=this.items;if(s)for(s[i]||(e===void 0&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&(a=s[i])!=null&&a.event;){var a;i--}return i}findItemIndexAtTime(t,e){const i=this.items;if(i)for(let s=0;s<i.length;s++){let a=i[s];if(e&&e!=="primary"&&(a=a[e]),t===a.start||t>a.start&&t<a.end)return s}return-1}findJumpRestrictedIndex(t,e){const i=this.items;if(i)for(let s=t;s<=e&&i[s];s++){const a=i[s].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return s}return-1}findEventIndex(t){const e=this.items;if(e)for(let s=e.length;s--;){var i;if(((i=e[s].event)==null?void 0:i.identifier)===t)return s}return-1}findAssetIndex(t,e){const i=t.assetList,s=i.length;if(s>1)for(let a=0;a<s;a++){const l=i[a];if(!l.error){const u=l.timelineStart;if(e===u||e>u&&(e<u+(l.duration||0)||a===s-1))return a}}return 0}get assetIdAtEnd(){var t;const e=(t=this.items)==null||(t=t[this.length-1])==null?void 0:t.event;if(e){const i=e.assetList,s=i[i.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(t,e){const i=t.main.details,{dateRanges:s}=i,a=this.events,l=this.parseDateRanges(s,{url:i.url},e),u=Object.keys(s),d=a?a.filter(f=>!u.includes(f.identifier)):[];l.length&&l.sort((f,h)=>{const p=f.cue.pre,g=f.cue.post,v=h.cue.pre,y=h.cue.post;if(p&&!v)return-1;if(v&&!p||g&&!y)return 1;if(y&&!g)return-1;if(!p&&!v&&!g&&!y){const S=f.startTime,T=h.startTime;if(S!==T)return S-T}return f.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=l,d.forEach(f=>{this.removeEvent(f)}),this.updateSchedule(t,d)}updateSchedule(t,e=[],i=!1){const s=this.events||[];if(s.length||e.length||this.length<2){const a=this.items,l=this.parseSchedule(s,t);(i||e.length||a?.length!==l.length||l.some((d,f)=>Math.abs(d.playout.start-a[f].playout.start)>.005||Math.abs(d.playout.end-a[f].playout.end)>.005))&&(this.items=l,this.onScheduleUpdate(e,a))}}parseDateRanges(t,e,i){const s=[],a=Object.keys(t);for(let l=0;l<a.length;l++){const u=a[l],d=t[u];if(d.isInterstitial){let f=this.eventMap[u];f?f.setDateRange(d):(f=new HD(d,e),this.eventMap[u]=f,i===!1&&(f.appendInPlace=i)),s.push(f)}}return s}parseSchedule(t,e){const i=[],s=e.main.details,a=s.live?1/0:s.edge;let l=0;if(t=t.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),t.length){this.resolveOffsets(t,e);let d=0,f=0;if(t.forEach((h,p)=>{const g=h.cue.pre,v=h.cue.post,y=t[p-1]||null,S=h.appendInPlace,T=v?a:h.startOffset,A=h.duration,b=h.timelineOccupancy===Au.Range?A:0,R=h.resumptionOffset,C=y?.startTime===T,D=T+h.cumulativeDuration;let N=S?D+A:T+R;if(g||!v&&T<=0){const P=f;f+=b,h.timelineStart=D;const B=l;l+=A,i.push({event:h,start:D,end:N,playout:{start:B,end:l},integrated:{start:P,end:f}})}else if(T<=a){if(!C){const M=T-d;if(M>Lv){const q=d,tt=f;f+=M;const V=l;l+=M;const H={previousEvent:t[p-1]||null,nextEvent:h,start:q,end:q+M,playout:{start:V,end:l},integrated:{start:tt,end:f}};i.push(H)}else M>0&&y&&(y.cumulativeDuration+=M,i[i.length-1].end=T)}v&&(N=D),h.timelineStart=D;const P=f;f+=b;const B=l;l+=A,i.push({event:h,start:D,end:N,playout:{start:B,end:l},integrated:{start:P,end:f}})}else return;const w=h.resumeTime;v||w>a?d=a:d=w}),d<a){var u;const h=d,p=f,g=a-d;f+=g;const v=l;l+=g,i.push({previousEvent:((u=i[i.length-1])==null?void 0:u.event)||null,nextEvent:null,start:d,end:h+g,playout:{start:v,end:l},integrated:{start:p,end:f}})}this.setDurations(a,l,f)}else i.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){const i=e.main.details,s=i.live?1/0:i.edge;let a=0,l=-1;t.forEach((u,d)=>{const f=u.cue.pre,h=u.cue.post,p=f?0:h?s:u.startTime;this.updateAssetDurations(u),l===p?u.cumulativeDuration=a:(a=0,l=p),!h&&u.snapOptions.in&&(u.resumeAnchor=qs(null,i.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,e)||(u.appendInPlace=!1)),!u.appendInPlace&&d+1<t.length&&t[d+1].startTime-t[d].resumeTime<Lv&&(t[d+1].appendInPlace=!1,t[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const v=ht(u.resumeOffset)?u.resumeOffset:u.duration;a+=v})}primaryCanResumeInPlaceAt(t,e){const i=t.resumeTime,s=t.startTime+t.resumptionOffset;return Math.abs(i-s)>Kr?(this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${s}`),!1):!Object.keys(e).some(l=>{const u=e[l].details,d=u.edge;if(i>=d)return this.log(`"${t.identifier}" resumption ${i} past ${l} playlist end ${d}`),!1;const f=qs(null,u.fragments,i);if(!f)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${l} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const h=l==="audio"?.175:0;return Math.abs(f.start-i)<Kr+h||Math.abs(f.end-i)<Kr+h?!1:(this.log(`"${t.identifier}" resumption ${i} not aligned with ${l} fragment bounds (${f.start}-${f.end} sn: ${f.sn} cc: ${f.cc})`),!0)})}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let i=0,s=!1,a=!1;for(let l=0;l<t.assetList.length;l++){const u=t.assetList[l],d=e+i;u.startOffset=i,u.timelineStart=d,s||(s=u.duration===null),a||(a=!!u.error);const f=u.error?0:u.duration||0;i+=f}s&&!a?t.duration=Math.max(i,t.duration):t.duration=i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function Ni(r){return`[${r.event?'"'+r.event.identifier+'"':"primary"}: ${r.start.toFixed(2)}-${r.end.toFixed(2)}]`}class qD{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const i=t.assetListUrl;let s;try{s=uS(i,this.hls.sessionId,t.baseUrl)}catch(g){const v=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_ERROR,g,i);this.hls.trigger(_.ERROR,v);return}e&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+e);const a=this.hls.config,l=a.loader,u=new l(a),d={responseType:"json",url:s.href},f=a.interstitialAssetListLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,y,S)=>{const T=g.data,A=T?.ASSETS;if(!Array.isArray(A)){const b=this.assignAssetListError(t,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,v,S);this.hls.trigger(_.ERROR,b);return}t.assetListResponse=T,this.hls.trigger(_.ASSET_LIST_LOADED,{event:t,assetListResponse:T,networkDetails:S})},onError:(g,v,y,S)=>{const T=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${g.code} ${g.text} (${v.url})`),v.url,S,y);this.hls.trigger(_.ERROR,T)},onTimeout:(g,v,y)=>{const S=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,g,y);this.hls.trigger(_.ERROR,S)}};return u.load(d,h,p),this.hls.trigger(_.ASSET_LIST_LOADING,{event:t}),u}assignAssetListError(t,e,i,s,a,l){return t.error=i,{type:vt.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:s,error:i,networkDetails:l,stats:a}}}function _v(r){var t;r==null||(t=r.play())==null||t.catch(()=>{})}function zl(r,t){return`[${r}] Advancing timeline position to ${t}`}class YD extends Oi{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const s=i-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const l=s<=-.01;this.timelinePos=i,this.bufferedPos=i;const u=this.playingItem;if(!u){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(i,i-s)&&this.updateSchedule(!0),this.checkBuffer(),l&&i<u.start||i>=u.end){var d;const v=this.findItemIndex(u);let y=this.schedule.findItemIndexAtTime(i);if(y===-1&&(y=v+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${i} (resolving from ${v} to ${y})`)),!this.isInterstitial(u)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!l&&y>v){const S=this.schedule.findJumpRestrictedIndex(v+1,y);if(S>v){this.setSchedulePosition(S);return}}this.setSchedulePosition(y);return}const f=this.playingAsset;if(!f){if(this.playingLastItem&&this.isInterstitial(u)){const v=u.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,v))}return}const h=f.timelineStart,p=f.duration||0;if(l&&i<h||i>=h+p){var g;(g=u.event)!=null&&g.appendInPlace&&(this.clearInterstitial(u.event,u),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,f)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(i>=s.end){this.timelinePos=s.end;const u=this.findItemIndex(s);this.setSchedulePosition(u+1)}const a=this.playingAsset;if(!a)return;const l=a.timelineStart+(a.duration||0);i>=l&&this.setScheduleToAssetAtTime(i,a)},this.onScheduleUpdate=(i,s)=>{const a=this.schedule;if(!a)return;const l=this.playingItem,u=a.events||[],d=a.items||[],f=a.durations,h=i.map(S=>S.identifier),p=!!(u.length||h.length);(p||s)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${d.map(S=>Ni(S))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`);let g=null,v=null;l&&(g=this.updateItem(l,this.timelinePos),this.itemsMatch(l,g)?this.playingItem=g:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(v=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,v)?this.bufferingItem=v:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),i.forEach(S=>{S.assetList.forEach(T=>{this.clearAssetPlayer(T.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const T=S.assetItem.timelineStart,A=S.timelineOffset-T;if(A)try{S.timelineOffset=T}catch(b){Math.abs(A)>Kr&&this.warn(`${b} ("${S.assetId}" ${S.timelineOffset}->${T})`)}}}),p||s){if(this.hls.trigger(_.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:d.slice(0),durations:f,removedIds:h}),this.isInterstitial(l)&&h.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}l&&this.trimInPlace(g,l),y&&v!==g&&this.trimInPlace(v,y),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new qD(t),this.schedule=new KD(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(_.MEDIA_ENDED,this.onMediaEnded,this),t.on(_.ERROR,this.onError,this),t.on(_.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(_.MEDIA_ENDED,this.onMediaEnded,this),t.off(_.ERROR,this.onError,this),t.off(_.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;(t=this.getBufferingPlayer())==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.getBufferingPlayer())==null||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){si(t,"play",this.onPlay),si(t,"pause",this.onPause),si(t,"seeking",this.onSeeking),si(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const i=this.media=e.media;Ye(i,"seeking",this.onSeeking),Ye(i,"timeupdate",this.onTimeupdate),Ye(i,"play",this.onPlay),Ye(i,"pause",this.onPause)}onMediaAttached(t,e){const i=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!s){this.clearScheduleState();const a=this.findItemIndex(i);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const i=!!e.transferMedia,s=this.media;if(this.media=null,!i&&(s&&this.removeMediaListeners(s),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,i=p=>p&&t.getAssetPlayer(p.identifier),s=(p,g,v,y,S)=>{if(p){let T=p[g].start;const A=p.event;if(A){if(g==="playout"||A.timelineOccupancy!==Au.Point){const b=i(v);b?.interstitial===A&&(T+=b.assetItem.startOffset+b[S])}}else{const b=y==="bufferedPos"?l():t[y];T+=b-p.start}return T}return 0},a=(p,g)=>{var v;if(p!==0&&g!=="primary"&&(v=t.schedule)!=null&&v.length){var y;const S=t.schedule.findItemIndexAtTime(p),T=(y=t.schedule.items)==null?void 0:y[S];if(T){const A=T[g].start-T.start;return p+A}}return p},l=()=>{const p=t.bufferedPos;return p===Number.MAX_VALUE?u("primary"):Math.max(p,0)},u=p=>{var g,v;return(g=t.primaryDetails)!=null&&g.live?t.primaryDetails.edge:((v=t.schedule)==null?void 0:v.durations[p])||0},d=(p,g)=>{var v,y;const S=t.effectivePlayingItem;if(S!=null&&(v=S.event)!=null&&v.restrictions.skip||!t.schedule)return;t.log(`seek to ${p} "${g}"`);const T=t.effectivePlayingItem,A=t.schedule.findItemIndexAtTime(p,g),b=(y=t.schedule.items)==null?void 0:y[A],R=t.getBufferingPlayer(),C=R?.interstitial,D=C?.appendInPlace,N=T&&t.itemsMatch(T,b);if(T&&(D||N)){const w=i(t.playingAsset),P=w?.media||t.primaryMedia;if(P){const B=g==="primary"?P.currentTime:s(T,g,t.playingAsset,"timelinePos","currentTime"),M=p-B,q=(D?B:P.currentTime)+M;if(q>=0&&(!w||D||q<=w.duration)){P.currentTime=q;return}}}if(b){let w=p;if(g!=="primary"){const B=b[g].start,M=p-B;w=b.start+M}const P=!t.isInterstitial(b);if((!t.isInterstitial(T)||T.event.appendInPlace)&&(P||b.event.appendInPlace)){const B=t.media||(D?R?.media:null);B&&(B.currentTime=w)}else if(T){const B=t.findItemIndex(T);if(A>B){const q=t.schedule.findJumpRestrictedIndex(B+1,A);if(q>B){t.setSchedulePosition(q);return}}let M=0;if(P)t.timelinePos=w,t.checkBuffer();else{const q=b.event.assetList,tt=p-(b[g]||b).start;for(let V=q.length;V--;){const H=q[V];if(H.duration&&tt>=H.startOffset&&tt<H.startOffset+H.duration){M=V;break}}}t.setSchedulePosition(A,M)}}},f=()=>{const p=t.effectivePlayingItem;if(t.isInterstitial(p))return p;const g=e();return t.isInterstitial(g)?g:null},h={get bufferedEnd(){const p=e(),g=t.bufferingItem;if(g&&g===p){var v;return s(g,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-g.playout.start||((v=t.bufferingAsset)==null?void 0:v.startOffset)||0}return 0},get currentTime(){const p=f(),g=t.effectivePlayingItem;return g&&g===p?s(g,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-g.playout.start:0},set currentTime(p){const g=f(),v=t.effectivePlayingItem;v&&v===g&&d(p+v.playout.start,"playout")},get duration(){const p=f();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const g=(p=f())==null?void 0:p.event.assetList;return g?g.map(v=>t.getAssetPlayer(v.identifier)):[]},get playingIndex(){var p;const g=(p=f())==null?void 0:p.event;return g&&t.effectivePlayingAsset?g.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return f()}};return this.manager={get events(){var p;return((p=t.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=t.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return f()?h:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const p=e();return t.findItemIndex(p)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const p=t.effectivePlayingItem;return t.findItemIndex(p)},primary:{get bufferedEnd(){return l()},get currentTime(){const p=t.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return u("primary")},get seekableStart(){var p;return((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return u("integrated")},get seekableStart(){var p;return a(((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=t.effectivePlayingItem,g=p?.event;if(g&&!g.restrictions.skip){const v=t.findItemIndex(p);if(g.appendInPlace){const y=p.playout.start+p.event.duration;d(y+.001,"playout")}else t.advanceAfterAssetEnded(g,v,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,i=(t=this.schedule)==null?void 0:t.items;return!this.playbackStarted||!e||!i?!1:this.findItemIndex(e)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var t,e;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let s=this.media;!s&&(t=this.bufferingItem)!=null&&(t=t.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const a=(e=s)==null?void 0:e.currentTime;if(!(a===void 0||!ht(a)))return a}get primaryMedia(){var t;return this.media||((t=this.detachedData)==null?void 0:t.media)||null}isInterstitial(t){return!!(t!=null&&t.event)}retreiveMediaSource(t,e){const i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){const i=t.interstitial.appendInPlace,s=t.media;if(i&&s===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&s){this.detachedData={media:s};return}const a=t.transferMedia();this.log(`transfer MediaSource from ${t} ${Jt(a)}`),this.detachedData=a}else e&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(t,e){var i,s;if(t.media===e)return;let a=null;const l=this.hls,u=t!==l,d=u&&t.interstitial.appendInPlace,f=(i=this.detachedData)==null?void 0:i.mediaSource;let h;if(l.media)d&&(a=l.transferMedia(),this.detachedData=a),h="Primary";else if(f){const y=this.getBufferingPlayer();y?(a=y.transferMedia(),h=`${y}`):h="detached MediaSource"}else h="detached media";if(!a){if(f)a=this.detachedData,this.log(`using detachedData: MediaSource ${Jt(a)}`);else if(!this.detachedData||l.media===e){const y=this.playerQueue;y.length>1&&y.forEach(S=>{if(u&&S.interstitial.appendInPlace!==d){const T=S.interstitial;this.clearInterstitial(S.interstitial,null),T.appendInPlace=!1,T.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${T}`)}}),this.hls.detachMedia(),this.detachedData={media:e}}}const p=a&&"mediaSource"in a&&((s=a.mediaSource)==null?void 0:s.readyState)!=="closed",g=p&&a?a:e;this.log(`${p?"transfering MediaSource":"attaching media"} to ${u?t:"Primary"} from ${h} (media.currentTime: ${e.currentTime})`);const v=this.schedule;if(g===a&&v){const y=u&&t.assetId===v.assetIdAtEnd;g.overrides={duration:v.duration,endOfStream:!u||y,cueRemoval:!u}}t.attachMedia(g)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=t?.events;if(!e||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,s=this.effectivePlayingItem;if(i===-1){const a=this.hls.startPosition;if(this.log(zl("checkStart",a)),this.timelinePos=a,e.length&&e[0].cue.pre){const l=t.findEventIndex(e[0].identifier);this.setSchedulePosition(l)}else if(a>=0||!this.primaryLive){const l=this.timelinePos=a>0?a:0,u=t.findItemIndexAtTime(l);this.setSchedulePosition(u)}}else if(s&&!this.playingItem){const a=t.findItemIndex(s);this.setSchedulePosition(a)}}advanceAssetBuffering(t,e){const i=t.event,s=i.findAssetIndex(e),a=_d(i,s);if(!i.isAssetPastPlayoutLimit(a))this.bufferedToEvent(t,a);else if(this.schedule){var l;const u=(l=this.schedule.items)==null?void 0:l[this.findItemIndex(t)+1];u&&this.bufferedToItem(u)}}advanceAfterAssetEnded(t,e,i){const s=_d(t,i);if(t.isAssetPastPlayoutLimit(s)){if(this.schedule){const a=this.schedule.items;if(a){const l=e+1,u=a.length;if(l>=u){this.setSchedulePosition(-1);return}const d=t.resumeTime;this.timelinePos<d&&(this.log(zl("advanceAfterAssetEnded",d)),this.timelinePos=d,t.appendInPlace&&this.advanceInPlace(d),this.checkBuffer(this.bufferedPos<d)),this.setSchedulePosition(l)}}}else{if(t.appendInPlace){const a=t.assetList[s];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(e,s)}}setScheduleToAssetAtTime(t,e){const i=this.schedule;if(!i)return;const s=e.parentIdentifier,a=i.getEvent(s);if(a){const l=i.findEventIndex(s),u=i.findAssetIndex(a,t);this.advanceAfterAssetEnded(a,l,u-1)}}setSchedulePosition(t,e){var i;const s=(i=this.schedule)==null?void 0:i.items;if(!s||this.playbackDisabled)return;const a=t>=0?s[t]:null;this.log(`setSchedulePosition ${t}, ${e} (${a&&Ni(a)}) pos: ${this.timelinePos}`);const l=this.waitingItem||this.playingItem,u=this.playingLastItem;if(this.isInterstitial(l)){const h=l.event,p=this.playingAsset,g=p?.identifier,v=g?this.getAssetPlayer(g):null;if(v&&g&&(!this.eventItemsMatch(l,a)||e!==void 0&&g!==h.assetList[e].identifier)){var d;const y=h.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${h.assetList.length} ${$r(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(_.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:y,event:h,schedule:s.slice(0),scheduleIndex:t,player:v}),l!==this.playingItem){this.itemsMatch(l,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(h,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(g,a),v.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(l,a)&&(this.endedItem=l,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${h} ${Ni(l)}`),h.hasPlayed=!0,this.hls.trigger(_.INTERSTITIAL_ENDED,{event:h,schedule:s.slice(0),scheduleIndex:t}),h.cue.once)){var f;this.updateSchedule();const y=(f=this.schedule)==null?void 0:f.items;if(a&&y){const S=this.findItemIndex(a);this.advanceSchedule(S,y,e,l,u)}return}}this.advanceSchedule(t,s,e,l,u)}advanceSchedule(t,e,i,s,a){const l=this.schedule;if(!l)return;const u=e[t]||null,d=this.primaryMedia,f=this.playerQueue;if(f.length&&f.forEach(h=>{const p=h.interstitial,g=l.findEventIndex(p.identifier);(g<t||g>t+1)&&this.clearInterstitial(p,u)}),this.isInterstitial(u)){this.timelinePos=Math.min(Math.max(this.timelinePos,u.start),u.end);const h=u.event;if(i===void 0){i=l.findAssetIndex(h,this.timelinePos);const y=_d(h,i-1);if(h.isAssetPastPlayoutLimit(y)||h.appendInPlace&&this.timelinePos===u.end){this.advanceAfterAssetEnded(h,t,i);return}i=y}const p=this.waitingItem;this.assetsBuffered(u,d)||this.setBufferingItem(u);let g=this.preloadAssets(h,i);if(this.eventItemsMatch(u,p||s)||(this.waitingItem=u,this.log(`INTERSTITIAL_STARTED ${Ni(u)} ${h.appendInPlace?"append in place":""}`),this.hls.trigger(_.INTERSTITIAL_STARTED,{event:h,schedule:e.slice(0),scheduleIndex:t})),!h.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${h}`);return}if(h.assetListLoader&&(h.assetListLoader.destroy(),h.assetListLoader=void 0),!d){this.log(`Waiting for attachMedia to start Interstitial ${h}`);return}this.waitingItem=this.endedItem=null,this.playingItem=u;const v=h.assetList[i];if(!v){this.advanceAfterAssetEnded(h,t,i||0);return}if(g||(g=this.getAssetPlayer(v.identifier)),g===null||g.destroyed){const y=h.assetList.length;this.warn(`asset ${i+1}/${y} player destroyed ${h}`),g=this.createAssetPlayer(h,v,i),g.loadSource()}if(!this.eventItemsMatch(u,this.bufferingItem)&&h.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(g,i,e,t,d),this.shouldPlay&&_v(g.media)}else u?(this.resumePrimary(u,t,s),this.shouldPlay&&_v(this.hls.media)):a&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(l.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var t;return(t=this.mediaSelection)==null?void 0:t.main.details}get primaryLive(){var t;return!!((t=this.primaryDetails)!=null&&t.live)}resumePrimary(t,e,i){var s,a;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${Ni(t)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let u=this.timelinePos;(u<t.start||u>=t.end)&&(u=this.getPrimaryResumption(t,e),this.log(zl("resumePrimary",u)),this.timelinePos=u),this.attachPrimary(u,t)}if(!i)return;const l=(a=this.schedule)==null?void 0:a.items;l&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Ni(t)}`),this.hls.trigger(_.INTERSTITIALS_PRIMARY_RESUMED,{schedule:l.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const i=t.start;if(this.primaryLive){const s=this.primaryDetails;if(e===0)return this.hls.startPosition;if(s&&(i<s.fragmentStart||i>s.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);return e!=null&&e.hls?e.hls.bufferedToEnd:At.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,s),i&&this.startLoadingPrimaryAt(t,i)),i||(this.log(zl("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((i=s.mainForwardBufferInfo)==null?void 0:i.start)||s.media.currentTime)-t)>.5?s.startLoad(t,e):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),(t=this.schedule)==null||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(_.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(_.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(e.level===-1||!this.schedule)return;const i=this.hls.levels[e.level];if(!i.details)return;const s=Vt(Vt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const i=this.hls.audioTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=Vt(Vt({},this.altSelection),{},{audio:i});return}const a=Vt(Vt({},s),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(t,e){const i=this.hls.subtitleTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=Vt(Vt({},this.altSelection),{},{subtitles:i});return}const a=Vt(Vt({},s),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(t,e){const i=Ny(e);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(e)||s.setAudioOption(i)))}onSubtitleTrackSwitch(t,e){const i=Ny(e);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(e)||e.id!==-1&&s.setSubtitleOption(i)))}onBufferCodecs(t,e){const i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let s=0;s<e.length;s++){const a=e[s];if(a.cue.post){var i;const l=this.schedule.findEventIndex(a.identifier),u=(i=this.schedule.items)==null?void 0:i[l];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const i=this.findItemIndex(e);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(t,e){var i;const s=(i=this.schedule)==null?void 0:i.items;if(t&&s){const a=this.findItemIndex(t,e);return s[a]||null}return null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach((a,l)=>{t.event.isAssetPastPlayoutLimit(l)&&this.clearAssetPlayer(a.identifier,null)});const i=t.end+.25,s=At.bufferInfo(this.primaryMedia,i,0);(s.end>i||(s.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${Ni(t)} (was ${Ni(e)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===((i=e.event)==null?void 0:i.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(t=!1){var e;const i=this.mediaSelection;i&&((e=this.schedule)==null||e.updateSchedule(i,[],t))}checkBuffer(t){var e;const i=(e=this.schedule)==null?void 0:e.items;if(!i)return;const s=At.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=s.len<1),this.updateBufferedPos(s.end,i,t)}updateBufferedPos(t,e,i){const s=this.schedule,a=this.bufferingItem;if(this.bufferedPos>t||!s)return;if(e.length===1&&this.itemsMatch(e[0],a)){this.bufferedPos=t;return}const l=this.playingItem,u=this.findItemIndex(l);let d=s.findItemIndexAtTime(t);if(this.bufferedPos<t){var f;const h=this.findItemIndex(a),p=Math.min(h+1,e.length-1),g=e[p];if((d===-1&&a&&t>=a.end||(f=g.event)!=null&&f.appendInPlace&&t+.01>=g.start)&&(d=p),this.isInterstitial(a)){const v=a.event;if(p-u>1&&v.appendInPlace===!1||v.assetList.length===0&&v.assetListLoader)return}if(this.bufferedPos=t,d>h&&d>u)this.bufferedToItem(g);else{const v=this.primaryDetails;this.primaryLive&&v&&t>v.edge-v.targetduration&&g.start<v.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else i&&l&&!this.itemsMatch(l,a)&&(d===u?this.bufferedToItem(l):d===u+1&&this.bufferedToItem(e[d]))}assetsBuffered(t,e){return t.event.assetList.length===0?!1:!t.event.assetList.some(s=>{const a=this.getAssetPlayer(s.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(e))})}setBufferingItem(t){const e=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(t,e)&&i){const{items:s,events:a}=i;if(!s||!a)return e;const l=this.isInterstitial(t),u=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const d=u?u.remaining:e?e.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Ni(t)}`+(e?` (${d.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(l){const f=i.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach((h,p)=>{const g=this.getAssetPlayer(h.identifier);g&&(p===f&&g.loadSource(),g.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(f=>f.pauseBuffering());this.hls.trigger(_.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t,e=0){const i=this.setBufferingItem(t);if(!this.playbackDisabled){if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(i!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(t.start,t,!0):this.preloadPrimary(t):this.preloadPrimary(t)}}}preloadPrimary(t){const e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){const i=t.event,s=i.assetList.length===0&&!i.assetListLoader,a=i.cue.once;if(s||!a){const l=this.preloadAssets(i,e);if(l!=null&&l.interstitial.appendInPlace){const u=this.primaryMedia;u&&this.bufferAssetPlayer(l,u)}}}preloadAssets(t,e){const i=t.assetUrl,s=t.assetList.length,a=s===0&&!t.assetListLoader,l=t.cue.once;if(a){const d=t.timelineStart;if(t.appendInPlace){var u;const g=this.playingItem;!this.isInterstitial(g)&&(g==null||(u=g.nextEvent)==null?void 0:u.identifier)===t.identifier&&this.flushFrontBuffer(d+.25)}let f,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(t.cue.pre||t.cue.post)){const g=h-d;g>0&&(f=Math.round(g*1e3)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:s} ${t}${f?` live-start: ${h} start-offset: ${f}`:""}`),i)return this.createAsset(t,0,0,d,t.duration,i);const p=this.assetListLoader.loadAssetList(t,f);p&&(t.assetListLoader=p)}else if(!l&&s){for(let f=e;f<s;f++){const h=t.assetList[f],p=this.getAssetPlayerQueueIndex(h.identifier);(p===-1||this.playerQueue[p].destroyed)&&!h.error&&this.createAssetPlayer(t,h,f)}const d=t.assetList[e];if(d){const f=this.getAssetPlayer(d.identifier);return f&&f.loadSource(),f}}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`),Object.keys(e).forEach(s=>{this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e){for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i]}return null}createAsset(t,e,i,s,a,l){const u={parentIdentifier:t.identifier,identifier:GD(t,l,e),duration:a,startOffset:i,timelineStart:s,uri:l};return this.createAssetPlayer(t,u,e)}createAssetPlayer(t,e,i){const s=this.hls,a=s.userConfig;let l=a.videoPreference;const u=s.loadLevelObj||s.levels[s.currentLevel];(l||u)&&(l=Wt({},l),u.videoCodec&&(l.videoCodec=u.videoCodec),u.videoRange&&(l.allowedVideoRanges=[u.videoRange]));const d=s.audioTracks[s.audioTrack],f=s.subtitleTracks[s.subtitleTrack];let h=0;if(this.primaryLive||t.appendInPlace){const C=this.timelinePos-e.timelineStart;if(C>1){const D=e.duration;D&&C<D&&(h=C)}}const p=e.identifier,g=Vt(Vt({},a),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:d||a.audioPreference,subtitlePreference:f||a.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(g.timelineOffset=e.timelineStart));const v=g.cmcd;v!=null&&v.sessionId&&v.contentId&&(g.cmcd=Wt({},v,{contentId:Ja(e.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${t} and asset ${p}`);const y=new VD(this.HlsPlayerClass,g,t,e);this.playerQueue.push(y),t.assetList[i]=e;let S=!0;const T=C=>{if(C.live){var D;const P=new Error(`Interstitials MUST be VOD assets ${t}`),B={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:P},M=((D=this.schedule)==null?void 0:D.findEventIndex(t.identifier))||-1;this.handleAssetItemError(B,t,M,i,P.message);return}const N=C.edge-C.fragmentStart,w=e.duration;(S||w===null||N>w)&&(S=!1,this.log(`Interstitial asset "${p}" duration change ${w} > ${N}`),e.duration=N,this.updateSchedule())};y.on(_.LEVEL_UPDATED,(C,{details:D})=>T(D)),y.on(_.LEVEL_PTS_UPDATED,(C,{details:D})=>T(D)),y.on(_.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const A=(C,D)=>{const N=this.getAssetPlayer(p);if(N&&D.tracks){N.off(_.BUFFER_CODECS,A),N.tracks=D.tracks;const w=this.primaryMedia;this.bufferingAsset===N.assetItem&&w&&!N.media&&this.bufferAssetPlayer(N,w)}};y.on(_.BUFFER_CODECS,A);const b=()=>{var C;const D=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${D}`),!D||!this.schedule)return;const N=this.schedule.findEventIndex(t.identifier),w=(C=this.schedule.items)==null?void 0:C[N];this.isInterstitial(w)&&this.advanceAssetBuffering(w,e)};y.on(_.BUFFERED_TO_END,b);const R=C=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const N=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,N,C)};return y.once(_.MEDIA_ENDED,R(i)),y.once(_.PLAYOUT_LIMIT_REACHED,R(1/0)),y.on(_.ERROR,(C,D)=>{if(!this.schedule)return;const N=this.getAssetPlayer(p);if(D.details===Q.BUFFER_STALLED_ERROR){if(N!=null&&N.appendInPlace){this.handleInPlaceStall(t);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(D,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${D.error} ${t}`)}),y.on(_.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const D=new Error(`Asset player destroyed unexpectedly ${p}`),N={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:D};this.handleAssetItemError(N,t,this.schedule.findEventIndex(t.identifier),i,D.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${$r(e)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:y}),y}clearInterstitial(t,e){t.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,e)}),t.reset()}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(e!==-1){this.log(`reset asset player "${t}" after error`);const i=this.playerQueue[e];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(t,e){const i=this.getAssetPlayerQueueIndex(t);if(i!==-1){const s=this.playerQueue[i];this.log(`clear ${s} toSegment: ${e&&Ni(e)}`),this.transferMediaFromPlayer(s,e),this.playerQueue.splice(i,1),s.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,s,a){const{interstitial:l,assetItem:u,assetId:d}=t,f=l.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!h||h.identifier!==d)&&(h&&(this.clearAssetPlayer(h.identifier,i[s]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${f} ${$r(u)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:e,event:l,schedule:i.slice(0),scheduleIndex:s,player:t})),this.bufferAssetPlayer(t,a)}bufferAssetPlayer(t,e){var i,s;if(!this.schedule)return;const{interstitial:a,assetItem:l}=t,u=this.schedule.findEventIndex(a.identifier),d=(i=this.schedule.items)==null?void 0:i[u];if(!d)return;t.loadSource(),this.setBufferingItem(d),this.bufferingAsset=l;const f=this.getBufferingPlayer();if(f===t)return;const h=a.appendInPlace;if(h&&f?.interstitial.appendInPlace===!1)return;const p=f?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(h&&l!==this.playingAsset){if(!t.tracks){this.log(`Waiting for track info before buffering ${t}`);return}if(p&&!VE(p,t.tracks)){const g=new Error(`Asset ${$r(l)} SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),v={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:g},y=a.findAssetIndex(l);this.handleAssetItemError(v,a,u,y,g.message);return}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,i=this.primaryMedia;if(!e||!i)return;const s=i.currentTime,a=e.findAssetIndex(t,s),l=t.assetList[a];if(l){const u=this.getAssetPlayer(l.identifier);if(u){const d=u.currentTime||s-l.timelineStart,f=u.duration-d;if(this.warn(`Stalled at ${d} of ${d+f} in ${u} ${t} (media.currentTime: ${s})`),d&&(f/i.playbackRate<.5||u.bufferedInPlaceToEnd(i))&&u.hls){const h=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,h,a)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,i,s,a){if(t.details===Q.BUFFER_STALLED_ERROR)return;const l=e.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${l&&$r(l)} ${t.error}`),!this.schedule)return;const u=l?.identifier||"",d=this.getAssetPlayerQueueIndex(u),f=this.playerQueue[d]||null,h=this.schedule.items,p=Wt({},t,{fatal:!1,errorAction:Hr(!0),asset:l,assetListIndex:s,event:e,schedule:h,scheduleIndex:i,player:f});if(this.hls.trigger(_.INTERSTITIAL_ASSET_ERROR,p),!t.fatal)return;const g=this.playingAsset,v=this.bufferingAsset,y=new Error(a);if(l&&(this.clearAssetPlayer(u,null),l.error=y),!e.assetList.some(S=>!S.error))e.error=y;else for(let S=s;S<e.assetList.length;S++)this.resetAssetPlayer(e.assetList[S].identifier);this.updateSchedule(!0),e.error?this.primaryFallback(e):g&&g.identifier===u?this.advanceAfterAssetEnded(e,i,s):v&&v.identifier===u&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,v)}primaryFallback(t){const e=t.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${Ni(i)} error: ${t.error}`);let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const a=this.updateItem(i,s);if(this.itemsMatch(i,a)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e)),!this.schedule)return;const l=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(l)}else this.checkStart()}onAssetListLoaded(t,e){var i,s;const a=e.event,l=a.identifier,u=e.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(l)))return;const d=a.timelineStart,f=a.duration;let h=0;u.forEach((S,T)=>{const A=parseFloat(S.DURATION);this.createAsset(a,T,h,d+h,A,S.URI),h+=A}),a.duration=h,this.log(`Loaded asset-list with duration: ${h} (was: ${f}) ${a}`);const p=this.waitingItem,g=p?.event.identifier===l;this.updateSchedule();const v=(s=this.bufferingItem)==null?void 0:s.event;if(g){var y;const S=this.schedule.findEventIndex(l),T=(y=this.schedule.items)==null?void 0:y[S];if(T){if(!this.playingItem&&this.timelinePos>T.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){a.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${a}`),this.updateSchedule(!0),this.primaryFallback(a);return}this.setBufferingItem(T)}this.setSchedulePosition(S)}else if(v?.identifier===l){const S=a.assetList[0];if(S){const T=this.getAssetPlayer(S.identifier);if(v.appendInPlace){const A=this.primaryMedia;T&&A&&this.bufferAssetPlayer(T,A)}else T&&T.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const i=e.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case Q.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Cv=500;class XD extends Bh{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller",mt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=at.IDLE,this.setInterval(Cv),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:s}=e;if(this.fragContextChanged(i)||(Te(i)&&(this.fragPrevious=i),this.state=at.IDLE),!s)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let l;const u=i.start;for(let f=0;f<a.length;f++)if(u>=a[f].start&&u<=a[f].end){l=a[f];break}const d=i.start+i.duration;l?l.end=d:(l={start:u,end:d},a.push(l)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:i,endOffset:s}=e;if(i===0&&s!==Number.POSITIVE_INFINITY){const a=s-1;if(a<=0)return;e.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(l=>{for(let u=0;u<l.length;){if(l[u].end<=a){l.shift();continue}else if(l[u].start<a)l[u].start=a;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(i,a,mt.SUBTITLE)}}onError(t,e){const i=e.frag;i?.type===mt.SUBTITLE&&(e.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==at.STOPPED&&(this.state=at.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){if(this.levels&&Yx(this.levels,e)){this.levels=e.map(i=>new ro(i));return}this.tracksBuffered=[],this.levels=e.map(i=>{const s=new ro(i);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,mt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==at.STOPPED&&this.setInterval(Cv)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:s,levels:a}=this,{details:l,id:u}=e;if(!a){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const d=a[u];if(u>=a.length||!d)return;this.log(`Subtitle track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(l.live||(i=d.details)!=null&&i.live){if(l.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const g=p.fragments[0];if(!d.details)l.hasProgramDateTime&&p.hasProgramDateTime?(Tu(l,p),f=l.fragmentStart):g&&(f=g.start,Zd(l,f));else{var h;f=this.alignPlaylists(l,d.details,(h=this.levelLastLoaded)==null?void 0:h.details),f===0&&g&&(f=g.start,Zd(l,f))}p&&!this.startFragRequested&&this.setStartPosition(p,f)}d.details=l,this.levelLastLoaded=d,u===s&&(this.hls.trigger(_.SUBTITLE_TRACK_UPDATED,{details:l,id:u,groupId:e.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===at.IDLE&&(qs(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,s=e.decryptdata,a=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&s!=null&&s.key&&s.iv&&zr(s.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer,Nh(s.method)).catch(u=>{throw a.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:e}),u}).then(u=>{const d=performance.now();a.trigger(_.FRAG_DECRYPTED,{frag:e,payload:u,stats:{tstart:l,tdecrypt:d}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=at.IDLE})}}doTick(){if(!this.media){this.state=at.IDLE;return}if(this.state===at.IDLE){const{currentTrackId:t,levels:e}=this,i=e?.[t];if(!i||!e.length||!i.details||this.waitForLive(i))return;const{config:s}=this,a=this.getLoadPosition(),l=At.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,s.maxBufferHole),{end:u,len:d}=l,f=i.details,h=this.hls.maxBufferLength+f.levelTargetDuration;if(d>h)return;const p=f.fragments,g=p.length,v=f.edge;let y=null;const S=this.fragPrevious;if(u<v){const b=s.maxFragLookUpTolerance,R=u>v-b?0:b;y=qs(S,p,Math.max(p[0].start,u),R),!y&&S&&S.start<p[0].start&&(y=p[0])}else y=p[g-1];if(y=this.filterReplacedPrimary(y,i.details),!y)return;const T=y.sn-f.startSN,A=p[T-1];if(A&&A.cc===y.cc&&this.fragmentTracker.getState(A)===Le.NOT_LOADED&&(y=A),this.fragmentTracker.getState(y)===Le.NOT_LOADED){const b=this.mapToInitFragWhenRequired(y);b&&this.loadFragment(b,i,u)}}}loadFragment(t,e,i){Te(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new WD(this.tracksBuffered[this.currentTrackId]||[])}}class WD{constructor(t){this.buffered=void 0;const e=(i,s,a)=>{if(s=s>>>0,s>a-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${a})`);return t[s][i]};this.buffered={get length(){return t.length},end(i){return e("end",i,t.length)},start(i){return e("start",i,t.length)}}}}const QD={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},cS=r=>String.fromCharCode(QD[r]||r),Fi=15,Dn=100,ZD={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},JD={17:2,18:4,21:6,22:8,23:10,19:13,20:15},tI={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},eI={25:2,26:4,29:6,30:8,31:10,27:13,28:15},iI=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class nI{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i=typeof e=="function"?e():e;Kt.log(`${this.time} [${t}] ${i}`)}}}const $s=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class fS{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class sI{constructor(){this.uchar=" ",this.penState=new fS}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class rI{constructor(t){this.chars=[],this.pos=0,this.currPenState=new fS,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<Dn;e++)this.chars.push(new sI);this.logger=t}equals(t){for(let e=0;e<Dn;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<Dn;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<Dn;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Dn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Dn)}moveCursor(t){const e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=cS(t);if(this.pos>=Dn){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)}clearFromPos(t){let e;for(e=t;e<Dn;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<Dn;i++){const s=this.chars[i].uchar;s!==" "&&(e=!1),t.push(s)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class Cd{constructor(t){this.rows=[],this.currRow=Fi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<Fi;e++)this.rows.push(new rI(t));this.logger=t}reset(){for(let t=0;t<Fi;t++)this.rows[t].clear();this.currRow=Fi-1}equals(t){let e=!0;for(let i=0;i<Fi;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<Fi;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<Fi;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+Jt(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let u=0;u<Fi;u++)this.rows[u].clear();const a=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const u=l.rows[a].cueStartTime,d=this.logger.time;if(u!==null&&d!==null&&u<d)for(let f=0;f<this.nrRollUpRows;f++)this.rows[e-this.nrRollUpRows+f+1].copy(l.rows[a+f])}}this.currRow=e;const i=this.rows[this.currRow];if(t.indent!==null){const a=t.indent,l=Math.max(a-1,0);i.setCursor(t.indent),t.color=i.chars[l].penState.foreground}const s={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+Jt(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",s=-1;for(let a=0;a<Fi;a++){const l=this.rows[a].getTextString();l&&(s=a+1,t?e.push("Row "+s+": '"+l+"'"):e.push(l.trim()))}return e.length>0&&(t?i="["+e.join(" | ")+"]":i=e.join(`
`)),i}getTextAndFormat(){return this.rows}}class wv{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Cd(i),this.nonDisplayedMemory=new Cd(i),this.lastOutputScreen=new Cd(i),this.currRollUpRow=this.displayedMemory.rows[Fi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Fi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=s[i]}this.logger.log(2,"MIDROW: "+Jt(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;e!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=e:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Dv{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=oI(),this.logger=void 0;const s=this.logger=new nI;this.channels=[null,new wv(t,e,s),new wv(t+1,i,s)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){const s=e[i]&127,a=e[i+1]&127;let l=!1,u=null;if(s===0&&a===0)continue;this.logger.log(3,()=>"["+$s([e[i],e[i+1]])+"] -> ("+$s([s,a])+")");const d=this.cmdHistory;if(s>=16&&s<=31){if(aI(s,a,d)){Vl(null,null,d),this.logger.log(3,()=>"Repeated command ("+$s([s,a])+") is dropped");continue}Vl(s,a,this.cmdHistory),l=this.parseCmd(s,a),l||(l=this.parseMidrow(s,a)),l||(l=this.parsePAC(s,a)),l||(l=this.parseBackgroundAttributes(s,a))}else Vl(null,null,d);if(!l&&(u=this.parseChars(s,a),u)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+$s([s,a])+" orig: "+$s([e[i],e[i+1]]))}}parseCmd(t,e){const i=(t===20||t===28||t===21||t===29)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=33&&e<=35;if(!(i||s))return!1;const a=t===20||t===21||t===23?1:2,l=this.channels[a];return t===20||t===21||t===28||t===29?e===32?l.ccRCL():e===33?l.ccBS():e===34?l.ccAOF():e===35?l.ccAON():e===36?l.ccDER():e===37?l.ccRU(2):e===38?l.ccRU(3):e===39?l.ccRU(4):e===40?l.ccFON():e===41?l.ccRDC():e===42?l.ccTR():e===43?l.ccRTD():e===44?l.ccEDM():e===45?l.ccCR():e===46?l.ccENM():e===47&&l.ccEOC():l.ccTO(e-32),this.currentChannel=a,!0}parseMidrow(t,e){let i=0;if((t===17||t===25)&&e>=32&&e<=47){if(t===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return s?(s.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+$s([t,e])+")"),!0):!1}return!1}parsePAC(t,e){let i;const s=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,a=(t===16||t===24)&&e>=64&&e<=95;if(!(s||a))return!1;const l=t<=23?1:2;e>=64&&e<=95?i=l===1?ZD[t]:tI[t]:i=l===1?JD[t]:eI[t];const u=this.channels[l];return u?(u.setPAC(this.interpretPAC(i,e)),this.currentChannel=l,!0):!1}interpretPAC(t,e){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:t};return e>95?i=e-96:i=e-64,s.underline=(i&1)===1,i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((i-16)/2)*4,s}parseChars(t,e){let i,s=null,a=null;if(t>=25?(i=2,a=t-8):(i=1,a=t),a>=17&&a<=19){let l;a===17?l=e+80:a===18?l=e+112:l=e+144,this.logger.log(2,()=>"Special char '"+cS(l)+"' in channel "+i),s=[l]}else t>=32&&t<=127&&(s=e===0?[t]:[t,e]);return s&&this.logger.log(3,()=>"Char codes =  "+$s(s).join(",")),s}parseBackgroundAttributes(t,e){const i=(t===16||t===24)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=45&&e<=47;if(!(i||s))return!1;let a;const l={};t===16||t===24?(a=Math.floor((e-32)/2),l.background=iI[a],e%2===1&&(l.background=l.background+"_semi")):e===45?l.background="transparent":(l.foreground="black",e===47&&(l.underline=!0));const u=t<=23?1:2;return this.channels[u].setBkgData(l),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}Vl(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function Vl(r,t,e){e.a=r,e.b=t}function aI(r,t,e){return e.a===r&&e.b===t}function oI(){return{a:null,b:null}}var Wh=(function(){if(Su!=null&&Su.VTTCue)return self.VTTCue;const r=["","lr","rl"],t=["start","middle","end","left","right"];function e(u,d){if(typeof d!="string"||!Array.isArray(u))return!1;const f=d.toLowerCase();return~u.indexOf(f)?f:!1}function i(u){return e(r,u)}function s(u){return e(t,u)}function a(u,...d){let f=1;for(;f<arguments.length;f++){const h=arguments[f];for(const p in h)u[p]=h[p]}return u}function l(u,d,f){const h=this,p={enumerable:!0};h.hasBeenReset=!1;let g="",v=!1,y=u,S=d,T=f,A=null,b="",R=!0,C="auto",D="start",N=50,w="middle",P=50,B="middle";Object.defineProperty(h,"id",a({},p,{get:function(){return g},set:function(M){g=""+M}})),Object.defineProperty(h,"pauseOnExit",a({},p,{get:function(){return v},set:function(M){v=!!M}})),Object.defineProperty(h,"startTime",a({},p,{get:function(){return y},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");y=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",a({},p,{get:function(){return S},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");S=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",a({},p,{get:function(){return T},set:function(M){T=""+M,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",a({},p,{get:function(){return A},set:function(M){A=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",a({},p,{get:function(){return b},set:function(M){const q=i(M);if(q===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=q,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",a({},p,{get:function(){return R},set:function(M){R=!!M,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",a({},p,{get:function(){return C},set:function(M){if(typeof M!="number"&&M!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",a({},p,{get:function(){return D},set:function(M){const q=s(M);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");D=q,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",a({},p,{get:function(){return N},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");N=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",a({},p,{get:function(){return w},set:function(M){const q=s(M);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");w=q,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",a({},p,{get:function(){return P},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");P=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",a({},p,{get:function(){return B},set:function(M){const q=s(M);if(!q)throw new SyntaxError("An invalid or illegal string was specified.");B=q,this.hasBeenReset=!0}})),h.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l})();class lI{decode(t,e){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function dS(r){function t(i,s,a,l){return(i|0)*3600+(s|0)*60+(a|0)+parseFloat(l||0)}const e=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return e?parseFloat(e[2])>59?t(e[2],e[3],0,e[4]):t(e[1],e[2],e[3],e[4]):null}class uI{constructor(){this.values=Object.create(null)}set(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let s=0;s<i.length;++s)if(e===i[s]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function hS(r,t,e,i){const s=i?r.split(i):[r];for(const a in s){if(typeof s[a]!="string")continue;const l=s[a].split(e);if(l.length!==2)continue;const u=l[0],d=l[1];t(u,d)}}const ah=new Wh(0,0,""),Kl=ah.align==="middle"?"middle":"center";function cI(r,t,e){const i=r;function s(){const u=dS(r);if(u===null)throw new Error("Malformed timestamp: "+i);return r=r.replace(/^[^\sa-zA-Z-]+/,""),u}function a(u,d){const f=new uI;hS(u,function(g,v){let y;switch(g){case"region":for(let S=e.length-1;S>=0;S--)if(e[S].id===v){f.set(g,e[S].region);break}break;case"vertical":f.alt(g,v,["rl","lr"]);break;case"line":y=v.split(","),f.integer(g,y[0]),f.percent(g,y[0])&&f.set("snapToLines",!1),f.alt(g,y[0],["auto"]),y.length===2&&f.alt("lineAlign",y[1],["start",Kl,"end"]);break;case"position":y=v.split(","),f.percent(g,y[0]),y.length===2&&f.alt("positionAlign",y[1],["start",Kl,"end","line-left","line-right","auto"]);break;case"size":f.percent(g,v);break;case"align":f.alt(g,v,["start",Kl,"end","left","right"]);break}},/:/,/\s/),d.region=f.get("region",null),d.vertical=f.get("vertical","");let h=f.get("line","auto");h==="auto"&&ah.line===-1&&(h=-1),d.line=h,d.lineAlign=f.get("lineAlign","start"),d.snapToLines=f.get("snapToLines",!0),d.size=f.get("size",100),d.align=f.get("align",Kl);let p=f.get("position","auto");p==="auto"&&ah.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function l(){r=r.replace(/^\s+/,"")}if(l(),t.startTime=s(),l(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);r=r.slice(3),l(),t.endTime=s(),l(),a(r,t)}function mS(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class fI{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new lI,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){let a=e.buffer,l=0;for(a=mS(a);l<a.length&&a[l]!=="\r"&&a[l]!==`
`;)++l;const u=a.slice(0,l);return a[l]==="\r"&&++l,a[l]===`
`&&++l,e.buffer=a.slice(l),u}function s(a){hS(a,function(l,u){},/:/)}try{let a="";if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;a=i();const u=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let l=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(l?l=!1:a=i(),e.state){case"HEADER":/:/.test(a)?s(a):a||(e.state="ID");continue;case"NOTE":a||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){e.state="NOTE";break}if(!a)continue;if(e.cue=new Wh(0,0,""),e.state="CUE",a.indexOf("-->")===-1){e.cue.id=a;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{cI(a,e.cue,e.regionList)}catch{e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const u=a.indexOf("-->")!==-1;if(!a||u&&(l=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(e.cue===null)continue;e.cue.text&&(e.cue.text+=`
`),e.cue.text+=a}continue;case"BADCUE":a||(e.state="ID")}}}catch{e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const dI=/\r\n|\n\r|\n|\r/g,wd=function(t,e,i=0){return t.slice(i,i+e.length)===e},hI=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),s=parseInt(t.slice(-9,-7)),a=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!ht(e)||!ht(i)||!ht(s)||!ht(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=60*1e3*s,e+=3600*1e3*a,e};function Qh(r,t,e){return Ja(r.toString())+Ja(t.toString())+Ja(e)}const mI=function(t,e,i){let s=t[e],a=t[s.prevCC];if(!a||!a.new&&s.new){t.ccOffset=t.presentationOffset=s.start,s.new=!1;return}for(;(l=a)!=null&&l.new;){var l;t.ccOffset+=s.start-a.start,s.new=!1,s=a,a=t[s.prevCC]}t.presentationOffset=i};function pI(r,t,e,i,s,a,l){const u=new fI,d=Ei(new Uint8Array(r)).trim().replace(dI,`
`).split(`
`),f=[],h=t?Sw(t.baseTime,t.timescale):0;let p="00:00.000",g=0,v=0,y,S=!0;u.oncue=function(T){const A=e[i];let b=e.ccOffset;const R=(g-h)/9e4;if(A!=null&&A.new&&(v!==void 0?b=e.ccOffset=A.start:mI(e,i,R)),R){if(!t){y=new Error("Missing initPTS for VTT MPEGTS");return}b=R-e.presentationOffset}const C=T.endTime-T.startTime,D=pi((T.startTime+b-v)*9e4,s*9e4)/9e4;T.startTime=Math.max(D,0),T.endTime=Math.max(D+C,0);const N=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(N)),T.id||(T.id=Qh(T.startTime,T.endTime,N)),T.endTime>0&&f.push(T)},u.onparsingerror=function(T){y=T},u.onflush=function(){if(y){l(y);return}a(f)},d.forEach(T=>{if(S)if(wd(T,"X-TIMESTAMP-MAP=")){S=!1,T.slice(16).split(",").forEach(A=>{wd(A,"LOCAL:")?p=A.slice(6):wd(A,"MPEGTS:")&&(g=parseInt(A.slice(7)))});try{v=hI(p)/1e3}catch(A){y=A}return}else T===""&&(S=!1);u.parse(T+`
`)}),u.flush()}const Dd="stpp.ttml.im1t",pS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,gS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,gI={left:"start",center:"center",right:"end",start:"start",end:"end"};function Iv(r,t,e,i){const s=Dt(new Uint8Array(r),["mdat"]);if(s.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const a=s.map(u=>Ei(u)),l=xw(t.baseTime,1,t.timescale);try{a.forEach(u=>e(yI(u,l)))}catch(u){i(u)}}function yI(r,t){const s=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(a).reduce((p,g)=>(p[g]=s.getAttribute(`ttp:${g}`)||a[g],p),{}),u=s.getAttribute("xml:space")!=="preserve",d=Ov(Id(s,"styling","style")),f=Ov(Id(s,"layout","region")),h=Id(s,"body","[begin]");return[].map.call(h,p=>{const g=yS(p,u);if(!g||!p.hasAttribute("begin"))return null;const v=kd(p.getAttribute("begin"),l),y=kd(p.getAttribute("dur"),l);let S=kd(p.getAttribute("end"),l);if(v===null)throw kv(p);if(S===null){if(y===null)throw kv(p);S=v+y}const T=new Wh(v-t,S-t,g);T.id=Qh(T.startTime,T.endTime,T.text);const A=f[p.getAttribute("region")],b=d[p.getAttribute("style")],R=vI(A,b,d),{textAlign:C}=R;if(C){const D=gI[C];D&&(T.lineAlign=D),T.align=C}return Wt(T,R),T}).filter(p=>p!==null)}function Id(r,t,e){const i=r.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(e)):[]}function Ov(r){return r.reduce((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t},{})}function yS(r,t){return[].slice.call(r.childNodes).reduce((e,i,s)=>{var a;return i.nodeName==="br"&&s?e+`
`:(a=i.childNodes)!=null&&a.length?yS(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function vI(r,t,e){const i="http://www.w3.org/ns/ttml#styling";let s=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return l&&e.hasOwnProperty(l)&&(s=e[l]),a.reduce((u,d)=>{const f=Od(t,i,d)||Od(r,i,d)||Od(s,i,d);return f&&(u[d]=f),u},{})}function Od(r,t,e){return r&&r.hasAttributeNS(t,e)?r.getAttributeNS(t,e):null}function kv(r){return new Error(`Could not parse ttml timestamp ${r}`)}function kd(r,t){if(!r)return null;let e=dS(r);return e===null&&(pS.test(r)?e=EI(r,t):gS.test(r)&&(e=xI(r,t))),e}function EI(r,t){const e=pS.exec(r),i=(e[4]|0)+(e[5]|0)/t.subFrameRate;return(e[1]|0)*3600+(e[2]|0)*60+(e[3]|0)+i/t.frameRate}function xI(r,t){const e=gS.exec(r),i=Number(e[1]);switch(e[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class ql{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class SI{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Pv(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this),t.on(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(_.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this),t.off(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(_.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new ql(this,"textTrack1"),e=new ql(this,"textTrack2"),i=new ql(this,"textTrack3"),s=new ql(this,"textTrack4");this.cea608Parser1=new Dv(1,t,e),this.cea608Parser2=new Dv(3,i,s)}addCues(t,e,i,s,a){let l=!1;for(let u=a.length;u--;){const d=a[u],f=TI(d[0],d[1],e,i);if(f>=0&&(d[0]=Math.min(d[0],e),d[1]=Math.max(d[1],i),l=!0,f/(i-e)>.5))return}if(l||a.push([e,i]),this.config.renderTextTracksNatively){const u=this.captionsTracks[t];this.Cues.newCue(u,e,i,s)}else{const u=this.Cues.newCue(null,e,i,s);this.hls.trigger(_.CUES_PARSED,{type:"captions",cues:u,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:a,trackId:l}){const{unparsedVttFrags:u}=this;i===mt.MAIN&&(this.initPTS[e.cc]={baseTime:s,timescale:a,trackId:l}),u.length&&(this.unparsedVttFrags=[],u.forEach(d=>{this.initPTS[d.frag.cc]?this.onFragLoaded(_.FRAG_LOADED,d):this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){const a=i.textTracks[s];if(Mv(a,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:s}=this,{label:a,languageCode:l}=e[t],u=this.getExistingTrack(a,l);if(u)i[t]=u,jr(i[t]),oS(i[t],s);else{const d=this.createTextTrack("captions",a,l);d&&(d[t]=!0,i[t]=d)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const i=e.label,s={_id:t,label:i,kind:"captions",default:e.media?!!e.media.default:!1,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=s,this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(t,e,i){const s=this.media;if(s)return s.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const i=!!e.transferMedia;if(this.media=null,i)return;const{captionsTracks:s}=this;Object.keys(s).forEach(a=>{jr(s[a]),delete s[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Pv(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let i=0;i<e.length;i++)jr(e[i])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],s=i.some(a=>a.textCodec===Dd);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(Yx(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const l=this.media,u=l?ru(l.textTracks):null;if(this.tracks.forEach((d,f)=>{let h;if(u){let p=null;for(let g=0;g<u.length;g++)if(u[g]&&Mv(u[g],d)){p=u[g],u[g]=null;break}p&&(h=p)}if(h)jr(h);else{const p=vS(d);h=this.createTextTrack(p,d.name,d.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),u!=null&&u.length){const d=u.filter(f=>f!==null).map(f=>f.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(i=>{const s=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!s)return;const a=`textTrack${s[1]}`,l=this.captionsProperties[a];l&&(l.label=i.name,i.lang&&(l.languageCode=i.lang),l.media=i)})}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return e?.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===mt.MAIN){var i,s;const{cea608Parser1:a,cea608Parser2:l,lastSn:u}=this,{cc:d,sn:f}=e.frag,h=(i=(s=e.part)==null?void 0:s.index)!=null?i:-1;a&&l&&(f!==u+1||f===u&&h!==this.lastPartIndex+1||d!==this.lastCc)&&(a.reset(),l.reset()),this.lastCc=d,this.lastSn=f,this.lastPartIndex=h}}onFragLoaded(t,e){const{frag:i,payload:s}=e;if(i.type===mt.SUBTITLE)if(s.byteLength){const a=i.decryptdata,l="stats"in e;if(a==null||!a.encrypted||l){const u=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),u&&u.textCodec===Dd?this._parseIMSC1(i,s):this._parseVTTs(e)}}else this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;Iv(e,this.initPTS[t.cc],s=>{this._appendCues(s,t.level),i.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},s=>{i.logger.log(`Failed to parse IMSC1: ${s}`),i.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:s})})}_parseVTTs(t){var e;const{frag:i,payload:s}=t,{initPTS:a,unparsedVttFrags:l}=this,u=a.length-1;if(!a[i.cc]&&u===-1){l.push(t);return}const d=this.hls,f=(e=i.initSegment)!=null&&e.data?Ii(i.initSegment.data,new Uint8Array(s)).buffer:s;pI(f,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,h=>{this._appendCues(h,i.level),d.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},h=>{const p=h.message==="Missing initPTS for VTT MPEGTS";p?l.push(t):this._fallbackToIMSC1(i,s),d.logger.log(`Failed to parse VTT cue: ${h}`),!(p&&u>i.cc)&&d.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:h})})}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||Iv(e,this.initPTS[t.cc],()=>{i.textCodec=Dd,this._parseIMSC1(t,e)},()=>{i.textCodec="wvtt"})}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[e];if(!s||s.mode==="disabled")return;t.forEach(a=>lS(s,a))}else{const s=this.tracks[e];if(!s)return;const a=s.default?"default":"subtitles"+e;i.trigger(_.CUES_PARSED,{type:"subtitles",cues:t,track:a})}}onFragDecrypted(t,e){const{frag:i}=e;i.type===mt.SUBTITLE&&this.onFragLoaded(_.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:s}=e;if(!(i.type===mt.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let a=0;a<s.length;a++){const l=s[a].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(l);this.cea608Parser1.addData(s[a].pts,u[0]),this.cea608Parser2.addData(s[a].pts,u[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:s,type:a}){const{media:l}=this;if(!(!l||l.currentTime<i)){if(!a||a==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(d=>rh(u[d],e,i))}if(this.config.renderTextTracksNatively&&e===0&&s!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(d=>rh(u[d],e,s))}}}extractCea608Data(t){const e=[[],[]],i=t[0]&31;let s=2;for(let a=0;a<i;a++){const l=t[s++],u=127&t[s++],d=127&t[s++];if(u===0&&d===0)continue;if((4&l)!==0){const h=3&l;(h===0||h===1)&&(e[h].push(u),e[h].push(d))}}return e}}function vS(r){return r.characteristics&&/transcribes-spoken-dialog/gi.test(r.characteristics)&&/describes-music-and-sound/gi.test(r.characteristics)?"captions":"subtitles"}function Mv(r,t){return!!r&&r.kind===vS(t)&&eh(t,r)}function TI(r,t,e,i){return Math.min(t,i)-Math.max(r,e)}function Pv(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const bI=/\s/,AI={newCue(r,t,e,i){const s=[];let a,l,u,d,f;const h=self.VTTCue||self.TextTrackCue;for(let g=0;g<i.rows.length;g++)if(a=i.rows[g],u=!0,d=0,f="",!a.isEmpty()){var p;for(let S=0;S<a.chars.length;S++)bI.test(a.chars[S].uchar)&&u?d++:(f+=a.chars[S].uchar,u=!1);a.cueStartTime=t,t===e&&(e+=1e-4),d>=16?d--:d++;const v=mS(f.trim()),y=Qh(t,e,v);r!=null&&(p=r.cues)!=null&&p.getCueById(y)||(l=new h(t,e,v),l.id=y,l.line=g+1,l.align="left",l.position=10+Math.min(80,Math.floor(d*8/32)*10),s.push(l))}return r&&s.length&&(s.sort((g,v)=>g.line==="auto"||v.line==="auto"?0:g.line>8&&v.line>8?v.line-g.line:g.line-v.line),s.forEach(g=>lS(r,g))),s}};function RI(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const LI=/(\d+)-(\d+)\/(\d+)/;class Nv{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||DI,this.controller=new self.AbortController,this.stats=new wh}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const a=_I(t,this.controller.signal),l=t.responseType==="arraybuffer",u=l?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:f}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,a),self.clearTimeout(this.requestTimeout),e.timeout=d&&ht(d)?d:f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},e.timeout),(lo(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var g;this.response=this.loader=p;const v=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},f-(v-s.loading.start)),!p.ok){const{status:S,statusText:T}=p;throw new II(T||"fetch, bad network response",S,p)}s.loading.first=v,s.total=wI(p.headers)||s.total;const y=(g=this.callbacks)==null?void 0:g.onProgress;return y&&ht(e.highWaterMark)?this.loadProgressively(p,s,t,e.highWaterMark,y):l?p.arrayBuffer():t.responseType==="json"?p.json():p.text()}).then(p=>{var g,v;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const S=p[u];S&&(s.loaded=s.total=S);const T={url:y.url,data:p,code:y.status},A=(g=this.callbacks)==null?void 0:g.onProgress;A&&!ht(e.highWaterMark)&&A(s,t,p,y),(v=this.callbacks)==null||v.onSuccess(T,s,t,y)}).catch(p=>{var g;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const v=p&&p.code||0,y=p?p.message:null;(g=this.callbacks)==null||g.onError({code:v,text:y},t,p?p.details:null,s)})}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,s=0,a){const l=new Cx,u=t.body.getReader(),d=()=>u.read().then(f=>{if(f.done)return l.dataLength&&a(e,i,l.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const h=f.value,p=h.length;return e.loaded+=p,p<s||l.dataLength?(l.push(h),l.dataLength>=s&&a(e,i,l.flush().buffer,t)):a(e,i,h.buffer,t),d()}).catch(()=>Promise.reject());return d()}}function _I(r,t){const e={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Wt({},r.headers))};return r.rangeEnd&&e.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),e}function CI(r){const t=LI.exec(r);if(t)return parseInt(t[2])-parseInt(t[1])+1}function wI(r){const t=r.get("Content-Range");if(t){const i=CI(t);if(ht(i))return i}const e=r.get("Content-Length");if(e)return parseInt(e)}function DI(r,t){return new self.Request(r.url,t)}class II extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const OI=/^age:\s*[\d.]+\s*$/im;class ES{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new wh,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return a(i,e.url)}).catch(l=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",e.url,!0),a(i,e.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)}).catch(l=>{var u;(u=this.callbacks)==null||u.onError({code:i.status,text:l.message},e,i,s)}):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const s=e.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:l}=i.loadPolicy;if(s)for(const u in s)t.setRequestHeader(u,s[u]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&ht(a)?a:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const s=e.readyState,a=this.config;if(!i.aborted&&s>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const f=e.status,h=e.responseType==="text"?e.responseText:null;if(f>=200&&f<300){const y=h??e.response;if(y!=null){var l,u;i.loading.end=Math.max(self.performance.now(),i.loading.first);const S=e.responseType==="arraybuffer"?y.byteLength:y.length;i.loaded=i.total=S,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const T=(l=this.callbacks)==null?void 0:l.onProgress;T&&T(i,t,y,e);const A={url:e.responseURL,data:y,code:f};(u=this.callbacks)==null||u.onSuccess(A,i,t,e);return}}const p=a.loadPolicy.errorRetry,g=i.retry,v={url:t.url,data:void 0,code:f};if(Eu(p,g,!1,v))this.retry(p);else{var d;Kt.error(`${f} while loading ${t.url}`),(d=this.callbacks)==null||d.onError({code:f,text:e.statusText},t,e,i)}}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry,e=this.stats.retry;if(Eu(t,e,!0))this.retry(t);else{var i;Kt.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=kh(t,i.retry),i.retry++,Kt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e?.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&OI.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const kI={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},MI=Vt(Vt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:ES,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:K_,bufferController:Nw,capLevelController:qh,errorController:Q_,fpsController:FD,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:yx,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:kI},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},PI()),{},{subtitleStreamController:XD,subtitleTrackController:$D,timelineController:SI,audioStreamController:Ow,audioTrackController:kw,emeController:Vr,cmcdController:kD,contentSteeringController:PD,interstitialsController:YD});function PI(){return{cueHandler:AI,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function NI(r,t,e){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=oh(r),s=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(l=>{const u=`${l==="level"?"playlist":l}LoadPolicy`,d=t[u]===void 0,f=[];a.forEach(h=>{const p=`${l}Loading${h}`,g=t[p];if(g!==void 0&&d){f.push(p);const v=i[u].default;switch(t[u]={default:v},h){case"TimeOut":v.maxLoadTimeMs=g,v.maxTimeToFirstByteMs=g;break;case"MaxRetry":v.errorRetry.maxNumRetry=g,v.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":v.errorRetry.retryDelayMs=g,v.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=g,v.timeoutRetry.maxRetryDelayMs=g;break}}}),f.length&&e.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${u}": ${Jt(t[u])}`)}),Vt(Vt({},i),t)}function oh(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(oh):Object.keys(r).reduce((t,e)=>(t[e]=oh(r[e]),t),{}):r}function FI(r,t){const e=r.loader;e!==Nv&&e!==ES?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):RI()&&(r.loader=Nv,r.progressive=!0,r.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}const au=2,BI=.1,UI=.05,$I=100;class jI extends dx{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1})}},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval($I),this.mediaSource=e.mediaSource;const i=this.media=e.media;Ye(i,"playing",this.onMediaPlaying),Ye(i,"waiting",this.onMediaWaiting),Ye(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:i}=this;i&&(si(i,"playing",this.onMediaPlaying),si(i,"waiting",this.onMediaWaiting),si(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(!((t=this.media)!=null&&t.readyState)||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,s;const a=(i=this.hls)==null?void 0:i.config;if(!a)return;const l=this.media;if(!l)return;const{seeking:u}=l,d=this.seeking&&!u,f=!this.seeking&&u,h=l.paused&&!u||l.ended||l.playbackRate===0;if(this.seeking=u,t!==e){e&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!h&&t>e&&this.nudgeOnVideoHole(t,e)),this.waiting===0&&this.stallResolved(t);return}if(f||d){d&&this.stallResolved(t);return}if(h){this.nudgeRetry=0,this.stallResolved(t),!this.ended&&l.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1}));return}if(!At.getBuffered(l).length){this.nudgeRetry=0;return}const p=At.bufferInfo(l,t,0),g=p.nextStart||0,v=this.fragmentTracker;if(u&&v&&this.hls){const N=Fv(this.hls.inFlightFragments,t),w=p.len>au,P=!g||N||g-t>au&&!v.getPartialFragment(t);if(w||P)return;this.moved=!1}const y=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(p.len>0)&&!g)return;const w=Math.max(g,p.start||0)-t,B=!!(y!=null&&y.live)?y.targetduration*2:au,M=Yl(t,v);if(w>0&&(w<=B||M)){l.paused||this._trySkipBufferHole(M);return}}const S=a.detectStallWithCurrentTimeMs,T=self.performance.now(),A=this.waiting;let b=this.stalled;if(b===null)if(A>0&&T-A<S)b=this.stalled=A;else{this.stalled=T;return}const R=T-b;if(!u&&(R>=S||A)&&this.hls){var C;if(((C=this.mediaSource)==null?void 0:C.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(t-(y?.edge||0))<1){if(this.ended)return;this.ended=t||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const D=At.bufferInfo(l,t,a.maxBufferHole);this._tryFixBufferStall(D,R,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(_.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&s&&s.length>1&&t>s.end(0)){const a=At.bufferedInfo(At.timeRangesToArray(this.buffered.audio),t,0);if(a.len>1&&e>=a.start){const l=At.timeRangesToArray(s),u=At.bufferedInfo(l,e,0).bufferedIndex;if(u>-1&&u<l.length-1){const d=At.bufferedInfo(l,t,0).bufferedIndex,f=l[u].end,h=l[u+1].start;if((d===-1||d>u)&&h-f<1&&t-f<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${f} -> ${h} buffered index: ${d}`);this.warn(p.message),this.media.currentTime+=1e-6;let g=Yl(t,this.fragmentTracker);g&&"fragment"in g?g=g.fragment:g||(g=void 0);const v=At.bufferInfo(this.media,t,0);this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:g,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(t,e,i){var s,a;const{fragmentTracker:l,media:u}=this,d=(s=this.hls)==null?void 0:s.config;if(!u||!l||!d)return;const f=(a=this.hls)==null?void 0:a.latestLevelDetails,h=Yl(i,l);if((h||f!=null&&f.live&&i<f.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const p=t.buffered,g=this.adjacentTraversal(t,i);(p&&p.length>1&&t.len>d.maxBufferHole||t.nextStart&&(t.nextStart-i<d.maxBufferHole||g))&&(e>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const i=this.fragmentTracker,s=t.nextStart;if(i&&s){const a=i.getFragAtPos(e,mt.MAIN),l=i.getFragAtPos(s,mt.MAIN);if(a&&l)return l.sn-a.sn<2}return!1}_reportStall(t){const{hls:e,media:i,stallReported:s,stalled:a}=this;if(!s&&a!==null&&i&&e){this.stallReported=!0;const l=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Jt(t)})`);this.warn(l.message),e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:t.len,bufferInfo:t,stalled:{start:a}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:i,media:s}=this,a=(e=this.hls)==null?void 0:e.config;if(!s||!i||!a)return 0;const l=s.currentTime,u=At.bufferInfo(s,l,0),d=l<u.start?u.start:u.nextStart;if(d&&this.hls){const h=u.len<=a.maxBufferHole,p=u.len>0&&u.len<1&&s.readyState<3,g=d-l;if(g>0&&(h||p)){if(g>a.maxBufferHole){let y=!1;if(l===0){const S=i.getAppendedFrag(0,mt.MAIN);S&&d<S.end&&(y=!0)}if(!y&&t){var f;if(!((f=this.hls.loadLevelObj)!=null&&f.details)||Fv(this.hls.inFlightFragments,d))return 0;let T=!1,A=t.end;for(;A<d;){const b=Yl(A,i);if(b)A+=b.duration;else{T=!0;break}}if(T)return 0}}const v=Math.max(d+UI,l+BI);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${v}`),this.moved=!0,s.currentTime=v,!(t!=null&&t.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${v}`),S={type:vt.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:u.len,bufferInfo:u};t&&("fragment"in t?S.part=t:S.frag=t),this.hls.trigger(_.ERROR,S)}return v}}return 0}_tryNudgeBuffer(t){const{hls:e,media:i,nudgeRetry:s}=this,a=e?.config;if(!i||!a)return 0;const l=i.currentTime;if(this.nudgeRetry++,s<a.nudgeMaxRetry){const u=l+(s+1)*a.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${l} to ${u}`);this.warn(d.message),i.currentTime=u,e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:t.len,bufferInfo:t})}else{const u=new Error(`Playhead still not moving while enough data buffered @${l} after ${a.nudgeMaxRetry} nudges`);this.error(u.message),e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:t.len,bufferInfo:t})}}}function Fv(r,t){const e=Bv(r.main);if(e&&e.start<=t)return e;const i=Bv(r.audio);return i&&i.start<=t?i:null}function Bv(r){if(!r)return null;switch(r.state){case at.IDLE:case at.STOPPED:case at.ENDED:case at.ERROR:return null}return r.frag}function Yl(r,t){return t.getAppendedFrag(r,mt.MAIN)||t.getPartialFragment(r)}const GI=.25;function lh(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Md(r,t,e,i,s){let a=new r(t,e,"");try{a.value=i,s&&(a.type=s)}catch{a=new r(t,e,Jt(s?Vt({type:s},i):i))}return a}const Xl=(()=>{const r=lh();try{r&&new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class HI{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(_.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var i;this.media=e.media,((i=e.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var t;const e=(t=this.hls)==null?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null,!e.transferMedia&&(this.id3Track&&(this.removeCues&&jr(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if(i.kind==="metadata"&&i.label==="id3")return oS(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:s}=this.hls.config;if(!i&&!s)return;const{samples:a}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=lh();if(l)for(let u=0;u<a.length;u++){const d=a[u].type;if(d===yi.emsg&&!i||!s)continue;const f=Px(a[u].data),h=a[u].pts;let p=h+a[u].duration;p>Xl&&(p=Xl),p-h<=0&&(p=h+GI);for(let v=0;v<f.length;v++){const y=f[v];if(!Nx(y)){this.updateId3CueEnds(h,d);const S=Md(l,h,p,y,d);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(t,e){var i;const s=(i=this.id3Track)==null?void 0:i.cues;if(s)for(let a=s.length;a--;){const l=s[a];l.type===e&&l.startTime<t&&l.endTime===Xl&&(l.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:s}){const{id3Track:a,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:d}}=l;if(a&&(u||d)){let f;s==="audio"?f=h=>h.type===yi.audioId3&&d:s==="video"?f=h=>h.type===yi.emsg&&u:f=h=>h.type===yi.audioId3&&d||h.type===yi.emsg&&u,rh(a,e,i,f)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:s,enableDateRangeMetadataCues:a,interstitialsController:l}=this.hls.config;if(!a)return;const u=lh();if(i&&s&&!l){const{fragmentStart:S,fragmentEnd:T}=t;let A=this.assetCue;A?(A.startTime=S,A.endTime=T):u&&(A=this.assetCue=Md(u,S,T,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),A&&(A.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(A),A.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:d}=this,{dateRanges:f}=t,h=Object.keys(f);let p=this.dateRangeCuesAppended;if(d&&e){var g;if((g=d.cues)!=null&&g.length){const S=Object.keys(p).filter(T=>!h.includes(T));for(let T=S.length;T--;){var v;const A=S[T],b=(v=p[A])==null?void 0:v.cues;delete p[A],b&&Object.keys(b).forEach(R=>{const C=b[R];if(C){C.removeEventListener("enter",this.onEventCueEnter);try{d.removeCue(C)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const y=t.fragments[t.fragments.length-1];if(!(h.length===0||!ht(y?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<h.length;S++){const T=h[S],A=f[T],b=A.startTime,R=p[T],C=R?.cues||{};let D=R?.durationKnown||!1,N=Xl;const{duration:w,endDate:P}=A;if(P&&w!==null)N=b+w,D=!0;else if(A.endOnNext&&!D){const M=h.reduce((q,tt)=>{if(tt!==A.id){const V=f[tt];if(V.class===A.class&&V.startDate>A.startDate&&(!q||A.startDate<q.startDate))return V}return q},null);M&&(N=M.startTime,D=!0)}const B=Object.keys(A.attr);for(let M=0;M<B.length;M++){const q=B[M];if(!cC(q))continue;const tt=C[q];if(tt)D&&!(R!=null&&R.durationKnown)?tt.endTime=N:Math.abs(tt.startTime-b)>.01&&(tt.startTime=b,tt.endTime=N);else if(u){let V=A.attr[q];fC(q)&&(V=KE(V));const X=Md(u,b,N,{key:q,data:V},yi.dateRange);X&&(X.id=T,this.id3Track.addCue(X),C[q]=X,l&&(q==="X-ASSET-LIST"||q==="X-ASSET-URL")&&X.addEventListener("enter",this.onEventCueEnter))}}p[T]={cues:C,dateRange:A,durationKnown:D}}}}}class zI{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,i=this.levelDetails;if(!e||!i)return;this.currentTime=e.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:l}=this.config;if(!a||l===1||!i.live)return;const u=this.targetLatency;if(u===null)return;const d=s-u,f=Math.min(this.maxLatency,u+i.targetduration);if(d<f&&d>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,l)),g=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,v=Math.min(p,Math.max(1,g));this.changeMediaPlaybackRate(e,v)}else e.playbackRate!==1&&e.playbackRate!==0&&this.changeMediaPlaybackRate(e,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return((t=this.hls)==null?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(t.liveMaxLatencyDuration!==void 0)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(t===null||this.hls===null)return null;const{holdBack:e,partHoldBack:i,targetduration:s}=t,{liveSyncDuration:a,liveSyncDurationCount:l,lowLatencyMode:u}=this.config,d=this.hls.userConfig;let f=u&&i||e;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||f===0)&&(f=a!==void 0?a:l*s);const h=s;return f+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(t===null||e===null)return null;const i=this.levelDetails;if(i===null)return null;const s=i.edge,a=t-e-this.edgeStalled,l=s-i.totalduration,u=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(l,a),u)}get drift(){const t=this.levelDetails;return t===null?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(t===null)return 0;const e=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,s;t.playbackRate!==e&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}class VI extends Kh{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,s=[],a={},l={};let u=!1,d=!1,f=!1;e.levels.forEach(h=>{const p=h.attrs;let{audioCodec:g,videoCodec:v}=h;g&&(h.audioCodec=g=pu(g,i)||void 0),v&&(v=h.videoCodec=__(v));const{width:y,height:S,unknownCodecs:T}=h,A=T?.length||0;if(u||(u=!!(y&&S)),d||(d=!!v),f||(f=!!g),A||g&&!this.isAudioSupported(g)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:b,"FRAME-RATE":R,"HDCP-LEVEL":C,"PATHWAY-ID":D,RESOLUTION:N,"VIDEO-RANGE":w}=p,B=`${`${D||"."}-`}${h.bitrate}-${N}-${R}-${b}-${w}-${C}`;if(a[B])if(a[B].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const M=l[B]+=1;h.attrs["PATHWAY-ID"]=new Array(M+1).join(".");const q=this.createLevel(h);a[B]=q,s.push(q)}else a[B].addGroupId("audio",p.AUDIO),a[B].addGroupId("text",p.SUBTITLES);else{const M=this.createLevel(h);a[B]=M,l[B]=1,s.push(M)}}),this.filterAndSortMediaOptions(s,e,u,d,f)}createLevel(t){const e=new ro(t),i=t.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(s.message),e.supportedResult=sx(s,[])}return e}isAudioSupported(t){return no(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return no(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,s,a){var l;let u=[],d=[],f=t;const h=((l=e.stats)==null?void 0:l.parsing)||{};if((i||s)&&a&&(f=f.filter(({videoCodec:b,videoRange:R,width:C,height:D})=>(!!b||!!(C&&D))&&F_(R))),f.length===0){Promise.resolve().then(()=>{if(this.hls){let b="no level with compatible codecs found in manifest",R=b;e.levels.length&&(R=`one or more CODECS in variant not supported: ${Jt(e.levels.map(D=>D.attrs.CODECS).filter((D,N,w)=>w.indexOf(D)===N))}`,this.warn(R),b+=` (${R})`);const C=new Error(b);this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:C,reason:R})}}),h.end=performance.now();return}e.audioTracks&&(u=e.audioTracks.filter(b=>!b.audioCodec||this.isAudioSupported(b.audioCodec)),Uv(u)),e.subtitles&&(d=e.subtitles,Uv(d));const p=f.slice(0);f.sort((b,R)=>{if(b.attrs["HDCP-LEVEL"]!==R.attrs["HDCP-LEVEL"])return(b.attrs["HDCP-LEVEL"]||"")>(R.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&b.height!==R.height)return b.height-R.height;if(b.frameRate!==R.frameRate)return b.frameRate-R.frameRate;if(b.videoRange!==R.videoRange)return gu.indexOf(b.videoRange)-gu.indexOf(R.videoRange);if(b.videoCodec!==R.videoCodec){const C=Dy(b.videoCodec),D=Dy(R.videoCodec);if(C!==D)return D-C}if(b.uri===R.uri&&b.codecSet!==R.codecSet){const C=mu(b.codecSet),D=mu(R.codecSet);if(C!==D)return D-C}return b.averageBitrate!==R.averageBitrate?b.averageBitrate-R.averageBitrate:0});let g=p[0];if(this.steering&&(f=this.steering.filterParsedLevels(f),f.length!==p.length)){for(let b=0;b<p.length;b++)if(p[b].pathwayId===f[0].pathwayId){g=p[b];break}}this._levels=f;for(let b=0;b<f.length;b++)if(f[b]===g){var v;this._firstLevel=b;const R=g.bitrate,C=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${f.length} level(s) found, first bitrate: ${R}`),((v=this.hls.userConfig)==null?void 0:v.abrEwmaDefaultEstimate)===void 0){const D=Math.min(R,this.hls.config.abrEwmaDefaultEstimateMax);D>C&&C===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=D)}break}const y=a&&!s,S=this.hls.config,T=!!(S.audioStreamController&&S.audioTrackController),A={levels:f,audioTracks:u,subtitleTracks:d,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:s,altAudio:T&&!y&&u.some(b=>!!b.url)};h.end=performance.now(),this.hls.trigger(_.MANIFEST_PARSED,A)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(e.length===0)return;if(t<0||t>=e.length){const h=new Error("invalid level idx"),p=t<0;if(this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:t,fatal:p,error:h,reason:h.message}),p)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,a=s?s.attrs["PATHWAY-ID"]:void 0,l=e[t],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=l,i===t&&s&&a===u)return;this.log(`Switching to level ${t} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${u?" with Pathway "+u:""} from level ${i}${a?" with Pathway "+a:""}`);const d={level:t,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(_.LEVEL_SWITCHING,d);const f=l.details;if(!f||f.live){const h=this.switchParams(l.uri,s?.details,f);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),i=t.filter(s=>e.indexOf(s)!==-1);if(t.length<1){this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);return}this.steering.pathwayPriority=i}}onError(t,e){e.fatal||!e.context||e.context.type===It.LEVEL&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(e!==void 0&&e.type===mt.MAIN){const i=e.elementaryStreams;if(!Object.keys(i).some(a=>!!i[a]))return;const s=this._levels[e.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(t,e){var i;const{level:s,details:a}=e,l=e.levelInfo;if(!l){var u;this.warn(`Invalid level index ${s}`),(u=e.deliveryDirectives)!=null&&u.skip&&(a.deltaUpdateFailed=!0);return}if(l===this.currentLevel||e.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let d=l.details;d===e.details&&d.advanced&&(d=void 0),this.playlistLoaded(s,e,d)}else(i=e.deliveryDirectives)!=null&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=this.getUrlWithDirectives(t.uri,e),s=this.currentLevelIndex,a=t.attrs["PATHWAY-ID"],l=t.details,u=l?.age;this.log(`Loading level index ${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${a?" Pathway "+a:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${i}`),this.hls.trigger(_.LEVEL_LOADING,{url:i,level:s,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(this._levels.length===1)return;const i=this._levels.filter((a,l)=>l!==t?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(u=>u.level=-1)),!1));Rx(i),this._levels=i,this.currentLevelIndex>-1&&(e=this.currentLevel)!=null&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=i.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(_.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(_.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Uv(r){const t={};r.forEach(e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function xS(){return self.SourceBuffer||self.WebKitSourceBuffer}function SS(){if(!ps())return!1;const t=xS();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function KI(){if(!SS())return!1;const r=ps();return typeof r?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>r.isTypeSupported(so(t,"video")))||["mp4a.40.2","fLaC"].some(t=>r.isTypeSupported(so(t,"audio"))))}function qI(){var r;const t=xS();return typeof(t==null||(r=t.prototype)==null?void 0:r.changeType)=="function"}const YI=100;class XI extends Bh{constructor(t,e,i){super(t,e,i,"stream-controller",mt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,a=s?s.currentTime:null;if(a===null||!ht(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const l=this.getFwdBufferInfoAtPos(s,a,mt.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(YI),this.level=-1,!this.startFragRequested){let a=s.startLevel;a===-1&&(s.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=s.firstAutoLevel),s.nextLoadLevel=a,this.level=s.loadLevel,this._hasEnoughToStart=!!e}i>0&&t===-1&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=at.IDLE,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=at.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case at.WAITING_LEVEL:{const{levels:t,level:e}=this,i=t?.[e],s=i?.details;if(s&&(!s.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(s))break;this.state=at.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=at.IDLE;break}break}case at.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===at.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),(t=this.media)!=null&&t.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:s}=this;if(e===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?t.nextLoadLevel:t.loadLevel;if(!(i!=null&&i[a]))return;const l=i[a],u=this.getMainFwdBufferInfo();if(u===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(u,d)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(_.BUFFER_EOS,S),this.state=at.ENDED;return}if(!this.buffering)return;t.loadLevel!==a&&t.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=t.nextLoadLevel=a;const f=l.details;if(!f||this.state===at.WAITING_LEVEL||this.waitForLive(l)){this.level=a,this.state=at.WAITING_LEVEL,this.startFragRequested=!1;return}const h=u.len,p=this.getMaxBufferLength(l.maxBitrate);if(h>=p)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:u.end;let v=this.getNextFragment(g,f);if(this.couldBacktrack&&!this.fragPrevious&&v&&Te(v)&&this.fragmentTracker.getState(v)!==Le.OK){var y;const T=((y=this.backtrackFragment)!=null?y:v).sn-f.startSN,A=f.fragments[T-1];A&&v.cc===A.cc&&(v=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,g)){if(!v.gap){const T=this.audioOnly&&!this.altAudio?Zt.AUDIO:Zt.VIDEO,A=(T===Zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,T,mt.MAIN)}v=this.getNextFragmentLoopLoading(v,f,u,mt.MAIN,p)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,l,g))}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);s===Le.NOT_LOADED||s===Le.PARTIAL?Te(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,mt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(e!=null&&e.readyState){let i;const s=this.getAppendedFrag(e.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<a.targetduration*2)return}if(!e.paused&&t){const u=this.hls.nextLoadLevel,d=t[u],f=this.fragLastKbps;f&&this.fragCurrent?i=this.fragCurrent.duration*d.maxBitrate/(1e3*f)+1:i=0}else i=0;const l=this.getBufferedFrag(e.currentTime+i);if(l){const u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();const d=u.maxStartPTS?u.maxStartPTS:u.start,f=u.duration,h=Math.max(l.end,d+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case at.KEY_LOADING:case at.FRAG_LOADING:case at.FRAG_LOADING_WAITING_RETRY:case at.PARSING:case at.PARSED:this.state=at.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio===2?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;Ye(i,"playing",this.onMediaPlaying),Ye(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:i}=this;i&&(si(i,"playing",this.onMediaPlaying),si(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e),!e.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(_.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,s=!1;for(let a=0;a<e.levels.length;a++){const l=e.levels[a].audioCodec;l&&(i=i||l.indexOf("mp4a.40.2")!==-1,s=s||l.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&s&&!qI(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==at.IDLE)return;const s=e.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=at.WAITING_LEVEL)}onLevelLoaded(t,e){var i;const{levels:s,startFragRequested:a}=this,l=e.level,u=e.details,d=u.totalduration;if(!s){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${d}`);const f=e.levelInfo,h=this.fragCurrent;h&&(this.state===at.FRAG_LOADING||this.state===at.FRAG_LOADING_WAITING_RETRY)&&h.level!==e.level&&h.loader&&this.abortCurrentFrag();let p=0;if(u.live||(i=f.details)!=null&&i.live){var g;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;p=this.alignPlaylists(u,f.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(f.details=u,this.levelLastLoaded=f,a||this.setStartPosition(u,p),this.hls.trigger(_.LEVEL_UPDATED,{details:u,level:l}),this.state===at.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=at.IDLE}a&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,a=this.getLoadPosition(),l=t.fragmentStart,u=t.edge,d=a>=l-e.maxFragLookUpTolerance&&a<=u;if(s!==null&&i.duration>s&&(a<s||!d)){const h=e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;if((!d&&i.readyState<4||a<u-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var f;const p=At.bufferInfo(i,s,0);if(!((f=p.buffered)!=null&&f.length)){i.currentTime=s;return}if(p.start<=a){i.currentTime=s;return}const{nextStart:v}=At.bufferedInfo(p.buffered,a,0);v&&(i.currentTime=v)}else i.currentTime=s}}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:s,payload:a}=t,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=l[i.level];if(!u){this.warn(`Level ${i.level} not found on progress`);return}const d=u.details;if(!d){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const f=u.videoCodec,h=d.PTSKnown||!d.live,p=(e=i.initSegment)==null?void 0:e.data,g=this._getAudioCodec(u),v=this.transmuxer=this.transmuxer||new qx(this.hls,mt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=s?s.index:-1,S=y!==-1,T=new Ph(i.level,i.sn,i.stats.chunkCount,a.byteLength,y,S),A=this.initPTS[i.cc];v.push(a,p,g,f,i,s,d.totalduration,h,T,A)}onAudioTrackSwitching(t,e){const i=this.hls,s=this.altAudio===2;if(yu(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),i.once(_.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(_.AUDIO_TRACK_SWITCHED,e)}),i.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(_.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=yu(e.url,this.hls);if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){const i=e.tracks;let s,a,l=!1;for(const u in i){const d=i[u];if(d.id==="main"){if(a=u,s=d,u==="video"){const f=i[u];f&&(this.videoBuffer=f.buffer)}}else l=!0}l&&s?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:s}=e,a=i.type===mt.MAIN;if(a){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===at.PARSED&&(this.state=at.IDLE);return}const u=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),Te(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}const l=this.media;l&&(!this._hasEnoughToStart&&At.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal){this.state=at.ERROR;return}switch(e.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.MAIN,e);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===at.WAITING_LEVEL&&((i=e.context)==null?void 0:i.type)===It.LEVEL&&(this.state=at.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onFragLoadEmergencyAborted(){this.state=at.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==Zt.AUDIO||!this.altAudio){const i=(e===Zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,e,mt.MAIN),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking){this.log(`could not seek to ${i}, already seeking at ${e}`);return}const s=this.timelineOffset;s&&i&&(i+=s);const a=this.getLevelDetails(),l=At.getBuffered(t),u=l.length?l.start(0):0,d=u-i,f=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<f||this.loadingParts&&d<2*(a?.partTarget||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),i+=d,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${u}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e.indexOf("mp4a.40.5")!==-1?e="mp4a.40.2":e="mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(i=>{const{hls:s}=this,a=i?.frag;if(!a||this.fragContextChanged(a))return;e.fragmentError=0,this.state=at.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=a.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),s.trigger(_.FRAG_LOADED,i),a.bitrateTest=!1}).catch(i=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}_handleTransmuxComplete(t){const e=this.playlistType,{hls:i}=this,{remuxResult:s,chunkMeta:a}=t,l=this.getCurrentContext(a);if(!l){this.resetWhenMissingContext(a);return}const{frag:u,part:d,level:f}=l,{video:h,text:p,id3:g,initSegment:v}=s,{details:y}=f,S=this.altAudio?void 0:s.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=at.PARSING,v){const T=v.tracks;if(T){const C=u.initSegment||u;if(this.unhandledEncryptionError(v,u))return;this._bufferInitSegment(f,T,C,a),i.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:e,tracks:T})}const A=v.initPTS,b=v.timescale,R=this.initPTS[u.cc];if(ht(A)&&(!R||R.baseTime!==A||R.timescale!==b)){const C=v.trackId;this.initPTS[u.cc]={baseTime:A,timescale:b,trackId:C},i.trigger(_.INIT_PTS_FOUND,{frag:u,id:e,initPTS:A,timescale:b,trackId:C})}}if(h&&y){S&&h.type==="audiovideo"&&this.logMuxedErr(u);const T=y.fragments[u.sn-1-y.startSN],A=u.sn===y.startSN,b=!T||u.cc>T.cc;if(s.independent!==!1){const{startPTS:R,endPTS:C,startDTS:D,endDTS:N}=h;if(d)d.elementaryStreams[h.type]={startPTS:R,endPTS:C,startDTS:D,endDTS:N};else if(h.firstKeyFrame&&h.independent&&a.id===1&&!b&&(this.couldBacktrack=!0),h.dropped&&h.independent){const w=this.getMainFwdBufferInfo(),P=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,B=h.firstKeyFramePTS?h.firstKeyFramePTS:R;if(!A&&P<B-this.config.maxBufferHole&&!b){this.backtrack(u);return}else b&&(u.gap=!0);u.setElementaryStreamInfo(h.type,u.start,C,u.start,N,!0)}else A&&R-(y.appliedTimelineOffset||0)>au&&(u.gap=!0);u.setElementaryStreamInfo(h.type,R,C,D,N),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(h,u,d,a,A||b)}else if(A||b)u.gap=!0;else{this.backtrack(u);return}}if(S){const{startPTS:T,endPTS:A,startDTS:b,endDTS:R}=S;d&&(d.elementaryStreams[Zt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:R}),u.setElementaryStreamInfo(Zt.AUDIO,T,A,b,R),this.bufferFragmentData(S,u,d,a)}if(y&&g!=null&&g.samples.length){const T={id:e,frag:u,details:y,samples:g.samples};i.trigger(_.FRAG_PARSING_METADATA,T)}if(y&&p){const T={id:e,frag:u,details:y,samples:p.samples};i.trigger(_.FRAG_PARSING_USERDATA,T)}}logMuxedErr(t){this.warn(`${Te(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,s){if(this.state!==at.PARSING)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));const{audio:a,video:l,audiovideo:u}=e;if(a){const f=t.audioCodec;let h=Jl(a.codec,f);h==="mp4a"&&(h="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const g=a.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),f&&f!==h&&this.log(`Swapping manifest audio codec "${f}" for "${h}"`),a.levelCodec=h,a.id=mt.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${h||""}/${f||""}/${a.codec}]`),delete e.audiovideo}if(l){l.levelCodec=t.videoCodec,l.id=mt.MAIN;const f=l.codec;if(f?.length===4)switch(f){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${t.videoCodec||""}/${f}]${l.codec!==f?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete e.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${t.codecs}/${u.codec}]`),delete e.video,delete e.audio);const d=Object.keys(e);if(d.length){if(this.hls.trigger(_.BUFFER_CODECS,e),!this.hls)return;d.forEach(f=>{const p=e[f].initSegment;p!=null&&p.byteLength&&this.hls.trigger(_.BUFFER_APPENDING,{type:f,data:p,frag:i,part:null,chunkMeta:s,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,mt.MAIN)}get maxBufferLength(){const{levels:t,level:e}=this,i=t?.[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=at.IDLE}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&t.seeking===!1){const i=t.currentTime;if(At.isBuffered(t,i)?e=this.getAppendedFrag(i):At.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const s=this.fragPlaying,a=e.level;(!s||e.sn!==s.sn||s.level!==a)&&(this.fragPlaying=e,this.hls.trigger(_.FRAG_CHANGED,{frag:e}),(!s||s.level!==a)&&this.hls.trigger(_.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;return ht(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;if(ht(e)){const i=this.getLevelDetails(),s=this.currentFrag||(i?qs(null,i.fragments,e):null);if(s){const a=s.programDateTime;if(a!==null){const l=a+(e-s.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class WI extends Oi{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[i].loader;if(s){var e;if(t&&t!==((e=s.context)==null?void 0:e.frag.type))return;s.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t,e=Q.KEY_LOAD_ERROR,i,s,a){return new In({type:vt.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:a,error:i,networkDetails:s})}loadClear(t,e,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let s=0,a=e.length;s<a;s++){const l=e[s];if(t.cc<=l.cc&&(!Te(t)||!Te(l)||t.sn<l.sn)||!i&&s==a-1)return this.emeController.selectKeySystemFormat(l).then(u=>{if(!this.emeController)return;l.setKeyFormat(u);const d=eu(u);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const s=Wa(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var i,s;e&&t.setKeyFormat(e);const a=t.decryptdata;if(!a){const f=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,f))}const l=a.uri;if(!l)return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));const u=Pd(a);let d=this.keyIdToKeyInfo[u];if((i=d)!=null&&i.decryptdata.key)return a.key=d.decryptdata.key,Promise.resolve({frag:t,keyInfo:d});if(this.emeController&&(s=d)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(d.decryptdata)){case"usable":case"usable-in-future":return d.keyLoadPromise.then(h=>{const{keyInfo:p}=h;return a.key=p.decryptdata.key,{frag:t,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[u]?"Rel":"L"}oading${a.keyId?" keyId: "+qe(a.keyId):""} URI: ${a.uri} from ${t.type} ${t.level}`),d=this.keyIdToKeyInfo[u]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(d,t):this.loadKeyEME(d,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(d,t);default:return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var s;if(!t.decryptdata.keyId&&(s=e.initSegment)!=null&&s.data){const l=p_(e.initSegment.data);if(l.length){const u=l[0];u.some(d=>d!==0)&&(this.log(`Using keyId found in init segment ${qe(u)}`),t.decryptdata.keyId=u,zs.setKeyIdForUri(t.decryptdata.uri,u))}}const a=this.emeController.loadKey(i);return(t.keyLoadPromise=a.then(l=>(t.mediaKeySessionContext=l,i))).catch(l=>{throw t.keyLoadPromise=null,"data"in l&&(l.data.frag=e),l})}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,s=i.loader,a=new s(i);return e.keyLoader=t.loader=a,t.keyLoadPromise=new Promise((l,u)=>{const d={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},f=i.keyLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,y,S)=>{const{frag:T,keyInfo:A}=y,b=Pd(A.decryptdata);if(!T.decryptdata||A!==this.keyIdToKeyInfo[b])return u(this.createKeyLoadError(T,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));A.decryptdata.key=T.decryptdata.key=new Uint8Array(g.data),T.keyLoader=null,A.loader=null,l({frag:T,keyInfo:A})},onError:(g,v,y,S)=>{this.resetLoader(v),u(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${g.code} loading key ${g.text}`),y,Vt({url:d.url,data:void 0},g)))},onTimeout:(g,v,y)=>{this.resetLoader(v),u(this.createKeyLoadError(e,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(g,v,y)=>{this.resetLoader(v),u(this.createKeyLoadError(e,Q.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};a.load(d,h,p)})}resetLoader(t){const{frag:e,keyInfo:i,url:s}=t,a=i.loader;e.keyLoader===a&&(e.keyLoader=null,i.loader=null);const l=Pd(i.decryptdata)||s;delete this.keyIdToKeyInfo[l],a&&a.destroy()}}function Pd(r){if(r.keyFormat!==$e.FAIRPLAY){const t=r.keyId;if(t)return qe(t)}return r.uri}function $v(r){const{type:t}=r;switch(t){case It.AUDIO_TRACK:return mt.AUDIO;case It.SUBTITLE_TRACK:return mt.SUBTITLE;default:return mt.MAIN}}function Nd(r,t){let e=r.url;return(e===void 0||e.indexOf("data:")===0)&&(e=t.url),e}class QI{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,s=e.loader,a=i||s,l=new a(e);return this.loaders[t.type]=l,l}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:It.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:i,level:s,pathwayId:a,url:l,deliveryDirectives:u,levelInfo:d}=e;this.load({id:i,level:s,pathwayId:a,responseType:"text",type:It.LEVEL,url:l,deliveryDirectives:u,levelOrTrack:d})}onAudioTrackLoading(t,e){const{id:i,groupId:s,url:a,deliveryDirectives:l,track:u}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:It.AUDIO_TRACK,url:a,deliveryDirectives:l,levelOrTrack:u})}onSubtitleTrackLoading(t,e){const{id:i,groupId:s,url:a,deliveryDirectives:l,track:u}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:It.SUBTITLE_TRACK,url:a,deliveryDirectives:l,levelOrTrack:u})}onLevelsUpdated(t,e){const i=this.loaders[It.LEVEL];if(i){const s=i.context;s&&!e.levels.some(a=>a===s.levelOrTrack)&&(i.abort(),delete this.loaders[It.LEVEL])}}load(t){var e;const i=this.hls.config;let s=this.getInternalLoader(t);if(s){const f=this.hls.logger,h=s.context;if(h&&h.levelOrTrack===t.levelOrTrack&&(h.url===t.url||h.deliveryDirectives&&!t.deliveryDirectives)){h.url===t.url?f.log(`[playlist-loader]: ignore ${t.url} ongoing request`):f.log(`[playlist-loader]: ignore ${t.url} in favor of ${h.url}`);return}f.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),s.abort()}let a;if(t.type===It.MANIFEST?a=i.manifestLoadPolicy.default:a=Wt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(t),ht((e=t.deliveryDirectives)==null?void 0:e.part)){let f;if(t.type===It.LEVEL&&t.level!==null?f=this.hls.levels[t.level].details:t.type===It.AUDIO_TRACK&&t.id!==null?f=this.hls.audioTracks[t.id].details:t.type===It.SUBTITLE_TRACK&&t.id!==null&&(f=this.hls.subtitleTracks[t.id].details),f){const h=f.partTarget,p=f.targetduration;if(h&&p){const g=Math.max(h*3,p*.8)*1e3;a=Wt({},a,{maxTimeToFirstByteMs:Math.min(g,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(g,a.maxTimeToFirstByteMs)})}}}const l=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:(f,h,p,g)=>{const v=this.getInternalLoader(p);this.resetInternalLoader(p.type);const y=f.data;h.parsing.start=performance.now(),Ji.isMediaPlaylist(y)||p.type!==It.MANIFEST?this.handleTrackOrLevelPlaylist(f,h,p,g||null,v):this.handleMasterPlaylist(f,h,p,g)},onError:(f,h,p,g)=>{this.handleNetworkError(h,p,!1,f,g)},onTimeout:(f,h,p)=>{this.handleNetworkError(h,p,!0,void 0,f)}};s.load(t,u,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,s){const a=this.hls,l=t.data,u=Nd(t,i),d=Ji.parseMasterPlaylist(l,u);if(d.playlistParsingError){e.parsing.end=performance.now(),this.handleManifestParsingError(t,i,d.playlistParsingError,s,e);return}const{contentSteering:f,levels:h,sessionData:p,sessionKeys:g,startTimeOffset:v,variableList:y}=d;this.variableList=y,h.forEach(b=>{const{unknownCodecs:R}=b;if(R){const{preferManagedMediaSource:C}=this.hls.config;let{audioCodec:D,videoCodec:N}=b;for(let w=R.length;w--;){const P=R[w];no(P,"audio",C)?(b.audioCodec=D=D?`${D},${P}`:P,Yr.audio[D.substring(0,4)]=2,R.splice(w,1)):no(P,"video",C)&&(b.videoCodec=N=N?`${N},${P}`:P,Yr.video[N.substring(0,4)]=2,R.splice(w,1))}}});const{AUDIO:S=[],SUBTITLES:T,"CLOSED-CAPTIONS":A}=Ji.parseMasterPlaylistMedia(l,u,d);S.length&&!S.some(R=>!R.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new re({}),bitrate:0,url:""})),a.trigger(_.MANIFEST_LOADED,{levels:h,audioTracks:S,subtitles:T,captions:A,contentSteering:f,url:u,stats:e,networkDetails:s,sessionData:p,sessionKeys:g,startTimeOffset:v,variableList:y})}handleTrackOrLevelPlaylist(t,e,i,s,a){const l=this.hls,{id:u,level:d,type:f}=i,h=Nd(t,i),p=ht(d)?d:ht(u)?u:0,g=$v(i),v=Ji.parseLevelPlaylist(t.data,h,p,g,0,this.variableList);if(f===It.MANIFEST){const y={attrs:new re({}),bitrate:0,details:v,name:"",url:h};v.requestScheduled=e.loading.start+Tx(v,0),l.trigger(_.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:h,stats:e,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=v,this.handlePlaylistLoaded(v,t,e,i,s,a)}handleManifestParsingError(t,e,i,s,a){this.hls.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:e.type===It.MANIFEST,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:s,stats:a})}handleNetworkError(t,e,i=!1,s,a){let l=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${t.type}`;t.type===It.LEVEL?l+=`: ${t.level} id: ${t.id}`:(t.type===It.AUDIO_TRACK||t.type===It.SUBTITLE_TRACK)&&(l+=` id: ${t.id} group-id: "${t.groupId}"`);const u=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let d=Q.UNKNOWN,f=!1;const h=this.getInternalLoader(t);switch(t.type){case It.MANIFEST:d=i?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,f=!0;break;case It.LEVEL:d=i?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,f=!1;break;case It.AUDIO_TRACK:d=i?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case It.SUBTITLE_TRACK:d=i?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,f=!1;break}h&&this.resetInternalLoader(t.type);const p={type:vt.NETWORK_ERROR,details:d,fatal:f,url:t.url,loader:h,context:t,error:u,networkDetails:e,stats:a};if(s){const g=e?.url||t.url;p.response=Vt({url:g,data:void 0},s)}this.hls.trigger(_.ERROR,p)}handlePlaylistLoaded(t,e,i,s,a,l){const u=this.hls,{type:d,level:f,levelOrTrack:h,id:p,groupId:g,deliveryDirectives:v}=s,y=Nd(e,s),S=$v(s);let T=typeof s.level=="number"&&S===mt.MAIN?f:void 0;const A=t.playlistParsingError;if(A){if(this.hls.logger.warn(`${A} ${t.url}`),!u.config.ignorePlaylistParsingErrors){u.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:A,reason:A.message,response:e,context:s,level:T,parent:S,networkDetails:a,stats:i});return}t.playlistParsingError=null}if(!t.fragments.length){const b=t.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:b,reason:b.message,response:e,context:s,level:T,parent:S,networkDetails:a,stats:i});return}switch(t.live&&l&&(l.getCacheAge&&(t.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),d){case It.MANIFEST:case It.LEVEL:if(T){if(!h)T=0;else if(h!==u.levels[T]){const b=u.levels.indexOf(h);b>-1&&(T=b)}}u.trigger(_.LEVEL_LOADED,{details:t,levelInfo:h||u.levels[0],level:T||0,id:p||0,stats:i,networkDetails:a,deliveryDirectives:v,withoutMultiVariant:d===It.MANIFEST});break;case It.AUDIO_TRACK:u.trigger(_.AUDIO_TRACK_LOADED,{details:t,track:h,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:v});break;case It.SUBTITLE_TRACK:u.trigger(_.SUBTITLE_TRACK_LOADED,{details:t,track:h,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:v});break}}}class kn{static get version(){return ao}static isMSESupported(){return SS()}static isSupported(){return KI()}static getMediaSource(){return ps()}static get Events(){return _}static get MetadataSchema(){return yi}static get ErrorTypes(){return vt}static get ErrorDetails(){return Q}static get DefaultConfig(){return kn.defaultConfig?kn.defaultConfig:MI}static set DefaultConfig(t){kn.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Uh,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=n_(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=NI(kn.DefaultConfig,t,e);this.userConfig=t,i.progressive&&FI(i,e);const{abrController:s,bufferController:a,capLevelController:l,errorController:u,fpsController:d}=i,f=new u(this),h=this.abrController=new s(this),p=new Z_(this),g=i.interstitialsController,v=g?this.interstitialsController=new g(this,kn):null,y=this.bufferController=new a(this,p),S=this.capLevelController=new l(this),T=new d(this),A=new QI(this),b=i.contentSteeringController,R=b?new b(this):null,C=this.levelController=new VI(this,R),D=new HI(this),N=new WI(this.config,this.logger),w=this.streamController=new XI(this,p,N),P=this.gapController=new jI(this,p);S.setStreamController(w),T.setStreamController(w);const B=[A,C,w];v&&B.splice(1,0,v),R&&B.splice(1,0,R),this.networkControllers=B;const M=[h,y,P,S,T,D,p];this.audioTrackController=this.createController(i.audioTrackController,B);const q=i.audioStreamController;q&&B.push(this.audioStreamController=new q(this,p,N)),this.subtitleTrackController=this.createController(i.subtitleTrackController,B);const tt=i.subtitleStreamController;tt&&B.push(this.subtititleStreamController=new tt(this,p,N)),this.createController(i.timelineController,M),N.emeController=this.emeController=this.createController(i.emeController,M),this.cmcdController=this.createController(i.cmcdController,M),this.latencyController=this.createController(zI,M),this.coreComponents=M,B.push(f);const V=f.onErrorOut;typeof V=="function"&&this.on(_.ERROR,V,f),this.on(_.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(t,e){if(t){const i=new t(this);return e&&e.push(i),i}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,s){this._emitter.off(t,e,i,s)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const s=t===_.ERROR;this.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:s,event:t,error:i}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(_.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const a=new Error(`attachMedia failed: invalid argument (${t})`);this.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,i=e?t.media:t,s=e?t:{media:i};this._media=i,this.trigger(_.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(_.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(_.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,i=this._url,s=this._url=Ch.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),e&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(_.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(t=-1,e){this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!(this.started||!this.networkControllers));t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()}))}get inFlightFragments(){const t={[mt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[mt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[mt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=t?.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=jD()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){N_(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let s=0;s<i;s++)if(t[s].maxBitrate>=e)return s;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this;let s;if(e===-1&&t!=null&&t.length?s=t.length-1:s=e,i)for(let a=s;a--;){const l=t[a].attrs["HDCP-LEVEL"];if(l&&l<=i)return a}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return((e=this.audioTrackController)==null?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return((e=this.subtitleTrackController)==null?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!!((t=this.bufferController)!=null&&t.bufferedToEnd)}get interstitialsManager(){var t;return((t=this.interstitialsController)==null?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t,e=this.allAudioTracks){const i=ox(e);return rx(t,i,navigator.mediaCapabilities)}}kn.defaultConfig=void 0;function ZI({url:r,containerRef:t}){const e=F.useRef(null);return F.useEffect(()=>{if(!t?.current)return;const i=new YL({container:t.current,url:r,type:"m3u8",autoSize:!0,fullscreen:!0,fullscreenWeb:!0,playbackRate:!0,aspectRatio:!0,setting:!0,customType:{m3u8:(l,u)=>{if(kn.isSupported()){const d=new kn;d.loadSource(u),d.attachMedia(l)}else l.canPlayType("application/vnd.apple.mpegurl")&&(l.src=u)}}});e.current=i;const s=l=>{(l.key==="f"||l.key==="F")&&(i.fullscreen=!i.fullscreen)};let a=!1;return i.on("focus",()=>{a||(window.addEventListener("keydown",s),a=!0)}),i.on("blur",()=>{a&&(window.removeEventListener("keydown",s),a=!1)}),()=>{i&&i.destroy(!0)}},[]),F.useEffect(()=>{e.current&&e.current.url!==r&&e.current.switchUrl(r,"Tp mi")},[r]),null}const JI="_watch_ysw7b_2",t2="_info_ysw7b_83",e2="_episodes_ysw7b_159",i2="_active_ysw7b_178",n2={watch:JI,"watch-container":"_watch-container_ysw7b_7","watch-player":"_watch-player_ysw7b_7","player-center":"_player-center_ysw7b_16","player-return":"_player-return_ysw7b_27","player-ratio":"_player-ratio_ysw7b_40","watch-main":"_watch-main_ysw7b_62","watch-info":"_watch-info_ysw7b_71","thumb-container":"_thumb-container_ysw7b_79","info-thumb":"_info-thumb_ysw7b_83",info:t2,"info-name":"_info-name_ysw7b_105","info-alias-name":"_info-alias-name_ysw7b_111","info-detail":"_info-detail_ysw7b_118","detail-tags":"_detail-tags_ysw7b_124","tag-topic":"_tag-topic_ysw7b_129","detail-desc":"_detail-desc_ysw7b_138",episodes:e2,"episodes-button":"_episodes-button_ysw7b_165",active:i2,"watch-side":"_watch-side_ysw7b_192","actors-header":"_actors-header_ysw7b_197","actors-container":"_actors-container_ysw7b_202","actors-item":"_actors-item_ysw7b_209","actors-img":"_actors-img_ysw7b_215","actors-name":"_actors-name_ysw7b_222"},s2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M73.4 297.4C60.9 309.9 60.9 330.2 73.4 342.7L233.4 502.7C245.9 515.2 266.2 515.2 278.7 502.7C291.2 490.2 291.2 469.9 278.7 457.4L173.3 352L544 352C561.7 352 576 337.7 576 320C576 302.3 561.7 288 544 288L173.3 288L278.7 182.6C291.2 170.1 291.2 149.8 278.7 137.3C266.2 124.8 245.9 124.8 233.4 137.3L73.4 297.3z"})),Bt=Xs.bind(n2);function jv(){const{slug:r,episodeSlug:t}=_1(),[e,i]=F.useState(null),[s,a]=F.useState(null),l=F.useRef();F.useEffect(()=>{const g=`https://ophim1.com/v1/api/phim/${r}`;fetch(g,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>i(T.data)).catch(T=>console.error(T));const y=g+"/peoples";fetch(y,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>a(T.data)).catch(T=>console.error(T))},[r]);const u=F.useMemo(()=>e?.breadCrumb.slice(0,2)||[],[e]),d=F.useMemo(()=>e?.breadCrumb.slice(2,e?.breadCrumb.length-1)||[],[e]),f=F.useMemo(()=>e?.item.episodes[0].server_data||[],[e]),h=F.useMemo(()=>f.length?t&&f.find(g=>g.slug===t)||f[0]:null,[f,t]),p=F.useMemo(()=>e?.item?.content&&new DOMParser().parseFromString(e.item.content,"text/html").body.textContent||"",[e]);return r?e?$.jsxs("div",{className:Bt("watch"),children:[$.jsxs("div",{className:Bt("watch-player"),children:[$.jsxs("div",{className:Bt("player-center"),children:[$.jsx(me,{to:`/movies/${r}`,className:Bt("player-return"),children:$.jsx(s2,{})}),$.jsxs("div",{className:Bt("player-name"),children:["Thm button imdb X l play pause bng du cch, X l focus blur input B call API ly nh thanh search https://img.ophim.live/uploads/movies/ + path CSS control Thm webkit gii hn cho desc Xem phim ",e.item.name]})]}),$.jsx("div",{className:Bt("player-ratio"),ref:l,children:$.jsx(ZI,{url:h?.link_m3u8,containerRef:l})})]}),$.jsxs("div",{className:Bt("watch-container"),children:[$.jsxs("div",{className:Bt("watch-main"),children:[$.jsxs("div",{className:Bt("watch-info"),children:[$.jsx("div",{className:Bt("thumb-container"),children:$.jsx("div",{className:Bt("info-thumb"),children:$.jsx("img",{src:e.APP_DOMAIN_CDN_IMAGE+"/uploads/"+e.seoOnPage.og_image[0],alt:e.item.name})})}),$.jsx("div",{className:Bt("info"),children:$.jsxs("div",{children:[$.jsx("div",{className:Bt("info-name"),children:$.jsx(me,{to:`/movies/${e.params.slug}`,children:e.item.name})}),$.jsx("div",{className:Bt("info-alias-name"),children:e.item.origin_name}),$.jsxs("div",{className:Bt("info-detail"),children:[$.jsx("div",{className:Bt("detail-tags"),children:u.map((g,v)=>$.jsx(me,{className:Bt("tag-topic"),to:g.slug,children:g.name},v))}),$.jsx("div",{className:Bt("detail-tags"),children:d.map((g,v)=>$.jsx(me,{className:Bt("tag-topic"),to:g.slug,children:g.name},v))})]})]})}),$.jsxs("div",{className:Bt("detail-desc"),children:[$.jsx("div",{className:Bt("desc"),children:p}),$.jsxs(me,{to:`/movies/${e.params.slug}`,children:["Thng tin phim",$.jsx(HE,{})]})]})]}),$.jsx("div",{className:Bt("watch-episodes"),children:$.jsx("div",{className:Bt("episodes"),children:f.length>1&&f.map(g=>{const v=t===g.slug||!t&&g.slug===f[0].slug;return $.jsxs(me,{to:`/watch/${r}/${g.slug}`,className:Bt("episodes-button",{active:v}),children:[$.jsx(_h,{}),"Tp ",g.name]},g.slug)})})})]}),$.jsxs("div",{className:Bt("watch-side"),children:[$.jsx("div",{className:Bt("side-rate")}),$.jsxs("div",{className:Bt("side-actors"),children:[$.jsx("div",{className:Bt("actors-header"),children:"Din vin"}),$.jsx("div",{className:Bt("actors-container"),children:s&&s.peoples.map(g=>$.jsxs("div",{className:Bt("actors-item"),children:[$.jsx("div",{className:Bt("actors-img"),children:$.jsx("img",{src:s.profile_sizes.original+g.profile_path,alt:g.name})}),$.jsx("div",{className:Bt("actors-name"),children:g.name})]},g.id))})]})]})]})]}):$.jsx("div",{className:Bt("loading"),children:"ang ti phim..."}):$.jsxs("div",{children:[$.jsx("h1",{children:"Trang danh sch phim (Watch)"}),$.jsx("p",{children:"Hin th danh sch cc phim..."})]})}const r2="_fixed_1f6n0_8",a2="_header_1f6n0_1",o2="_logo_1f6n0_29",l2={"header-wrapper":"_header-wrapper_1f6n0_1",fixed:r2,header:a2,logo:o2},u2="_search_1as0s_2",c2="_fadeInUp_1as0s_1",f2="_item_1as0s_94",d2="_spinner_1as0s_1",h2={search:u2,"search-container":"_search-container_1as0s_6","search-element":"_search-element_1as0s_10","search-icon":"_search-icon_1as0s_14","remove-icon":"_remove-icon_1as0s_28","search-input":"_search-input_1as0s_42","search-list":"_search-list_1as0s_56",fadeInUp:c2,"list-container":"_list-container_1as0s_82","list-title":"_list-title_1as0s_89",item:f2,"item-poster-container":"_item-poster-container_1as0s_108","item-poster":"_item-poster_1as0s_108","item-desc":"_item-desc_1as0s_130","item-name":"_item-name_1as0s_149","item-tag-span":"_item-tag-span_1as0s_155","view-all":"_view-all_1as0s_173","no-result":"_no-result_1as0s_190","loading-icon":"_loading-icon_1as0s_207",spinner:d2},m2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M480 272C480 317.9 465.1 360.3 440 394.7L566.6 521.4C579.1 533.9 579.1 554.2 566.6 566.7C554.1 579.2 533.8 579.2 521.3 566.7L394.7 440C360.3 465.1 317.9 480 272 480C157.1 480 64 386.9 64 272C64 157.1 157.1 64 272 64C386.9 64 480 157.1 480 272zM272 416C351.5 416 416 351.5 416 272C416 192.5 351.5 128 272 128C192.5 128 128 192.5 128 272C128 351.5 192.5 416 272 416z"})),p2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM231 231C240.4 221.6 255.6 221.6 264.9 231L319.9 286L374.9 231C384.3 221.6 399.5 221.6 408.8 231C418.1 240.4 418.2 255.6 408.8 264.9L353.8 319.9L408.8 374.9C418.2 384.3 418.2 399.5 408.8 408.8C399.4 418.1 384.2 418.2 374.9 408.8L319.9 353.8L264.9 408.8C255.5 418.2 240.3 418.2 231 408.8C221.7 399.4 221.6 384.2 231 374.9L286 319.9L231 264.9C221.6 255.5 221.6 240.3 231 231z"})),g2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M272 112C272 85.5 293.5 64 320 64C346.5 64 368 85.5 368 112C368 138.5 346.5 160 320 160C293.5 160 272 138.5 272 112zM272 528C272 501.5 293.5 480 320 480C346.5 480 368 501.5 368 528C368 554.5 346.5 576 320 576C293.5 576 272 554.5 272 528zM112 272C138.5 272 160 293.5 160 320C160 346.5 138.5 368 112 368C85.5 368 64 346.5 64 320C64 293.5 85.5 272 112 272zM480 320C480 293.5 501.5 272 528 272C554.5 272 576 293.5 576 320C576 346.5 554.5 368 528 368C501.5 368 480 346.5 480 320zM139 433.1C157.8 414.3 188.1 414.3 206.9 433.1C225.7 451.9 225.7 482.2 206.9 501C188.1 519.8 157.8 519.8 139 501C120.2 482.2 120.2 451.9 139 433.1zM139 139C157.8 120.2 188.1 120.2 206.9 139C225.7 157.8 225.7 188.1 206.9 206.9C188.1 225.7 157.8 225.7 139 206.9C120.2 188.1 120.2 157.8 139 139zM501 433.1C519.8 451.9 519.8 482.2 501 501C482.2 519.8 451.9 519.8 433.1 501C414.3 482.2 414.3 451.9 433.1 433.1C451.9 414.3 482.2 414.3 501 433.1z"})),de=Xs.bind(h2);function y2(){const[r,t]=F.useState(""),[e,i]=F.useState([]),[s,a]=F.useState(!0),[l,u]=F.useState(!0),[d,f]=F.useState(!0),h=F.useRef(null);return F.useEffect(()=>{if(!r.trim()){i([]);return}const p=setTimeout(()=>{const g=`https://ophim1.com/v1/api/tim-kiem?keyword=${r}`,v={method:"GET",headers:{accept:"application/json"}};fetch(g,v).then(y=>y.json()).then(y=>{u(!0);const T=(y.data.items||[]).slice(0,5);if(T.length===0){i([]);return}const A=T.map(b=>{const R=`https://ophim1.com/v1/api/phim/${b.slug}/images`;return fetch(R,v).then(C=>C.json()).then(C=>{const w=`https://image.tmdb.org/t/p/original${C.data.images.find(P=>P.type==="poster").file_path}`;return b.posterHandlePath=w,b}).catch(C=>(console.error(`Li khi ly nh cho ${b.slug}:`,C),b))});return Promise.all(A)}).then(y=>{y&&(i(y),u(!1))}).catch(y=>{console.error("Li trong chui API:",y),i([])})},400);return()=>{clearTimeout(p)}},[r]),$.jsx("div",{className:de("search"),children:$.jsxs("div",{className:de("search-container"),children:[$.jsxs("div",{className:de("search-element"),children:[$.jsx("div",{className:de("search-icon"),children:$.jsx(m2,{})}),$.jsx("input",{value:r,onChange:p=>t(p.target.value),id:"main-search",className:de("search-input"),type:"text",placeholder:"Tm kim phim",autoComplete:"off",ref:h}),$.jsx("div",{onClick:()=>{t(""),h.current.focus()},className:de("remove-icon"),children:r.length>0&&$.jsx(p2,{})})]}),s&&r&&$.jsxs("div",{className:de("search-list"),children:[r.length>0&&e.length==0&&$.jsx("div",{className:de("no-result"),children:"Khng tm thy kt qu"}),l&&d&&$.jsx(g2,{className:de("loading-icon")}),!l&&r.length>0&&e.length>0&&$.jsxs("div",{className:de("list-container"),children:[$.jsx("div",{className:de("list-title"),children:"Danh sch phim"}),$.jsx("div",{className:de("list-result"),children:r.length>0&&e.map(p=>$.jsxs(me,{className:de("item"),to:`/watch/${p.slug}`,children:[$.jsx("div",{className:de("item-poster-container"),children:$.jsx("div",{className:de("item-poster"),children:$.jsx("img",{onLoad:()=>f(!1),src:p.posterHandlePath,alt:"poster"})})}),$.jsxs("div",{className:de("item-desc"),children:[$.jsx("div",{className:de("item-name"),children:p.name}),$.jsx("div",{className:de("item-origin-name"),children:p.origin_name}),$.jsxs("div",{className:de("item-tag"),children:[$.jsx("span",{children:p.year}),$.jsx("span",{className:de("item-tag-span"),children:p.time}),$.jsx("span",{className:de("item-tag-span"),children:p.episode_current||p.time})]})]})]},p._id))})]}),r.length>0&&e.length>0&&$.jsx(me,{className:de("view-all"),to:"/tim-kiem?q=a",children:"Ton b kt qu"})]})]})})}const Fd=Xs.bind(l2);function TS(){return $.jsx("div",{className:Fd("header-wrapper","fixed"),children:$.jsxs("div",{className:Fd("header"),children:[$.jsx(me,{to:"/",className:Fd("logo"),children:$.jsx("img",{src:"/logo.svg",alt:"ATPhim"})}),$.jsx(y2,{}),$.jsx("div",{style:{width:"882px",height:"40px"}})]})})}function v2(){}function E2({children:r}){return $.jsxs("div",{children:[$.jsx(TS,{}),$.jsxs("div",{className:"container",children:[$.jsx(v2,{}),r]})]})}function Gv({children:r}){return $.jsxs("div",{children:[$.jsx(TS,{}),$.jsx("div",{className:"contaier",children:r})]})}const x2=[{path:"/",component:qL},{path:"/watch/:slug",component:jv,layout:Gv},{path:"/watch/:slug/:episodeSlug",component:jv,layout:Gv}];function S2(){return $.jsx($.Fragment,{children:$.jsx(fA,{basename:"/ATPhim",children:$.jsx("div",{className:"app",children:$.jsx(G1,{children:x2.map((r,t)=>{const e=r.component;let i=E2;return r.layout?i=r.layout:r.layout===null&&(i=F.Fragment),$.jsx(eE,{path:r.path,element:$.jsx(i,{children:$.jsx(e,{})})},t)})})})})})}Xb.createRoot(document.getElementById("root")).render($.jsx(F.StrictMode,{children:$.jsx(Wb,{children:$.jsx(S2,{})})}))});export default T2();
