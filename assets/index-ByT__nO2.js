var CT=(l,t)=>()=>(t||l((t={exports:{}}).exports,t),t.exports);var Z_=CT((gE,An)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();function wT(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var ff={exports:{}},ba={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function kT(){if(Fg)return ba;Fg=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,n,a){var o=null;if(a!==void 0&&(o=""+a),n.key!==void 0&&(o=""+n.key),"key"in n){a={};for(var c in n)c!=="key"&&(a[c]=n[c])}else a=n;return n=a.ref,{$$typeof:l,type:i,key:o,ref:n!==void 0?n:null,props:a}}return ba.Fragment=t,ba.jsx=e,ba.jsxs=e,ba}var Ug;function OT(){return Ug||(Ug=1,ff.exports=kT()),ff.exports}var lt=OT(),df={exports:{}},Lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function MT(){if($g)return Lt;$g=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function v(k){return k===null||typeof k!="object"?null:(k=g&&k[g]||k["@@iterator"],typeof k=="function"?k:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,T={};function A(k,U,it){this.props=k,this.context=U,this.refs=T,this.updater=it||E}A.prototype.isReactComponent={},A.prototype.setState=function(k,U){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,U,"setState")},A.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function b(){}b.prototype=A.prototype;function _(k,U,it){this.props=k,this.context=U,this.refs=T,this.updater=it||E}var I=_.prototype=new b;I.constructor=_,x(I,A.prototype),I.isPureReactComponent=!0;var C=Array.isArray;function N(){}var w={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function B(k,U,it){var ut=it.ref;return{$$typeof:l,type:k,key:U,ref:ut!==void 0?ut:null,props:it}}function M(k,U){return B(k.type,U,k.props)}function K(k){return typeof k=="object"&&k!==null&&k.$$typeof===l}function tt(k){var U={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(it){return U[it]})}var H=/\/+/g;function G(k,U){return typeof k=="object"&&k!==null&&k.key!=null?tt(""+k.key):U.toString(36)}function Y(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(N,N):(k.status="pending",k.then(function(U){k.status==="pending"&&(k.status="fulfilled",k.value=U)},function(U){k.status==="pending"&&(k.status="rejected",k.reason=U)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function O(k,U,it,ut,ft){var dt=typeof k;(dt==="undefined"||dt==="boolean")&&(k=null);var St=!1;if(k===null)St=!0;else switch(dt){case"bigint":case"string":case"number":St=!0;break;case"object":switch(k.$$typeof){case l:case t:St=!0;break;case m:return St=k._init,O(St(k._payload),U,it,ut,ft)}}if(St)return ft=ft(k),St=ut===""?"."+G(k,0):ut,C(ft)?(it="",St!=null&&(it=St.replace(H,"$&/")+"/"),O(ft,U,it,"",function(ae){return ae})):ft!=null&&(K(ft)&&(ft=M(ft,it+(ft.key==null||k&&k.key===ft.key?"":(""+ft.key).replace(H,"$&/")+"/")+St)),U.push(ft)),1;St=0;var Dt=ut===""?".":ut+":";if(C(k))for(var It=0;It<k.length;It++)ut=k[It],dt=Dt+G(ut,It),St+=O(ut,U,it,dt,ft);else if(It=v(k),typeof It=="function")for(k=It.call(k),It=0;!(ut=k.next()).done;)ut=ut.value,dt=Dt+G(ut,It++),St+=O(ut,U,it,dt,ft);else if(dt==="object"){if(typeof k.then=="function")return O(Y(k),U,it,ut,ft);throw U=String(k),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return St}function j(k,U,it){if(k==null)return k;var ut=[],ft=0;return O(k,ut,"","",function(dt){return U.call(it,dt,ft++)}),ut}function X(k){if(k._status===-1){var U=k._result;U=U(),U.then(function(it){(k._status===0||k._status===-1)&&(k._status=1,k._result=it)},function(it){(k._status===0||k._status===-1)&&(k._status=2,k._result=it)}),k._status===-1&&(k._status=0,k._result=U)}if(k._status===1)return k._result.default;throw k._result}var rt=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},ct={map:j,forEach:function(k,U,it){j(k,function(){U.apply(this,arguments)},it)},count:function(k){var U=0;return j(k,function(){U++}),U},toArray:function(k){return j(k,function(U){return U})||[]},only:function(k){if(!K(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return Lt.Activity=p,Lt.Children=ct,Lt.Component=A,Lt.Fragment=e,Lt.Profiler=n,Lt.PureComponent=_,Lt.StrictMode=i,Lt.Suspense=d,Lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,Lt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return w.H.useMemoCache(k)}},Lt.cache=function(k){return function(){return k.apply(null,arguments)}},Lt.cacheSignal=function(){return null},Lt.cloneElement=function(k,U,it){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var ut=x({},k.props),ft=k.key;if(U!=null)for(dt in U.key!==void 0&&(ft=""+U.key),U)!P.call(U,dt)||dt==="key"||dt==="__self"||dt==="__source"||dt==="ref"&&U.ref===void 0||(ut[dt]=U[dt]);var dt=arguments.length-2;if(dt===1)ut.children=it;else if(1<dt){for(var St=Array(dt),Dt=0;Dt<dt;Dt++)St[Dt]=arguments[Dt+2];ut.children=St}return B(k.type,ft,ut)},Lt.createContext=function(k){return k={$$typeof:o,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},Lt.createElement=function(k,U,it){var ut,ft={},dt=null;if(U!=null)for(ut in U.key!==void 0&&(dt=""+U.key),U)P.call(U,ut)&&ut!=="key"&&ut!=="__self"&&ut!=="__source"&&(ft[ut]=U[ut]);var St=arguments.length-2;if(St===1)ft.children=it;else if(1<St){for(var Dt=Array(St),It=0;It<St;It++)Dt[It]=arguments[It+2];ft.children=Dt}if(k&&k.defaultProps)for(ut in St=k.defaultProps,St)ft[ut]===void 0&&(ft[ut]=St[ut]);return B(k,dt,ft)},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(k){return{$$typeof:c,render:k}},Lt.isValidElement=K,Lt.lazy=function(k){return{$$typeof:m,_payload:{_status:-1,_result:k},_init:X}},Lt.memo=function(k,U){return{$$typeof:f,type:k,compare:U===void 0?null:U}},Lt.startTransition=function(k){var U=w.T,it={};w.T=it;try{var ut=k(),ft=w.S;ft!==null&&ft(it,ut),typeof ut=="object"&&ut!==null&&typeof ut.then=="function"&&ut.then(N,rt)}catch(dt){rt(dt)}finally{U!==null&&it.types!==null&&(U.types=it.types),w.T=U}},Lt.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},Lt.use=function(k){return w.H.use(k)},Lt.useActionState=function(k,U,it){return w.H.useActionState(k,U,it)},Lt.useCallback=function(k,U){return w.H.useCallback(k,U)},Lt.useContext=function(k){return w.H.useContext(k)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(k,U){return w.H.useDeferredValue(k,U)},Lt.useEffect=function(k,U){return w.H.useEffect(k,U)},Lt.useEffectEvent=function(k){return w.H.useEffectEvent(k)},Lt.useId=function(){return w.H.useId()},Lt.useImperativeHandle=function(k,U,it){return w.H.useImperativeHandle(k,U,it)},Lt.useInsertionEffect=function(k,U){return w.H.useInsertionEffect(k,U)},Lt.useLayoutEffect=function(k,U){return w.H.useLayoutEffect(k,U)},Lt.useMemo=function(k,U){return w.H.useMemo(k,U)},Lt.useOptimistic=function(k,U){return w.H.useOptimistic(k,U)},Lt.useReducer=function(k,U,it){return w.H.useReducer(k,U,it)},Lt.useRef=function(k){return w.H.useRef(k)},Lt.useState=function(k){return w.H.useState(k)},Lt.useSyncExternalStore=function(k,U,it){return w.H.useSyncExternalStore(k,U,it)},Lt.useTransition=function(){return w.H.useTransition()},Lt.version="19.2.0",Lt}var jg;function dd(){return jg||(jg=1,df.exports=MT()),df.exports}var J=dd(),hf={exports:{}},Aa={},mf={exports:{}},pf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function PT(){return Gg||(Gg=1,(function(l){function t(O,j){var X=O.length;O.push(j);t:for(;0<X;){var rt=X-1>>>1,ct=O[rt];if(0<n(ct,j))O[rt]=j,O[X]=ct,X=rt;else break t}}function e(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var j=O[0],X=O.pop();if(X!==j){O[0]=X;t:for(var rt=0,ct=O.length,k=ct>>>1;rt<k;){var U=2*(rt+1)-1,it=O[U],ut=U+1,ft=O[ut];if(0>n(it,X))ut<ct&&0>n(ft,it)?(O[rt]=ft,O[ut]=X,rt=ut):(O[rt]=it,O[U]=X,rt=U);else if(ut<ct&&0>n(ft,X))O[rt]=ft,O[ut]=X,rt=ut;else break t}}return j}function n(O,j){var X=O.sortIndex-j.sortIndex;return X!==0?X:O.id-j.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;l.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();l.unstable_now=function(){return o.now()-c}}var d=[],f=[],m=1,p=null,g=3,v=!1,E=!1,x=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function I(O){for(var j=e(f);j!==null;){if(j.callback===null)i(f);else if(j.startTime<=O)i(f),j.sortIndex=j.expirationTime,t(d,j);else break;j=e(f)}}function C(O){if(x=!1,I(O),!E)if(e(d)!==null)E=!0,N||(N=!0,tt());else{var j=e(f);j!==null&&Y(C,j.startTime-O)}}var N=!1,w=-1,P=5,B=-1;function M(){return T?!0:!(l.unstable_now()-B<P)}function K(){if(T=!1,N){var O=l.unstable_now();B=O;var j=!0;try{t:{E=!1,x&&(x=!1,b(w),w=-1),v=!0;var X=g;try{e:{for(I(O),p=e(d);p!==null&&!(p.expirationTime>O&&M());){var rt=p.callback;if(typeof rt=="function"){p.callback=null,g=p.priorityLevel;var ct=rt(p.expirationTime<=O);if(O=l.unstable_now(),typeof ct=="function"){p.callback=ct,I(O),j=!0;break e}p===e(d)&&i(d),I(O)}else i(d);p=e(d)}if(p!==null)j=!0;else{var k=e(f);k!==null&&Y(C,k.startTime-O),j=!1}}break t}finally{p=null,g=X,v=!1}j=void 0}}finally{j?tt():N=!1}}}var tt;if(typeof _=="function")tt=function(){_(K)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,G=H.port2;H.port1.onmessage=K,tt=function(){G.postMessage(null)}}else tt=function(){A(K,0)};function Y(O,j){w=A(function(){O(l.unstable_now())},j)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(O){O.callback=null},l.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<O?Math.floor(1e3/O):5},l.unstable_getCurrentPriorityLevel=function(){return g},l.unstable_next=function(O){switch(g){case 1:case 2:case 3:var j=3;break;default:j=g}var X=g;g=j;try{return O()}finally{g=X}},l.unstable_requestPaint=function(){T=!0},l.unstable_runWithPriority=function(O,j){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var X=g;g=O;try{return j()}finally{g=X}},l.unstable_scheduleCallback=function(O,j,X){var rt=l.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?rt+X:rt):X=rt,O){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=X+ct,O={id:m++,callback:j,priorityLevel:O,startTime:X,expirationTime:ct,sortIndex:-1},X>rt?(O.sortIndex=X,t(f,O),e(d)===null&&O===e(f)&&(x?(b(w),w=-1):x=!0,Y(C,X-rt))):(O.sortIndex=ct,t(d,O),E||v||(E=!0,N||(N=!0,tt()))),O},l.unstable_shouldYield=M,l.unstable_wrapCallback=function(O){var j=g;return function(){var X=g;g=j;try{return O.apply(this,arguments)}finally{g=X}}}})(pf)),pf}var Hg;function NT(){return Hg||(Hg=1,mf.exports=PT()),mf.exports}var gf={exports:{}},Ue={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function BT(){if(zg)return Ue;zg=1;var l=dd();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(d,f,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:p==null?null:""+p,children:d,containerInfo:f,implementation:m}}var o=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ue.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ue.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,m)},Ue.flushSync=function(d){var f=o.T,m=i.p;try{if(o.T=null,i.p=2,d)return d()}finally{o.T=f,i.p=m,i.d.f()}},Ue.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Ue.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Ue.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,p=c(m,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):m==="script"&&i.d.X(d,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ue.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=c(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Ue.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,p=c(m,f.crossOrigin);i.d.L(d,m,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ue.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=c(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Ue.requestFormReset=function(d){i.d.r(d)},Ue.unstable_batchedUpdates=function(d,f){return d(f)},Ue.useFormState=function(d,f,m){return o.H.useFormState(d,f,m)},Ue.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ue.version="19.2.0",Ue}var Vg;function FT(){if(Vg)return gf.exports;Vg=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),gf.exports=BT(),gf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function UT(){if(Kg)return Aa;Kg=1;var l=NT(),t=dd(),e=FT();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)r+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var r=s,u=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(u=r.return),s=r.return;while(s)}return r.tag===3?u:null}function o(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function c(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(a(s)!==s)throw Error(i(188))}function f(s){var r=s.alternate;if(!r){if(r=a(s),r===null)throw Error(i(188));return r!==s?null:s}for(var u=s,h=r;;){var y=u.return;if(y===null)break;var S=y.alternate;if(S===null){if(h=y.return,h!==null){u=h;continue}break}if(y.child===S.child){for(S=y.child;S;){if(S===u)return d(y),s;if(S===h)return d(y),r;S=S.sibling}throw Error(i(188))}if(u.return!==h.return)u=y,h=S;else{for(var L=!1,D=y.child;D;){if(D===u){L=!0,u=y,h=S;break}if(D===h){L=!0,h=y,u=S;break}D=D.sibling}if(!L){for(D=S.child;D;){if(D===u){L=!0,u=S,h=y;break}if(D===h){L=!0,h=S,u=y;break}D=D.sibling}if(!L)throw Error(i(189))}}if(u.alternate!==h)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:r}function m(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=m(s),r!==null)return r;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),_=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function tt(s){return s===null||typeof s!="object"?null:(s=K&&s[K]||s["@@iterator"],typeof s=="function"?s:null)}var H=Symbol.for("react.client.reference");function G(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===H?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case C:return"Suspense";case N:return"SuspenseList";case B:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case _:return s.displayName||"Context";case b:return(s._context.displayName||"Context")+".Consumer";case I:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case w:return r=s.displayName||null,r!==null?r:G(s.type)||"Memo";case P:r=s._payload,s=s._init;try{return G(s(r))}catch{}}return null}var Y=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},rt=[],ct=-1;function k(s){return{current:s}}function U(s){0>ct||(s.current=rt[ct],rt[ct]=null,ct--)}function it(s,r){ct++,rt[ct]=s.current,s.current=r}var ut=k(null),ft=k(null),dt=k(null),St=k(null);function Dt(s,r){switch(it(dt,r),it(ft,s),it(ut,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?lg(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=lg(r),s=og(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}U(ut),it(ut,s)}function It(){U(ut),U(ft),U(dt)}function ae(s){s.memoizedState!==null&&it(St,s);var r=ut.current,u=og(r,s.type);r!==u&&(it(ft,s),it(ut,u))}function Se(s){ft.current===s&&(U(ut),U(ft)),St.current===s&&(U(St),Ea._currentValue=X)}var Be,mi;function Le(s){if(Be===void 0)try{throw Error()}catch(u){var r=u.stack.trim().match(/\n( *(at )?)/);Be=r&&r[1]||"",mi=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Be+s+mi}var ki=!1;function bt(s,r){if(!s||ki)return"";ki=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(r){var ot=function(){throw Error()};if(Object.defineProperty(ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ot,[])}catch(et){var Z=et}Reflect.construct(s,[],ot)}else{try{ot.call()}catch(et){Z=et}s.call(ot.prototype)}}else{try{throw Error()}catch(et){Z=et}(ot=s())&&typeof ot.catch=="function"&&ot.catch(function(){})}}catch(et){if(et&&Z&&typeof et.stack=="string")return[et.stack,Z.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=h.DetermineComponentFrameRoot(),L=S[0],D=S[1];if(L&&D){var F=L.split(`
`),W=D.split(`
`);for(y=h=0;h<F.length&&!F[h].includes("DetermineComponentFrameRoot");)h++;for(;y<W.length&&!W[y].includes("DetermineComponentFrameRoot");)y++;if(h===F.length||y===W.length)for(h=F.length-1,y=W.length-1;1<=h&&0<=y&&F[h]!==W[y];)y--;for(;1<=h&&0<=y;h--,y--)if(F[h]!==W[y]){if(h!==1||y!==1)do if(h--,y--,0>y||F[h]!==W[y]){var st=`
`+F[h].replace(" at new "," at ");return s.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",s.displayName)),st}while(1<=h&&0<=y);break}}}finally{ki=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Le(u):""}function pt(s,r){switch(s.tag){case 26:case 27:case 5:return Le(s.type);case 16:return Le("Lazy");case 13:return s.child!==r&&r!==null?Le("Suspense Fallback"):Le("Suspense");case 19:return Le("SuspenseList");case 0:case 15:return bt(s.type,!1);case 11:return bt(s.type.render,!1);case 1:return bt(s.type,!0);case 31:return Le("Activity");default:return""}}function Te(s){try{var r="",u=null;do r+=pt(s,u),u=s,s=s.return;while(s);return r}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var le=Object.prototype.hasOwnProperty,oe=l.unstable_scheduleCallback,De=l.unstable_cancelCallback,Fe=l.unstable_shouldYield,$e=l.unstable_requestPaint,ee=l.unstable_now,Xi=l.unstable_getCurrentPriorityLevel,Ke=l.unstable_ImmediatePriority,Js=l.unstable_UserBlockingPriority,xs=l.unstable_NormalPriority,Dn=l.unstable_LowPriority,tn=l.unstable_IdlePriority,Qi=l.log,Xo=l.unstable_setDisableYieldValue,en=null,je=null;function Oi(s){if(typeof Qi=="function"&&Xo(s),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(en,s)}catch{}}var Ge=Math.clz32?Math.clz32:kt,Qo=Math.log,Wo=Math.LN2;function kt(s){return s>>>=0,s===0?32:31-(Qo(s)/Wo|0)|0}var Ga=256,Ha=262144,za=4194304;function sn(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Va(s,r,u){var h=s.pendingLanes;if(h===0)return 0;var y=0,S=s.suspendedLanes,L=s.pingedLanes;s=s.warmLanes;var D=h&134217727;return D!==0?(h=D&~S,h!==0?y=sn(h):(L&=D,L!==0?y=sn(L):u||(u=D&~s,u!==0&&(y=sn(u))))):(D=h&~S,D!==0?y=sn(D):L!==0?y=sn(L):u||(u=h&~s,u!==0&&(y=sn(u)))),y===0?0:r!==0&&r!==y&&(r&S)===0&&(S=y&-y,u=r&-r,S>=u||S===32&&(u&4194048)!==0)?r:y}function kr(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function yE(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gd(){var s=za;return za<<=1,(za&62914560)===0&&(za=4194304),s}function Zo(s){for(var r=[],u=0;31>u;u++)r.push(s);return r}function Or(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function vE(s,r,u,h,y,S){var L=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var D=s.entanglements,F=s.expirationTimes,W=s.hiddenUpdates;for(u=L&~u;0<u;){var st=31-Ge(u),ot=1<<st;D[st]=0,F[st]=-1;var Z=W[st];if(Z!==null)for(W[st]=null,st=0;st<Z.length;st++){var et=Z[st];et!==null&&(et.lane&=-536870913)}u&=~ot}h!==0&&Hd(s,h,0),S!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=S&~(L&~r))}function Hd(s,r,u){s.pendingLanes|=r,s.suspendedLanes&=~r;var h=31-Ge(r);s.entangledLanes|=r,s.entanglements[h]=s.entanglements[h]|1073741824|u&261930}function zd(s,r){var u=s.entangledLanes|=r;for(s=s.entanglements;u;){var h=31-Ge(u),y=1<<h;y&r|s[h]&r&&(s[h]|=r),u&=~y}}function Vd(s,r){var u=r&-r;return u=(u&42)!==0?1:Jo(u),(u&(s.suspendedLanes|r))!==0?0:u}function Jo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function tu(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Kd(){var s=j.p;return s!==0?s:(s=window.event,s===void 0?32:wg(s.type))}function qd(s,r){var u=j.p;try{return j.p=s,r()}finally{j.p=u}}var bs=Math.random().toString(36).slice(2),Ce="__reactFiber$"+bs,qe="__reactProps$"+bs,Cn="__reactContainer$"+bs,eu="__reactEvents$"+bs,EE="__reactListeners$"+bs,SE="__reactHandles$"+bs,Yd="__reactResources$"+bs,Mr="__reactMarker$"+bs;function iu(s){delete s[Ce],delete s[qe],delete s[eu],delete s[EE],delete s[SE]}function wn(s){var r=s[Ce];if(r)return r;for(var u=s.parentNode;u;){if(r=u[Cn]||u[Ce]){if(u=r.alternate,r.child!==null||u!==null&&u.child!==null)for(s=pg(s);s!==null;){if(u=s[Ce])return u;s=pg(s)}return r}s=u,u=s.parentNode}return null}function kn(s){if(s=s[Ce]||s[Cn]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Pr(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function On(s){var r=s[Yd];return r||(r=s[Yd]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Re(s){s[Mr]=!0}var Xd=new Set,Qd={};function nn(s,r){Mn(s,r),Mn(s+"Capture",r)}function Mn(s,r){for(Qd[s]=r,s=0;s<r.length;s++)Xd.add(r[s])}var TE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wd={},Zd={};function xE(s){return le.call(Zd,s)?!0:le.call(Wd,s)?!1:TE.test(s)?Zd[s]=!0:(Wd[s]=!0,!1)}function Ka(s,r,u){if(xE(r))if(u===null)s.removeAttribute(r);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var h=r.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+u)}}function qa(s,r,u){if(u===null)s.removeAttribute(r);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+u)}}function Wi(s,r,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(r,u,""+h)}}function pi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Jd(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function bE(s,r,u){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,S=h.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return y.call(this)},set:function(L){u=""+L,S.call(this,L)}}),Object.defineProperty(s,r,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(L){u=""+L},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function su(s){if(!s._valueTracker){var r=Jd(s)?"checked":"value";s._valueTracker=bE(s,r,""+s[r])}}function th(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var u=r.getValue(),h="";return s&&(h=Jd(s)?s.checked?"true":"false":s.value),s=h,s!==u?(r.setValue(s),!0):!1}function Ya(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var AE=/[\n"\\]/g;function gi(s){return s.replace(AE,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function nu(s,r,u,h,y,S,L,D){s.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?s.type=L:s.removeAttribute("type"),r!=null?L==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+pi(r)):s.value!==""+pi(r)&&(s.value=""+pi(r)):L!=="submit"&&L!=="reset"||s.removeAttribute("value"),r!=null?ru(s,L,pi(r)):u!=null?ru(s,L,pi(u)):h!=null&&s.removeAttribute("value"),y==null&&S!=null&&(s.defaultChecked=!!S),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+pi(D):s.removeAttribute("name")}function eh(s,r,u,h,y,S,L,D){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.type=S),r!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||r!=null)){su(s);return}u=u!=null?""+pi(u):"",r=r!=null?""+pi(r):u,D||r===s.value||(s.value=r),s.defaultValue=r}h=h??y,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=D?s.checked:!!h,s.defaultChecked=!!h,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(s.name=L),su(s)}function ru(s,r,u){r==="number"&&Ya(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Pn(s,r,u,h){if(s=s.options,r){r={};for(var y=0;y<u.length;y++)r["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=r.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&h&&(s[u].defaultSelected=!0)}else{for(u=""+pi(u),r=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,h&&(s[y].defaultSelected=!0);return}r!==null||s[y].disabled||(r=s[y])}r!==null&&(r.selected=!0)}}function ih(s,r,u){if(r!=null&&(r=""+pi(r),r!==s.value&&(s.value=r),u==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=u!=null?""+pi(u):""}function sh(s,r,u,h){if(r==null){if(h!=null){if(u!=null)throw Error(i(92));if(Y(h)){if(1<h.length)throw Error(i(93));h=h[0]}u=h}u==null&&(u=""),r=u}u=pi(r),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h),su(s)}function Nn(s,r){if(r){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=r;return}}s.textContent=r}var LE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nh(s,r,u){var h=r.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":h?s.setProperty(r,u):typeof u!="number"||u===0||LE.has(r)?r==="float"?s.cssFloat=u:s[r]=(""+u).trim():s[r]=u+"px"}function rh(s,r,u){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||r!=null&&r.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var y in r)h=r[y],r.hasOwnProperty(y)&&u[y]!==h&&nh(s,y,h)}else for(var S in r)r.hasOwnProperty(S)&&nh(s,S,r[S])}function au(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_E=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xa(s){return _E.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Zi(){}var lu=null;function ou(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Bn=null,Fn=null;function ah(s){var r=kn(s);if(r&&(s=r.stateNode)){var u=s[qe]||null;t:switch(s=r.stateNode,r.type){case"input":if(nu(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),r=u.name,u.type==="radio"&&r!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+gi(""+r)+'"][type="radio"]'),r=0;r<u.length;r++){var h=u[r];if(h!==s&&h.form===s.form){var y=h[qe]||null;if(!y)throw Error(i(90));nu(h,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(r=0;r<u.length;r++)h=u[r],h.form===s.form&&th(h)}break t;case"textarea":ih(s,u.value,u.defaultValue);break t;case"select":r=u.value,r!=null&&Pn(s,!!u.multiple,r,!1)}}}var uu=!1;function lh(s,r,u){if(uu)return s(r,u);uu=!0;try{var h=s(r);return h}finally{if(uu=!1,(Bn!==null||Fn!==null)&&(Nl(),Bn&&(r=Bn,s=Fn,Fn=Bn=null,ah(r),s)))for(r=0;r<s.length;r++)ah(s[r])}}function Nr(s,r){var u=s.stateNode;if(u===null)return null;var h=u[qe]||null;if(h===null)return null;u=h[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break t;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,r,typeof u));return u}var Ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cu=!1;if(Ji)try{var Br={};Object.defineProperty(Br,"passive",{get:function(){cu=!0}}),window.addEventListener("test",Br,Br),window.removeEventListener("test",Br,Br)}catch{cu=!1}var As=null,fu=null,Qa=null;function oh(){if(Qa)return Qa;var s,r=fu,u=r.length,h,y="value"in As?As.value:As.textContent,S=y.length;for(s=0;s<u&&r[s]===y[s];s++);var L=u-s;for(h=1;h<=L&&r[u-h]===y[S-h];h++);return Qa=y.slice(s,1<h?1-h:void 0)}function Wa(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Za(){return!0}function uh(){return!1}function Ye(s){function r(u,h,y,S,L){this._reactName=u,this._targetInst=y,this.type=h,this.nativeEvent=S,this.target=L,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(u=s[D],this[D]=u?u(S):S[D]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Za:uh,this.isPropagationStopped=uh,this}return p(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),r}var rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ja=Ye(rn),Fr=p({},rn,{view:0,detail:0}),IE=Ye(Fr),du,hu,Ur,tl=p({},Fr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ur&&(Ur&&s.type==="mousemove"?(du=s.screenX-Ur.screenX,hu=s.screenY-Ur.screenY):hu=du=0,Ur=s),du)},movementY:function(s){return"movementY"in s?s.movementY:hu}}),ch=Ye(tl),DE=p({},tl,{dataTransfer:0}),CE=Ye(DE),wE=p({},Fr,{relatedTarget:0}),mu=Ye(wE),kE=p({},rn,{animationName:0,elapsedTime:0,pseudoElement:0}),OE=Ye(kE),ME=p({},rn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),PE=Ye(ME),NE=p({},rn,{data:0}),fh=Ye(NE),BE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $E(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=UE[s])?!!r[s]:!1}function pu(){return $E}var jE=p({},Fr,{key:function(s){if(s.key){var r=BE[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Wa(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?FE[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pu,charCode:function(s){return s.type==="keypress"?Wa(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Wa(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),GE=Ye(jE),HE=p({},tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dh=Ye(HE),zE=p({},Fr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pu}),VE=Ye(zE),KE=p({},rn,{propertyName:0,elapsedTime:0,pseudoElement:0}),qE=Ye(KE),YE=p({},tl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),XE=Ye(YE),QE=p({},rn,{newState:0,oldState:0}),WE=Ye(QE),ZE=[9,13,27,32],gu=Ji&&"CompositionEvent"in window,$r=null;Ji&&"documentMode"in document&&($r=document.documentMode);var JE=Ji&&"TextEvent"in window&&!$r,hh=Ji&&(!gu||$r&&8<$r&&11>=$r),mh=" ",ph=!1;function gh(s,r){switch(s){case"keyup":return ZE.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Un=!1;function tS(s,r){switch(s){case"compositionend":return yh(r);case"keypress":return r.which!==32?null:(ph=!0,mh);case"textInput":return s=r.data,s===mh&&ph?null:s;default:return null}}function eS(s,r){if(Un)return s==="compositionend"||!gu&&gh(s,r)?(s=oh(),Qa=fu=As=null,Un=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return hh&&r.locale!=="ko"?null:r.data;default:return null}}var iS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vh(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!iS[s.type]:r==="textarea"}function Eh(s,r,u,h){Bn?Fn?Fn.push(h):Fn=[h]:Bn=h,r=Hl(r,"onChange"),0<r.length&&(u=new Ja("onChange","change",null,u,h),s.push({event:u,listeners:r}))}var jr=null,Gr=null;function sS(s){eg(s,0)}function el(s){var r=Pr(s);if(th(r))return s}function Sh(s,r){if(s==="change")return r}var Th=!1;if(Ji){var yu;if(Ji){var vu="oninput"in document;if(!vu){var xh=document.createElement("div");xh.setAttribute("oninput","return;"),vu=typeof xh.oninput=="function"}yu=vu}else yu=!1;Th=yu&&(!document.documentMode||9<document.documentMode)}function bh(){jr&&(jr.detachEvent("onpropertychange",Ah),Gr=jr=null)}function Ah(s){if(s.propertyName==="value"&&el(Gr)){var r=[];Eh(r,Gr,s,ou(s)),lh(sS,r)}}function nS(s,r,u){s==="focusin"?(bh(),jr=r,Gr=u,jr.attachEvent("onpropertychange",Ah)):s==="focusout"&&bh()}function rS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return el(Gr)}function aS(s,r){if(s==="click")return el(r)}function lS(s,r){if(s==="input"||s==="change")return el(r)}function oS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var ii=typeof Object.is=="function"?Object.is:oS;function Hr(s,r){if(ii(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var u=Object.keys(s),h=Object.keys(r);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var y=u[h];if(!le.call(r,y)||!ii(s[y],r[y]))return!1}return!0}function Lh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Rh(s,r){var u=Lh(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=r&&h>=r)return{node:u,offset:r-s};s=h}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=Lh(u)}}function _h(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?_h(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ih(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ya(s.document);r instanceof s.HTMLIFrameElement;){try{var u=typeof r.contentWindow.location.href=="string"}catch{u=!1}if(u)s=r.contentWindow;else break;r=Ya(s.document)}return r}function Eu(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var uS=Ji&&"documentMode"in document&&11>=document.documentMode,$n=null,Su=null,zr=null,Tu=!1;function Dh(s,r,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Tu||$n==null||$n!==Ya(h)||(h=$n,"selectionStart"in h&&Eu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),zr&&Hr(zr,h)||(zr=h,h=Hl(Su,"onSelect"),0<h.length&&(r=new Ja("onSelect","select",null,r,u),s.push({event:r,listeners:h}),r.target=$n)))}function an(s,r){var u={};return u[s.toLowerCase()]=r.toLowerCase(),u["Webkit"+s]="webkit"+r,u["Moz"+s]="moz"+r,u}var jn={animationend:an("Animation","AnimationEnd"),animationiteration:an("Animation","AnimationIteration"),animationstart:an("Animation","AnimationStart"),transitionrun:an("Transition","TransitionRun"),transitionstart:an("Transition","TransitionStart"),transitioncancel:an("Transition","TransitionCancel"),transitionend:an("Transition","TransitionEnd")},xu={},Ch={};Ji&&(Ch=document.createElement("div").style,"AnimationEvent"in window||(delete jn.animationend.animation,delete jn.animationiteration.animation,delete jn.animationstart.animation),"TransitionEvent"in window||delete jn.transitionend.transition);function ln(s){if(xu[s])return xu[s];if(!jn[s])return s;var r=jn[s],u;for(u in r)if(r.hasOwnProperty(u)&&u in Ch)return xu[s]=r[u];return s}var wh=ln("animationend"),kh=ln("animationiteration"),Oh=ln("animationstart"),cS=ln("transitionrun"),fS=ln("transitionstart"),dS=ln("transitioncancel"),Mh=ln("transitionend"),Ph=new Map,bu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bu.push("scrollEnd");function _i(s,r){Ph.set(s,r),nn(r,[s])}var il=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},yi=[],Gn=0,Au=0;function sl(){for(var s=Gn,r=Au=Gn=0;r<s;){var u=yi[r];yi[r++]=null;var h=yi[r];yi[r++]=null;var y=yi[r];yi[r++]=null;var S=yi[r];if(yi[r++]=null,h!==null&&y!==null){var L=h.pending;L===null?y.next=y:(y.next=L.next,L.next=y),h.pending=y}S!==0&&Nh(u,y,S)}}function nl(s,r,u,h){yi[Gn++]=s,yi[Gn++]=r,yi[Gn++]=u,yi[Gn++]=h,Au|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Lu(s,r,u,h){return nl(s,r,u,h),rl(s)}function on(s,r){return nl(s,null,null,r),rl(s)}function Nh(s,r,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var y=!1,S=s.return;S!==null;)S.childLanes|=u,h=S.alternate,h!==null&&(h.childLanes|=u),S.tag===22&&(s=S.stateNode,s===null||s._visibility&1||(y=!0)),s=S,S=S.return;return s.tag===3?(S=s.stateNode,y&&r!==null&&(y=31-Ge(u),s=S.hiddenUpdates,h=s[y],h===null?s[y]=[r]:h.push(r),r.lane=u|536870912),S):null}function rl(s){if(50<da)throw da=0,Mc=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Hn={};function hS(s,r,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(s,r,u,h){return new hS(s,r,u,h)}function Ru(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ts(s,r){var u=s.alternate;return u===null?(u=si(s.tag,r,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=r,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,r=s.dependencies,u.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Bh(s,r){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,r=u.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function al(s,r,u,h,y,S){var L=0;if(h=s,typeof s=="function")Ru(s)&&(L=1);else if(typeof s=="string")L=vT(s,u,ut.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case B:return s=si(31,u,r,y),s.elementType=B,s.lanes=S,s;case x:return un(u.children,y,S,r);case T:L=8,y|=24;break;case A:return s=si(12,u,r,y|2),s.elementType=A,s.lanes=S,s;case C:return s=si(13,u,r,y),s.elementType=C,s.lanes=S,s;case N:return s=si(19,u,r,y),s.elementType=N,s.lanes=S,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:L=10;break t;case b:L=9;break t;case I:L=11;break t;case w:L=14;break t;case P:L=16,h=null;break t}L=29,u=Error(i(130,s===null?"null":typeof s,"")),h=null}return r=si(L,u,r,y),r.elementType=s,r.type=h,r.lanes=S,r}function un(s,r,u,h){return s=si(7,s,h,r),s.lanes=u,s}function _u(s,r,u){return s=si(6,s,null,r),s.lanes=u,s}function Fh(s){var r=si(18,null,null,0);return r.stateNode=s,r}function Iu(s,r,u){return r=si(4,s.children!==null?s.children:[],s.key,r),r.lanes=u,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Uh=new WeakMap;function vi(s,r){if(typeof s=="object"&&s!==null){var u=Uh.get(s);return u!==void 0?u:(r={value:s,source:r,stack:Te(r)},Uh.set(s,r),r)}return{value:s,source:r,stack:Te(r)}}var zn=[],Vn=0,ll=null,Vr=0,Ei=[],Si=0,Ls=null,Mi=1,Pi="";function es(s,r){zn[Vn++]=Vr,zn[Vn++]=ll,ll=s,Vr=r}function $h(s,r,u){Ei[Si++]=Mi,Ei[Si++]=Pi,Ei[Si++]=Ls,Ls=s;var h=Mi;s=Pi;var y=32-Ge(h)-1;h&=~(1<<y),u+=1;var S=32-Ge(r)+y;if(30<S){var L=y-y%5;S=(h&(1<<L)-1).toString(32),h>>=L,y-=L,Mi=1<<32-Ge(r)+y|u<<y|h,Pi=S+s}else Mi=1<<S|u<<y|h,Pi=s}function Du(s){s.return!==null&&(es(s,1),$h(s,1,0))}function Cu(s){for(;s===ll;)ll=zn[--Vn],zn[Vn]=null,Vr=zn[--Vn],zn[Vn]=null;for(;s===Ls;)Ls=Ei[--Si],Ei[Si]=null,Pi=Ei[--Si],Ei[Si]=null,Mi=Ei[--Si],Ei[Si]=null}function jh(s,r){Ei[Si++]=Mi,Ei[Si++]=Pi,Ei[Si++]=Ls,Mi=r.id,Pi=r.overflow,Ls=s}var we=null,Jt=null,Bt=!1,Rs=null,Ti=!1,wu=Error(i(519));function _s(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kr(vi(r,s)),wu}function Gh(s){var r=s.stateNode,u=s.type,h=s.memoizedProps;switch(r[Ce]=s,r[qe]=h,u){case"dialog":Mt("cancel",r),Mt("close",r);break;case"iframe":case"object":case"embed":Mt("load",r);break;case"video":case"audio":for(u=0;u<ma.length;u++)Mt(ma[u],r);break;case"source":Mt("error",r);break;case"img":case"image":case"link":Mt("error",r),Mt("load",r);break;case"details":Mt("toggle",r);break;case"input":Mt("invalid",r),eh(r,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Mt("invalid",r);break;case"textarea":Mt("invalid",r),sh(r,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||r.textContent===""+u||h.suppressHydrationWarning===!0||rg(r.textContent,u)?(h.popover!=null&&(Mt("beforetoggle",r),Mt("toggle",r)),h.onScroll!=null&&Mt("scroll",r),h.onScrollEnd!=null&&Mt("scrollend",r),h.onClick!=null&&(r.onclick=Zi),r=!0):r=!1,r||_s(s,!0)}function Hh(s){for(we=s.return;we;)switch(we.tag){case 5:case 31:case 13:Ti=!1;return;case 27:case 3:Ti=!0;return;default:we=we.return}}function Kn(s){if(s!==we)return!1;if(!Bt)return Hh(s),Bt=!0,!1;var r=s.tag,u;if((u=r!==3&&r!==27)&&((u=r===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Xc(s.type,s.memoizedProps)),u=!u),u&&Jt&&_s(s),Hh(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Jt=mg(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Jt=mg(s)}else r===27?(r=Jt,js(s.type)?(s=tf,tf=null,Jt=s):Jt=r):Jt=we?bi(s.stateNode.nextSibling):null;return!0}function cn(){Jt=we=null,Bt=!1}function ku(){var s=Rs;return s!==null&&(Ze===null?Ze=s:Ze.push.apply(Ze,s),Rs=null),s}function Kr(s){Rs===null?Rs=[s]:Rs.push(s)}var Ou=k(null),fn=null,is=null;function Is(s,r,u){it(Ou,r._currentValue),r._currentValue=u}function ss(s){s._currentValue=Ou.current,U(Ou)}function Mu(s,r,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,h!==null&&(h.childLanes|=r)):h!==null&&(h.childLanes&r)!==r&&(h.childLanes|=r),s===u)break;s=s.return}}function Pu(s,r,u,h){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var S=y.dependencies;if(S!==null){var L=y.child;S=S.firstContext;t:for(;S!==null;){var D=S;S=y;for(var F=0;F<r.length;F++)if(D.context===r[F]){S.lanes|=u,D=S.alternate,D!==null&&(D.lanes|=u),Mu(S.return,u,s),h||(L=null);break t}S=D.next}}else if(y.tag===18){if(L=y.return,L===null)throw Error(i(341));L.lanes|=u,S=L.alternate,S!==null&&(S.lanes|=u),Mu(L,u,s),L=null}else L=y.child;if(L!==null)L.return=y;else for(L=y;L!==null;){if(L===s){L=null;break}if(y=L.sibling,y!==null){y.return=L.return,L=y;break}L=L.return}y=L}}function qn(s,r,u,h){s=null;for(var y=r,S=!1;y!==null;){if(!S){if((y.flags&524288)!==0)S=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var L=y.alternate;if(L===null)throw Error(i(387));if(L=L.memoizedProps,L!==null){var D=y.type;ii(y.pendingProps.value,L.value)||(s!==null?s.push(D):s=[D])}}else if(y===St.current){if(L=y.alternate,L===null)throw Error(i(387));L.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(Ea):s=[Ea])}y=y.return}s!==null&&Pu(r,s,u,h),r.flags|=262144}function ol(s){for(s=s.firstContext;s!==null;){if(!ii(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function dn(s){fn=s,is=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ke(s){return zh(fn,s)}function ul(s,r){return fn===null&&dn(s),zh(s,r)}function zh(s,r){var u=r._currentValue;if(r={context:r,memoizedValue:u,next:null},is===null){if(s===null)throw Error(i(308));is=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else is=is.next=r;return u}var mS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){r.aborted=!0,s.forEach(function(u){return u()})}},pS=l.unstable_scheduleCallback,gS=l.unstable_NormalPriority,pe={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nu(){return{controller:new mS,data:new Map,refCount:0}}function qr(s){s.refCount--,s.refCount===0&&pS(gS,function(){s.controller.abort()})}var Yr=null,Bu=0,Yn=0,Xn=null;function yS(s,r){if(Yr===null){var u=Yr=[];Bu=0,Yn=$c(),Xn={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Bu++,r.then(Vh,Vh),r}function Vh(){if(--Bu===0&&Yr!==null){Xn!==null&&(Xn.status="fulfilled");var s=Yr;Yr=null,Yn=0,Xn=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function vS(s,r){var u=[],h={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){h.status="fulfilled",h.value=r;for(var y=0;y<u.length;y++)(0,u[y])(r)},function(y){for(h.status="rejected",h.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),h}var Kh=O.S;O.S=function(s,r){Dp=ee(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&yS(s,r),Kh!==null&&Kh(s,r)};var hn=k(null);function Fu(){var s=hn.current;return s!==null?s:Qt.pooledCache}function cl(s,r){r===null?it(hn,hn.current):it(hn,r.pool)}function qh(){var s=Fu();return s===null?null:{parent:pe._currentValue,pool:s}}var Qn=Error(i(460)),Uu=Error(i(474)),fl=Error(i(542)),dl={then:function(){}};function Yh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Xh(s,r,u){switch(u=s[u],u===void 0?s.push(r):u!==r&&(r.then(Zi,Zi),r=u),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wh(s),s;default:if(typeof r.status=="string")r.then(Zi,Zi);else{if(s=Qt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(h){if(r.status==="pending"){var y=r;y.status="fulfilled",y.value=h}},function(h){if(r.status==="pending"){var y=r;y.status="rejected",y.reason=h}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wh(s),s}throw pn=r,Qn}}function mn(s){try{var r=s._init;return r(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(pn=u,Qn):u}}var pn=null;function Qh(){if(pn===null)throw Error(i(459));var s=pn;return pn=null,s}function Wh(s){if(s===Qn||s===fl)throw Error(i(483))}var Wn=null,Xr=0;function hl(s){var r=Xr;return Xr+=1,Wn===null&&(Wn=[]),Xh(Wn,s,r)}function Qr(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function ml(s,r){throw r.$$typeof===g?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Zh(s){function r(z,$){if(s){var Q=z.deletions;Q===null?(z.deletions=[$],z.flags|=16):Q.push($)}}function u(z,$){if(!s)return null;for(;$!==null;)r(z,$),$=$.sibling;return null}function h(z){for(var $=new Map;z!==null;)z.key!==null?$.set(z.key,z):$.set(z.index,z),z=z.sibling;return $}function y(z,$){return z=ts(z,$),z.index=0,z.sibling=null,z}function S(z,$,Q){return z.index=Q,s?(Q=z.alternate,Q!==null?(Q=Q.index,Q<$?(z.flags|=67108866,$):Q):(z.flags|=67108866,$)):(z.flags|=1048576,$)}function L(z){return s&&z.alternate===null&&(z.flags|=67108866),z}function D(z,$,Q,at){return $===null||$.tag!==6?($=_u(Q,z.mode,at),$.return=z,$):($=y($,Q),$.return=z,$)}function F(z,$,Q,at){var Et=Q.type;return Et===x?st(z,$,Q.props.children,at,Q.key):$!==null&&($.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===P&&mn(Et)===$.type)?($=y($,Q.props),Qr($,Q),$.return=z,$):($=al(Q.type,Q.key,Q.props,null,z.mode,at),Qr($,Q),$.return=z,$)}function W(z,$,Q,at){return $===null||$.tag!==4||$.stateNode.containerInfo!==Q.containerInfo||$.stateNode.implementation!==Q.implementation?($=Iu(Q,z.mode,at),$.return=z,$):($=y($,Q.children||[]),$.return=z,$)}function st(z,$,Q,at,Et){return $===null||$.tag!==7?($=un(Q,z.mode,at,Et),$.return=z,$):($=y($,Q),$.return=z,$)}function ot(z,$,Q){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=_u(""+$,z.mode,Q),$.return=z,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case v:return Q=al($.type,$.key,$.props,null,z.mode,Q),Qr(Q,$),Q.return=z,Q;case E:return $=Iu($,z.mode,Q),$.return=z,$;case P:return $=mn($),ot(z,$,Q)}if(Y($)||tt($))return $=un($,z.mode,Q,null),$.return=z,$;if(typeof $.then=="function")return ot(z,hl($),Q);if($.$$typeof===_)return ot(z,ul(z,$),Q);ml(z,$)}return null}function Z(z,$,Q,at){var Et=$!==null?$.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Et!==null?null:D(z,$,""+Q,at);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case v:return Q.key===Et?F(z,$,Q,at):null;case E:return Q.key===Et?W(z,$,Q,at):null;case P:return Q=mn(Q),Z(z,$,Q,at)}if(Y(Q)||tt(Q))return Et!==null?null:st(z,$,Q,at,null);if(typeof Q.then=="function")return Z(z,$,hl(Q),at);if(Q.$$typeof===_)return Z(z,$,ul(z,Q),at);ml(z,Q)}return null}function et(z,$,Q,at,Et){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return z=z.get(Q)||null,D($,z,""+at,Et);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case v:return z=z.get(at.key===null?Q:at.key)||null,F($,z,at,Et);case E:return z=z.get(at.key===null?Q:at.key)||null,W($,z,at,Et);case P:return at=mn(at),et(z,$,Q,at,Et)}if(Y(at)||tt(at))return z=z.get(Q)||null,st($,z,at,Et,null);if(typeof at.then=="function")return et(z,$,Q,hl(at),Et);if(at.$$typeof===_)return et(z,$,Q,ul($,at),Et);ml($,at)}return null}function gt(z,$,Q,at){for(var Et=null,Ut=null,yt=$,_t=$=0,Nt=null;yt!==null&&_t<Q.length;_t++){yt.index>_t?(Nt=yt,yt=null):Nt=yt.sibling;var $t=Z(z,yt,Q[_t],at);if($t===null){yt===null&&(yt=Nt);break}s&&yt&&$t.alternate===null&&r(z,yt),$=S($t,$,_t),Ut===null?Et=$t:Ut.sibling=$t,Ut=$t,yt=Nt}if(_t===Q.length)return u(z,yt),Bt&&es(z,_t),Et;if(yt===null){for(;_t<Q.length;_t++)yt=ot(z,Q[_t],at),yt!==null&&($=S(yt,$,_t),Ut===null?Et=yt:Ut.sibling=yt,Ut=yt);return Bt&&es(z,_t),Et}for(yt=h(yt);_t<Q.length;_t++)Nt=et(yt,z,_t,Q[_t],at),Nt!==null&&(s&&Nt.alternate!==null&&yt.delete(Nt.key===null?_t:Nt.key),$=S(Nt,$,_t),Ut===null?Et=Nt:Ut.sibling=Nt,Ut=Nt);return s&&yt.forEach(function(Ks){return r(z,Ks)}),Bt&&es(z,_t),Et}function Tt(z,$,Q,at){if(Q==null)throw Error(i(151));for(var Et=null,Ut=null,yt=$,_t=$=0,Nt=null,$t=Q.next();yt!==null&&!$t.done;_t++,$t=Q.next()){yt.index>_t?(Nt=yt,yt=null):Nt=yt.sibling;var Ks=Z(z,yt,$t.value,at);if(Ks===null){yt===null&&(yt=Nt);break}s&&yt&&Ks.alternate===null&&r(z,yt),$=S(Ks,$,_t),Ut===null?Et=Ks:Ut.sibling=Ks,Ut=Ks,yt=Nt}if($t.done)return u(z,yt),Bt&&es(z,_t),Et;if(yt===null){for(;!$t.done;_t++,$t=Q.next())$t=ot(z,$t.value,at),$t!==null&&($=S($t,$,_t),Ut===null?Et=$t:Ut.sibling=$t,Ut=$t);return Bt&&es(z,_t),Et}for(yt=h(yt);!$t.done;_t++,$t=Q.next())$t=et(yt,z,_t,$t.value,at),$t!==null&&(s&&$t.alternate!==null&&yt.delete($t.key===null?_t:$t.key),$=S($t,$,_t),Ut===null?Et=$t:Ut.sibling=$t,Ut=$t);return s&&yt.forEach(function(DT){return r(z,DT)}),Bt&&es(z,_t),Et}function Yt(z,$,Q,at){if(typeof Q=="object"&&Q!==null&&Q.type===x&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case v:t:{for(var Et=Q.key;$!==null;){if($.key===Et){if(Et=Q.type,Et===x){if($.tag===7){u(z,$.sibling),at=y($,Q.props.children),at.return=z,z=at;break t}}else if($.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===P&&mn(Et)===$.type){u(z,$.sibling),at=y($,Q.props),Qr(at,Q),at.return=z,z=at;break t}u(z,$);break}else r(z,$);$=$.sibling}Q.type===x?(at=un(Q.props.children,z.mode,at,Q.key),at.return=z,z=at):(at=al(Q.type,Q.key,Q.props,null,z.mode,at),Qr(at,Q),at.return=z,z=at)}return L(z);case E:t:{for(Et=Q.key;$!==null;){if($.key===Et)if($.tag===4&&$.stateNode.containerInfo===Q.containerInfo&&$.stateNode.implementation===Q.implementation){u(z,$.sibling),at=y($,Q.children||[]),at.return=z,z=at;break t}else{u(z,$);break}else r(z,$);$=$.sibling}at=Iu(Q,z.mode,at),at.return=z,z=at}return L(z);case P:return Q=mn(Q),Yt(z,$,Q,at)}if(Y(Q))return gt(z,$,Q,at);if(tt(Q)){if(Et=tt(Q),typeof Et!="function")throw Error(i(150));return Q=Et.call(Q),Tt(z,$,Q,at)}if(typeof Q.then=="function")return Yt(z,$,hl(Q),at);if(Q.$$typeof===_)return Yt(z,$,ul(z,Q),at);ml(z,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,$!==null&&$.tag===6?(u(z,$.sibling),at=y($,Q),at.return=z,z=at):(u(z,$),at=_u(Q,z.mode,at),at.return=z,z=at),L(z)):u(z,$)}return function(z,$,Q,at){try{Xr=0;var Et=Yt(z,$,Q,at);return Wn=null,Et}catch(yt){if(yt===Qn||yt===fl)throw yt;var Ut=si(29,yt,null,z.mode);return Ut.lanes=at,Ut.return=z,Ut}finally{}}}var gn=Zh(!0),Jh=Zh(!1),Ds=!1;function $u(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ju(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Cs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ws(s,r,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(jt&2)!==0){var y=h.pending;return y===null?r.next=r:(r.next=y.next,y.next=r),h.pending=r,r=rl(s),Nh(s,null,u),r}return nl(s,h,r,u),rl(s)}function Wr(s,r,u){if(r=r.updateQueue,r!==null&&(r=r.shared,(u&4194048)!==0)){var h=r.lanes;h&=s.pendingLanes,u|=h,r.lanes=u,zd(s,u)}}function Gu(s,r){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var y=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var L={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?y=S=L:S=S.next=L,u=u.next}while(u!==null);S===null?y=S=r:S=S.next=r}else y=S=r;u={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:S,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=r:s.next=r,u.lastBaseUpdate=r}var Hu=!1;function Zr(){if(Hu){var s=Xn;if(s!==null)throw s}}function Jr(s,r,u,h){Hu=!1;var y=s.updateQueue;Ds=!1;var S=y.firstBaseUpdate,L=y.lastBaseUpdate,D=y.shared.pending;if(D!==null){y.shared.pending=null;var F=D,W=F.next;F.next=null,L===null?S=W:L.next=W,L=F;var st=s.alternate;st!==null&&(st=st.updateQueue,D=st.lastBaseUpdate,D!==L&&(D===null?st.firstBaseUpdate=W:D.next=W,st.lastBaseUpdate=F))}if(S!==null){var ot=y.baseState;L=0,st=W=F=null,D=S;do{var Z=D.lane&-536870913,et=Z!==D.lane;if(et?(Pt&Z)===Z:(h&Z)===Z){Z!==0&&Z===Yn&&(Hu=!0),st!==null&&(st=st.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});t:{var gt=s,Tt=D;Z=r;var Yt=u;switch(Tt.tag){case 1:if(gt=Tt.payload,typeof gt=="function"){ot=gt.call(Yt,ot,Z);break t}ot=gt;break t;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=Tt.payload,Z=typeof gt=="function"?gt.call(Yt,ot,Z):gt,Z==null)break t;ot=p({},ot,Z);break t;case 2:Ds=!0}}Z=D.callback,Z!==null&&(s.flags|=64,et&&(s.flags|=8192),et=y.callbacks,et===null?y.callbacks=[Z]:et.push(Z))}else et={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},st===null?(W=st=et,F=ot):st=st.next=et,L|=Z;if(D=D.next,D===null){if(D=y.shared.pending,D===null)break;et=D,D=et.next,et.next=null,y.lastBaseUpdate=et,y.shared.pending=null}}while(!0);st===null&&(F=ot),y.baseState=F,y.firstBaseUpdate=W,y.lastBaseUpdate=st,S===null&&(y.shared.lanes=0),Ns|=L,s.lanes=L,s.memoizedState=ot}}function tm(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function em(s,r){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)tm(u[s],r)}var Zn=k(null),pl=k(0);function im(s,r){s=ds,it(pl,s),it(Zn,r),ds=s|r.baseLanes}function zu(){it(pl,ds),it(Zn,Zn.current)}function Vu(){ds=pl.current,U(Zn),U(pl)}var ni=k(null),xi=null;function ks(s){var r=s.alternate;it(he,he.current&1),it(ni,s),xi===null&&(r===null||Zn.current!==null||r.memoizedState!==null)&&(xi=s)}function Ku(s){it(he,he.current),it(ni,s),xi===null&&(xi=s)}function sm(s){s.tag===22?(it(he,he.current),it(ni,s),xi===null&&(xi=s)):Os()}function Os(){it(he,he.current),it(ni,ni.current)}function ri(s){U(ni),xi===s&&(xi=null),U(he)}var he=k(0);function gl(s){for(var r=s;r!==null;){if(r.tag===13){var u=r.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Zc(u)||Jc(u)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ns=0,Rt=null,Kt=null,ge=null,yl=!1,Jn=!1,yn=!1,vl=0,ta=0,tr=null,ES=0;function ue(){throw Error(i(321))}function qu(s,r){if(r===null)return!1;for(var u=0;u<r.length&&u<s.length;u++)if(!ii(s[u],r[u]))return!1;return!0}function Yu(s,r,u,h,y,S){return ns=S,Rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,O.H=s===null||s.memoizedState===null?$m:uc,yn=!1,S=u(h,y),yn=!1,Jn&&(S=rm(r,u,h,y)),nm(s),S}function nm(s){O.H=sa;var r=Kt!==null&&Kt.next!==null;if(ns=0,ge=Kt=Rt=null,yl=!1,ta=0,tr=null,r)throw Error(i(300));s===null||ye||(s=s.dependencies,s!==null&&ol(s)&&(ye=!0))}function rm(s,r,u,h){Rt=s;var y=0;do{if(Jn&&(tr=null),ta=0,Jn=!1,25<=y)throw Error(i(301));if(y+=1,ge=Kt=null,s.updateQueue!=null){var S=s.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}O.H=jm,S=r(u,h)}while(Jn);return S}function SS(){var s=O.H,r=s.useState()[0];return r=typeof r.then=="function"?ea(r):r,s=s.useState()[0],(Kt!==null?Kt.memoizedState:null)!==s&&(Rt.flags|=1024),r}function Xu(){var s=vl!==0;return vl=0,s}function Qu(s,r,u){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~u}function Wu(s){if(yl){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}yl=!1}ns=0,ge=Kt=Rt=null,Jn=!1,ta=vl=0,tr=null}function He(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ge===null?Rt.memoizedState=ge=s:ge=ge.next=s,ge}function me(){if(Kt===null){var s=Rt.alternate;s=s!==null?s.memoizedState:null}else s=Kt.next;var r=ge===null?Rt.memoizedState:ge.next;if(r!==null)ge=r,Kt=s;else{if(s===null)throw Rt.alternate===null?Error(i(467)):Error(i(310));Kt=s,s={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},ge===null?Rt.memoizedState=ge=s:ge=ge.next=s}return ge}function El(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ea(s){var r=ta;return ta+=1,tr===null&&(tr=[]),s=Xh(tr,s,r),r=Rt,(ge===null?r.memoizedState:ge.next)===null&&(r=r.alternate,O.H=r===null||r.memoizedState===null?$m:uc),s}function Sl(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ea(s);if(s.$$typeof===_)return ke(s)}throw Error(i(438,String(s)))}function Zu(s){var r=null,u=Rt.updateQueue;if(u!==null&&(r=u.memoCache),r==null){var h=Rt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(r={data:h.data.map(function(y){return y.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),u===null&&(u=El(),Rt.updateQueue=u),u.memoCache=r,u=r.data[r.index],u===void 0)for(u=r.data[r.index]=Array(s),h=0;h<s;h++)u[h]=M;return r.index++,u}function rs(s,r){return typeof r=="function"?r(s):r}function Tl(s){var r=me();return Ju(r,Kt,s)}function Ju(s,r,u){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=u;var y=s.baseQueue,S=h.pending;if(S!==null){if(y!==null){var L=y.next;y.next=S.next,S.next=L}r.baseQueue=y=S,h.pending=null}if(S=s.baseState,y===null)s.memoizedState=S;else{r=y.next;var D=L=null,F=null,W=r,st=!1;do{var ot=W.lane&-536870913;if(ot!==W.lane?(Pt&ot)===ot:(ns&ot)===ot){var Z=W.revertLane;if(Z===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),ot===Yn&&(st=!0);else if((ns&Z)===Z){W=W.next,Z===Yn&&(st=!0);continue}else ot={lane:0,revertLane:W.revertLane,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(D=F=ot,L=S):F=F.next=ot,Rt.lanes|=Z,Ns|=Z;ot=W.action,yn&&u(S,ot),S=W.hasEagerState?W.eagerState:u(S,ot)}else Z={lane:ot,revertLane:W.revertLane,gesture:W.gesture,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(D=F=Z,L=S):F=F.next=Z,Rt.lanes|=ot,Ns|=ot;W=W.next}while(W!==null&&W!==r);if(F===null?L=S:F.next=D,!ii(S,s.memoizedState)&&(ye=!0,st&&(u=Xn,u!==null)))throw u;s.memoizedState=S,s.baseState=L,s.baseQueue=F,h.lastRenderedState=S}return y===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function tc(s){var r=me(),u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var h=u.dispatch,y=u.pending,S=r.memoizedState;if(y!==null){u.pending=null;var L=y=y.next;do S=s(S,L.action),L=L.next;while(L!==y);ii(S,r.memoizedState)||(ye=!0),r.memoizedState=S,r.baseQueue===null&&(r.baseState=S),u.lastRenderedState=S}return[S,h]}function am(s,r,u){var h=Rt,y=me(),S=Bt;if(S){if(u===void 0)throw Error(i(407));u=u()}else u=r();var L=!ii((Kt||y).memoizedState,u);if(L&&(y.memoizedState=u,ye=!0),y=y.queue,sc(um.bind(null,h,y,s),[s]),y.getSnapshot!==r||L||ge!==null&&ge.memoizedState.tag&1){if(h.flags|=2048,er(9,{destroy:void 0},om.bind(null,h,y,u,r),null),Qt===null)throw Error(i(349));S||(ns&127)!==0||lm(h,r,u)}return u}function lm(s,r,u){s.flags|=16384,s={getSnapshot:r,value:u},r=Rt.updateQueue,r===null?(r=El(),Rt.updateQueue=r,r.stores=[s]):(u=r.stores,u===null?r.stores=[s]:u.push(s))}function om(s,r,u,h){r.value=u,r.getSnapshot=h,cm(r)&&fm(s)}function um(s,r,u){return u(function(){cm(r)&&fm(s)})}function cm(s){var r=s.getSnapshot;s=s.value;try{var u=r();return!ii(s,u)}catch{return!0}}function fm(s){var r=on(s,2);r!==null&&Je(r,s,2)}function ec(s){var r=He();if(typeof s=="function"){var u=s;if(s=u(),yn){Oi(!0);try{u()}finally{Oi(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:s},r}function dm(s,r,u,h){return s.baseState=u,Ju(s,Kt,typeof h=="function"?h:rs)}function TS(s,r,u,h,y){if(Al(s))throw Error(i(485));if(s=r.action,s!==null){var S={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){S.listeners.push(L)}};O.T!==null?u(!0):S.isTransition=!1,h(S),u=r.pending,u===null?(S.next=r.pending=S,hm(r,S)):(S.next=u.next,r.pending=u.next=S)}}function hm(s,r){var u=r.action,h=r.payload,y=s.state;if(r.isTransition){var S=O.T,L={};O.T=L;try{var D=u(y,h),F=O.S;F!==null&&F(L,D),mm(s,r,D)}catch(W){ic(s,r,W)}finally{S!==null&&L.types!==null&&(S.types=L.types),O.T=S}}else try{S=u(y,h),mm(s,r,S)}catch(W){ic(s,r,W)}}function mm(s,r,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){pm(s,r,h)},function(h){return ic(s,r,h)}):pm(s,r,u)}function pm(s,r,u){r.status="fulfilled",r.value=u,gm(r),s.state=u,r=s.pending,r!==null&&(u=r.next,u===r?s.pending=null:(u=u.next,r.next=u,hm(s,u)))}function ic(s,r,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do r.status="rejected",r.reason=u,gm(r),r=r.next;while(r!==h)}s.action=null}function gm(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function ym(s,r){return r}function vm(s,r){if(Bt){var u=Qt.formState;if(u!==null){t:{var h=Rt;if(Bt){if(Jt){e:{for(var y=Jt,S=Ti;y.nodeType!==8;){if(!S){y=null;break e}if(y=bi(y.nextSibling),y===null){y=null;break e}}S=y.data,y=S==="F!"||S==="F"?y:null}if(y){Jt=bi(y.nextSibling),h=y.data==="F!";break t}}_s(h)}h=!1}h&&(r=u[0])}}return u=He(),u.memoizedState=u.baseState=r,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ym,lastRenderedState:r},u.queue=h,u=Bm.bind(null,Rt,h),h.dispatch=u,h=ec(!1),S=oc.bind(null,Rt,!1,h.queue),h=He(),y={state:r,dispatch:null,action:s,pending:null},h.queue=y,u=TS.bind(null,Rt,y,S,u),y.dispatch=u,h.memoizedState=s,[r,u,!1]}function Em(s){var r=me();return Sm(r,Kt,s)}function Sm(s,r,u){if(r=Ju(s,r,ym)[0],s=Tl(rs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var h=ea(r)}catch(L){throw L===Qn?fl:L}else h=r;r=me();var y=r.queue,S=y.dispatch;return u!==r.memoizedState&&(Rt.flags|=2048,er(9,{destroy:void 0},xS.bind(null,y,u),null)),[h,S,s]}function xS(s,r){s.action=r}function Tm(s){var r=me(),u=Kt;if(u!==null)return Sm(r,u,s);me(),r=r.memoizedState,u=me();var h=u.queue.dispatch;return u.memoizedState=s,[r,h,!1]}function er(s,r,u,h){return s={tag:s,create:u,deps:h,inst:r,next:null},r=Rt.updateQueue,r===null&&(r=El(),Rt.updateQueue=r),u=r.lastEffect,u===null?r.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,r.lastEffect=s),s}function xm(){return me().memoizedState}function xl(s,r,u,h){var y=He();Rt.flags|=s,y.memoizedState=er(1|r,{destroy:void 0},u,h===void 0?null:h)}function bl(s,r,u,h){var y=me();h=h===void 0?null:h;var S=y.memoizedState.inst;Kt!==null&&h!==null&&qu(h,Kt.memoizedState.deps)?y.memoizedState=er(r,S,u,h):(Rt.flags|=s,y.memoizedState=er(1|r,S,u,h))}function bm(s,r){xl(8390656,8,s,r)}function sc(s,r){bl(2048,8,s,r)}function bS(s){Rt.flags|=4;var r=Rt.updateQueue;if(r===null)r=El(),Rt.updateQueue=r,r.events=[s];else{var u=r.events;u===null?r.events=[s]:u.push(s)}}function Am(s){var r=me().memoizedState;return bS({ref:r,nextImpl:s}),function(){if((jt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Lm(s,r){return bl(4,2,s,r)}function Rm(s,r){return bl(4,4,s,r)}function _m(s,r){if(typeof r=="function"){s=s();var u=r(s);return function(){typeof u=="function"?u():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Im(s,r,u){u=u!=null?u.concat([s]):null,bl(4,4,_m.bind(null,r,s),u)}function nc(){}function Dm(s,r){var u=me();r=r===void 0?null:r;var h=u.memoizedState;return r!==null&&qu(r,h[1])?h[0]:(u.memoizedState=[s,r],s)}function Cm(s,r){var u=me();r=r===void 0?null:r;var h=u.memoizedState;if(r!==null&&qu(r,h[1]))return h[0];if(h=s(),yn){Oi(!0);try{s()}finally{Oi(!1)}}return u.memoizedState=[h,r],h}function rc(s,r,u){return u===void 0||(ns&1073741824)!==0&&(Pt&261930)===0?s.memoizedState=r:(s.memoizedState=u,s=wp(),Rt.lanes|=s,Ns|=s,u)}function wm(s,r,u,h){return ii(u,r)?u:Zn.current!==null?(s=rc(s,u,h),ii(s,r)||(ye=!0),s):(ns&42)===0||(ns&1073741824)!==0&&(Pt&261930)===0?(ye=!0,s.memoizedState=u):(s=wp(),Rt.lanes|=s,Ns|=s,r)}function km(s,r,u,h,y){var S=j.p;j.p=S!==0&&8>S?S:8;var L=O.T,D={};O.T=D,oc(s,!1,r,u);try{var F=y(),W=O.S;if(W!==null&&W(D,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var st=vS(F,h);ia(s,r,st,oi(s))}else ia(s,r,h,oi(s))}catch(ot){ia(s,r,{then:function(){},status:"rejected",reason:ot},oi())}finally{j.p=S,L!==null&&D.types!==null&&(L.types=D.types),O.T=L}}function AS(){}function ac(s,r,u,h){if(s.tag!==5)throw Error(i(476));var y=Om(s).queue;km(s,y,r,X,u===null?AS:function(){return Mm(s),u(h)})}function Om(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:X},next:null};var u={};return r.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:u},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Mm(s){var r=Om(s);r.next===null&&(r=s.alternate.memoizedState),ia(s,r.next.queue,{},oi())}function lc(){return ke(Ea)}function Pm(){return me().memoizedState}function Nm(){return me().memoizedState}function LS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var u=oi();s=Cs(u);var h=ws(r,s,u);h!==null&&(Je(h,r,u),Wr(h,r,u)),r={cache:Nu()},s.payload=r;return}r=r.return}}function RS(s,r,u){var h=oi();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Al(s)?Fm(r,u):(u=Lu(s,r,u,h),u!==null&&(Je(u,s,h),Um(u,r,h)))}function Bm(s,r,u){var h=oi();ia(s,r,u,h)}function ia(s,r,u,h){var y={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Al(s))Fm(r,y);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=r.lastRenderedReducer,S!==null))try{var L=r.lastRenderedState,D=S(L,u);if(y.hasEagerState=!0,y.eagerState=D,ii(D,L))return nl(s,r,y,0),Qt===null&&sl(),!1}catch{}finally{}if(u=Lu(s,r,y,h),u!==null)return Je(u,s,h),Um(u,r,h),!0}return!1}function oc(s,r,u,h){if(h={lane:2,revertLane:$c(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Al(s)){if(r)throw Error(i(479))}else r=Lu(s,u,h,2),r!==null&&Je(r,s,2)}function Al(s){var r=s.alternate;return s===Rt||r!==null&&r===Rt}function Fm(s,r){Jn=yl=!0;var u=s.pending;u===null?r.next=r:(r.next=u.next,u.next=r),s.pending=r}function Um(s,r,u){if((u&4194048)!==0){var h=r.lanes;h&=s.pendingLanes,u|=h,r.lanes=u,zd(s,u)}}var sa={readContext:ke,use:Sl,useCallback:ue,useContext:ue,useEffect:ue,useImperativeHandle:ue,useLayoutEffect:ue,useInsertionEffect:ue,useMemo:ue,useReducer:ue,useRef:ue,useState:ue,useDebugValue:ue,useDeferredValue:ue,useTransition:ue,useSyncExternalStore:ue,useId:ue,useHostTransitionStatus:ue,useFormState:ue,useActionState:ue,useOptimistic:ue,useMemoCache:ue,useCacheRefresh:ue};sa.useEffectEvent=ue;var $m={readContext:ke,use:Sl,useCallback:function(s,r){return He().memoizedState=[s,r===void 0?null:r],s},useContext:ke,useEffect:bm,useImperativeHandle:function(s,r,u){u=u!=null?u.concat([s]):null,xl(4194308,4,_m.bind(null,r,s),u)},useLayoutEffect:function(s,r){return xl(4194308,4,s,r)},useInsertionEffect:function(s,r){xl(4,2,s,r)},useMemo:function(s,r){var u=He();r=r===void 0?null:r;var h=s();if(yn){Oi(!0);try{s()}finally{Oi(!1)}}return u.memoizedState=[h,r],h},useReducer:function(s,r,u){var h=He();if(u!==void 0){var y=u(r);if(yn){Oi(!0);try{u(r)}finally{Oi(!1)}}}else y=r;return h.memoizedState=h.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},h.queue=s,s=s.dispatch=RS.bind(null,Rt,s),[h.memoizedState,s]},useRef:function(s){var r=He();return s={current:s},r.memoizedState=s},useState:function(s){s=ec(s);var r=s.queue,u=Bm.bind(null,Rt,r);return r.dispatch=u,[s.memoizedState,u]},useDebugValue:nc,useDeferredValue:function(s,r){var u=He();return rc(u,s,r)},useTransition:function(){var s=ec(!1);return s=km.bind(null,Rt,s.queue,!0,!1),He().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,u){var h=Rt,y=He();if(Bt){if(u===void 0)throw Error(i(407));u=u()}else{if(u=r(),Qt===null)throw Error(i(349));(Pt&127)!==0||lm(h,r,u)}y.memoizedState=u;var S={value:u,getSnapshot:r};return y.queue=S,bm(um.bind(null,h,S,s),[s]),h.flags|=2048,er(9,{destroy:void 0},om.bind(null,h,S,u,r),null),u},useId:function(){var s=He(),r=Qt.identifierPrefix;if(Bt){var u=Pi,h=Mi;u=(h&~(1<<32-Ge(h)-1)).toString(32)+u,r="_"+r+"R_"+u,u=vl++,0<u&&(r+="H"+u.toString(32)),r+="_"}else u=ES++,r="_"+r+"r_"+u.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:lc,useFormState:vm,useActionState:vm,useOptimistic:function(s){var r=He();r.memoizedState=r.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=u,r=oc.bind(null,Rt,!0,u),u.dispatch=r,[s,r]},useMemoCache:Zu,useCacheRefresh:function(){return He().memoizedState=LS.bind(null,Rt)},useEffectEvent:function(s){var r=He(),u={impl:s};return r.memoizedState=u,function(){if((jt&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},uc={readContext:ke,use:Sl,useCallback:Dm,useContext:ke,useEffect:sc,useImperativeHandle:Im,useInsertionEffect:Lm,useLayoutEffect:Rm,useMemo:Cm,useReducer:Tl,useRef:xm,useState:function(){return Tl(rs)},useDebugValue:nc,useDeferredValue:function(s,r){var u=me();return wm(u,Kt.memoizedState,s,r)},useTransition:function(){var s=Tl(rs)[0],r=me().memoizedState;return[typeof s=="boolean"?s:ea(s),r]},useSyncExternalStore:am,useId:Pm,useHostTransitionStatus:lc,useFormState:Em,useActionState:Em,useOptimistic:function(s,r){var u=me();return dm(u,Kt,s,r)},useMemoCache:Zu,useCacheRefresh:Nm};uc.useEffectEvent=Am;var jm={readContext:ke,use:Sl,useCallback:Dm,useContext:ke,useEffect:sc,useImperativeHandle:Im,useInsertionEffect:Lm,useLayoutEffect:Rm,useMemo:Cm,useReducer:tc,useRef:xm,useState:function(){return tc(rs)},useDebugValue:nc,useDeferredValue:function(s,r){var u=me();return Kt===null?rc(u,s,r):wm(u,Kt.memoizedState,s,r)},useTransition:function(){var s=tc(rs)[0],r=me().memoizedState;return[typeof s=="boolean"?s:ea(s),r]},useSyncExternalStore:am,useId:Pm,useHostTransitionStatus:lc,useFormState:Tm,useActionState:Tm,useOptimistic:function(s,r){var u=me();return Kt!==null?dm(u,Kt,s,r):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:Zu,useCacheRefresh:Nm};jm.useEffectEvent=Am;function cc(s,r,u,h){r=s.memoizedState,u=u(h,r),u=u==null?r:p({},r,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var fc={enqueueSetState:function(s,r,u){s=s._reactInternals;var h=oi(),y=Cs(h);y.payload=r,u!=null&&(y.callback=u),r=ws(s,y,h),r!==null&&(Je(r,s,h),Wr(r,s,h))},enqueueReplaceState:function(s,r,u){s=s._reactInternals;var h=oi(),y=Cs(h);y.tag=1,y.payload=r,u!=null&&(y.callback=u),r=ws(s,y,h),r!==null&&(Je(r,s,h),Wr(r,s,h))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var u=oi(),h=Cs(u);h.tag=2,r!=null&&(h.callback=r),r=ws(s,h,u),r!==null&&(Je(r,s,u),Wr(r,s,u))}};function Gm(s,r,u,h,y,S,L){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,S,L):r.prototype&&r.prototype.isPureReactComponent?!Hr(u,h)||!Hr(y,S):!0}function Hm(s,r,u,h){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(u,h),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(u,h),r.state!==s&&fc.enqueueReplaceState(r,r.state,null)}function vn(s,r){var u=r;if("ref"in r){u={};for(var h in r)h!=="ref"&&(u[h]=r[h])}if(s=s.defaultProps){u===r&&(u=p({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}function zm(s){il(s)}function Vm(s){console.error(s)}function Km(s){il(s)}function Ll(s,r){try{var u=s.onUncaughtError;u(r.value,{componentStack:r.stack})}catch(h){setTimeout(function(){throw h})}}function qm(s,r,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function dc(s,r,u){return u=Cs(u),u.tag=3,u.payload={element:null},u.callback=function(){Ll(s,r)},u}function Ym(s){return s=Cs(s),s.tag=3,s}function Xm(s,r,u,h){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var S=h.value;s.payload=function(){return y(S)},s.callback=function(){qm(r,u,h)}}var L=u.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(s.callback=function(){qm(r,u,h),typeof y!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})})}function _S(s,r,u,h,y){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(r=u.alternate,r!==null&&qn(r,u,y,!0),u=ni.current,u!==null){switch(u.tag){case 31:case 13:return xi===null?Bl():u.alternate===null&&ce===0&&(ce=3),u.flags&=-257,u.flags|=65536,u.lanes=y,h===dl?u.flags|=16384:(r=u.updateQueue,r===null?u.updateQueue=new Set([h]):r.add(h),Bc(s,h,y)),!1;case 22:return u.flags|=65536,h===dl?u.flags|=16384:(r=u.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=r):(u=r.retryQueue,u===null?r.retryQueue=new Set([h]):u.add(h)),Bc(s,h,y)),!1}throw Error(i(435,u.tag))}return Bc(s,h,y),Bl(),!1}if(Bt)return r=ni.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=y,h!==wu&&(s=Error(i(422),{cause:h}),Kr(vi(s,u)))):(h!==wu&&(r=Error(i(423),{cause:h}),Kr(vi(r,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,h=vi(h,u),y=dc(s.stateNode,h,y),Gu(s,y),ce!==4&&(ce=2)),!1;var S=Error(i(520),{cause:h});if(S=vi(S,u),fa===null?fa=[S]:fa.push(S),ce!==4&&(ce=2),r===null)return!0;h=vi(h,u),u=r;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=dc(u.stateNode,h,s),Gu(u,s),!1;case 1:if(r=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Bs===null||!Bs.has(S))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Ym(y),Xm(y,s,u,h),Gu(u,y),!1}u=u.return}while(u!==null);return!1}var hc=Error(i(461)),ye=!1;function Oe(s,r,u,h){r.child=s===null?Jh(r,null,u,h):gn(r,s.child,u,h)}function Qm(s,r,u,h,y){u=u.render;var S=r.ref;if("ref"in h){var L={};for(var D in h)D!=="ref"&&(L[D]=h[D])}else L=h;return dn(r),h=Yu(s,r,u,L,S,y),D=Xu(),s!==null&&!ye?(Qu(s,r,y),as(s,r,y)):(Bt&&D&&Du(r),r.flags|=1,Oe(s,r,h,y),r.child)}function Wm(s,r,u,h,y){if(s===null){var S=u.type;return typeof S=="function"&&!Ru(S)&&S.defaultProps===void 0&&u.compare===null?(r.tag=15,r.type=S,Zm(s,r,S,h,y)):(s=al(u.type,null,h,r,r.mode,y),s.ref=r.ref,s.return=r,r.child=s)}if(S=s.child,!Tc(s,y)){var L=S.memoizedProps;if(u=u.compare,u=u!==null?u:Hr,u(L,h)&&s.ref===r.ref)return as(s,r,y)}return r.flags|=1,s=ts(S,h),s.ref=r.ref,s.return=r,r.child=s}function Zm(s,r,u,h,y){if(s!==null){var S=s.memoizedProps;if(Hr(S,h)&&s.ref===r.ref)if(ye=!1,r.pendingProps=h=S,Tc(s,y))(s.flags&131072)!==0&&(ye=!0);else return r.lanes=s.lanes,as(s,r,y)}return mc(s,r,u,h,y)}function Jm(s,r,u,h){var y=h.children,S=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((r.flags&128)!==0){if(S=S!==null?S.baseLanes|u:u,s!==null){for(h=r.child=s.child,y=0;h!==null;)y=y|h.lanes|h.childLanes,h=h.sibling;h=y&~S}else h=0,r.child=null;return tp(s,r,S,u,h)}if((u&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&cl(r,S!==null?S.cachePool:null),S!==null?im(r,S):zu(),sm(r);else return h=r.lanes=536870912,tp(s,r,S!==null?S.baseLanes|u:u,u,h)}else S!==null?(cl(r,S.cachePool),im(r,S),Os(),r.memoizedState=null):(s!==null&&cl(r,null),zu(),Os());return Oe(s,r,y,u),r.child}function na(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function tp(s,r,u,h,y){var S=Fu();return S=S===null?null:{parent:pe._currentValue,pool:S},r.memoizedState={baseLanes:u,cachePool:S},s!==null&&cl(r,null),zu(),sm(r),s!==null&&qn(s,r,h,!0),r.childLanes=y,null}function Rl(s,r){return r=Il({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function ep(s,r,u){return gn(r,s.child,null,u),s=Rl(r,r.pendingProps),s.flags|=2,ri(r),r.memoizedState=null,s}function IS(s,r,u){var h=r.pendingProps,y=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Bt){if(h.mode==="hidden")return s=Rl(r,h),r.lanes=536870912,na(null,s);if(Ku(r),(s=Jt)?(s=hg(s,Ti),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ls!==null?{id:Mi,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},u=Fh(s),u.return=r,r.child=u,we=r,Jt=null)):s=null,s===null)throw _s(r);return r.lanes=536870912,null}return Rl(r,h)}var S=s.memoizedState;if(S!==null){var L=S.dehydrated;if(Ku(r),y)if(r.flags&256)r.flags&=-257,r=ep(s,r,u);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(ye||qn(s,r,u,!1),y=(u&s.childLanes)!==0,ye||y){if(h=Qt,h!==null&&(L=Vd(h,u),L!==0&&L!==S.retryLane))throw S.retryLane=L,on(s,L),Je(h,s,L),hc;Bl(),r=ep(s,r,u)}else s=S.treeContext,Jt=bi(L.nextSibling),we=r,Bt=!0,Rs=null,Ti=!1,s!==null&&jh(r,s),r=Rl(r,h),r.flags|=4096;return r}return s=ts(s.child,{mode:h.mode,children:h.children}),s.ref=r.ref,r.child=s,s.return=r,s}function _l(s,r){var u=r.ref;if(u===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(r.flags|=4194816)}}function mc(s,r,u,h,y){return dn(r),u=Yu(s,r,u,h,void 0,y),h=Xu(),s!==null&&!ye?(Qu(s,r,y),as(s,r,y)):(Bt&&h&&Du(r),r.flags|=1,Oe(s,r,u,y),r.child)}function ip(s,r,u,h,y,S){return dn(r),r.updateQueue=null,u=rm(r,h,u,y),nm(s),h=Xu(),s!==null&&!ye?(Qu(s,r,S),as(s,r,S)):(Bt&&h&&Du(r),r.flags|=1,Oe(s,r,u,S),r.child)}function sp(s,r,u,h,y){if(dn(r),r.stateNode===null){var S=Hn,L=u.contextType;typeof L=="object"&&L!==null&&(S=ke(L)),S=new u(h,S),r.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=fc,r.stateNode=S,S._reactInternals=r,S=r.stateNode,S.props=h,S.state=r.memoizedState,S.refs={},$u(r),L=u.contextType,S.context=typeof L=="object"&&L!==null?ke(L):Hn,S.state=r.memoizedState,L=u.getDerivedStateFromProps,typeof L=="function"&&(cc(r,u,L,h),S.state=r.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(L=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),L!==S.state&&fc.enqueueReplaceState(S,S.state,null),Jr(r,h,S,y),Zr(),S.state=r.memoizedState),typeof S.componentDidMount=="function"&&(r.flags|=4194308),h=!0}else if(s===null){S=r.stateNode;var D=r.memoizedProps,F=vn(u,D);S.props=F;var W=S.context,st=u.contextType;L=Hn,typeof st=="object"&&st!==null&&(L=ke(st));var ot=u.getDerivedStateFromProps;st=typeof ot=="function"||typeof S.getSnapshotBeforeUpdate=="function",D=r.pendingProps!==D,st||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D||W!==L)&&Hm(r,S,h,L),Ds=!1;var Z=r.memoizedState;S.state=Z,Jr(r,h,S,y),Zr(),W=r.memoizedState,D||Z!==W||Ds?(typeof ot=="function"&&(cc(r,u,ot,h),W=r.memoizedState),(F=Ds||Gm(r,u,F,h,Z,W,L))?(st||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=h,r.memoizedState=W),S.props=h,S.state=W,S.context=L,h=F):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),h=!1)}else{S=r.stateNode,ju(s,r),L=r.memoizedProps,st=vn(u,L),S.props=st,ot=r.pendingProps,Z=S.context,W=u.contextType,F=Hn,typeof W=="object"&&W!==null&&(F=ke(W)),D=u.getDerivedStateFromProps,(W=typeof D=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(L!==ot||Z!==F)&&Hm(r,S,h,F),Ds=!1,Z=r.memoizedState,S.state=Z,Jr(r,h,S,y),Zr();var et=r.memoizedState;L!==ot||Z!==et||Ds||s!==null&&s.dependencies!==null&&ol(s.dependencies)?(typeof D=="function"&&(cc(r,u,D,h),et=r.memoizedState),(st=Ds||Gm(r,u,st,h,Z,et,F)||s!==null&&s.dependencies!==null&&ol(s.dependencies))?(W||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,et,F),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,et,F)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||L===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||L===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),r.memoizedProps=h,r.memoizedState=et),S.props=h,S.state=et,S.context=F,h=st):(typeof S.componentDidUpdate!="function"||L===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||L===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),h=!1)}return S=h,_l(s,r),h=(r.flags&128)!==0,S||h?(S=r.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:S.render(),r.flags|=1,s!==null&&h?(r.child=gn(r,s.child,null,y),r.child=gn(r,null,u,y)):Oe(s,r,u,y),r.memoizedState=S.state,s=r.child):s=as(s,r,y),s}function np(s,r,u,h){return cn(),r.flags|=256,Oe(s,r,u,h),r.child}var pc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gc(s){return{baseLanes:s,cachePool:qh()}}function yc(s,r,u){return s=s!==null?s.childLanes&~u:0,r&&(s|=li),s}function rp(s,r,u){var h=r.pendingProps,y=!1,S=(r.flags&128)!==0,L;if((L=S)||(L=s!==null&&s.memoizedState===null?!1:(he.current&2)!==0),L&&(y=!0,r.flags&=-129),L=(r.flags&32)!==0,r.flags&=-33,s===null){if(Bt){if(y?ks(r):Os(),(s=Jt)?(s=hg(s,Ti),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ls!==null?{id:Mi,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},u=Fh(s),u.return=r,r.child=u,we=r,Jt=null)):s=null,s===null)throw _s(r);return Jc(s)?r.lanes=32:r.lanes=536870912,null}var D=h.children;return h=h.fallback,y?(Os(),y=r.mode,D=Il({mode:"hidden",children:D},y),h=un(h,y,u,null),D.return=r,h.return=r,D.sibling=h,r.child=D,h=r.child,h.memoizedState=gc(u),h.childLanes=yc(s,L,u),r.memoizedState=pc,na(null,h)):(ks(r),vc(r,D))}var F=s.memoizedState;if(F!==null&&(D=F.dehydrated,D!==null)){if(S)r.flags&256?(ks(r),r.flags&=-257,r=Ec(s,r,u)):r.memoizedState!==null?(Os(),r.child=s.child,r.flags|=128,r=null):(Os(),D=h.fallback,y=r.mode,h=Il({mode:"visible",children:h.children},y),D=un(D,y,u,null),D.flags|=2,h.return=r,D.return=r,h.sibling=D,r.child=h,gn(r,s.child,null,u),h=r.child,h.memoizedState=gc(u),h.childLanes=yc(s,L,u),r.memoizedState=pc,r=na(null,h));else if(ks(r),Jc(D)){if(L=D.nextSibling&&D.nextSibling.dataset,L)var W=L.dgst;L=W,h=Error(i(419)),h.stack="",h.digest=L,Kr({value:h,source:null,stack:null}),r=Ec(s,r,u)}else if(ye||qn(s,r,u,!1),L=(u&s.childLanes)!==0,ye||L){if(L=Qt,L!==null&&(h=Vd(L,u),h!==0&&h!==F.retryLane))throw F.retryLane=h,on(s,h),Je(L,s,h),hc;Zc(D)||Bl(),r=Ec(s,r,u)}else Zc(D)?(r.flags|=192,r.child=s.child,r=null):(s=F.treeContext,Jt=bi(D.nextSibling),we=r,Bt=!0,Rs=null,Ti=!1,s!==null&&jh(r,s),r=vc(r,h.children),r.flags|=4096);return r}return y?(Os(),D=h.fallback,y=r.mode,F=s.child,W=F.sibling,h=ts(F,{mode:"hidden",children:h.children}),h.subtreeFlags=F.subtreeFlags&65011712,W!==null?D=ts(W,D):(D=un(D,y,u,null),D.flags|=2),D.return=r,h.return=r,h.sibling=D,r.child=h,na(null,h),h=r.child,D=s.child.memoizedState,D===null?D=gc(u):(y=D.cachePool,y!==null?(F=pe._currentValue,y=y.parent!==F?{parent:F,pool:F}:y):y=qh(),D={baseLanes:D.baseLanes|u,cachePool:y}),h.memoizedState=D,h.childLanes=yc(s,L,u),r.memoizedState=pc,na(s.child,h)):(ks(r),u=s.child,s=u.sibling,u=ts(u,{mode:"visible",children:h.children}),u.return=r,u.sibling=null,s!==null&&(L=r.deletions,L===null?(r.deletions=[s],r.flags|=16):L.push(s)),r.child=u,r.memoizedState=null,u)}function vc(s,r){return r=Il({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Il(s,r){return s=si(22,s,null,r),s.lanes=0,s}function Ec(s,r,u){return gn(r,s.child,null,u),s=vc(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function ap(s,r,u){s.lanes|=r;var h=s.alternate;h!==null&&(h.lanes|=r),Mu(s.return,r,u)}function Sc(s,r,u,h,y,S){var L=s.memoizedState;L===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:y,treeForkCount:S}:(L.isBackwards=r,L.rendering=null,L.renderingStartTime=0,L.last=h,L.tail=u,L.tailMode=y,L.treeForkCount=S)}function lp(s,r,u){var h=r.pendingProps,y=h.revealOrder,S=h.tail;h=h.children;var L=he.current,D=(L&2)!==0;if(D?(L=L&1|2,r.flags|=128):L&=1,it(he,L),Oe(s,r,h,u),h=Bt?Vr:0,!D&&s!==null&&(s.flags&128)!==0)t:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ap(s,u,r);else if(s.tag===19)ap(s,u,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break t;for(;s.sibling===null;){if(s.return===null||s.return===r)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(u=r.child,y=null;u!==null;)s=u.alternate,s!==null&&gl(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=r.child,r.child=null):(y=u.sibling,u.sibling=null),Sc(r,!1,y,u,S,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=r.child,r.child=null;y!==null;){if(s=y.alternate,s!==null&&gl(s)===null){r.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}Sc(r,!0,u,null,S,h);break;case"together":Sc(r,!1,null,null,void 0,h);break;default:r.memoizedState=null}return r.child}function as(s,r,u){if(s!==null&&(r.dependencies=s.dependencies),Ns|=r.lanes,(u&r.childLanes)===0)if(s!==null){if(qn(s,r,u,!1),(u&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,u=ts(s,s.pendingProps),r.child=u,u.return=r;s.sibling!==null;)s=s.sibling,u=u.sibling=ts(s,s.pendingProps),u.return=r;u.sibling=null}return r.child}function Tc(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&ol(s)))}function DS(s,r,u){switch(r.tag){case 3:Dt(r,r.stateNode.containerInfo),Is(r,pe,s.memoizedState.cache),cn();break;case 27:case 5:ae(r);break;case 4:Dt(r,r.stateNode.containerInfo);break;case 10:Is(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Ku(r),null;break;case 13:var h=r.memoizedState;if(h!==null)return h.dehydrated!==null?(ks(r),r.flags|=128,null):(u&r.child.childLanes)!==0?rp(s,r,u):(ks(r),s=as(s,r,u),s!==null?s.sibling:null);ks(r);break;case 19:var y=(s.flags&128)!==0;if(h=(u&r.childLanes)!==0,h||(qn(s,r,u,!1),h=(u&r.childLanes)!==0),y){if(h)return lp(s,r,u);r.flags|=128}if(y=r.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),it(he,he.current),h)break;return null;case 22:return r.lanes=0,Jm(s,r,u,r.pendingProps);case 24:Is(r,pe,s.memoizedState.cache)}return as(s,r,u)}function op(s,r,u){if(s!==null)if(s.memoizedProps!==r.pendingProps)ye=!0;else{if(!Tc(s,u)&&(r.flags&128)===0)return ye=!1,DS(s,r,u);ye=(s.flags&131072)!==0}else ye=!1,Bt&&(r.flags&1048576)!==0&&$h(r,Vr,r.index);switch(r.lanes=0,r.tag){case 16:t:{var h=r.pendingProps;if(s=mn(r.elementType),r.type=s,typeof s=="function")Ru(s)?(h=vn(s,h),r.tag=1,r=sp(null,r,s,h,u)):(r.tag=0,r=mc(null,r,s,h,u));else{if(s!=null){var y=s.$$typeof;if(y===I){r.tag=11,r=Qm(null,r,s,h,u);break t}else if(y===w){r.tag=14,r=Wm(null,r,s,h,u);break t}}throw r=G(s)||s,Error(i(306,r,""))}}return r;case 0:return mc(s,r,r.type,r.pendingProps,u);case 1:return h=r.type,y=vn(h,r.pendingProps),sp(s,r,h,y,u);case 3:t:{if(Dt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));h=r.pendingProps;var S=r.memoizedState;y=S.element,ju(s,r),Jr(r,h,null,u);var L=r.memoizedState;if(h=L.cache,Is(r,pe,h),h!==S.cache&&Pu(r,[pe],u,!0),Zr(),h=L.element,S.isDehydrated)if(S={element:h,isDehydrated:!1,cache:L.cache},r.updateQueue.baseState=S,r.memoizedState=S,r.flags&256){r=np(s,r,h,u);break t}else if(h!==y){y=vi(Error(i(424)),r),Kr(y),r=np(s,r,h,u);break t}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Jt=bi(s.firstChild),we=r,Bt=!0,Rs=null,Ti=!0,u=Jh(r,null,h,u),r.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(cn(),h===y){r=as(s,r,u);break t}Oe(s,r,h,u)}r=r.child}return r;case 26:return _l(s,r),s===null?(u=Eg(r.type,null,r.pendingProps,null))?r.memoizedState=u:Bt||(u=r.type,s=r.pendingProps,h=zl(dt.current).createElement(u),h[Ce]=r,h[qe]=s,Me(h,u,s),Re(h),r.stateNode=h):r.memoizedState=Eg(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return ae(r),s===null&&Bt&&(h=r.stateNode=gg(r.type,r.pendingProps,dt.current),we=r,Ti=!0,y=Jt,js(r.type)?(tf=y,Jt=bi(h.firstChild)):Jt=y),Oe(s,r,r.pendingProps.children,u),_l(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Bt&&((y=h=Jt)&&(h=rT(h,r.type,r.pendingProps,Ti),h!==null?(r.stateNode=h,we=r,Jt=bi(h.firstChild),Ti=!1,y=!0):y=!1),y||_s(r)),ae(r),y=r.type,S=r.pendingProps,L=s!==null?s.memoizedProps:null,h=S.children,Xc(y,S)?h=null:L!==null&&Xc(y,L)&&(r.flags|=32),r.memoizedState!==null&&(y=Yu(s,r,SS,null,null,u),Ea._currentValue=y),_l(s,r),Oe(s,r,h,u),r.child;case 6:return s===null&&Bt&&((s=u=Jt)&&(u=aT(u,r.pendingProps,Ti),u!==null?(r.stateNode=u,we=r,Jt=null,s=!0):s=!1),s||_s(r)),null;case 13:return rp(s,r,u);case 4:return Dt(r,r.stateNode.containerInfo),h=r.pendingProps,s===null?r.child=gn(r,null,h,u):Oe(s,r,h,u),r.child;case 11:return Qm(s,r,r.type,r.pendingProps,u);case 7:return Oe(s,r,r.pendingProps,u),r.child;case 8:return Oe(s,r,r.pendingProps.children,u),r.child;case 12:return Oe(s,r,r.pendingProps.children,u),r.child;case 10:return h=r.pendingProps,Is(r,r.type,h.value),Oe(s,r,h.children,u),r.child;case 9:return y=r.type._context,h=r.pendingProps.children,dn(r),y=ke(y),h=h(y),r.flags|=1,Oe(s,r,h,u),r.child;case 14:return Wm(s,r,r.type,r.pendingProps,u);case 15:return Zm(s,r,r.type,r.pendingProps,u);case 19:return lp(s,r,u);case 31:return IS(s,r,u);case 22:return Jm(s,r,u,r.pendingProps);case 24:return dn(r),h=ke(pe),s===null?(y=Fu(),y===null&&(y=Qt,S=Nu(),y.pooledCache=S,S.refCount++,S!==null&&(y.pooledCacheLanes|=u),y=S),r.memoizedState={parent:h,cache:y},$u(r),Is(r,pe,y)):((s.lanes&u)!==0&&(ju(s,r),Jr(r,null,null,u),Zr()),y=s.memoizedState,S=r.memoizedState,y.parent!==h?(y={parent:h,cache:h},r.memoizedState=y,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=y),Is(r,pe,h)):(h=S.cache,Is(r,pe,h),h!==y.cache&&Pu(r,[pe],u,!0))),Oe(s,r,r.pendingProps.children,u),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function ls(s){s.flags|=4}function xc(s,r,u,h,y){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(Pp())s.flags|=8192;else throw pn=dl,Uu}else s.flags&=-16777217}function up(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ag(r))if(Pp())s.flags|=8192;else throw pn=dl,Uu}function Dl(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Gd():536870912,s.lanes|=r,rr|=r)}function ra(s,r){if(!Bt)switch(s.tailMode){case"hidden":r=s.tail;for(var u=null;r!==null;)r.alternate!==null&&(u=r),r=r.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function te(s){var r=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(r)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,h|=y.subtreeFlags&65011712,h|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=h,s.childLanes=u,r}function CS(s,r,u){var h=r.pendingProps;switch(Cu(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return te(r),null;case 1:return te(r),null;case 3:return u=r.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),r.memoizedState.cache!==h&&(r.flags|=2048),ss(pe),It(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Kn(r)?ls(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,ku())),te(r),null;case 26:var y=r.type,S=r.memoizedState;return s===null?(ls(r),S!==null?(te(r),up(r,S)):(te(r),xc(r,y,null,h,u))):S?S!==s.memoizedState?(ls(r),te(r),up(r,S)):(te(r),r.flags&=-16777217):(s=s.memoizedProps,s!==h&&ls(r),te(r),xc(r,y,s,h,u)),null;case 27:if(Se(r),u=dt.current,y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==h&&ls(r);else{if(!h){if(r.stateNode===null)throw Error(i(166));return te(r),null}s=ut.current,Kn(r)?Gh(r):(s=gg(y,h,u),r.stateNode=s,ls(r))}return te(r),null;case 5:if(Se(r),y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==h&&ls(r);else{if(!h){if(r.stateNode===null)throw Error(i(166));return te(r),null}if(S=ut.current,Kn(r))Gh(r);else{var L=zl(dt.current);switch(S){case 1:S=L.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:S=L.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":S=L.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":S=L.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":S=L.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof h.is=="string"?L.createElement("select",{is:h.is}):L.createElement("select"),h.multiple?S.multiple=!0:h.size&&(S.size=h.size);break;default:S=typeof h.is=="string"?L.createElement(y,{is:h.is}):L.createElement(y)}}S[Ce]=r,S[qe]=h;t:for(L=r.child;L!==null;){if(L.tag===5||L.tag===6)S.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===r)break t;for(;L.sibling===null;){if(L.return===null||L.return===r)break t;L=L.return}L.sibling.return=L.return,L=L.sibling}r.stateNode=S;t:switch(Me(S,y,h),y){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&ls(r)}}return te(r),xc(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,u),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==h&&ls(r);else{if(typeof h!="string"&&r.stateNode===null)throw Error(i(166));if(s=dt.current,Kn(r)){if(s=r.stateNode,u=r.memoizedProps,h=null,y=we,y!==null)switch(y.tag){case 27:case 5:h=y.memoizedProps}s[Ce]=r,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||rg(s.nodeValue,u)),s||_s(r,!0)}else s=zl(s).createTextNode(h),s[Ce]=r,r.stateNode=s}return te(r),null;case 31:if(u=r.memoizedState,s===null||s.memoizedState!==null){if(h=Kn(r),u!==null){if(s===null){if(!h)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ce]=r}else cn(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;te(r),s=!1}else u=ku(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return r.flags&256?(ri(r),r):(ri(r),null);if((r.flags&128)!==0)throw Error(i(558))}return te(r),null;case 13:if(h=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Kn(r),h!==null&&h.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=r.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Ce]=r}else cn(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;te(r),y=!1}else y=ku(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return r.flags&256?(ri(r),r):(ri(r),null)}return ri(r),(r.flags&128)!==0?(r.lanes=u,r):(u=h!==null,s=s!==null&&s.memoizedState!==null,u&&(h=r.child,y=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(y=h.alternate.memoizedState.cachePool.pool),S=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),S!==y&&(h.flags|=2048)),u!==s&&u&&(r.child.flags|=8192),Dl(r,r.updateQueue),te(r),null);case 4:return It(),s===null&&zc(r.stateNode.containerInfo),te(r),null;case 10:return ss(r.type),te(r),null;case 19:if(U(he),h=r.memoizedState,h===null)return te(r),null;if(y=(r.flags&128)!==0,S=h.rendering,S===null)if(y)ra(h,!1);else{if(ce!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(S=gl(s),S!==null){for(r.flags|=128,ra(h,!1),s=S.updateQueue,r.updateQueue=s,Dl(r,s),r.subtreeFlags=0,s=u,u=r.child;u!==null;)Bh(u,s),u=u.sibling;return it(he,he.current&1|2),Bt&&es(r,h.treeForkCount),r.child}s=s.sibling}h.tail!==null&&ee()>Ml&&(r.flags|=128,y=!0,ra(h,!1),r.lanes=4194304)}else{if(!y)if(s=gl(S),s!==null){if(r.flags|=128,y=!0,s=s.updateQueue,r.updateQueue=s,Dl(r,s),ra(h,!0),h.tail===null&&h.tailMode==="hidden"&&!S.alternate&&!Bt)return te(r),null}else 2*ee()-h.renderingStartTime>Ml&&u!==536870912&&(r.flags|=128,y=!0,ra(h,!1),r.lanes=4194304);h.isBackwards?(S.sibling=r.child,r.child=S):(s=h.last,s!==null?s.sibling=S:r.child=S,h.last=S)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=ee(),s.sibling=null,u=he.current,it(he,y?u&1|2:u&1),Bt&&es(r,h.treeForkCount),s):(te(r),null);case 22:case 23:return ri(r),Vu(),h=r.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(r.flags|=8192):h&&(r.flags|=8192),h?(u&536870912)!==0&&(r.flags&128)===0&&(te(r),r.subtreeFlags&6&&(r.flags|=8192)):te(r),u=r.updateQueue,u!==null&&Dl(r,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),h!==u&&(r.flags|=2048),s!==null&&U(hn),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),ss(pe),te(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function wS(s,r){switch(Cu(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ss(pe),It(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Se(r),null;case 31:if(r.memoizedState!==null){if(ri(r),r.alternate===null)throw Error(i(340));cn()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(ri(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));cn()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return U(he),null;case 4:return It(),null;case 10:return ss(r.type),null;case 22:case 23:return ri(r),Vu(),s!==null&&U(hn),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ss(pe),null;case 25:return null;default:return null}}function cp(s,r){switch(Cu(r),r.tag){case 3:ss(pe),It();break;case 26:case 27:case 5:Se(r);break;case 4:It();break;case 31:r.memoizedState!==null&&ri(r);break;case 13:ri(r);break;case 19:U(he);break;case 10:ss(r.type);break;case 22:case 23:ri(r),Vu(),s!==null&&U(hn);break;case 24:ss(pe)}}function aa(s,r){try{var u=r.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var y=h.next;u=y;do{if((u.tag&s)===s){h=void 0;var S=u.create,L=u.inst;h=S(),L.destroy=h}u=u.next}while(u!==y)}}catch(D){Ht(r,r.return,D)}}function Ms(s,r,u){try{var h=r.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var S=y.next;h=S;do{if((h.tag&s)===s){var L=h.inst,D=L.destroy;if(D!==void 0){L.destroy=void 0,y=r;var F=u,W=D;try{W()}catch(st){Ht(y,F,st)}}}h=h.next}while(h!==S)}}catch(st){Ht(r,r.return,st)}}function fp(s){var r=s.updateQueue;if(r!==null){var u=s.stateNode;try{em(r,u)}catch(h){Ht(s,s.return,h)}}}function dp(s,r,u){u.props=vn(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Ht(s,r,h)}}function la(s,r){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(y){Ht(s,r,y)}}function Ni(s,r){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(y){Ht(s,r,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Ht(s,r,y)}else u.current=null}function hp(s){var r=s.type,u=s.memoizedProps,h=s.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break t;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(y){Ht(s,s.return,y)}}function bc(s,r,u){try{var h=s.stateNode;JS(h,s.type,u,r),h[qe]=r}catch(y){Ht(s,s.return,y)}}function mp(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&js(s.type)||s.tag===4}function Ac(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||mp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&js(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lc(s,r,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,r?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,r):(r=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,r.appendChild(s),u=u._reactRootContainer,u!=null||r.onclick!==null||(r.onclick=Zi));else if(h!==4&&(h===27&&js(s.type)&&(u=s.stateNode,r=null),s=s.child,s!==null))for(Lc(s,r,u),s=s.sibling;s!==null;)Lc(s,r,u),s=s.sibling}function Cl(s,r,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,r?u.insertBefore(s,r):u.appendChild(s);else if(h!==4&&(h===27&&js(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Cl(s,r,u),s=s.sibling;s!==null;)Cl(s,r,u),s=s.sibling}function pp(s){var r=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,y=r.attributes;y.length;)r.removeAttributeNode(y[0]);Me(r,h,u),r[Ce]=s,r[qe]=u}catch(S){Ht(s,s.return,S)}}var os=!1,ve=!1,Rc=!1,gp=typeof WeakSet=="function"?WeakSet:Set,_e=null;function kS(s,r){if(s=s.containerInfo,qc=Wl,s=Ih(s),Eu(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var y=h.anchorOffset,S=h.focusNode;h=h.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break t}var L=0,D=-1,F=-1,W=0,st=0,ot=s,Z=null;e:for(;;){for(var et;ot!==u||y!==0&&ot.nodeType!==3||(D=L+y),ot!==S||h!==0&&ot.nodeType!==3||(F=L+h),ot.nodeType===3&&(L+=ot.nodeValue.length),(et=ot.firstChild)!==null;)Z=ot,ot=et;for(;;){if(ot===s)break e;if(Z===u&&++W===y&&(D=L),Z===S&&++st===h&&(F=L),(et=ot.nextSibling)!==null)break;ot=Z,Z=ot.parentNode}ot=et}u=D===-1||F===-1?null:{start:D,end:F}}else u=null}u=u||{start:0,end:0}}else u=null;for(Yc={focusedElem:s,selectionRange:u},Wl=!1,_e=r;_e!==null;)if(r=_e,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,_e=s;else for(;_e!==null;){switch(r=_e,S=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)y=s[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&S!==null){s=void 0,u=r,y=S.memoizedProps,S=S.memoizedState,h=u.stateNode;try{var gt=vn(u.type,y);s=h.getSnapshotBeforeUpdate(gt,S),h.__reactInternalSnapshotBeforeUpdate=s}catch(Tt){Ht(u,u.return,Tt)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,u=s.nodeType,u===9)Wc(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Wc(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,_e=s;break}_e=r.return}}function yp(s,r,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:cs(s,u),h&4&&aa(5,u);break;case 1:if(cs(s,u),h&4)if(s=u.stateNode,r===null)try{s.componentDidMount()}catch(L){Ht(u,u.return,L)}else{var y=vn(u.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(y,r,s.__reactInternalSnapshotBeforeUpdate)}catch(L){Ht(u,u.return,L)}}h&64&&fp(u),h&512&&la(u,u.return);break;case 3:if(cs(s,u),h&64&&(s=u.updateQueue,s!==null)){if(r=null,u.child!==null)switch(u.child.tag){case 27:case 5:r=u.child.stateNode;break;case 1:r=u.child.stateNode}try{em(s,r)}catch(L){Ht(u,u.return,L)}}break;case 27:r===null&&h&4&&pp(u);case 26:case 5:cs(s,u),r===null&&h&4&&hp(u),h&512&&la(u,u.return);break;case 12:cs(s,u);break;case 31:cs(s,u),h&4&&Sp(s,u);break;case 13:cs(s,u),h&4&&Tp(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=jS.bind(null,u),lT(s,u))));break;case 22:if(h=u.memoizedState!==null||os,!h){r=r!==null&&r.memoizedState!==null||ve,y=os;var S=ve;os=h,(ve=r)&&!S?fs(s,u,(u.subtreeFlags&8772)!==0):cs(s,u),os=y,ve=S}break;case 30:break;default:cs(s,u)}}function vp(s){var r=s.alternate;r!==null&&(s.alternate=null,vp(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&iu(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ie=null,Xe=!1;function us(s,r,u){for(u=u.child;u!==null;)Ep(s,r,u),u=u.sibling}function Ep(s,r,u){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(en,u)}catch{}switch(u.tag){case 26:ve||Ni(u,r),us(s,r,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ve||Ni(u,r);var h=ie,y=Xe;js(u.type)&&(ie=u.stateNode,Xe=!1),us(s,r,u),ga(u.stateNode),ie=h,Xe=y;break;case 5:ve||Ni(u,r);case 6:if(h=ie,y=Xe,ie=null,us(s,r,u),ie=h,Xe=y,ie!==null)if(Xe)try{(ie.nodeType===9?ie.body:ie.nodeName==="HTML"?ie.ownerDocument.body:ie).removeChild(u.stateNode)}catch(S){Ht(u,r,S)}else try{ie.removeChild(u.stateNode)}catch(S){Ht(u,r,S)}break;case 18:ie!==null&&(Xe?(s=ie,fg(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),hr(s)):fg(ie,u.stateNode));break;case 4:h=ie,y=Xe,ie=u.stateNode.containerInfo,Xe=!0,us(s,r,u),ie=h,Xe=y;break;case 0:case 11:case 14:case 15:Ms(2,u,r),ve||Ms(4,u,r),us(s,r,u);break;case 1:ve||(Ni(u,r),h=u.stateNode,typeof h.componentWillUnmount=="function"&&dp(u,r,h)),us(s,r,u);break;case 21:us(s,r,u);break;case 22:ve=(h=ve)||u.memoizedState!==null,us(s,r,u),ve=h;break;default:us(s,r,u)}}function Sp(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{hr(s)}catch(u){Ht(r,r.return,u)}}}function Tp(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{hr(s)}catch(u){Ht(r,r.return,u)}}function OS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new gp),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new gp),r;default:throw Error(i(435,s.tag))}}function wl(s,r){var u=OS(s);r.forEach(function(h){if(!u.has(h)){u.add(h);var y=GS.bind(null,s,h);h.then(y,y)}})}function Qe(s,r){var u=r.deletions;if(u!==null)for(var h=0;h<u.length;h++){var y=u[h],S=s,L=r,D=L;t:for(;D!==null;){switch(D.tag){case 27:if(js(D.type)){ie=D.stateNode,Xe=!1;break t}break;case 5:ie=D.stateNode,Xe=!1;break t;case 3:case 4:ie=D.stateNode.containerInfo,Xe=!0;break t}D=D.return}if(ie===null)throw Error(i(160));Ep(S,L,y),ie=null,Xe=!1,S=y.alternate,S!==null&&(S.return=null),y.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)xp(r,s),r=r.sibling}var Ii=null;function xp(s,r){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Qe(r,s),We(s),h&4&&(Ms(3,s,s.return),aa(3,s),Ms(5,s,s.return));break;case 1:Qe(r,s),We(s),h&512&&(ve||u===null||Ni(u,u.return)),h&64&&os&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var y=Ii;if(Qe(r,s),We(s),h&512&&(ve||u===null||Ni(u,u.return)),h&4){var S=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){t:{h=s.type,u=s.memoizedProps,y=y.ownerDocument||y;e:switch(h){case"title":S=y.getElementsByTagName("title")[0],(!S||S[Mr]||S[Ce]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=y.createElement(h),y.head.insertBefore(S,y.querySelector("head > title"))),Me(S,h,u),S[Ce]=s,Re(S),h=S;break t;case"link":var L=xg("link","href",y).get(h+(u.href||""));if(L){for(var D=0;D<L.length;D++)if(S=L[D],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){L.splice(D,1);break e}}S=y.createElement(h),Me(S,h,u),y.head.appendChild(S);break;case"meta":if(L=xg("meta","content",y).get(h+(u.content||""))){for(D=0;D<L.length;D++)if(S=L[D],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){L.splice(D,1);break e}}S=y.createElement(h),Me(S,h,u),y.head.appendChild(S);break;default:throw Error(i(468,h))}S[Ce]=s,Re(S),h=S}s.stateNode=h}else bg(y,s.type,s.stateNode);else s.stateNode=Tg(y,h,s.memoizedProps);else S!==h?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,h===null?bg(y,s.type,s.stateNode):Tg(y,h,s.memoizedProps)):h===null&&s.stateNode!==null&&bc(s,s.memoizedProps,u.memoizedProps)}break;case 27:Qe(r,s),We(s),h&512&&(ve||u===null||Ni(u,u.return)),u!==null&&h&4&&bc(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Qe(r,s),We(s),h&512&&(ve||u===null||Ni(u,u.return)),s.flags&32){y=s.stateNode;try{Nn(y,"")}catch(gt){Ht(s,s.return,gt)}}h&4&&s.stateNode!=null&&(y=s.memoizedProps,bc(s,y,u!==null?u.memoizedProps:y)),h&1024&&(Rc=!0);break;case 6:if(Qe(r,s),We(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(gt){Ht(s,s.return,gt)}}break;case 3:if(ql=null,y=Ii,Ii=Vl(r.containerInfo),Qe(r,s),Ii=y,We(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{hr(r.containerInfo)}catch(gt){Ht(s,s.return,gt)}Rc&&(Rc=!1,bp(s));break;case 4:h=Ii,Ii=Vl(s.stateNode.containerInfo),Qe(r,s),We(s),Ii=h;break;case 12:Qe(r,s),We(s);break;case 31:Qe(r,s),We(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,wl(s,h)));break;case 13:Qe(r,s),We(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ol=ee()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,wl(s,h)));break;case 22:y=s.memoizedState!==null;var F=u!==null&&u.memoizedState!==null,W=os,st=ve;if(os=W||y,ve=st||F,Qe(r,s),ve=st,os=W,We(s),h&8192)t:for(r=s.stateNode,r._visibility=y?r._visibility&-2:r._visibility|1,y&&(u===null||F||os||ve||En(s)),u=null,r=s;;){if(r.tag===5||r.tag===26){if(u===null){F=u=r;try{if(S=F.stateNode,y)L=S.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{D=F.stateNode;var ot=F.memoizedProps.style,Z=ot!=null&&ot.hasOwnProperty("display")?ot.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(gt){Ht(F,F.return,gt)}}}else if(r.tag===6){if(u===null){F=r;try{F.stateNode.nodeValue=y?"":F.memoizedProps}catch(gt){Ht(F,F.return,gt)}}}else if(r.tag===18){if(u===null){F=r;try{var et=F.stateNode;y?dg(et,!0):dg(F.stateNode,!1)}catch(gt){Ht(F,F.return,gt)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break t;for(;r.sibling===null;){if(r.return===null||r.return===s)break t;u===r&&(u=null),r=r.return}u===r&&(u=null),r.sibling.return=r.return,r=r.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,wl(s,u))));break;case 19:Qe(r,s),We(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,wl(s,h)));break;case 30:break;case 21:break;default:Qe(r,s),We(s)}}function We(s){var r=s.flags;if(r&2){try{for(var u,h=s.return;h!==null;){if(mp(h)){u=h;break}h=h.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var y=u.stateNode,S=Ac(s);Cl(s,S,y);break;case 5:var L=u.stateNode;u.flags&32&&(Nn(L,""),u.flags&=-33);var D=Ac(s);Cl(s,D,L);break;case 3:case 4:var F=u.stateNode.containerInfo,W=Ac(s);Lc(s,W,F);break;default:throw Error(i(161))}}catch(st){Ht(s,s.return,st)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function bp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;bp(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function cs(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)yp(s,r.alternate,r),r=r.sibling}function En(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Ms(4,r,r.return),En(r);break;case 1:Ni(r,r.return);var u=r.stateNode;typeof u.componentWillUnmount=="function"&&dp(r,r.return,u),En(r);break;case 27:ga(r.stateNode);case 26:case 5:Ni(r,r.return),En(r);break;case 22:r.memoizedState===null&&En(r);break;case 30:En(r);break;default:En(r)}s=s.sibling}}function fs(s,r,u){for(u=u&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var h=r.alternate,y=s,S=r,L=S.flags;switch(S.tag){case 0:case 11:case 15:fs(y,S,u),aa(4,S);break;case 1:if(fs(y,S,u),h=S,y=h.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(W){Ht(h,h.return,W)}if(h=S,y=h.updateQueue,y!==null){var D=h.stateNode;try{var F=y.shared.hiddenCallbacks;if(F!==null)for(y.shared.hiddenCallbacks=null,y=0;y<F.length;y++)tm(F[y],D)}catch(W){Ht(h,h.return,W)}}u&&L&64&&fp(S),la(S,S.return);break;case 27:pp(S);case 26:case 5:fs(y,S,u),u&&h===null&&L&4&&hp(S),la(S,S.return);break;case 12:fs(y,S,u);break;case 31:fs(y,S,u),u&&L&4&&Sp(y,S);break;case 13:fs(y,S,u),u&&L&4&&Tp(y,S);break;case 22:S.memoizedState===null&&fs(y,S,u),la(S,S.return);break;case 30:break;default:fs(y,S,u)}r=r.sibling}}function _c(s,r){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&qr(u))}function Ic(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&qr(s))}function Di(s,r,u,h){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Ap(s,r,u,h),r=r.sibling}function Ap(s,r,u,h){var y=r.flags;switch(r.tag){case 0:case 11:case 15:Di(s,r,u,h),y&2048&&aa(9,r);break;case 1:Di(s,r,u,h);break;case 3:Di(s,r,u,h),y&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&qr(s)));break;case 12:if(y&2048){Di(s,r,u,h),s=r.stateNode;try{var S=r.memoizedProps,L=S.id,D=S.onPostCommit;typeof D=="function"&&D(L,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(F){Ht(r,r.return,F)}}else Di(s,r,u,h);break;case 31:Di(s,r,u,h);break;case 13:Di(s,r,u,h);break;case 23:break;case 22:S=r.stateNode,L=r.alternate,r.memoizedState!==null?S._visibility&2?Di(s,r,u,h):oa(s,r):S._visibility&2?Di(s,r,u,h):(S._visibility|=2,ir(s,r,u,h,(r.subtreeFlags&10256)!==0||!1)),y&2048&&_c(L,r);break;case 24:Di(s,r,u,h),y&2048&&Ic(r.alternate,r);break;default:Di(s,r,u,h)}}function ir(s,r,u,h,y){for(y=y&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var S=s,L=r,D=u,F=h,W=L.flags;switch(L.tag){case 0:case 11:case 15:ir(S,L,D,F,y),aa(8,L);break;case 23:break;case 22:var st=L.stateNode;L.memoizedState!==null?st._visibility&2?ir(S,L,D,F,y):oa(S,L):(st._visibility|=2,ir(S,L,D,F,y)),y&&W&2048&&_c(L.alternate,L);break;case 24:ir(S,L,D,F,y),y&&W&2048&&Ic(L.alternate,L);break;default:ir(S,L,D,F,y)}r=r.sibling}}function oa(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var u=s,h=r,y=h.flags;switch(h.tag){case 22:oa(u,h),y&2048&&_c(h.alternate,h);break;case 24:oa(u,h),y&2048&&Ic(h.alternate,h);break;default:oa(u,h)}r=r.sibling}}var ua=8192;function sr(s,r,u){if(s.subtreeFlags&ua)for(s=s.child;s!==null;)Lp(s,r,u),s=s.sibling}function Lp(s,r,u){switch(s.tag){case 26:sr(s,r,u),s.flags&ua&&s.memoizedState!==null&&ET(u,Ii,s.memoizedState,s.memoizedProps);break;case 5:sr(s,r,u);break;case 3:case 4:var h=Ii;Ii=Vl(s.stateNode.containerInfo),sr(s,r,u),Ii=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=ua,ua=16777216,sr(s,r,u),ua=h):sr(s,r,u));break;default:sr(s,r,u)}}function Rp(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function ca(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var u=0;u<r.length;u++){var h=r[u];_e=h,Ip(h,s)}Rp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)_p(s),s=s.sibling}function _p(s){switch(s.tag){case 0:case 11:case 15:ca(s),s.flags&2048&&Ms(9,s,s.return);break;case 3:ca(s);break;case 12:ca(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,kl(s)):ca(s);break;default:ca(s)}}function kl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var u=0;u<r.length;u++){var h=r[u];_e=h,Ip(h,s)}Rp(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Ms(8,r,r.return),kl(r);break;case 22:u=r.stateNode,u._visibility&2&&(u._visibility&=-3,kl(r));break;default:kl(r)}s=s.sibling}}function Ip(s,r){for(;_e!==null;){var u=_e;switch(u.tag){case 0:case 11:case 15:Ms(8,u,r);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:qr(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,_e=h;else t:for(u=s;_e!==null;){h=_e;var y=h.sibling,S=h.return;if(vp(h),h===u){_e=null;break t}if(y!==null){y.return=S,_e=y;break t}_e=S}}}var MS={getCacheForType:function(s){var r=ke(pe),u=r.data.get(s);return u===void 0&&(u=s(),r.data.set(s,u)),u},cacheSignal:function(){return ke(pe).controller.signal}},PS=typeof WeakMap=="function"?WeakMap:Map,jt=0,Qt=null,Ot=null,Pt=0,Gt=0,ai=null,Ps=!1,nr=!1,Dc=!1,ds=0,ce=0,Ns=0,Sn=0,Cc=0,li=0,rr=0,fa=null,Ze=null,wc=!1,Ol=0,Dp=0,Ml=1/0,Pl=null,Bs=null,xe=0,Fs=null,ar=null,hs=0,kc=0,Oc=null,Cp=null,da=0,Mc=null;function oi(){return(jt&2)!==0&&Pt!==0?Pt&-Pt:O.T!==null?$c():Kd()}function wp(){if(li===0)if((Pt&536870912)===0||Bt){var s=Ha;Ha<<=1,(Ha&3932160)===0&&(Ha=262144),li=s}else li=536870912;return s=ni.current,s!==null&&(s.flags|=32),li}function Je(s,r,u){(s===Qt&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)&&(lr(s,0),Us(s,Pt,li,!1)),Or(s,u),((jt&2)===0||s!==Qt)&&(s===Qt&&((jt&2)===0&&(Sn|=u),ce===4&&Us(s,Pt,li,!1)),Bi(s))}function kp(s,r,u){if((jt&6)!==0)throw Error(i(327));var h=!u&&(r&127)===0&&(r&s.expiredLanes)===0||kr(s,r),y=h?FS(s,r):Nc(s,r,!0),S=h;do{if(y===0){nr&&!h&&Us(s,r,0,!1);break}else{if(u=s.current.alternate,S&&!NS(u)){y=Nc(s,r,!1),S=!1;continue}if(y===2){if(S=r,s.errorRecoveryDisabledLanes&S)var L=0;else L=s.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){r=L;t:{var D=s;y=fa;var F=D.current.memoizedState.isDehydrated;if(F&&(lr(D,L).flags|=256),L=Nc(D,L,!1),L!==2){if(Dc&&!F){D.errorRecoveryDisabledLanes|=S,Sn|=S,y=4;break t}S=Ze,Ze=y,S!==null&&(Ze===null?Ze=S:Ze.push.apply(Ze,S))}y=L}if(S=!1,y!==2)continue}}if(y===1){lr(s,0),Us(s,r,0,!0);break}t:{switch(h=s,S=y,S){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Us(h,r,li,!Ps);break t;case 2:Ze=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(y=Ol+300-ee(),10<y)){if(Us(h,r,li,!Ps),Va(h,0,!0)!==0)break t;hs=r,h.timeoutHandle=ug(Op.bind(null,h,u,Ze,Pl,wc,r,li,Sn,rr,Ps,S,"Throttled",-0,0),y);break t}Op(h,u,Ze,Pl,wc,r,li,Sn,rr,Ps,S,null,-0,0)}}break}while(!0);Bi(s)}function Op(s,r,u,h,y,S,L,D,F,W,st,ot,Z,et){if(s.timeoutHandle=-1,ot=r.subtreeFlags,ot&8192||(ot&16785408)===16785408){ot={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zi},Lp(r,S,ot);var gt=(S&62914560)===S?Ol-ee():(S&4194048)===S?Dp-ee():0;if(gt=ST(ot,gt),gt!==null){hs=S,s.cancelPendingCommit=gt(jp.bind(null,s,r,S,u,h,y,L,D,F,st,ot,null,Z,et)),Us(s,S,L,!W);return}}jp(s,r,S,u,h,y,L,D,F)}function NS(s){for(var r=s;;){var u=r.tag;if((u===0||u===11||u===15)&&r.flags&16384&&(u=r.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var y=u[h],S=y.getSnapshot;y=y.value;try{if(!ii(S(),y))return!1}catch{return!1}}if(u=r.child,r.subtreeFlags&16384&&u!==null)u.return=r,r=u;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Us(s,r,u,h){r&=~Cc,r&=~Sn,s.suspendedLanes|=r,s.pingedLanes&=~r,h&&(s.warmLanes|=r),h=s.expirationTimes;for(var y=r;0<y;){var S=31-Ge(y),L=1<<S;h[S]=-1,y&=~L}u!==0&&Hd(s,u,r)}function Nl(){return(jt&6)===0?(ha(0),!1):!0}function Pc(){if(Ot!==null){if(Gt===0)var s=Ot.return;else s=Ot,is=fn=null,Wu(s),Wn=null,Xr=0,s=Ot;for(;s!==null;)cp(s.alternate,s),s=s.return;Ot=null}}function lr(s,r){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,iT(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),hs=0,Pc(),Qt=s,Ot=u=ts(s.current,null),Pt=r,Gt=0,ai=null,Ps=!1,nr=kr(s,r),Dc=!1,rr=li=Cc=Sn=Ns=ce=0,Ze=fa=null,wc=!1,(r&8)!==0&&(r|=r&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=r;0<h;){var y=31-Ge(h),S=1<<y;r|=s[y],h&=~S}return ds=r,sl(),u}function Mp(s,r){Rt=null,O.H=sa,r===Qn||r===fl?(r=Qh(),Gt=3):r===Uu?(r=Qh(),Gt=4):Gt=r===hc?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,ai=r,Ot===null&&(ce=1,Ll(s,vi(r,s.current)))}function Pp(){var s=ni.current;return s===null?!0:(Pt&4194048)===Pt?xi===null:(Pt&62914560)===Pt||(Pt&536870912)!==0?s===xi:!1}function Np(){var s=O.H;return O.H=sa,s===null?sa:s}function Bp(){var s=O.A;return O.A=MS,s}function Bl(){ce=4,Ps||(Pt&4194048)!==Pt&&ni.current!==null||(nr=!0),(Ns&134217727)===0&&(Sn&134217727)===0||Qt===null||Us(Qt,Pt,li,!1)}function Nc(s,r,u){var h=jt;jt|=2;var y=Np(),S=Bp();(Qt!==s||Pt!==r)&&(Pl=null,lr(s,r)),r=!1;var L=ce;t:do try{if(Gt!==0&&Ot!==null){var D=Ot,F=ai;switch(Gt){case 8:Pc(),L=6;break t;case 3:case 2:case 9:case 6:ni.current===null&&(r=!0);var W=Gt;if(Gt=0,ai=null,or(s,D,F,W),u&&nr){L=0;break t}break;default:W=Gt,Gt=0,ai=null,or(s,D,F,W)}}BS(),L=ce;break}catch(st){Mp(s,st)}while(!0);return r&&s.shellSuspendCounter++,is=fn=null,jt=h,O.H=y,O.A=S,Ot===null&&(Qt=null,Pt=0,sl()),L}function BS(){for(;Ot!==null;)Fp(Ot)}function FS(s,r){var u=jt;jt|=2;var h=Np(),y=Bp();Qt!==s||Pt!==r?(Pl=null,Ml=ee()+500,lr(s,r)):nr=kr(s,r);t:do try{if(Gt!==0&&Ot!==null){r=Ot;var S=ai;e:switch(Gt){case 1:Gt=0,ai=null,or(s,r,S,1);break;case 2:case 9:if(Yh(S)){Gt=0,ai=null,Up(r);break}r=function(){Gt!==2&&Gt!==9||Qt!==s||(Gt=7),Bi(s)},S.then(r,r);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:Yh(S)?(Gt=0,ai=null,Up(r)):(Gt=0,ai=null,or(s,r,S,7));break;case 5:var L=null;switch(Ot.tag){case 26:L=Ot.memoizedState;case 5:case 27:var D=Ot;if(L?Ag(L):D.stateNode.complete){Gt=0,ai=null;var F=D.sibling;if(F!==null)Ot=F;else{var W=D.return;W!==null?(Ot=W,Fl(W)):Ot=null}break e}}Gt=0,ai=null,or(s,r,S,5);break;case 6:Gt=0,ai=null,or(s,r,S,6);break;case 8:Pc(),ce=6;break t;default:throw Error(i(462))}}US();break}catch(st){Mp(s,st)}while(!0);return is=fn=null,O.H=h,O.A=y,jt=u,Ot!==null?0:(Qt=null,Pt=0,sl(),ce)}function US(){for(;Ot!==null&&!Fe();)Fp(Ot)}function Fp(s){var r=op(s.alternate,s,ds);s.memoizedProps=s.pendingProps,r===null?Fl(s):Ot=r}function Up(s){var r=s,u=r.alternate;switch(r.tag){case 15:case 0:r=ip(u,r,r.pendingProps,r.type,void 0,Pt);break;case 11:r=ip(u,r,r.pendingProps,r.type.render,r.ref,Pt);break;case 5:Wu(r);default:cp(u,r),r=Ot=Bh(r,ds),r=op(u,r,ds)}s.memoizedProps=s.pendingProps,r===null?Fl(s):Ot=r}function or(s,r,u,h){is=fn=null,Wu(r),Wn=null,Xr=0;var y=r.return;try{if(_S(s,y,r,u,Pt)){ce=1,Ll(s,vi(u,s.current)),Ot=null;return}}catch(S){if(y!==null)throw Ot=y,S;ce=1,Ll(s,vi(u,s.current)),Ot=null;return}r.flags&32768?(Bt||h===1?s=!0:nr||(Pt&536870912)!==0?s=!1:(Ps=s=!0,(h===2||h===9||h===3||h===6)&&(h=ni.current,h!==null&&h.tag===13&&(h.flags|=16384))),$p(r,s)):Fl(r)}function Fl(s){var r=s;do{if((r.flags&32768)!==0){$p(r,Ps);return}s=r.return;var u=CS(r.alternate,r,ds);if(u!==null){Ot=u;return}if(r=r.sibling,r!==null){Ot=r;return}Ot=r=s}while(r!==null);ce===0&&(ce=5)}function $p(s,r){do{var u=wS(s.alternate,s);if(u!==null){u.flags&=32767,Ot=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!r&&(s=s.sibling,s!==null)){Ot=s;return}Ot=s=u}while(s!==null);ce=6,Ot=null}function jp(s,r,u,h,y,S,L,D,F){s.cancelPendingCommit=null;do Ul();while(xe!==0);if((jt&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(S=r.lanes|r.childLanes,S|=Au,vE(s,u,S,L,D,F),s===Qt&&(Ot=Qt=null,Pt=0),ar=r,Fs=s,hs=u,kc=S,Oc=y,Cp=h,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,HS(xs,function(){return Kp(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||h){h=O.T,O.T=null,y=j.p,j.p=2,L=jt,jt|=4;try{kS(s,r,u)}finally{jt=L,j.p=y,O.T=h}}xe=1,Gp(),Hp(),zp()}}function Gp(){if(xe===1){xe=0;var s=Fs,r=ar,u=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||u){u=O.T,O.T=null;var h=j.p;j.p=2;var y=jt;jt|=4;try{xp(r,s);var S=Yc,L=Ih(s.containerInfo),D=S.focusedElem,F=S.selectionRange;if(L!==D&&D&&D.ownerDocument&&_h(D.ownerDocument.documentElement,D)){if(F!==null&&Eu(D)){var W=F.start,st=F.end;if(st===void 0&&(st=W),"selectionStart"in D)D.selectionStart=W,D.selectionEnd=Math.min(st,D.value.length);else{var ot=D.ownerDocument||document,Z=ot&&ot.defaultView||window;if(Z.getSelection){var et=Z.getSelection(),gt=D.textContent.length,Tt=Math.min(F.start,gt),Yt=F.end===void 0?Tt:Math.min(F.end,gt);!et.extend&&Tt>Yt&&(L=Yt,Yt=Tt,Tt=L);var z=Rh(D,Tt),$=Rh(D,Yt);if(z&&$&&(et.rangeCount!==1||et.anchorNode!==z.node||et.anchorOffset!==z.offset||et.focusNode!==$.node||et.focusOffset!==$.offset)){var Q=ot.createRange();Q.setStart(z.node,z.offset),et.removeAllRanges(),Tt>Yt?(et.addRange(Q),et.extend($.node,$.offset)):(Q.setEnd($.node,$.offset),et.addRange(Q))}}}}for(ot=[],et=D;et=et.parentNode;)et.nodeType===1&&ot.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ot.length;D++){var at=ot[D];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}Wl=!!qc,Yc=qc=null}finally{jt=y,j.p=h,O.T=u}}s.current=r,xe=2}}function Hp(){if(xe===2){xe=0;var s=Fs,r=ar,u=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||u){u=O.T,O.T=null;var h=j.p;j.p=2;var y=jt;jt|=4;try{yp(s,r.alternate,r)}finally{jt=y,j.p=h,O.T=u}}xe=3}}function zp(){if(xe===4||xe===3){xe=0,$e();var s=Fs,r=ar,u=hs,h=Cp;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?xe=5:(xe=0,ar=Fs=null,Vp(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Bs=null),tu(u),r=r.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(en,r,void 0,(r.current.flags&128)===128)}catch{}if(h!==null){r=O.T,y=j.p,j.p=2,O.T=null;try{for(var S=s.onRecoverableError,L=0;L<h.length;L++){var D=h[L];S(D.value,{componentStack:D.stack})}}finally{O.T=r,j.p=y}}(hs&3)!==0&&Ul(),Bi(s),y=s.pendingLanes,(u&261930)!==0&&(y&42)!==0?s===Mc?da++:(da=0,Mc=s):da=0,ha(0)}}function Vp(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,qr(r)))}function Ul(){return Gp(),Hp(),zp(),Kp()}function Kp(){if(xe!==5)return!1;var s=Fs,r=kc;kc=0;var u=tu(hs),h=O.T,y=j.p;try{j.p=32>u?32:u,O.T=null,u=Oc,Oc=null;var S=Fs,L=hs;if(xe=0,ar=Fs=null,hs=0,(jt&6)!==0)throw Error(i(331));var D=jt;if(jt|=4,_p(S.current),Ap(S,S.current,L,u),jt=D,ha(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(en,S)}catch{}return!0}finally{j.p=y,O.T=h,Vp(s,r)}}function qp(s,r,u){r=vi(u,r),r=dc(s.stateNode,r,2),s=ws(s,r,2),s!==null&&(Or(s,2),Bi(s))}function Ht(s,r,u){if(s.tag===3)qp(s,s,u);else for(;r!==null;){if(r.tag===3){qp(r,s,u);break}else if(r.tag===1){var h=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Bs===null||!Bs.has(h))){s=vi(u,s),u=Ym(2),h=ws(r,u,2),h!==null&&(Xm(u,h,r,s),Or(h,2),Bi(h));break}}r=r.return}}function Bc(s,r,u){var h=s.pingCache;if(h===null){h=s.pingCache=new PS;var y=new Set;h.set(r,y)}else y=h.get(r),y===void 0&&(y=new Set,h.set(r,y));y.has(u)||(Dc=!0,y.add(u),s=$S.bind(null,s,r,u),r.then(s,s))}function $S(s,r,u){var h=s.pingCache;h!==null&&h.delete(r),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Qt===s&&(Pt&u)===u&&(ce===4||ce===3&&(Pt&62914560)===Pt&&300>ee()-Ol?(jt&2)===0&&lr(s,0):Cc|=u,rr===Pt&&(rr=0)),Bi(s)}function Yp(s,r){r===0&&(r=Gd()),s=on(s,r),s!==null&&(Or(s,r),Bi(s))}function jS(s){var r=s.memoizedState,u=0;r!==null&&(u=r.retryLane),Yp(s,u)}function GS(s,r){var u=0;switch(s.tag){case 31:case 13:var h=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(r),Yp(s,u)}function HS(s,r){return oe(s,r)}var $l=null,ur=null,Fc=!1,jl=!1,Uc=!1,$s=0;function Bi(s){s!==ur&&s.next===null&&(ur===null?$l=ur=s:ur=ur.next=s),jl=!0,Fc||(Fc=!0,VS())}function ha(s,r){if(!Uc&&jl){Uc=!0;do for(var u=!1,h=$l;h!==null;){if(s!==0){var y=h.pendingLanes;if(y===0)var S=0;else{var L=h.suspendedLanes,D=h.pingedLanes;S=(1<<31-Ge(42|s)+1)-1,S&=y&~(L&~D),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,Zp(h,S))}else S=Pt,S=Va(h,h===Qt?S:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(S&3)===0||kr(h,S)||(u=!0,Zp(h,S));h=h.next}while(u);Uc=!1}}function zS(){Xp()}function Xp(){jl=Fc=!1;var s=0;$s!==0&&eT()&&(s=$s);for(var r=ee(),u=null,h=$l;h!==null;){var y=h.next,S=Qp(h,r);S===0?(h.next=null,u===null?$l=y:u.next=y,y===null&&(ur=u)):(u=h,(s!==0||(S&3)!==0)&&(jl=!0)),h=y}xe!==0&&xe!==5||ha(s),$s!==0&&($s=0)}function Qp(s,r){for(var u=s.suspendedLanes,h=s.pingedLanes,y=s.expirationTimes,S=s.pendingLanes&-62914561;0<S;){var L=31-Ge(S),D=1<<L,F=y[L];F===-1?((D&u)===0||(D&h)!==0)&&(y[L]=yE(D,r)):F<=r&&(s.expiredLanes|=D),S&=~D}if(r=Qt,u=Pt,u=Va(s,s===r?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===r&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&De(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||kr(s,u)){if(r=u&-u,r===s.callbackPriority)return r;switch(h!==null&&De(h),tu(u)){case 2:case 8:u=Js;break;case 32:u=xs;break;case 268435456:u=tn;break;default:u=xs}return h=Wp.bind(null,s),u=oe(u,h),s.callbackPriority=r,s.callbackNode=u,r}return h!==null&&h!==null&&De(h),s.callbackPriority=2,s.callbackNode=null,2}function Wp(s,r){if(xe!==0&&xe!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Ul()&&s.callbackNode!==u)return null;var h=Pt;return h=Va(s,s===Qt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(kp(s,h,r),Qp(s,ee()),s.callbackNode!=null&&s.callbackNode===u?Wp.bind(null,s):null)}function Zp(s,r){if(Ul())return null;kp(s,r,!0)}function VS(){sT(function(){(jt&6)!==0?oe(Ke,zS):Xp()})}function $c(){if($s===0){var s=Yn;s===0&&(s=Ga,Ga<<=1,(Ga&261888)===0&&(Ga=256)),$s=s}return $s}function Jp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xa(""+s)}function tg(s,r){var u=r.ownerDocument.createElement("input");return u.name=r.name,u.value=r.value,s.id&&u.setAttribute("form",s.id),r.parentNode.insertBefore(u,r),s=new FormData(s),u.parentNode.removeChild(u),s}function KS(s,r,u,h,y){if(r==="submit"&&u&&u.stateNode===y){var S=Jp((y[qe]||null).action),L=h.submitter;L&&(r=(r=L[qe]||null)?Jp(r.formAction):L.getAttribute("formAction"),r!==null&&(S=r,L=null));var D=new Ja("action","action",null,h,y);s.push({event:D,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if($s!==0){var F=L?tg(y,L):new FormData(y);ac(u,{pending:!0,data:F,method:y.method,action:S},null,F)}}else typeof S=="function"&&(D.preventDefault(),F=L?tg(y,L):new FormData(y),ac(u,{pending:!0,data:F,method:y.method,action:S},S,F))},currentTarget:y}]})}}for(var jc=0;jc<bu.length;jc++){var Gc=bu[jc],qS=Gc.toLowerCase(),YS=Gc[0].toUpperCase()+Gc.slice(1);_i(qS,"on"+YS)}_i(wh,"onAnimationEnd"),_i(kh,"onAnimationIteration"),_i(Oh,"onAnimationStart"),_i("dblclick","onDoubleClick"),_i("focusin","onFocus"),_i("focusout","onBlur"),_i(cS,"onTransitionRun"),_i(fS,"onTransitionStart"),_i(dS,"onTransitionCancel"),_i(Mh,"onTransitionEnd"),Mn("onMouseEnter",["mouseout","mouseover"]),Mn("onMouseLeave",["mouseout","mouseover"]),Mn("onPointerEnter",["pointerout","pointerover"]),Mn("onPointerLeave",["pointerout","pointerover"]),nn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nn("onBeforeInput",["compositionend","keypress","textInput","paste"]),nn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ma));function eg(s,r){r=(r&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],y=h.event;h=h.listeners;t:{var S=void 0;if(r)for(var L=h.length-1;0<=L;L--){var D=h[L],F=D.instance,W=D.currentTarget;if(D=D.listener,F!==S&&y.isPropagationStopped())break t;S=D,y.currentTarget=W;try{S(y)}catch(st){il(st)}y.currentTarget=null,S=F}else for(L=0;L<h.length;L++){if(D=h[L],F=D.instance,W=D.currentTarget,D=D.listener,F!==S&&y.isPropagationStopped())break t;S=D,y.currentTarget=W;try{S(y)}catch(st){il(st)}y.currentTarget=null,S=F}}}}function Mt(s,r){var u=r[eu];u===void 0&&(u=r[eu]=new Set);var h=s+"__bubble";u.has(h)||(ig(r,s,2,!1),u.add(h))}function Hc(s,r,u){var h=0;r&&(h|=4),ig(u,s,h,r)}var Gl="_reactListening"+Math.random().toString(36).slice(2);function zc(s){if(!s[Gl]){s[Gl]=!0,Xd.forEach(function(u){u!=="selectionchange"&&(XS.has(u)||Hc(u,!1,s),Hc(u,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Gl]||(r[Gl]=!0,Hc("selectionchange",!1,r))}}function ig(s,r,u,h){switch(wg(r)){case 2:var y=bT;break;case 8:y=AT;break;default:y=af}u=y.bind(null,r,u,s),y=void 0,!cu||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(y=!0),h?y!==void 0?s.addEventListener(r,u,{capture:!0,passive:y}):s.addEventListener(r,u,!0):y!==void 0?s.addEventListener(r,u,{passive:y}):s.addEventListener(r,u,!1)}function Vc(s,r,u,h,y){var S=h;if((r&1)===0&&(r&2)===0&&h!==null)t:for(;;){if(h===null)return;var L=h.tag;if(L===3||L===4){var D=h.stateNode.containerInfo;if(D===y)break;if(L===4)for(L=h.return;L!==null;){var F=L.tag;if((F===3||F===4)&&L.stateNode.containerInfo===y)return;L=L.return}for(;D!==null;){if(L=wn(D),L===null)return;if(F=L.tag,F===5||F===6||F===26||F===27){h=S=L;continue t}D=D.parentNode}}h=h.return}lh(function(){var W=S,st=ou(u),ot=[];t:{var Z=Ph.get(s);if(Z!==void 0){var et=Ja,gt=s;switch(s){case"keypress":if(Wa(u)===0)break t;case"keydown":case"keyup":et=GE;break;case"focusin":gt="focus",et=mu;break;case"focusout":gt="blur",et=mu;break;case"beforeblur":case"afterblur":et=mu;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=ch;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=CE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=VE;break;case wh:case kh:case Oh:et=OE;break;case Mh:et=qE;break;case"scroll":case"scrollend":et=IE;break;case"wheel":et=XE;break;case"copy":case"cut":case"paste":et=PE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=dh;break;case"toggle":case"beforetoggle":et=WE}var Tt=(r&4)!==0,Yt=!Tt&&(s==="scroll"||s==="scrollend"),z=Tt?Z!==null?Z+"Capture":null:Z;Tt=[];for(var $=W,Q;$!==null;){var at=$;if(Q=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||Q===null||z===null||(at=Nr($,z),at!=null&&Tt.push(pa($,at,Q))),Yt)break;$=$.return}0<Tt.length&&(Z=new et(Z,gt,null,u,st),ot.push({event:Z,listeners:Tt}))}}if((r&7)===0){t:{if(Z=s==="mouseover"||s==="pointerover",et=s==="mouseout"||s==="pointerout",Z&&u!==lu&&(gt=u.relatedTarget||u.fromElement)&&(wn(gt)||gt[Cn]))break t;if((et||Z)&&(Z=st.window===st?st:(Z=st.ownerDocument)?Z.defaultView||Z.parentWindow:window,et?(gt=u.relatedTarget||u.toElement,et=W,gt=gt?wn(gt):null,gt!==null&&(Yt=a(gt),Tt=gt.tag,gt!==Yt||Tt!==5&&Tt!==27&&Tt!==6)&&(gt=null)):(et=null,gt=W),et!==gt)){if(Tt=ch,at="onMouseLeave",z="onMouseEnter",$="mouse",(s==="pointerout"||s==="pointerover")&&(Tt=dh,at="onPointerLeave",z="onPointerEnter",$="pointer"),Yt=et==null?Z:Pr(et),Q=gt==null?Z:Pr(gt),Z=new Tt(at,$+"leave",et,u,st),Z.target=Yt,Z.relatedTarget=Q,at=null,wn(st)===W&&(Tt=new Tt(z,$+"enter",gt,u,st),Tt.target=Q,Tt.relatedTarget=Yt,at=Tt),Yt=at,et&&gt)e:{for(Tt=QS,z=et,$=gt,Q=0,at=z;at;at=Tt(at))Q++;at=0;for(var Et=$;Et;Et=Tt(Et))at++;for(;0<Q-at;)z=Tt(z),Q--;for(;0<at-Q;)$=Tt($),at--;for(;Q--;){if(z===$||$!==null&&z===$.alternate){Tt=z;break e}z=Tt(z),$=Tt($)}Tt=null}else Tt=null;et!==null&&sg(ot,Z,et,Tt,!1),gt!==null&&Yt!==null&&sg(ot,Yt,gt,Tt,!0)}}t:{if(Z=W?Pr(W):window,et=Z.nodeName&&Z.nodeName.toLowerCase(),et==="select"||et==="input"&&Z.type==="file")var Ut=Sh;else if(vh(Z))if(Th)Ut=lS;else{Ut=rS;var yt=nS}else et=Z.nodeName,!et||et.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&au(W.elementType)&&(Ut=Sh):Ut=aS;if(Ut&&(Ut=Ut(s,W))){Eh(ot,Ut,u,st);break t}yt&&yt(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&ru(Z,"number",Z.value)}switch(yt=W?Pr(W):window,s){case"focusin":(vh(yt)||yt.contentEditable==="true")&&($n=yt,Su=W,zr=null);break;case"focusout":zr=Su=$n=null;break;case"mousedown":Tu=!0;break;case"contextmenu":case"mouseup":case"dragend":Tu=!1,Dh(ot,u,st);break;case"selectionchange":if(uS)break;case"keydown":case"keyup":Dh(ot,u,st)}var _t;if(gu)t:{switch(s){case"compositionstart":var Nt="onCompositionStart";break t;case"compositionend":Nt="onCompositionEnd";break t;case"compositionupdate":Nt="onCompositionUpdate";break t}Nt=void 0}else Un?gh(s,u)&&(Nt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Nt="onCompositionStart");Nt&&(hh&&u.locale!=="ko"&&(Un||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&Un&&(_t=oh()):(As=st,fu="value"in As?As.value:As.textContent,Un=!0)),yt=Hl(W,Nt),0<yt.length&&(Nt=new fh(Nt,s,null,u,st),ot.push({event:Nt,listeners:yt}),_t?Nt.data=_t:(_t=yh(u),_t!==null&&(Nt.data=_t)))),(_t=JE?tS(s,u):eS(s,u))&&(Nt=Hl(W,"onBeforeInput"),0<Nt.length&&(yt=new fh("onBeforeInput","beforeinput",null,u,st),ot.push({event:yt,listeners:Nt}),yt.data=_t)),KS(ot,s,W,u,st)}eg(ot,r)})}function pa(s,r,u){return{instance:s,listener:r,currentTarget:u}}function Hl(s,r){for(var u=r+"Capture",h=[];s!==null;){var y=s,S=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||S===null||(y=Nr(s,u),y!=null&&h.unshift(pa(s,y,S)),y=Nr(s,r),y!=null&&h.push(pa(s,y,S))),s.tag===3)return h;s=s.return}return[]}function QS(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function sg(s,r,u,h,y){for(var S=r._reactName,L=[];u!==null&&u!==h;){var D=u,F=D.alternate,W=D.stateNode;if(D=D.tag,F!==null&&F===h)break;D!==5&&D!==26&&D!==27||W===null||(F=W,y?(W=Nr(u,S),W!=null&&L.unshift(pa(u,W,F))):y||(W=Nr(u,S),W!=null&&L.push(pa(u,W,F)))),u=u.return}L.length!==0&&s.push({event:r,listeners:L})}var WS=/\r\n?/g,ZS=/\u0000|\uFFFD/g;function ng(s){return(typeof s=="string"?s:""+s).replace(WS,`
`).replace(ZS,"")}function rg(s,r){return r=ng(r),ng(s)===r}function qt(s,r,u,h,y,S){switch(u){case"children":typeof h=="string"?r==="body"||r==="textarea"&&h===""||Nn(s,h):(typeof h=="number"||typeof h=="bigint")&&r!=="body"&&Nn(s,""+h);break;case"className":qa(s,"class",h);break;case"tabIndex":qa(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":qa(s,u,h);break;case"style":rh(s,h,S);break;case"data":if(r!=="object"){qa(s,"data",h);break}case"src":case"href":if(h===""&&(r!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Xa(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(r!=="input"&&qt(s,r,"name",y.name,y,null),qt(s,r,"formEncType",y.formEncType,y,null),qt(s,r,"formMethod",y.formMethod,y,null),qt(s,r,"formTarget",y.formTarget,y,null)):(qt(s,r,"encType",y.encType,y,null),qt(s,r,"method",y.method,y,null),qt(s,r,"target",y.target,y,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Xa(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=Zi);break;case"onScroll":h!=null&&Mt("scroll",s);break;case"onScrollEnd":h!=null&&Mt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=Xa(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":Mt("beforetoggle",s),Mt("toggle",s),Ka(s,"popover",h);break;case"xlinkActuate":Wi(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Wi(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Wi(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Wi(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Wi(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Wi(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Wi(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Wi(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Wi(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ka(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=RE.get(u)||u,Ka(s,u,h))}}function Kc(s,r,u,h,y,S){switch(u){case"style":rh(s,h,S);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof h=="string"?Nn(s,h):(typeof h=="number"||typeof h=="bigint")&&Nn(s,""+h);break;case"onScroll":h!=null&&Mt("scroll",s);break;case"onScrollEnd":h!=null&&Mt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Zi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qd.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),r=u.slice(2,y?u.length-7:void 0),S=s[qe]||null,S=S!=null?S[u]:null,typeof S=="function"&&s.removeEventListener(r,S,y),typeof h=="function")){typeof S!="function"&&S!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(r,h,y);break t}u in s?s[u]=h:h===!0?s.setAttribute(u,""):Ka(s,u,h)}}}function Me(s,r,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",s),Mt("load",s);var h=!1,y=!1,S;for(S in u)if(u.hasOwnProperty(S)){var L=u[S];if(L!=null)switch(S){case"src":h=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:qt(s,r,S,L,u,null)}}y&&qt(s,r,"srcSet",u.srcSet,u,null),h&&qt(s,r,"src",u.src,u,null);return;case"input":Mt("invalid",s);var D=S=L=y=null,F=null,W=null;for(h in u)if(u.hasOwnProperty(h)){var st=u[h];if(st!=null)switch(h){case"name":y=st;break;case"type":L=st;break;case"checked":F=st;break;case"defaultChecked":W=st;break;case"value":S=st;break;case"defaultValue":D=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(i(137,r));break;default:qt(s,r,h,st,u,null)}}eh(s,S,D,F,W,L,y,!1);return;case"select":Mt("invalid",s),h=L=S=null;for(y in u)if(u.hasOwnProperty(y)&&(D=u[y],D!=null))switch(y){case"value":S=D;break;case"defaultValue":L=D;break;case"multiple":h=D;default:qt(s,r,y,D,u,null)}r=S,u=L,s.multiple=!!h,r!=null?Pn(s,!!h,r,!1):u!=null&&Pn(s,!!h,u,!0);return;case"textarea":Mt("invalid",s),S=y=h=null;for(L in u)if(u.hasOwnProperty(L)&&(D=u[L],D!=null))switch(L){case"value":h=D;break;case"defaultValue":y=D;break;case"children":S=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:qt(s,r,L,D,u,null)}sh(s,h,y,S);return;case"option":for(F in u)if(u.hasOwnProperty(F)&&(h=u[F],h!=null))switch(F){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:qt(s,r,F,h,u,null)}return;case"dialog":Mt("beforetoggle",s),Mt("toggle",s),Mt("cancel",s),Mt("close",s);break;case"iframe":case"object":Mt("load",s);break;case"video":case"audio":for(h=0;h<ma.length;h++)Mt(ma[h],s);break;case"image":Mt("error",s),Mt("load",s);break;case"details":Mt("toggle",s);break;case"embed":case"source":case"link":Mt("error",s),Mt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in u)if(u.hasOwnProperty(W)&&(h=u[W],h!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:qt(s,r,W,h,u,null)}return;default:if(au(r)){for(st in u)u.hasOwnProperty(st)&&(h=u[st],h!==void 0&&Kc(s,r,st,h,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(h=u[D],h!=null&&qt(s,r,D,h,u,null))}function JS(s,r,u,h){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,S=null,L=null,D=null,F=null,W=null,st=null;for(et in u){var ot=u[et];if(u.hasOwnProperty(et)&&ot!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":F=ot;default:h.hasOwnProperty(et)||qt(s,r,et,null,h,ot)}}for(var Z in h){var et=h[Z];if(ot=u[Z],h.hasOwnProperty(Z)&&(et!=null||ot!=null))switch(Z){case"type":S=et;break;case"name":y=et;break;case"checked":W=et;break;case"defaultChecked":st=et;break;case"value":L=et;break;case"defaultValue":D=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(i(137,r));break;default:et!==ot&&qt(s,r,Z,et,h,ot)}}nu(s,L,D,F,W,st,S,y);return;case"select":et=L=D=Z=null;for(S in u)if(F=u[S],u.hasOwnProperty(S)&&F!=null)switch(S){case"value":break;case"multiple":et=F;default:h.hasOwnProperty(S)||qt(s,r,S,null,h,F)}for(y in h)if(S=h[y],F=u[y],h.hasOwnProperty(y)&&(S!=null||F!=null))switch(y){case"value":Z=S;break;case"defaultValue":D=S;break;case"multiple":L=S;default:S!==F&&qt(s,r,y,S,h,F)}r=D,u=L,h=et,Z!=null?Pn(s,!!u,Z,!1):!!h!=!!u&&(r!=null?Pn(s,!!u,r,!0):Pn(s,!!u,u?[]:"",!1));return;case"textarea":et=Z=null;for(D in u)if(y=u[D],u.hasOwnProperty(D)&&y!=null&&!h.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:qt(s,r,D,null,h,y)}for(L in h)if(y=h[L],S=u[L],h.hasOwnProperty(L)&&(y!=null||S!=null))switch(L){case"value":Z=y;break;case"defaultValue":et=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==S&&qt(s,r,L,y,h,S)}ih(s,Z,et);return;case"option":for(var gt in u)if(Z=u[gt],u.hasOwnProperty(gt)&&Z!=null&&!h.hasOwnProperty(gt))switch(gt){case"selected":s.selected=!1;break;default:qt(s,r,gt,null,h,Z)}for(F in h)if(Z=h[F],et=u[F],h.hasOwnProperty(F)&&Z!==et&&(Z!=null||et!=null))switch(F){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:qt(s,r,F,Z,h,et)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Tt in u)Z=u[Tt],u.hasOwnProperty(Tt)&&Z!=null&&!h.hasOwnProperty(Tt)&&qt(s,r,Tt,null,h,Z);for(W in h)if(Z=h[W],et=u[W],h.hasOwnProperty(W)&&Z!==et&&(Z!=null||et!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:qt(s,r,W,Z,h,et)}return;default:if(au(r)){for(var Yt in u)Z=u[Yt],u.hasOwnProperty(Yt)&&Z!==void 0&&!h.hasOwnProperty(Yt)&&Kc(s,r,Yt,void 0,h,Z);for(st in h)Z=h[st],et=u[st],!h.hasOwnProperty(st)||Z===et||Z===void 0&&et===void 0||Kc(s,r,st,Z,h,et);return}}for(var z in u)Z=u[z],u.hasOwnProperty(z)&&Z!=null&&!h.hasOwnProperty(z)&&qt(s,r,z,null,h,Z);for(ot in h)Z=h[ot],et=u[ot],!h.hasOwnProperty(ot)||Z===et||Z==null&&et==null||qt(s,r,ot,Z,h,et)}function ag(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tT(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var y=u[h],S=y.transferSize,L=y.initiatorType,D=y.duration;if(S&&D&&ag(L)){for(L=0,D=y.responseEnd,h+=1;h<u.length;h++){var F=u[h],W=F.startTime;if(W>D)break;var st=F.transferSize,ot=F.initiatorType;st&&ag(ot)&&(F=F.responseEnd,L+=st*(F<D?1:(D-W)/(F-W)))}if(--h,r+=8*(S+L)/(y.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var qc=null,Yc=null;function zl(s){return s.nodeType===9?s:s.ownerDocument}function lg(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function og(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Xc(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Qc=null;function eT(){var s=window.event;return s&&s.type==="popstate"?s===Qc?!1:(Qc=s,!0):(Qc=null,!1)}var ug=typeof setTimeout=="function"?setTimeout:void 0,iT=typeof clearTimeout=="function"?clearTimeout:void 0,cg=typeof Promise=="function"?Promise:void 0,sT=typeof queueMicrotask=="function"?queueMicrotask:typeof cg<"u"?function(s){return cg.resolve(null).then(s).catch(nT)}:ug;function nT(s){setTimeout(function(){throw s})}function js(s){return s==="head"}function fg(s,r){var u=r,h=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(h===0){s.removeChild(y),hr(r);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")ga(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,ga(u);for(var S=u.firstChild;S;){var L=S.nextSibling,D=S.nodeName;S[Mr]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=L}}else u==="body"&&ga(s.ownerDocument.body);u=y}while(u);hr(r)}function dg(s,r){var u=s;s=0;do{var h=u.nextSibling;if(u.nodeType===1?r?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(r?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=h}while(u)}function Wc(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var u=r;switch(r=r.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Wc(u),iu(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function rT(s,r,u,h){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[Mr])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(S=s.getAttribute("rel"),S==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(S!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(S=s.getAttribute("src"),(S!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&S&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var S=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===S)return s}else return s;if(s=bi(s.nextSibling),s===null)break}return null}function aT(s,r,u){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=bi(s.nextSibling),s===null))return null;return s}function hg(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=bi(s.nextSibling),s===null))return null;return s}function Zc(s){return s.data==="$?"||s.data==="$~"}function Jc(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function lT(s,r){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||u.readyState!=="loading")r();else{var h=function(){r(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function bi(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var tf=null;function mg(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(r===0)return bi(s.nextSibling);r--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||r++}s=s.nextSibling}return null}function pg(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(r===0)return s;r--}else u!=="/$"&&u!=="/&"||r++}s=s.previousSibling}return null}function gg(s,r,u){switch(r=zl(u),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function ga(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);iu(s)}var Ai=new Map,yg=new Set;function Vl(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ms=j.d;j.d={f:oT,r:uT,D:cT,C:fT,L:dT,m:hT,X:pT,S:mT,M:gT};function oT(){var s=ms.f(),r=Nl();return s||r}function uT(s){var r=kn(s);r!==null&&r.tag===5&&r.type==="form"?Mm(r):ms.r(s)}var cr=typeof document>"u"?null:document;function vg(s,r,u){var h=cr;if(h&&typeof r=="string"&&r){var y=gi(r);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),yg.has(y)||(yg.add(y),s={rel:s,crossOrigin:u,href:r},h.querySelector(y)===null&&(r=h.createElement("link"),Me(r,"link",s),Re(r),h.head.appendChild(r)))}}function cT(s){ms.D(s),vg("dns-prefetch",s,null)}function fT(s,r){ms.C(s,r),vg("preconnect",s,r)}function dT(s,r,u){ms.L(s,r,u);var h=cr;if(h&&s&&r){var y='link[rel="preload"][as="'+gi(r)+'"]';r==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+gi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+gi(u.imageSizes)+'"]')):y+='[href="'+gi(s)+'"]';var S=y;switch(r){case"style":S=fr(s);break;case"script":S=dr(s)}Ai.has(S)||(s=p({rel:"preload",href:r==="image"&&u&&u.imageSrcSet?void 0:s,as:r},u),Ai.set(S,s),h.querySelector(y)!==null||r==="style"&&h.querySelector(ya(S))||r==="script"&&h.querySelector(va(S))||(r=h.createElement("link"),Me(r,"link",s),Re(r),h.head.appendChild(r)))}}function hT(s,r){ms.m(s,r);var u=cr;if(u&&s){var h=r&&typeof r.as=="string"?r.as:"script",y='link[rel="modulepreload"][as="'+gi(h)+'"][href="'+gi(s)+'"]',S=y;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=dr(s)}if(!Ai.has(S)&&(s=p({rel:"modulepreload",href:s},r),Ai.set(S,s),u.querySelector(y)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(va(S)))return}h=u.createElement("link"),Me(h,"link",s),Re(h),u.head.appendChild(h)}}}function mT(s,r,u){ms.S(s,r,u);var h=cr;if(h&&s){var y=On(h).hoistableStyles,S=fr(s);r=r||"default";var L=y.get(S);if(!L){var D={loading:0,preload:null};if(L=h.querySelector(ya(S)))D.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":r},u),(u=Ai.get(S))&&ef(s,u);var F=L=h.createElement("link");Re(F),Me(F,"link",s),F._p=new Promise(function(W,st){F.onload=W,F.onerror=st}),F.addEventListener("load",function(){D.loading|=1}),F.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Kl(L,r,h)}L={type:"stylesheet",instance:L,count:1,state:D},y.set(S,L)}}}function pT(s,r){ms.X(s,r);var u=cr;if(u&&s){var h=On(u).hoistableScripts,y=dr(s),S=h.get(y);S||(S=u.querySelector(va(y)),S||(s=p({src:s,async:!0},r),(r=Ai.get(y))&&sf(s,r),S=u.createElement("script"),Re(S),Me(S,"link",s),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},h.set(y,S))}}function gT(s,r){ms.M(s,r);var u=cr;if(u&&s){var h=On(u).hoistableScripts,y=dr(s),S=h.get(y);S||(S=u.querySelector(va(y)),S||(s=p({src:s,async:!0,type:"module"},r),(r=Ai.get(y))&&sf(s,r),S=u.createElement("script"),Re(S),Me(S,"link",s),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},h.set(y,S))}}function Eg(s,r,u,h){var y=(y=dt.current)?Vl(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(r=fr(u.href),u=On(y).hoistableStyles,h=u.get(r),h||(h={type:"style",instance:null,count:0,state:null},u.set(r,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=fr(u.href);var S=On(y).hoistableStyles,L=S.get(s);if(L||(y=y.ownerDocument||y,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(s,L),(S=y.querySelector(ya(s)))&&!S._p&&(L.instance=S,L.state.loading=5),Ai.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ai.set(s,u),S||yT(y,s,u,L.state))),r&&h===null)throw Error(i(528,""));return L}if(r&&h!==null)throw Error(i(529,""));return null;case"script":return r=u.async,u=u.src,typeof u=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=dr(u),u=On(y).hoistableScripts,h=u.get(r),h||(h={type:"script",instance:null,count:0,state:null},u.set(r,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function fr(s){return'href="'+gi(s)+'"'}function ya(s){return'link[rel="stylesheet"]['+s+"]"}function Sg(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function yT(s,r,u,h){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?h.loading=1:(r=s.createElement("link"),h.preload=r,r.addEventListener("load",function(){return h.loading|=1}),r.addEventListener("error",function(){return h.loading|=2}),Me(r,"link",u),Re(r),s.head.appendChild(r))}function dr(s){return'[src="'+gi(s)+'"]'}function va(s){return"script[async]"+s}function Tg(s,r,u){if(r.count++,r.instance===null)switch(r.type){case"style":var h=s.querySelector('style[data-href~="'+gi(u.href)+'"]');if(h)return r.instance=h,Re(h),h;var y=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),Re(h),Me(h,"style",y),Kl(h,u.precedence,s),r.instance=h;case"stylesheet":y=fr(u.href);var S=s.querySelector(ya(y));if(S)return r.state.loading|=4,r.instance=S,Re(S),S;h=Sg(u),(y=Ai.get(y))&&ef(h,y),S=(s.ownerDocument||s).createElement("link"),Re(S);var L=S;return L._p=new Promise(function(D,F){L.onload=D,L.onerror=F}),Me(S,"link",h),r.state.loading|=4,Kl(S,u.precedence,s),r.instance=S;case"script":return S=dr(u.src),(y=s.querySelector(va(S)))?(r.instance=y,Re(y),y):(h=u,(y=Ai.get(S))&&(h=p({},u),sf(h,y)),s=s.ownerDocument||s,y=s.createElement("script"),Re(y),Me(y,"link",h),s.head.appendChild(y),r.instance=y);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(h=r.instance,r.state.loading|=4,Kl(h,u.precedence,s));return r.instance}function Kl(s,r,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=h.length?h[h.length-1]:null,S=y,L=0;L<h.length;L++){var D=h[L];if(D.dataset.precedence===r)S=D;else if(S!==y)break}S?S.parentNode.insertBefore(s,S.nextSibling):(r=u.nodeType===9?u.head:u,r.insertBefore(s,r.firstChild))}function ef(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function sf(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var ql=null;function xg(s,r,u){if(ql===null){var h=new Map,y=ql=new Map;y.set(u,h)}else y=ql,h=y.get(u),h||(h=new Map,y.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var S=u[y];if(!(S[Mr]||S[Ce]||s==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var L=S.getAttribute(r)||"";L=s+L;var D=h.get(L);D?D.push(S):h.set(L,[S])}}return h}function bg(s,r,u){s=s.ownerDocument||s,s.head.insertBefore(u,r==="title"?s.querySelector("head > title"):null)}function vT(s,r,u){if(u===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Ag(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function ET(s,r,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=fr(h.href),S=r.querySelector(ya(y));if(S){r=S._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Yl.bind(s),r.then(s,s)),u.state.loading|=4,u.instance=S,Re(S);return}S=r.ownerDocument||r,h=Sg(h),(y=Ai.get(y))&&ef(h,y),S=S.createElement("link"),Re(S);var L=S;L._p=new Promise(function(D,F){L.onload=D,L.onerror=F}),Me(S,"link",h),u.instance=S}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,r),(r=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=Yl.bind(s),r.addEventListener("load",u),r.addEventListener("error",u))}}var nf=0;function ST(s,r){return s.stylesheets&&s.count===0&&Ql(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var h=setTimeout(function(){if(s.stylesheets&&Ql(s,s.stylesheets),s.unsuspend){var S=s.unsuspend;s.unsuspend=null,S()}},6e4+r);0<s.imgBytes&&nf===0&&(nf=62500*tT());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Ql(s,s.stylesheets),s.unsuspend)){var S=s.unsuspend;s.unsuspend=null,S()}},(s.imgBytes>nf?50:800)+r);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(y)}}:null}function Yl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ql(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Xl=null;function Ql(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Xl=new Map,r.forEach(TT,s),Xl=null,Yl.call(s))}function TT(s,r){if(!(r.state.loading&4)){var u=Xl.get(s);if(u)var h=u.get(null);else{u=new Map,Xl.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<y.length;S++){var L=y[S];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(u.set(L.dataset.precedence,L),h=L)}h&&u.set(null,h)}y=r.instance,L=y.getAttribute("data-precedence"),S=u.get(L)||h,S===h&&u.set(null,y),u.set(L,y),this.count++,h=Yl.bind(this),y.addEventListener("load",h),y.addEventListener("error",h),S?S.parentNode.insertBefore(y,S.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),r.state.loading|=4}}var Ea={$$typeof:_,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function xT(s,r,u,h,y,S,L,D,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zo(0),this.hiddenUpdates=Zo(null),this.identifierPrefix=h,this.onUncaughtError=y,this.onCaughtError=S,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function Lg(s,r,u,h,y,S,L,D,F,W,st,ot){return s=new xT(s,r,u,L,F,W,st,ot,D),r=1,S===!0&&(r|=24),S=si(3,null,null,r),s.current=S,S.stateNode=s,r=Nu(),r.refCount++,s.pooledCache=r,r.refCount++,S.memoizedState={element:h,isDehydrated:u,cache:r},$u(S),s}function Rg(s){return s?(s=Hn,s):Hn}function _g(s,r,u,h,y,S){y=Rg(y),h.context===null?h.context=y:h.pendingContext=y,h=Cs(r),h.payload={element:u},S=S===void 0?null:S,S!==null&&(h.callback=S),u=ws(s,h,r),u!==null&&(Je(u,s,r),Wr(u,s,r))}function Ig(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<r?u:r}}function rf(s,r){Ig(s,r),(s=s.alternate)&&Ig(s,r)}function Dg(s){if(s.tag===13||s.tag===31){var r=on(s,67108864);r!==null&&Je(r,s,67108864),rf(s,67108864)}}function Cg(s){if(s.tag===13||s.tag===31){var r=oi();r=Jo(r);var u=on(s,r);u!==null&&Je(u,s,r),rf(s,r)}}var Wl=!0;function bT(s,r,u,h){var y=O.T;O.T=null;var S=j.p;try{j.p=2,af(s,r,u,h)}finally{j.p=S,O.T=y}}function AT(s,r,u,h){var y=O.T;O.T=null;var S=j.p;try{j.p=8,af(s,r,u,h)}finally{j.p=S,O.T=y}}function af(s,r,u,h){if(Wl){var y=lf(h);if(y===null)Vc(s,r,h,Zl,u),kg(s,h);else if(RT(y,s,r,u,h))h.stopPropagation();else if(kg(s,h),r&4&&-1<LT.indexOf(s)){for(;y!==null;){var S=kn(y);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var L=sn(S.pendingLanes);if(L!==0){var D=S;for(D.pendingLanes|=2,D.entangledLanes|=2;L;){var F=1<<31-Ge(L);D.entanglements[1]|=F,L&=~F}Bi(S),(jt&6)===0&&(Ml=ee()+500,ha(0))}}break;case 31:case 13:D=on(S,2),D!==null&&Je(D,S,2),Nl(),rf(S,2)}if(S=lf(h),S===null&&Vc(s,r,h,Zl,u),S===y)break;y=S}y!==null&&h.stopPropagation()}else Vc(s,r,h,null,u)}}function lf(s){return s=ou(s),of(s)}var Zl=null;function of(s){if(Zl=null,s=wn(s),s!==null){var r=a(s);if(r===null)s=null;else{var u=r.tag;if(u===13){if(s=o(r),s!==null)return s;s=null}else if(u===31){if(s=c(r),s!==null)return s;s=null}else if(u===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Zl=s,null}function wg(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xi()){case Ke:return 2;case Js:return 8;case xs:case Dn:return 32;case tn:return 268435456;default:return 32}default:return 32}}var uf=!1,Gs=null,Hs=null,zs=null,Sa=new Map,Ta=new Map,Vs=[],LT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function kg(s,r){switch(s){case"focusin":case"focusout":Gs=null;break;case"dragenter":case"dragleave":Hs=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":Sa.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ta.delete(r.pointerId)}}function xa(s,r,u,h,y,S){return s===null||s.nativeEvent!==S?(s={blockedOn:r,domEventName:u,eventSystemFlags:h,nativeEvent:S,targetContainers:[y]},r!==null&&(r=kn(r),r!==null&&Dg(r)),s):(s.eventSystemFlags|=h,r=s.targetContainers,y!==null&&r.indexOf(y)===-1&&r.push(y),s)}function RT(s,r,u,h,y){switch(r){case"focusin":return Gs=xa(Gs,s,r,u,h,y),!0;case"dragenter":return Hs=xa(Hs,s,r,u,h,y),!0;case"mouseover":return zs=xa(zs,s,r,u,h,y),!0;case"pointerover":var S=y.pointerId;return Sa.set(S,xa(Sa.get(S)||null,s,r,u,h,y)),!0;case"gotpointercapture":return S=y.pointerId,Ta.set(S,xa(Ta.get(S)||null,s,r,u,h,y)),!0}return!1}function Og(s){var r=wn(s.target);if(r!==null){var u=a(r);if(u!==null){if(r=u.tag,r===13){if(r=o(u),r!==null){s.blockedOn=r,qd(s.priority,function(){Cg(u)});return}}else if(r===31){if(r=c(u),r!==null){s.blockedOn=r,qd(s.priority,function(){Cg(u)});return}}else if(r===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Jl(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var u=lf(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);lu=h,u.target.dispatchEvent(h),lu=null}else return r=kn(u),r!==null&&Dg(r),s.blockedOn=u,!1;r.shift()}return!0}function Mg(s,r,u){Jl(s)&&u.delete(r)}function _T(){uf=!1,Gs!==null&&Jl(Gs)&&(Gs=null),Hs!==null&&Jl(Hs)&&(Hs=null),zs!==null&&Jl(zs)&&(zs=null),Sa.forEach(Mg),Ta.forEach(Mg)}function to(s,r){s.blockedOn===r&&(s.blockedOn=null,uf||(uf=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,_T)))}var eo=null;function Pg(s){eo!==s&&(eo=s,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){eo===s&&(eo=null);for(var r=0;r<s.length;r+=3){var u=s[r],h=s[r+1],y=s[r+2];if(typeof h!="function"){if(of(h||u)===null)continue;break}var S=kn(u);S!==null&&(s.splice(r,3),r-=3,ac(S,{pending:!0,data:y,method:u.method,action:h},h,y))}}))}function hr(s){function r(F){return to(F,s)}Gs!==null&&to(Gs,s),Hs!==null&&to(Hs,s),zs!==null&&to(zs,s),Sa.forEach(r),Ta.forEach(r);for(var u=0;u<Vs.length;u++){var h=Vs[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Vs.length&&(u=Vs[0],u.blockedOn===null);)Og(u),u.blockedOn===null&&Vs.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var y=u[h],S=u[h+1],L=y[qe]||null;if(typeof S=="function")L||Pg(u);else if(L){var D=null;if(S&&S.hasAttribute("formAction")){if(y=S,L=S[qe]||null)D=L.formAction;else if(of(y)!==null)continue}else D=L.action;typeof D=="function"?u[h+1]=D:(u.splice(h,3),h-=3),Pg(u)}}}function Ng(){function s(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(L){return y=L})},focusReset:"manual",scroll:"manual"})}function r(){y!==null&&(y(),y=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),y!==null&&(y(),y=null)}}}function cf(s){this._internalRoot=s}io.prototype.render=cf.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var u=r.current,h=oi();_g(u,h,s,r,null,null)},io.prototype.unmount=cf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;_g(s.current,2,null,s,null,null),Nl(),r[Cn]=null}};function io(s){this._internalRoot=s}io.prototype.unstable_scheduleHydration=function(s){if(s){var r=Kd();s={blockedOn:null,target:s,priority:r};for(var u=0;u<Vs.length&&r!==0&&r<Vs[u].priority;u++);Vs.splice(u,0,s),u===0&&Og(s)}};var Bg=t.version;if(Bg!=="19.2.0")throw Error(i(527,Bg,"19.2.0"));j.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(r),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var IT={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var so=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!so.isDisabled&&so.supportsFiber)try{en=so.inject(IT),je=so}catch{}}return Aa.createRoot=function(s,r){if(!n(s))throw Error(i(299));var u=!1,h="",y=zm,S=Vm,L=Km;return r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(S=r.onCaughtError),r.onRecoverableError!==void 0&&(L=r.onRecoverableError)),r=Lg(s,1,!1,null,null,u,h,null,y,S,L,Ng),s[Cn]=r.current,zc(s),new cf(r)},Aa.hydrateRoot=function(s,r,u){if(!n(s))throw Error(i(299));var h=!1,y="",S=zm,L=Vm,D=Km,F=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(L=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(F=u.formState)),r=Lg(s,1,!0,r,u??null,h,y,F,S,L,D,Ng),r.context=Rg(null),u=r.current,h=oi(),h=Jo(h),y=Cs(h),y.callback=null,ws(u,y,h),u=h,r.current.lanes=u,Or(r,u),Bi(r),s[Cn]=r.current,zc(s),new io(r)},Aa.version="19.2.0",Aa}var qg;function $T(){if(qg)return hf.exports;qg=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),hf.exports=UT(),hf.exports}var jT=$T();function GT({children:l}){return l}/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Yg="popstate";function HT(l={}){function t(i,n){let{pathname:a,search:o,hash:c}=i.location;return Vf("",{pathname:a,search:o,hash:c},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function e(i,n){return typeof n=="string"?n:wa(n)}return VT(t,e,null,l)}function re(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}function zi(l,t){if(!l){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function zT(){return Math.random().toString(36).substring(2,10)}function Xg(l,t){return{usr:l.state,key:l.key,idx:t}}function Vf(l,t,e=null,i){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof t=="string"?Dr(t):t,state:e,key:t&&t.key||i||zT()}}function wa({pathname:l="/",search:t="",hash:e=""}){return t&&t!=="?"&&(l+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(l+=e.charAt(0)==="#"?e:"#"+e),l}function Dr(l){let t={};if(l){let e=l.indexOf("#");e>=0&&(t.hash=l.substring(e),l=l.substring(0,e));let i=l.indexOf("?");i>=0&&(t.search=l.substring(i),l=l.substring(0,i)),l&&(t.pathname=l)}return t}function VT(l,t,e,i={}){let{window:n=document.defaultView,v5Compat:a=!1}=i,o=n.history,c="POP",d=null,f=m();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function m(){return(o.state||{idx:null}).idx}function p(){c="POP";let T=m(),A=T==null?null:T-f;f=T,d&&d({action:c,location:x.location,delta:A})}function g(T,A){c="PUSH";let b=Vf(x.location,T,A);f=m()+1;let _=Xg(b,f),I=x.createHref(b);try{o.pushState(_,"",I)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;n.location.assign(I)}a&&d&&d({action:c,location:x.location,delta:1})}function v(T,A){c="REPLACE";let b=Vf(x.location,T,A);f=m();let _=Xg(b,f),I=x.createHref(b);o.replaceState(_,"",I),a&&d&&d({action:c,location:x.location,delta:0})}function E(T){return KT(T)}let x={get action(){return c},get location(){return l(n,o)},listen(T){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(Yg,p),d=T,()=>{n.removeEventListener(Yg,p),d=null}},createHref(T){return t(n,T)},createURL:E,encodeLocation(T){let A=E(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:g,replace:v,go(T){return o.go(T)}};return x}function KT(l,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),re(e,"No window.location.(origin|href) available to create URL");let i=typeof l=="string"?l:wa(l);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function Sy(l,t,e="/"){return qT(l,t,e,!1)}function qT(l,t,e,i){let n=typeof t=="string"?Dr(t):t,a=Ts(n.pathname||"/",e);if(a==null)return null;let o=Ty(l);YT(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let f=rx(a);c=sx(o[d],f,i)}return c}function Ty(l,t=[],e=[],i="",n=!1){let a=(o,c,d=n,f)=>{let m={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(i)&&d)return;re(m.relativePath.startsWith(i),`Absolute route path "${m.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(i.length)}let p=Ss([i,m.relativePath]),g=e.concat(m);o.children&&o.children.length>0&&(re(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Ty(o.children,t,g,p,d)),!(o.path==null&&!o.index)&&t.push({path:p,score:ex(p,o.index),routesMeta:g})};return l.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let d of xy(o.path))a(o,c,!0,d)}),t}function xy(l){let t=l.split("/");if(t.length===0)return[];let[e,...i]=t,n=e.endsWith("?"),a=e.replace(/\?$/,"");if(i.length===0)return n?[a,""]:[a];let o=xy(i.join("/")),c=[];return c.push(...o.map(d=>d===""?a:[a,d].join("/"))),n&&c.push(...o),c.map(d=>l.startsWith("/")&&d===""?"/":d)}function YT(l){l.sort((t,e)=>t.score!==e.score?e.score-t.score:ix(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var XT=/^:[\w-]+$/,QT=3,WT=2,ZT=1,JT=10,tx=-2,Qg=l=>l==="*";function ex(l,t){let e=l.split("/"),i=e.length;return e.some(Qg)&&(i+=tx),t&&(i+=WT),e.filter(n=>!Qg(n)).reduce((n,a)=>n+(XT.test(a)?QT:a===""?ZT:JT),i)}function ix(l,t){return l.length===t.length&&l.slice(0,-1).every((i,n)=>i===t[n])?l[l.length-1]-t[t.length-1]:0}function sx(l,t,e=!1){let{routesMeta:i}=l,n={},a="/",o=[];for(let c=0;c<i.length;++c){let d=i[c],f=c===i.length-1,m=a==="/"?t:t.slice(a.length)||"/",p=ko({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),g=d.route;if(!p&&f&&e&&!i[i.length-1].route.index&&(p=ko({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!p)return null;Object.assign(n,p.params),o.push({params:n,pathname:Ss([a,p.pathname]),pathnameBase:ux(Ss([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=Ss([a,p.pathnameBase]))}return o}function ko(l,t){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[e,i]=nx(l.path,l.caseSensitive,l.end),n=t.match(e);if(!n)return null;let a=n[0],o=a.replace(/(.)\/+$/,"$1"),c=n.slice(1);return{params:i.reduce((f,{paramName:m,isOptional:p},g)=>{if(m==="*"){let E=c[g]||"";o=a.slice(0,a.length-E.length).replace(/(.)\/+$/,"$1")}const v=c[g];return p&&!v?f[m]=void 0:f[m]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:o,pattern:l}}function nx(l,t=!1,e=!0){zi(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let i=[],n="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(i.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return l.endsWith("*")?(i.push({paramName:"*"}),n+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?n+="\\/*$":l!==""&&l!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function rx(l){try{return l.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return zi(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),l}}function Ts(l,t){if(t==="/")return l;if(!l.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=l.charAt(e);return i&&i!=="/"?null:l.slice(e)||"/"}function ax(l,t="/"){let{pathname:e,search:i="",hash:n=""}=typeof l=="string"?Dr(l):l;return{pathname:e?e.startsWith("/")?e:lx(e,t):t,search:cx(i),hash:fx(n)}}function lx(l,t){let e=t.replace(/\/+$/,"").split("/");return l.split("/").forEach(n=>{n===".."?e.length>1&&e.pop():n!=="."&&e.push(n)}),e.length>1?e.join("/"):"/"}function yf(l,t,e,i){return`Cannot include a '${l}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ox(l){return l.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function by(l){let t=ox(l);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function Ay(l,t,e,i=!1){let n;typeof l=="string"?n=Dr(l):(n={...l},re(!n.pathname||!n.pathname.includes("?"),yf("?","pathname","search",n)),re(!n.pathname||!n.pathname.includes("#"),yf("#","pathname","hash",n)),re(!n.search||!n.search.includes("#"),yf("#","search","hash",n)));let a=l===""||n.pathname==="",o=a?"/":n.pathname,c;if(o==null)c=e;else{let p=t.length-1;if(!i&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;n.pathname=g.join("/")}c=p>=0?t[p]:"/"}let d=ax(n,c),f=o&&o!=="/"&&o.endsWith("/"),m=(a||o===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}var Ss=l=>l.join("/").replace(/\/\/+/g,"/"),ux=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),cx=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,fx=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function dx(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}var Ly=["POST","PUT","PATCH","DELETE"];new Set(Ly);var hx=["GET",...Ly];new Set(hx);var Cr=J.createContext(null);Cr.displayName="DataRouter";var zo=J.createContext(null);zo.displayName="DataRouterState";J.createContext(!1);var Ry=J.createContext({isTransitioning:!1});Ry.displayName="ViewTransition";var mx=J.createContext(new Map);mx.displayName="Fetchers";var px=J.createContext(null);px.displayName="Await";var qi=J.createContext(null);qi.displayName="Navigation";var Ua=J.createContext(null);Ua.displayName="Location";var Yi=J.createContext({outlet:null,matches:[],isDataRoute:!1});Yi.displayName="Route";var hd=J.createContext(null);hd.displayName="RouteError";function gx(l,{relative:t}={}){re($a(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=J.useContext(qi),{hash:n,pathname:a,search:o}=ja(l,{relative:t}),c=a;return e!=="/"&&(c=a==="/"?e:Ss([e,a])),i.createHref({pathname:c,search:o,hash:n})}function $a(){return J.useContext(Ua)!=null}function In(){return re($a(),"useLocation() may be used only in the context of a <Router> component."),J.useContext(Ua).location}var _y="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Iy(l){J.useContext(qi).static||J.useLayoutEffect(l)}function yx(){let{isDataRoute:l}=J.useContext(Yi);return l?wx():vx()}function vx(){re($a(),"useNavigate() may be used only in the context of a <Router> component.");let l=J.useContext(Cr),{basename:t,navigator:e}=J.useContext(qi),{matches:i}=J.useContext(Yi),{pathname:n}=In(),a=JSON.stringify(by(i)),o=J.useRef(!1);return Iy(()=>{o.current=!0}),J.useCallback((d,f={})=>{if(zi(o.current,_y),!o.current)return;if(typeof d=="number"){e.go(d);return}let m=Ay(d,JSON.parse(a),n,f.relative==="path");l==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Ss([t,m.pathname])),(f.replace?e.replace:e.push)(m,f.state,f)},[t,e,a,n,l])}J.createContext(null);function Ex(){let{matches:l}=J.useContext(Yi),t=l[l.length-1];return t?t.params:{}}function ja(l,{relative:t}={}){let{matches:e}=J.useContext(Yi),{pathname:i}=In(),n=JSON.stringify(by(e));return J.useMemo(()=>Ay(l,JSON.parse(n),i,t==="path"),[l,n,i,t])}function Sx(l,t){return Dy(l,t)}function Dy(l,t,e,i,n){re($a(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=J.useContext(qi),{matches:o}=J.useContext(Yi),c=o[o.length-1],d=c?c.params:{},f=c?c.pathname:"/",m=c?c.pathnameBase:"/",p=c&&c.route;{let b=p&&p.path||"";Cy(f,!p||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let g=In(),v;if(t){let b=typeof t=="string"?Dr(t):t;re(m==="/"||b.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${b.pathname}" was given in the \`location\` prop.`),v=b}else v=g;let E=v.pathname||"/",x=E;if(m!=="/"){let b=m.replace(/^\//,"").split("/");x="/"+E.replace(/^\//,"").split("/").slice(b.length).join("/")}let T=Sy(l,{pathname:x});zi(p||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),zi(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=Lx(T&&T.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:Ss([m,a.encodeLocation?a.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?m:Ss([m,a.encodeLocation?a.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),o,e,i,n);return t&&A?J.createElement(Ua.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},A):A}function Tx(){let l=Cx(),t=dx(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),e=l instanceof Error?l.stack:null,i="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",l),o=J.createElement(J.Fragment,null,J.createElement("p",null," Hey developer "),J.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",J.createElement("code",{style:a},"ErrorBoundary")," or"," ",J.createElement("code",{style:a},"errorElement")," prop on your route.")),J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},t),e?J.createElement("pre",{style:n},e):null,o)}var xx=J.createElement(Tx,null),bx=class extends J.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,t){return t.location!==l.location||t.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:t.error,location:t.location,revalidation:l.revalidation||t.revalidation}}componentDidCatch(l,t){this.props.unstable_onError?this.props.unstable_onError(l,t):console.error("React Router caught the following error during render",l)}render(){return this.state.error!==void 0?J.createElement(Yi.Provider,{value:this.props.routeContext},J.createElement(hd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ax({routeContext:l,match:t,children:e}){let i=J.useContext(Cr);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),J.createElement(Yi.Provider,{value:l},e)}function Lx(l,t=[],e=null,i=null,n=null){if(l==null){if(!e)return null;if(e.errors)l=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)l=e.matches;else return null}let a=l,o=e?.errors;if(o!=null){let f=a.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);re(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let c=!1,d=-1;if(e)for(let f=0;f<a.length;f++){let m=a[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:p,errors:g}=e,v=m.route.loader&&!p.hasOwnProperty(m.route.id)&&(!g||g[m.route.id]===void 0);if(m.route.lazy||v){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,m,p)=>{let g,v=!1,E=null,x=null;e&&(g=o&&m.route.id?o[m.route.id]:void 0,E=m.route.errorElement||xx,c&&(d<0&&p===0?(Cy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,x=null):d===p&&(v=!0,x=m.route.hydrateFallbackElement||null)));let T=t.concat(a.slice(0,p+1)),A=()=>{let b;return g?b=E:v?b=x:m.route.Component?b=J.createElement(m.route.Component,null):m.route.element?b=m.route.element:b=f,J.createElement(Ax,{match:m,routeContext:{outlet:f,matches:T,isDataRoute:e!=null},children:b})};return e&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?J.createElement(bx,{location:e.location,revalidation:e.revalidation,component:E,error:g,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:i}):A()},null)}function md(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rx(l){let t=J.useContext(Cr);return re(t,md(l)),t}function _x(l){let t=J.useContext(zo);return re(t,md(l)),t}function Ix(l){let t=J.useContext(Yi);return re(t,md(l)),t}function pd(l){let t=Ix(l),e=t.matches[t.matches.length-1];return re(e.route.id,`${l} can only be used on routes that contain a unique "id"`),e.route.id}function Dx(){return pd("useRouteId")}function Cx(){let l=J.useContext(hd),t=_x("useRouteError"),e=pd("useRouteError");return l!==void 0?l:t.errors?.[e]}function wx(){let{router:l}=Rx("useNavigate"),t=pd("useNavigate"),e=J.useRef(!1);return Iy(()=>{e.current=!0}),J.useCallback(async(n,a={})=>{zi(e.current,_y),e.current&&(typeof n=="number"?l.navigate(n):await l.navigate(n,{fromRouteId:t,...a}))},[l,t])}var Wg={};function Cy(l,t,e){!t&&!Wg[l]&&(Wg[l]=!0,zi(!1,e))}J.memo(kx);function kx({routes:l,future:t,state:e,unstable_onError:i}){return Dy(l,void 0,e,i,t)}function wy(l){re(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ox({basename:l="/",children:t=null,location:e,navigationType:i="POP",navigator:n,static:a=!1}){re(!$a(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=l.replace(/^\/*/,"/"),c=J.useMemo(()=>({basename:o,navigator:n,static:a,future:{}}),[o,n,a]);typeof e=="string"&&(e=Dr(e));let{pathname:d="/",search:f="",hash:m="",state:p=null,key:g="default"}=e,v=J.useMemo(()=>{let E=Ts(d,o);return E==null?null:{location:{pathname:E,search:f,hash:m,state:p,key:g},navigationType:i}},[o,d,f,m,p,g,i]);return zi(v!=null,`<Router basename="${o}"> is not able to match the URL "${d}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:J.createElement(qi.Provider,{value:c},J.createElement(Ua.Provider,{children:t,value:v}))}function Mx({children:l,location:t}){return Sx(Kf(l),t)}function Kf(l,t=[]){let e=[];return J.Children.forEach(l,(i,n)=>{if(!J.isValidElement(i))return;let a=[...t,n];if(i.type===J.Fragment){e.push.apply(e,Kf(i.props.children,a));return}re(i.type===wy,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),re(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=Kf(i.props.children,a)),e.push(o)}),e}var xo="get",bo="application/x-www-form-urlencoded";function Vo(l){return l!=null&&typeof l.tagName=="string"}function Px(l){return Vo(l)&&l.tagName.toLowerCase()==="button"}function Nx(l){return Vo(l)&&l.tagName.toLowerCase()==="form"}function Bx(l){return Vo(l)&&l.tagName.toLowerCase()==="input"}function Fx(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function Ux(l,t){return l.button===0&&(!t||t==="_self")&&!Fx(l)}var no=null;function $x(){if(no===null)try{new FormData(document.createElement("form"),0),no=!1}catch{no=!0}return no}var jx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vf(l){return l!=null&&!jx.has(l)?(zi(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${bo}"`),null):l}function Gx(l,t){let e,i,n,a,o;if(Nx(l)){let c=l.getAttribute("action");i=c?Ts(c,t):null,e=l.getAttribute("method")||xo,n=vf(l.getAttribute("enctype"))||bo,a=new FormData(l)}else if(Px(l)||Bx(l)&&(l.type==="submit"||l.type==="image")){let c=l.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=l.getAttribute("formaction")||c.getAttribute("action");if(i=d?Ts(d,t):null,e=l.getAttribute("formmethod")||c.getAttribute("method")||xo,n=vf(l.getAttribute("formenctype"))||vf(c.getAttribute("enctype"))||bo,a=new FormData(c,l),!$x()){let{name:f,type:m,value:p}=l;if(m==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,p)}}else{if(Vo(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=xo,i=null,n=bo,o=l}return a&&n==="text/plain"&&(o=a,a=void 0),{action:i,method:e.toLowerCase(),encType:n,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function gd(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}function Hx(l,t,e){let i=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return i.pathname==="/"?i.pathname=`_root.${e}`:t&&Ts(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${e}`,i}async function zx(l,t){if(l.id in t)return t[l.id];try{let e=await import(l.module);return t[l.id]=e,e}catch(e){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Vx(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function Kx(l,t,e){let i=await Promise.all(l.map(async n=>{let a=t.routes[n.route.id];if(a){let o=await zx(a,e);return o.links?o.links():[]}return[]}));return Qx(i.flat(1).filter(Vx).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function Zg(l,t,e,i,n,a){let o=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,c=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return a==="assets"?t.filter((d,f)=>o(d,f)||c(d,f)):a==="data"?t.filter((d,f)=>{let m=i.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(o(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function qx(l,t,{includeHydrateFallback:e}={}){return Yx(l.map(i=>{let n=t.routes[i.route.id];if(!n)return[];let a=[n.module];return n.clientActionModule&&(a=a.concat(n.clientActionModule)),n.clientLoaderModule&&(a=a.concat(n.clientLoaderModule)),e&&n.hydrateFallbackModule&&(a=a.concat(n.hydrateFallbackModule)),n.imports&&(a=a.concat(n.imports)),a}).flat(1))}function Yx(l){return[...new Set(l)]}function Xx(l){let t={},e=Object.keys(l).sort();for(let i of e)t[i]=l[i];return t}function Qx(l,t){let e=new Set;return new Set(t),l.reduce((i,n)=>{let a=JSON.stringify(Xx(n));return e.has(a)||(e.add(a),i.push({key:a,link:n})),i},[])}function ky(){let l=J.useContext(Cr);return gd(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function Wx(){let l=J.useContext(zo);return gd(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var yd=J.createContext(void 0);yd.displayName="FrameworkContext";function Oy(){let l=J.useContext(yd);return gd(l,"You must render this element inside a <HydratedRouter> element"),l}function Zx(l,t){let e=J.useContext(yd),[i,n]=J.useState(!1),[a,o]=J.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:m,onTouchStart:p}=t,g=J.useRef(null);J.useEffect(()=>{if(l==="render"&&o(!0),l==="viewport"){let x=A=>{A.forEach(b=>{o(b.isIntersecting)})},T=new IntersectionObserver(x,{threshold:.5});return g.current&&T.observe(g.current),()=>{T.disconnect()}}},[l]),J.useEffect(()=>{if(i){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[i]);let v=()=>{n(!0)},E=()=>{n(!1),o(!1)};return e?l!=="intent"?[a,g,{}]:[a,g,{onFocus:La(c,v),onBlur:La(d,E),onMouseEnter:La(f,v),onMouseLeave:La(m,E),onTouchStart:La(p,v)}]:[!1,g,{}]}function La(l,t){return e=>{l&&l(e),e.defaultPrevented||t(e)}}function Jx({page:l,...t}){let{router:e}=ky(),i=J.useMemo(()=>Sy(e.routes,l,e.basename),[e.routes,l,e.basename]);return i?J.createElement(e1,{page:l,matches:i,...t}):null}function t1(l){let{manifest:t,routeModules:e}=Oy(),[i,n]=J.useState([]);return J.useEffect(()=>{let a=!1;return Kx(l,t,e).then(o=>{a||n(o)}),()=>{a=!0}},[l,t,e]),i}function e1({page:l,matches:t,...e}){let i=In(),{manifest:n,routeModules:a}=Oy(),{basename:o}=ky(),{loaderData:c,matches:d}=Wx(),f=J.useMemo(()=>Zg(l,t,d,n,i,"data"),[l,t,d,n,i]),m=J.useMemo(()=>Zg(l,t,d,n,i,"assets"),[l,t,d,n,i]),p=J.useMemo(()=>{if(l===i.pathname+i.search+i.hash)return[];let E=new Set,x=!1;if(t.forEach(A=>{let b=n.routes[A.route.id];!b||!b.hasLoader||(!f.some(_=>_.route.id===A.route.id)&&A.route.id in c&&a[A.route.id]?.shouldRevalidate||b.hasClientLoader?x=!0:E.add(A.route.id))}),E.size===0)return[];let T=Hx(l,o,"data");return x&&E.size>0&&T.searchParams.set("_routes",t.filter(A=>E.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[o,c,i,n,f,t,l,a]),g=J.useMemo(()=>qx(m,n),[m,n]),v=t1(m);return J.createElement(J.Fragment,null,p.map(E=>J.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...e})),g.map(E=>J.createElement("link",{key:E,rel:"modulepreload",href:E,...e})),v.map(({key:E,link:x})=>J.createElement("link",{key:E,nonce:e.nonce,...x})))}function i1(...l){return t=>{l.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var My=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{My&&(window.__reactRouterVersion="7.9.4")}catch{}function s1({basename:l,children:t,window:e}){let i=J.useRef();i.current==null&&(i.current=HT({window:e,v5Compat:!0}));let n=i.current,[a,o]=J.useState({action:n.action,location:n.location}),c=J.useCallback(d=>{J.startTransition(()=>o(d))},[o]);return J.useLayoutEffect(()=>n.listen(c),[n,c]),J.createElement(Ox,{basename:l,children:t,location:a.location,navigationType:a.action,navigator:n})}var Py=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tr=J.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:n,reloadDocument:a,replace:o,state:c,target:d,to:f,preventScrollReset:m,viewTransition:p,...g},v){let{basename:E}=J.useContext(qi),x=typeof f=="string"&&Py.test(f),T,A=!1;if(typeof f=="string"&&x&&(T=f,My))try{let B=new URL(window.location.href),M=f.startsWith("//")?new URL(B.protocol+f):new URL(f),K=Ts(M.pathname,E);M.origin===B.origin&&K!=null?f=K+M.search+M.hash:A=!0}catch{zi(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=gx(f,{relative:n}),[_,I,C]=Zx(i,g),N=l1(f,{replace:o,state:c,target:d,preventScrollReset:m,relative:n,viewTransition:p});function w(B){t&&t(B),B.defaultPrevented||N(B)}let P=J.createElement("a",{...g,...C,href:T||b,onClick:A||a?t:w,ref:i1(v,I),target:d,"data-discover":!x&&e==="render"?"true":void 0});return _&&!x?J.createElement(J.Fragment,null,P,J.createElement(Jx,{page:b})):P});Tr.displayName="Link";var n1=J.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:n=!1,style:a,to:o,viewTransition:c,children:d,...f},m){let p=ja(o,{relative:f.relative}),g=In(),v=J.useContext(zo),{navigator:E,basename:x}=J.useContext(qi),T=v!=null&&d1(p)&&c===!0,A=E.encodeLocation?E.encodeLocation(p).pathname:p.pathname,b=g.pathname,_=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(b=b.toLowerCase(),_=_?_.toLowerCase():null,A=A.toLowerCase()),_&&x&&(_=Ts(_,x)||_);const I=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let C=b===A||!n&&b.startsWith(A)&&b.charAt(I)==="/",N=_!=null&&(_===A||!n&&_.startsWith(A)&&_.charAt(A.length)==="/"),w={isActive:C,isPending:N,isTransitioning:T},P=C?t:void 0,B;typeof i=="function"?B=i(w):B=[i,C?"active":null,N?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(w):a;return J.createElement(Tr,{...f,"aria-current":P,className:B,ref:m,style:M,to:o,viewTransition:c},typeof d=="function"?d(w):d)});n1.displayName="NavLink";var r1=J.forwardRef(({discover:l="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:n,state:a,method:o=xo,action:c,onSubmit:d,relative:f,preventScrollReset:m,viewTransition:p,...g},v)=>{let E=c1(),x=f1(c,{relative:f}),T=o.toLowerCase()==="get"?"get":"post",A=typeof c=="string"&&Py.test(c),b=_=>{if(d&&d(_),_.defaultPrevented)return;_.preventDefault();let I=_.nativeEvent.submitter,C=I?.getAttribute("formmethod")||o;E(I||_.currentTarget,{fetcherKey:t,method:C,navigate:e,replace:n,state:a,relative:f,preventScrollReset:m,viewTransition:p})};return J.createElement("form",{ref:v,method:T,action:x,onSubmit:i?d:b,...g,"data-discover":!A&&l==="render"?"true":void 0})});r1.displayName="Form";function a1(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ny(l){let t=J.useContext(Cr);return re(t,a1(l)),t}function l1(l,{target:t,replace:e,state:i,preventScrollReset:n,relative:a,viewTransition:o}={}){let c=yx(),d=In(),f=ja(l,{relative:a});return J.useCallback(m=>{if(Ux(m,t)){m.preventDefault();let p=e!==void 0?e:wa(d)===wa(f);c(l,{replace:p,state:i,preventScrollReset:n,relative:a,viewTransition:o})}},[d,c,f,e,i,t,l,n,a,o])}var o1=0,u1=()=>`__${String(++o1)}__`;function c1(){let{router:l}=Ny("useSubmit"),{basename:t}=J.useContext(qi),e=Dx();return J.useCallback(async(i,n={})=>{let{action:a,method:o,encType:c,formData:d,body:f}=Gx(i,t);if(n.navigate===!1){let m=n.fetcherKey||u1();await l.fetch(m,e,n.action||a,{preventScrollReset:n.preventScrollReset,formData:d,body:f,formMethod:n.method||o,formEncType:n.encType||c,flushSync:n.flushSync})}else await l.navigate(n.action||a,{preventScrollReset:n.preventScrollReset,formData:d,body:f,formMethod:n.method||o,formEncType:n.encType||c,replace:n.replace,state:n.state,fromRouteId:e,flushSync:n.flushSync,viewTransition:n.viewTransition})},[l,t,e])}function f1(l,{relative:t}={}){let{basename:e}=J.useContext(qi),i=J.useContext(Yi);re(i,"useFormAction must be used inside a RouteContext");let[n]=i.matches.slice(-1),a={...ja(l||".",{relative:t})},o=In();if(l==null){a.search=o.search;let c=new URLSearchParams(a.search),d=c.getAll("index");if(d.some(m=>m==="")){c.delete("index"),d.filter(p=>p).forEach(p=>c.append("index",p));let m=c.toString();a.search=m?`?${m}`:""}}return(!l||l===".")&&n.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:Ss([e,a.pathname])),wa(a)}function d1(l,{relative:t}={}){let e=J.useContext(Ry);re(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Ny("useViewTransitionState"),n=ja(l,{relative:t});if(!e.isTransitioning)return!1;let a=Ts(e.currentLocation.pathname,i)||e.currentLocation.pathname,o=Ts(e.nextLocation.pathname,i)||e.nextLocation.pathname;return ko(n.pathname,o)!=null||ko(n.pathname,a)!=null}var Ef={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Jg;function h1(){return Jg||(Jg=1,(function(l){(function(){var t={}.hasOwnProperty;function e(){for(var a="",o=0;o<arguments.length;o++){var c=arguments[o];c&&(a=n(a,i.call(this,c)))}return a}function i(a){if(typeof a=="string"||typeof a=="number")return this&&this[a]||a;if(typeof a!="object")return"";if(Array.isArray(a))return e.apply(this,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var c in a)t.call(a,c)&&a[c]&&(o=n(o,this&&this[c]||c));return o}function n(a,o){return o?a?a+" "+o:a+o:a}l.exports?(e.default=e,l.exports=e):window.classNames=e})()})(Ef)),Ef.exports}var m1=h1();const wr=wT(m1),p1="_slide_1n2ja_1",g1={slide:p1,"slide-title":"_slide-title_1n2ja_7","title-text":"_title-text_1n2ja_16","title-info":"_title-info_1n2ja_23","slide-content":"_slide-content_1n2ja_43","slide-group":"_slide-group_1n2ja_48"},y1="_name_1lo5v_26",v1={"slide-card":"_slide-card_1lo5v_1","slide-poster":"_slide-poster_1lo5v_6","slide-img":"_slide-img_1lo5v_16","slide-name":"_slide-name_1lo5v_22",name:y1,"origin-name":"_origin-name_1lo5v_32"},mr=wr.bind(v1);function E1({movieData:l,imgDom:t}){return console.log(l),lt.jsxs("div",{className:mr("slide-card"),children:[lt.jsx("a",{className:mr("slide-poster"),href:`/phim/${l.slug}`,children:lt.jsx("img",{className:mr("slide-img"),src:t+"/uploads/movies/"+l.poster_url,alt:""})}),lt.jsxs("div",{className:mr("slide-name"),children:[lt.jsx("div",{className:mr("name"),children:lt.jsx("a",{href:`/phim/${l.slug}`,children:l.name})}),lt.jsx("div",{className:mr("origin-name"),children:lt.jsx("a",{href:`/phim/${l.slug}`,children:l.origin_name})})]})]})}const By=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M98.9 114.6C91.5 130.6 98.5 149.7 114.5 157.1L467.6 320L114.6 483C98.6 490.4 91.5 509.4 99 525.5C106.5 541.6 125.4 548.5 141.5 541.1L557.5 349.1C568.8 343.9 576.1 332.5 576.1 320C576.1 307.5 568.8 296.2 557.5 290.9L141.4 99C125.4 91.6 106.3 98.6 98.9 114.6z"})),pr=wr.bind(g1);function S1({data:l}){const t=()=>`#${Math.floor(Math.random()*16777215).toString(16)}`;return lt.jsxs("div",{className:pr("slide"),children:[lt.jsxs("div",{className:pr("slide-title"),children:[lt.jsxs("div",{className:pr("title-text"),style:{background:`linear-gradient(
    235deg,
    rgb(255, 255, 255) 30%,
    ${t()} 100%
  )`},children:[l.seoOnPage.titleHead," mi"]}),lt.jsx("div",{className:pr("title-info"),children:lt.jsxs("a",{href:l.seoOnPage.og_url,children:[lt.jsx("span",{children:"Xem toan b"}),lt.jsx(By,{})]})})]}),lt.jsx("div",{className:pr("slide-content"),children:lt.jsx("div",{className:pr("slide-group"),children:l.items.map(e=>lt.jsx(E1,{movieData:e,imgDom:l.APP_DOMAIN_CDN_IMAGE},e._id))})})]})}const T1={"home-container":"_home-container_1t107_1","slide-container":"_slide-container_1t107_7"},t0=wr.bind(T1);function x1(){const[l,t]=J.useState(null);return J.useEffect(()=>{fetch("https://ophim1.com/v1/api/quoc-gia/han-quoc",{method:"GET",headers:{accept:"application/json"}}).then(n=>n.json()).then(n=>t(n.data)).catch(n=>console.error(n))},[]),lt.jsx("div",{className:t0("home-container"),children:lt.jsx("div",{className:t0("slide-container"),children:l&&lt.jsx(S1,{data:l})})})}/*!
 * artplayer.js v5.3.0
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(l,t,e,i,n,a,o,c){var d=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},f=typeof d[i]=="function"&&d[i],m=f.i||{},p=f.cache||{},g=typeof An<"u"&&typeof An.require=="function"&&An.require.bind(An);function v(T,A){if(!p[T]){if(!l[T]){if(n[T])return n[T];var b=typeof d[i]=="function"&&d[i];if(!A&&b)return b(T,!0);if(f)return f(T,!0);if(g&&typeof T=="string")return g(T);var _=Error("Cannot find module '"+T+"'");throw _.code="MODULE_NOT_FOUND",_}C.resolve=function(N){var w=l[T][1][N];return w??N},C.cache={};var I=p[T]=new v.Module(T);l[T][0].call(I.exports,C,I,I.exports,d)}return p[T].exports;function C(N){var w=C.resolve(N);return w===!1?{}:v(w)}}v.isParcelRequire=!0,v.Module=function(T){this.id=T,this.bundle=v,this.require=g,this.exports={}},v.modules=l,v.cache=p,v.parent=f,v.distDir=void 0,v.publicUrl=void 0,v.devServer=void 0,v.i=m,v.register=function(T,A){l[T]=[function(b,_){_.exports=A},{}]},Object.defineProperty(v,"root",{get:function(){return d[i]}}),d[i]=v;for(var E=0;E<t.length;E++)v(t[E]);{var x=v(e);typeof gE=="object"&&typeof An<"u"?An.exports=x:typeof define=="function"&&define.amd&&define(function(){return x})}})({esqvp:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("bundle-text:./style/index.less"),o=n.interopDefault(a),c=l("option-validator"),d=n.interopDefault(c),f=l("../package.json"),m=l("./config"),p=n.interopDefault(m),g=l("./contextmenu"),v=n.interopDefault(g),E=l("./control"),x=n.interopDefault(E),T=l("./events"),A=n.interopDefault(T),b=l("./hotkey"),_=n.interopDefault(b),I=l("./i18n"),C=n.interopDefault(I),N=l("./icons"),w=n.interopDefault(N),P=l("./info"),B=n.interopDefault(P),M=l("./layer"),K=n.interopDefault(M),tt=l("./loading"),H=n.interopDefault(tt),G=l("./mask"),Y=n.interopDefault(G),O=l("./notice"),j=n.interopDefault(O),X=l("./player"),rt=n.interopDefault(X),ct=l("./plugins"),k=n.interopDefault(ct),U=l("./scheme"),it=n.interopDefault(U),ut=l("./setting"),ft=n.interopDefault(ut),dt=l("./storage"),St=n.interopDefault(dt),Dt=l("./subtitle"),It=n.interopDefault(Dt),ae=l("./template"),Se=n.interopDefault(ae),Be=l("./utils"),mi=l("./utils/emitter"),Le=n.interopDefault(mi);let ki=0,bt=[];class pt extends Le.default{constructor(le,oe){if(super(),!Be.isBrowser)throw Error("Artplayer can only be used in the browser environment");this.id=++ki;let De=Be.mergeDeep(pt.option,le);if(De.container=le.container,this.option=(0,d.default)(De,it.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isRotate=!1,this.isDestroy=!1,this.template=new Se.default(this),this.events=new A.default(this),this.storage=new St.default(this),this.icons=new w.default(this),this.i18n=new C.default(this),this.notice=new j.default(this),this.player=new rt.default(this),this.layers=new K.default(this),this.controls=new x.default(this),this.contextmenu=new v.default(this),this.subtitle=new It.default(this),this.info=new B.default(this),this.loading=new H.default(this),this.hotkey=new _.default(this),this.mask=new Y.default(this),this.setting=new ft.default(this),this.plugins=new k.default(this),typeof oe=="function"&&this.on("ready",()=>oe.call(this,this)),pt.DEBUG){let Fe=$e=>console.log(`[ART.${this.id}] -> ${$e}`);Fe(`Version@${pt.version}`);for(let $e=0;$e<p.default.events.length;$e++)this.on(`video:${p.default.events[$e]}`,ee=>Fe(`Event@${ee.type}`))}bt.push(this)}static get instances(){return bt}static get version(){return f.version}static get config(){return p.default}static get utils(){return Be}static get scheme(){return it.default}static get Emitter(){return Le.default}static get validator(){return d.default}static get kindOf(){return d.default.kindOf}static get html(){return Se.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,gesture:!0,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,proxy:void 0,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],thumbnails:{url:"",number:60,column:10,width:0,height:0,scale:1},subtitle:{url:"",type:"",style:{},name:"",escape:!0,encoding:"utf-8",onVttLoad:le=>le},moreVideoAttr:{controls:!1,preload:Be.isSafari?"auto":"metadata"},i18n:{},icons:{},cssVar:{},customType:{},lang:navigator?.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}get video(){return this.template.$video}destroy(le=!0){pt.REMOVE_SRC_WHEN_DESTROY&&this.video.removeAttribute("src"),this.events.destroy(),this.template.destroy(le),bt.splice(bt.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}e.default=pt,pt.STYLE=o.default,pt.DEBUG=!1,pt.CONTEXTMENU=!0,pt.NOTICE_TIME=2e3,pt.SETTING_WIDTH=250,pt.SETTING_ITEM_WIDTH=200,pt.SETTING_ITEM_HEIGHT=35,pt.RESIZE_TIME=200,pt.SCROLL_TIME=200,pt.SCROLL_GAP=50,pt.AUTO_PLAYBACK_MAX=10,pt.AUTO_PLAYBACK_MIN=5,pt.AUTO_PLAYBACK_TIMEOUT=3e3,pt.RECONNECT_TIME_MAX=5,pt.RECONNECT_SLEEP_TIME=1e3,pt.CONTROL_HIDE_TIME=3e3,pt.DBCLICK_TIME=300,pt.DBCLICK_FULLSCREEN=!0,pt.MOBILE_DBCLICK_PLAY=!0,pt.MOBILE_CLICK_PLAY=!1,pt.AUTO_ORIENTATION_TIME=200,pt.INFO_LOOP_TIME=1e3,pt.FAST_FORWARD_VALUE=3,pt.FAST_FORWARD_TIME=1e3,pt.TOUCH_MOVE_RATIO=.5,pt.VOLUME_STEP=.1,pt.SEEK_STEP=5,pt.PLAYBACK_RATE=[.5,.75,1,1.25,1.5,2],pt.ASPECT_RATIO=["default","4:3","16:9"],pt.FLIP=["normal","horizontal","vertical"],pt.FULLSCREEN_WEB_IN_BODY=!1,pt.LOG_VERSION=!0,pt.USE_RAF=!1,pt.REMOVE_SRC_WHEN_DESTROY=!0,Be.isBrowser&&(window.Artplayer=pt,Be.setStyleText("artplayer-style",o.default),setTimeout(()=>{pt.LOG_VERSION&&console.log(`%c ArtPlayer %c ${pt.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},100))},{"bundle-text:./style/index.less":"2wh8D","option-validator":"g7VGh","../package.json":"lh3R5","./config":"eJfh8","./contextmenu":"9zso8","./control":"dp1yk","./events":"jmVSD","./hotkey":"dswts","./i18n":"d9ktO","./icons":"fFHY0","./info":"kZ0F8","./layer":"j9lbi","./loading":"bMjWd","./mask":"k1nkQ","./notice":"fPVaU","./player":"uR0Sw","./plugins":"cjxJL","./scheme":"biLjm","./setting":"bwLGT","./storage":"kwqbK","./subtitle":"k5613","./template":"fwOA1","./utils":"aBlEo","./utils/emitter":"4NM7P","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2wh8D":[function(l,t,e,i){t.exports='.art-video-player{--art-theme:red;--art-font-color:#fff;--art-background-color:#000;--art-text-shadow-color:#00000080;--art-transition-duration:.2s;--art-padding:10px;--art-border-radius:3px;--art-progress-height:6px;--art-progress-color:#ffffff40;--art-hover-color:#ffffff40;--art-loaded-color:#ffffff40;--art-state-size:80px;--art-state-opacity:.8;--art-bottom-height:100px;--art-bottom-offset:20px;--art-bottom-gap:5px;--art-highlight-width:8px;--art-highlight-color:#ffffff80;--art-control-height:46px;--art-control-opacity:.75;--art-control-icon-size:36px;--art-control-icon-scale:1.1;--art-volume-height:120px;--art-volume-handle-size:14px;--art-lock-size:36px;--art-indicator-scale:0;--art-indicator-size:16px;--art-fullscreen-web-index:9999;--art-settings-icon-size:24px;--art-settings-max-height:300px;--art-selector-max-height:300px;--art-contextmenus-min-width:250px;--art-subtitle-font-size:20px;--art-subtitle-gap:5px;--art-subtitle-bottom:15px;--art-subtitle-border:#000;--art-widget-background:#000000d9;--art-tip-background:#000000b3;--art-scrollbar-size:4px;--art-scrollbar-background:#ffffff40;--art-scrollbar-background-hover:#ffffff80;--art-mini-progress-height:2px}.art-bg-cover{background-position:50%;background-repeat:no-repeat;background-size:cover}.art-bottom-gradient{background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x}.art-backdrop-filter{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.art-video-player{zoom:1;text-align:left;user-select:none;box-sizing:border-box;width:100%;height:100%;color:var(--art-font-color);background-color:var(--art-background-color);text-shadow:0 0 2px var(--art-text-shadow-color);-webkit-tap-highlight-color:#0000;-ms-touch-action:manipulation;touch-action:manipulation;-ms-high-contrast-adjust:none;direction:ltr;outline:0;margin:0 auto;padding:0;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Roboto,Arial,sans-serif;font-size:14px;line-height:1.3;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box}.art-video-player ::-webkit-scrollbar{width:var(--art-scrollbar-size);height:var(--art-scrollbar-size)}.art-video-player ::-webkit-scrollbar-thumb{background-color:var(--art-scrollbar-background)}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:var(--art-scrollbar-background-hover)}.art-video-player img{vertical-align:top;max-width:100%}.art-video-player svg{fill:var(--art-font-color)}.art-video-player a{color:var(--art-font-color);text-decoration:none}.art-icon{justify-content:center;align-items:center;line-height:1;display:flex}.art-video-player.art-backdrop .art-contextmenus,.art-video-player.art-backdrop .art-info,.art-video-player.art-backdrop .art-settings,.art-video-player.art-backdrop .art-layer-auto-playback,.art-video-player.art-backdrop .art-selector-list,.art-video-player.art-backdrop .art-volume-inner{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-video{z-index:10;cursor:pointer;width:100%;height:100%;position:absolute;inset:0}.art-poster{z-index:11;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;width:100%;height:100%;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;text-align:center;pointer-events:none;justify-content:center;align-items:center;gap:var(--art-subtitle-gap);width:100%;bottom:var(--art-subtitle-bottom);font-size:var(--art-subtitle-font-size);transition:bottom var(--art-transition-duration)ease;text-shadow:var(--art-subtitle-border)1px 0 1px,var(--art-subtitle-border)0 1px 1px,var(--art-subtitle-border)-1px 0 1px,var(--art-subtitle-border)0 -1px 1px,var(--art-subtitle-border)1px 1px 1px,var(--art-subtitle-border)-1px -1px 1px,var(--art-subtitle-border)1px -1px 1px,var(--art-subtitle-border)-1px 1px 1px;flex-direction:column;padding:0 5%;display:none;position:absolute}.art-video-player.art-subtitle-show .art-subtitle{display:flex}.art-video-player.art-control-show .art-subtitle{bottom:calc(var(--art-control-height) + var(--art-subtitle-bottom))}.art-danmuku{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;pointer-events:none;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:flex}.art-video-player .art-mask{z-index:50;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;inset:0}.art-video-player .art-mask .art-state{opacity:0;width:var(--art-state-size);height:var(--art-state-size);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.art-video-player.art-mask-show .art-state{cursor:pointer;pointer-events:auto;opacity:var(--art-state-opacity);transform:scale(1)}.art-video-player.art-loading-show .art-state{display:none}.art-video-player .art-loading{z-index:70;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;opacity:0;pointer-events:none;width:100%;height:100%;padding:0 var(--art-padding);transition:all var(--art-transition-duration)ease;background-size:100% var(--art-bottom-height);background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:flex-end;display:flex;position:absolute;inset:0;overflow:hidden}.art-video-player .art-bottom .art-controls,.art-video-player .art-bottom .art-progress{transform:translateY(var(--art-bottom-offset));transition:transform var(--art-transition-duration)ease}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1}.art-video-player.art-control-show .art-bottom .art-controls,.art-video-player.art-hover .art-bottom .art-controls,.art-video-player.art-control-show .art-bottom .art-progress,.art-video-player.art-hover .art-bottom .art-progress{transform:translateY(0)}.art-bottom .art-progress{z-index:0;pointer-events:auto;padding-bottom:var(--art-bottom-gap);position:relative}.art-bottom .art-progress .art-control-progress{cursor:pointer;height:var(--art-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner{width:100%;height:50%;transition:height var(--art-transition-duration)ease;background-color:var(--art-progress-color);align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-hover{z-index:0;background-color:var(--art-hover-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;background-color:var(--art-loaded-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;background-color:var(--art-theme);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{z-index:0;pointer-events:auto;width:100%;height:100%;transform:translateX(calc(var(--art-highlight-width)/-2));background-color:var(--art-highlight-color);position:absolute;inset:0 auto 0 0;width:var(--art-highlight-width)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{z-index:40;width:var(--art-indicator-size);height:var(--art-indicator-size);transform:scale(var(--art-indicator-scale));margin-left:calc(var(--art-indicator-size)/-2);transition:transform var(--art-transition-duration)ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{pointer-events:none;width:100%;height:100%}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:hover{transform:scale(1.2)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:active{transform:scale(1)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;border-radius:var(--art-border-radius);white-space:nowrap;background-color:var(--art-tip-background);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.art-bottom .art-progress .art-control-progress:hover .art-control-progress-inner{height:100%}.art-bottom .art-progress .art-control-thumbnails{bottom:calc(var(--art-bottom-gap) + 10px);border-radius:var(--art-border-radius);pointer-events:none;background-color:var(--art-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px #0003,0 1px 2px -1px #0003}.art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{transform:scale(1)}.art-controls{z-index:10;pointer-events:auto;height:var(--art-control-height);justify-content:space-between;align-items:center;display:flex;position:relative}.art-controls .art-controls-left,.art-controls .art-controls-right{height:100%;display:flex}.art-controls .art-controls-center{flex:1;justify-content:center;align-items:center;height:100%;padding:0 10px;display:none}.art-controls .art-controls-right{justify-content:flex-end}.art-controls .art-control{cursor:pointer;white-space:nowrap;opacity:var(--art-control-opacity);min-height:var(--art-control-height);min-width:var(--art-control-height);transition:opacity var(--art-transition-duration)ease;flex-shrink:0;justify-content:center;align-items:center;display:flex}.art-controls .art-control .art-icon{height:var(--art-control-icon-size);width:var(--art-control-icon-size);transform:scale(var(--art-control-icon-scale));transition:transform var(--art-transition-duration)ease}.art-controls .art-control .art-icon:active{transform:scale(calc(var(--art-control-icon-scale)*.8))}.art-controls .art-control:hover{opacity:1}.art-control-volume{position:relative}.art-control-volume .art-volume-panel{text-align:center;cursor:default;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--art-control-height);width:var(--art-control-height);height:var(--art-volume-height);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;transform:translateY(10px)}.art-control-volume .art-volume-panel .art-volume-inner{border-radius:var(--art-border-radius);background-color:var(--art-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider{cursor:pointer;flex:1;justify-content:center;width:100%;display:flex;position:relative}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle{border-radius:var(--art-border-radius);background-color:#ffffff40;justify-content:center;width:2px;display:flex;position:relative;overflow:hidden}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle .art-volume-loaded{z-index:0;background-color:var(--art-theme);width:100%;height:100%;position:absolute;inset:0}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-indicator{width:var(--art-volume-handle-size);height:var(--art-volume-handle-size);margin-top:calc(var(--art-volume-handle-size)/-2);background-color:var(--art-theme);transition:transform var(--art-transition-duration)ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider:active .art-volume-indicator{transform:scale(.9)}.art-control-volume:hover .art-volume-panel{opacity:1;pointer-events:auto;transform:translateY(0)}.art-video-player .art-notice{z-index:80;width:100%;height:auto;padding:var(--art-padding);pointer-events:none;display:none;position:absolute;inset:0 0 auto}.art-video-player .art-notice .art-notice-inner{border-radius:var(--art-border-radius);background-color:var(--art-tip-background);padding:5px;line-height:1;display:inline-flex}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);min-width:var(--art-contextmenus-min-width);flex-direction:column;padding:5px 0;font-size:12px;display:none;position:absolute}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;border-bottom:1px solid #ffffff1a;padding:10px 15px;display:flex}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 8px}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:var(--art-theme)}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;border-radius:var(--art-border-radius);max-height:var(--art-settings-max-height);left:auto;right:var(--art-padding);bottom:var(--art-control-height);transition:all var(--art-transition-duration)ease;background-color:var(--art-widget-background);flex-direction:column;display:none;position:absolute;overflow:hidden auto}.art-video-player .art-settings .art-setting-panel{flex-direction:column;display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item{cursor:pointer;transition:background-color var(--art-transition-duration)ease;justify-content:space-between;align-items:center;padding:0 5px;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover{background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:var(--art-theme)}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{flex-shrink:0;justify-content:center;align-items:center;gap:5px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:var(--art-settings-icon-size);width:var(--art-settings-icon-size);justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{justify-content:center;align-items:center;gap:5px;font-size:12px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{justify-content:center;align-items:center;min-width:32px;height:24px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{appearance:none;background-color:#fff3;outline:none;width:80px;height:3px}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:flex}.art-video-player .art-info{left:var(--art-padding);top:var(--art-padding);z-index:100;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);padding:10px;font-size:12px;display:none;position:absolute}.art-video-player .art-info .art-info-panel{flex-direction:column;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item{align-items:center;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item .art-info-title{text-align:right;width:100px}.art-video-player .art-info .art-info-panel .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;user-select:all;width:250px;overflow:hidden}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio]{overflow:hidden}.art-video-player[data-aspect-ratio] .art-video{object-fit:fill;box-sizing:content-box}.art-fullscreen{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3}.art-fullscreen-web{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3;z-index:var(--art-fullscreen-web-index);width:100%;height:100%;position:fixed;inset:0}.art-mini-popup{z-index:9999;border-radius:var(--art-border-radius);cursor:move;user-select:none;background:#000;width:320px;height:180px;transition:opacity .2s;position:fixed;overflow:hidden;box-shadow:0 0 5px #00000080}.art-mini-popup svg{fill:#fff}.art-mini-popup .art-video{pointer-events:none}.art-mini-popup .art-mini-close{z-index:20;cursor:pointer;opacity:0;transition:opacity .2s;position:absolute;top:10px;right:10px}.art-mini-popup .art-mini-state{z-index:30;pointer-events:none;opacity:0;background-color:#00000040;justify-content:center;align-items:center;width:100%;height:100%;transition:opacity .2s;display:flex;position:absolute;inset:0}.art-mini-popup .art-mini-state .art-icon{opacity:.75;cursor:pointer;pointer-events:auto;transition:transform .2s;transform:scale(3)}.art-mini-popup .art-mini-state .art-icon:active{transform:scale(2.5)}.art-mini-popup.art-mini-dragging{opacity:.9}.art-mini-popup:hover .art-mini-close,.art-mini-popup:hover .art-mini-state{opacity:1}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-lock{height:var(--art-lock-size);width:var(--art-lock-size);top:50%;left:var(--art-padding);background-color:var(--art-tip-background);border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;transform:translateY(-50%)}.art-video-player .art-layer-auto-playback{border-radius:var(--art-border-radius);left:var(--art-padding);bottom:calc(var(--art-control-height) + var(--art-bottom-gap) + 10px);background-color:var(--art-widget-background);align-items:center;gap:10px;padding:10px;line-height:1;display:none;position:absolute}.art-video-player .art-layer-auto-playback .art-auto-playback-close{cursor:pointer;justify-content:center;align-items:center;display:flex}.art-video-player .art-layer-auto-playback .art-auto-playback-close svg{width:15px;height:15px;fill:var(--art-theme)}.art-video-player .art-layer-auto-playback .art-auto-playback-jump{color:var(--art-theme);cursor:pointer}.art-video-player.art-lock .art-subtitle{bottom:var(--art-subtitle-bottom)!important}.art-video-player.art-mini-progress-bar .art-bottom,.art-video-player.art-lock .art-bottom{opacity:1;background-image:none;padding:0}.art-video-player.art-mini-progress-bar .art-bottom .art-controls,.art-video-player.art-lock .art-bottom .art-controls,.art-video-player.art-mini-progress-bar .art-bottom .art-progress,.art-video-player.art-lock .art-bottom .art-progress{transform:translateY(calc(var(--art-control-height) + var(--art-bottom-gap) + var(--art-progress-height)/4))}.art-video-player.art-mini-progress-bar .art-bottom .art-progress-indicator,.art-video-player.art-lock .art-bottom .art-progress-indicator{display:none!important}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-control-selector{justify-content:center;display:flex;position:relative}.art-control-selector .art-selector-list{text-align:center;border-radius:var(--art-border-radius);opacity:0;pointer-events:none;bottom:var(--art-control-height);max-height:var(--art-selector-max-height);background-color:var(--art-widget-background);transition:all var(--art-transition-duration)ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto;transform:translateY(10px)}.art-control-selector .art-selector-list .art-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex}.art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-control-selector .art-selector-list .art-selector-item:hover,.art-control-selector .art-selector-list .art-selector-item.art-current{color:var(--art-theme)}.art-control-selector:hover .art-selector-list{opacity:1;pointer-events:auto;transform:translateY(0)}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.art-video-player.art-mobile{--art-bottom-gap:10px;--art-control-height:38px;--art-control-icon-scale:1;--art-state-size:60px;--art-settings-max-height:180px;--art-selector-max-height:180px;--art-indicator-scale:1;--art-control-opacity:1}.art-video-player.art-mobile .art-controls-left{margin-left:calc(var(--art-padding)/-1)}.art-video-player.art-mobile .art-controls-right{margin-right:calc(var(--art-padding)/-1)}'},{}],g7VGh:[function(l,t,e,i){t.exports=(function(){function n(p){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(p)}var a=Object.prototype.toString,o=function(p){if(p===void 0)return"undefined";if(p===null)return"null";var g=n(p);if(g==="boolean")return"boolean";if(g==="string")return"string";if(g==="number")return"number";if(g==="symbol")return"symbol";if(g==="function")return c(p)==="GeneratorFunction"?"generatorfunction":"function";if(Array.isArray?Array.isArray(p):p instanceof Array)return"array";if(p.constructor&&typeof p.constructor.isBuffer=="function"&&p.constructor.isBuffer(p))return"buffer";if((function(v){try{if(typeof v.length=="number"&&typeof v.callee=="function")return!0}catch(E){if(E.message.indexOf("callee")!==-1)return!0}return!1})(p))return"arguments";if(p instanceof Date||typeof p.toDateString=="function"&&typeof p.getDate=="function"&&typeof p.setDate=="function")return"date";if(p instanceof Error||typeof p.message=="string"&&p.constructor&&typeof p.constructor.stackTraceLimit=="number")return"error";if(p instanceof RegExp||typeof p.flags=="string"&&typeof p.ignoreCase=="boolean"&&typeof p.multiline=="boolean"&&typeof p.global=="boolean")return"regexp";switch(c(p)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(typeof p.throw=="function"&&typeof p.return=="function"&&typeof p.next=="function")return"generator";switch(g=a.call(p)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return g.slice(8,-1).toLowerCase().replace(/\s/g,"")};function c(p){return p.constructor?p.constructor.name:null}function d(p,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return f(p,g,v),m(p,g,v),(function(E,x,T){var A=o(x),b=o(E);if(A==="object"){if(b!=="object")throw Error("[Type Error]: '".concat(T.join("."),"' require 'object' type, but got '").concat(b,"'"));Object.keys(x).forEach(function(_){var I=E[_],C=x[_],N=T.slice();N.push(_),f(I,C,N),m(I,C,N),d(I,C,N)})}if(A==="array"){if(b!=="array")throw Error("[Type Error]: '".concat(T.join("."),"' require 'array' type, but got '").concat(b,"'"));E.forEach(function(_,I){var C=E[I],N=x[I]||x[0],w=T.slice();w.push(I),f(C,N,w),m(C,N,w),d(C,N,w)})}})(p,g,v),p}function f(p,g,v){if(o(g)==="string"){var E=o(p);if(g[0]==="?"&&(g=g.slice(1)+"|undefined"),!(-1<g.indexOf("|")?g.split("|").map(function(x){return x.toLowerCase().trim()}).filter(Boolean).some(function(x){return E===x}):g.toLowerCase().trim()===E))throw Error("[Type Error]: '".concat(v.join("."),"' require '").concat(g,"' type, but got '").concat(E,"'"))}}function m(p,g,v){if(o(g)==="function"){var E=g(p,o(p),v);if(E!==!0){var x=o(E);throw x==="string"?Error(E):x==="error"?E:Error("[Validator Error]: The scheme for '".concat(v.join("."),"' validator require return true, but got '").concat(E,"'"))}}}return d.kindOf=o,d})()},{}],lh3R5:[function(l,t,e,i){t.exports=JSON.parse('{"name":"artplayer","version":"5.3.0","description":"ArtPlayer.js is a modern and full featured HTML5 video player","author":"Harvey Zack <laozhaochaguan@gmail.com>","license":"MIT","homepage":"https://artplayer.org","repository":{"type":"git","url":"git+https://github.com/zhw2590582/ArtPlayer.git"},"bugs":{"url":"https://github.com/zhw2590582/ArtPlayer/issues"},"keywords":["html5","video","player"],"exports":{".":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.mjs","require":"./dist/artplayer.js"},"./legacy":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.legacy.js","require":"./dist/artplayer.legacy.js"},"./i18n/*":{"types":"./types/i18n.d.ts","import":"./dist/i18n/*.mjs","require":"./dist/i18n/*.js"}},"main":"./dist/artplayer.js","module":"./dist/artplayer.mjs","types":"./types/artplayer.d.ts","typesVersions":{"*":{"i18n/*":["types/i18n.d.ts"],"legacy":["types/artplayer.d.ts"]}},"legacy":"./dist/artplayer.legacy.js","browserslist":"last 1 Chrome version","dependencies":{"option-validator":"^2.0.6"}}')},{}],eJfh8:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default={properties:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],loqXi:[function(l,t,e,i){e.interopDefault=function(n){return n&&n.__esModule?n:{default:n}},e.defineInteropFlag=function(n){Object.defineProperty(n,"__esModule",{value:!0})},e.exportAll=function(n,a){return Object.keys(n).forEach(function(o){o==="default"||o==="__esModule"||Object.prototype.hasOwnProperty.call(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:function(){return n[o]}})}),a},e.export=function(n,a,o){Object.defineProperty(n,a,{enumerable:!0,get:o})}},{}],"9zso8":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("../utils"),o=l("../utils/component"),c=n.interopDefault(o),d=l("./aspectRatio"),f=n.interopDefault(d),m=l("./close"),p=n.interopDefault(m),g=l("./flip"),v=n.interopDefault(g),E=l("./info"),x=n.interopDefault(E),T=l("./playbackRate"),A=n.interopDefault(T),b=l("./version"),_=n.interopDefault(b);class I extends c.default{constructor(N){super(N),this.name="contextmenu",this.$parent=N.template.$contextmenu,a.isMobile||this.init()}init(){let{option:N,proxy:w,template:{$player:P,$contextmenu:B}}=this.art;N.playbackRate&&this.add((0,A.default)({name:"playbackRate",index:10})),N.aspectRatio&&this.add((0,f.default)({name:"aspectRatio",index:20})),N.flip&&this.add((0,v.default)({name:"flip",index:30})),this.add((0,x.default)({name:"info",index:40})),this.add((0,_.default)({name:"version",index:50})),this.add((0,p.default)({name:"close",index:60}));for(let M=0;M<N.contextmenu.length;M++)this.add(N.contextmenu[M]);w(P,"contextmenu",M=>{if(!this.art.constructor.CONTEXTMENU)return;M.preventDefault(),this.show=!0;let K=M.clientX,tt=M.clientY,{height:H,width:G,left:Y,top:O}=(0,a.getRect)(P),{height:j,width:X}=(0,a.getRect)(B),rt=K-Y,ct=tt-O;K+X>Y+G&&(rt=G-X),tt+j>O+H&&(ct=H-j),(0,a.setStyles)(B,{top:`${ct}px`,left:`${rt}px`})}),w(P,"click",M=>{(0,a.includeFromEvent)(M,B)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}e.default=I},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"6XHP2","./close":"eF6AX","./flip":"7Wg1P","./info":"fjRnU","./playbackRate":"hm1DY","./version":"aJBeL","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBlEo:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./compatibility");n.exportAll(a,e);var o=l("./dom");n.exportAll(o,e);var c=l("./error");n.exportAll(c,e);var d=l("./file");n.exportAll(d,e);var f=l("./format");n.exportAll(f,e);var m=l("./property");n.exportAll(m,e);var p=l("./subtitle");n.exportAll(p,e);var g=l("./time");n.exportAll(g,e)},{"./compatibility":"jg0yq","./dom":"eANXw","./error":"4FwTI","./file":"i2JbS","./format":"dy9GH","./property":"jY49c","./subtitle":"ke7ox","./time":"f7gsx","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jg0yq:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"userAgent",()=>a),n.export(e,"isSafari",()=>o),n.export(e,"isIOS",()=>c),n.export(e,"isIOS13",()=>d),n.export(e,"isMobile",()=>f),n.export(e,"isBrowser",()=>m);let a=globalThis?.CUSTOM_USER_AGENT??(typeof navigator<"u"?navigator.userAgent:""),o=/^(?:(?!chrome|android).)*safari/i.test(a),c=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream,d=c||a.includes("Macintosh")&&navigator.maxTouchPoints>=1,f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)||d,m=typeof window<"u"&&typeof document<"u"},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eANXw:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"query",()=>o),n.export(e,"queryAll",()=>c),n.export(e,"addClass",()=>d),n.export(e,"removeClass",()=>f),n.export(e,"hasClass",()=>m),n.export(e,"append",()=>p),n.export(e,"remove",()=>g),n.export(e,"setStyle",()=>v),n.export(e,"setStyles",()=>E),n.export(e,"getStyle",()=>x),n.export(e,"siblings",()=>T),n.export(e,"inverseClass",()=>A),n.export(e,"tooltip",()=>b),n.export(e,"isInViewport",()=>_),n.export(e,"includeFromEvent",()=>I),n.export(e,"replaceElement",()=>C),n.export(e,"createElement",()=>N),n.export(e,"getIcon",()=>w),n.export(e,"setStyleText",()=>P),n.export(e,"supportsFlex",()=>B),n.export(e,"getRect",()=>M),n.export(e,"loadImg",()=>K),n.export(e,"getComposedPath",()=>tt);var a=l("./compatibility");function o(H,G=document){return G.querySelector(H)}function c(H,G=document){return Array.from(G.querySelectorAll(H))}function d(H,G){return H.classList.add(G)}function f(H,G){return H.classList.remove(G)}function m(H,G){return H.classList.contains(G)}function p(H,G){return G instanceof Element?H.appendChild(G):H.insertAdjacentHTML("beforeend",String(G)),H.lastElementChild||H.lastChild}function g(H){return H.parentNode.removeChild(H)}function v(H,G,Y){return H.style[G]=Y,H}function E(H,G){for(let Y in G)v(H,Y,G[Y]);return H}function x(H,G,Y=!0){let O=window.getComputedStyle(H,null).getPropertyValue(G);return Y?Number.parseFloat(O):O}function T(H){return Array.from(H.parentElement.children).filter(G=>G!==H)}function A(H,G){T(H).forEach(Y=>f(Y,G)),d(H,G)}function b(H,G,Y="top"){a.isMobile||(H.setAttribute("aria-label",G),d(H,"hint--rounded"),d(H,`hint--${Y}`))}function _(H,G=0){let Y=H.getBoundingClientRect(),O=window.innerHeight||document.documentElement.clientHeight,j=window.innerWidth||document.documentElement.clientWidth,X=Y.top-G<=O&&Y.top+Y.height+G>=0,rt=Y.left-G<=j+G&&Y.left+Y.width+G>=0;return X&&rt}function I(H,G){return tt(H).includes(G)}function C(H,G){return G.parentNode.replaceChild(H,G),H}function N(H){return document.createElement(H)}function w(H="",G=""){let Y=N("i");return d(Y,"art-icon"),d(Y,`art-icon-${H}`),p(Y,G),Y}function P(H,G){let Y=document.getElementById(H);Y||((Y=document.createElement("style")).id=H,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(Y)}):(document.head||document.documentElement).appendChild(Y)),Y.textContent=G}function B(){let H=document.createElement("div");return H.style.display="flex",H.style.display==="flex"}function M(H){return H.getBoundingClientRect()}function K(H,G){return new Promise((Y,O)=>{let j=new Image;j.onload=function(){if(G&&G!==1){let X=document.createElement("canvas"),rt=X.getContext("2d");X.width=j.width*G,X.height=j.height*G,rt.drawImage(j,0,0,X.width,X.height),X.toBlob(ct=>{let k=URL.createObjectURL(ct),U=new Image;U.onload=function(){Y(U)},U.onerror=function(){URL.revokeObjectURL(k),O(Error(`Image load failed: ${H}`))},U.src=k})}else Y(j)},j.onerror=function(){O(Error(`Image load failed: ${H}`))},j.src=H})}function tt(H){if(H.composedPath)return H.composedPath();let G=[],Y=H.target;for(;Y;)G.push(Y),Y=Y.parentNode;return G.includes(window)||window===void 0||G.push(window),G}},{"./compatibility":"jg0yq","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4FwTI":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"ArtPlayerError",()=>a),n.export(e,"errorHandle",()=>o);class a extends Error{constructor(d,f){super(d),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,f||this.constructor),this.name="ArtPlayerError"}}function o(c,d){if(!c)throw new a(d);return c}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i2JbS:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o,c){let d=document.createElement("a");d.style.display="none",d.href=o,d.download=c,document.body.appendChild(d),d.click(),document.body.removeChild(d)}n.defineInteropFlag(e),n.export(e,"getExt",()=>function o(c){return c.includes("?")?o(c.split("?")[0]):c.includes("#")?o(c.split("#")[0]):c.trim().toLowerCase().split(".").pop()}),n.export(e,"download",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dy9GH:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(m,p,g){return Math.max(Math.min(m,Math.max(p,g)),Math.min(p,g))}function o(m){return m.charAt(0).toUpperCase()+m.slice(1)}function c(m){if(!m)return"00:00";let p=Math.floor(m/3600),g=Math.floor((m-3600*p)/60),v=Math.floor(m-3600*p-60*g);return(p>0?[p,g,v]:[g,v]).map(E=>E<10?`0${E}`:String(E)).join(":")}function d(m){return m.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}function f(m){let p={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'},g=RegExp(`(${Object.keys(p).join("|")})`,"g");return m.replace(g,v=>p[v]||v)}n.defineInteropFlag(e),n.export(e,"clamp",()=>a),n.export(e,"capitalize",()=>o),n.export(e,"secondToTime",()=>c),n.export(e,"escape",()=>d),n.export(e,"unescape",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jY49c:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"def",()=>a),n.export(e,"has",()=>c),n.export(e,"get",()=>d),n.export(e,"mergeDeep",()=>function f(...m){let p=g=>g&&typeof g=="object"&&!Array.isArray(g);return m.reduce((g,v)=>(Object.keys(v).forEach(E=>{let x=g[E],T=v[E];Array.isArray(x)&&Array.isArray(T)?g[E]=x.concat(...T):p(x)&&p(T)?g[E]=f(x,T):g[E]=T}),g),{})});let a=Object.defineProperty,{hasOwnProperty:o}=Object.prototype;function c(f,m){return o.call(f,m)}function d(f,m){return Object.getOwnPropertyDescriptor(f,m)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ke7ox:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(d){return`WEBVTT \r
\r
`.concat(d.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(f,m,p)=>{let g=p.slice(0,3);return p.length===1&&(g=`${p}00`),p.length===2&&(g=`${p}0`),`${m},${g}`}).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/\{[\s\S]*?\}/g,"").concat(`\r
\r
`))}function o(d){return URL.createObjectURL(new Blob([d],{type:"text/vtt"}))}function c(d){let f=RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function m(p=""){return p.split(/[:.]/).map((g,v,E)=>{if(v===E.length-1){if(g.length===1)return`.${g}00`;if(g.length===2)return`.${g}0`}else if(g.length===1)return(v===0?"0":":0")+g;return v===0?g:v===E.length-1?`.${g}`:`:${g}`}).join("")}return`WEBVTT ${d.split(/\r?\n/).map(p=>{let g=p.match(f);return g?{start:m(g[1].trim()),end:m(g[2].trim()),text:g[5].replace(/\{[\s\S]*?\}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(v=>v.trim()).join(`
`)}:null}).filter(p=>p).map((p,g)=>p?`${g+1} ${p.start} --> ${p.end} ${p.text}`:"").filter(p=>p.trim()).join(`

`)}`}n.defineInteropFlag(e),n.export(e,"srtToVtt",()=>a),n.export(e,"vttToBlob",()=>o),n.export(e,"assToVtt",()=>c)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f7gsx:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(d=0){return new Promise(f=>setTimeout(f,d))}function o(d,f){let m;return function(...p){let g=()=>(m=null,d.apply(this,p));clearTimeout(m),m=setTimeout(g,f)}}function c(d,f){let m=!1;return function(...p){m||(d.apply(this,p),m=!0,setTimeout(()=>{m=!1},f))}}n.defineInteropFlag(e),n.export(e,"sleep",()=>a),n.export(e,"debounce",()=>o),n.export(e,"throttle",()=>c)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],idCEj:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("option-validator"),o=n.interopDefault(a),c=l("../scheme"),d=l("./dom"),f=l("./error");e.default=class{constructor(m){this.id=0,this.art=m,this.cache=new Map,this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.update=this.update.bind(this)}get show(){return(0,d.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(m){let{$player:p}=this.art.template,g=`art-${this.name}-show`;m?(0,d.addClass)(p,g):(0,d.removeClass)(p,g),this.art.emit(this.name,m)}toggle(){this.show=!this.show}add(m){let p=typeof m=="function"?m(this.art):m;if(p.html=p.html||"",(0,o.default)(p,c.ComponentOption),!this.$parent||!this.name||p.disable)return;let g=p.name||`${this.name}${this.id}`,v=this.cache.get(g);(0,f.errorHandle)(!v,`Can't add an existing [${g}] to the [${this.name}]`),this.id+=1;let E=(0,d.createElement)("div");(0,d.addClass)(E,`art-${this.name}`),(0,d.addClass)(E,`art-${this.name}-${g}`);let x=Array.from(this.$parent.children);E.dataset.index=p.index||this.id;let T=x.find(b=>Number(b.dataset.index)>=Number(E.dataset.index));T?T.insertAdjacentElement("beforebegin",E):(0,d.append)(this.$parent,E),p.html&&(0,d.append)(E,p.html),p.style&&(0,d.setStyles)(E,p.style),p.tooltip&&(0,d.tooltip)(E,p.tooltip);let A=[];if(p.click){let b=this.art.events.proxy(E,"click",_=>{_.preventDefault(),p.click.call(this.art,this,_)});A.push(b)}return p.selector&&["left","right"].includes(p.position)&&this.selector(p,E,A),this[g]=E,this.cache.set(g,{$ref:E,events:A,option:p}),p.mounted&&p.mounted.call(this.art,E),E}remove(m){let p=this.cache.get(m);(0,f.errorHandle)(p,`Can't find [${m}] from the [${this.name}]`),p.option.beforeUnmount&&p.option.beforeUnmount.call(this.art,p.$ref);for(let g=0;g<p.events.length;g++)this.art.events.remove(p.events[g]);this.cache.delete(m),delete this[m],(0,d.remove)(p.$ref)}update(m){let p=this.cache.get(m.name);return p&&(m=Object.assign(p.option,m),this.remove(m.name)),this.add(m)}}},{"option-validator":"g7VGh","../scheme":"biLjm","./dom":"eANXw","./error":"4FwTI","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],biLjm:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"ComponentOption",()=>v);var a=l("../utils");let o="array",c="boolean",d="string",f="number",m="object",p="function";function g(E,x,T){return(0,a.errorHandle)(x===d||x===f||E instanceof Element,`${T.join(".")} require '${d}' or 'Element' type`)}let v={html:g,disable:`?${c}`,name:`?${d}`,index:`?${f}`,style:`?${m}`,click:`?${p}`,mounted:`?${p}`,tooltip:`?${d}|${f}`,width:`?${f}`,selector:`?${o}`,onSelect:`?${p}`,switch:`?${c}`,onSwitch:`?${p}`,range:`?${o}`,onRange:`?${p}`,onChange:`?${p}`};e.default={id:d,container:g,url:d,poster:d,type:d,theme:d,lang:d,volume:f,isLive:c,muted:c,autoplay:c,autoSize:c,autoMini:c,loop:c,flip:c,playbackRate:c,aspectRatio:c,screenshot:c,setting:c,hotkey:c,pip:c,mutex:c,backdrop:c,fullscreen:c,fullscreenWeb:c,subtitleOffset:c,miniProgressBar:c,useSSR:c,playsInline:c,lock:c,gesture:c,fastForward:c,autoPlayback:c,autoOrientation:c,airplay:c,proxy:`?${p}`,plugins:[p],layers:[v],contextmenu:[v],settings:[v],controls:[{...v,position:(E,x,T)=>{let A=["top","left","right"];return(0,a.errorHandle)(A.includes(E),`${T.join(".")} only accept ${A.toString()} as parameters`)}}],quality:[{default:`?${c}`,html:d,url:d}],highlight:[{time:f,text:d}],thumbnails:{url:d,number:f,column:f,width:f,height:f,scale:f},subtitle:{url:d,name:d,type:d,style:m,escape:c,encoding:d,onVttLoad:p},moreVideoAttr:m,i18n:m,icons:m,cssVar:m,customType:m}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6XHP2":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>{let{i18n:f,constructor:{ASPECT_RATIO:m}}=d,p=m.map(g=>`<span data-value="${g}">${g==="default"?f.get("Default"):g}</span>`).join("");return{...c,html:`${f.get("Aspect Ratio")}: ${p}`,click:(g,v)=>{let{value:E}=v.target.dataset;E&&(d.aspectRatio=E,g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="default"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("aspectRatio",E=>{let x=(0,a.queryAll)("span",g).find(T=>T.dataset.value===E);x&&(0,a.inverseClass)(x,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eF6AX:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){return c=>({...o,html:c.i18n.get("Close"),click:d=>{d.show=!1}})}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7Wg1P":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>{let{i18n:f,constructor:{FLIP:m}}=d,p=m.map(g=>`<span data-value="${g}">${f.get((0,a.capitalize)(g))}</span>`).join("");return{...c,html:`${f.get("Video Flip")}: ${p}`,click:(g,v)=>{let{value:E}=v.target.dataset;E&&(d.flip=E.toLowerCase(),g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="normal"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("flip",E=>{let x=(0,a.queryAll)("span",g).find(T=>T.dataset.value===E);x&&(0,a.inverseClass)(x,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjRnU:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){return c=>({...o,html:c.i18n.get("Video Info"),click:d=>{c.info.show=!0,d.show=!1}})}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hm1DY:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>{let{i18n:f,constructor:{PLAYBACK_RATE:m}}=d,p=m.map(g=>`<span data-value="${g}">${g===1?f.get("Normal"):g.toFixed(1)}</span>`).join("");return{...c,html:`${f.get("Play Speed")}: ${p}`,click:(g,v)=>{let{value:E}=v.target.dataset;E&&(d.playbackRate=Number(E),g.show=!1)},mounted:g=>{let v=(0,a.query)('[data-value="1"]',g);v&&(0,a.inverseClass)(v,"art-current"),d.on("video:ratechange",()=>{let E=(0,a.queryAll)("span",g).find(x=>Number(x.dataset.value)===d.playbackRate);E&&(0,a.inverseClass)(E,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aJBeL:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>function(o){return{...o,html:`<a href="https://artplayer.org" target="_blank">ArtPlayer ${a.version}</a>`}});var a=l("../../package.json")},{"../../package.json":"lh3R5","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dp1yk:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("../utils"),o=l("../utils/component"),c=n.interopDefault(o),d=l("./airplay"),f=n.interopDefault(d),m=l("./fullscreen"),p=n.interopDefault(m),g=l("./fullscreenWeb"),v=n.interopDefault(g),E=l("./pip"),x=n.interopDefault(E),T=l("./playAndPause"),A=n.interopDefault(T),b=l("./progress"),_=n.interopDefault(b),I=l("./screenshot"),C=n.interopDefault(I),N=l("./setting"),w=n.interopDefault(N),P=l("./time"),B=n.interopDefault(P),M=l("./volume"),K=n.interopDefault(M);class tt extends c.default{constructor(G){super(G),this.isHover=!1,this.name="control",this.timer=Date.now();let{constructor:Y}=G,{$player:O,$bottom:j}=this.art.template;G.on("mousemove",()=>{a.isMobile||(this.show=!0)}),G.on("click",()=>{a.isMobile?this.toggle():this.show=!0}),G.on("document:mousemove",X=>{this.isHover=(0,a.includeFromEvent)(X,j)}),G.on("video:timeupdate",()=>{!G.setting.show&&!this.isHover&&!G.isInput&&G.playing&&this.show&&Date.now()-this.timer>=Y.CONTROL_HIDE_TIME&&(this.show=!1)}),G.on("control",X=>{X?((0,a.removeClass)(O,"art-hide-cursor"),(0,a.addClass)(O,"art-hover"),this.timer=Date.now()):((0,a.addClass)(O,"art-hide-cursor"),(0,a.removeClass)(O,"art-hover"))}),this.init()}init(){let{option:G}=this.art;G.isLive||this.add((0,_.default)({name:"progress",position:"top",index:10})),this.add({name:"thumbnails",position:"top",index:20}),this.add((0,A.default)({name:"playAndPause",position:"left",index:10})),this.add((0,K.default)({name:"volume",position:"left",index:20})),G.isLive||this.add((0,B.default)({name:"time",position:"left",index:30})),G.quality.length&&(0,a.sleep)().then(()=>{this.art.quality=G.quality}),G.screenshot&&!a.isMobile&&this.add((0,C.default)({name:"screenshot",position:"right",index:20})),G.setting&&this.add((0,w.default)({name:"setting",position:"right",index:30})),G.pip&&this.add((0,x.default)({name:"pip",position:"right",index:40})),G.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,f.default)({name:"airplay",position:"right",index:50})),G.fullscreenWeb&&this.add((0,v.default)({name:"fullscreenWeb",position:"right",index:60})),G.fullscreen&&this.add((0,p.default)({name:"fullscreen",position:"right",index:70}));for(let Y=0;Y<G.controls.length;Y++)this.add(G.controls[Y])}add(G){let Y=typeof G=="function"?G(this.art):G,{$progress:O,$controlsLeft:j,$controlsRight:X}=this.art.template;switch(Y.position){case"top":this.$parent=O;break;case"left":this.$parent=j;break;case"right":this.$parent=X;break;default:(0,a.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(Y)}check(G){G.$control_value.innerHTML=G.html;for(let Y=0;Y<G.$control_option.length;Y++){let O=G.$control_option[Y];O.default=O===G,O.default&&(0,a.inverseClass)(O.$control_item,"art-current")}}selector(G,Y,O){let{proxy:j}=this.art.events;(0,a.addClass)(Y,"art-control-selector");let X=(0,a.createElement)("div");(0,a.addClass)(X,"art-selector-value"),(0,a.append)(X,G.html),Y.textContent="",(0,a.append)(Y,X);let rt=(0,a.createElement)("div");(0,a.addClass)(rt,"art-selector-list"),(0,a.append)(Y,rt);for(let k=0;k<G.selector.length;k++){let U=G.selector[k],it=(0,a.createElement)("div");(0,a.addClass)(it,"art-selector-item"),U.default&&(0,a.addClass)(it,"art-current"),it.dataset.index=k,it.dataset.value=U.value,it.innerHTML=U.html,(0,a.append)(rt,it),(0,a.def)(U,"$control_option",{get:()=>G.selector}),(0,a.def)(U,"$control_item",{get:()=>it}),(0,a.def)(U,"$control_value",{get:()=>X})}let ct=j(rt,"click",async k=>{let U=(0,a.getComposedPath)(k),it=G.selector.find(ut=>ut.$control_item===U.find(ft=>ut.$control_item===ft));this.check(it),G.onSelect&&(X.innerHTML=await G.onSelect.call(this.art,it,it.$control_item,k))});O.push(ct)}}e.default=tt},{"../utils":"aBlEo","../utils/component":"idCEj","./airplay":"amOzz","./fullscreen":"3GuBU","./fullscreenWeb":"jj1KV","./pip":"jMeHN","./playAndPause":"u3h8M","./progress":"1XZSS","./screenshot":"dIscA","./setting":"aqA0g","./time":"ihweO","./volume":"fJVWn","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],amOzz:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("AirPlay"),mounted:f=>{let{proxy:m,icons:p}=d;(0,a.append)(f,p.airplay),m(f,"click",()=>d.airplay())}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3GuBU":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("Fullscreen"),mounted:f=>{let{proxy:m,icons:p,i18n:g}=d,v=(0,a.append)(f,p.fullscreenOn),E=(0,a.append)(f,p.fullscreenOff);(0,a.setStyle)(E,"display","none"),m(f,"click",()=>{d.fullscreen=!d.fullscreen}),d.on("fullscreen",x=>{x?((0,a.tooltip)(f,g.get("Exit Fullscreen")),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(E,"display","inline-flex")):((0,a.tooltip)(f,g.get("Fullscreen")),(0,a.setStyle)(v,"display","inline-flex"),(0,a.setStyle)(E,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jj1KV:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("Web Fullscreen"),mounted:f=>{let{proxy:m,icons:p,i18n:g}=d,v=(0,a.append)(f,p.fullscreenWebOn),E=(0,a.append)(f,p.fullscreenWebOff);(0,a.setStyle)(E,"display","none"),m(f,"click",()=>{d.fullscreenWeb=!d.fullscreenWeb}),d.on("fullscreenWeb",x=>{x?((0,a.tooltip)(f,g.get("Exit Web Fullscreen")),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(E,"display","inline-flex")):((0,a.tooltip)(f,g.get("Web Fullscreen")),(0,a.setStyle)(v,"display","inline-flex"),(0,a.setStyle)(E,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jMeHN:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("PIP Mode"),mounted:f=>{let{proxy:m,icons:p,i18n:g}=d;(0,a.append)(f,p.pip),m(f,"click",()=>{d.pip=!d.pip}),d.on("pip",v=>{(0,a.tooltip)(f,g.get(v?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],u3h8M:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,mounted:f=>{let{proxy:m,icons:p,i18n:g}=d,v=(0,a.append)(f,p.play),E=(0,a.append)(f,p.pause);function x(){(0,a.setStyle)(v,"display","flex"),(0,a.setStyle)(E,"display","none")}function T(){(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(E,"display","flex")}(0,a.tooltip)(v,g.get("Play")),(0,a.tooltip)(E,g.get("Pause")),m(v,"click",()=>{d.play()}),m(E,"click",()=>{d.pause()}),d.playing?T():x(),d.on("video:playing",()=>{T()}),d.on("video:pause",()=>{x()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1XZSS":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"getPosFromEvent",()=>o),n.export(e,"setCurrentTime",()=>c),n.export(e,"default",()=>d);var a=l("../utils");function o(f,m){let{$progress:p}=f.template,{left:g}=(0,a.getRect)(p),v=a.isMobile?m.touches[0].clientX:m.clientX,E=(0,a.clamp)(v-g,0,p.clientWidth),x=E/p.clientWidth*f.duration,T=(0,a.secondToTime)(x),A=(0,a.clamp)(E/p.clientWidth,0,1);return{second:x,time:T,width:E,percentage:A}}function c(f,m){if(f.isRotate){let p=m.touches[0].clientY/f.height,g=p*f.duration;f.emit("setBar","played",p,m),f.seek=g}else{let{second:p,percentage:g}=o(f,m);f.emit("setBar","played",g,m),f.seek=p}}function d(f){return m=>{let{icons:p,option:g,proxy:v}=m;return{...f,html:'<div class="art-control-progress-inner"><div class="art-progress-hover"></div><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:E=>{let x=null,T=!1,A=(0,a.query)(".art-progress-hover",E),b=(0,a.query)(".art-progress-loaded",E),_=(0,a.query)(".art-progress-played",E),I=(0,a.query)(".art-progress-highlight",E),C=(0,a.query)(".art-progress-indicator",E),N=(0,a.query)(".art-progress-tip",E);function w(P,B){let{width:M,time:K}=B||o(m,P);N.textContent=K;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>E.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${E.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}p.indicator?(0,a.append)(C,p.indicator):(0,a.setStyle)(C,"backgroundColor","var(--art-theme)"),m.on("setBar",function(P,B,M){let K=P==="played"&&M&&a.isMobile;P==="loaded"&&(0,a.setStyle)(b,"width",`${100*B}%`),P==="hover"&&(0,a.setStyle)(A,"width",`${100*B}%`),P==="played"&&((0,a.setStyle)(_,"width",`${100*B}%`),(0,a.setStyle)(C,"left",`${100*B}%`)),K&&((0,a.setStyle)(N,"display","flex"),w(M,{width:E.clientWidth*B,time:(0,a.secondToTime)(B*m.duration)}),clearTimeout(x),x=setTimeout(()=>{(0,a.setStyle)(N,"display","none")},500))}),m.on("video:loadedmetadata",function(){I.textContent="";for(let P=0;P<g.highlight.length;P++){let B=g.highlight[P],M=(0,a.clamp)(B.time,0,m.duration)/m.duration*100,K=`<span data-text="${B.text}" data-time="${B.time}" style="left: ${M}%"></span>`;(0,a.append)(I,K)}}),m.constructor.USE_RAF?m.on("raf",()=>{m.emit("setBar","played",m.played),m.emit("setBar","loaded",m.loaded)}):(m.on("video:timeupdate",()=>{m.emit("setBar","played",m.played)}),m.on("video:progress",()=>{m.emit("setBar","loaded",m.loaded)}),m.on("video:ended",()=>{m.emit("setBar","played",1)})),m.emit("setBar","loaded",m.loaded||0),a.isMobile||(v(E,"click",P=>{P.target!==C&&c(m,P)}),v(E,"mousemove",P=>{let{percentage:B}=o(m,P);if(m.emit("setBar","hover",B,P),(0,a.setStyle)(N,"display","flex"),(0,a.includeFromEvent)(P,I)){let{width:M}=o(m,P),{text:K}=P.target.dataset;N.textContent=K;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>E.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${E.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}else w(P)}),v(E,"mouseleave",P=>{(0,a.setStyle)(N,"display","none"),m.emit("setBar","hover",0,P)}),v(E,"mousedown",P=>{T=P.button===0}),m.on("document:mousemove",P=>{if(T){let{second:B,percentage:M}=o(m,P);m.emit("setBar","played",M,P),m.seek=B}}),m.on("document:mouseup",()=>{T&&(T=!1)}))}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dIscA:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("Screenshot"),mounted:f=>{let{proxy:m,icons:p}=d;(0,a.append)(f,p.screenshot),m(f,"click",()=>{d.screenshot()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aqA0g:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,tooltip:d.i18n.get("Show Setting"),mounted:f=>{let{proxy:m,icons:p,i18n:g}=d;(0,a.append)(f,p.setting),m(f,"click",()=>{d.setting.toggle(),d.setting.resize()}),d.on("setting",v=>{(0,a.tooltip)(f,g.get(v?"Hide Setting":"Show Setting"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ihweO:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,style:a.isMobile?{fontSize:"12px",padding:"0 5px"}:{cursor:"auto",padding:"0 10px"},mounted:f=>{function m(){let g=`${(0,a.secondToTime)(d.currentTime)} / ${(0,a.secondToTime)(d.duration)}`;g!==f.textContent&&(f.textContent=g)}m();let p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let g=0;g<p.length;g++)d.on(p[g],m)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fJVWn:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return d=>({...c,mounted:f=>{let{proxy:m,icons:p}=d,g=(0,a.append)(f,p.volume),v=(0,a.append)(f,p.volumeClose),E=(0,a.append)(f,'<div class="art-volume-panel"></div>'),x=(0,a.append)(E,'<div class="art-volume-inner"></div>'),T=(0,a.append)(x,'<div class="art-volume-val"></div>'),A=(0,a.append)(x,'<div class="art-volume-slider"></div>'),b=(0,a.append)(A,'<div class="art-volume-handle"></div>'),_=(0,a.append)(b,'<div class="art-volume-loaded"></div>'),I=(0,a.append)(A,'<div class="art-volume-indicator"></div>');function C(w){let{top:P,height:B}=(0,a.getRect)(A);return 1-(w.clientY-P)/B}function N(){if(d.muted||d.volume===0)(0,a.setStyle)(g,"display","none"),(0,a.setStyle)(v,"display","flex"),(0,a.setStyle)(I,"top","100%"),(0,a.setStyle)(_,"top","100%"),T.textContent=0;else{let w=100*d.volume;(0,a.setStyle)(g,"display","flex"),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(I,"top",`${100-w}%`),(0,a.setStyle)(_,"top",`${100-w}%`),T.textContent=Math.floor(w)}}if(N(),d.on("video:volumechange",N),m(g,"click",()=>{d.muted=!0}),m(v,"click",()=>{d.muted=!1}),a.isMobile)(0,a.setStyle)(E,"display","none");else{let w=!1;m(A,"mousedown",P=>{w=P.button===0,d.volume=C(P)}),d.on("document:mousemove",P=>{w&&(d.muted=!1,d.volume=C(P))}),d.on("document:mouseup",()=>{w&&(w=!1)})}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jmVSD:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./clickInit"),o=n.interopDefault(a),c=l("./gestureInit"),d=n.interopDefault(c),f=l("./globalInit"),m=n.interopDefault(f),p=l("./hoverInit"),g=n.interopDefault(p),v=l("./moveInit"),E=n.interopDefault(v),x=l("./resizeInit"),T=n.interopDefault(x),A=l("./updateInit"),b=n.interopDefault(A),_=l("./viewInit"),I=n.interopDefault(_);e.default=class{constructor(C){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),(0,o.default)(C,this),(0,g.default)(C,this),(0,E.default)(C,this),(0,T.default)(C,this),(0,d.default)(C,this),(0,I.default)(C,this),(0,m.default)(C,this),(0,b.default)(C,this)}proxy(C,N,w,P={}){if(Array.isArray(N))return N.map(M=>this.proxy(C,M,w,P));C.addEventListener(N,w,P);let B=()=>C.removeEventListener(N,w,P);return this.destroyEvents.push(B),B}hover(C,N,w){N&&this.proxy(C,"mouseenter",N),w&&this.proxy(C,"mouseleave",w)}remove(C){let N=this.destroyEvents.indexOf(C);N>-1&&(C(),this.destroyEvents.splice(N,1))}destroy(){for(let C=0;C<this.destroyEvents.length;C++)this.destroyEvents[C]()}}},{"./clickInit":"i8G6V","./gestureInit":"9wEzB","./globalInit":"ikBrS","./hoverInit":"jwNq0","./moveInit":"eqSsP","./resizeInit":"42JNz","./updateInit":"7kM1M","./viewInit":"2IW9m","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i8G6V:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c,d){let{constructor:f,template:{$player:m,$video:p}}=c;function g(E){(0,a.includeFromEvent)(E,m)?(c.isInput=E.target.tagName==="INPUT",c.isFocus=!0,c.emit("focus",E)):(c.isInput=!1,c.isFocus=!1,c.emit("blur",E))}c.on("document:click",g),c.on("document:contextmenu",g);let v=[];d.proxy(p,"click",E=>{let x=Date.now();v.push(x);let{MOBILE_CLICK_PLAY:T,DBCLICK_TIME:A,MOBILE_DBCLICK_PLAY:b,DBCLICK_FULLSCREEN:_}=f,I=v.filter(C=>x-C<=A);switch(I.length){case 1:c.emit("click",E),a.isMobile?!c.isLock&&T&&c.toggle():c.toggle(),v=I;break;case 2:c.emit("dblclick",E),a.isMobile?!c.isLock&&b&&c.toggle():_&&(c.fullscreen=!c.fullscreen),v=[];break;default:v=[]}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"9wEzB":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>c);var a=l("../control/progress"),o=l("../utils");function c(d,f){if(o.isMobile&&!d.option.isLive){let{$video:m,$progress:p}=d.template,g=null,v=!1,E=0,x=0,T=0,A=_=>{if(_.touches.length===1&&!d.isLock){g===p&&(0,a.setCurrentTime)(d,_),v=!0;let{pageX:I,pageY:C}=_.touches[0];E=I,x=C,T=d.currentTime}},b=_=>{if(_.touches.length===1&&v&&d.duration){let{pageX:I,pageY:C}=_.touches[0],N=(function(B,M,K,tt){let H=M-tt,G=K-B,Y=0;if(2>Math.abs(G)&&2>Math.abs(H))return Y;let O=180*Math.atan2(H,G)/Math.PI;return O>=-45&&O<45?Y=4:O>=45&&O<135?Y=1:O>=-135&&O<-45?Y=2:(O>=135&&O<=180||O>=-180&&O<-135)&&(Y=3),Y})(E,x,I,C),w=[3,4].includes(N),P=[1,2].includes(N);if(w&&!d.isRotate||P&&d.isRotate){let B=(0,o.clamp)((I-E)/d.width,-1,1),M=(0,o.clamp)((C-x)/d.height,-1,1),K=d.isRotate?M:B,tt=g===m?d.constructor.TOUCH_MOVE_RATIO:1,H=(0,o.clamp)(T+d.duration*K*tt,0,d.duration);d.seek=H,d.emit("setBar","played",(0,o.clamp)(H/d.duration,0,1),_),d.notice.show=`${(0,o.secondToTime)(H)} / ${(0,o.secondToTime)(d.duration)}`}}};d.option.gesture&&(f.proxy(m,"touchstart",_=>{g=m,A(_)}),f.proxy(m,"touchmove",b)),f.proxy(p,"touchstart",_=>{g=p,A(_)}),f.proxy(p,"touchmove",b),d.on("document:touchend",()=>{v&&(E=0,x=0,T=0,v=!1,g=null)})}}},{"../control/progress":"1XZSS","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ikBrS:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o,c){let d=["click","mouseup","keydown","touchend","touchmove","mousemove","pointerup","contextmenu","pointermove","visibilitychange","webkitfullscreenchange"],f=["resize","scroll","orientationchange"],m=[];function p(g={}){for(let E=0;E<m.length;E++)c.remove(m[E]);m.length=0;let{$player:v}=o.template;d.forEach(E=>{let x=g.document||v.ownerDocument||document,T=c.proxy(x,E,A=>{o.emit(`document:${E}`,A)});m.push(T)}),f.forEach(E=>{let x=g.window||v.ownerDocument?.defaultView||window,T=c.proxy(x,E,A=>{o.emit(`window:${E}`,A)});m.push(T)})}p(),c.bindGlobalEvents=p}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jwNq0:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c,d){let{$player:f}=c.template;d.hover(f,m=>{(0,a.addClass)(f,"art-hover"),c.emit("hover",!0,m)},m=>{(0,a.removeClass)(f,"art-hover"),c.emit("hover",!1,m)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eqSsP:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o,c){let{$player:d}=o.template;c.proxy(d,"mousemove",f=>{o.emit("mousemove",f)})}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"42JNz":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c,d){let{option:f,constructor:m}=c;c.on("resize",()=>{let{aspectRatio:g,notice:v}=c;c.state==="standard"&&f.autoSize&&c.autoSize(),c.aspectRatio=g,v.show=""});let p=(0,a.debounce)(()=>c.emit("resize"),m.RESIZE_TIME);c.on("window:orientationchange",()=>p()),c.on("window:resize",()=>p()),screen&&screen.orientation&&screen.orientation.onchange&&d.proxy(screen.orientation,"change",()=>p())}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7kM1M":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){if(o.constructor.USE_RAF){let c=null;(function d(){o.playing&&o.emit("raf"),o.isDestroy||(c=requestAnimationFrame(d))})(),o.on("destroy",()=>{cancelAnimationFrame(c)})}}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2IW9m":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{option:d,constructor:f,template:{$container:m}}=c,p=(0,a.throttle)(()=>{c.emit("view",(0,a.isInViewport)(m,f.SCROLL_GAP))},f.SCROLL_TIME);c.on("window:scroll",()=>p()),c.on("view",g=>{d.autoMini&&(c.mini=!g)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dswts:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var n=l("./utils");e.default=class{constructor(a){this.art=a,this.keys={},a.option.hotkey&&!n.isMobile&&this.init()}init(){let{constructor:a}=this.art;this.add("Escape",()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add("Space",()=>{this.art.toggle()}),this.add("ArrowLeft",()=>{this.art.backward=a.SEEK_STEP}),this.add("ArrowUp",()=>{this.art.volume+=a.VOLUME_STEP}),this.add("ArrowRight",()=>{this.art.forward=a.SEEK_STEP}),this.add("ArrowDown",()=>{this.art.volume-=a.VOLUME_STEP}),this.art.on("document:keydown",o=>{if(this.art.isFocus){let c=document.activeElement.tagName.toUpperCase(),d=document.activeElement.getAttribute("contenteditable");if(c!=="INPUT"&&c!=="TEXTAREA"&&d!==""&&d!=="true"&&!o.altKey&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey){let f=this.keys[o.code];if(f){o.preventDefault();for(let m=0;m<f.length;m++)f[m].call(this.art,o);this.art.emit("hotkey",o)}}}this.art.emit("keydown",o)})}add(a,o){return this.keys[a]?this.keys[a].push(o):this.keys[a]=[o],this}remove(a,o){if(this.keys[a]){let c=this.keys[a].indexOf(o);c!==-1&&this.keys[a].splice(c,1)}return this}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d9ktO:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("../utils"),o=l("./zh-cn"),c=n.interopDefault(o);e.default=class{constructor(d){this.art=d,this.languages={"zh-cn":c.default},this.language={},this.update(d.option.i18n)}init(){let d=this.art.option.lang.toLowerCase();this.language=this.languages[d]||{}}get(d){return this.language[d]||d}update(d){this.languages=(0,a.mergeDeep)(this.languages,d),this.init()}}},{"../utils":"aBlEo","./zh-cn":"3hyaR","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3hyaR":[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let n={"Video Info":"",Close:"","Video Load Failed":"",Volume:"",Play:"",Pause:"",Rate:"",Mute:"","Video Flip":"",Horizontal:"",Vertical:"",Reconnect:"","Show Setting":"","Hide Setting":"",Screenshot:"","Play Speed":"","Aspect Ratio":"",Default:"",Normal:"",Open:"","Switch Video":"","Switch Subtitle":"",Fullscreen:"","Exit Fullscreen":"","Web Fullscreen":"","Exit Web Fullscreen":"","Mini Player":"","PIP Mode":"","Exit PIP Mode":"","PIP Not Supported":"","Fullscreen Not Supported":"","Subtitle Offset":"","Last Seen":"","Jump Play":"",AirPlay:"","AirPlay Not Available":""};e.default=n,typeof window<"u"&&(window["artplayer-i18n-zh-cn"]=n)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fFHY0:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("bundle-text:./airplay.svg"),o=n.interopDefault(a),c=l("bundle-text:./arrow-left.svg"),d=n.interopDefault(c),f=l("bundle-text:./arrow-right.svg"),m=n.interopDefault(f),p=l("bundle-text:./aspect-ratio.svg"),g=n.interopDefault(p),v=l("bundle-text:./check.svg"),E=n.interopDefault(v),x=l("bundle-text:./close.svg"),T=n.interopDefault(x),A=l("bundle-text:./config.svg"),b=n.interopDefault(A),_=l("bundle-text:./error.svg"),I=n.interopDefault(_),C=l("bundle-text:./flip.svg"),N=n.interopDefault(C),w=l("bundle-text:./fullscreen-off.svg"),P=n.interopDefault(w),B=l("bundle-text:./fullscreen-on.svg"),M=n.interopDefault(B),K=l("bundle-text:./fullscreen-web-off.svg"),tt=n.interopDefault(K),H=l("bundle-text:./fullscreen-web-on.svg"),G=n.interopDefault(H),Y=l("bundle-text:./loading.svg"),O=n.interopDefault(Y),j=l("bundle-text:./lock.svg"),X=n.interopDefault(j),rt=l("bundle-text:./pause.svg"),ct=n.interopDefault(rt),k=l("bundle-text:./pip.svg"),U=n.interopDefault(k),it=l("bundle-text:./play.svg"),ut=n.interopDefault(it),ft=l("bundle-text:./playback-rate.svg"),dt=n.interopDefault(ft),St=l("bundle-text:./screenshot.svg"),Dt=n.interopDefault(St),It=l("bundle-text:./setting.svg"),ae=n.interopDefault(It),Se=l("bundle-text:./state.svg"),Be=n.interopDefault(Se),mi=l("bundle-text:./switch-off.svg"),Le=n.interopDefault(mi),ki=l("bundle-text:./switch-on.svg"),bt=n.interopDefault(ki),pt=l("bundle-text:./unlock.svg"),Te=n.interopDefault(pt),le=l("bundle-text:./volume-close.svg"),oe=n.interopDefault(le),De=l("bundle-text:./volume.svg"),Fe=n.interopDefault(De),$e=l("../utils");e.default=class{constructor(ee){let Xi={loading:O.default,state:Be.default,play:ut.default,pause:ct.default,check:E.default,volume:Fe.default,volumeClose:oe.default,screenshot:Dt.default,setting:ae.default,pip:U.default,arrowLeft:d.default,arrowRight:m.default,playbackRate:dt.default,aspectRatio:g.default,config:b.default,lock:X.default,flip:N.default,unlock:Te.default,fullscreenOff:P.default,fullscreenOn:M.default,fullscreenWebOff:tt.default,fullscreenWebOn:G.default,switchOn:bt.default,switchOff:Le.default,error:I.default,close:T.default,airplay:o.default,...ee.option.icons};for(let Ke in Xi)(0,$e.def)(this,Ke,{get:()=>(0,$e.getIcon)(Ke,Xi[Ke])})}}},{"bundle-text:./airplay.svg":"gkZgZ","bundle-text:./arrow-left.svg":"kQyD4","bundle-text:./arrow-right.svg":"64ztm","bundle-text:./aspect-ratio.svg":"72LvA","bundle-text:./check.svg":"4QmBo","bundle-text:./close.svg":"j1hoe","bundle-text:./config.svg":"hNZaT","bundle-text:./error.svg":"dKh4l","bundle-text:./flip.svg":"lIEIE","bundle-text:./fullscreen-off.svg":"1533e","bundle-text:./fullscreen-on.svg":"76ut3","bundle-text:./fullscreen-web-off.svg":"3NzMk","bundle-text:./fullscreen-web-on.svg":"12xHc","bundle-text:./loading.svg":"iVcUF","bundle-text:./lock.svg":"1J4so","bundle-text:./pause.svg":"1KgkK","bundle-text:./pip.svg":"4h4tM","bundle-text:./play.svg":"jecAY","bundle-text:./playback-rate.svg":"anPe9","bundle-text:./screenshot.svg":"9BPYQ","bundle-text:./setting.svg":"hsI9k","bundle-text:./state.svg":"gr1ZU","bundle-text:./switch-off.svg":"6kdAr","bundle-text:./switch-on.svg":"ksdMo","bundle-text:./unlock.svg":"iz5Qc","bundle-text:./volume-close.svg":"3OZoa","bundle-text:./volume.svg":"hRYA4","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],gkZgZ:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/><path d="M4 17h10l-5-6Z"/></svg>'},{}],kQyD4:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6Z"/></svg>'},{}],"64ztm":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6Z"/></svg>'},{}],"72LvA":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;transform:translate(0)" viewBox="0 0 88 88"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0Z"/></clipPath></defs><g clip-path="url(#__lottie_element_216)"><g style="display:block"><path d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 1.4495849676166017e-7l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31C14.488-13.492 13.228-13.492 12.438-12.702m-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13ZM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8Z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></g></svg>'},{}],"4QmBo":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%" viewBox="0 0 24 24"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4Z"/></svg>'},{}],j1hoe:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733C823.467 166.4 797.867 166.4 780.8 183.466L512 452.267l-268.8-268.8C226.133 166.4 200.533 166.4 183.467 183.466c-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733Z"/></svg>'},{}],hNZaT:[function(l,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M15 17h6v1h-6Zm-4 0H3v1h8v2h1v-5h-1Zm3-9h1V3h-1v2H3v1h11Zm4-3v1h3V5ZM6 14h1V9H6v2H3v1h3Zm4-2h11v-1H10Z" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],dKh4l:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.1 93.1 0 0 1 34.447 33.341M512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88m0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2"/></svg>'},{}],lIEIE:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon" viewBox="0 0 1024 1024"><path d="M554.667 810.667V896h-85.333v-85.333Zm-384-632.662a42.67 42.67 0 0 1 34.987 18.219l203.903 291.328a42.67 42.67 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667m682.666 0a42.667 42.667 0 0 1 42.368 37.717l.299 4.95v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.67 42.67 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.67 42.67 0 0 1 34.944-18.219M554.667 640v85.333h-85.333V640Zm-358.4-320.896V716.8L335.957 512 196.31 319.104Zm358.4 150.23v85.333h-85.333v-85.333Zm0-170.667V384h-85.333v-85.333Zm0-170.667v85.333h-85.333V128Z"/></svg>'},{}],"1533e":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M768 298.667h170.667V384h-256V128H768ZM341.333 384h-256v-85.333H256V128h85.333ZM768 725.333V896h-85.333V640h256v85.333ZM341.333 640v256H256V725.333H85.333V640Z"/></svg>'},{}],"76ut3":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M625.778 256H768v142.222h113.778v-256h-256ZM256 398.222V256h142.222V142.222h-256v256Zm512 227.556V768H625.778v113.778h256v-256ZM398.222 768H256V625.778H142.222v256h256Z"/></svg>'},{}],"3NzMk":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128ZM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384Zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448Z"/></svg>'},{}],"12xHc":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128Zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448Zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384Z"/></svg>'},{}],iVcUF:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" class="uil-default" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><path fill="none" d="M0 0h100v100H0Z" class="bk"/><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="translate(0 -30)"><animate attributeName="opacity" begin="-1s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(30 105.98 65)"><animate attributeName="opacity" begin="-0.9166666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(60 75.98 65)"><animate attributeName="opacity" begin="-0.8333333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(90 65 65)"><animate attributeName="opacity" begin="-0.75s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(120 58.66 65)"><animate attributeName="opacity" begin="-0.6666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(150 54.02 65)"><animate attributeName="opacity" begin="-0.5833333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="matrix(-1 0 0 -1 100 130)"><animate attributeName="opacity" begin="-0.5s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(210 45.98 65)"><animate attributeName="opacity" begin="-0.4166666666666667s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(240 41.34 65)"><animate attributeName="opacity" begin="-0.3333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-90 35 65)"><animate attributeName="opacity" begin="-0.25s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" begin="-0.16666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" begin="-0.08333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect></svg>'},{}],"1J4so":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="M298.667 426.667v-85.333a213.333 213.333 0 1 1 426.667 0v85.333H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667ZM512 213.333a128 128 0 0 0-128 128v85.333h256v-85.333a128 128 0 0 0-128-128"/></svg>'},{}],"1KgkK":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2m8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2"/></svg>'},{}],"4h4tM":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 1024 1024"><path d="M844.8 219.648H179.2c-6.144 0-10.24 4.608-10.24 10.752v563.2c0 5.632 4.096 10.24 10.24 10.24h256V896h-256A102.4 102.4 0 0 1 76.8 793.6V230.4c0-56.832 45.568-102.4 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v204.8h-92.16V230.4c0-6.144-4.608-10.752-10.24-10.752M614.4 588.8c-28.672 0-51.2 22.528-51.2 51.2v204.8c0 28.16 22.528 51.2 51.2 51.2H896c28.16 0 51.2-23.04 51.2-51.2V640c0-28.672-23.04-51.2-51.2-51.2Z"/></svg>'},{}],jecAY:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45"/></svg>'},{}],anPe9:[function(l,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M10 8v8l6-4ZM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2M5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8m0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4Zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22ZM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"9BPYQ":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10m0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8"/></svg>'},{}],hsI9k:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a7 7 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1 1 0 0 0-1.272.23l-1.008 1.225a7 7 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A7 7 0 0 0 4.4 8.6l-1.564.261A1 1 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.1 7.1 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a1 1 0 0 0 .835-.986V9.847a1 1 0 0 0-.836-.986M11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8"/></svg>'},{}],gr1ZU:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><path d="M9.5 9.325v5.35q0 .575.525.875t1.025-.05l4.15-2.65q.475-.3.475-.85t-.475-.85L11.05 8.5q-.5-.35-1.025-.05t-.525.875M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12t.788-3.9 2.137-3.175q1.35-1.35 3.175-2.137T12 2t3.9.788 3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22"/></svg>'},{}],"6kdAr":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1740 1024"><path d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898m-.564-975.36A464.589 464.589 0 1 1 48.025 513.024 463.87 463.87 0 0 1 511.335 48.435Z"/></svg>'},{}],ksdMo:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1664 1024"><path fill="#648ffc" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448"/></svg>'},{}],iz5Qc:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.333a213.333 213.333 0 0 1 368.085-146.816"/></svg>'},{}],"3OZoa":[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M15 11a4 4 0 0 0-2-3.465v2.636l1.865 1.865A4 4 0 0 0 15 11"/><path d="M13.583 5.583A6 6 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8 8 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805m5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806q.322-.154.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416M11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172Z"/></svg>'},{}],hRYA4:[function(l,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39m4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8 8 0 0 0 19 11a8 8 0 0 0-4.554-7.222"/><path d="M15 11a4 4 0 0 0-2-3.465v6.93A4 4 0 0 0 15 11"/></svg>'},{}],kZ0F8:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./utils"),o=l("./utils/component"),c=n.interopDefault(o);class d extends c.default{constructor(m){super(m),this.name="info",a.isMobile||this.init()}init(){let{proxy:m,constructor:p,template:{$infoPanel:g,$infoClose:v,$video:E}}=this.art;m(v,"click",()=>{this.show=!1});let x=null,T=(0,a.queryAll)("[data-video]",g)||[];this.art.on("destroy",()=>clearTimeout(x)),(function A(){for(let b=0;b<T.length;b++){let _=T[b],I=E[_.dataset.video],C=typeof I=="number"?I.toFixed(2):I;_.textContent!==C&&(_.textContent=C)}x=setTimeout(A,p.INFO_LOOP_TIME)})()}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j9lbi:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./utils/component"),o=n.interopDefault(a);class c extends o.default{constructor(f){super(f);let{option:m,template:{$layer:p}}=f;this.name="layer",this.$parent=p;for(let g=0;g<m.layers.length;g++)this.add(m.layers[g])}}e.default=c},{"./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bMjWd:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./utils"),o=l("./utils/component"),c=n.interopDefault(o);class d extends c.default{constructor(m){super(m),this.name="loading",(0,a.append)(m.template.$loading,m.icons.loading)}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k1nkQ:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./utils"),o=l("./utils/component"),c=n.interopDefault(o);class d extends c.default{constructor(m){super(m),this.name="mask";let{template:p,icons:g,events:v}=m,E=(0,a.append)(p.$state,g.state),x=(0,a.append)(p.$state,g.error);(0,a.setStyle)(x,"display","none"),m.on("destroy",()=>{(0,a.setStyle)(E,"display","none"),(0,a.setStyle)(x,"display",null)}),v.proxy(p.$state,"click",()=>m.play())}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fPVaU:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var n=l("./utils");e.default=class{constructor(a){this.art=a,this.timer=null}set show(a){let{constructor:o,template:{$player:c,$noticeInner:d}}=this.art;a?(d.textContent=a instanceof Error?a.message.trim():a,(0,n.addClass)(c,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{d.textContent="",(0,n.removeClass)(c,"art-notice-show")},o.NOTICE_TIME)):(0,n.removeClass)(c,"art-notice-show")}get show(){let{template:{$player:a}}=this.art;return a.classList.contains("art-notice-show")}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],uR0Sw:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("./airplayMix"),o=n.interopDefault(a),c=l("./aspectRatioMix"),d=n.interopDefault(c),f=l("./attrMix"),m=n.interopDefault(f),p=l("./autoHeightMix"),g=n.interopDefault(p),v=l("./autoSizeMix"),E=n.interopDefault(v),x=l("./cssVarMix"),T=n.interopDefault(x),A=l("./currentTimeMix"),b=n.interopDefault(A),_=l("./durationMix"),I=n.interopDefault(_),C=l("./eventInit"),N=n.interopDefault(C),w=l("./flipMix"),P=n.interopDefault(w),B=l("./fullscreenMix"),M=n.interopDefault(B),K=l("./fullscreenWebMix"),tt=n.interopDefault(K),H=l("./loadedMix"),G=n.interopDefault(H),Y=l("./miniMix"),O=n.interopDefault(Y),j=l("./optionInit"),X=n.interopDefault(j),rt=l("./pauseMix"),ct=n.interopDefault(rt),k=l("./pipMix"),U=n.interopDefault(k),it=l("./playbackRateMix"),ut=n.interopDefault(it),ft=l("./playedMix"),dt=n.interopDefault(ft),St=l("./playingMix"),Dt=n.interopDefault(St),It=l("./playMix"),ae=n.interopDefault(It),Se=l("./posterMix"),Be=n.interopDefault(Se),mi=l("./qualityMix"),Le=n.interopDefault(mi),ki=l("./rectMix"),bt=n.interopDefault(ki),pt=l("./screenshotMix"),Te=n.interopDefault(pt),le=l("./seekMix"),oe=n.interopDefault(le),De=l("./stateMix"),Fe=n.interopDefault(De),$e=l("./subtitleOffsetMix"),ee=n.interopDefault($e),Xi=l("./switchMix"),Ke=n.interopDefault(Xi),Js=l("./themeMix"),xs=n.interopDefault(Js),Dn=l("./thumbnailsMix"),tn=n.interopDefault(Dn),Qi=l("./toggleMix"),Xo=n.interopDefault(Qi),en=l("./typeMix"),je=n.interopDefault(en),Oi=l("./urlMix"),Ge=n.interopDefault(Oi),Qo=l("./volumeMix"),Wo=n.interopDefault(Qo);e.default=class{constructor(kt){(0,Ge.default)(kt),(0,m.default)(kt),(0,ae.default)(kt),(0,ct.default)(kt),(0,Xo.default)(kt),(0,oe.default)(kt),(0,Wo.default)(kt),(0,b.default)(kt),(0,I.default)(kt),(0,Ke.default)(kt),(0,ut.default)(kt),(0,d.default)(kt),(0,Te.default)(kt),(0,M.default)(kt),(0,tt.default)(kt),(0,U.default)(kt),(0,G.default)(kt),(0,dt.default)(kt),(0,Dt.default)(kt),(0,E.default)(kt),(0,bt.default)(kt),(0,P.default)(kt),(0,O.default)(kt),(0,Be.default)(kt),(0,g.default)(kt),(0,T.default)(kt),(0,xs.default)(kt),(0,je.default)(kt),(0,Fe.default)(kt),(0,ee.default)(kt),(0,o.default)(kt),(0,Le.default)(kt),(0,tn.default)(kt),(0,N.default)(kt),(0,X.default)(kt)}}},{"./airplayMix":"d8BTB","./aspectRatioMix":"aQNJl","./attrMix":"5DA9e","./autoHeightMix":"1swKn","./autoSizeMix":"lSbiD","./cssVarMix":"32Hp1","./currentTimeMix":"kfZbu","./durationMix":"eV1ag","./eventInit":"f8NQq","./flipMix":"ea3Qm","./fullscreenMix":"ffXE3","./fullscreenWebMix":"8tarF","./loadedMix":"f9syH","./miniMix":"dLuS7","./optionInit":"d1F69","./pauseMix":"kewk9","./pipMix":"4XzDs","./playbackRateMix":"jphfi","./playedMix":"iNpeS","./playingMix":"aBIWL","./playMix":"hRBri","./posterMix":"fgfXC","./qualityMix":"17rUP","./rectMix":"55qzI","./screenshotMix":"bC6TG","./seekMix":"j8GRO","./stateMix":"cn7iR","./subtitleOffsetMix":"2k4nP","./switchMix":"6SU6j","./themeMix":"7iMuh","./thumbnailsMix":"6P0RS","./toggleMix":"eNi78","./typeMix":"7AUBD","./urlMix":"cnlLL","./volumeMix":"iX66j","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d8BTB:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,notice:f,proxy:m,template:{$video:p}}=c,g=!0;window.WebKitPlaybackTargetAvailabilityEvent&&p.webkitShowPlaybackTargetPicker?m(p,"webkitplaybacktargetavailabilitychanged",v=>{switch(v.availability){case"available":g=!0;break;case"not-available":g=!1}}):g=!1,(0,a.def)(c,"airplay",{value(){g?(p.webkitShowPlaybackTargetPicker(),c.emit("airplay")):f.show=d.get("AirPlay Not Available")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aQNJl:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,notice:f,template:{$video:m,$player:p}}=c;(0,a.def)(c,"aspectRatio",{get:()=>p.dataset.aspectRatio||"default",set(g){if(g||(g="default"),g==="default")(0,a.setStyle)(m,"width",null),(0,a.setStyle)(m,"height",null),(0,a.setStyle)(m,"margin",null),delete p.dataset.aspectRatio;else{let v=g.split(":").map(Number),{clientWidth:E,clientHeight:x}=p,T=v[0]/v[1];E/x>T?((0,a.setStyle)(m,"width",`${T*x}px`),(0,a.setStyle)(m,"height","100%"),(0,a.setStyle)(m,"margin","0 auto")):((0,a.setStyle)(m,"width","100%"),(0,a.setStyle)(m,"height",`${E/T}px`),(0,a.setStyle)(m,"margin","auto 0")),p.dataset.aspectRatio=g}f.show=`${d.get("Aspect Ratio")}: ${g==="default"?d.get("Default"):g}`,c.emit("aspectRatio",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"5DA9e":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$video:d}}=c;(0,a.def)(c,"attr",{value(f,m){if(m===void 0)return d[f];d[f]=m}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1swKn":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$container:d,$video:f}}=c;(0,a.def)(c,"autoHeight",{value(){let{clientWidth:m}=d,{videoHeight:p,videoWidth:g}=f,v=m/g*p;(0,a.setStyle)(d,"height",`${v}px`),c.emit("autoHeight",v)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],lSbiD:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{$container:d,$player:f,$video:m}=c.template;(0,a.def)(c,"autoSize",{value(){let{videoWidth:p,videoHeight:g}=m,{width:v,height:E}=(0,a.getRect)(d),x=p/g;v/E>x?((0,a.setStyle)(f,"width",`${E*x/v*100}%`),(0,a.setStyle)(f,"height","100%")):((0,a.setStyle)(f,"width","100%"),(0,a.setStyle)(f,"height",`${v/x/E*100}%`)),c.emit("autoSize",{width:c.width,height:c.height})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"32Hp1":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{$player:d}=c.template;(0,a.def)(c,"cssVar",{value:(f,m)=>m?d.style.setProperty(f,m):getComputedStyle(d).getPropertyValue(f)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kfZbu:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{$video:d}=c.template;(0,a.def)(c,"currentTime",{get:()=>d.currentTime||0,set:f=>{Number.isNaN(f=Number.parseFloat(f))||(d.currentTime=(0,a.clamp)(f,0,c.duration))}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eV1ag:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"duration",{get:()=>{let{duration:d}=c.template.$video;return d===1/0?0:d||0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f8NQq:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>d);var a=l("../config"),o=n.interopDefault(a),c=l("../utils");function d(f){let{i18n:m,notice:p,option:g,constructor:v,proxy:E,template:{$player:x,$video:T,$poster:A}}=f,b=0;for(let _=0;_<o.default.events.length;_++)E(T,o.default.events[_],I=>{f.emit(`video:${I.type}`,I)});f.on("video:canplay",()=>{b=0,f.loading.show=!1}),f.once("video:canplay",()=>{f.loading.show=!1,f.controls.show=!0,f.mask.show=!0,f.isReady=!0,f.emit("ready")}),f.on("video:ended",()=>{g.loop?(f.seek=0,f.play(),f.controls.show=!1,f.mask.show=!1):(f.controls.show=!0,f.mask.show=!0)}),f.on("video:error",async _=>{b<v.RECONNECT_TIME_MAX?(await(0,c.sleep)(v.RECONNECT_SLEEP_TIME),b+=1,f.url=g.url,p.show=`${m.get("Reconnect")}: ${b}`,f.emit("error",_,b)):(f.mask.show=!0,f.loading.show=!1,f.controls.show=!0,(0,c.addClass)(x,"art-error"),await(0,c.sleep)(v.RECONNECT_SLEEP_TIME),p.show=m.get("Video Load Failed"))}),f.on("video:loadedmetadata",()=>{f.emit("resize"),c.isMobile&&(f.loading.show=!1,f.controls.show=!0,f.mask.show=!0)}),f.on("video:loadstart",()=>{f.loading.show=!0,f.mask.show=!1,f.controls.show=!0}),f.on("video:pause",()=>{f.controls.show=!0,f.mask.show=!0}),f.on("video:play",()=>{f.mask.show=!1,(0,c.setStyle)(A,"display","none")}),f.on("video:playing",()=>{f.mask.show=!1}),f.on("video:progress",()=>{f.playing&&(f.loading.show=!1)}),f.on("video:seeked",()=>{f.loading.show=!1,f.mask.show=!0}),f.on("video:seeking",()=>{f.loading.show=!0,f.mask.show=!1}),f.on("video:timeupdate",()=>{f.mask.show=!1}),f.on("video:waiting",()=>{f.loading.show=!0,f.mask.show=!1})}},{"../config":"eJfh8","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ea3Qm:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$player:d},i18n:f,notice:m}=c;(0,a.def)(c,"flip",{get:()=>d.dataset.flip||"normal",set(p){p||(p="normal"),p==="normal"?delete d.dataset.flip:d.dataset.flip=p,m.show=`${f.get("Video Flip")}: ${f.get((0,a.capitalize)(p))}`,c.emit("flip",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ffXE3:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>d);var a=l("../libs/screenfull"),o=n.interopDefault(a),c=l("../utils");function d(f){let{i18n:m,notice:p,template:{$video:g,$player:v}}=f;f.once("video:loadedmetadata",()=>{o.default.isEnabled?(o.default.on("change",()=>{f.emit("fullscreen",o.default.isFullscreen),o.default.isFullscreen?(f.state="fullscreen",(0,c.addClass)(v,"art-fullscreen")):(0,c.removeClass)(v,"art-fullscreen"),f.emit("resize")}),o.default.on("error",E=>{f.emit("fullscreenError",E)}),(0,c.def)(f,"fullscreen",{get:()=>o.default.isFullscreen,async set(E){E?await o.default.request(v):await o.default.exit()}})):g.webkitSupportsFullscreen?(f.on("document:webkitfullscreenchange",()=>{f.emit("fullscreen",f.fullscreen),f.emit("resize")}),(0,c.def)(f,"fullscreen",{get:()=>document.fullscreenElement===g,set(E){E?(f.state="fullscreen",g.webkitEnterFullscreen()):g.webkitExitFullscreen()}})):(0,c.def)(f,"fullscreen",{get:()=>!1,set(){p.show=m.get("Fullscreen Not Supported")}}),(0,c.def)(f,"fullscreen",(0,c.get)(f,"fullscreen"))})}},{"../libs/screenfull":"iSPAQ","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iSPAQ:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{if(typeof document>"u")return!1;let d=n[0],f={};for(let m of n)if(m[1]in document){for(let[p,g]of m.entries())f[d[p]]=g;return f}return!1})(),o={change:a.fullscreenchange,error:a.fullscreenerror},c={request:(d=document.documentElement,f)=>new Promise((m,p)=>{let g=()=>{c.off("change",g),m()};c.on("change",g);let v=d[a.requestFullscreen](f);v instanceof Promise&&v.then(g).catch(p)}),exit:()=>new Promise((d,f)=>{if(!c.isFullscreen)return void d();let m=()=>{c.off("change",m),d()};c.on("change",m);let p=document[a.exitFullscreen]();p instanceof Promise&&p.then(m).catch(f)}),toggle:(d,f)=>c.isFullscreen?c.exit():c.request(d,f),onchange(d){c.on("change",d)},onerror(d){c.on("error",d)},on(d,f){let m=o[d];m&&document.addEventListener(m,f,!1)},off(d,f){let m=o[d];m&&document.removeEventListener(m,f,!1)},raw:a};Object.defineProperties(c,{isFullscreen:{get:()=>!!document[a.fullscreenElement]},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>!!document[a.fullscreenEnabled]}}),e.default=c},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"8tarF":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{constructor:d,template:{$container:f,$player:m}}=c,p="";(0,a.def)(c,"fullscreenWeb",{get:()=>(0,a.hasClass)(m,"art-fullscreen-web"),set(g){g?(p=m.style.cssText,d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(document.body,m),c.state="fullscreenWeb",(0,a.setStyle)(m,"width","100%"),(0,a.setStyle)(m,"height","100%"),(0,a.addClass)(m,"art-fullscreen-web"),c.emit("fullscreenWeb",!0)):(d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(f,m),p&&(m.style.cssText=p,p=""),(0,a.removeClass)(m,"art-fullscreen-web"),c.emit("fullscreenWeb",!1)),c.emit("resize")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f9syH:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{$video:d}=c.template;(0,a.def)(c,"loaded",{get:()=>c.loadedTime/d.duration}),(0,a.def)(c,"loadedTime",{get:()=>d.buffered.length?d.buffered.end(d.buffered.length-1):0})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dLuS7:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{icons:d,proxy:f,storage:m,template:{$player:p,$video:g}}=c,v=!1,E=0,x=0;function T(){let{$mini:_}=c.template;_&&((0,a.removeClass)(p,"art-mini"),(0,a.setStyle)(_,"display","none"),p.prepend(g),c.emit("mini",!1))}function A(_,I){c.playing?((0,a.setStyle)(_,"display","none"),(0,a.setStyle)(I,"display","flex")):((0,a.setStyle)(_,"display","flex"),(0,a.setStyle)(I,"display","none"))}function b(){let{$mini:_}=c.template,I=(0,a.getRect)(_),C=window.innerHeight-I.height-50,N=window.innerWidth-I.width-50;m.set("top",C),m.set("left",N),(0,a.setStyle)(_,"top",`${C}px`),(0,a.setStyle)(_,"left",`${N}px`)}(0,a.def)(c,"mini",{get:()=>(0,a.hasClass)(p,"art-mini"),set(_){if(_){c.state="mini",(0,a.addClass)(p,"art-mini");let I=(function(){let{$mini:w}=c.template;if(w)return(0,a.append)(w,g),(0,a.setStyle)(w,"display","flex");{let P=(0,a.createElement)("div");(0,a.addClass)(P,"art-mini-popup"),(0,a.append)(document.body,P),c.template.$mini=P,(0,a.append)(P,g);let B=(0,a.append)(P,'<div class="art-mini-close"></div>');(0,a.append)(B,d.close),f(B,"click",T);let M=(0,a.append)(P,'<div class="art-mini-state"></div>'),K=(0,a.append)(M,d.play),tt=(0,a.append)(M,d.pause);return f(K,"click",()=>c.play()),f(tt,"click",()=>c.pause()),A(K,tt),c.on("video:playing",()=>A(K,tt)),c.on("video:pause",()=>A(K,tt)),c.on("video:timeupdate",()=>A(K,tt)),f(P,"mousedown",H=>{v=H.button===0,E=H.pageX,x=H.pageY}),c.on("document:mousemove",H=>{if(v){(0,a.addClass)(P,"art-mini-dragging");let G=H.pageX-E,Y=H.pageY-x;(0,a.setStyle)(P,"transform",`translate(${G}px, ${Y}px)`)}}),c.on("document:mouseup",()=>{if(v){v=!1,(0,a.removeClass)(P,"art-mini-dragging");let H=(0,a.getRect)(P);m.set("left",H.left),m.set("top",H.top),(0,a.setStyle)(P,"left",`${H.left}px`),(0,a.setStyle)(P,"top",`${H.top}px`),(0,a.setStyle)(P,"transform",null)}}),P}})(),C=m.get("top"),N=m.get("left");typeof C=="number"&&typeof N=="number"?((0,a.setStyle)(I,"top",`${C}px`),(0,a.setStyle)(I,"left",`${N}px`),(0,a.isInViewport)(I)||b()):b(),c.emit("mini",!0)}else T()}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d1F69:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{option:d,storage:f,template:{$video:m,$poster:p}}=c;for(let v in d.moreVideoAttr)c.attr(v,d.moreVideoAttr[v]);d.muted&&(c.muted=d.muted),d.volume&&(m.volume=(0,a.clamp)(d.volume,0,1));let g=f.get("volume");for(let v in typeof g=="number"&&(m.volume=(0,a.clamp)(g,0,1)),d.poster&&(0,a.setStyle)(p,"backgroundImage",`url(${d.poster})`),d.autoplay&&(m.autoplay=d.autoplay),d.playsInline&&(m.playsInline=!0,m["webkit-playsinline"]=!0),d.theme&&(d.cssVar["--art-theme"]=d.theme),d.cssVar)c.cssVar(v,d.cssVar[v]);c.url=d.url}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kewk9:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$video:d},i18n:f,notice:m}=c;(0,a.def)(c,"pause",{value(){let p=d.pause();return m.show=f.get("Pause"),c.emit("pause"),p}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4XzDs":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,notice:f,template:{$video:m}}=c;if(document.pictureInPictureEnabled){let{template:{$video:p},proxy:g,notice:v}=c;p.disablePictureInPicture=!1,(0,a.def)(c,"pip",{get:()=>document.pictureInPictureElement,set(E){E?(c.state="pip",p.requestPictureInPicture().catch(x=>{throw v.show=x,x})):document.exitPictureInPicture().catch(x=>{throw v.show=x,x})}}),g(p,"enterpictureinpicture",()=>{c.emit("pip",!0)}),g(p,"leavepictureinpicture",()=>{c.emit("pip",!1)})}else if(m.webkitSupportsPresentationMode){let{$video:p}=c.template;p.webkitSetPresentationMode("inline"),(0,a.def)(c,"pip",{get:()=>p.webkitPresentationMode==="picture-in-picture",set(g){g?(c.state="pip",p.webkitSetPresentationMode("picture-in-picture"),c.emit("pip",!0)):(p.webkitSetPresentationMode("inline"),c.emit("pip",!1))}})}else(0,a.def)(c,"pip",{get:()=>!1,set(){f.show=d.get("PIP Not Supported")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jphfi:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$video:d},i18n:f,notice:m}=c;(0,a.def)(c,"playbackRate",{get:()=>d.playbackRate,set(p){p?p!==d.playbackRate&&(d.playbackRate=p,m.show=`${f.get("Rate")}: ${p===1?f.get("Normal"):`${p}x`}`):c.playbackRate=1}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iNpeS:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"played",{get:()=>c.currentTime/c.duration})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBIWL:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{$video:d}=c.template;(0,a.def)(c,"playing",{get:()=>typeof d.playing=="boolean"?d.playing:d.currentTime>0&&!d.paused&&!d.ended&&d.readyState>2})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hRBri:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,notice:f,option:m,constructor:{instances:p},template:{$video:g}}=c;(0,a.def)(c,"play",{async value(){let v=await g.play();if(f.show=d.get("Play"),c.emit("play"),m.mutex)for(let E=0;E<p.length;E++){let x=p[E];x!==c&&x.pause()}return v}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fgfXC:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$poster:d}}=c;(0,a.def)(c,"poster",{get:()=>{try{return d.style.backgroundImage.match(/"(.*)"/)[1]}catch{return""}},set(f){(0,a.setStyle)(d,"backgroundImage",`url(${f})`)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"17rUP":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"quality",{set(d){let{controls:f,notice:m,i18n:p}=c,g=d.find(v=>v.default)||d[0];f.update({name:"quality",position:"right",index:10,style:{marginRight:"10px"},html:g?.html||"",selector:d,onSelect:async v=>(await c.switchQuality(v.url),m.show=`${p.get("Switch Video")}: ${v.html}`,v.html)})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"55qzI":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"rect",{get:()=>(0,a.getRect)(c.template.$player)});let d=["bottom","height","left","right","top","width"];for(let f=0;f<d.length;f++){let m=d[f];(0,a.def)(c,m,{get:()=>c.rect[m]})}(0,a.def)(c,"x",{get:()=>c.left+window.pageXOffset}),(0,a.def)(c,"y",{get:()=>c.top+window.pageYOffset})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bC6TG:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{notice:d,template:{$video:f}}=c,m=(0,a.createElement)("canvas");(0,a.def)(c,"getDataURL",{value:()=>new Promise((p,g)=>{try{m.width=f.videoWidth,m.height=f.videoHeight,m.getContext("2d").drawImage(f,0,0),p(m.toDataURL("image/png"))}catch(v){d.show=v,g(v)}})}),(0,a.def)(c,"getBlobUrl",{value:()=>new Promise((p,g)=>{try{m.width=f.videoWidth,m.height=f.videoHeight,m.getContext("2d").drawImage(f,0,0),m.toBlob(v=>{p(URL.createObjectURL(v))})}catch(v){d.show=v,g(v)}})}),(0,a.def)(c,"screenshot",{value:async p=>{let g=await c.getDataURL(),v=p||`artplayer_${(0,a.secondToTime)(f.currentTime)}`;return(0,a.download)(g,`${v}.png`),c.emit("screenshot",g),g}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j8GRO:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{notice:d}=c;(0,a.def)(c,"seek",{set(f){c.currentTime=f,c.duration&&(d.show=`${(0,a.secondToTime)(c.currentTime)} / ${(0,a.secondToTime)(c.duration)}`),c.emit("seek",c.currentTime)}}),(0,a.def)(c,"forward",{set(f){c.seek=c.currentTime+f}}),(0,a.def)(c,"backward",{set(f){c.seek=c.currentTime-f}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cn7iR:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let d=["mini","pip","fullscreen","fullscreenWeb"];(0,a.def)(c,"state",{get:()=>d.find(f=>c[f])||"standard",set(f){for(let m=0;m<d.length;m++){let p=d[m];p!==f&&c[p]&&(c[p]=!1)}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2k4nP":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{notice:d,i18n:f,template:m}=c;(0,a.def)(c,"subtitleOffset",{get:()=>m.$track?.offset||0,set(p){let{cues:g}=c.subtitle;if(!m.$track||g.length===0)return;let v=(0,a.clamp)(p,-10,10);m.$track.offset=v;for(let E=0;E<g.length;E++){let x=g[E];x.originalStartTime=x.originalStartTime??x.startTime,x.originalEndTime=x.originalEndTime??x.endTime,x.startTime=(0,a.clamp)(x.originalStartTime+v,0,c.duration),x.endTime=(0,a.clamp)(x.originalEndTime+v,0,c.duration)}c.subtitle.update(),d.show=`${f.get("Subtitle Offset")}: ${p}s`,c.emit("subtitleOffset",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6SU6j":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){function d(f,m){return new Promise((p,g)=>{if(f===c.url)return;let{playing:v,aspectRatio:E,playbackRate:x}=c;c.pause(),c.url=f,c.notice.show="",c.once("video:error",g),c.once("video:loadedmetadata",()=>{c.currentTime=m}),c.once("video:canplay",async()=>{c.playbackRate=x,c.aspectRatio=E,v&&await c.play(),c.notice.show="",p()})})}(0,a.def)(c,"switchQuality",{value:f=>d(f,c.currentTime)}),(0,a.def)(c,"switchUrl",{value:f=>d(f,0)}),(0,a.def)(c,"switch",{set:c.switchUrl})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7iMuh":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"theme",{get:()=>c.cssVar("--art-theme"),set(d){c.cssVar("--art-theme",d)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6P0RS":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{events:d,option:f,template:{$progress:m,$video:p}}=c,g=null,v=null,E=!1,x=!1,T=!1;d.hover(m,()=>{T=!0},()=>{T=!1}),c.on("setBar",async(A,b,_)=>{let I=c.controls?.thumbnails,{url:C,scale:N}=f.thumbnails;if(!I||!C)return;let w=A==="played"&&_&&a.isMobile;if(A==="hover"||w){if(E||(E=!0,v=await(0,a.loadImg)(C,N),x=!0),!x||!T)return;let P=m.clientWidth*b;(0,a.setStyle)(I,"display","flex"),P>0&&P<m.clientWidth?(function(B){let M=c.controls?.thumbnails;if(!M)return;let{number:K,column:tt,width:H,height:G,scale:Y}=f.thumbnails,O=H*Y||v.naturalWidth/tt,j=G*Y||O/(p.videoWidth/p.videoHeight),X=Math.floor(B/(m.clientWidth/K)),rt=Math.ceil(X/tt)-1;(0,a.setStyle)(M,"backgroundImage",`url(${v.src})`),(0,a.setStyle)(M,"height",`${j}px`),(0,a.setStyle)(M,"width",`${O}px`),(0,a.setStyle)(M,"backgroundPosition",`-${(X%tt||tt-1)*O}px -${rt*j}px`),B<=O/2?(0,a.setStyle)(M,"left",0):B>m.clientWidth-O/2?(0,a.setStyle)(M,"left",`${m.clientWidth-O}px`):(0,a.setStyle)(M,"left",`${B-O/2}px`)})(P):a.isMobile||(0,a.setStyle)(I,"display","none"),w&&(clearTimeout(g),g=setTimeout(()=>{(0,a.setStyle)(I,"display","none")},500))}}),(0,a.def)(c,"thumbnails",{get:()=>c.option.thumbnails,set(A){A.url&&!c.option.isLive&&(c.option.thumbnails=A,clearTimeout(g),g=null,v=null,E=!1,x=!1)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eNi78:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"toggle",{value:()=>c.playing?c.pause():c.play()})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7AUBD":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){(0,a.def)(c,"type",{get:()=>c.option.type,set(d){c.option.type=d}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cnlLL:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{option:d,template:{$video:f}}=c;(0,a.def)(c,"url",{get:()=>f.src,async set(m){if(m){let p=c.url,g=d.type||(0,a.getExt)(m),v=d.customType[g];g&&v?(await(0,a.sleep)(),c.loading.show=!0,v.call(c,f,m,c)):(URL.revokeObjectURL(p),f.src=m),p!==c.url&&(c.option.url=m,c.isReady&&p&&c.once("video:canplay",()=>{c.emit("restart",m)}))}else await(0,a.sleep)(),c.loading.show=!0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iX66j:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{template:{$video:d},i18n:f,notice:m,storage:p}=c;(0,a.def)(c,"volume",{get:()=>d.volume||0,set:g=>{d.volume=(0,a.clamp)(g,0,1),m.show=`${f.get("Volume")}: ${Number.parseInt(100*d.volume,10)}`,d.volume!==0&&p.set("volume",d.volume)}}),(0,a.def)(c,"muted",{get:()=>d.muted,set:g=>{d.muted=g,c.emit("muted",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cjxJL:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("../utils"),o=l("./autoOrientation"),c=n.interopDefault(o),d=l("./autoPlayback"),f=n.interopDefault(d),m=l("./fastForward"),p=n.interopDefault(m),g=l("./lock"),v=n.interopDefault(g),E=l("./miniProgressBar"),x=n.interopDefault(E);e.default=class{constructor(T){this.art=T,this.id=0;let{option:A}=T;A.miniProgressBar&&!A.isLive&&this.add(x.default),A.lock&&a.isMobile&&this.add(v.default),A.autoPlayback&&!A.isLive&&this.add(f.default),A.autoOrientation&&a.isMobile&&this.add(c.default),A.fastForward&&a.isMobile&&!A.isLive&&this.add(p.default);for(let b=0;b<A.plugins.length;b++)this.add(A.plugins[b])}add(T){this.id+=1;let A=T.call(this.art,this.art);return A instanceof Promise?A.then(b=>this.next(T,b)):this.next(T,A)}next(T,A){let b=A&&A.name||T.name||`plugin${this.id}`;return(0,a.errorHandle)(!(0,a.has)(this,b),`Cannot add a plugin that already has the same name: ${b}`),(0,a.def)(this,b,{value:A}),this}}},{"../utils":"aBlEo","./autoOrientation":"jb9jb","./autoPlayback":"21HWM","./fastForward":"4sxBO","./lock":"fjy9V","./miniProgressBar":"d0xRp","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jb9jb:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{notice:d,constructor:f,template:{$player:m,$video:p}}=c,g="art-auto-orientation",v="art-auto-orientation-fullscreen",E=!1;function x(){let{videoWidth:T,videoHeight:A}=p,b=document.documentElement.clientWidth,_=document.documentElement.clientHeight;return T>A&&b<_||T<A&&b>_}return c.on("fullscreenWeb",T=>{T?x()&&setTimeout(()=>{c.fullscreenWeb&&!(0,a.hasClass)(m,g)&&(function(){let A=document.documentElement.clientWidth,b=document.documentElement.clientHeight;(0,a.setStyle)(m,"width",`${b}px`),(0,a.setStyle)(m,"height",`${A}px`),(0,a.setStyle)(m,"transform-origin","0 0"),(0,a.setStyle)(m,"transform",`rotate(90deg) translate(0, -${A}px)`),(0,a.addClass)(m,g),c.isRotate=!0,c.emit("resize")})()},Number(f.AUTO_ORIENTATION_TIME??0)):(0,a.hasClass)(m,g)&&((0,a.setStyle)(m,"width",""),(0,a.setStyle)(m,"height",""),(0,a.setStyle)(m,"transform-origin",""),(0,a.setStyle)(m,"transform",""),(0,a.removeClass)(m,g),c.isRotate=!1,c.emit("resize"))}),c.on("fullscreen",async T=>{let A=!!screen?.orientation?.lock;if(T){if(A&&x())try{let b=screen.orientation.type.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(b),E=!0,(0,a.addClass)(m,v)}catch(b){E=!1,d.show=b}}else if((0,a.hasClass)(m,v)&&(0,a.removeClass)(m,v),A&&E){try{screen.orientation.unlock()}catch{}E=!1}}),{name:"autoOrientation",get state(){return(0,a.hasClass)(m,g)}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"21HWM":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,icons:f,storage:m,constructor:p,proxy:g,template:{$poster:v}}=c,E=c.layers.add({name:"auto-playback",html:'<div class="art-auto-playback-close"></div><div class="art-auto-playback-last"></div><div class="art-auto-playback-jump"></div>'}),x=(0,a.query)(".art-auto-playback-last",E),T=(0,a.query)(".art-auto-playback-jump",E),A=(0,a.query)(".art-auto-playback-close",E);(0,a.append)(A,f.close);let b=null;function _(){let I=(m.get("times")||{})[c.option.id||c.option.url];clearTimeout(b),(0,a.setStyle)(E,"display","none"),I&&I>=p.AUTO_PLAYBACK_MIN&&((0,a.setStyle)(E,"display","flex"),x.textContent=`${d.get("Last Seen")} ${(0,a.secondToTime)(I)}`,T.textContent=d.get("Jump Play"),g(A,"click",()=>{(0,a.setStyle)(E,"display","none")}),g(T,"click",()=>{c.seek=I,c.play(),(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(E,"display","none")}),c.once("video:timeupdate",()=>{b=setTimeout(()=>{(0,a.setStyle)(E,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}return c.on("video:timeupdate",()=>{if(c.playing){let I=m.get("times")||{},C=Object.keys(I);C.length>p.AUTO_PLAYBACK_MAX&&delete I[C[0]],I[c.option.id||c.option.url]=c.currentTime,m.set("times",I)}}),c.on("ready",_),c.on("restart",_),{name:"auto-playback",get times(){return m.get("times")||{}},clear:()=>m.del("times"),delete(I){let C=m.get("times")||{};return delete C[I],m.set("times",C),C}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4sxBO":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{constructor:d,proxy:f,template:{$player:m,$video:p}}=c,g=null,v=!1,E=1,x=()=>{clearTimeout(g),v&&(v=!1,c.playbackRate=E,(0,a.removeClass)(m,"art-fast-forward"))};return f(p,"touchstart",T=>{T.touches.length===1&&c.playing&&!c.isLock&&(g=setTimeout(()=>{v=!0,E=c.playbackRate,c.playbackRate=d.FAST_FORWARD_VALUE,(0,a.addClass)(m,"art-fast-forward")},d.FAST_FORWARD_TIME))}),c.on("document:touchmove",x),c.on("document:touchend",x),{name:"fastForward",get state(){return(0,a.hasClass)(m,"art-fast-forward")}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjy9V:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{layers:d,icons:f,template:{$player:m}}=c;function p(){return(0,a.hasClass)(m,"art-lock")}function g(){(0,a.addClass)(m,"art-lock"),c.isLock=!0,c.emit("lock",!0)}function v(){(0,a.removeClass)(m,"art-lock"),c.isLock=!1,c.emit("lock",!1)}return d.add({name:"lock",mounted(E){let x=(0,a.append)(E,f.lock),T=(0,a.append)(E,f.unlock);(0,a.setStyle)(x,"display","none"),c.on("lock",A=>{A?((0,a.setStyle)(x,"display","inline-flex"),(0,a.setStyle)(T,"display","none")):((0,a.setStyle)(x,"display","none"),(0,a.setStyle)(T,"display","inline-flex"))})},click(){p()?v():g()}}),{name:"lock",get state(){return p()},set state(E){E?g():v()}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d0xRp:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){return c.on("control",d=>{d?(0,a.removeClass)(c.template.$player,"art-mini-progress-bar"):(0,a.addClass)(c.template.$player,"art-mini-progress-bar")}),{name:"mini-progress-bar"}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bwLGT:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("../utils"),o=l("../utils/component"),c=n.interopDefault(o),d=l("./aspectRatio"),f=n.interopDefault(d),m=l("./flip"),p=n.interopDefault(m),g=l("./playbackRate"),v=n.interopDefault(g),E=l("./subtitleOffset"),x=n.interopDefault(E);class T extends c.default{constructor(b){super(b);let{option:_,controls:I,template:{$setting:C}}=b;this.name="setting",this.$parent=C,this.id=0,this.active=null,this.cache=new Map,this.option=[...this.builtin,..._.settings],_.setting&&(this.format(),this.render(),b.on("blur",()=>{this.show&&(this.show=!1,this.render())}),b.on("focus",N=>{let w=(0,a.includeFromEvent)(N,I.setting),P=(0,a.includeFromEvent)(N,this.$parent);!this.show||w||P||(this.show=!1,this.render())}),b.on("resize",()=>this.resize()))}get builtin(){let b=[],{option:_}=this.art;return _.playbackRate&&b.push((0,v.default)(this.art)),_.aspectRatio&&b.push((0,f.default)(this.art)),_.flip&&b.push((0,p.default)(this.art)),_.subtitleOffset&&b.push((0,x.default)(this.art)),b}traverse(b,_=this.option){for(let I=0;I<_.length;I++){let C=_[I];b(C),C.selector?.length&&this.traverse(b,C.selector)}}check(b){b.$parent.tooltip=b.html,this.traverse(_=>{_.default=_===b,_.default&&_.$item&&(0,a.inverseClass)(_.$item,"art-current")},b.$option),this.render(b.$parents)}format(b=this.option,_,I,C=[]){for(let N=0;N<b.length;N++){let w=b[N];if(w?.name?((0,a.errorHandle)(!C.includes(w.name),`The [${w.name}] already exists in [setting]`),C.push(w.name)):w.name=`setting-${this.id++}`,!w.$formatted){(0,a.def)(w,"$parent",{get:()=>_}),(0,a.def)(w,"$parents",{get:()=>I}),(0,a.def)(w,"$option",{get:()=>b});let P=[];(0,a.def)(w,"$events",{get:()=>P}),(0,a.def)(w,"$formatted",{get:()=>!0})}this.format(w.selector||[],w,b,C)}this.option=b}find(b=""){let _=null;return this.traverse(I=>{I.name===b&&(_=I)}),_}resize(){let{controls:b,constructor:{SETTING_WIDTH:_,SETTING_ITEM_HEIGHT:I},template:{$player:C,$setting:N}}=this.art;if(b.setting&&this.show){let w=this.active[0]?.$parent?.width||_,{left:P,width:B}=(0,a.getRect)(b.setting),{left:M,width:K}=(0,a.getRect)(C),tt=P-M+B/2-w/2,H=this.active===this.option?this.active.length*I:(this.active.length+1)*I;if((0,a.setStyle)(N,"height",`${H}px`),(0,a.setStyle)(N,"width",`${w}px`),this.art.isRotate||a.isMobile)return;tt+w>K?((0,a.setStyle)(N,"left",null),(0,a.setStyle)(N,"right",null)):((0,a.setStyle)(N,"left",`${tt}px`),(0,a.setStyle)(N,"right","auto"))}}inactivate(b){for(let _=0;_<b.$events.length;_++)this.art.events.remove(b.$events[_]);b.$events.length=0}remove(b){let _=this.find(b);(0,a.errorHandle)(_,`Can't find [${b}] in the [setting]`);let I=_.$option.indexOf(_);_.$option.splice(I,1),this.inactivate(_),_.$item&&(0,a.remove)(_.$item),this.render()}update(b){let _=this.find(b.name);return _?(this.inactivate(_),Object.assign(_,b),this.format(),this.createItem(_,!0),this.render(),_):this.add(b)}add(b,_=this.option){return _.push(b),this.format(),this.createItem(b),this.render(),b}createHeader(b){if(!this.cache.has(b.$option))return;let _=this.cache.get(b.$option),{proxy:I,icons:{arrowLeft:C},constructor:{SETTING_ITEM_HEIGHT:N}}=this.art,w=(0,a.createElement)("div");(0,a.setStyle)(w,"height",`${N}px`),(0,a.addClass)(w,"art-setting-item"),(0,a.addClass)(w,"art-setting-item-back");let P=(0,a.append)(w,'<div class="art-setting-item-left"></div>'),B=(0,a.createElement)("div");(0,a.addClass)(B,"art-setting-item-left-icon"),(0,a.append)(B,C),(0,a.append)(P,B),(0,a.append)(P,b.$parent.html);let M=I(w,"click",()=>this.render(b.$parents));b.$parent.$events.push(M),(0,a.append)(_,w)}createItem(b,_=!1){if(!this.cache.has(b.$option))return;let I=this.cache.get(b.$option),C=b.$item,N="selector";(0,a.has)(b,"switch")&&(N="switch"),(0,a.has)(b,"range")&&(N="range"),(0,a.has)(b,"onClick")&&(N="button");let{icons:w,proxy:P,constructor:B}=this.art,M=(0,a.createElement)("div");(0,a.addClass)(M,"art-setting-item"),(0,a.setStyle)(M,"height",`${B.SETTING_ITEM_HEIGHT}px`),M.dataset.name=b.name||"",M.dataset.value=b.value||"";let K=(0,a.append)(M,'<div class="art-setting-item-left"></div>'),tt=(0,a.append)(M,'<div class="art-setting-item-right"></div>'),H=(0,a.createElement)("div");switch((0,a.addClass)(H,"art-setting-item-left-icon"),N){case"button":case"switch":case"range":(0,a.append)(H,b.icon||w.config);break;case"selector":b.selector?.length?(0,a.append)(H,b.icon||w.config):(0,a.append)(H,w.check)}(0,a.append)(K,H),(0,a.def)(b,"$icon",{configurable:!0,get:()=>H}),(0,a.def)(b,"icon",{configurable:!0,get:()=>H.innerHTML,set(O){H.innerHTML="",(0,a.append)(H,O)}});let G=(0,a.createElement)("div");(0,a.addClass)(G,"art-setting-item-left-text"),(0,a.append)(G,b.html||""),(0,a.append)(K,G),(0,a.def)(b,"$html",{configurable:!0,get:()=>G}),(0,a.def)(b,"html",{configurable:!0,get:()=>G.innerHTML,set(O){G.innerHTML="",(0,a.append)(G,O)}});let Y=(0,a.createElement)("div");switch((0,a.addClass)(Y,"art-setting-item-right-tooltip"),(0,a.append)(Y,b.tooltip||""),(0,a.append)(tt,Y),(0,a.def)(b,"$tooltip",{configurable:!0,get:()=>Y}),(0,a.def)(b,"tooltip",{configurable:!0,get:()=>Y.innerHTML,set(O){Y.innerHTML="",(0,a.append)(Y,O)}}),N){case"switch":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let j=(0,a.append)(O,w.switchOn),X=(0,a.append)(O,w.switchOff);(0,a.setStyle)(b.switch?X:j,"display","none"),(0,a.append)(tt,O),(0,a.def)(b,"$switch",{configurable:!0,get:()=>O});let rt=b.switch;(0,a.def)(b,"switch",{configurable:!0,get:()=>rt,set(ct){rt=ct,ct?((0,a.setStyle)(X,"display","none"),(0,a.setStyle)(j,"display",null)):((0,a.setStyle)(X,"display",null),(0,a.setStyle)(j,"display","none"))}});break}case"range":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let j=(0,a.append)(O,'<input type="range">');j.value=b.range[0],j.min=b.range[1],j.max=b.range[2],j.step=b.range[3],(0,a.addClass)(j,"art-setting-range"),(0,a.append)(tt,O),(0,a.def)(b,"$range",{configurable:!0,get:()=>j});let X=[...b.range];(0,a.def)(b,"range",{configurable:!0,get:()=>X,set(rt){X=[...rt],j.value=rt[0],j.min=rt[1],j.max=rt[2],j.step=rt[3]}})}break;case"selector":if(b.selector?.length){let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon"),(0,a.append)(O,w.arrowRight),(0,a.append)(tt,O)}}switch(N){case"switch":if(b.onSwitch){let O=P(M,"click",async j=>{b.switch=await b.onSwitch.call(this.art,b,M,j)});b.$events.push(O)}break;case"range":if(b.$range){if(b.onRange){let O=P(b.$range,"change",async j=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onRange.call(this.art,b,M,j)});b.$events.push(O)}if(b.onChange){let O=P(b.$range,"input",async j=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onChange.call(this.art,b,M,j)});b.$events.push(O)}}break;case"selector":{let O=P(M,"click",async j=>{b.selector?.length?this.render(b.selector):(this.check(b),b.$parent.onSelect&&(b.$parent.tooltip=await b.$parent.onSelect.call(this.art,b,M,j)))});b.$events.push(O),b.default&&(0,a.addClass)(M,"art-current")}break;case"button":if(b.onClick){let O=P(M,"click",async j=>{b.tooltip=await b.onClick.call(this.art,b,M,j)});b.$events.push(O)}}(0,a.def)(b,"$item",{configurable:!0,get:()=>M}),_?(0,a.replaceElement)(M,C):(0,a.append)(I,M),b.mounted&&setTimeout(()=>b.mounted.call(this.art,b.$item,b),0)}render(b=this.option){if(this.active=b,this.cache.has(b)){let _=this.cache.get(b);(0,a.inverseClass)(_,"art-current")}else{let _=(0,a.createElement)("div");this.cache.set(b,_),(0,a.addClass)(_,"art-setting-panel"),(0,a.append)(this.$parent,_),(0,a.inverseClass)(_,"art-current"),b[0]?.$parent&&this.createHeader(b[0]);for(let I=0;I<b.length;I++)this.createItem(b[I])}this.resize()}}e.default=T},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"cb8VK","./flip":"ljJTO","./playbackRate":"3QcSQ","./subtitleOffset":"eB5hg","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cb8VK:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){let{i18n:c,icons:d,constructor:{SETTING_ITEM_WIDTH:f,ASPECT_RATIO:m}}=o;function p(v){return v==="default"?c.get("Default"):v}function g(){let v=o.setting.find(`aspect-ratio-${o.aspectRatio}`);o.setting.check(v)}return{width:f,name:"aspect-ratio",html:c.get("Aspect Ratio"),icon:d.aspectRatio,tooltip:p(o.aspectRatio),selector:m.map(v=>({value:v,name:`aspect-ratio-${v}`,default:v===o.aspectRatio,html:p(v)})),onSelect:v=>(o.aspectRatio=v.value,v.html),mounted:()=>{g(),o.on("aspectRatio",()=>g())}}}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ljJTO:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e),n.export(e,"default",()=>o);var a=l("../utils");function o(c){let{i18n:d,icons:f,constructor:{SETTING_ITEM_WIDTH:m,FLIP:p}}=c;function g(E){return d.get((0,a.capitalize)(E))}function v(){let E=c.setting.find(`flip-${c.flip}`);c.setting.check(E)}return{width:m,name:"flip",html:d.get("Video Flip"),tooltip:g(c.flip),icon:f.flip,selector:p.map(E=>({value:E,name:`flip-${E}`,default:E===c.flip,html:g(E)})),onSelect:E=>(c.flip=E.value,E.html),mounted:()=>{v(),c.on("flip",()=>v())}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3QcSQ":[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){let{i18n:c,icons:d,constructor:{SETTING_ITEM_WIDTH:f,PLAYBACK_RATE:m}}=o;function p(v){return v===1?c.get("Normal"):v.toFixed(1)}function g(){let v=o.setting.find(`playback-rate-${o.playbackRate}`);o.setting.check(v)}return{width:f,name:"playback-rate",html:c.get("Play Speed"),tooltip:p(o.playbackRate),icon:d.playbackRate,selector:m.map(v=>({value:v,name:`playback-rate-${v}`,default:v===o.playbackRate,html:p(v)})),onSelect:v=>(o.playbackRate=v.value,v.html),mounted:()=>{g(),o.on("video:ratechange",()=>g())}}}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eB5hg:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");function a(o){let{i18n:c,icons:d,constructor:f}=o;return{width:f.SETTING_ITEM_WIDTH,name:"subtitle-offset",html:c.get("Subtitle Offset"),icon:d.subtitle,tooltip:"0s",range:[0,-10,10,.1],onChange:m=>(o.subtitleOffset=m.range[0],`${m.range[0]}s`),mounted:(m,p)=>{o.on("subtitleOffset",g=>{p.$range.value=g,p.tooltip=`${g}s`})}}}n.defineInteropFlag(e),n.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kwqbK:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(n){try{let a=JSON.parse(window.localStorage.getItem(this.name))||{};return n?a[n]:a}catch{return n?this.settings[n]:this.settings}}set(n,a){try{let o=Object.assign({},this.get(),{[n]:a});window.localStorage.setItem(this.name,JSON.stringify(o))}catch{this.settings[n]=a}}del(n){try{let a=this.get();delete a[n],window.localStorage.setItem(this.name,JSON.stringify(a))}catch{delete this.settings[n]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k5613:[function(l,t,e,i){var n=l("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(e);var a=l("option-validator"),o=n.interopDefault(a),c=l("./scheme"),d=n.interopDefault(c),f=l("./utils"),m=l("./utils/component"),p=n.interopDefault(m);class g extends p.default{constructor(E){super(E),this.name="subtitle",this.option=null,this.destroyEvent=()=>null,this.init(E.option.subtitle);let x=!1;E.on("video:timeupdate",()=>{if(!this.url)return;let T=this.art.template.$video.webkitDisplayingFullscreen;typeof T=="boolean"&&T!==x&&(x=T,this.createTrack(T?"subtitles":"metadata",this.url))})}get url(){return this.art.template.$track.src}set url(E){this.switch(E)}get textTrack(){return this.art.template.$video?.textTracks?.[0]}get activeCues(){return this.textTrack?Array.from(this.textTrack.activeCues):[]}get cues(){return this.textTrack?Array.from(this.textTrack.cues):[]}style(E,x){let{$subtitle:T}=this.art.template;return typeof E=="object"?(0,f.setStyles)(T,E):(0,f.setStyle)(T,E,x)}update(){let{option:{subtitle:E},template:{$subtitle:x}}=this.art;x.innerHTML="",this.activeCues.length&&(this.art.emit("subtitleBeforeUpdate",this.activeCues),x.innerHTML=this.activeCues.map((T,A)=>T.text.split(/\r?\n/).filter(b=>b.trim()).map(b=>`<div class="art-subtitle-line" data-group="${A}">${E.escape?(0,f.escape)(b):b}</div>`).join("")).join(""),this.art.emit("subtitleAfterUpdate",this.activeCues))}async switch(E,x={}){let{i18n:T,notice:A,option:b}=this.art,_={...b.subtitle,...x,url:E},I=await this.init(_);return x.name&&(A.show=`${T.get("Switch Subtitle")}: ${x.name}`),I}createTrack(E,x){let{template:T,proxy:A,option:b}=this.art,{$video:_,$track:I}=T,C=(0,f.createElement)("track");C.default=!0,C.kind=E,C.src=x,C.label=b.subtitle.name||"Artplayer",C.track.mode="hidden",C.onload=()=>{this.art.emit("subtitleLoad",this.cues,this.option)},this.art.events.remove(this.destroyEvent),I.onload=null,(0,f.remove)(I),(0,f.append)(_,C),T.$track=C,this.destroyEvent=A(this.textTrack,"cuechange",()=>this.update())}async init(E){let{notice:x,template:{$subtitle:T}}=this.art;return this.textTrack?((0,o.default)(E,d.default.subtitle),E.url?(this.option=E,this.style(E.style),fetch(E.url).then(A=>A.arrayBuffer()).then(A=>{let b=new TextDecoder(E.encoding).decode(A);switch(E.type||(0,f.getExt)(E.url)){case"srt":{let _=(0,f.srtToVtt)(b),I=E.onVttLoad(_);return(0,f.vttToBlob)(I)}case"ass":{let _=(0,f.assToVtt)(b),I=E.onVttLoad(_);return(0,f.vttToBlob)(I)}case"vtt":{let _=E.onVttLoad(b);return(0,f.vttToBlob)(_)}default:return E.url}}).then(A=>(T.innerHTML="",this.url===A||(URL.revokeObjectURL(this.url),this.createTrack("metadata",A)),A)).catch(A=>{throw T.innerHTML="",x.show=A,A})):void 0):null}}e.default=g},{"option-validator":"g7VGh","./scheme":"biLjm","./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fwOA1:[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var n=l("../package.json"),a=l("./utils");class o{constructor(d){this.art=d;let{option:f,constructor:m}=d;f.container instanceof Element?this.$container=f.container:(this.$container=(0,a.query)(f.container),(0,a.errorHandle)(this.$container,`No container element found by ${f.container}`)),(0,a.errorHandle)((0,a.supportsFlex)(),"The current browser does not support flex layout");let p=this.$container.tagName.toLowerCase();(0,a.errorHandle)(p==="div",`Unsupported container element type, only support 'div' but got '${p}'`),(0,a.errorHandle)(m.instances.every(g=>g.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=d.id,this.init()}static get html(){return`<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"><track default kind="metadata" src=""></track></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">${n.version}</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span>x<span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-contextmenus"></div></div>`}query(d){return(0,a.query)(d,this.$container)}init(){let{option:d}=this.art;if(d.useSSR||(this.$container.innerHTML=o.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$track=this.query("track"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$contextmenu=this.query(".art-contextmenus"),d.proxy){let f=d.proxy.call(this.art,this.art);(0,a.errorHandle)(f instanceof HTMLVideoElement||f instanceof HTMLCanvasElement,"Function 'option.proxy' needs to return 'HTMLVideoElement' or 'HTMLCanvasElement'"),(0,a.replaceElement)(f,this.$video),f.className="art-video",this.$video=f}d.backdrop&&(0,a.addClass)(this.$player,"art-backdrop"),a.isMobile&&(0,a.addClass)(this.$player,"art-mobile")}destroy(d){d?this.$container.innerHTML="":(0,a.addClass)(this.$player,"art-destroy")}}e.default=o},{"../package.json":"lh3R5","./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4NM7P":[function(l,t,e,i){l("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{on(n,a,o){let c=this.e||(this.e={});return(c[n]||(c[n]=[])).push({fn:a,ctx:o}),this}once(n,a,o){let c=this;function d(...f){c.off(n,d),a.apply(o,f)}return d._=a,this.on(n,d,o)}emit(n,...a){let o=((this.e||(this.e={}))[n]||[]).slice();for(let c=0;c<o.length;c+=1)o[c].fn.apply(o[c].ctx,a);return this}off(n,a){let o=this.e||(this.e={}),c=o[n],d=[];if(c&&a)for(let f=0,m=c.length;f<m;f+=1)c[f].fn!==a&&c[f].fn._!==a&&d.push(c[f]);return d.length?o[n]=d:delete o[n],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}]},["esqvp"],"esqvp","parcelRequire4dc0",{});let{default:b1}=parcelRequire4dc0("esqvp");const ht=Number.isFinite||function(l){return typeof l=="number"&&isFinite(l)},A1=Number.isSafeInteger||function(l){return typeof l=="number"&&Math.abs(l)<=L1},L1=Number.MAX_SAFE_INTEGER||9007199254740991;let vt=(function(l){return l.NETWORK_ERROR="networkError",l.MEDIA_ERROR="mediaError",l.KEY_SYSTEM_ERROR="keySystemError",l.MUX_ERROR="muxError",l.OTHER_ERROR="otherError",l})({}),q=(function(l){return l.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",l.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",l.KEY_SYSTEM_NO_SESSION="keySystemNoSession",l.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",l.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",l.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",l.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",l.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",l.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",l.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",l.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",l.MANIFEST_LOAD_ERROR="manifestLoadError",l.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",l.MANIFEST_PARSING_ERROR="manifestParsingError",l.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",l.LEVEL_EMPTY_ERROR="levelEmptyError",l.LEVEL_LOAD_ERROR="levelLoadError",l.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",l.LEVEL_PARSING_ERROR="levelParsingError",l.LEVEL_SWITCH_ERROR="levelSwitchError",l.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",l.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",l.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",l.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",l.FRAG_LOAD_ERROR="fragLoadError",l.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",l.FRAG_DECRYPT_ERROR="fragDecryptError",l.FRAG_PARSING_ERROR="fragParsingError",l.FRAG_GAP="fragGap",l.REMUX_ALLOC_ERROR="remuxAllocError",l.KEY_LOAD_ERROR="keyLoadError",l.KEY_LOAD_TIMEOUT="keyLoadTimeOut",l.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",l.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",l.BUFFER_APPEND_ERROR="bufferAppendError",l.BUFFER_APPENDING_ERROR="bufferAppendingError",l.BUFFER_STALLED_ERROR="bufferStalledError",l.BUFFER_FULL_ERROR="bufferFullError",l.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",l.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",l.ASSET_LIST_LOAD_ERROR="assetListLoadError",l.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",l.ASSET_LIST_PARSING_ERROR="assetListParsingError",l.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",l.INTERNAL_EXCEPTION="internalException",l.INTERNAL_ABORTED="aborted",l.ATTACH_MEDIA_ERROR="attachMediaError",l.UNKNOWN="unknown",l})({}),R=(function(l){return l.MEDIA_ATTACHING="hlsMediaAttaching",l.MEDIA_ATTACHED="hlsMediaAttached",l.MEDIA_DETACHING="hlsMediaDetaching",l.MEDIA_DETACHED="hlsMediaDetached",l.MEDIA_ENDED="hlsMediaEnded",l.STALL_RESOLVED="hlsStallResolved",l.BUFFER_RESET="hlsBufferReset",l.BUFFER_CODECS="hlsBufferCodecs",l.BUFFER_CREATED="hlsBufferCreated",l.BUFFER_APPENDING="hlsBufferAppending",l.BUFFER_APPENDED="hlsBufferAppended",l.BUFFER_EOS="hlsBufferEos",l.BUFFERED_TO_END="hlsBufferedToEnd",l.BUFFER_FLUSHING="hlsBufferFlushing",l.BUFFER_FLUSHED="hlsBufferFlushed",l.MANIFEST_LOADING="hlsManifestLoading",l.MANIFEST_LOADED="hlsManifestLoaded",l.MANIFEST_PARSED="hlsManifestParsed",l.LEVEL_SWITCHING="hlsLevelSwitching",l.LEVEL_SWITCHED="hlsLevelSwitched",l.LEVEL_LOADING="hlsLevelLoading",l.LEVEL_LOADED="hlsLevelLoaded",l.LEVEL_UPDATED="hlsLevelUpdated",l.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",l.LEVELS_UPDATED="hlsLevelsUpdated",l.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",l.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",l.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",l.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",l.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",l.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",l.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",l.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",l.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",l.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",l.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",l.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",l.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",l.CUES_PARSED="hlsCuesParsed",l.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",l.INIT_PTS_FOUND="hlsInitPtsFound",l.FRAG_LOADING="hlsFragLoading",l.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",l.FRAG_LOADED="hlsFragLoaded",l.FRAG_DECRYPTED="hlsFragDecrypted",l.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",l.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",l.FRAG_PARSING_METADATA="hlsFragParsingMetadata",l.FRAG_PARSED="hlsFragParsed",l.FRAG_BUFFERED="hlsFragBuffered",l.FRAG_CHANGED="hlsFragChanged",l.FPS_DROP="hlsFpsDrop",l.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",l.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",l.ERROR="hlsError",l.DESTROYING="hlsDestroying",l.KEY_LOADING="hlsKeyLoading",l.KEY_LOADED="hlsKeyLoaded",l.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",l.BACK_BUFFER_REACHED="hlsBackBufferReached",l.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",l.ASSET_LIST_LOADING="hlsAssetListLoading",l.ASSET_LIST_LOADED="hlsAssetListLoaded",l.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",l.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",l.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",l.INTERSTITIAL_STARTED="hlsInterstitialStarted",l.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",l.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",l.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",l.INTERSTITIAL_ENDED="hlsInterstitialEnded",l.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",l.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",l.EVENT_CUE_ENTER="hlsEventCueEnter",l})({});var wt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},mt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class gr{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class R1{constructor(t,e,i,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new gr(t),this.fast_=new gr(e),this.defaultTTFB_=n,this.ttfb_=new gr(t)}update(t,e){const{slow_:i,fast_:n,ttfb_:a}=this;i.halfLife!==t&&(this.slow_=new gr(t,i.getEstimate(),i.getTotalWeight())),n.halfLife!==e&&(this.fast_=new gr(e,n.getEstimate(),n.getTotalWeight())),a.halfLife!==t&&(this.ttfb_=new gr(t,a.getEstimate(),a.getTotalWeight()))}sample(t,e){t=Math.max(t,this.minDelayMs_);const i=8*e,n=t/1e3,a=i/n;this.fast_.sample(n,a),this.slow_.sample(n,a)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function _1(l,t,e){return(t=D1(t))in l?Object.defineProperty(l,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):l[t]=e,l}function Xt(){return Xt=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(l[i]=e[i])}return l},Xt.apply(null,arguments)}function e0(l,t){var e=Object.keys(l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(l);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(l,n).enumerable})),e.push.apply(e,i)}return e}function zt(l){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?e0(Object(e),!0).forEach(function(i){_1(l,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(e)):e0(Object(e)).forEach(function(i){Object.defineProperty(l,i,Object.getOwnPropertyDescriptor(e,i))})}return l}function I1(l,t){if(typeof l!="object"||!l)return l;var e=l[Symbol.toPrimitive];if(e!==void 0){var i=e.call(l,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(l)}function D1(l){var t=I1(l,"string");return typeof t=="symbol"?t:t+""}class Ri{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${t}]:`;this.trace=Xs,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}}const Xs=function(){},C1={trace:Xs,debug:Xs,log:Xs,warn:Xs,info:Xs,error:Xs};function qf(){return Xt({},C1)}function w1(l,t){const e=self.console[l];return e?e.bind(self.console,`${t?"["+t+"] ":""}[${l}] >`):Xs}function i0(l,t,e){return t[l]?t[l].bind(t):w1(l,e)}const Yf=qf();function k1(l,t,e){const i=qf();if(typeof console=="object"&&l===!0||typeof l=="object"){const n=["debug","log","info","warn","error"];n.forEach(a=>{i[a]=i0(a,l,e)});try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.14`)}catch{return qf()}n.forEach(a=>{Yf[a]=i0(a,l)})}else Xt(Yf,i);return i}const Vt=Yf;function Ws(l=!0){return typeof self>"u"?void 0:(l||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function O1(l){return typeof self<"u"&&l===self.ManagedMediaSource}function Fy(l,t){const e=Object.keys(l),i=Object.keys(t),n=e.length,a=i.length;return!n||!a||n===a&&!e.some(o=>i.indexOf(o)===-1)}function hi(l,t=!1){if(typeof TextDecoder<"u"){const f=new TextDecoder("utf-8").decode(l);if(t){const m=f.indexOf("\0");return m!==-1?f.substring(0,m):f}return f.replace(/\0/g,"")}const e=l.length;let i,n,a,o="",c=0;for(;c<e;){if(i=l[c++],i===0&&t)return o;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:n=l[c++],o+=String.fromCharCode((i&31)<<6|n&63);break;case 14:n=l[c++],a=l[c++],o+=String.fromCharCode((i&15)<<12|(n&63)<<6|(a&63)<<0);break}}return o}function ze(l){let t="";for(let e=0;e<l.length;e++){let i=l[e].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function Uy(l){return Uint8Array.from(l.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function M1(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Sf={exports:{}},s0;function P1(){return s0||(s0=1,(function(l,t){(function(e){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(d,f,m){if(m=m||{},d=d.trim(),f=f.trim(),!f){if(!m.alwaysNormalize)return d;var p=c.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=c.normalizePath(p.path),c.buildURLFromParts(p)}var g=c.parseURL(f);if(!g)throw new Error("Error trying to parse relative URL.");if(g.scheme)return m.alwaysNormalize?(g.path=c.normalizePath(g.path),c.buildURLFromParts(g)):f;var v=c.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var E=n.exec(v.path);v.netLoc=E[1],v.path=E[2]}v.netLoc&&!v.path&&(v.path="/");var x={scheme:v.scheme,netLoc:g.netLoc,path:null,params:g.params,query:g.query,fragment:g.fragment};if(!g.netLoc&&(x.netLoc=v.netLoc,g.path[0]!=="/"))if(!g.path)x.path=v.path,g.params||(x.params=v.params,g.query||(x.query=v.query));else{var T=v.path,A=T.substring(0,T.lastIndexOf("/")+1)+g.path;x.path=c.normalizePath(A)}return x.path===null&&(x.path=m.alwaysNormalize?c.normalizePath(g.path):g.path),c.buildURLFromParts(x)},parseURL:function(d){var f=i.exec(d);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(a,"");d.length!==(d=d.replace(o,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};l.exports=c})()})(Sf)),Sf.exports}var vd=P1();class Ed{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Wt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class $y{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof t=="string"&&(t={url:t}),this.base=t,B1(this,"stats")}setByteRange(t,e){const i=t.split("@",2);let n;i.length===1?n=e?.byteRangeEndOffset||0:n=parseInt(i[1]),this._byteRange=[n,parseInt(i[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Wt.AUDIO]:null,[Wt.VIDEO]:null,[Wt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Ed),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=vd.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Wt.AUDIO]=null,t[Wt.VIDEO]=null,t[Wt.AUDIOVIDEO]=null}}function Ee(l){return l.sn!=="initSegment"}class Tf extends $y{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(ht(t)&&ht(e))return e-t}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){var t;const{levelkeys:e}=this;if(!e||e.NONE)return null;if(e.identity)this._decryptdata||(this._decryptdata=e.identity.getDecryptData(this.sn));else if(!((t=this._decryptdata)!=null&&t.keyId)){const i=Object.keys(e);if(i.length===1){const n=this._decryptdata=e[i[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,e))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const t=ht(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){var e;const i=Object.keys(this.levelkeys),n=i.length;if(n>1||n===1&&(e=this.levelkeys[i[0]])!=null&&e.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){if(!ht(t)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=t}get ref(){return Ee(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){const e=this.levelkeys;if(e){var i;const n=e[t];n&&!((i=this._decryptdata)!=null&&i.keyId)&&(this._decryptdata=n.getDecryptData(this.sn,e))}}abortRequests(){var t,e;(t=this.loader)==null||t.abort(),(e=this.keyLoader)==null||e.abort()}setElementaryStreamInfo(t,e,i,n,a,o=!1){const{elementaryStreams:c}=this,d=c[t];if(!d){c[t]={startPTS:e,endPTS:i,startDTS:n,endDTS:a,partial:o};return}d.startPTS=Math.min(d.startPTS,e),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,n),d.endDTS=Math.max(d.endDTS,a)}}class N1 extends $y{constructor(t,e,i,n,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=n;const o=t.enumeratedString("BYTERANGE");o&&this.setByteRange(o,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function jy(l,t){const e=Object.getPrototypeOf(l);if(e){const i=Object.getOwnPropertyDescriptor(e,t);return i||jy(e,t)}}function B1(l,t){const e=jy(l,t);e&&(e.enumerable=!0,Object.defineProperty(l,t,e))}const n0=Math.pow(2,32)-1,F1=[].push,Gy={video:1,audio:2,id3:3,text:4};function be(l){return String.fromCharCode.apply(null,l)}function Hy(l,t){const e=l[t]<<8|l[t+1];return e<0?65536+e:e}function xt(l,t){const e=zy(l,t);return e<0?4294967296+e:e}function r0(l,t){let e=xt(l,t);return e*=Math.pow(2,32),e+=xt(l,t+4),e}function zy(l,t){return l[t]<<24|l[t+1]<<16|l[t+2]<<8|l[t+3]}function U1(l){const t=l.byteLength;for(let e=0;e<t;){const i=xt(l,e);if(i>8&&l[e+4]===109&&l[e+5]===111&&l[e+6]===111&&l[e+7]===102)return!0;e=i>1?e+i:t}return!1}function Ct(l,t){const e=[];if(!t.length)return e;const i=l.byteLength;for(let n=0;n<i;){const a=xt(l,n),o=be(l.subarray(n+4,n+8)),c=a>1?n+a:i;if(o===t[0])if(t.length===1)e.push(l.subarray(n+8,c));else{const d=Ct(l.subarray(n+8,c),t.slice(1));d.length&&F1.apply(e,d)}n=c}return e}function $1(l){const t=[],e=l[0];let i=8;const n=xt(l,i);i+=4;let a=0,o=0;e===0?(a=xt(l,i),o=xt(l,i+4),i+=8):(a=r0(l,i),o=r0(l,i+8),i+=16),i+=2;let c=l.length+o;const d=Hy(l,i);i+=2;for(let f=0;f<d;f++){let m=i;const p=xt(l,m);m+=4;const g=p&2147483647;if((p&2147483648)>>>31===1)return Vt.warn("SIDX has hierarchical references (not supported)"),null;const E=xt(l,m);m+=4,t.push({referenceSize:g,subsegmentDuration:E,info:{duration:E/n,start:c,end:c+g-1}}),c+=g,m+=4,i=m}return{earliestPresentationTime:a,timescale:n,version:e,referencesCount:d,references:t}}function Vy(l){const t=[],e=Ct(l,["moov","trak"]);for(let n=0;n<e.length;n++){const a=e[n],o=Ct(a,["tkhd"])[0];if(o){let c=o[0];const d=xt(o,c===0?12:20),f=Ct(a,["mdia","mdhd"])[0];if(f){c=f[0];const m=xt(f,c===0?12:20),p=Ct(a,["mdia","hdlr"])[0];if(p){const g=be(p.subarray(8,12)),v={soun:Wt.AUDIO,vide:Wt.VIDEO}[g],E=Ct(a,["mdia","minf","stbl","stsd"])[0],x=j1(E);v?(t[d]={timescale:m,type:v,stsd:x},t[v]=zt({timescale:m,id:d},x)):t[d]={timescale:m,type:g,stsd:x}}}}}return Ct(l,["moov","mvex","trex"]).forEach(n=>{const a=xt(n,4),o=t[a];o&&(o.default={duration:xt(n,12),flags:xt(n,20)})}),t}function j1(l){const t=l.subarray(8),e=t.subarray(86),i=be(t.subarray(4,8));let n=i,a;const o=i==="enca"||i==="encv";if(o){const f=Ct(t,[i])[0].subarray(i==="enca"?28:78);Ct(f,["sinf"]).forEach(p=>{const g=Ct(p,["schm"])[0];if(g){const v=be(g.subarray(4,8));if(v==="cbcs"||v==="cenc"){const E=Ct(p,["frma"])[0];E&&(n=be(E))}}})}const c=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Ct(e,["avcC"])[0];d&&d.length>3&&(n+="."+ao(d[1])+ao(d[2])+ao(d[3]),a=ro(c==="avc1"?"dva1":"dvav",e));break}case"mp4a":{const d=Ct(t,[i])[0],f=Ct(d.subarray(28),["esds"])[0];if(f&&f.length>7){let m=4;if(f[m++]!==3)break;m=xf(f,m),m+=2;const p=f[m++];if(p&128&&(m+=2),p&64&&(m+=f[m++]),f[m++]!==4)break;m=xf(f,m);const g=f[m++];if(g===64)n+="."+ao(g);else break;if(m+=12,f[m++]!==5)break;m=xf(f,m);const v=f[m++];let E=(v&248)>>3;E===31&&(E+=1+((v&7)<<3)+((f[m]&224)>>5)),n+="."+E}break}case"hvc1":case"hev1":{const d=Ct(e,["hvcC"])[0];if(d&&d.length>12){const f=d[1],m=["","A","B","C"][f>>6],p=f&31,g=xt(d,2),v=(f&32)>>5?"H":"L",E=d[12],x=d.subarray(6,12);n+="."+m+p,n+="."+G1(g).toString(16).toUpperCase(),n+="."+v+E;let T="";for(let A=x.length;A--;){const b=x[A];(b||T)&&(T="."+b.toString(16).toUpperCase()+T)}n+=T}a=ro(c=="hev1"?"dvhe":"dvh1",e);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=ro(n,e)||n;break}case"vp09":{const d=Ct(e,["vpcC"])[0];if(d&&d.length>6){const f=d[4],m=d[5],p=d[6]>>4&15;n+="."+$i(f)+"."+$i(m)+"."+$i(p)}break}case"av01":{const d=Ct(e,["av1C"])[0];if(d&&d.length>2){const f=d[1]>>>5,m=d[1]&31,p=d[2]>>>7?"H":"M",g=(d[2]&64)>>6,v=(d[2]&32)>>5,E=f===2&&g?v?12:10:g?10:8,x=(d[2]&16)>>4,T=(d[2]&8)>>3,A=(d[2]&4)>>2,b=d[2]&3;n+="."+f+"."+$i(m)+p+"."+$i(E)+"."+x+"."+T+A+b+"."+$i(1)+"."+$i(1)+"."+$i(1)+"."+0,a=ro("dav1",e)}break}}return{codec:n,encrypted:o,supplemental:a}}function ro(l,t){const e=Ct(t,["dvvC"]),i=e.length?e[0]:Ct(t,["dvcC"])[0];if(i){const n=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return l+"."+$i(n)+"."+$i(a)}}function G1(l){let t=0;for(let e=0;e<32;e++)t|=(l>>e&1)<<31-e;return t>>>0}function xf(l,t){const e=t+5;for(;l[t++]&128&&t<e;);return t}function ao(l){return("0"+l.toString(16).toUpperCase()).slice(-2)}function $i(l){return(l<10?"0":"")+l}function H1(l,t){if(!l||!t)return;const e=t.keyId;e&&t.isCommonEncryption&&Ky(l,(i,n)=>{const a=i.subarray(8,24);a.some(o=>o!==0)||(Vt.log(`[eme] Patching keyId in 'enc${n?"a":"v"}>sinf>>tenc' box: ${ze(a)} -> ${ze(e)}`),i.set(e,8))})}function z1(l){const t=[];return Ky(l,e=>t.push(e.subarray(8,24))),t}function Ky(l,t){Ct(l,["moov","trak"]).forEach(i=>{const n=Ct(i,["mdia","minf","stbl","stsd"])[0];if(!n)return;const a=n.subarray(8);let o=Ct(a,["enca"]);const c=o.length>0;c||(o=Ct(a,["encv"])),o.forEach(d=>{const f=c?d.subarray(28):d.subarray(78);Ct(f,["sinf"]).forEach(p=>{const g=qy(p);g&&t(g,c)})})})}function qy(l){const t=Ct(l,["schm"])[0];if(t){const e=be(t.subarray(4,8));if(e==="cbcs"||e==="cenc"){const i=Ct(l,["schi","tenc"])[0];if(i)return i}}}function V1(l,t,e){const i={},n=Ct(l,["moof","traf"]);for(let a=0;a<n.length;a++){const o=n[a],c=Ct(o,["tfhd"])[0],d=xt(c,4),f=t[d];if(!f)continue;i[d]||(i[d]={start:NaN,duration:0,sampleCount:0,timescale:f.timescale,type:f.type});const m=i[d],p=Ct(o,["tfdt"])[0];if(p){const _=p[0];let I=xt(p,4);_===1&&(I===n0?e.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(I*=n0+1,I+=xt(p,8))),ht(I)&&(!ht(m.start)||I<m.start)&&(m.start=I)}const g=f.default,v=xt(c,0)|g?.flags;let E=g?.duration||0;v&8&&(v&2?E=xt(c,12):E=xt(c,8));const x=Ct(o,["trun"]);let T=m.start||0,A=0,b=E;for(let _=0;_<x.length;_++){const I=x[_],C=xt(I,4),N=m.sampleCount;m.sampleCount+=C;const w=I[3]&1,P=I[3]&4,B=I[2]&1,M=I[2]&2,K=I[2]&4,tt=I[2]&8;let H=8,G=C;for(w&&(H+=4),P&&C&&(!(I[H+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=N),H+=4,B?(b=xt(I,H),H+=4):b=E,M&&(H+=4),tt&&(H+=4),T+=b,A+=b,G--);G--;)B?(b=xt(I,H),H+=4):b=E,M&&(H+=4),K&&(I[H+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(G+1),m.keyFrameStart=T),H+=4),tt&&(H+=4),T+=b,A+=b;!A&&E&&(A+=E*C)}m.duration+=A}if(!Object.keys(i).some(a=>i[a].duration)){let a=1/0,o=0;const c=Ct(l,["sidx"]);for(let d=0;d<c.length;d++){const f=$1(c[d]);if(f!=null&&f.references){a=Math.min(a,f.earliestPresentationTime/f.timescale);const m=f.references.reduce((p,g)=>p+g.info.duration||0,0);o=Math.max(o,m+f.earliestPresentationTime/f.timescale)}}o&&ht(o)&&Object.keys(i).forEach(d=>{i[d].duration||(i[d].duration=o*i[d].timescale-i[d].start)})}return i}function K1(l){const t={valid:null,remainder:null},e=Ct(l,["moof"]);if(e.length<2)return t.remainder=l,t;const i=e[e.length-1];return t.valid=l.slice(0,i.byteOffset-8),t.remainder=l.slice(i.byteOffset-8),t}function Li(l,t){const e=new Uint8Array(l.length+t.length);return e.set(l),e.set(t,l.length),e}function a0(l,t){const e=[],i=t.samples,n=t.timescale,a=t.id;let o=!1;return Ct(i,["moof"]).map(d=>{const f=d.byteOffset-8;Ct(d,["traf"]).map(p=>{const g=Ct(p,["tfdt"]).map(v=>{const E=v[0];let x=xt(v,4);return E===1&&(x*=Math.pow(2,32),x+=xt(v,8)),x/n})[0];return g!==void 0&&(l=g),Ct(p,["tfhd"]).map(v=>{const E=xt(v,4),x=xt(v,0)&16777215,T=(x&1)!==0,A=(x&2)!==0,b=(x&8)!==0;let _=0;const I=(x&16)!==0;let C=0;const N=(x&32)!==0;let w=8;E===a&&(T&&(w+=8),A&&(w+=4),b&&(_=xt(v,w),w+=4),I&&(C=xt(v,w),w+=4),N&&(w+=4),t.type==="video"&&(o=Ko(t.codec)),Ct(p,["trun"]).map(P=>{const B=P[0],M=xt(P,0)&16777215,K=(M&1)!==0;let tt=0;const H=(M&4)!==0,G=(M&256)!==0;let Y=0;const O=(M&512)!==0;let j=0;const X=(M&1024)!==0,rt=(M&2048)!==0;let ct=0;const k=xt(P,4);let U=8;K&&(tt=xt(P,U),U+=4),H&&(U+=4);let it=tt+f;for(let ut=0;ut<k;ut++){if(G?(Y=xt(P,U),U+=4):Y=_,O?(j=xt(P,U),U+=4):j=C,X&&(U+=4),rt&&(B===0?ct=xt(P,U):ct=zy(P,U),U+=4),t.type===Wt.VIDEO){let ft=0;for(;ft<j;){const dt=xt(i,it);if(it+=4,q1(o,i[it])){const St=i.subarray(it,it+dt);Sd(St,o?2:1,l+ct/n,e)}it+=dt,ft+=dt+4}}l+=Y/n}}))})})}),e}function Ko(l){if(!l)return!1;const t=l.substring(0,4);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function q1(l,t){if(l){const e=t>>1&63;return e===39||e===40}else return(t&31)===6}function Sd(l,t,e,i){const n=Yy(l);let a=0;a+=t;let o=0,c=0,d=0;for(;a<n.length;){o=0;do{if(a>=n.length)break;d=n[a++],o+=d}while(d===255);c=0;do{if(a>=n.length)break;d=n[a++],c+=d}while(d===255);const f=n.length-a;let m=a;if(c<f)a+=c;else if(c>f){Vt.error(`Malformed SEI payload. ${c} is too small, only ${f} bytes left to parse.`);break}if(o===4){if(n[m++]===181){const g=Hy(n,m);if(m+=2,g===49){const v=xt(n,m);if(m+=4,v===1195456820){const E=n[m++];if(E===3){const x=n[m++],T=31&x,A=64&x,b=A?2+T*3:0,_=new Uint8Array(b);if(A){_[0]=x;for(let I=1;I<b;I++)_[I]=n[m++]}i.push({type:E,payloadType:o,pts:e,bytes:_})}}}}}else if(o===5&&c>16){const p=[];for(let E=0;E<16;E++){const x=n[m++].toString(16);p.push(x.length==1?"0"+x:x),(E===3||E===5||E===7||E===9)&&p.push("-")}const g=c-16,v=new Uint8Array(g);for(let E=0;E<g;E++)v[E]=n[m++];i.push({payloadType:o,pts:e,uuid:p.join(""),userData:hi(v),userDataBytes:v})}}}function Yy(l){const t=l.byteLength,e=[];let i=1;for(;i<t-2;)l[i]===0&&l[i+1]===0&&l[i+2]===3?(e.push(i+2),i+=2):i++;if(e.length===0)return l;const n=t-e.length,a=new Uint8Array(n);let o=0;for(i=0;i<n;o++,i++)o===e[0]&&(o++,e.shift()),a[i]=l[o];return a}function Y1(l){const t=l[0];let e="",i="",n=0,a=0,o=0,c=0,d=0,f=0;if(t===0){for(;be(l.subarray(f,f+1))!=="\0";)e+=be(l.subarray(f,f+1)),f+=1;for(e+=be(l.subarray(f,f+1)),f+=1;be(l.subarray(f,f+1))!=="\0";)i+=be(l.subarray(f,f+1)),f+=1;i+=be(l.subarray(f,f+1)),f+=1,n=xt(l,12),a=xt(l,16),c=xt(l,20),d=xt(l,24),f=28}else if(t===1){f+=4,n=xt(l,f),f+=4;const p=xt(l,f);f+=4;const g=xt(l,f);for(f+=4,o=2**32*p+g,A1(o)||(o=Number.MAX_SAFE_INTEGER,Vt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=xt(l,f),f+=4,d=xt(l,f),f+=4;be(l.subarray(f,f+1))!=="\0";)e+=be(l.subarray(f,f+1)),f+=1;for(e+=be(l.subarray(f,f+1)),f+=1;be(l.subarray(f,f+1))!=="\0";)i+=be(l.subarray(f,f+1)),f+=1;i+=be(l.subarray(f,f+1)),f+=1}const m=l.subarray(f,l.byteLength);return{schemeIdUri:e,value:i,timeScale:n,presentationTime:o,presentationTimeDelta:a,eventDuration:c,id:d,payload:m}}function X1(l,...t){const e=t.length;let i=8,n=e;for(;n--;)i+=t[n].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(l,4),n=0,i=8;n<e;n++)a.set(t[n],i),i+=t[n].byteLength;return a}function Q1(l,t,e){if(l.byteLength!==16)throw new RangeError("Invalid system id");let i,n;i=0,n=new Uint8Array;let a;i>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;const o=new Uint8Array(4);return e.byteLength>0&&new DataView(o.buffer).setUint32(0,e.byteLength,!1),X1([112,115,115,104],new Uint8Array([i,0,0,0]),l,a,n,o,e)}function W1(l){const t=[];if(l instanceof ArrayBuffer){const e=l.byteLength;let i=0;for(;i+32<e;){const n=new DataView(l,i),a=Z1(n);t.push(a),i+=a.size}}return t}function Z1(l){const t=l.getUint32(0),e=l.byteOffset,i=l.byteLength;if(i<t)return{offset:e,size:i};if(l.getUint32(4)!==1886614376)return{offset:e,size:t};const a=l.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:e,size:t};const o=l.buffer,c=ze(new Uint8Array(o,e+12,16));let d=null,f=null,m=0;if(a===0)m=28;else{const g=l.getUint32(28);if(!g||i<32+g*16)return{offset:e,size:t};d=[];for(let v=0;v<g;v++)d.push(new Uint8Array(o,e+32+v*16,16));m=32+g*16}if(!m)return{offset:e,size:t};const p=l.getUint32(m);return t-32<p?{offset:e,size:t}:(f=new Uint8Array(o,e+m+4,p),{version:a,systemId:c,kids:d,data:f,offset:e,size:t})}const Xy=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),_r={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Td(l,t){const e=_r[t];return!!e&&!!e[l.slice(0,4)]}function ka(l,t,e=!0){return!l.split(",").some(i=>!xd(i,t,e))}function xd(l,t,e=!0){var i;const n=Ws(e);return(i=n?.isTypeSupported(Oa(l,t)))!=null?i:!1}function Oa(l,t){return`${t}/mp4;codecs=${l}`}function l0(l){if(l){const t=l.substring(0,4);return _r.video[t]}return 2}function Oo(l){const t=Xy();return l.split(",").reduce((e,i)=>{const a=t&&Ko(i)?9:_r.video[i];return a?(a*2+e)/(e?3:2):(_r.audio[i]+e)/(e?2:1)},0)}const bf={};function J1(l,t=!0){if(bf[l])return bf[l];const e={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[l];for(let n=0;n<e.length;n++){var i;if(xd(e[n],"audio",t))return bf[l]=e[n],e[n];if(e[n]==="mp3"&&(i=Ws(t))!=null&&i.isTypeSupported("audio/mpeg"))return""}return l}const tb=/flac|opus|mp4a\.40\.34/i;function Mo(l,t=!0){return l.replace(tb,e=>J1(e.toLowerCase(),t))}function eb(l,t){const e=[];if(l){const i=l.split(",");for(let n=0;n<i.length;n++)Td(i[n],"video")||e.push(i[n])}return t&&e.push(t),e.join(",")}function Ao(l,t){if(l&&(l.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(l)!==-1)&&(o0(l,"audio")||o0(l,"video")))return l;if(t){const e=t.split(",");if(e.length>1){if(l){for(let i=e.length;i--;)if(e[i].substring(0,4)===l.substring(0,4))return e[i]}return e[0]}}return t||l}function o0(l,t){return Td(l,t)&&xd(l,t)}function ib(l){const t=l.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(".");i.length>2&&i[0]==="avc1"&&(t[e]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return t.join(",")}function sb(l){if(l.startsWith("av01.")){const t=l.split("."),e=["0","111","01","01","01","0"];for(let i=t.length;i>4&&i<10;i++)t[i]=e[i-4];return t.join(".")}return l}function u0(l){const t=Ws(l)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Xf(l){return l.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const nb={supported:!0,powerEfficient:!0,smooth:!0},rb={supported:!1,smooth:!1,powerEfficient:!1},Qy={supported:!0,configurations:[],decodingInfoResults:[nb]};function Wy(l,t){return{supported:!1,configurations:t,decodingInfoResults:[rb],error:l}}function ab(l,t,e,i,n,a){const o=l.videoCodec,c=l.audioCodec?l.audioGroups:null,d=a?.audioCodec,f=a?.channels,m=f?parseInt(f):d?1/0:2;let p=null;if(c!=null&&c.length)try{c.length===1&&c[0]?p=t.groups[c[0]].channels:p=c.reduce((g,v)=>{if(v){const E=t.groups[v];if(!E)throw new Error(`Audio track group ${v} not found`);Object.keys(E.channels).forEach(x=>{g[x]=(g[x]||0)+E.channels[x]})}return g},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(g=>Ko(g))||l.width>1920&&l.height>1088||l.height>1920&&l.width>1088||l.frameRate>Math.max(i,30)||l.videoRange!=="SDR"&&l.videoRange!==e||l.bitrate>Math.max(n,8e6))||!!p&&ht(m)&&Object.keys(p).some(g=>parseInt(g)>m)}function Zy(l,t,e,i={}){const n=l.videoCodec;if(!n&&!l.audioCodec||!e)return Promise.resolve(Qy);const a=[],o=lb(l),c=o.length,d=ob(l,t,c>0),f=d.length;for(let m=c||1*f||1;m--;){const p={type:"media-source"};if(c&&(p.video=o[m%c]),f){p.audio=d[m%f];const g=p.audio.bitrate;p.video&&g&&(p.video.bitrate-=g)}a.push(p)}if(n){const m=navigator.userAgent;if(n.split(",").some(p=>Ko(p))&&Xy())return Promise.resolve(Wy(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),a))}return Promise.all(a.map(m=>{const p=cb(m);return i[p]||(i[p]=e.decodingInfo(m))})).then(m=>({supported:!m.some(p=>!p.supported),configurations:a,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:a,decodingInfoResults:[],error:m}))}function lb(l){var t;const e=(t=l.videoCodec)==null?void 0:t.split(","),i=Jy(l),n=l.width||640,a=l.height||480,o=l.frameRate||30,c=l.videoRange.toLowerCase();return e?e.map(d=>{const f={contentType:Oa(sb(d),"video"),width:n,height:a,bitrate:i,framerate:o};return c!=="sdr"&&(f.transferFunction=c),f}):[]}function ob(l,t,e){var i;const n=(i=l.audioCodec)==null?void 0:i.split(","),a=Jy(l);return n&&l.audioGroups?l.audioGroups.reduce((o,c)=>{var d;const f=c?(d=t.groups[c])==null?void 0:d.tracks:null;return f?f.reduce((m,p)=>{if(p.groupId===c){const g=parseFloat(p.channels||"");n.forEach(v=>{const E={contentType:Oa(v,"audio"),bitrate:e?ub(v,a):a};g&&(E.channels=""+g),m.push(E)})}return m},o):o},[]):[]}function ub(l,t){if(t<=1)return 1;let e=128e3;return l==="ec-3"?e=768e3:l==="ac-3"&&(e=64e4),Math.min(t/2,e)}function Jy(l){return Math.ceil(Math.max(l.bitrate*.9,l.averageBitrate)/1e3)*1e3||1}function cb(l){let t="";const{audio:e,video:i}=l;if(i){const n=Xf(i.contentType);t+=`${n}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(e){const n=Xf(e.contentType);t+=`${i?"_":""}${n}_c${e.channels}`}return t}const Qf=["NONE","TYPE-0","TYPE-1",null];function fb(l){return Qf.indexOf(l)>-1}const Po=["SDR","PQ","HLG"];function db(l){return!!l&&Po.indexOf(l)>-1}var Lo={No:"",Yes:"YES",v2:"v2"};function c0(l){const{canSkipUntil:t,canSkipDateRanges:e,age:i}=l,n=i<t/2;return t&&n?e?Lo.v2:Lo.Yes:Lo.No}class f0{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return this.msn!==void 0&&e.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class Ma{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const i=(e=t.supplemental)==null?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return d0(this._audioGroups,t)}hasSubtitleGroup(t){return d0(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e){if(t==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(e)===-1&&i.push(e)}else if(t==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(e)===-1&&i.push(e)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function d0(l,t){return!t||!l?!1:l.indexOf(t)!==-1}function hb(){if(typeof matchMedia=="function"){const l=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(l.media!==t.media)return l.matches===!0}return!1}function mb(l,t){let e=!1,i=[];if(l&&(e=l!=="SDR",i=[l]),t){i=t.allowedVideoRanges||Po.slice(0);const n=i.join("")!=="SDR"&&!t.videoCodec;e=t.preferHDR!==void 0?t.preferHDR:n&&hb(),e||(i=["SDR"])}return{preferHDR:e,allowedVideoRanges:i}}const pb=l=>{const t=new WeakSet;return(e,i)=>{if(l&&(i=l(e,i)),typeof i=="object"&&i!==null){if(t.has(i))return;t.add(i)}return i}},Zt=(l,t)=>JSON.stringify(l,pb(t));function gb(l,t,e,i,n){const a=Object.keys(l),o=i?.channels,c=i?.audioCodec,d=n?.videoCodec,f=o&&parseInt(o)===2;let m=!1,p=!1,g=1/0,v=1/0,E=1/0,x=1/0,T=0,A=[];const{preferHDR:b,allowedVideoRanges:_}=mb(t,n);for(let P=a.length;P--;){const B=l[a[P]];m||(m=B.channels[2]>0),g=Math.min(g,B.minHeight),v=Math.min(v,B.minFramerate),E=Math.min(E,B.minBitrate),_.filter(K=>B.videoRanges[K]>0).length>0&&(p=!0)}g=ht(g)?g:0,v=ht(v)?v:0;const I=Math.max(1080,g),C=Math.max(30,v);E=ht(E)?E:e,e=Math.max(E,e),p||(t=void 0);const N=a.length>1;return{codecSet:a.reduce((P,B)=>{const M=l[B];if(B===P)return P;if(A=p?_.filter(K=>M.videoRanges[K]>0):[],N){if(M.minBitrate>e)return Fi(B,`min bitrate of ${M.minBitrate} > current estimate of ${e}`),P;if(!M.hasDefaultAudio)return Fi(B,"no renditions with default or auto-select sound found"),P;if(c&&B.indexOf(c.substring(0,4))%5!==0)return Fi(B,`audio codec preference "${c}" not found`),P;if(o&&!f){if(!M.channels[o])return Fi(B,`no renditions with ${o} channel sound found (channels options: ${Object.keys(M.channels)})`),P}else if((!c||f)&&m&&M.channels[2]===0)return Fi(B,"no renditions with stereo sound found"),P;if(M.minHeight>I)return Fi(B,`min resolution of ${M.minHeight} > maximum of ${I}`),P;if(M.minFramerate>C)return Fi(B,`min framerate of ${M.minFramerate} > maximum of ${C}`),P;if(!A.some(K=>M.videoRanges[K]>0))return Fi(B,`no variants with VIDEO-RANGE of ${Zt(A)} found`),P;if(d&&B.indexOf(d.substring(0,4))%5!==0)return Fi(B,`video codec preference "${d}" not found`),P;if(M.maxScore<T)return Fi(B,`max score of ${M.maxScore} < selected max of ${T}`),P}return P&&(Oo(B)>=Oo(P)||M.fragmentError>l[P].fragmentError)?P:(x=M.minIndex,T=M.maxScore,B)},void 0),videoRanges:A,preferHDR:b,minFramerate:v,minBitrate:E,minIndex:x}}function Fi(l,t){Vt.log(`[abr] start candidates with "${l}" ignored because ${t}`)}function tv(l){return l.reduce((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const n=e.channels||"2";return i.channels[n]=(i.channels[n]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function yb(l,t,e,i){return l.slice(e,i+1).reduce((n,a,o)=>{if(!a.codecSet)return n;const c=a.audioGroups;let d=n[a.codecSet];d||(n[a.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!c,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,a.bitrate);const f=Math.min(a.height,a.width);return d.minHeight=Math.min(d.minHeight,f),d.minFramerate=Math.min(d.minFramerate,a.frameRate),d.minIndex=Math.min(d.minIndex,o),d.maxScore=Math.max(d.maxScore,a.score),d.fragmentError+=a.fragmentError,d.videoRanges[a.videoRange]=(d.videoRanges[a.videoRange]||0)+1,c&&c.forEach(m=>{if(!m)return;const p=t.groups[m];p&&(d.hasDefaultAudio=d.hasDefaultAudio||t.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(p.channels).forEach(g=>{d.channels[g]=(d.channels[g]||0)+p.channels[g]}))}),n},{})}function h0(l){if(!l)return l;const{lang:t,assocLang:e,characteristics:i,channels:n,audioCodec:a}=l;return{lang:t,assocLang:e,characteristics:i,channels:n,audioCodec:a}}function Gi(l,t,e){if("attrs"in l){const i=t.indexOf(l);if(i!==-1)return i}for(let i=0;i<t.length;i++){const n=t[i];if(Ln(l,n,e))return i}return-1}function Ln(l,t,e){const{groupId:i,name:n,lang:a,assocLang:o,default:c}=l,d=l.forced;return(i===void 0||t.groupId===i)&&(n===void 0||t.name===n)&&(a===void 0||vb(a,t.lang))&&(a===void 0||t.assocLang===o)&&(c===void 0||t.default===c)&&(d===void 0||t.forced===d)&&(!("characteristics"in l)||Eb(l.characteristics||"",t.characteristics))&&(e===void 0||e(l,t))}function vb(l,t="--"){return l.length===t.length?l===t:l.startsWith(t)||t.startsWith(l)}function Eb(l,t=""){const e=l.split(","),i=t.split(",");return e.length===i.length&&!e.some(n=>i.indexOf(n)===-1)}function bn(l,t){const{audioCodec:e,channels:i}=l;return(e===void 0||(t.audioCodec||"").substring(0,4)===e.substring(0,4))&&(i===void 0||i===(t.channels||"2"))}function Sb(l,t,e,i,n){const a=t[i],c=t.reduce((g,v,E)=>{const x=v.uri;return(g[x]||(g[x]=[])).push(E),g},{})[a.uri];c.length>1&&(i=Math.max.apply(Math,c));const d=a.videoRange,f=a.frameRate,m=a.codecSet.substring(0,4),p=m0(t,i,g=>{if(g.videoRange!==d||g.frameRate!==f||g.codecSet.substring(0,4)!==m)return!1;const v=g.audioGroups,E=e.filter(x=>!v||v.indexOf(x.groupId)!==-1);return Gi(l,E,n)>-1});return p>-1?p:m0(t,i,g=>{const v=g.audioGroups,E=e.filter(x=>!v||v.indexOf(x.groupId)!==-1);return Gi(l,E,n)>-1})}function m0(l,t,e){for(let i=t;i>-1;i--)if(e(l[i]))return i;for(let i=t+1;i<l.length;i++)if(e(l[i]))return i;return-1}function No(l,t){var e;return!!l&&l!==((e=t.loadLevelObj)==null?void 0:e.uri)}class Tb extends Ri{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var i;const{fragCurrent:n,partCurrent:a,hls:o}=this,{autoLevelEnabled:c,media:d}=o;if(!n||!d)return;const f=performance.now(),m=a?a.stats:n.stats,p=a?a.duration:n.duration,g=f-m.loading.start,v=o.minAutoLevel,E=n.level,x=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||E<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!c)return;const T=x>-1&&x!==E,A=!!e||T;if(!A&&(d.paused||!d.playbackRate||!d.readyState))return;const b=o.mainForwardBufferInfo;if(!A&&b===null)return;const _=this.bwEstimator.getEstimateTTFB(),I=Math.abs(d.playbackRate);if(g<=Math.max(_,1e3*(p/(I*2))))return;const C=b?b.len/I:0,N=m.loading.first?m.loading.first-m.loading.start:-1,w=m.loaded&&N>-1,P=this.getBwEstimate(),B=o.levels,M=B[E],K=Math.max(m.loaded,Math.round(p*(n.bitrate||M.averageBitrate)/8));let tt=w?g-N:g;tt<1&&w&&(tt=Math.min(g,m.loaded*8/P));const H=w?m.loaded*1e3/tt:0,G=_/1e3,Y=H?(K-m.loaded)/H:K*8/P+G;if(Y<=C)return;const O=H?H*8:P,j=((i=e?.details||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,X=this.hls.config.abrBandWidthUpFactor;let rt=Number.POSITIVE_INFINITY,ct;for(ct=E-1;ct>v;ct--){const ut=B[ct].maxBitrate,ft=!B[ct].details||j;if(rt=this.getTimeToLoadFrag(G,O,p*ut,ft),rt<Math.min(C,p+G))break}if(rt>=Y||rt>p*10)return;w?this.bwEstimator.sample(g-Math.min(_,N),m.loaded):this.bwEstimator.sampleTTFB(g);const k=B[ct].maxBitrate;this.getBwEstimate()*X>k&&this.resetEstimator(k);const U=this.findBestLevel(k,v,ct,0,C,1,1);U>-1&&(ct=U),this.warn(`Fragment ${n.sn}${a?" part "+a.index:""} of level ${E} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${C.toFixed(3)} s
      Estimated load time for current fragment: ${Y.toFixed(3)} s
      Estimated load time for down switch fragment: ${rt.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${ht(P)?P|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${ct} @ ${k|0} bps`),o.nextLoadLevel=o.nextAutoLevel=ct,this.clearTimer();const it=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===ct&&ct>0){const ut=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ct>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${ut.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,ct>v){let ft=this.findBestLevel(this.hls.levels[v].bitrate,v,ct,0,ut,1,1);ft===-1&&(ft=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ft,this.resetEstimator(this.hls.levels[ft].bitrate)}}};T||Y>rt*2?it():this.timer=self.setInterval(it,rt*1e3),o.trigger(R.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:m})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new R1(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.FRAG_LOADING,this.onFragLoading,this),t.on(R.FRAG_LOADED,this.onFragLoaded,this),t.on(R.FRAG_BUFFERED,this.onFragBuffered,this),t.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(R.LEVEL_LOADED,this.onLevelLoaded,this),t.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.FRAG_LOADING,this.onFragLoading,this),t.off(R.FRAG_LOADED,this.onFragLoaded,this),t.off(R.FRAG_BUFFERED,this.onFragBuffered,this),t.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(R.LEVEL_LOADED,this.onLevelLoaded,this),t.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(R.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var n;this.fragCurrent=i,this.partCurrent=(n=e.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case q.FRAG_LOAD_TIMEOUT:{const i=e.frag,{fragCurrent:n,partCurrent:a}=this;if(i&&n&&i.sn===n.sn&&i.level===n.level){const o=performance.now(),c=a?a.stats:i.stats,d=o-c.loading.start,f=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&f>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,f),c.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(t,e,i,n){const a=t+i/e,o=n?t+this.lastLevelLoadSec:0;return a+o}onLevelLoaded(t,e){const i=this.hls.config,{loading:n}=e.stats,a=n.end-n.first;ht(a)&&(this.lastLevelLoadSec=a/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:i}){const n=i?i.stats:e.stats;if(e.type===mt.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=i?i.duration:e.duration,o=this.hls.levels[e.level],c=(o.loaded?o.loaded.bytes:0)+n.loaded,d=(o.loaded?o.loaded.duration:0)+a;o.loaded={bytes:c,duration:d},o.realBitrate=Math.round(8*c/d)}if(e.bitrateTest){const a={stats:n,frag:e,part:i,id:e.type};this.onFragBuffered(R.FRAG_BUFFERED,a),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:i,part:n}=e,a=n!=null&&n.stats.loaded?n.stats:i.stats;if(a.aborted||this.ignoreFragment(i))return;const o=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==mt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,e,t,0,n,1,1);if(a>-1)return a;const o=this.hls.firstLevel,c=Math.min(Math.max(o,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(t!==-1&&(!i||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const a=i&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const o=this.hls.levels;if(o.length>Math.max(t,a)&&o[t].loadError<=o[a].loadError)return t}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:n,config:a,minAutoLevel:o}=i,c=e?e.duration:t?t.duration:0,d=this.getBwEstimate(),f=this.getStarvationDelay();let m=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(f){const T=this.findBestLevel(d,o,n,f,0,m,p);if(T>=0)return this.rebufferNotice=-1,T}let g=c?Math.min(c,a.maxStarvationDelay):a.maxStarvationDelay;if(!f){const T=this.bitrateTestDelay;T&&(g=(c?Math.min(c,a.maxLoadingDelay):a.maxLoadingDelay)-T,this.info(`bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),m=p=1)}const v=this.findBestLevel(d,o,n,f,g,m,p);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const E=i.levels[o],x=i.loadLevelObj;return x&&E?.bitrate<x.bitrate?o:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&e.playbackRate!==0?Math.abs(e.playbackRate):1,n=t.mainForwardBufferInfo;return(n?n.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,n,a,o,c){var d;const f=n+a,m=this.lastLoadedFragLevel,p=m===-1?this.hls.firstLevel:m,{fragCurrent:g,partCurrent:v}=this,{levels:E,allAudioTracks:x,loadLevel:T,config:A}=this.hls;if(E.length===1)return 0;const b=E[p],_=!!((d=this.hls.latestLevelDetails)!=null&&d.live),I=T===-1||m===-1;let C,N="SDR",w=b?.frameRate||0;const{audioPreference:P,videoPreference:B}=A,M=this.audioTracksByGroup||(this.audioTracksByGroup=tv(x));let K=-1;if(I){if(this.firstSelection!==-1)return this.firstSelection;const O=this.codecTiers||(this.codecTiers=yb(E,M,e,i)),j=gb(O,N,t,P,B),{codecSet:X,videoRanges:rt,minFramerate:ct,minBitrate:k,minIndex:U,preferHDR:it}=j;K=U,C=X,N=it?rt[rt.length-1]:rt[0],w=ct,t=Math.max(t,k),this.log(`picked start tier ${Zt(j)}`)}else C=b?.codecSet,N=b?.videoRange;const tt=v?v.duration:g?g.duration:0,H=this.bwEstimator.getEstimateTTFB()/1e3,G=[];for(let O=i;O>=e;O--){var Y;const j=E[O],X=O>p;if(!j)continue;if(A.useMediaCapabilities&&!j.supportedResult&&!j.supportedPromise){const ft=navigator.mediaCapabilities;typeof ft?.decodingInfo=="function"&&ab(j,M,N,w,t,P)?(j.supportedPromise=Zy(j,M,ft,this.supportedCache),j.supportedPromise.then(dt=>{if(!this.hls)return;j.supportedResult=dt;const St=this.hls.levels,Dt=St.indexOf(j);dt.error?this.warn(`MediaCapabilities decodingInfo error: "${dt.error}" for level ${Dt} ${Zt(dt)}`):dt.supported?dt.decodingInfoResults.some(It=>It.smooth===!1||It.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Dt} not smooth or powerEfficient: ${Zt(dt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Dt} ${Zt(dt)}`),Dt>-1&&St.length>1&&(this.log(`Removing unsupported level ${Dt}`),this.hls.removeLevel(Dt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(dt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${dt}`)})):j.supportedResult=Qy}if((C&&j.codecSet!==C||N&&j.videoRange!==N||X&&w>j.frameRate||!X&&w>0&&w<j.frameRate||(Y=j.supportedResult)!=null&&(Y=Y.decodingInfoResults)!=null&&Y.some(ft=>ft.smooth===!1))&&(!I||O!==K)){G.push(O);continue}const rt=j.details,ct=(v?rt?.partTarget:rt?.averagetargetduration)||tt;let k;X?k=c*t:k=o*t;const U=tt&&n>=tt*2&&a===0?j.averageBitrate:j.maxBitrate,it=this.getTimeToLoadFrag(H,k,U*ct,rt===void 0);if(k>=U&&(O===m||j.loadError===0&&j.fragmentError===0)&&(it<=H||!ht(it)||_&&!this.bitrateTestDelay||it<f)){const ft=this.forcedAutoLevel;return O!==T&&(ft===-1||ft!==T)&&(G.length&&this.trace(`Skipped level(s) ${G.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${E[G[0]].codecs}" ${E[G[0]].videoRange}; not compatible with "${C}" ${N}`),this.info(`switch candidate:${p}->${O} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-U)} ttfb:${H.toFixed(1)} avgDuration:${ct.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${it.toFixed(1)} firstSelection:${I} codecSet:${j.codecSet} videoRange:${j.videoRange} hls.loadLevel:${T}`)),I&&(this.firstSelection=O),O}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}}const ev={search:function(l,t){let e=0,i=l.length-1,n=null,a=null;for(;e<=i;){n=(e+i)/2|0,a=l[n];const o=t(a);if(o>0)e=n+1;else if(o<0)i=n-1;else return a}return null}};function xb(l,t,e){if(t===null||!Array.isArray(l)||!l.length||!ht(t))return null;const i=l[0].programDateTime;if(t<(i||0))return null;const n=l[l.length-1].endProgramDateTime;if(t>=(n||0))return null;for(let a=0;a<l.length;++a){const o=l[a];if(Ab(t,e,o))return o}return null}function _n(l,t,e=0,i=0,n=.005){let a=null;if(l){a=t[1+l.sn-t[0].sn]||null;const c=l.endDTS-e;c>0&&c<15e-7&&(e+=15e-7),a&&l.level!==a.level&&a.end<=l.end&&(a=t[2+l.sn-t[0].sn]||null)}else e===0&&t[0].start===0&&(a=t[0]);if(a&&((!l||l.level===a.level)&&p0(e,i,a)===0||bb(a,l,Math.min(n,i))))return a;const o=ev.search(t,p0.bind(null,e,i));return o&&(o!==l||!a)?o:a}function bb(l,t,e){if(t&&t.start===0&&t.level<l.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((n,a)=>(a[0]==="INF"&&(n+=parseFloat(a[1])),n),e);return l.start<=i}return!1}function p0(l=0,t=0,e){if(e.start<=l&&e.start+e.duration>l)return 0;const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-i<=l?1:e.start-i>l&&e.start?-1:0}function Ab(l,t,e){const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0))*1e3;return(e.endProgramDateTime||0)-i>l}function iv(l,t,e){if(l&&l.startCC<=t&&l.endCC>=t){let i=l.fragments;const{fragmentHint:n}=l;n&&(i=i.concat(n));let a;return ev.search(i,o=>o.cc<t?1:o.cc>t?-1:(a=o,o.end<=e?1:o.start>e?-1:0)),a||null}return null}function Bo(l){switch(l.details){case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_TIMEOUT:case q.LEVEL_LOAD_TIMEOUT:case q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function sv(l){return l.details.startsWith("key")}function nv(l){return sv(l)&&!!l.frag&&!l.frag.decryptdata}function g0(l,t){const e=Bo(t);return l.default[`${e?"timeout":"error"}Retry`]}function bd(l,t){const e=l.backoff==="linear"?1:Math.pow(2,t);return Math.min(e*l.retryDelayMs,l.maxRetryDelayMs)}function y0(l){return zt(zt({},l),{errorRetry:null,timeoutRetry:null})}function Fo(l,t,e,i){if(!l)return!1;const n=i?.code,a=t<l.maxNumRetry&&(Lb(n)||!!e);return l.shouldRetry?l.shouldRetry(l,t,e,i,a):a}function Lb(l){return Wf(l)||!!l&&(l<400||l>499)}function Wf(l){return l===0&&navigator.onLine===!1}var Pe={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},ci={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class Rb extends Ri{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(R.ERROR,this.onError,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(R.ERROR,this.onError,this),t.off(R.ERROR,this.onErrorOut,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return t?.type===mt.MAIN?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,i=e.currentLevel;return(t=e.loadLevelObj)!=null&&t.details||i===-1?e.loadLevel:i}variantHasKey(t,e){if(t){var i;if((i=t.details)!=null&&i.hasKey(e))return!0;const n=t.audioGroups;if(n)return this.hls.allAudioTracks.filter(o=>n.indexOf(o.groupId)>=0).some(o=>{var c;return(c=o.details)==null?void 0:c.hasKey(e)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;const n=this.hls,a=e.context;switch(e.details){case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:e.errorAction=this.getFragRetryOrSwitchAction(e);return;case q.FRAG_PARSING_ERROR:if((i=e.frag)!=null&&i.gap){e.errorAction=br();return}case q.FRAG_GAP:case q.FRAG_DECRYPT_ERROR:{e.errorAction=this.getFragRetryOrSwitchAction(e),e.errorAction.action=Pe.SendAlternateToPenaltyBox;return}case q.LEVEL_EMPTY_ERROR:case q.LEVEL_PARSING_ERROR:{var o;const d=e.parent===mt.MAIN?e.level:n.loadLevel;e.details===q.LEVEL_EMPTY_ERROR&&((o=e.context)!=null&&(o=o.levelDetails)!=null&&o.live)?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,d):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,d))}return;case q.LEVEL_LOAD_ERROR:case q.LEVEL_LOAD_TIMEOUT:typeof a?.level=="number"&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,a.level));return;case q.AUDIO_TRACK_LOAD_ERROR:case q.AUDIO_TRACK_LOAD_TIMEOUT:case q.SUBTITLE_LOAD_ERROR:case q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const d=n.loadLevelObj;if(d&&(a.type===wt.AUDIO_TRACK&&d.hasAudioGroup(a.groupId)||a.type===wt.SUBTITLE_TRACK&&d.hasSubtitleGroup(a.groupId))){e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.loadLevel),e.errorAction.action=Pe.SendAlternateToPenaltyBox,e.errorAction.flags=ci.MoveAllAlternatesMatchingHost;return}}return;case q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:e.errorAction={action:Pe.SendAlternateToPenaltyBox,flags:ci.MoveAllAlternatesMatchingHDCP};return;case q.KEY_SYSTEM_SESSION_UPDATE_FAILED:case q.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case q.KEY_SYSTEM_NO_SESSION:e.errorAction={action:Pe.SendAlternateToPenaltyBox,flags:ci.MoveAllAlternatesMatchingKey};return;case q.BUFFER_ADD_CODEC_ERROR:case q.REMUX_ALLOC_ERROR:case q.BUFFER_APPEND_ERROR:if(!e.errorAction){var c;e.errorAction=this.getLevelSwitchAction(e,(c=e.level)!=null?c:n.loadLevel)}return;case q.INTERNAL_EXCEPTION:case q.BUFFER_APPENDING_ERROR:case q.BUFFER_FULL_ERROR:case q.LEVEL_SWITCH_ERROR:case q.BUFFER_STALLED_ERROR:case q.BUFFER_SEEK_OVER_HOLE:case q.BUFFER_NUDGE_ON_STALL:e.errorAction=br();return}e.type===vt.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=br())}getPlaylistRetryOrSwitchAction(t,e){const i=this.hls,n=g0(i.config.playlistLoadPolicy,t),a=this.playlistError++;if(Fo(n,a,Bo(t),t.response))return{action:Pe.RetryRequest,flags:ci.None,retryConfig:n,retryCount:a};const c=this.getLevelSwitchAction(t,e);return n&&(c.retryConfig=n,c.retryCount=a),c}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),n=e.levels[i],{fragLoadPolicy:a,keyLoadPolicy:o}=e.config,c=g0(sv(t)?o:a,t),d=e.levels.reduce((m,p)=>m+p.fragmentError,0);if(n&&(t.details!==q.FRAG_GAP&&n.fragmentError++,!nv(t)&&Fo(c,d,Bo(t),t.response)))return{action:Pe.RetryRequest,flags:ci.None,retryConfig:c,retryCount:d};const f=this.getLevelSwitchAction(t,i);return c&&(f.retryConfig=c,f.retryCount=d),f}getLevelSwitchAction(t,e){const i=this.hls;e==null&&(e=i.loadLevel);const n=this.hls.levels[e];if(n){var a,o;const f=t.details;n.loadError++,f===q.BUFFER_APPEND_ERROR&&n.fragmentError++;let m=-1;const{levels:p,loadLevel:g,minAutoLevel:v,maxAutoLevel:E}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const x=(a=t.frag)==null?void 0:a.type,A=(x===mt.AUDIO&&f===q.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(f===q.BUFFER_ADD_CODEC_ERROR||f===q.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:N})=>n.audioCodec!==N),_=t.sourceBufferName==="video"&&(f===q.BUFFER_ADD_CODEC_ERROR||f===q.BUFFER_APPEND_ERROR)&&p.some(({codecSet:N,audioCodec:w})=>n.codecSet!==N&&n.audioCodec===w),{type:I,groupId:C}=(o=t.context)!=null?o:{};for(let N=p.length;N--;){const w=(N+g)%p.length;if(w!==g&&w>=v&&w<=E&&p[w].loadError===0){var c,d;const P=p[w];if(f===q.FRAG_GAP&&x===mt.MAIN&&t.frag){const B=p[w].details;if(B){const M=_n(t.frag,B.fragments,t.frag.start);if(M!=null&&M.gap)continue}}else{if(I===wt.AUDIO_TRACK&&P.hasAudioGroup(C)||I===wt.SUBTITLE_TRACK&&P.hasSubtitleGroup(C))continue;if(x===mt.AUDIO&&(c=n.audioGroups)!=null&&c.some(B=>P.hasAudioGroup(B))||x===mt.SUBTITLE&&(d=n.subtitleGroups)!=null&&d.some(B=>P.hasSubtitleGroup(B))||A&&n.audioCodec===P.audioCodec||_&&n.codecSet===P.codecSet||!A&&n.codecSet!==P.codecSet)continue}m=w;break}}if(m>-1&&i.loadLevel!==m)return t.levelRetry=!0,this.playlistError=0,{action:Pe.SendAlternateToPenaltyBox,flags:ci.None,nextAutoLevel:m}}return{action:Pe.SendAlternateToPenaltyBox,flags:ci.MoveAllAlternatesMatchingHost}}onErrorOut(t,e){var i;switch((i=e.errorAction)==null?void 0:i.action){case Pe.DoNothing:break;case Pe.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(e),!e.errorAction.resolved&&e.details!==q.FRAG_GAP?e.fatal=!0:/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(e.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:n}=i,a=i.nextAutoLevel;switch(n){case ci.None:this.switchLevel(t,a);break;case ci.MoveAllAlternatesMatchingHDCP:{const d=this.getVariantLevelIndex(t.frag),f=e.levels[d],m=f?.attrs["HDCP-LEVEL"];if(i.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){e.maxHdcpLevel=Qf[Qf.indexOf(m)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}}case ci.MoveAllAlternatesMatchingKey:{const d=t.decryptdata;if(d){const f=this.hls.levels,m=f.length;for(let g=m;g--;)if(this.variantHasKey(f[g],d)){var o,c;this.log(`Banned key found in level ${g} (${f[g].bitrate}bps) or audio group "${(o=f[g].audioGroups)==null?void 0:o.join(",")}" (${(c=t.frag)==null?void 0:c.type} fragment) ${ze(d.keyId||[])}`),f[g].fragmentError++,f[g].loadError++,this.log(`Removing level ${g} with key error (${t.error})`),this.hls.removeLevel(g)}const p=t.frag;if(this.hls.levels.length<m)i.resolved=!0;else if(p&&p.type!==mt.MAIN){const g=p.decryptdata;g&&!d.matches(g)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(t,a)}switchLevel(t,e){if(e!==void 0&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===q.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&t.sourceBufferName!=="audiovideo")){const i=Xf(t.mimeType),n=this.hls.levels;for(let a=n.length;a--;)n[a][`${t.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${a} for ${t.details} ("${i}" not supported)`),this.hls.removeLevel(a))}}}function br(l){const t={action:Pe.DoNothing,flags:ci.None};return l&&(t.resolved=!0),t}var Ae={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class _b{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.BUFFER_APPENDED,this.onBufferAppended,this),t.on(R.FRAG_BUFFERED,this.onFragBuffered,this),t.on(R.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.BUFFER_APPENDED,this.onBufferAppended,this),t.off(R.FRAG_BUFFERED,this.onFragBuffered,this),t.off(R.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let n=i.length;n--;){const a=i[n];if(!a)break;if(a.start<=t&&t<=a.end&&a.loaded)return a}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){const{fragments:n}=this,a=Object.keys(n);for(let o=a.length;o--;){const c=n[a[o]];if(c?.body.type===e&&(!i||c.buffered)){const d=c.body;if(d.start<=t&&t<=d.end)return d}}return null}detectEvictedFragments(t,e,i,n,a){this.timeRanges&&(this.timeRanges[t]=e);const o=n?.fragment.sn||-1;Object.keys(this.fragments).forEach(c=>{const d=this.fragments[c];if(!d||o>=d.body.sn)return;if(!d.buffered&&(!d.loaded||a)){d.body.type===i&&this.removeFragment(d.body);return}const f=d.range[t];if(f){if(f.time.length===0){this.removeFragment(d.body);return}f.time.some(m=>{const p=!this.isTimeBuffered(m.startPTS,m.endPTS,e);return p&&this.removeFragment(d.body),p})}})}detectPartialFragments(t){const e=this.timeRanges;if(!e||t.frag.sn==="initSegment")return;const i=t.frag,n=yr(i),a=this.fragments[n];if(!a||a.buffered&&i.gap)return;const o=!i.relurl;Object.keys(e).forEach(c=>{const d=i.elementaryStreams[c];if(!d)return;const f=e[c],m=o||d.partial===!0;a.range[c]=this.getBufferedTimes(i,t.part,m,f)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),lo(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=v0(i,n=>n.fragment.sn>=t))}fragBuffered(t,e){const i=yr(t);let n=this.fragments[i];!n&&e&&(n=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(t,e,i,n){const a={time:[],partial:i},o=t.start,c=t.end,d=t.minEndPTS||c,f=t.maxStartPTS||o;for(let m=0;m<n.length;m++){const p=n.start(m)-this.bufferPadding,g=n.end(m)+this.bufferPadding;if(f>=p&&d<=g){a.time.push({startPTS:Math.max(o,n.start(m)),endPTS:Math.min(c,n.end(m))});break}else if(o<g&&c>p){const v=Math.max(o,n.start(m)),E=Math.min(c,n.end(m));E>v&&(a.partial=!0,a.time.push({startPTS:v,endPTS:E}))}else if(c<=p)break}return a}getPartialFragment(t){let e=null,i,n,a,o=0;const{bufferPadding:c,fragments:d}=this;return Object.keys(d).forEach(f=>{const m=d[f];m&&lo(m)&&(n=m.body.start-c,a=m.body.end+c,t>=n&&t<=a&&(i=Math.min(t-n,a-t),o<=i&&(e=m.body,o=i)))}),e}isEndListAppended(t){const e=this.endListFragments[t];return e!==void 0&&(e.buffered||lo(e))}getState(t){const e=yr(t),i=this.fragments[e];return i?i.buffered?lo(i)?Ae.PARTIAL:Ae.OK:Ae.APPENDING:Ae.NOT_LOADED}isTimeBuffered(t,e,i){let n,a;for(let o=0;o<i.length;o++){if(n=i.start(o)-this.bufferPadding,a=i.end(o)+this.bufferPadding,t>=n&&e<=a)return!0;if(e<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if(e.frag.sn==="initSegment"||e.frag.bitrateTest)return;const i=e.frag,n=e.part?null:e,a=yr(i);this.fragments[a]={body:i,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:n,timeRanges:a,type:o}=e;if(i.sn==="initSegment")return;const c=i.type;if(n){let f=this.activePartLists[c];f||(this.activePartLists[c]=f=[]),f.push(n)}this.timeRanges=a;const d=a[o];this.detectEvictedFragments(o,d,c,n)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=yr(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let n=i.length;n--;){const a=e[i[n]];if(a?.body.type===t)return!0}return!1}hasParts(t){var e;return!!((e=this.activePartLists[t])!=null&&e.length)}removeFragmentsInRange(t,e,i,n,a){n&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c)return;const d=c.body;d.type!==i||n&&!d.gap||d.start<e&&d.end>t&&(c.buffered||a)&&this.removeFragment(d)})}removeFragment(t){const e=yr(t);t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const n=t.sn;this.activePartLists[t.type]=v0(i,a=>a.fragment.sn!==n)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=(t=this.hls)==null||(t=t.latestLevelDetails)==null?void 0:t.partList;e&&e.forEach(i=>i.clearElementaryStreamInfo())}}function lo(l){var t,e,i;return l.buffered&&!!(l.body.gap||(t=l.range.video)!=null&&t.partial||(e=l.range.audio)!=null&&e.partial||(i=l.range.audiovideo)!=null&&i.partial)}function yr(l){return`${l.type}_${l.level}_${l.sn}`}function v0(l,t){return l.filter(e=>{const i=t(e);return i||e.clearElementaryStreamInfo(),i})}var Zs={cbc:0,ctr:1};class Ib{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case Zs.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case Zs.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function Db(l){const t=l.byteLength,e=t&&new DataView(l.buffer).getUint8(t-1);return e?l.slice(0,t-e):l}class Cb{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let n=0;n<4;n++)i[n]=e.getUint32(n*4);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,n=i[0],a=i[1],o=i[2],c=i[3],d=this.invSubMix,f=d[0],m=d[1],p=d[2],g=d[3],v=new Uint32Array(256);let E=0,x=0,T=0;for(T=0;T<256;T++)T<128?v[T]=T<<1:v[T]=T<<1^283;for(T=0;T<256;T++){let A=x^x<<1^x<<2^x<<3^x<<4;A=A>>>8^A&255^99,t[E]=A,e[A]=E;const b=v[E],_=v[b],I=v[_];let C=v[A]*257^A*16843008;n[E]=C<<24|C>>>8,a[E]=C<<16|C>>>16,o[E]=C<<8|C>>>24,c[E]=C,C=I*16843009^_*65537^b*257^E*16843008,f[A]=C<<24|C>>>8,m[A]=C<<16|C>>>16,p[A]=C<<8|C>>>24,g[A]=C,E?(E=b^v[v[v[I^b]]],x^=v[v[x]]):E=x=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,n=0;for(;n<e.length&&i;)i=e[n]===this.key[n],n++;if(i)return;this.key=e;const a=this.keySize=e.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const o=this.ksRows=(a+6+1)*4;let c,d;const f=this.keySchedule=new Uint32Array(o),m=this.invKeySchedule=new Uint32Array(o),p=this.sBox,g=this.rcon,v=this.invSubMix,E=v[0],x=v[1],T=v[2],A=v[3];let b,_;for(c=0;c<o;c++){if(c<a){b=f[c]=e[c];continue}_=b,c%a===0?(_=_<<8|_>>>24,_=p[_>>>24]<<24|p[_>>>16&255]<<16|p[_>>>8&255]<<8|p[_&255],_^=g[c/a|0]<<24):a>6&&c%a===4&&(_=p[_>>>24]<<24|p[_>>>16&255]<<16|p[_>>>8&255]<<8|p[_&255]),f[c]=b=(f[c-a]^_)>>>0}for(d=0;d<o;d++)c=o-d,d&3?_=f[c]:_=f[c-4],d<4||c<=4?m[d]=_:m[d]=E[p[_>>>24]]^x[p[_>>>16&255]]^T[p[_>>>8&255]]^A[p[_&255]],m[d]=m[d]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,e,i){const n=this.keySize+6,a=this.invKeySchedule,o=this.invSBox,c=this.invSubMix,d=c[0],f=c[1],m=c[2],p=c[3],g=this.uint8ArrayToUint32Array_(i);let v=g[0],E=g[1],x=g[2],T=g[3];const A=new Int32Array(t),b=new Int32Array(A.length);let _,I,C,N,w,P,B,M,K,tt,H,G,Y,O;const j=this.networkToHostOrderSwap;for(;e<A.length;){for(K=j(A[e]),tt=j(A[e+1]),H=j(A[e+2]),G=j(A[e+3]),w=K^a[0],P=G^a[1],B=H^a[2],M=tt^a[3],Y=4,O=1;O<n;O++)_=d[w>>>24]^f[P>>16&255]^m[B>>8&255]^p[M&255]^a[Y],I=d[P>>>24]^f[B>>16&255]^m[M>>8&255]^p[w&255]^a[Y+1],C=d[B>>>24]^f[M>>16&255]^m[w>>8&255]^p[P&255]^a[Y+2],N=d[M>>>24]^f[w>>16&255]^m[P>>8&255]^p[B&255]^a[Y+3],w=_,P=I,B=C,M=N,Y=Y+4;_=o[w>>>24]<<24^o[P>>16&255]<<16^o[B>>8&255]<<8^o[M&255]^a[Y],I=o[P>>>24]<<24^o[B>>16&255]<<16^o[M>>8&255]<<8^o[w&255]^a[Y+1],C=o[B>>>24]<<24^o[M>>16&255]<<16^o[w>>8&255]<<8^o[P&255]^a[Y+2],N=o[M>>>24]<<24^o[w>>16&255]<<16^o[P>>8&255]<<8^o[B&255]^a[Y+3],b[e]=j(_^v),b[e+1]=j(N^E),b[e+2]=j(C^x),b[e+3]=j(I^T),v=K,E=tt,x=H,T=G,e=e+4}return b.buffer}}class wb{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){const t=kb(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}function kb(l){switch(l){case Zs.cbc:return"AES-CBC";case Zs.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${l}`)}}const Ob=16;class Ad{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?Db(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,n){return this.useSoftware?new Promise((a,o)=>{const c=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(c,e,i,n);const d=this.flush();d?a(d.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,n)}softwareDecrypt(t,e,i,n){const{currentIV:a,currentResult:o,remainderData:c}=this;if(n!==Zs.cbc||e.byteLength!==16)return Vt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),c&&(t=Li(c,t),this.remainderData=null);const d=this.getValidChunk(t);if(!d.length)return null;a&&(i=a);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new Cb),f.expandKey(e);const m=o;return this.currentResult=f.decrypt(d.buffer,0,i),this.currentIV=d.slice(-16).buffer,m||null}webCryptoDecrypt(t,e,i,n){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,n));this.key=e,this.fastAesKey=new wb(this.subtle,e,n)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Ib(this.subtle,new Uint8Array(i),n).decrypt(t.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Vt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(t,e,i,n)))}onWebCryptoError(t,e,i,n){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,n);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%Ob;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){this.logEnabled&&(Vt.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const E0=Math.pow(2,17);class Mb{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new ys({type:vt.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,a=n.fLoader,o=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(E=>E[0]==="GAP")){d(T0(t));return}else t.gap=!1;const f=this.loader=a?new a(n):new o(n),m=S0(t);t.loader=f;const p=y0(n.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:E0};t.stats=f.stats;const v={onSuccess:(E,x,T,A)=>{this.resetLoader(t,f);let b=E.data;T.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(b.slice(0,16)),b=b.slice(16)),c({frag:t,part:null,payload:b,networkDetails:A})},onError:(E,x,T,A)=>{this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:zt({url:i,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:T,stats:A}))},onAbort:(E,x,T)=>{this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:T,stats:E}))},onTimeout:(E,x,T)=>{this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:T,stats:E}))}};e&&(v.onProgress=(E,x,T,A)=>e({frag:t,part:null,payload:T,networkDetails:A})),f.load(m,g,v)})}loadPart(t,e,i){this.abort();const n=this.config,a=n.fLoader,o=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap){d(T0(t,e));return}const f=this.loader=a?new a(n):new o(n),m=S0(t,e);t.loader=f;const p=y0(n.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:E0};e.stats=f.stats,f.load(m,g,{onSuccess:(v,E,x,T)=>{this.resetLoader(t,f),this.updateStatsFromPart(t,e);const A={frag:t,part:e,payload:v.data,networkDetails:T};i(A),c(A)},onError:(v,E,x,T)=>{this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:zt({url:m.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:x,stats:T}))},onAbort:(v,E,x)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:x,stats:v}))},onTimeout:(v,E,x)=>{this.resetLoader(t,f),d(new ys({type:vt.NETWORK_ERROR,details:q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:x,stats:v}))}})})}updateStatsFromPart(t,e){const i=t.stats,n=e.stats,a=n.total;if(i.loaded+=n.loaded,a){const d=Math.round(t.duration/e.duration),f=Math.min(Math.round(i.loaded/a),d),p=(d-f)*Math.round(i.loaded/f);i.total=i.loaded+p}else i.total=Math.max(i.loaded,i.total);const o=i.loading,c=n.loading;o.start?o.first+=c.first-c.start:(o.start=c.start,o.first=c.first),o.end=c.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function S0(l,t=null){const e=t||l,i={frag:l,part:t,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},n=e.byteRangeStartOffset,a=e.byteRangeEndOffset;if(ht(n)&&ht(a)){var o;let c=n,d=a;if(l.sn==="initSegment"&&Pb((o=l.decryptdata)==null?void 0:o.method)){const f=a-n;f%16&&(d=a+(16-f%16)),n!==0&&(i.resetIV=!0,c=n-16)}i.rangeStart=c,i.rangeEnd=d}return i}function T0(l,t){const e=new Error(`GAP ${l.gap?"tag":"attribute"} found`),i={type:vt.MEDIA_ERROR,details:q.FRAG_GAP,fatal:!1,frag:l,error:e,networkDetails:null};return t&&(i.part=t),(t||l).stats.aborted=!0,new ys(i)}function Pb(l){return l==="AES-128"||l==="AES-256"}class ys extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class rv extends Ri{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Ld{constructor(t,e,i,n=0,a=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=oo(),this.buffering={audio:oo(),video:oo(),audiovideo:oo()},this.level=t,this.sn=e,this.id=i,this.size=n,this.part=a,this.partial=o}}function oo(){return{start:0,executeStart:0,executeEnd:0,end:0}}const x0={length:0,start:()=>0,end:()=>0};class At{static isBuffered(t,e){if(t){const i=At.getBuffered(t);for(let n=i.length;n--;)if(e>=i.start(n)&&e<=i.end(n))return!0}return!1}static bufferedRanges(t){if(t){const e=At.getBuffered(t);return At.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){const n=At.bufferedRanges(t);if(n.length)return At.bufferedInfo(n,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort((m,p)=>m.start-p.start||p.end-m.end);let n=-1,a=[];if(i)for(let m=0;m<t.length;m++){e>=t[m].start&&e<=t[m].end&&(n=m);const p=a.length;if(p){const g=a[p-1].end;t[m].start-g<i?t[m].end>g&&(a[p-1].end=t[m].end):a.push(t[m])}else a.push(t[m])}else a=t;let o=0,c,d=e,f=e;for(let m=0;m<a.length;m++){const p=a[m].start,g=a[m].end;if(n===-1&&e>=p&&e<=g&&(n=m),e+i>=p&&e<g)d=p,f=g,o=f-e;else if(e+i<p){c=p;break}}return{len:o,start:d||0,end:f||0,nextStart:c,buffered:t,bufferedIndex:n}}static getBuffered(t){try{return t.buffered||x0}catch(e){return Vt.log("failed to get media.buffered",e),x0}}}const av=/\{\$([a-zA-Z0-9-_]+)\}/g;function b0(l){return av.test(l)}function Zf(l,t){if(l.variableList!==null||l.hasVariableRefs){const e=l.variableList;return t.replace(av,i=>{const n=i.substring(2,i.length-1),a=e?.[n];return a===void 0?(l.playlistParsingError||(l.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),i):a})}return t}function A0(l,t,e){let i=l.variableList;i||(l.variableList=i={});let n,a;if("QUERYPARAM"in t){n=t.QUERYPARAM;try{const o=new self.URL(e).searchParams;if(o.has(n))a=o.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${e}"`)}catch(o){l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else n=t.NAME,a=t.VALUE;n in i?l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):i[n]=a||""}function Nb(l,t,e){const i=t.IMPORT;if(e&&i in e){let n=l.variableList;n||(l.variableList=n={}),n[i]=e[i]}else l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const Bb=/^(\d+)x(\d+)$/,L0=/(.+?)=(".*?"|.*?)(?:,|$)/g;class se{constructor(t,e){typeof t=="string"&&(t=se.parseAttrList(t,e)),Xt(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(e.length&1?"0":"")+e;const i=new Uint8Array(e.length/2);for(let n=0;n<e.length/2;n++)i[n]=parseInt(e.slice(n*2,n*2+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const i=this[t];return(i?i.split(/[ ,]+/):[]).reduce((n,a)=>(n[a.toLowerCase()]=!0,n),e)}bool(t){return this[t]==="YES"}decimalResolution(t){const e=Bb.exec(this[t]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i;const n={};for(L0.lastIndex=0;(i=L0.exec(t))!==null;){const o=i[1].trim();let c=i[2];const d=c.indexOf('"')===0&&c.lastIndexOf('"')===c.length-1;let f=!1;if(d)c=c.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":f=!0}if(e&&(d||f))c=Zf(e,c);else if(!f&&!d)switch(o){case"CLOSED-CAPTIONS":if(c==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Vt.warn(`${t}: attribute ${o} is missing quotes`)}n[o]=c}return n}}const Fb="com.apple.hls.interstitial";function Ub(l){return l!=="ID"&&l!=="CLASS"&&l!=="CUE"&&l!=="START-DATE"&&l!=="DURATION"&&l!=="END-DATE"&&l!=="END-ON-NEXT"}function $b(l){return l==="SCTE35-OUT"||l==="SCTE35-IN"||l==="SCTE35-CMD"}class lv{constructor(t,e,i=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=e?.tagAnchor||null,this.tagOrder=(n=e?.tagOrder)!=null?n:i,e){const a=e.attr;for(const o in a)if(Object.prototype.hasOwnProperty.call(t,o)&&t[o]!==a[o]){Vt.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=o;break}t=Xt(new se({}),a,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=e?.endDate||new Date(this.attr["END-DATE"]);ht(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return t===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return t===null||t.programDateTime===null?(Vt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return e!==null?this._dateAtEnd=new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(ht(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===Fb}get isValid(){return!!this.id&&!this._badValueForSameId&&ht(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const jb=10;class Gb{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||e===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1}hasKey(t){return this.encryptedFragments.some(e=>{let i=e.decryptdata;return i||(e.setKeyFormat(t.keyFormat),i=e.decryptdata),!!i&&t.matches(i)})}get hasProgramDateTime(){return this.fragments.length?ht(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||jb}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(e!==-1){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function Uo(l,t){return l.length===t.length?!l.some((e,i)=>e!==t[i]):!1}function R0(l,t){return!l&&!t?!0:!l||!t?!1:Uo(l,t)}function Ar(l){return l==="AES-128"||l==="AES-256"||l==="AES-256-CTR"}function Rd(l){switch(l){case"AES-128":case"AES-256":return Zs.cbc;case"AES-256-CTR":return Zs.ctr;default:throw new Error(`invalid full segment method ${l}`)}}function _d(l){return Uint8Array.from(atob(l),t=>t.charCodeAt(0))}function Jf(l){return Uint8Array.from(unescape(encodeURIComponent(l)),t=>t.charCodeAt(0))}function Hb(l){const t=Jf(l).subarray(0,16),e=new Uint8Array(16);return e.set(t,16-t.length),e}function ov(l){const t=function(i,n,a){const o=i[n];i[n]=i[a],i[a]=o};t(l,0,3),t(l,1,2),t(l,4,5),t(l,6,7)}function uv(l){const t=l.split(":");let e=null;if(t[0]==="data"&&t.length===2){const i=t[1].split(";"),n=i[i.length-1].split(",");if(n.length===2){const a=n[0]==="base64",o=n[1];a?(i.splice(-1,1),e=_d(o)):e=Hb(o)}}return e}const $o=typeof self<"u"?self:void 0;var ne={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ne={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Ro(l){switch(l){case Ne.FAIRPLAY:return ne.FAIRPLAY;case Ne.PLAYREADY:return ne.PLAYREADY;case Ne.WIDEVINE:return ne.WIDEVINE;case Ne.CLEARKEY:return ne.CLEARKEY}}function Af(l){switch(l){case ne.FAIRPLAY:return Ne.FAIRPLAY;case ne.PLAYREADY:return Ne.PLAYREADY;case ne.WIDEVINE:return Ne.WIDEVINE;case ne.CLEARKEY:return Ne.CLEARKEY}}function _a(l){const{drmSystems:t,widevineLicenseUrl:e}=l,i=t?[ne.FAIRPLAY,ne.WIDEVINE,ne.PLAYREADY,ne.CLEARKEY].filter(n=>!!t[n]):[];return!i[ne.WIDEVINE]&&e&&i.push(ne.WIDEVINE),i}const cv=(function(l){return $o!=null&&(l=$o.navigator)!=null&&l.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function zb(l,t,e,i){let n;switch(l){case ne.FAIRPLAY:n=["cenc","sinf"];break;case ne.WIDEVINE:case ne.PLAYREADY:n=["cenc"];break;case ne.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${l}`)}return Vb(n,t,e,i)}function Vb(l,t,e,i){return[{initDataTypes:l,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:e.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function Kb(l){var t;return!!l&&(l.sessionType==="persistent-license"||!!((t=l.sessionTypes)!=null&&t.some(e=>e==="persistent-license")))}function fv(l){const t=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/2),e=String.fromCharCode.apply(null,Array.from(t)),i=e.substring(e.indexOf("<"),e.length),o=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const c=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(c){const d=_d(c).subarray(0,16);return ov(d),d}}return null}let uo={};class Rn{static clearKeyUriToKeyIdMap(){uo={}}static setKeyIdForUri(t,e){uo[t]=e}constructor(t,e,i,n=[1],a=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=n,this.iv=a,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ar(t),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(Uy(o)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&Uo(t.keyFormatVersions,this.keyFormatVersions)&&R0(t.iv,this.iv)&&R0(t.keyId,this.keyId)}isSupported(){if(this.method){if(Ar(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ne.FAIRPLAY:case Ne.WIDEVINE:case Ne.PLAYREADY:case Ne.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t,e){if(!this.encrypted||!this.uri)return null;if(Ar(this.method)){let a=this.iv;return a||(typeof t!="number"&&(Vt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0),a=Yb(t)),new Rn(this.method,this.uri,"identity",this.keyFormatVersions,a)}if(this.keyId){const a=uo[this.uri];if(a&&!Uo(this.keyId,a)&&Rn.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=uv(this.uri);if(i)switch(this.keyFormat){case Ne.WIDEVINE:if(this.pssh=i,!this.keyId){const a=W1(i.buffer);if(a.length){var n;const o=a[0];this.keyId=(n=o.kids)!=null&&n.length?o.kids[0]:null}}this.keyId||(this.keyId=_0(e));break;case Ne.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Q1(a,null,i),this.keyId=fv(i);break}default:{let a=i.subarray(0,16);if(a.length!==16){const o=new Uint8Array(16);o.set(a,16-a.length),a=o}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a;a=qb(e),a||(a=_0(e),a||(a=uo[this.uri])),a&&(this.keyId=a,Rn.setKeyIdForUri(this.uri,a))}return this}}function qb(l){const t=l?.[Ne.WIDEVINE];return t?t.keyId:null}function _0(l){const t=l?.[Ne.PLAYREADY];if(t){const e=uv(t.uri);if(e)return fv(e)}return null}function Yb(l){const t=new Uint8Array(16);for(let e=12;e<16;e++)t[e]=l>>8*(15-e)&255;return t}const I0=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,D0=/#EXT-X-MEDIA:(.*)/g,Xb=/^#EXT(?:INF|-X-TARGETDURATION):/m,Lf=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Qb=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Hi{static findGroup(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n.id===e)return n}}static resolve(t,e){return vd.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return Xb.test(t)}static parseMasterPlaylist(t,e){const i=b0(t),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},a=[];if(I0.lastIndex=0,!t.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let o;for(;(o=I0.exec(t))!=null;)if(o[1]){var c;const f=new se(o[1],n),m=Zf(n,o[2]),p={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:Hi.resolve(m,e)},g=f.decimalResolution("RESOLUTION");g&&(p.width=g.width,p.height=g.height),k0(f.CODECS,p);const v=f["SUPPLEMENTAL-CODECS"];v&&(p.supplemental={},k0(v,p.supplemental)),(c=p.unknownCodecs)!=null&&c.length||a.push(p),n.levels.push(p)}else if(o[3]){const f=o[3],m=o[4];switch(f){case"SESSION-DATA":{const p=new se(m,n),g=p["DATA-ID"];g&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[g]=p);break}case"SESSION-KEY":{const p=C0(m,e,n);p.encrypted&&p.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(p)):Vt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const p=new se(m,n);A0(n,p,e)}break}case"CONTENT-STEERING":{const p=new se(m,n);n.contentSteering={uri:Hi.resolve(p["SERVER-URI"],e),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=w0(m);break}}}const d=a.length>0&&a.length<n.levels.length;return n.levels=d?a:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(t,e,i){let n;const a={},o=i.levels,c={AUDIO:o.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:o.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(D0.lastIndex=0;(n=D0.exec(t))!==null;){const f=new se(n[1],i),m=f.TYPE;if(m){const p=c[m],g=a[m]||[];a[m]=g;const v=f.LANGUAGE,E=f["ASSOC-LANGUAGE"],x=f.CHANNELS,T=f.CHARACTERISTICS,A=f["INSTREAM-ID"],b={attrs:f,bitrate:0,id:d++,groupId:f["GROUP-ID"]||"",name:f.NAME||v||"",type:m,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:v,url:f.URI?Hi.resolve(f.URI,e):""};if(E&&(b.assocLang=E),x&&(b.channels=x),T&&(b.characteristics=T),A&&(b.instreamId=A),p!=null&&p.length){const _=Hi.findGroup(p,b.groupId)||p[0];O0(b,_,"audioCodec"),O0(b,_,"textCodec")}g.push(b)}}return a}static parseLevelPlaylist(t,e,i,n,a,o){var c;const d={url:e},f=new Gb(e),m=f.fragments,p=[];let g=null,v=0,E=0,x=0,T=0,A=0,b=null,_=new Tf(n,d),I,C,N,w=-1,P=!1,B=null,M;if(Lf.lastIndex=0,f.m3u8=t,f.hasVariableRefs=b0(t),((c=Lf.exec(t))==null?void 0:c[0])!=="#EXTM3U")return f.playlistParsingError=new Error("Missing format identifier #EXTM3U"),f;for(;(I=Lf.exec(t))!==null;){P&&(P=!1,_=new Tf(n,d),_.playlistOffset=x,_.setStart(x),_.sn=v,_.cc=T,A&&(_.bitrate=A),_.level=i,g&&(_.initSegment=g,g.rawProgramDateTime&&(_.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),B&&(_.setByteRange(B),B=null)));const G=I[1];if(G){_.duration=parseFloat(G);const Y=(" "+I[2]).slice(1);_.title=Y||null,_.tagList.push(Y?["INF",G,Y]:["INF",G])}else if(I[3]){if(ht(_.duration)){_.playlistOffset=x,_.setStart(x),N&&P0(_,N,f),_.sn=v,_.level=i,_.cc=T,m.push(_);const Y=(" "+I[3]).slice(1);_.relurl=Zf(f,Y),td(_,b,p),b=_,x+=_.duration,v++,E=0,P=!0}}else{if(I=I[0].match(Qb),!I){Vt.warn("No matches on slow regex match for level playlist!");continue}for(C=1;C<I.length&&I[C]===void 0;C++);const Y=(" "+I[C]).slice(1),O=(" "+I[C+1]).slice(1),j=I[C+2]?(" "+I[C+2]).slice(1):null;switch(Y){case"BYTERANGE":b?_.setByteRange(O,b):_.setByteRange(O);break;case"PROGRAM-DATE-TIME":_.rawProgramDateTime=O,_.tagList.push(["PROGRAM-DATE-TIME",O]),w===-1&&(w=m.length);break;case"PLAYLIST-TYPE":f.type&&ps(f,Y,I),f.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":f.startSN!==0?ps(f,Y,I):m.length>0&&N0(f,Y,I),v=f.startSN=parseInt(O);break;case"SKIP":{f.skippedSegments&&ps(f,Y,I);const X=new se(O,f),rt=X.decimalInteger("SKIPPED-SEGMENTS");if(ht(rt)){f.skippedSegments+=rt;for(let k=rt;k--;)m.push(null);v+=rt}const ct=X.enumeratedString("RECENTLY-REMOVED-DATERANGES");ct&&(f.recentlyRemovedDateranges=(f.recentlyRemovedDateranges||[]).concat(ct.split("	")));break}case"TARGETDURATION":f.targetduration!==0&&ps(f,Y,I),f.targetduration=Math.max(parseInt(O),1);break;case"VERSION":f.version!==null&&ps(f,Y,I),f.version=parseInt(O);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":f.live||ps(f,Y,I),f.live=!1;break;case"#":(O||j)&&_.tagList.push(j?[O,j]:[O]);break;case"DISCONTINUITY":T++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([Y]);break;case"BITRATE":_.tagList.push([Y,O]),A=parseInt(O)*1e3,ht(A)?_.bitrate=A:A=0;break;case"DATERANGE":{const X=new se(O,f),rt=new lv(X,f.dateRanges[X.ID],f.dateRangeTagCount);f.dateRangeTagCount++,rt.isValid||f.skippedSegments?f.dateRanges[rt.id]=rt:Vt.warn(`Ignoring invalid DATERANGE tag: "${O}"`),_.tagList.push(["EXT-X-DATERANGE",O]);break}case"DEFINE":{{const X=new se(O,f);"IMPORT"in X?Nb(f,X,o):A0(f,X,e)}break}case"DISCONTINUITY-SEQUENCE":f.startCC!==0?ps(f,Y,I):m.length>0&&N0(f,Y,I),f.startCC=T=parseInt(O);break;case"KEY":{const X=C0(O,e,f);if(X.isSupported()){if(X.method==="NONE"){N=void 0;break}N||(N={});const rt=N[X.keyFormat];rt!=null&&rt.matches(X)||(rt&&(N=Xt({},N)),N[X.keyFormat]=X)}else Vt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${O}"`);break}case"START":f.startTimeOffset=w0(O);break;case"MAP":{const X=new se(O,f);if(_.duration){const rt=new Tf(n,d);M0(rt,X,i,N),g=rt,_.initSegment=g,g.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=g.rawProgramDateTime)}else{const rt=_.byteRangeEndOffset;if(rt){const ct=_.byteRangeStartOffset;B=`${rt-ct}@${ct}`}else B=null;M0(_,X,i,N),g=_,P=!0}g.cc=T;break}case"SERVER-CONTROL":{M&&ps(f,Y,I),M=new se(O),f.canBlockReload=M.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=M.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&M.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=M.optionalFloat("PART-HOLD-BACK",0),f.holdBack=M.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{f.partTarget&&ps(f,Y,I);const X=new se(O);f.partTarget=X.decimalFloatingPoint("PART-TARGET");break}case"PART":{let X=f.partList;X||(X=f.partList=[]);const rt=E>0?X[X.length-1]:void 0,ct=E++,k=new se(O,f),U=new N1(k,_,d,ct,rt);X.push(U),_.duration+=U.duration;break}case"PRELOAD-HINT":{const X=new se(O,f);f.preloadHint=X;break}case"RENDITION-REPORT":{const X=new se(O,f);f.renditionReports=f.renditionReports||[],f.renditionReports.push(X);break}default:Vt.warn(`line parsed but not handled: ${I}`);break}}}b&&!b.relurl?(m.pop(),x-=b.duration,f.partList&&(f.fragmentHint=b)):f.partList&&(td(_,b,p),_.cc=T,f.fragmentHint=_,N&&P0(_,N,f)),f.targetduration||(f.playlistParsingError=new Error("Missing Target Duration"));const K=m.length,tt=m[0],H=m[K-1];if(x+=f.skippedSegments*f.targetduration,x>0&&K&&H){f.averagetargetduration=x/K;const G=H.sn;f.endSN=G!=="initSegment"?G:0,f.live||(H.endList=!0),w>0&&(Zb(m,w),tt&&p.unshift(tt))}return f.fragmentHint&&(x+=f.fragmentHint.duration),f.totalduration=x,p.length&&f.dateRangeTagCount&&tt&&dv(p,f),f.endCC=T,f}}function dv(l,t){let e=l.length;if(!e)if(t.hasProgramDateTime){const c=t.fragments[t.fragments.length-1];l.push(c),e++}else return;const i=l[e-1],n=t.live?1/0:t.totalduration,a=Object.keys(t.dateRanges);for(let c=a.length;c--;){const d=t.dateRanges[a[c]],f=d.startDate.getTime();d.tagAnchor=i.ref;for(let m=e;m--;){var o;if(((o=l[m])==null?void 0:o.sn)<t.startSN)break;const p=Wb(t,f,l,m,n);if(p!==-1){d.tagAnchor=t.fragments[p].ref;break}}}}function Wb(l,t,e,i,n){const a=e[i];if(a){const c=a.programDateTime;if(t>=c||i===0){var o;const d=(((o=e[i+1])==null?void 0:o.start)||n)-a.start;if(t<=c+d*1e3){const f=e[i].sn-l.startSN;if(f<0)return-1;const m=l.fragments;if(m.length>e.length){const g=(e[i+1]||m[m.length-1]).sn-l.startSN;for(let v=g;v>f;v--){const E=m[v].programDateTime;if(t>=E&&t<E+m[v].duration*1e3)return v}}return f}}}return-1}function C0(l,t,e){var i,n;const a=new se(l,e),o=(i=a.METHOD)!=null?i:"",c=a.URI,d=a.hexadecimalInteger("IV"),f=a.KEYFORMATVERSIONS,m=(n=a.KEYFORMAT)!=null?n:"identity";c&&a.IV&&!d&&Vt.error(`Invalid IV: ${a.IV}`);const p=c?Hi.resolve(c,t):"",g=(f||"1").split("/").map(Number).filter(Number.isFinite);return new Rn(o,p,m,g,d,a.KEYID)}function w0(l){const e=new se(l).decimalFloatingPoint("TIME-OFFSET");return ht(e)?e:null}function k0(l,t){let e=(l||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const n=e.filter(a=>Td(a,i));n.length&&(t[`${i}Codec`]=n.map(a=>a.split("/")[0]).join(","),e=e.filter(a=>n.indexOf(a)===-1))}),t.unknownCodecs=e}function O0(l,t,e){const i=t[e];i&&(l[e]=i)}function Zb(l,t){let e=l[t];for(let i=t;i--;){const n=l[i];if(!n)return;n.programDateTime=e.programDateTime-n.duration*1e3,e=n}}function td(l,t,e){l.rawProgramDateTime?e.push(l):t!=null&&t.programDateTime&&(l.programDateTime=t.endProgramDateTime)}function M0(l,t,e,i){l.relurl=t.URI,t.BYTERANGE&&l.setByteRange(t.BYTERANGE),l.level=e,l.sn="initSegment",i&&(l.levelkeys=i),l.initSegment=null}function P0(l,t,e){l.levelkeys=t;const{encryptedFragments:i}=e;(!i.length||i[i.length-1].levelkeys!==t)&&Object.keys(t).some(n=>t[n].isCommonEncryption)&&i.push(l)}function ps(l,t,e){l.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${e[0]})`)}function N0(l,t,e){l.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${e[0]})`)}function Rf(l,t){const e=t.startPTS;if(ht(e)){let i=0,n;t.sn>l.sn?(i=e-l.start,n=l):(i=l.start-e,n=t),n.duration!==i&&n.setDuration(i)}else t.sn>l.sn?l.cc===t.cc&&l.minEndPTS?t.setStart(l.start+(l.minEndPTS-l.start)):t.setStart(l.start+l.duration):t.setStart(Math.max(l.start-t.duration,0))}function hv(l,t,e,i,n,a,o){i-e<=0&&(o.warn("Fragment should have a positive duration",t),i=e+t.duration,a=n+t.duration);let d=e,f=i;const m=t.startPTS,p=t.endPTS;if(ht(m)){const A=Math.abs(m-e);l&&A>l.totalduration?o.warn(`media timestamps and playlist times differ by ${A}s for level ${t.level} ${l.url}`):ht(t.deltaPTS)?t.deltaPTS=Math.max(A,t.deltaPTS):t.deltaPTS=A,d=Math.max(e,m),e=Math.min(e,m),n=t.startDTS!==void 0?Math.min(n,t.startDTS):n,f=Math.min(i,p),i=Math.max(i,p),a=t.endDTS!==void 0?Math.max(a,t.endDTS):a}const g=e-t.start;t.start!==0&&t.setStart(e),t.setDuration(i-t.start),t.startPTS=e,t.maxStartPTS=d,t.startDTS=n,t.endPTS=i,t.minEndPTS=f,t.endDTS=a;const v=t.sn;if(!l||v<l.startSN||v>l.endSN)return 0;let E;const x=v-l.startSN,T=l.fragments;for(T[x]=t,E=x;E>0;E--)Rf(T[E],T[E-1]);for(E=x;E<T.length-1;E++)Rf(T[E],T[E+1]);return l.fragmentHint&&Rf(T[T.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,g}function Jb(l,t,e){if(l===t)return;let i=null;const n=l.fragments;for(let m=n.length-1;m>=0;m--){const p=n[m].initSegment;if(p){i=p;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;let a;iA(l,t,(m,p,g,v)=>{if((!t.startCC||t.skippedSegments)&&p.cc!==m.cc){const E=m.cc-p.cc;for(let x=g;x<v.length;x++)v[x].cc+=E;t.endCC=v[v.length-1].cc}ht(m.startPTS)&&ht(m.endPTS)&&(p.setStart(p.startPTS=m.startPTS),p.startDTS=m.startDTS,p.maxStartPTS=m.maxStartPTS,p.endPTS=m.endPTS,p.endDTS=m.endDTS,p.minEndPTS=m.minEndPTS,p.setDuration(m.endPTS-m.startPTS),p.duration&&(a=p),t.PTSKnown=t.alignedSliding=!0),m.hasStreams&&(p.elementaryStreams=m.elementaryStreams),p.loader=m.loader,m.hasStats&&(p.stats=m.stats),m.initSegment&&(p.initSegment=m.initSegment,i=m.initSegment)});const o=t.fragments,c=t.fragmentHint?o.concat(t.fragmentHint):o;if(i&&c.forEach(m=>{var p;m&&(!m.initSegment||m.initSegment.relurl===((p=i)==null?void 0:p.relurl))&&(m.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=o.some(m=>!m),t.deltaUpdateFailed){e.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=t.skippedSegments;m--;)o.shift();t.startSN=o[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=tA(l.dateRanges,t,e));const m=l.fragments.filter(p=>p.rawProgramDateTime);if(l.hasProgramDateTime&&!t.hasProgramDateTime)for(let p=1;p<c.length;p++)c[p].programDateTime===null&&td(c[p],c[p-1],m);dv(m,t)}t.endCC=o[o.length-1].cc}if(!t.startCC){var d;const m=gv(l,t.startSN-1);t.startCC=(d=m?.cc)!=null?d:o[0].cc}eA(l.partList,t.partList,(m,p)=>{p.elementaryStreams=m.elementaryStreams,p.stats=m.stats}),a?hv(t,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS,e):mv(l,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=l.driftStartTime,t.driftStart=l.driftStart;const f=t.advancedDateTime;if(t.advanced&&f){const m=t.edge;t.driftStart||(t.driftStartTime=f,t.driftStart=m),t.driftEndTime=f,t.driftEnd=m}else t.driftEndTime=l.driftEndTime,t.driftEnd=l.driftEnd,t.advancedDateTime=l.advancedDateTime;t.requestScheduled===-1&&(t.requestScheduled=l.requestScheduled)}function tA(l,t,e){const{dateRanges:i,recentlyRemovedDateranges:n}=t,a=Xt({},l);n&&n.forEach(d=>{delete a[d]});const c=Object.keys(a).length;return c?(Object.keys(i).forEach(d=>{const f=a[d],m=new lv(i[d].attr,f);m.isValid?(a[d]=m,f||(m.tagOrder+=c)):e.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Zt(i[d].attr)}"`)}),a):i}function eA(l,t,e){if(l&&t){let i=0;for(let n=0,a=l.length;n<=a;n++){const o=l[n],c=t[n+i];o&&c&&o.index===c.index&&o.fragment.sn===c.fragment.sn?e(o,c):i--}}}function iA(l,t,e){const i=t.skippedSegments,n=Math.max(l.startSN,t.startSN)-t.startSN,a=(l.fragmentHint?1:0)+(i?t.endSN:Math.min(l.endSN,t.endSN))-t.startSN,o=t.startSN-l.startSN,c=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,d=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments;for(let f=n;f<=a;f++){const m=d[o+f];let p=c[f];if(i&&!p&&m&&(p=t.fragments[f]=m),m&&p){e(m,p,f,c);const g=m.relurl,v=p.relurl;if(g&&sA(g,v)){t.playlistParsingError=B0(`media sequence mismatch ${p.sn}:`,l,t,m,p);return}else if(m.cc!==p.cc){t.playlistParsingError=B0(`discontinuity sequence mismatch (${m.cc}!=${p.cc})`,l,t,m,p);return}}}}function B0(l,t,e,i,n){return new Error(`${l} ${n.url}
Playlist starting @${t.startSN}
${t.m3u8}

Playlist starting @${e.startSN}
${e.m3u8}`)}function mv(l,t,e=!0){const i=t.startSN+t.skippedSegments-l.startSN,n=l.fragments,a=i>=0;let o=0;if(a&&i<n.length)o=n[i].start;else if(a&&t.startSN===l.endSN+1)o=l.fragmentEnd;else if(a&&e)o=l.fragmentStart+i*t.levelTargetDuration;else if(!t.skippedSegments&&t.fragmentStart===0)o=l.fragmentStart;else return;ed(t,o)}function ed(l,t){if(t){const e=l.fragments;for(let i=l.skippedSegments;i<e.length;i++)e[i].addStart(t);l.fragmentHint&&l.fragmentHint.addStart(t)}}function pv(l,t=1/0){let e=1e3*l.targetduration;if(l.updated){const i=l.fragments;if(i.length&&e*4>t){const a=i[i.length-1].duration*1e3;a<e&&(e=a)}}else e/=2;return Math.round(e)}function gv(l,t,e){if(!l)return null;let i=l.fragments[t-l.startSN];return i||(i=l.fragmentHint,i&&i.sn===t)?i:t<l.startSN&&e&&e.sn===t?e:null}function F0(l,t,e){return l?yv(l.partList,t,e):null}function yv(l,t,e){if(l)for(let i=l.length;i--;){const n=l[i];if(n.index===e&&n.fragment.sn===t)return n}return null}function vv(l){l.forEach((t,e)=>{var i;(i=t.details)==null||i.fragments.forEach(n=>{n.level=e,n.initSegment&&(n.initSegment.level=e)})})}function sA(l,t){return l!==t&&t?U0(l)!==U0(t):!1}function U0(l){return l.replace(/\?[^?]*$/,"")}function Ia(l,t){for(let i=0,n=l.length;i<n;i++){var e;if(((e=l[i])==null?void 0:e.cc)===t)return l[i]}return null}function nA(l,t){return!!(l&&t.startCC<l.endCC&&t.endCC>l.startCC)}function $0(l,t){const e=l.start+t;l.startPTS=e,l.setStart(e),l.endPTS=e+l.duration}function Ev(l,t){const e=t.fragments;for(let i=0,n=e.length;i<n;i++)$0(e[i],l);t.fragmentHint&&$0(t.fragmentHint,l),t.alignedSliding=!0}function rA(l,t){l&&(Sv(t,l),t.alignedSliding||jo(t,l),!t.alignedSliding&&!t.skippedSegments&&mv(l,t,!1))}function Sv(l,t){if(!nA(t,l))return;const e=Math.min(t.endCC,l.endCC),i=Ia(t.fragments,e),n=Ia(l.fragments,e);if(!i||!n)return;Vt.log(`Aligning playlist at start of dicontinuity sequence ${e}`);const a=i.start-n.start;Ev(a,l)}function jo(l,t){if(!l.hasProgramDateTime||!t.hasProgramDateTime)return;const e=l.fragments,i=t.fragments;if(!e.length||!i.length)return;let n,a;const o=Math.min(t.endCC,l.endCC);t.startCC<o&&l.startCC<o&&(n=Ia(i,o),a=Ia(e,o)),(!n||!a)&&(n=i[Math.floor(i.length/2)],a=Ia(e,n.cc)||e[Math.floor(e.length/2)]);const c=n.programDateTime,d=a.programDateTime;if(!c||!d)return;const f=(d-c)/1e3-(a.start-n.start);Ev(f,l)}function Ve(l,t,e){ei(l,t,e),l.addEventListener(t,e)}function ei(l,t,e){l.removeEventListener(t,e)}const aA={toString:function(l){let t="";const e=l.length;for(let i=0;i<e;i++)t+=`[${l.start(i).toFixed(3)}-${l.end(i).toFixed(3)}]`;return t}},nt={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Id extends rv{constructor(t,e,i,n,a){super(n,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=nt.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:c,media:d,mediaBuffer:f,state:m}=this,p=d?d.currentTime:0,g=At.bufferInfo(f||d,p,o.maxBufferHole),v=!g.len;if(this.log(`Media seeking to ${ht(p)?p.toFixed(3):p}, state: ${m}, ${v?"out of":"in"} buffer`),this.state===nt.ENDED)this.resetLoadingState();else if(c){const E=o.maxFragLookUpTolerance,x=c.start-E,T=c.start+c.duration+E;if(v||T<g.start||x>g.end){const A=p>T;(p<x||A)&&(A&&c.loader&&(this.log(`Cancelling fragment load for seek (sn: ${c.sn})`),c.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const E=this.lastCurrentTime;if(p>E&&(this.lastCurrentTime=p),!this.loadingParts){const x=Math.max(g.end,p),T=this.shouldLoadParts(this.getLevelDetails(),x);T&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${x.toFixed(2)}`),this.loadingParts=T)}}this.hls.hasEnoughToStart||(this.log(`Setting ${v?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,v&&(this.startPosition=p)),v&&this.state===nt.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=t,this.fragmentLoader=new Mb(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Ad(t.config)}registerListeners(){const{hls:t}=this;t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(R.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===nt.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=nt.STOPPED}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return e===-1&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const i=t.end||0,n=this.config.timelineOffset||0;if(i<=n)return!1;const a=t.buffered;this.config.maxBufferHole&&a&&a.length>1&&(t=At.bufferedInfo(a,t.start,0));const o=t.nextStart;if(o&&o>n&&o<e.edge||this.media.currentTime<t.start)return!1;const d=e.partList;if(d!=null&&d.length){const m=d[d.length-1];return At.isBuffered(this.media,m.start+m.duration/2)}const f=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(f)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;if(t){var e;return((e=this.getLevelDetails())==null?void 0:e.appliedTimelineOffset)||t}return 0}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;Ve(i,"seeking",this.onMediaSeeking),Ve(i,"ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===nt.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(t,e){const i=!!e.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ei(n,"seeking",this.onMediaSeeking),ei(n,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=nt.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){const n=a=>{const o=a.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(o,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(t,e,i,n).then(a=>{if(!a)return;const o=this.state,c=a.frag;if(this.fragContextChanged(c)){(o===nt.FRAG_LOADING||!this.fragCurrent&&o===nt.PARSING)&&(this.fragmentTracker.removeFragment(c),this.state=nt.IDLE);return}"payload"in a&&(this.log(`Loaded ${c.type} sn: ${c.sn} of ${this.playlistLabel()} ${c.level}`),this.hls.trigger(R.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===nt.STOPPED||this.state===nt.ERROR||(this.warn(`Frag error: ${a?.message||a}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if(i.getState(t)===Ae.APPENDING){const a=t.type,o=this.getFwdBufferInfo(this.mediaBuffer,a),c=Math.max(t.duration,o?o.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?t.sn-d.sn:0)===1||this.reduceMaxBufferLength(c,t.duration))&&i.removeFragment(t)}else((e=this.mediaBuffer)==null?void 0:e.buffered.length)===0?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===Ae.PARTIAL&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return e?.live&&e.type!=="EVENT"&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,i=null){if(!(t-e))return;const n={startOffset:t,endOffset:e,type:i};this.hls.trigger(R.BUFFER_FLUSHING,n)}_loadInitSegment(t,e){this._doFragLoad(t,e).then(i=>{const n=i?.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:n}=this,{frag:a,payload:o}=i,c=a.decryptdata;if(o&&o.byteLength>0&&c!=null&&c.key&&c.iv&&Ar(c.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),c.key.buffer,c.iv.buffer,Rd(c.method)).catch(f=>{throw n.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:a}),f}).then(f=>{const m=self.performance.now();return n.trigger(R.FRAG_DECRYPTED,{frag:a,payload:f,stats:{tstart:d,tdecrypt:m}}),i.payload=f,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===nt.STOPPED||this.state===nt.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;this.state!==nt.STOPPED&&(this.state=nt.IDLE),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var i,n;const a=t.tracks;if(a&&!e.encrypted&&((i=a.audio)!=null&&i.encrypted||(n=a.video)!=null&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,c=new Error(`Encrypted track with no key in ${this.fragInfo(e)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(c.message),!o||o.mediaKeys?!1:(this.hls.trigger(R.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_KEYS,fatal:!1,error:c,frag:e}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?aA.toString(At.getBuffered(i)):"(detached)"})`),Ee(t)){var n;if(t.type!==mt.SUBTITLE){const o=t.elementaryStreams;if(!Object.keys(o).some(c=>!!o[c])){this.state=nt.IDLE;return}}const a=(n=this.levels)==null?void 0:n[t.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=nt.IDLE}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:n,partsLoaded:a}=t,o=!a||a.length===0||a.some(d=>!d),c=new Ld(i.level,i.sn,i.stats.chunkCount+1,0,n?n.index:-1,!o);e.flush(c)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,n){var a;this.fragCurrent=t;const o=e.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let c=null;if(t.encrypted&&!((a=t.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${t.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=nt.KEY_LOADING,this.fragCurrent=t,c=this.keyLoader.load(t).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(R.KEY_LOADED,g),this.state===nt.KEY_LOADING&&(this.state=nt.IDLE),g}),this.hls.trigger(R.KEY_LOADING,{frag:t}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else t.encrypted||(c=this.keyLoader.loadClear(t,o.encryptedFragments,this.startFragRequested),c&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(Ee(t)&&(!d||t.sn!==d.sn)){const g=this.shouldLoadParts(e.details,t.end);g!==this.loadingParts&&(this.log(`LL-Part loading ${g?"ON":"OFF"} loading sn ${d?.sn}->${t.sn}`),this.loadingParts=g)}if(i=Math.max(t.start,i||0),this.loadingParts&&Ee(t)){const g=o.partList;if(g&&n){i>o.fragmentEnd&&o.fragmentHint&&(t=o.fragmentHint);const v=this.getNextPart(g,t,i);if(v>-1){const E=g[v];t=this.fragCurrent=E.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${E.index} (${v}/${g.length-1}) of ${this.fragInfo(t,!1,E)}) cc: ${t.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state=nt.FRAG_LOADING;let x;return c?x=c.then(T=>!T||this.fragContextChanged(T.frag)?null:this.doFragPartsLoad(t,E,e,n)).catch(T=>this.handleFragLoadError(T)):x=this.doFragPartsLoad(t,E,e,n).catch(T=>this.handleFragLoadError(T)),this.hls.trigger(R.FRAG_LOADING,{frag:t,part:E,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!t.url||this.loadedEndOfParts(g,i))return Promise.resolve(null)}}if(Ee(t)&&this.loadingParts){var f;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${t.sn} loaded parts: ${(f=o.partList)==null?void 0:f.filter(g=>g.loaded).map(g=>`[${g.start}-${g.end}]`)}`),this.loadingParts=!1}else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),ht(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=nt.FRAG_LOADING;const m=this.config.progressive;let p;return m&&c?p=c.then(g=>!g||this.fragContextChanged(g.frag)?null:this.fragmentLoader.load(t,n)).catch(g=>this.handleFragLoadError(g)):p=Promise.all([this.fragmentLoader.load(t,m?n:void 0),c]).then(([g])=>(!m&&n&&n(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(R.FRAG_LOADING,{frag:t,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(t,e,i,n){return new Promise((a,o)=>{var c;const d=[],f=(c=i.details)==null?void 0:c.partList,m=p=>{this.fragmentLoader.loadPart(t,p,n).then(g=>{d[p.index]=g;const v=g.part;this.hls.trigger(R.FRAG_LOADED,g);const E=F0(i.details,t.sn,p.index+1)||yv(f,t.sn,p.index+1);if(E)m(E);else return a({frag:t,part:v,partsLoaded:d})}).catch(o)};m(e)})}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===q.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===vt.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(e.frag)):this.hls.trigger(R.ERROR,e)}else this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==nt.PARSING){!this.fragCurrent&&this.state!==nt.STOPPED&&this.state!==nt.ERROR&&(this.state=nt.IDLE);return}const{frag:i,part:n,level:a}=e,o=self.performance.now();i.stats.parsing.end=o,n&&(n.stats.parsing.end=o);const c=this.getLevelDetails(),f=c&&i.sn>c.endSN||this.shouldLoadParts(c,i.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=f),this.updateLevelTiming(i,n,a,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var i;const a=t.partList[0];if(a.fragment.type===mt.SUBTITLE)return!1;const o=a.end+(((i=t.fragmentHint)==null?void 0:i.duration)||0);if(e>=o){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:n,sn:a,part:o}=t;if(!(e!=null&&e[n]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const c=e[n],d=c.details,f=o>-1?F0(d,a,o):null,m=f?f.fragment:gv(d,a,i);return m?(i&&i!==m&&(m.stats=i.stats),{frag:m,part:f,level:c}):null}bufferFragmentData(t,e,i,n,a){if(this.state!==nt.PARSING)return;const{data1:o,data2:c}=t;let d=o;if(c&&(d=Li(o,c)),!d.length)return;const f=this.initPTS[e.cc],m=f?-f.baseTime/f.timescale:void 0,p={type:t.type,frag:e,part:i,chunkMeta:n,offset:m,parent:e.type,data:d};if(this.hls.trigger(R.BUFFER_APPENDING,p),t.dropped&&t.independent&&!i){if(a)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!At.isBuffered(e,e.currentTime)){this.flushMainBuffer(0,t.start);return}const i=e.currentTime,n=At.bufferInfo(e,i,0),a=t.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),c=Math.max(Math.min(t.start-o,n.end-o),i+o);t.start-c>o&&this.flushMainBuffer(c,t.start)}getFwdBufferInfo(t,e){var i;const n=this.getLoadPosition();if(!ht(n))return null;const o=this.lastCurrentTime>n||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,n,e,o)}getFwdBufferInfoAtPos(t,e,i,n){const a=At.bufferInfo(t,e,n);if(a.len===0&&a.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(e,i);if(o&&(a.nextStart<=o.end||o.gap)){const c=Math.max(Math.min(a.nextStart,o.end)-e,n);return At.bufferInfo(t,e,c)}}return a}getMaxBufferLength(t){const{config:e}=this;let i;return t?i=Math.max(8*e.maxBufferSize/t,e.maxBufferLength):i=e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const i=this.config,n=Math.max(Math.min(t-e,i.maxBufferLength),e),a=Math.max(t-e*3,i.maxMaxBufferLength/2,n);return a>=n?(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(t,e=mt.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(t,e){const i=e.fragments,n=i.length;if(!n)return null;const{config:a}=this,o=i[0].start,c=a.lowLatencyMode&&!!e.partList;let d=null;if(e.live){const p=a.initialLiveManifestSize;if(n<p)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${p})`),null;if(!e.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<o){var f;c&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(e);const g=this.hls.startPosition,v=this.hls.liveSyncPosition,E=d?(g!==-1&&g>=o?g:v)||d.start:t;this.log(`Setting startPosition to ${E} to match start frag at live edge. mainStart: ${g} liveSyncPosition: ${v} frag.start: ${(f=d)==null?void 0:f.start}`),this.startPosition=this.nextLoadPosition=E}}else t<=o&&(d=i[0]);if(!d){const p=this.loadingParts?e.partEnd:e.fragmentEnd;d=this.getFragmentAtPosition(t,p,e)}let m=this.filterReplacedPrimary(d,e);if(!m&&d){const p=d.sn-e.startSN;m=this.filterReplacedPrimary(i[p+1]||null,e)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return(i===Ae.OK||i===Ae.PARTIAL&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,n,a){let o=null;if(t.gap&&(o=this.getNextFragment(this.nextLoadPosition,e),o&&!o.gap&&i.nextStart)){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,n,0);if(c!==null&&i.len+c.len>=a){const d=o.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(j0(this.config)){var t;if((t=this.hls.interstitialsManager)==null||(t=t.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(j0(this.config)&&t.type!==mt.SUBTITLE){const i=this.hls.interstitialsManager,n=i?.bufferingItem;if(n){const o=n.event;if(o){if(o.appendInPlace||Math.abs(t.start-n.start)>1||n.start===0)return null}else if(t.end<=n.start&&e?.live===!1||t.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||t.start-n.end>1))return null}const a=i?.playerQueue;if(a)for(let o=a.length;o--;){const c=a[o].interstitial;if(c.appendInPlace&&t.start>=c.startTime&&t.end<=c.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!t.initSegment.data&&!this.bitrateTest?t.initSegment:t}getNextPart(t,e,i){let n=-1,a=!1,o=!0;for(let c=0,d=t.length;c<d;c++){const f=t[c];if(o=o&&!f.independent,n>-1&&i<f.start)break;const m=f.loaded;m?n=-1:(a||(f.independent||o)&&f.fragment===e)&&(f.fragment!==e&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${f.start}`),n=c),a=m}return n}loadedEndOfParts(t,e){let i;for(let n=t.length;n--;){if(i=t[n],!i.loaded)return!1;if(e>i.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,i=this.fragPrevious;let n=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),n=xb(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const a=i.sn+1;if(a>=t.startSN&&a<=t.endSN){const o=e[a-t.startSN];i.cc===o.cc&&(n=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=iv(t,i.cc,i.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(n=this.getFragmentAtPosition(a,this.bitrateTest?t.fragmentEnd:t.edge,t))}return n}getFragmentAtPosition(t,e,i){const{config:n}=this;let{fragPrevious:a}=this,{fragments:o,endSN:c}=i;const{fragmentHint:d}=i,{maxFragLookUpTolerance:f}=n,m=i.partList,p=!!(this.loadingParts&&m!=null&&m.length&&d);p&&!this.bitrateTest&&m[m.length-1].fragment.sn===d.sn&&(o=o.concat(d),c=d.sn);let g;if(t<e){var v;const x=t<this.lastCurrentTime||t>e-f||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:f;g=_n(a,o,t,x)}else g=o[o.length-1];if(g){const E=g.sn-i.startSN,x=this.fragmentTracker.getState(g);if((x===Ae.OK||x===Ae.PARTIAL&&g.gap)&&(a=g),a&&g.sn===a.sn&&(!p||m[0].fragment.sn>g.sn||!i.live)&&g.level===a.level){const A=o[E+1];g.sn<c&&this.fragmentTracker.getState(A)!==Ae.OK?g=A:g=null}}return g}alignPlaylists(t,e,i){const n=t.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const a=t.fragmentStart,o=!e,c=t.alignedSliding&&ht(a);if(o||!c&&!a){rA(i,t);const d=t.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${n}`),d}return a}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*3)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);const n=this.timelineOffset;if(i===-1){const a=this.startTimeOffset!==null,o=a?this.startTimeOffset:t.startTimeOffset;o!==null&&ht(o)?(i=e+o,o<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${o} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+n}this.nextLoadPosition=i+n}getLoadPosition(){var t;const{media:e}=this;let i=0;return(t=this.hls)!=null&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&Ee(t)&&t.stats.aborted&&(this.log(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==nt.FRAG_LOADING_WAITING_RETRY)&&(this.state=nt.IDLE)}onFragmentOrKeyLoadError(t,e){var i;if(e.chunkMeta&&!e.frag){const A=this.getCurrentContext(e.chunkMeta);A&&(e.frag=A.frag)}const n=e.frag;if(!n||n.type!==t||!this.levels)return;if(this.fragContextChanged(n)){var a;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const o=e.details===q.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(n,!0);const c=e.errorAction;if(!c){this.state=nt.ERROR;return}const{action:d,flags:f,retryCount:m=0,retryConfig:p}=c,g=!!p,v=g&&d===Pe.RetryRequest,E=g&&!c.resolved&&f===ci.MoveAllAlternatesMatchingHost,x=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!v&&E&&Ee(n)&&!n.endList&&x&&!nv(e))this.resetFragmentErrors(t),this.treatAsGap(n),c.resolved=!0;else if((v||E)&&m<p.maxNumRetry){var T;const A=Wf((T=e.response)==null?void 0:T.code),b=bd(p,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+b,this.state=nt.FRAG_LOADING_WAITING_RETRY,c.resolved=!0,A){this.log("Waiting for connection (offline)"),this.retryDate=1/0,e.reason="offline";return}this.warn(`Fragment ${n.sn} of ${t} ${n.level} errored with ${e.details}, retrying loading ${m+1}/${p.maxNumRetry} in ${b}ms`)}else if(p)if(this.resetFragmentErrors(t),m<p.maxNumRetry)!o&&d!==Pe.RemoveAlternatePermanently&&(c.resolved=!0);else{this.warn(`${e.details} reached or exceeded max retry (${m})`);return}else d===Pe.SendAlternateToPenaltyBox?this.state=nt.WAITING_LEVEL:this.state=nt.ERROR;this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,i=e===1/0;(!e||t>=e||i&&!Wf(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=nt.IDLE)}reduceLengthAndFlushBuffer(t){if(this.state===nt.PARSING||this.state===nt.PARSED){const e=t.frag,i=t.parent,n=this.getFwdBufferInfo(this.mediaBuffer,i),a=n&&n.len>.5;a&&this.reduceMaxBufferLength(n.len,e?.duration||10);const o=!a;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(t){t===mt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==nt.STOPPED&&(this.state=nt.IDLE)}afterBufferFlushed(t,e,i){if(!t)return;const n=At.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,n,i),this.state===nt.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==nt.STOPPED&&(this.state=nt.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;e!=null&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log(`Loading context changed while buffering sn ${t.sn} of ${this.playlistLabel()} ${t.level===-1?"<removed>":t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,n){const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((d,f)=>{const m=t.elementaryStreams[f];if(m){const p=m.endPTS-m.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${t.sn} ${f} duration reliably (${p})`),d||!1;const g=n?0:hv(a,t,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(R.LEVEL_PTS_UPDATED,{details:a,level:i,drift:g,type:f,frag:t,start:m.startPTS,end:m.endPTS}),!0}return d},!1)){var c;if(i.fragmentError===0&&this.treatAsGap(t,i),((c=this.transmuxer)==null?void 0:c.error)===null){const d=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=nt.PARSED,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(R.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===mt.MAIN?"level":"track"}fragInfo(t,e=!0,i){var n,a;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${((n=e&&!i?t.startPTS:(i||t).start)!=null?n:NaN).toFixed(3)}-${((a=e&&!i?t.endPTS:(i||t).end)!=null?a:NaN).toFixed(3)}]${i&&t.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;(t=this.transmuxer)==null||t.reset()}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function j0(l){return!!l.interstitialsController&&l.enableInterstitialPlayback!==!1}class Tv{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;if(t.length)t.length===1?i=t[0]:i=lA(t,e);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function lA(l,t){const e=new Uint8Array(t);let i=0;for(let n=0;n<l.length;n++){const a=l[n];e.set(a,i),i+=a.length}return e}var _f={exports:{}},G0;function oA(){return G0||(G0=1,(function(l){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(d,f,m){this.fn=d,this.context=f,this.once=m||!1}function a(d,f,m,p,g){if(typeof m!="function")throw new TypeError("The listener must be a function");var v=new n(m,p||d,g),E=e?e+f:f;return d._events[E]?d._events[E].fn?d._events[E]=[d._events[E],v]:d._events[E].push(v):(d._events[E]=v,d._eventsCount++),d}function o(d,f){--d._eventsCount===0?d._events=new i:delete d._events[f]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],m,p;if(this._eventsCount===0)return f;for(p in m=this._events)t.call(m,p)&&f.push(e?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(m)):f},c.prototype.listeners=function(f){var m=e?e+f:f,p=this._events[m];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,v=p.length,E=new Array(v);g<v;g++)E[g]=p[g].fn;return E},c.prototype.listenerCount=function(f){var m=e?e+f:f,p=this._events[m];return p?p.fn?1:p.length:0},c.prototype.emit=function(f,m,p,g,v,E){var x=e?e+f:f;if(!this._events[x])return!1;var T=this._events[x],A=arguments.length,b,_;if(T.fn){switch(T.once&&this.removeListener(f,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,m),!0;case 3:return T.fn.call(T.context,m,p),!0;case 4:return T.fn.call(T.context,m,p,g),!0;case 5:return T.fn.call(T.context,m,p,g,v),!0;case 6:return T.fn.call(T.context,m,p,g,v,E),!0}for(_=1,b=new Array(A-1);_<A;_++)b[_-1]=arguments[_];T.fn.apply(T.context,b)}else{var I=T.length,C;for(_=0;_<I;_++)switch(T[_].once&&this.removeListener(f,T[_].fn,void 0,!0),A){case 1:T[_].fn.call(T[_].context);break;case 2:T[_].fn.call(T[_].context,m);break;case 3:T[_].fn.call(T[_].context,m,p);break;case 4:T[_].fn.call(T[_].context,m,p,g);break;default:if(!b)for(C=1,b=new Array(A-1);C<A;C++)b[C-1]=arguments[C];T[_].fn.apply(T[_].context,b)}}return!0},c.prototype.on=function(f,m,p){return a(this,f,m,p,!1)},c.prototype.once=function(f,m,p){return a(this,f,m,p,!0)},c.prototype.removeListener=function(f,m,p,g){var v=e?e+f:f;if(!this._events[v])return this;if(!m)return o(this,v),this;var E=this._events[v];if(E.fn)E.fn===m&&(!g||E.once)&&(!p||E.context===p)&&o(this,v);else{for(var x=0,T=[],A=E.length;x<A;x++)(E[x].fn!==m||g&&!E[x].once||p&&E[x].context!==p)&&T.push(E[x]);T.length?this._events[v]=T.length===1?T[0]:T:o(this,v)}return this},c.prototype.removeAllListeners=function(f){var m;return f?(m=e?e+f:f,this._events[m]&&o(this,m)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=e,c.EventEmitter=c,l.exports=c})(_f)),_f.exports}var uA=oA(),Dd=M1(uA);const Pa="1.6.14",Ir={};function cA(){return typeof __HLS_WORKER_BUNDLE__=="function"}function fA(){const l=Ir[Pa];if(l)return l.clientCount++,l;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t),n={worker:new self.Worker(e),objectURL:e,clientCount:1};return Ir[Pa]=n,n}function dA(l){const t=Ir[l];if(t)return t.clientCount++,t;const e=new self.URL(l,self.location.href).href,n={worker:new self.Worker(e),scriptURL:e,clientCount:1};return Ir[l]=n,n}function hA(l){const t=Ir[l||Pa];if(t&&t.clientCount--===1){const{worker:i,objectURL:n}=t;delete Ir[l||Pa],n&&self.URL.revokeObjectURL(n),i.terminate()}}function xv(l,t){return t+10<=l.length&&l[t]===51&&l[t+1]===68&&l[t+2]===73&&l[t+3]<255&&l[t+4]<255&&l[t+6]<128&&l[t+7]<128&&l[t+8]<128&&l[t+9]<128}function Cd(l,t){return t+10<=l.length&&l[t]===73&&l[t+1]===68&&l[t+2]===51&&l[t+3]<255&&l[t+4]<255&&l[t+6]<128&&l[t+7]<128&&l[t+8]<128&&l[t+9]<128}function qo(l,t){let e=0;return e=(l[t]&127)<<21,e|=(l[t+1]&127)<<14,e|=(l[t+2]&127)<<7,e|=l[t+3]&127,e}function Na(l,t){const e=t;let i=0;for(;Cd(l,t);){i+=10;const n=qo(l,t+6);i+=n,xv(l,t+10)&&(i+=10),t+=i}if(i>0)return l.subarray(e,e+i)}function mA(l,t,e,i){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=t[e+2],o=a>>2&15;if(o>12){const v=new Error(`invalid ADTS sampling index:${o}`);l.emit(R.ERROR,R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const c=(a>>6&3)+1,d=t[e+3]>>6&3|(a&1)<<2,f="mp4a.40."+c,m=n[o];let p=o;(c===5||c===29)&&(p-=3);const g=[c<<3|(p&14)>>1,(p&1)<<7|d<<3];return Vt.log(`manifest codec:${i}, parsed codec:${f}, channels:${d}, rate:${m} (ADTS object type:${c} sampling index:${o})`),{config:g,samplerate:m,channelCount:d,codec:f,parsedCodec:f,manifestCodec:i}}function bv(l,t){return l[t]===255&&(l[t+1]&246)===240}function Av(l,t){return l[t+1]&1?7:9}function wd(l,t){return(l[t+3]&3)<<11|l[t+4]<<3|(l[t+5]&224)>>>5}function pA(l,t){return t+5<l.length}function Go(l,t){return t+1<l.length&&bv(l,t)}function gA(l,t){return pA(l,t)&&bv(l,t)&&wd(l,t)<=l.length-t}function yA(l,t){if(Go(l,t)){const e=Av(l,t);if(t+e>=l.length)return!1;const i=wd(l,t);if(i<=e)return!1;const n=t+i;return n===l.length||Go(l,n)}return!1}function Lv(l,t,e,i,n){if(!l.samplerate){const a=mA(t,e,i,n);if(!a)return;Xt(l,a)}}function Rv(l){return 1024*9e4/l}function vA(l,t){const e=Av(l,t);if(t+e<=l.length){const i=wd(l,t)-e;if(i>0)return{headerLength:e,frameLength:i}}}function _v(l,t,e,i,n){const a=Rv(l.samplerate),o=i+n*a,c=vA(t,e);let d;if(c){const{frameLength:p,headerLength:g}=c,v=g+p,E=Math.max(0,e+v-t.length);E?(d=new Uint8Array(v-g),d.set(t.subarray(e+g,t.length),0)):d=t.subarray(e+g,e+v);const x={unit:d,pts:o};return E||l.samples.push(x),{sample:x,length:v,missing:E}}const f=t.length-e;return d=new Uint8Array(f),d.set(t.subarray(e,t.length),0),{sample:{unit:d,pts:o},length:f,missing:-1}}function EA(l,t){return Cd(l,t)&&qo(l,t+6)+10<=l.length-t}function SA(l){return l instanceof ArrayBuffer?l:l.byteOffset==0&&l.byteLength==l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer}function If(l,t=0,e=1/0){return TA(l,t,e,Uint8Array)}function TA(l,t,e,i){const n=xA(l);let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const o=bA(l)?l.byteOffset:0,c=(o+l.byteLength)/a,d=(o+t)/a,f=Math.floor(Math.max(0,Math.min(d,c))),m=Math.floor(Math.min(f+Math.max(e,0),c));return new i(n,f,m-f)}function xA(l){return l instanceof ArrayBuffer?l:l.buffer}function bA(l){return l&&l.buffer instanceof ArrayBuffer&&l.byteLength!==void 0&&l.byteOffset!==void 0}function AA(l){const t={key:l.type,description:"",data:"",mimeType:null,pictureType:null},e=3;if(l.size<2)return;if(l.data[0]!==e){console.log("Ignore frame with unrecognized character encoding");return}const i=l.data.subarray(1).indexOf(0);if(i===-1)return;const n=hi(If(l.data,1,i)),a=l.data[2+i],o=l.data.subarray(3+i).indexOf(0);if(o===-1)return;const c=hi(If(l.data,3+i,o));let d;return n==="-->"?d=hi(If(l.data,4+i+o)):d=SA(l.data.subarray(4+i+o)),t.mimeType=n,t.pictureType=a,t.description=c,t.data=d,t}function LA(l){if(l.size<2)return;const t=hi(l.data,!0),e=new Uint8Array(l.data.subarray(t.length+1));return{key:l.type,info:t,data:e.buffer}}function RA(l){if(l.size<2)return;if(l.type==="TXXX"){let e=1;const i=hi(l.data.subarray(e),!0);e+=i.length+1;const n=hi(l.data.subarray(e));return{key:l.type,info:i,data:n}}const t=hi(l.data.subarray(1));return{key:l.type,info:"",data:t}}function _A(l){if(l.type==="WXXX"){if(l.size<2)return;let e=1;const i=hi(l.data.subarray(e),!0);e+=i.length+1;const n=hi(l.data.subarray(e));return{key:l.type,info:i,data:n}}const t=hi(l.data);return{key:l.type,info:"",data:t}}function IA(l){return l.type==="PRIV"?LA(l):l.type[0]==="W"?_A(l):l.type==="APIC"?AA(l):RA(l)}function DA(l){const t=String.fromCharCode(l[0],l[1],l[2],l[3]),e=qo(l,4),i=10;return{type:t,size:e,data:l.subarray(i,i+e)}}const co=10,CA=10;function Iv(l){let t=0;const e=[];for(;Cd(l,t);){const i=qo(l,t+6);l[t+5]>>6&1&&(t+=co),t+=co;const n=t+i;for(;t+CA<n;){const a=DA(l.subarray(t)),o=IA(a);o&&e.push(o),t+=a.size+co}xv(l,t)&&(t+=co)}return e}function Dv(l){return l&&l.key==="PRIV"&&l.info==="com.apple.streaming.transportStreamTimestamp"}function wA(l){if(l.data.byteLength===8){const t=new Uint8Array(l.data),e=t[3]&1;let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,e&&(i+=4772185884e-2),Math.round(i)}}function kd(l){const t=Iv(l);for(let e=0;e<t.length;e++){const i=t[e];if(Dv(i))return wA(i)}}let di=(function(l){return l.audioId3="org.id3",l.dateRange="com.apple.quicktime.HLS",l.emsg="https://aomedia.org/emsg/ID3",l.misbklv="urn:misb:KLV:bin:1910.1",l})({});function ji(l="",t=9e4){return{type:l,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Od{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=Li(this.cachedData,t),this.cachedData=null);let i=Na(t,0),n=i?i.length:0,a;const o=this._audioTrack,c=this._id3Track,d=i?kd(i):void 0,f=t.length;for((this.basePTS===null||this.frameIndex===0&&ht(d))&&(this.basePTS=kA(d,e,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:di.audioId3,duration:Number.POSITIVE_INFINITY});n<f;){if(this.canParse(t,n)){const m=this.appendFrame(o,t,n);m?(this.frameIndex++,this.lastPTS=m.sample.pts,n+=m.length,a=n):n=f}else EA(t,n)?(i=Na(t,n),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:di.audioId3,duration:Number.POSITIVE_INFINITY}),n+=i.length,a=n):n++;if(n===f&&a!==f){const m=t.slice(a);this.cachedData?this.cachedData=Li(this.cachedData,m):this.cachedData=m}}return{audioTrack:o,videoTrack:ji(),id3Track:c,textTrack:ji()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:ji(),id3Track:this._id3Track,textTrack:ji()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const kA=(l,t,e)=>{if(ht(l))return l*90;const i=e?e.baseTime*9e4/e.timescale:0;return t*9e4+i};let fo=null;const OA=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],MA=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],PA=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],NA=[0,1,1,4];function Cv(l,t,e,i,n){if(e+24>t.length)return;const a=wv(t,e);if(a&&e+a.frameLength<=t.length){const o=a.samplesPerFrame*9e4/a.sampleRate,c=i+n*o,d={unit:t.subarray(e,e+a.frameLength),pts:c,dts:c};return l.config=[],l.channelCount=a.channelCount,l.samplerate=a.sampleRate,l.samples.push(d),{sample:d,length:a.frameLength,missing:0}}}function wv(l,t){const e=l[t+1]>>3&3,i=l[t+1]>>1&3,n=l[t+2]>>4&15,a=l[t+2]>>2&3;if(e!==1&&n!==0&&n!==15&&a!==3){const o=l[t+2]>>1&1,c=l[t+3]>>6,d=e===3?3-i:i===3?3:4,f=OA[d*14+n-1]*1e3,p=MA[(e===3?0:e===2?1:2)*3+a],g=c===3?1:2,v=PA[e][i],E=NA[i],x=v*8*E,T=Math.floor(v*f/p+o)*E;if(fo===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);fo=_?parseInt(_[1]):0}return!!fo&&fo<=87&&i===2&&f>=224e3&&c===0&&(l[t+3]=l[t+3]|128),{sampleRate:p,channelCount:g,frameLength:T,samplesPerFrame:x}}}function Md(l,t){return l[t]===255&&(l[t+1]&224)===224&&(l[t+1]&6)!==0}function kv(l,t){return t+1<l.length&&Md(l,t)}function BA(l,t){return Md(l,t)&&4<=l.length-t}function Ov(l,t){if(t+1<l.length&&Md(l,t)){const i=wv(l,t);let n=4;i!=null&&i.frameLength&&(n=i.frameLength);const a=t+n;return a===l.length||kv(l,a)}return!1}class FA extends Od{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const i=Na(t,0);let n=i?.length||0;if(Ov(t,n))return!1;for(let a=t.length;n<a;n++)if(yA(t,n))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return gA(t,e)}appendFrame(t,e,i){Lv(t,this.observer,e,i,t.manifestCodec);const n=_v(t,e,i,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const Mv=(l,t)=>{let e=0,i=5;t+=i;const n=new Uint32Array(1),a=new Uint32Array(1),o=new Uint8Array(1);for(;i>0;){o[0]=l[t];const c=Math.min(i,8),d=8-c;a[0]=4278190080>>>24+d<<d,n[0]=(o[0]&a[0])>>d,e=e?e<<c|n[0]:n[0],t+=1,i-=c}return e};class UA extends Od{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const n=Pv(t,e,i,this.basePTS,this.frameIndex);if(n!==-1)return{sample:t.samples[t.samples.length-1],length:n,missing:0}}static probe(t){if(!t)return!1;const e=Na(t,0);if(!e)return!1;const i=e.length;return t[i]===11&&t[i+1]===119&&kd(e)!==void 0&&Mv(t,i)<16}}function Pv(l,t,e,i,n){if(e+8>t.length||t[e]!==11||t[e+1]!==119)return-1;const a=t[e+4]>>6;if(a>=3)return-1;const c=[48e3,44100,32e3][a],d=t[e+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+a]*2;if(e+m>t.length)return-1;const p=t[e+6]>>5;let g=0;p===2?g+=2:(p&1&&p!==1&&(g+=2),p&4&&(g+=2));const v=(t[e+6]<<8|t[e+7])>>12-g&1,x=[2,1,2,3,3,4,4,5][p]+v,T=t[e+5]>>3,A=t[e+5]&7,b=new Uint8Array([a<<6|T<<1|A>>2,(A&3)<<6|p<<3|v<<2|d>>4,d<<4&224]),_=1536/c*9e4,I=i+n*_,C=t.subarray(e,e+m);return l.config=b,l.channelCount=x,l.samplerate=c,l.samples.push({unit:C,pts:I}),m}class $A extends Od{resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=Na(t,0);let i=e?.length||0;if(e&&t[i]===11&&t[i+1]===119&&kd(e)!==void 0&&Mv(t,i)<=16)return!1;for(let n=t.length;i<n;i++)if(Ov(t,i))return Vt.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return BA(t,e)}appendFrame(t,e,i){if(this.basePTS!==null)return Cv(t,e,i,this.basePTS,this.frameIndex)}}const jA=/\/emsg[-/]ID3/i;class GA{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,n){const a=this.videoTrack=ji("video",1),o=this.audioTrack=ji("audio",1),c=this.txtTrack=ji("text",1);if(this.id3Track=ji("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const d=Vy(t);if(d.video){const{id:f,timescale:m,codec:p,supplemental:g}=d.video;a.id=f,a.timescale=c.timescale=m,a.codec=p,a.supplemental=g}if(d.audio){const{id:f,timescale:m,codec:p}=d.audio;o.id=f,o.timescale=m,o.codec=p}c.id=Gy.text,a.sampleDuration=0,a.duration=o.duration=n}resetContiguity(){this.remainderData=null}static probe(t){return U1(t)}demux(t,e){this.timeOffset=e;let i=t;const n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Li(this.remainderData,t));const c=K1(i);this.remainderData=c.remainder,n.samples=c.valid||new Uint8Array}else n.samples=i;const o=this.extractID3Track(n,e);return a.samples=a0(e,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(e,this.timeOffset);return i.samples=a0(t,e),{videoTrack:e,audioTrack:ji(),id3Track:n,textTrack:ji()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const n=Ct(t.samples,["emsg"]);n&&n.forEach(a=>{const o=Y1(a);if(jA.test(o.schemeIdUri)){const c=H0(o,e);let d=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const f=o.payload;i.samples.push({data:f,len:f.byteLength,dts:c,pts:c,type:di.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const c=H0(o,e);i.samples.push({data:o.payload,len:o.payload.byteLength,dts:c,pts:c,type:di.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function H0(l,t){return ht(l.presentationTime)?l.presentationTime/l.timeScale:t+l.presentationTimeDelta/l.timeScale}class HA{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Ad(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,Zs.cbc)}decryptAacSample(t,e,i){const n=t[e].unit;if(n.length<=16)return;const a=n.subarray(16,n.length-n.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(o).then(c=>{const d=new Uint8Array(c);n.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}).catch(i)}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length){i();return}if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=Math.floor((t.length-48)/160)*16+16,i=new Int8Array(e);let n=0;for(let a=32;a<t.length-16;a+=160,n+=16)i.set(t.subarray(a,a+16),n);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let n=0;for(let a=32;a<t.length-16;a+=160,n+=16)t.set(i.subarray(n,n+16),a);return t}decryptAvcSample(t,e,i,n,a){const o=Yy(a.data),c=this.getAvcEncryptedData(o);this.decryptBuffer(c.buffer).then(d=>{a.data=this.getAvcDecryptedUnit(o,d),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,n)}).catch(n)}decryptAvcSamples(t,e,i,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length){n();return}const a=t[e].units;for(;!(i>=a.length);i++){const o=a[i];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(t,e,i,n,o),!this.decrypter.isSync()))return}}}}class Nv{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let i=this.VideoSample,n;if((!i||i.units.length===0)&&(i=t[t.length-1]),(e=i)!=null&&e.units){const a=i.units;n=a[a.length-1]}return n}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(t.pts===void 0){const i=e.samples,n=i.length;if(n){const a=i[n-1];t.pts=a.pts,t.dts=a.dts}else{e.dropped++;return}}e.samples.push(t)}}parseNALu(t,e,i){const n=e.byteLength;let a=t.naluState||0;const o=a,c=[];let d=0,f,m,p,g=-1,v=0;for(a===-1&&(g=0,v=this.getNALuType(e,0),a=0,d=1);d<n;){if(f=e[d++],!a){a=f?0:1;continue}if(a===1){a=f?0:2;continue}if(!f)a=3;else if(f===1){if(m=d-a-1,g>=0){const E={data:e.subarray(g,m),type:v};c.push(E)}else{const E=this.getLastNalUnit(t.samples);E&&(o&&d<=4-o&&E.state&&(E.data=E.data.subarray(0,E.data.byteLength-o)),m>0&&(E.data=Li(E.data,e.subarray(0,m)),E.state=0))}d<n?(p=this.getNALuType(e,d),g=d,v=p,a=0):a=-1}else a=0}if(g>=0&&a>=0){const E={data:e.subarray(g,n),type:v,state:a};c.push(E)}if(c.length===0){const E=this.getLastNalUnit(t.samples);E&&(E.data=Li(E.data,e))}return t.naluState=a,c}}class Da{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,n=new Uint8Array(4),a=Math.min(4,e);if(a===0)throw new Error("no bytes available");n.set(t.subarray(i,i+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(t){let e;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&Vt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!==0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class zA extends Nv{parsePES(t,e,i,n){const a=this.parseNALu(t,i.data,n);let o=this.VideoSample,c,d=!1;i.data=null,o&&a.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var m,p;switch(f.type){case 1:{let x=!1;c=!0;const T=f.data;if(d&&T.length>4){const A=this.readSliceType(T);(A===2||A===4||A===7||A===9)&&(x=!0)}if(x){var g;(g=o)!=null&&g.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.frame=!0,o.key=x;break}case 5:c=!0,(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 6:{c=!0,Sd(f.data,1,i.pts,e.samples);break}case 7:{var v,E;c=!0,d=!0;const x=f.data,T=this.readSPS(x);if(!t.sps||t.width!==T.width||t.height!==T.height||((v=t.pixelRatio)==null?void 0:v[0])!==T.pixelRatio[0]||((E=t.pixelRatio)==null?void 0:E[1])!==T.pixelRatio[1]){t.width=T.width,t.height=T.height,t.pixelRatio=T.pixelRatio,t.sps=[x];const A=x.subarray(1,4);let b="avc1.";for(let _=0;_<3;_++){let I=A[_].toString(16);I.length<2&&(I="0"+I),b+=I}t.codec=b}break}case 8:c=!0,t.pps=[f.data];break;case 9:c=!0,t.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:c=!0;break;default:c=!1;break}o&&c&&o.units.push(f)}),n&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}getNALuType(t,e){return t[e]&31}readSliceType(t){const e=new Da(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let i=8,n=8,a;for(let o=0;o<t;o++)n!==0&&(a=e.readEG(),n=(i+a+256)%256),i=n===0?i:n}readSPS(t){const e=new Da(t);let i=0,n=0,a=0,o=0,c,d,f;const m=e.readUByte.bind(e),p=e.readBits.bind(e),g=e.readUEG.bind(e),v=e.readBoolean.bind(e),E=e.skipBits.bind(e),x=e.skipEG.bind(e),T=e.skipUEG.bind(e),A=this.skipScalingList.bind(this);m();const b=m();if(p(5),E(3),m(),T(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){const P=g();if(P===3&&E(1),T(),T(),E(1),v())for(d=P!==3?8:12,f=0;f<d;f++)v()&&(f<6?A(16,e):A(64,e))}T();const _=g();if(_===0)g();else if(_===1)for(E(1),x(),x(),c=g(),f=0;f<c;f++)x();T(),E(1);const I=g(),C=g(),N=p(1);N===0&&E(1),E(1),v()&&(i=g(),n=g(),a=g(),o=g());let w=[1,1];if(v()&&v())switch(m()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:{w=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((I+1)*16-i*2-n*2),height:(2-N)*(C+1)*16-(N?2:4)*(a+o),pixelRatio:w}}}class VA extends Nv{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,i,n){const a=this.parseNALu(t,i.data,n);let o=this.VideoSample,c,d=!1;i.data=null,o&&a.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var m,p;switch(f.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),o.frame=!0,c=!0;break;case 16:case 17:case 18:case 21:if(c=!0,d){var g;(g=o)!=null&&g.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:c=!0,(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 39:c=!0,Sd(f.data,2,i.pts,e.samples);break;case 32:c=!0,t.vps||(typeof t.params!="object"&&(t.params={}),t.params=Xt(t.params,this.readVPS(f.data)),this.initVPS=f.data),t.vps=[f.data];break;case 33:if(c=!0,d=!0,t.vps!==void 0&&t.vps[0]!==this.initVPS&&t.sps!==void 0&&!this.matchSPS(t.sps[0],f.data)&&(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const v=this.readSPS(f.data);t.width=v.width,t.height=v.height,t.pixelRatio=v.pixelRatio,t.codec=v.codecString,t.sps=[],typeof t.params!="object"&&(t.params={});for(const E in v.params)t.params[E]=v.params[E]}this.pushParameterSet(t.sps,f.data,t.vps),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0;break;case 34:if(c=!0,typeof t.params=="object"){if(!t.pps){t.pps=[];const v=this.readPPS(f.data);for(const E in v)t.params[E]=v[E]}this.pushParameterSet(t.pps,f.data,t.vps)}break;case 35:c=!0,t.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:c=!1;break}o&&c&&o.units.push(f)}),n&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(t[e]&126)>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let i=0;for(let n=0;n<t.byteLength;n++)n>=2&&t[n]===3&&t[n-1]===0&&t[n-2]===0||(e[i]=t[n],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new Da(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);const i=e.readBits(3),n=e.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:n}}readSPS(t){const e=new Da(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const i=e.readBits(3);e.readBoolean();const n=e.readBits(2),a=e.readBoolean(),o=e.readBits(5),c=e.readUByte(),d=e.readUByte(),f=e.readUByte(),m=e.readUByte(),p=e.readUByte(),g=e.readUByte(),v=e.readUByte(),E=e.readUByte(),x=e.readUByte(),T=e.readUByte(),A=e.readUByte(),b=[],_=[];for(let bt=0;bt<i;bt++)b.push(e.readBoolean()),_.push(e.readBoolean());if(i>0)for(let bt=i;bt<8;bt++)e.readBits(2);for(let bt=0;bt<i;bt++)b[bt]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),_[bt]&&e.readUByte();e.readUEG();const I=e.readUEG();I==3&&e.skipBits(1);const C=e.readUEG(),N=e.readUEG(),w=e.readBoolean();let P=0,B=0,M=0,K=0;w&&(P+=e.readUEG(),B+=e.readUEG(),M+=e.readUEG(),K+=e.readUEG());const tt=e.readUEG(),H=e.readUEG(),G=e.readUEG(),Y=e.readBoolean();for(let bt=Y?0:i;bt<=i;bt++)e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.readBoolean()&&e.readBoolean())for(let pt=0;pt<4;pt++)for(let Te=0;Te<(pt===3?2:6);Te++)if(!e.readBoolean())e.readUEG();else{const oe=Math.min(64,1<<4+(pt<<1));pt>1&&e.readEG();for(let De=0;De<oe;De++)e.readEG()}e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const X=e.readUEG();let rt=0;for(let bt=0;bt<X;bt++){let pt=!1;if(bt!==0&&(pt=e.readBoolean()),pt){bt===X&&e.readUEG(),e.readBoolean(),e.readUEG();let Te=0;for(let le=0;le<=rt;le++){const oe=e.readBoolean();let De=!1;oe||(De=e.readBoolean()),(oe||De)&&Te++}rt=Te}else{const Te=e.readUEG(),le=e.readUEG();rt=Te+le;for(let oe=0;oe<Te;oe++)e.readUEG(),e.readBoolean();for(let oe=0;oe<le;oe++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const bt=e.readUEG();for(let pt=0;pt<bt;pt++){for(let Te=0;Te<G+4;Te++)e.readBits(1);e.readBits(1)}}let k=0,U=1,it=1,ut=!0,ft=1,dt=0;e.readBoolean(),e.readBoolean();let St=!1;if(e.readBoolean()){if(e.readBoolean()){const Fe=e.readUByte(),$e=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ee=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Fe>0&&Fe<16?(U=$e[Fe-1],it=ee[Fe-1]):Fe===255&&(U=e.readBits(16),it=e.readBits(16))}if(e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())),e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),St=e.readBoolean(),St&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG()),e.readBoolean()&&(ft=e.readBits(32),dt=e.readBits(32),e.readBoolean()&&e.readUEG(),e.readBoolean())){const ee=e.readBoolean(),Xi=e.readBoolean();let Ke=!1;(ee||Xi)&&(Ke=e.readBoolean(),Ke&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),Ke&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let Js=0;Js<=i;Js++){ut=e.readBoolean();const xs=ut||e.readBoolean();let Dn=!1;xs?e.readEG():Dn=e.readBoolean();const tn=Dn?1:e.readUEG()+1;if(ee)for(let Qi=0;Qi<tn;Qi++)e.readUEG(),e.readUEG(),Ke&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(Xi)for(let Qi=0;Qi<tn;Qi++)e.readUEG(),e.readUEG(),Ke&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),k=e.readUEG())}let It=C,ae=N;if(w){let bt=1,pt=1;I===1?bt=pt=2:I==2&&(bt=2),It=C-bt*B-bt*P,ae=N-pt*K-pt*M}const Se=n?["A","B","C"][n]:"",Be=c<<24|d<<16|f<<8|m;let mi=0;for(let bt=0;bt<32;bt++)mi=(mi|(Be>>bt&1)<<31-bt)>>>0;let Le=mi.toString(16);return o===1&&Le==="2"&&(Le="6"),{codecString:`hvc1.${Se}${o}.${Le}.${a?"H":"L"}${A}.B0`,params:{general_tier_flag:a,general_profile_idc:o,general_profile_space:n,general_profile_compatibility_flags:[c,d,f,m],general_constraint_indicator_flags:[p,g,v,E,x,T],general_level_idc:A,bit_depth:tt+8,bit_depth_luma_minus8:tt,bit_depth_chroma_minus8:H,min_spatial_segmentation_idc:k,chroma_format_idc:I,frame_rate:{fixed:ut,fps:dt/ft}},width:It,height:ae,pixelRatio:[U,it]}}readPPS(t){const e=new Da(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2),e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const n=e.readBoolean(),a=e.readBoolean();let o=1;return a&&n?o=0:a?o=3:n&&(o=2),{parallelismType:o}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const Ie=188;class Qs{constructor(t,e,i,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=n,this.videoParser=null}static probe(t,e){const i=Qs.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(t){const e=t.length;let i=Math.min(Ie*5,e-Ie)+1,n=0;for(;n<i;){let a=!1,o=-1,c=0;for(let d=n;d<e;d+=Ie)if(t[d]===71&&(e-d===Ie||t[d+Ie]===71)){if(c++,o===-1&&(o=d,o!==0&&(i=Math.min(o+Ie*99,t.length-Ie)+1)),a||(a=id(t,d)===0),a&&c>1&&(o===0&&c>2||d+Ie>i))return o}else{if(c)return-1;break}n++}return-1}static createTrack(t,e){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:Gy[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?e:void 0}}resetInitSegment(t,e,i,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Qs.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=Qs.createTrack("audio",n),this._id3Track=Qs.createTrack("id3"),this._txtTrack=Qs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,n=!1){i||(this.sampleAes=null);let a;const o=this._videoTrack,c=this._audioTrack,d=this._id3Track,f=this._txtTrack;let m=o.pid,p=o.pesData,g=c.pid,v=d.pid,E=c.pesData,x=d.pesData,T=null,A=this.pmtParsed,b=this._pmtId,_=t.length;if(this.remainderData&&(t=Li(this.remainderData,t),_=t.length,this.remainderData=null),_<Ie&&!n)return this.remainderData=t,{audioTrack:c,videoTrack:o,id3Track:d,textTrack:f};const I=Math.max(0,Qs.syncOffset(t));_-=(_-I)%Ie,_<t.byteLength&&!n&&(this.remainderData=new Uint8Array(t.buffer,_,t.buffer.byteLength-_));let C=0;for(let w=I;w<_;w+=Ie)if(t[w]===71){const P=!!(t[w+1]&64),B=id(t,w),M=(t[w+3]&48)>>4;let K;if(M>1){if(K=w+5+t[w+4],K===w+Ie)continue}else K=w+4;switch(B){case m:P&&(p&&(a=vr(p,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,f,a,!1)),p={data:[],size:0}),p&&(p.data.push(t.subarray(K,w+Ie)),p.size+=w+Ie-K);break;case g:if(P){if(E&&(a=vr(E,this.logger)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,a);break;case"mp3":this.parseMPEGPES(c,a);break;case"ac3":this.parseAC3PES(c,a);break}E={data:[],size:0}}E&&(E.data.push(t.subarray(K,w+Ie)),E.size+=w+Ie-K);break;case v:P&&(x&&(a=vr(x,this.logger))&&this.parseID3PES(d,a),x={data:[],size:0}),x&&(x.data.push(t.subarray(K,w+Ie)),x.size+=w+Ie-K);break;case 0:P&&(K+=t[K]+1),b=this._pmtId=KA(t,K);break;case b:{P&&(K+=t[K]+1);const tt=qA(t,K,this.typeSupported,i,this.observer,this.logger);m=tt.videoPid,m>0&&(o.pid=m,o.segmentCodec=tt.segmentVideoCodec),g=tt.audioPid,g>0&&(c.pid=g,c.segmentCodec=tt.segmentAudioCodec),v=tt.id3Pid,v>0&&(d.pid=v),T!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${w} after unknown PID '${T}'. Backtracking to sync byte @${I} to parse all TS packets.`),T=null,w=I-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=B;break}}else C++;C>0&&sd(this.observer,new Error(`Found ${C} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=p,c.pesData=E,d.pesData=x;const N={audioTrack:c,videoTrack:o,id3Track:d,textTrack:f};return n&&this.extractRemainingSamples(N),N}flush(){const{remainderData:t}=this;this.remainderData=null;let e;return t?e=this.demux(t,-1,!1,!0):e={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:n,textTrack:a}=t,o=i.pesData,c=e.pesData,d=n.pesData;let f;if(o&&(f=vr(o,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,a,f,!0),i.pesData=null)):i.pesData=o,c&&(f=vr(c,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,f);break;case"mp3":this.parseMPEGPES(e,f);break;case"ac3":this.parseAC3PES(e,f);break}e.pesData=null}else c!=null&&c.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=c;d&&(f=vr(d,this.logger))?(this.parseID3PES(n,f),n.pesData=null):n.pesData=d}demuxSampleAes(t,e,i){const n=this.demux(t,i,!0,!this.config.progressive),a=this.sampleAes=new HA(this.observer,this.config,e);return this.decrypt(n,a)}readyVideoParser(t){this.videoParser===null&&(t==="avc"?this.videoParser=new zA:t==="hevc"&&(this.videoParser=new VA))}decrypt(t,e){return new Promise(i=>{const{audioTrack:n,videoTrack:a}=t;n.samples&&n.segmentCodec==="aac"?e.decryptAacSamples(n.samples,0,()=>{a.samples?e.decryptAvcSamples(a.samples,0,0,()=>{i(t)}):i(t)}):a.samples&&e.decryptAvcSamples(a.samples,0,0,()=>{i(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0;const n=this.aacOverFlow;let a=e.data;if(n){this.aacOverFlow=null;const p=n.missing,g=n.sample.unit.byteLength;if(p===-1)a=Li(n.sample.unit,a);else{const v=g-p;n.sample.unit.set(a.subarray(0,p),v),t.samples.push(n.sample),i=n.missing}}let o,c;for(o=i,c=a.length;o<c-1&&!Go(a,o);o++);if(o!==i){let p;const g=o<c-1;if(g?p=`AAC PES did not start with ADTS header,offset:${o}`:p="No ADTS header found in AAC PES",sd(this.observer,new Error(p),g,this.logger),!g)return}Lv(t,this.observer,a,o,this.audioCodec);let d;if(e.pts!==void 0)d=e.pts;else if(n){const p=Rv(t.samplerate);d=n.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,m;for(;o<c;)if(m=_v(t,a,o,d,f),o+=m.length,m.missing){this.aacOverFlow=m;break}else for(f++;o<c-1&&!Go(a,o);o++);}parseMPEGPES(t,e){const i=e.data,n=i.length;let a=0,o=0;const c=e.pts;if(c===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<n;)if(kv(i,o)){const d=Cv(t,i,o,c,a);if(d)o+=d.length,a++;else break}else o++}parseAC3PES(t,e){{const i=e.data,n=e.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=i.length;let o=0,c=0,d;for(;c<a&&(d=Pv(t,i,c,n,o++))>0;)c+=d}}parseID3PES(t,e){if(e.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Xt({},e,{type:this._videoTrack?di.emsg:di.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function id(l,t){return((l[t+1]&31)<<8)+l[t+2]}function KA(l,t){return(l[t+10]&31)<<8|l[t+11]}function qA(l,t,e,i,n,a){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},c=(l[t+1]&15)<<8|l[t+2],d=t+3+c-4,f=(l[t+10]&15)<<8|l[t+11];for(t+=12+f;t<d;){const m=id(l,t),p=(l[t+3]&15)<<8|l[t+4];switch(l[t]){case 207:if(!i){Df("ADTS AAC",a);break}case 15:o.audioPid===-1&&(o.audioPid=m);break;case 21:o.id3Pid===-1&&(o.id3Pid=m);break;case 219:if(!i){Df("H.264",a);break}case 27:o.videoPid===-1&&(o.videoPid=m);break;case 3:case 4:!e.mpeg&&!e.mp3?a.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=m,o.segmentAudioCodec="mp3");break;case 193:if(!i){Df("AC-3",a);break}case 129:e.ac3?o.audioPid===-1&&(o.audioPid=m,o.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&p>0){let g=t+5,v=p;for(;v>2;){switch(l[g]){case 106:e.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=m,o.segmentAudioCodec="ac3");break}const x=l[g+1]+2;g+=x,v-=x}}break;case 194:case 135:return sd(n,new Error("Unsupported EC-3 in M2TS found"),void 0,a),o;case 36:o.videoPid===-1&&(o.videoPid=m,o.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}t+=p+5}return o}function sd(l,t,e,i){i.warn(`parsing error: ${t.message}`),l.emit(R.ERROR,R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:t,reason:t.message})}function Df(l,t){t.log(`${l} with AES-128-CBC encryption found in unencrypted stream`)}function vr(l,t){let e=0,i,n,a,o,c;const d=l.data;if(!l||l.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Li(d[0],d[1]),d.splice(1,1);if(i=d[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(n=(i[4]<<8)+i[5],n&&n>l.size-6)return null;const m=i[7];m&192&&(o=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,m&64?(c=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,o-c>60*9e4&&(t.warn(`${Math.round((o-c)/9e4)}s delta between PTS and DTS, align them`),o=c)):c=o),a=i[8];let p=a+9;if(l.size<=p)return null;l.size-=p;const g=new Uint8Array(l.size);for(let v=0,E=d.length;v<E;v++){i=d[v];let x=i.byteLength;if(p)if(p>x){p-=x;continue}else i=i.subarray(p),x-=p,p=0;g.set(i,e),e+=x}return n&&(n-=a+3),{data:g,pts:o,dts:c,len:n}}return null}class YA{static getSilentFrame(t,e){switch(t){case"mp4a.40.2":if(e===1)return new Uint8Array([0,200,0,128,35,128]);if(e===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(e===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(e===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(e===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(e===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(e===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const qs=Math.pow(2,32)-1;class V{static init(){V.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in V.types)V.types.hasOwnProperty(t)&&(V.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);V.HDLR_TYPES={video:e,audio:i};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);V.STTS=V.STSC=V.STCO=a,V.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),V.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),V.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),V.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);V.FTYP=V.box(V.types.ftyp,o,d,o,c),V.DINF=V.box(V.types.dinf,V.box(V.types.dref,n))}static box(t,...e){let i=8,n=e.length;const a=n;for(;n--;)i+=e[n].byteLength;const o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=i&255,o.set(t,4),n=0,i=8;n<a;n++)o.set(e[n],i),i+=e[n].byteLength;return o}static hdlr(t){return V.box(V.types.hdlr,V.HDLR_TYPES[t])}static mdat(t){return V.box(V.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(qs+1)),n=Math.floor(e%(qs+1));return V.box(V.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(t){return V.box(V.types.mdia,V.mdhd(t.timescale||0,t.duration||0),V.hdlr(t.type),V.minf(t))}static mfhd(t){return V.box(V.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?V.box(V.types.minf,V.box(V.types.smhd,V.SMHD),V.DINF,V.stbl(t)):V.box(V.types.minf,V.box(V.types.vmhd,V.VMHD),V.DINF,V.stbl(t))}static moof(t,e,i){return V.box(V.types.moof,V.mfhd(t),V.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=V.trak(t[e]);return V.box.apply(null,[V.types.moov,V.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(V.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=V.trex(t[e]);return V.box.apply(null,[V.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(qs+1)),n=Math.floor(e%(qs+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return V.box(V.types.mvhd,a)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let n,a;for(n=0;n<e.length;n++)a=e[n].flags,i[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return V.box(V.types.sdtp,i)}static stbl(t){return V.box(V.types.stbl,V.stsd(t),V.box(V.types.stts,V.STTS),V.box(V.types.stsc,V.STSC),V.box(V.types.stsz,V.STSZ),V.box(V.types.stco,V.STCO))}static avc1(t){let e=[],i=[],n,a,o;for(n=0;n<t.sps.length;n++)a=t.sps[n],o=a.byteLength,e.push(o>>>8&255),e.push(o&255),e=e.concat(Array.prototype.slice.call(a));for(n=0;n<t.pps.length;n++)a=t.pps[n],o=a.byteLength,i.push(o>>>8&255),i.push(o&255),i=i.concat(Array.prototype.slice.call(a));const c=V.box(V.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(i))),d=t.width,f=t.height,m=t.pixelRatio[0],p=t.pixelRatio[1];return V.box(V.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,V.box(V.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),V.box(V.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,e&255,0,0])}static mp4a(t){return V.box(V.types.mp4a,V.audioStsd(t),V.box(V.types.esds,V.esds(t)))}static mp3(t){return V.box(V.types[".mp3"],V.audioStsd(t))}static ac3(t){return V.box(V.types["ac-3"],V.audioStsd(t),V.box(V.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if(t.type==="audio"){if(e==="aac")return V.box(V.types.stsd,V.STSD,V.mp4a(t));if(e==="ac3"&&t.config)return V.box(V.types.stsd,V.STSD,V.ac3(t));if(e==="mp3"&&t.codec==="mp3")return V.box(V.types.stsd,V.STSD,V.mp3(t))}else if(t.pps&&t.sps){if(e==="avc")return V.box(V.types.stsd,V.STSD,V.avc1(t));if(e==="hevc"&&t.vps)return V.box(V.types.stsd,V.STSD,V.hvc1(t))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){const e=t.id,i=(t.duration||0)*(t.timescale||0),n=t.width||0,a=t.height||0,o=Math.floor(i/(qs+1)),c=Math.floor(i%(qs+1));return V.box(V.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,a>>8&255,a&255,0,0]))}static traf(t,e){const i=V.sdtp(t),n=t.id,a=Math.floor(e/(qs+1)),o=Math.floor(e%(qs+1));return V.box(V.types.traf,V.box(V.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),V.box(V.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255])),V.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,V.box(V.types.trak,V.tkhd(t),V.mdia(t))}static trex(t){const e=t.id;return V.box(V.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],n=i.length,a=12+16*n,o=new Uint8Array(a);let c,d,f,m,p,g;for(e+=8+a,o.set([t.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255],0),c=0;c<n;c++)d=i[c],f=d.duration,m=d.size,p=d.flags,g=d.cts,o.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*c);return V.box(V.types.trun,o)}static initSegment(t){V.types||V.init();const e=V.moov(t);return Li(V.FTYP,e)}static hvc1(t){const e=t.params,i=[t.vps,t.sps,t.pps],n=4,a=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),n-1|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),i.length]);let o=a.length;for(let E=0;E<i.length;E+=1){o+=3;for(let x=0;x<i[E].length;x+=1)o+=2+i[E][x].length}const c=new Uint8Array(o);c.set(a,0),o=a.length;const d=i.length-1;for(let E=0;E<i.length;E+=1){c.set(new Uint8Array([32+E|(E===d?128:0),0,i[E].length]),o),o+=3;for(let x=0;x<i[E].length;x+=1)c.set(new Uint8Array([i[E][x].length>>8,i[E][x].length&255]),o),o+=2,c.set(i[E][x],o),o+=i[E][x].length}const f=V.box(V.types.hvcC,c),m=t.width,p=t.height,g=t.pixelRatio[0],v=t.pixelRatio[1];return V.box(V.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,V.box(V.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),V.box(V.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,v>>24,v>>16&255,v>>8&255,v&255])))}}V.types=void 0;V.HDLR_TYPES=void 0;V.STTS=void 0;V.STSC=void 0;V.STCO=void 0;V.STSZ=void 0;V.VMHD=void 0;V.SMHD=void 0;V.STSD=void 0;V.FTYP=void 0;V.DINF=void 0;const Bv=9e4;function Pd(l,t,e=1,i=!1){const n=l*t*e;return i?Math.round(n):n}function XA(l,t,e=1,i=!1){return Pd(l,t,1/e,i)}function Ra(l,t=!1){return Pd(l,1e3,1/Bv,t)}function QA(l,t=1){return Pd(l,Bv,1/t)}function z0(l){const{baseTime:t,timescale:e,trackId:i}=l;return`${t/e} (${t}/${e}) trackId: ${i}`}const WA=10*1e3,ZA=1024,JA=1152,tL=1536;let Er=null,Cf=null;function V0(l,t,e,i){return{duration:t,size:e,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:l?2:1,isNonSync:l?0:1}}}class _o extends Ri{constructor(t,e,i,n){if(super("mp4-remuxer",n),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,Er===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Er=o?parseInt(o[1]):0}if(Cf===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);Cf=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){const e=this._initPTS;(!e||!t||t.trackId!==e.trackId||t.baseTime!==e.baseTime||t.timescale!==e.timescale)&&this.log(`Reset initPTS: ${e&&z0(e)} > ${t&&z0(t)}`),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t[0].pts,n=t.reduce((a,o)=>{let c=o.pts,d=c-a;return d<-4294967296&&(e=!0,c=fi(c,i),d=c-a),d>0?a:c},i);return e&&this.debug("PTS rollover detected"),n}remux(t,e,i,n,a,o,c,d){let f,m,p,g,v,E,x=a,T=a;const A=t.pid>-1,b=e.pid>-1,_=e.samples.length,I=t.samples.length>0,C=c&&_>0||_>1;if((!A||I)&&(!b||C)||this.ISGenerated||c){if(this.ISGenerated){var w,P,B,M;const G=this.videoTrackConfig;(G&&(e.width!==G.width||e.height!==G.height||((w=e.pixelRatio)==null?void 0:w[0])!==((P=G.pixelRatio)==null?void 0:P[0])||((B=e.pixelRatio)==null?void 0:B[1])!==((M=G.pixelRatio)==null?void 0:M[1]))||!G&&C||this.nextAudioTs===null&&I)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(t,e,a,o));const K=this.isVideoContiguous;let tt=-1,H;if(C&&(tt=eL(e.samples),!K&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,tt>0){this.warn(`Dropped ${tt} out of ${_} video samples due to a missing keyframe`);const G=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(tt),e.dropped+=tt,T+=(e.samples[0].pts-G)/e.inputTimeScale,H=T}else tt===-1&&(this.warn(`No keyframe found out of ${_} video samples`),E=!1);if(this.ISGenerated){if(I&&C){const G=this.getVideoStartPts(e.samples),O=(fi(t.samples[0].pts,G)-G)/e.inputTimeScale;x+=Math.max(0,O),T+=Math.max(0,-O)}if(I){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(t,e,a,o)),m=this.remuxAudio(t,x,this.isAudioContiguous,o,b||C||d===mt.AUDIO?T:void 0),C){const G=m?m.endPTS-m.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(t,e,a,o)),f=this.remuxVideo(e,T,K,G)}}else C&&(f=this.remuxVideo(e,T,K,0));f&&(f.firstKeyFrame=tt,f.independent=tt!==-1,f.firstKeyFramePTS=H)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(v=Fv(i,a,this._initPTS,this._initDTS)),n.samples.length&&(g=Uv(n,a,this._initPTS))),{audio:m,video:f,initSegment:p,independent:E,text:g,id3:v}}computeInitPts(t,e,i,n){const a=Math.round(i*e);let o=fi(t,a);if(o<a+e)for(this.log(`Adjusting PTS for rollover in timeline near ${(a-o)/e} ${n}`);o<a+e;)o+=8589934592;return o-a}generateIS(t,e,i,n){const a=t.samples,o=e.samples,c=this.typeSupported,d={},f=this._initPTS;let m=!f||n,p="audio/mp4",g,v,E,x=-1;if(m&&(g=v=1/0),t.config&&a.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":c.mpeg?(p="audio/mpeg",t.codec=""):c.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}d.audio={id:"audio",container:p,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):V.initSegment([t]),metadata:{channelCount:t.channelCount}},m&&(x=t.id,E=t.inputTimeScale,!f||E!==f.timescale?g=v=this.computeInitPts(a[0].pts,E,i,"audio"):m=!1)}if(e.sps&&e.pps&&o.length){if(e.timescale=e.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:V.initSegment([e]),metadata:{width:e.width,height:e.height}},m)if(x=e.id,E=e.inputTimeScale,!f||E!==f.timescale){const T=this.getVideoStartPts(o),A=fi(o[0].dts,T),b=this.computeInitPts(A,E,i,"video"),_=this.computeInitPts(T,E,i,"video");v=Math.min(v,b),g=Math.min(g,_)}else m=!1;this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,m?(f&&this.warn(`Timestamps at playlist time: ${n?"":"~"}${i} ${g/E} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${g/E} (${g}/${E}) trackId: ${x}`),this._initPTS={baseTime:g,timescale:E,trackId:x},this._initDTS={baseTime:v,timescale:E,trackId:x}):g=E=void 0,{tracks:d,initPTS:g,timescale:E,trackId:x}}remuxVideo(t,e,i,n){const a=t.inputTimeScale,o=t.samples,c=[],d=o.length,f=this._initPTS,m=f.baseTime*a/f.timescale;let p=this.nextVideoTs,g=8,v=this.videoSampleDuration,E,x,T=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,b=!1;if(!i||p===null){const k=m+e*a,U=o[0].pts-fi(o[0].dts,o[0].pts);Er&&p!==null&&Math.abs(k-U-(p+m))<15e3?i=!0:p=k-U-m}const _=p+m;for(let k=0;k<d;k++){const U=o[k];U.pts=fi(U.pts,_),U.dts=fi(U.dts,_),U.dts<o[k>0?k-1:k].dts&&(b=!0)}b&&o.sort(function(k,U){const it=k.dts-U.dts,ut=k.pts-U.pts;return it||ut}),E=o[0].dts,x=o[o.length-1].dts;const I=x-E,C=I?Math.round(I/(d-1)):v||t.inputTimeScale/30;if(i){const k=E-_,U=k>C,it=k<-1;if((U||it)&&(U?this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Ra(k,!0)} ms (${k}dts) hole between fragments detected at ${e.toFixed(3)}`):this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Ra(-k,!0)} ms (${k}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!it||_>=o[0].pts||Er)){E=_;const ut=o[0].pts-k;if(U)o[0].dts=E,o[0].pts=ut;else{let ft=!0;for(let dt=0;dt<o.length&&!(o[dt].dts>ut&&ft);dt++){const St=o[dt].pts;if(o[dt].dts-=k,o[dt].pts-=k,dt<o.length-1){const Dt=o[dt+1].pts,It=o[dt].pts,ae=Dt<=It,Se=Dt<=St;ft=ae==Se}}}this.log(`Video: Initial PTS/DTS adjusted: ${Ra(ut,!0)}/${Ra(E,!0)}, delta: ${Ra(k,!0)} ms`)}}E=Math.max(0,E);let N=0,w=0,P=E;for(let k=0;k<d;k++){const U=o[k],it=U.units,ut=it.length;let ft=0;for(let dt=0;dt<ut;dt++)ft+=it[dt].data.length;w+=ft,N+=ut,U.length=ft,U.dts<P?(U.dts=P,P+=C/4|0||1):P=U.dts,T=Math.min(U.pts,T),A=Math.max(U.pts,A)}x=o[d-1].dts;const B=w+4*N+8;let M;try{M=new Uint8Array(B)}catch(k){this.observer.emit(R.ERROR,R.ERROR,{type:vt.MUX_ERROR,details:q.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:B,reason:`fail allocating video mdat ${B}`});return}const K=new DataView(M.buffer);K.setUint32(0,B),M.set(V.types.mdat,4);let tt=!1,H=Number.POSITIVE_INFINITY,G=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let k=0;k<d;k++){const U=o[k],it=U.units;let ut=0;for(let St=0,Dt=it.length;St<Dt;St++){const It=it[St],ae=It.data,Se=It.data.byteLength;K.setUint32(g,Se),g+=4,M.set(ae,g),g+=Se,ut+=4+Se}let ft;if(k<d-1)v=o[k+1].dts-U.dts,ft=o[k+1].pts-U.pts;else{const St=this.config,Dt=k>0?U.dts-o[k-1].dts:C;if(ft=k>0?U.pts-o[k-1].pts:C,St.stretchShortVideoTrack&&this.nextAudioTs!==null){const It=Math.floor(St.maxBufferHole*a),ae=(n?T+n*a:this.nextAudioTs+m)-U.pts;ae>It?(v=ae-Dt,v<0?v=Dt:tt=!0,this.log(`It is approximately ${ae/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=Dt}else v=Dt}const dt=Math.round(U.pts-U.dts);H=Math.min(H,v),Y=Math.max(Y,v),G=Math.min(G,ft),O=Math.max(O,ft),c.push(V0(U.key,v,ut,dt))}if(c.length){if(Er){if(Er<70){const k=c[0].flags;k.dependsOn=2,k.isNonSync=0}}else if(Cf&&O-G<Y-H&&C/Y<.025&&c[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let k=E;for(let U=0,it=c.length;U<it;U++){const ut=k+c[U].duration,ft=k+c[U].cts;if(U<it-1){const dt=ut+c[U+1].cts;c[U].duration=dt-ft}else c[U].duration=U?c[U-1].duration:C;c[U].cts=0,k=ut}}}v=tt||!v?C:v;const j=x+v;this.nextVideoTs=p=j-m,this.videoSampleDuration=v,this.isVideoContiguous=!0;const ct={data1:V.moof(t.sequenceNumber++,E,Xt(t,{samples:c})),data2:M,startPTS:(T-m)/a,endPTS:(A+v-m)/a,startDTS:(E-m)/a,endDTS:p/a,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:t.dropped};return t.samples=[],t.dropped=0,ct}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return JA;case"ac3":return tL;default:return ZA}}remuxAudio(t,e,i,n,a){const o=t.inputTimeScale,c=t.samplerate?t.samplerate:o,d=o/c,f=this.getSamplesPerFrame(t),m=f*d,p=this._initPTS,g=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],E=a!==void 0;let x=t.samples,T=g?0:8,A=this.nextAudioTs||-1;const b=p.baseTime*o/p.timescale,_=b+e*o;if(this.isAudioContiguous=i=i||x.length&&A>0&&(n&&Math.abs(_-(A+b))<9e3||Math.abs(fi(x[0].pts,_)-(A+b))<20*m),x.forEach(function(O){O.pts=fi(O.pts,_)}),!i||A<0){const O=x.length;if(x=x.filter(j=>j.pts>=0),O!==x.length&&this.warn(`Removed ${x.length-O} of ${O} samples (initPTS ${b} / ${o})`),!x.length)return;a===0?A=0:n&&!E?A=Math.max(0,_-b):A=x[0].pts-b}if(t.segmentCodec==="aac"){const O=this.config.maxAudioFramesDrift;for(let j=0,X=A+b;j<x.length;j++){const rt=x[j],ct=rt.pts,k=ct-X,U=Math.abs(1e3*k/o);if(k<=-O*m&&E)j===0&&(this.warn(`Audio frame @ ${(ct/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*k/o)} ms.`),this.nextAudioTs=A=ct-b,X=ct);else if(k>=O*m&&U<WA&&E){let it=Math.round(k/m);for(X=ct-it*m;X<0&&it&&m;)it--,X+=m;j===0&&(this.nextAudioTs=A=X-b),this.warn(`Injecting ${it} audio frames @ ${((X-b)/o).toFixed(3)}s due to ${Math.round(1e3*k/o)} ms gap.`);for(let ut=0;ut<it;ut++){let ft=YA.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);ft||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ft=rt.unit.subarray()),x.splice(j,0,{unit:ft,pts:X}),X+=m,j++}}rt.pts=X,X+=m}}let I=null,C=null,N,w=0,P=x.length;for(;P--;)w+=x[P].unit.byteLength;for(let O=0,j=x.length;O<j;O++){const X=x[O],rt=X.unit;let ct=X.pts;if(C!==null){const U=v[O-1];U.duration=Math.round((ct-C)/d)}else if(i&&t.segmentCodec==="aac"&&(ct=A+b),I=ct,w>0){w+=T;try{N=new Uint8Array(w)}catch(U){this.observer.emit(R.ERROR,R.ERROR,{type:vt.MUX_ERROR,details:q.REMUX_ALLOC_ERROR,fatal:!1,error:U,bytes:w,reason:`fail allocating audio mdat ${w}`});return}g||(new DataView(N.buffer).setUint32(0,w),N.set(V.types.mdat,4))}else return;N.set(rt,T);const k=rt.byteLength;T+=k,v.push(V0(!0,f,k,0)),C=ct}const B=v.length;if(!B)return;const M=v[v.length-1];A=C-b,this.nextAudioTs=A+d*M.duration;const K=g?new Uint8Array(0):V.moof(t.sequenceNumber++,I/d,Xt({},t,{samples:v}));t.samples=[];const tt=(I-b)/o,H=A/o,Y={data1:K,data2:N,startPTS:tt,endPTS:H,startDTS:tt,endDTS:H,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,Y}}function fi(l,t){let e;if(t===null)return l;for(t<l?e=-8589934592:e=8589934592;Math.abs(l-t)>4294967296;)l+=e;return l}function eL(l){for(let t=0;t<l.length;t++)if(l[t].key)return t;return-1}function Fv(l,t,e,i){const n=l.samples.length;if(!n)return;const a=l.inputTimeScale;for(let c=0;c<n;c++){const d=l.samples[c];d.pts=fi(d.pts-e.baseTime*a/e.timescale,t*a)/a,d.dts=fi(d.dts-i.baseTime*a/i.timescale,t*a)/a}const o=l.samples;return l.samples=[],{samples:o}}function Uv(l,t,e){const i=l.samples.length;if(!i)return;const n=l.inputTimeScale;for(let o=0;o<i;o++){const c=l.samples[o];c.pts=fi(c.pts-e.baseTime*n/e.timescale,t*n)/n}l.samples.sort((o,c)=>o.pts-c.pts);const a=l.samples;return l.samples=[],{samples:a}}class iL extends Ri{constructor(t,e,i,n){super("passthrough-remuxer",n),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,i,n){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(t,n),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:i,videoCodec:n}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:a,video:o}=this.initData=Vy(t);if(e)H1(t,e);else{const d=a||o;d!=null&&d.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${d.codec}")!`)}a&&(i=K0(a,Wt.AUDIO,this)),o&&(n=K0(o,Wt.VIDEO,this));const c={};a&&o?c.audiovideo={container:"video/mp4",codec:i+","+n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:t,id:"main"}:a?c.audio={container:"audio/mp4",codec:i,encrypted:a.encrypted,initSegment:t,id:"audio"}:o?c.video={container:"video/mp4",codec:n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=c}remux(t,e,i,n,a,o){var c,d;let{initPTS:f,lastEndTime:m}=this;const p={audio:void 0,video:void 0,text:n,id3:i,initSegment:void 0};ht(m)||(m=this.lastEndTime=a||0);const g=e.samples;if(!g.length)return p;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let E=this.initData;if((c=E)!=null&&c.length||(this.generateInitSegment(g),E=this.initData),!((d=E)!=null&&d.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const x=V1(g,E,this),T=E.audio?x[E.audio.id]:null,A=E.video?x[E.video.id]:null,b=ho(A,1/0),_=ho(T,1/0),I=ho(A,0,!0),C=ho(T,0,!0);let N=a,w=0;const P=T&&(!A||!f&&_<b||f&&f.trackId===E.audio.id),B=P?T:A;if(B){const X=B.timescale,rt=B.start-a*X,ct=P?E.audio.id:E.video.id;N=B.start/X,w=P?C-_:I-b,(o||!f)&&(sL(f,N,a,w)||X!==f.timescale)&&(f&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${a} ${rt/X} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${N-a} (${rt}/${X}) trackId: ${ct}`),f=null,v.initPTS=rt,v.timescale=X,v.trackId=ct)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);f?(v.initPTS=f.baseTime,v.timescale=f.timescale,v.trackId=f.trackId):((!v.timescale||v.trackId===void 0||v.initPTS===void 0)&&(this.warn("Could not set initPTS"),v.initPTS=N,v.timescale=1,v.trackId=-1),this.initPTS=f={baseTime:v.initPTS,timescale:v.timescale,trackId:v.trackId});const M=N-f.baseTime/f.timescale,K=M+w;w>0?this.lastEndTime=K:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const tt=!!E.audio,H=!!E.video;let G="";tt&&(G+="audio"),H&&(G+="video");const Y=(E.audio?E.audio.encrypted:!1)||(E.video?E.video.encrypted:!1),O={data1:g,startPTS:M,startDTS:M,endPTS:K,endDTS:K,type:G,hasAudio:tt,hasVideo:H,nb:1,dropped:0,encrypted:Y};p.audio=tt&&!H?O:void 0,p.video=H?O:void 0;const j=A?.sampleCount;if(j){const X=A.keyFrameIndex,rt=X!==-1;O.nb=j,O.dropped=X===0||this.isVideoContiguous?0:rt?X:j,O.independent=rt,O.firstKeyFrame=X,rt&&A.keyFrameStart&&(O.firstKeyFramePTS=(A.keyFrameStart-f.baseTime)/f.timescale),this.isVideoContiguous||(p.independent=rt),this.isVideoContiguous||(this.isVideoContiguous=rt),O.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${X}/${j} dropped: ${O.dropped} start: ${O.firstKeyFramePTS||"NA"}`)}return p.initSegment=v,p.id3=Fv(i,a,f,f),n.samples.length&&(p.text=Uv(n,a,f)),p}}function ho(l,t,e=!1){return l?.start!==void 0?(l.start+(e?l.duration:0))/l.timescale:t}function sL(l,t,e,i){if(l===null)return!0;const n=Math.max(i,1),a=t-l.baseTime/l.timescale;return Math.abs(a-e)>n}function K0(l,t,e){const i=l.codec;return i&&i.length>4?i:t===Wt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?Mo(i,!1):(e.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(e.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let vs;try{vs=self.performance.now.bind(self.performance)}catch{vs=Date.now}const Io=[{demux:GA,remux:iL},{demux:Qs,remux:_o},{demux:FA,remux:_o},{demux:$A,remux:_o}];Io.splice(2,0,{demux:UA,remux:_o});class q0{constructor(t,e,i,n,a,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=a,this.logger=o}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,n){const a=i.transmuxing;a.executeStart=vs();let o=new Uint8Array(t);const{currentTransmuxState:c,transmuxConfig:d}=this;n&&(this.currentTransmuxState=n);const{contiguous:f,discontinuity:m,trackSwitch:p,accurateTimeOffset:g,timeOffset:v,initSegmentChange:E}=n||c,{audioCodec:x,videoCodec:T,defaultInitPts:A,duration:b,initSegmentData:_}=d,I=nL(o,e);if(I&&Ar(I.method)){const P=this.getDecrypter(),B=Rd(I.method);if(P.isSync()){let M=P.softwareDecrypt(o,I.key.buffer,I.iv.buffer,B);if(i.part>-1){const tt=P.flush();M=tt&&tt.buffer}if(!M)return a.executeEnd=vs(),wf(i);o=new Uint8Array(M)}else return this.asyncResult=!0,this.decryptionPromise=P.webCryptoDecrypt(o,I.key.buffer,I.iv.buffer,B).then(M=>{const K=this.push(M,null,i);return this.decryptionPromise=null,K}),this.decryptionPromise}const C=this.needsProbing(m,p);if(C){const P=this.configureTransmuxer(o);if(P)return this.logger.warn(`[transmuxer] ${P.message}`),this.observer.emit(R.ERROR,R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),a.executeEnd=vs(),wf(i)}(m||p||E||C)&&this.resetInitSegment(_,x,T,b,e),(m||E||C)&&this.resetInitialTimestamp(A),f||this.resetContiguity();const N=this.transmux(o,I,v,g,i);this.asyncResult=Ba(N);const w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,a.executeEnd=vs(),N}flush(t){const e=t.transmuxing;e.executeStart=vs();const{decrypter:i,currentTransmuxState:n,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(t));const o=[],{timeOffset:c}=n;if(i){const p=i.flush();p&&o.push(this.push(p.buffer,null,t))}const{demuxer:d,remuxer:f}=this;if(!d||!f){e.executeEnd=vs();const p=[wf(t)];return this.asyncResult?Promise.resolve(p):p}const m=d.flush(c);return Ba(m)?(this.asyncResult=!0,m.then(p=>(this.flushRemux(o,p,t),o))):(this.flushRemux(o,m,t),this.asyncResult?Promise.resolve(o):o)}flushRemux(t,e,i){const{audioTrack:n,videoTrack:a,id3Track:o,textTrack:c}=e,{accurateTimeOffset:d,timeOffset:f}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===mt.MAIN?"level":"track"} ${i.level}`);const m=this.remuxer.remux(n,a,o,c,f,d,!0,this.id);t.push({remuxResult:m,chunkMeta:i}),i.transmuxing.executeEnd=vs()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;!e||!i||(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;!t||!e||(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,n,a){const{demuxer:o,remuxer:c}=this;!o||!c||(o.resetInitSegment(t,e,i,n),c.resetInitSegment(t,e,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,n,a){let o;return e&&e.method==="SAMPLE-AES"?o=this.transmuxSampleAes(t,e,i,n,a):o=this.transmuxUnencrypted(t,i,n,a),o}transmuxUnencrypted(t,e,i,n){const{audioTrack:a,videoTrack:o,id3Track:c,textTrack:d}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,o,c,d,e,i,!1,this.id),chunkMeta:n}}transmuxSampleAes(t,e,i,n,a){return this.demuxer.demuxSampleAes(t,e,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,n,!1,this.id),chunkMeta:a}))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:n}=this;let a;for(let p=0,g=Io.length;p<g;p++){var o;if((o=Io[p].demux)!=null&&o.probe(t,this.logger)){a=Io[p];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,d=this.remuxer,f=a.remux,m=a.demux;(!d||!(d instanceof f))&&(this.remuxer=new f(i,e,n,this.logger)),(!c||!(c instanceof m))&&(this.demuxer=new m(i,e,n,this.logger),this.probe=m.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Ad(this.config)),t}}function nL(l,t){let e=null;return l.byteLength>0&&t?.key!=null&&t.iv!==null&&t.method!=null&&(e=t),e}const wf=l=>({remuxResult:{},chunkMeta:l});function Ba(l){return"then"in l&&l.then instanceof Function}class rL{constructor(t,e,i,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=n,this.defaultInitPts=a||null}}class aL{constructor(t,e,i,n,a,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=n,this.timeOffset=a,this.initSegmentChange=o}}let Y0=0;class $v{constructor(t,e,i,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Y0++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const f=d.data,m=this.hls;if(!(!m||!(f!=null&&f.event)||f.instanceNo!==this.instanceNo))switch(f.event){case"init":{var p;const g=(p=this.workerContext)==null?void 0:p.objectURL;g&&self.URL.revokeObjectURL(g);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":{m.logger[f.data.logType]&&m.logger[f.data.logType](f.data.message);break}default:{f.data=f.data||{},f.data.frag=this.frag,f.data.part=this.part,f.data.id=this.id,m.trigger(f.event,f.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})};const a=t.config;this.hls=t,this.id=e,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;const o=(d,f)=>{f=f||{},f.frag=this.frag||void 0,d===R.ERROR&&(f=f,f.parent=this.id,f.part=this.part,this.error=f.error),this.hls.trigger(d,f)};this.observer=new Dd,this.observer.on(R.FRAG_DECRYPTED,o),this.observer.on(R.ERROR,o);const c=u0(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(a.workerPath||cA()){try{a.workerPath?(d.log(`loading Web Worker ${a.workerPath} for "${e}"`),this.workerContext=dA(a.workerPath)):(d.log(`injecting Web Worker for "${e}"`),this.workerContext=fA());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:e,config:Zt(a)})}catch(m){d.warn(`Error setting up "${e}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new q0(this.observer,c,a,"",e,t.logger)}return}}this.transmuxer=new q0(this.observer,c,a,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=Y0++;const e=this.hls.config,i=u0(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:Zt(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),hA(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,n,a,o,c,d,f,m){var p,g;f.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:E}=this,x=o?o.start:a.start,T=a.decryptdata,A=this.frag,b=!(A&&a.cc===A.cc),_=!(A&&f.level===A.level),I=A?f.sn-A.sn:-1,C=this.part?f.part-this.part.index:-1,N=I===0&&f.id>1&&f.id===A?.stats.chunkCount,w=!_&&(I===1||I===0&&(C===1||N&&C<=0)),P=self.performance.now();(_||I||a.stats.parsing.start===0)&&(a.stats.parsing.start=P),o&&(C||!w)&&(o.stats.parsing.start=P);const B=!(A&&((p=a.initSegment)==null?void 0:p.url)===((g=A.initSegment)==null?void 0:g.url)),M=new aL(b,w,d,_,x,B);if(!w||b||B){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${f.sn}${f.part>-1?" part: "+f.part:""} ${this.id===mt.MAIN?"level":"track"}: ${f.level} id: ${f.id}
        discontinuity: ${b}
        trackSwitch: ${_}
        contiguous: ${w}
        accurateTimeOffset: ${d}
        timeOffset: ${x}
        initSegmentChange: ${B}`);const K=new rL(i,n,e,c,m);this.configureTransmuxer(K)}if(this.frag=a,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:t,decryptdata:T,chunkMeta:f,state:M},t instanceof ArrayBuffer?[t]:[]);else if(E){const K=E.push(t,T,f,M);Ba(K)?K.then(tt=>{this.handleTransmuxComplete(tt)}).catch(tt=>{this.transmuxerError(tt,f,"transmuxer-interface push error")}):this.handleTransmuxComplete(K)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){const n=i.flush(t);Ba(n)?n.then(a=>{this.handleFlushResult(a,t)}).catch(a=>{this.transmuxerError(a,t,"transmuxer-interface flush error")}):this.handleFlushResult(n,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}const X0=100;class lL extends Id{constructor(t,e,i){super(t,e,i,"audio-stream-controller",mt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(R.LEVEL_LOADED,this.onLevelLoaded,this),t.on(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(R.BUFFER_RESET,this.onBufferReset,this),t.on(R.BUFFER_CREATED,this.onBufferCreated,this),t.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(R.FRAG_LOADING,this.onFragLoading,this),t.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(R.LEVEL_LOADED,this.onLevelLoaded,this),t.off(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(R.BUFFER_RESET,this.onBufferReset,this),t.off(R.BUFFER_CREATED,this.onBufferCreated,this),t.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(R.FRAG_LOADING,this.onFragLoading,this),t.off(R.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:i,initPTS:n,timescale:a,trackId:o}){if(i===mt.MAIN){const c=e.cc,d=this.fragCurrent;if(this.initPTS[c]={baseTime:n,timescale:a,trackId:o},this.log(`InitPTS for cc: ${c} found from main: ${n/a} (${n}/${a}) trackId: ${o}`),this.mainAnchor=e,this.state===nt.WAITING_INIT_PTS){const f=this.waitingData;(!f&&!this.loadingParts||f&&f.frag.cc!==c)&&this.syncWithAnchor(e,f?.frag)}else!this.hls.hasEnoughToStart&&d&&d.cc!==c?(d.abortRequests(),this.syncWithAnchor(e,d)):this.state===nt.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var i;const n=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(e&&n?.cc===e.cc)return;const a=(n||t).cc,o=this.getLevelDetails(),c=this.getLoadPosition(),d=iv(o,a,c);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===nt.IDLE&&this.doTickIdle())}startLoad(t,e){if(!this.levels){this.startPosition=t,this.state=nt.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(X0),i>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=nt.IDLE):this.state=nt.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case nt.IDLE:this.doTickIdle();break;case nt.WAITING_TRACK:{const{levels:t,trackId:e}=this,i=t?.[e],n=i?.details;if(n&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(n))break;this.state=nt.WAITING_INIT_PTS}break}case nt.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case nt.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:e,part:i,cache:n,complete:a}=t,o=this.mainAnchor;if(this.initPTS[e.cc]!==void 0){this.waitingData=null,this.state=nt.FRAG_LOADING;const c=n.flush().buffer,d={frag:e,part:i,payload:c,networkDetails:null};this._handleFragmentLoadProgress(d),a&&super._handleFragmentLoadComplete(d)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state=nt.IDLE}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;t!=null&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:i,media:n,trackId:a}=this,o=e.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(i!=null&&i[a]))return;const c=i[a],d=c.details;if(!d||this.waitForLive(c)||this.waitForCdnTuneIn(d)){this.state=nt.WAITING_TRACK,this.startFragRequested=!1;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,Wt.AUDIO,mt.AUDIO));const m=this.getFwdBufferInfo(f,mt.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,d)){e.trigger(R.BUFFER_EOS,{type:"audio"}),this.state=nt.ENDED;return}const p=m.len,g=e.maxBufferLength,v=d.fragments,E=v[0].start,x=this.getLoadPosition(),T=this.flushing?x:m.end;if(this.switchingTrack&&n){const _=x;d.PTSKnown&&_<E&&(m.end>E||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=E+.05)}if(p>=g&&!this.switchingTrack&&T<v[v.length-1].start)return;let A=this.getNextFragment(T,d);if(A&&this.isLoopLoading(A,T)&&(A=this.getNextFragmentLoopLoading(A,d,m,mt.MAIN,g)),!A){this.bufferFlushed=!0;return}let b=((t=this.mainFragLoading)==null?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&Ee(A)&&!A.endList&&(!d.live||!this.loadingParts&&T<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===Ae.OK&&(this.mainFragLoading=b=null),b&&Ee(b))){if(A.start>b.end){const I=this.fragmentTracker.getFragAtPos(T,mt.MAIN);I&&I.end>b.end&&(b=I,this.mainFragLoading={frag:I,targetBufferTime:null})}if(A.start>b.end)return}this.loadFragment(A,c,T)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(i=>new Ma(i))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==nt.STOPPED&&(this.setInterval(X0),this.state=nt.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(R.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;const{levels:n}=this,{details:a,id:o,groupId:c,track:d}=e;if(!n){this.warn(`Audio tracks reset while loading track ${o} "${d.name}" of "${c}"`);return}const f=this.mainDetails;if(!f||a.endCC>f.endCC||f.expired){this.cachedTrackLoadedData=e,this.state!==nt.STOPPED&&(this.state=nt.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${d.name}" of "${c}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const m=n[o];let p=0;if(a.live||(i=m.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(m.details){var g;p=this.alignPlaylists(a,m.details,(g=this.levelLastLoaded)==null?void 0:g.details)}a.alignedSliding||(Sv(a,f),a.alignedSliding||jo(a,f),p=a.fragmentStart)}m.details=a,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(f,p),this.hls.trigger(R.AUDIO_TRACK_UPDATED,{details:a,id:o,groupId:e.groupId}),this.state===nt.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=nt.IDLE),this.tick()}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:n,payload:a}=t,{config:o,trackId:c,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const f=d[c];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const m=f.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const p=o.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let g=this.transmuxer;g||(g=this.transmuxer=new $v(this.hls,mt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[i.cc],E=(e=i.initSegment)==null?void 0:e.data;if(v!==void 0){const T=n?n.index:-1,A=T!==-1,b=new Ld(i.level,i.sn,i.stats.chunkCount,a.byteLength,T,A);g.push(a,E,p,"",i,n,m.totalduration,!1,b,v)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${m.startSN} ,${m.endSN}],track ${c}`);const{cache:x}=this.waitingData=this.waitingData||{frag:i,part:n,cache:new Tv,complete:!1};x.push(new Uint8Array(a)),this.state!==nt.STOPPED&&(this.state=nt.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===mt.MAIN&&Ee(e.frag)&&(this.mainFragLoading=e,this.state===nt.IDLE&&this.tick())}onFragBuffered(t,e){const{frag:i,part:n}=e;if(i.type!==mt.AUDIO){!this.audioOnly&&i.type===mt.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Ee(i)){this.fragPrevious=i;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(R.AUDIO_TRACK_SWITCHED,zt({},a)))}this.fragBufferedComplete(i,n),this.media&&this.tick()}onError(t,e){var i;if(e.fatal){this.state=nt.ERROR;return}switch(e.details){case q.FRAG_GAP:case q.FRAG_PARSING_ERROR:case q.FRAG_DECRYPT_ERROR:case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.AUDIO,e);break;case q.AUDIO_TRACK_LOAD_ERROR:case q.AUDIO_TRACK_LOAD_TIMEOUT:case q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===nt.WAITING_TRACK&&((i=e.context)==null?void 0:i.type)===wt.AUDIO_TRACK&&(this.state=nt.IDLE);break;case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case q.BUFFER_FULL_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onBufferFlushing(t,{type:e}){e!==Wt.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==Wt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===nt.ENDED&&(this.state=nt.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,e,mt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:n}=this,{remuxResult:a,chunkMeta:o}=t,c=this.getCurrentContext(o);if(!c){this.resetWhenMissingContext(o);return}const{frag:d,part:f,level:m}=c,{details:p}=m,{audio:g,text:v,id3:E,initSegment:x}=a;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=nt.PARSING,this.switchingTrack&&g&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const T=d.initSegment||d;if(this.unhandledEncryptionError(x,d))return;this._bufferInitSegment(m,x.tracks,T,o),n.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:i,tracks:x.tracks})}if(g){const{startPTS:T,endPTS:A,startDTS:b,endDTS:_}=g;f&&(f.elementaryStreams[Wt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:_}),d.setElementaryStreamInfo(Wt.AUDIO,T,A,b,_),this.bufferFragmentData(g,d,f,o)}if(E!=null&&(e=E.samples)!=null&&e.length){const T=Xt({id:i,frag:d,details:p},E);n.trigger(R.FRAG_PARSING_METADATA,T)}if(v){const T=Xt({id:i,frag:d,details:p},v);n.trigger(R.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(t,e,i,n){if(this.state!==nt.PARSING||(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio))return;const a=e.audio;a.id=mt.AUDIO;const o=t.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${o}/${a.codec}]`),o&&o.split(",").length===1&&(a.levelCodec=o),this.hls.trigger(R.BUFFER_CODECS,e);const c=a.initSegment;if(c!=null&&c.byteLength){const d={type:"audio",frag:i,part:null,chunkMeta:n,parent:i.type,data:c};this.hls.trigger(R.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(t,e,i){const n=this.fragmentTracker.getState(t);if(this.switchingTrack||n===Ae.NOT_LOADED||n===Ae.PARTIAL){var a;if(!Ee(t))this._loadInitSegment(t,e);else if((a=e.details)!=null&&a.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=nt.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==e.details.fragmentStart&&jo(e.details,o)}else super.loadFragment(t,e,i)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:i,assocLang:n,characteristics:a,audioCodec:o,channels:c}=this.bufferedTrack;Ln({name:e,lang:i,assocLang:n,characteristics:a,audioCodec:o,channels:c},t,bn)||(No(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(R.AUDIO_TRACK_SWITCHED,zt({},t))}}class Nd extends Ri{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const n=e?.renditionReports;if(n){let a=-1;for(let o=0;o<n.length;o++){const c=n[o];let d;try{d=new self.URL(c.URI,e.url).href}catch(f){this.warn(`Could not construct new URL for Rendition Report: ${f}`),d=c.URI||""}if(d===t){a=o;break}else d===t.substring(0,d.length)&&(a=o)}if(a!==-1){const o=n[a],c=parseInt(o["LAST-MSN"])||e.lastPartSn;let d=parseInt(o["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(e.age-e.partTarget,e.targetduration);d>=0&&m>e.partTarget&&(d+=1)}const f=i&&c0(i);return new f0(c,d>=0?d:void 0,f)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){const{details:n,stats:a}=e,o=self.performance.now(),c=a.loading.first?Math.max(0,o-a.loading.first):0;n.advancedDateTime=Date.now()-c;const d=this.hls.config.timelineOffset;if(d!==n.appliedTimelineOffset){const m=Math.max(d||0,0);n.appliedTimelineOffset=m,n.fragments.forEach(p=>{p.setStart(p.playlistOffset+m)})}if(n.live||i!=null&&i.live){const m="levelInfo"in e?e.levelInfo:e.track;if(n.reloaded(i),i&&n.fragments.length>0){Jb(i,n,this);const b=n.playlistParsingError;if(b){this.warn(b);const _=this.hls;if(!_.config.ignorePlaylistParsingErrors){var f;const{networkDetails:I}=e;_.trigger(R.ERROR,{type:vt.NETWORK_ERROR,details:q.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:b,reason:b.message,level:e.level||void 0,parent:(f=n.fragments[0])==null?void 0:f.type,networkDetails:I,stats:a});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=a.loading.start);const p=this.hls.mainForwardBufferInfo,g=p?p.end-p.len:0,v=(n.edge-g)*1e3,E=pv(n,v);if(n.requestScheduled+E<o?n.requestScheduled=o:n.requestScheduled+=E,this.log(`live playlist ${t} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let x,T,A;if(n.canBlockReload&&n.endSN&&n.advanced){const b=this.hls.config.lowLatencyMode,_=n.lastPartSn,I=n.endSN,C=n.lastPartIndex,N=C!==-1,w=_===I;N?w?(T=I+1,A=b?0:C):(T=_,A=b?C+1:n.maxPartIndex):T=I+1;const P=n.age,B=P+n.ageHeader;let M=Math.min(B-n.partTarget,n.targetduration*1.5);if(M>0){if(B>n.targetduration*3)this.log(`Playlist last advanced ${P.toFixed(2)}s ago. Omitting segment and part directives.`),T=void 0,A=void 0;else if(i!=null&&i.tuneInGoal&&B-n.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${M} with playlist age: ${n.age}`),M=0;else{const K=Math.floor(M/n.targetduration);if(T+=K,A!==void 0){const tt=Math.round(M%n.targetduration/n.partTarget);A+=tt}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${P.toFixed(2)}s goal: ${M} skip sn ${K} to part ${A}`)}n.tuneInGoal=M}if(x=this.getDeliveryDirectives(n,e.deliveryDirectives,T,A),b||!w){n.requestScheduled=o,this.loadingPlaylist(m,x);return}}else(n.canBlockReload||n.canSkipUntil)&&(x=this.getDeliveryDirectives(n,e.deliveryDirectives,T,A));x&&T!==void 0&&n.canBlockReload&&(n.requestScheduled=a.loading.first+Math.max(E-c*2,E/2)),this.scheduleLoading(m,x,n)}else this.clearTimer()}scheduleLoading(t,e,i){const n=i||t.details;if(!n){this.loadingPlaylist(t,e);return}const a=self.performance.now(),o=n.requestScheduled;if(a>=o){this.loadingPlaylist(t,e);return}const c=o-a;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(c)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),c)}getDeliveryDirectives(t,e,i,n){let a=c0(t);return e!=null&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,n=e.part,a=Lo.No),new f0(i,n,a)}checkRetry(t){const e=t.details,i=Bo(t),n=t.errorAction,{action:a,retryCount:o=0,retryConfig:c}=n||{},d=!!n&&!!c&&(a===Pe.RetryRequest||!n.resolved&&a===Pe.SendAlternateToPenaltyBox);if(d){var f;if(o>=c.maxNumRetry)return!1;if(i&&(f=t.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const m=bd(c,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${e}" in ${m}ms`)}t.levelRetry=!0,n.resolved=!0}return d}}function jv(l,t){if(l.length!==t.length)return!1;for(let e=0;e<l.length;e++)if(!Fa(l[e].attrs,t[e].attrs))return!1;return!0}function Fa(l,t,e){const i=l["STABLE-RENDITION-ID"];return i&&!e?i===t["STABLE-RENDITION-ID"]:!(e||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>l[n]!==t[n])}function nd(l,t){return t.label.toLowerCase()===l.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(l.lang||"").toLowerCase())}class oL extends Nd{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.LEVEL_LOADING,this.onLevelLoading,this),t.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.LEVEL_LOADING,this.onLevelLoading,this),t.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(R.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:n,details:a}=e,o=this.tracksInGroup[i];if(!o||o.groupId!==n){this.warn(`Audio track with id:${i} and group:${n} not found in active group ${o?.groupId}`);return}const c=o.details;o.details=e.details,this.log(`Audio track ${i} "${o.name}" lang:${o.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,c)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,n=this.groupIds;let a=this.currentTrack;if(!i||n?.length!==i?.length||i!=null&&i.some(c=>n?.indexOf(c)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(g=>!i||i.indexOf(g.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(g=>g.default)&&(this.selectDefaultTrack=!1),c.forEach((g,v)=>{g.id=v});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const d=this.hls.config.audioPreference;if(!a&&d){const g=Gi(d,c,bn);if(g>-1)a=c[g];else{const v=Gi(d,this.tracks);a=this.tracks[v]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const m={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${i?.join(",")}`),this.hls.trigger(R.AUDIO_TRACKS_UPDATED,m);const p=this.trackId;if(f!==-1&&p===-1)this.setAudioTrack(f);else if(c.length&&p===-1){var o;const g=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${c.length}`);this.warn(g.message),this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:g})}}}onError(t,e){e.fatal||!e.context||e.context.type===wt.AUDIO_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const n=this.currentTrack;if(n&&Ln(t,n,bn))return n;const a=Gi(t,this.tracksInGroup,bn);if(a>-1){const o=this.tracksInGroup[a];return this.setAudioTrack(a),o}else if(n){let o=e.loadLevel;o===-1&&(o=e.firstAutoLevel);const c=Sb(t,e.levels,i,o,bn);if(c===-1)return null;e.nextLoadLevel=c}if(t.channels||t.audioCodec){const o=Gi(t,i);if(o>-1)return i[o]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length){this.warn(`Invalid audio track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,n=e[t],a=n.details&&!n.details.live;if(t===this.trackId&&n===i&&a||(this.log(`Switching to audio-track ${t} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=t,this.currentTrack=n,this.hls.trigger(R.AUDIO_TRACK_SWITCHING,zt({},n)),a))return;const o=this.switchParams(n.url,i?.details,n.details);this.loadPlaylist(o)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const n=e[i];if(!(this.selectDefaultTrack&&!n.default)&&(!t||Ln(t,n,bn)))return i}if(t){const{name:i,lang:n,assocLang:a,characteristics:o,audioCodec:c,channels:d}=t;for(let f=0;f<e.length;f++){const m=e[f];if(Ln({name:i,lang:n,assocLang:a,characteristics:o,audioCodec:c,channels:d},m,bn))return f}for(let f=0;f<e.length;f++){const m=e[f];if(Fa(t.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<e.length;f++){const m=e[f];if(Fa(t.attrs,m.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&No(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,n=t.groupId,a=this.getUrlWithDirectives(t.url,e),o=t.details,c=o?.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${n}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${a}`),this.hls.trigger(R.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:e||null,track:t})}}class uL{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(this.queues===null||this.tracks===null)return;const n=this.queues[e];n.push(t),n.length===1&&!i&&this.executeNext(e)}appendBlocker(t){return new Promise(e=>{const i={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,t)})}prependBlocker(t){return new Promise(e=>{if(this.queues){const i={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;const i=(e=t[0])==null?void 0:e.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(t[0].execute(),t.splice(0,1))})}unblockAudio(t){if(this.queues===null)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(this.queues===null||this.tracks===null)return;const e=this.queues[t];if(e.length){const n=e[0];try{n.execute()}catch(a){var i;if(n.onError(a),this.queues===null||this.tracks===null)return;const o=(i=this.tracks[t])==null?void 0:i.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues!==null&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return((e=this.queues)==null?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return t===null||e===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(t){var e,i;return(e=this.queues)!=null&&e[t]||(i=this.tracks)!=null&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const i=(e=this.tracks)==null?void 0:e[t],n=i?.buffer;return n?`SourceBuffer${n.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return((e=this.queues)==null?void 0:e[t].map(i=>i.label).join(", "))||""}}const Q0=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Gv="HlsJsTrackRemovedError";class cL extends Error{constructor(t){super(t),this.name=Gv}}class fL extends Ri{constructor(t,e){super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:n,mediaSource:a}=this;i&&this.log("Media source opened"),!(!n||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(R.MEDIA_ATTACHED,{media:n,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:n}=this;i!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${i})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=O1(Ws(t.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.BUFFER_RESET,this.onBufferReset,this),t.on(R.BUFFER_APPENDING,this.onBufferAppending,this),t.on(R.BUFFER_CODECS,this.onBufferCodecs,this),t.on(R.BUFFER_EOS,this.onBufferEos,this),t.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(R.FRAG_PARSED,this.onFragParsed,this),t.on(R.FRAG_CHANGED,this.onFragChanged,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.BUFFER_RESET,this.onBufferReset,this),t.off(R.BUFFER_APPENDING,this.onBufferAppending,this),t.off(R.BUFFER_CODECS,this.onBufferCodecs,this),t.off(R.BUFFER_EOS,this.onBufferEos,this),t.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(R.FRAG_PARSED,this.onFragParsed,this),t.off(R.FRAG_CHANGED,this.onFragChanged,this),t.off(R.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const i={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const o=this.isQueued();(a||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===e?Xt(i,n.tracks):this.sourceBuffers.forEach(a=>{const[o]=a;o&&(i[o]=Xt({},this.tracks[o]),this.removeBuffer(o)),a[0]=a[1]=null}),{media:t,mediaSource:e,tracks:i}}initTracks(){const t={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=t,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let n=2;(e.audio&&!e.video||!e.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(t,e){const i=this.media=e.media;this.transferData=this.overrides=void 0;const n=Ws(this.appendSource);if(n){const a=!!e.mediaSource;(a||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const o=this.mediaSource=e.mediaSource||new n;if(this.assignMediaSource(o),a)this._objectUrl=i.src,this.attachTransferred();else{const c=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{i.removeAttribute("src");const d=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||d&&o instanceof d,W0(i),dL(i,c),i.load()}catch{i.src=c}else i.src=c}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${((e=this.transferData)==null?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${(i=t.constructor)==null?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const i=this.tracks,n=e.tracks,a=n?Object.keys(n):null,o=a?a.length:0,c=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(n&&a&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Zt(i,(d,f)=>d==="initSegment"?void 0:f)};
transfer tracks: ${Zt(n,(d,f)=>d==="initSegment"?void 0:f)}}`),!Fy(n,i)){e.mediaSource=null,e.tracks=void 0;const d=t.currentTime,f=this.details,m=Math.max(d,f?.fragments[0].start||0);if(m-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(i)}") start time: ${m} currentTime: ${d}`),this.onMediaDetaching(R.MEDIA_DETACHING,{}),this.onMediaAttaching(R.MEDIA_ATTACHING,e),t.currentTime=m;return}this.transferData=void 0,a.forEach(d=>{const f=d,m=n[f];if(m){const p=m.buffer;if(p){const g=this.fragmentTracker,v=m.id;if(g.hasFragments(v)||g.hasParts(v)){const T=At.getBuffered(p);g.detectEvictedFragments(f,T,v,null,!0)}const E=kf(f),x=[f,p];this.sourceBuffers[E]=x,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(f),this.trackSourceBuffer(f,m)}}}),c(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),c()}get mediaSourceOpenOrEnded(){var t;const e=(t=this.mediaSource)==null?void 0:t.readyState;return e==="open"||e==="ended"}onMediaDetaching(t,e){const i=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:a,_objectUrl:o}=this;if(a){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([c])=>{c&&this.removeBuffer(c)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const c=a.readyState==="open";try{const d=a.sourceBuffers;for(let f=d.length;f--;)c&&d[f].abort(),a.removeSourceBuffer(d[f]);c&&a.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),i||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(n.removeAttribute("src"),this.appendSource&&W0(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(R.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(([t])=>{t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(t){var e;const i=(e=this.tracks[t])==null?void 0:e.buffer;if(this.removeBuffer(t),i)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${t}`,a)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[kf(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new uL(this.tracks)}onBufferCodecs(t,e){var i;const n=this.tracks,a=Object.keys(e);this.log(`BUFFER_CODECS: "${a}" (current SB count ${this.sourceBufferCount})`);const o="audiovideo"in e&&(n.audio||n.video)||n.audiovideo&&("audio"in e||"video"in e),c=!o&&this.sourceBufferCount&&this.media&&a.some(d=>!n[d]);if(o||c){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${a}" SourceBuffers`);return}a.forEach(d=>{var f,m;const p=e[d],{id:g,codec:v,levelCodec:E,container:x,metadata:T,supplemental:A}=p;let b=n[d];const _=(f=this.transferData)==null||(f=f.tracks)==null?void 0:f[d],I=_!=null&&_.buffer?_:b,C=I?.pendingCodec||I?.codec,N=I?.levelCodec;b||(b=n[d]={buffer:void 0,listeners:[],codec:v,supplemental:A,container:x,levelCodec:E,metadata:T,id:g});const w=Ao(C,N),P=w?.replace(Q0,"$1");let B=Ao(v,E);const M=(m=B)==null?void 0:m.replace(Q0,"$1");B&&w&&P!==M&&(d.slice(0,5)==="audio"&&(B=Mo(B,this.appendSource)),this.log(`switching codec ${C} to ${B}`),B!==(b.pendingCodec||b.codec)&&(b.pendingCodec=B),b.container=x,this.appendChangeType(d,x,B))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!e.video&&((i=e.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{const i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t},{})}appendChangeType(t,e,i){const n=`${e};codecs=${i}`,a={label:`change-type=${n}`,execute:()=>{const o=this.tracks[t];if(o){const c=o.buffer;c!=null&&c.changeType&&(this.log(`changing ${t} sourceBuffer type to ${n}`),c.changeType(n),o.codec=i,o.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${t} SourceBuffer type`,o)}};this.append(a,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const i=t.start,n=i+t.duration*.05;if(((e=this.fragmentTracker.getAppendedFrag(i,mt.MAIN))==null?void 0:e.gap)===!0)return;const o={label:"block-audio",execute:()=>{var c;const d=this.tracks.video;(this.lastVideoAppendEnd>n||d!=null&&d.buffer&&At.isBuffered(d.buffer,n)||((c=this.fragmentTracker.getAppendedFrag(n,mt.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:o,frag:t},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:i}=this,{data:n,type:a,parent:o,frag:c,part:d,chunkMeta:f,offset:m}=e,p=f.buffering[a],{sn:g,cc:v}=c,E=self.performance.now();p.start=E;const x=c.stats.buffering,T=d?d.stats.buffering:null;x.start===0&&(x.start=E),T&&T.start===0&&(T.start=E);const A=i.audio;let b=!1;a==="audio"&&A?.container==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||f.id===1||this.lastMpegAudioChunk.sn!==f.sn,this.lastMpegAudioChunk=f);const _=i.video,I=_?.buffer;if(I&&g!=="initSegment"){const w=d||c,P=this.blockedAudioAppend;if(a==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(_.ending||_.ended)){const M=w.start+w.duration*.05,K=I.buffered,tt=this.currentOp("video");!K.length&&!tt?this.blockAudio(w):!tt&&!At.isBuffered(I,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(w)}else if(a==="video"){const B=w.end;if(P){const M=P.frag.start;(B>M||B<this.lastVideoAppendEnd||At.isBuffered(I,M))&&this.unblockAudio()}this.lastVideoAppendEnd=B}}const C=(d||c).start,N={label:`append-${a}`,execute:()=>{var w;p.executeStart=self.performance.now();const P=(w=this.tracks[a])==null?void 0:w.buffer;P&&(b?this.updateTimestampOffset(P,C,.1,a,g,v):m!==void 0&&ht(m)&&this.updateTimestampOffset(P,m,1e-6,a,g,v)),this.appendExecutor(n,a)},onStart:()=>{},onComplete:()=>{const w=self.performance.now();p.executeEnd=p.end=w,x.first===0&&(x.first=w),T&&T.first===0&&(T.first=w);const P={};this.sourceBuffers.forEach(([B,M])=>{B&&(P[B]=At.getBuffered(M))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(R.BUFFER_APPENDED,{type:a,frag:c,part:d,chunkMeta:f,parent:c.type,timeRanges:P})},onError:w=>{var P;const B={type:vt.MEDIA_ERROR,parent:c.type,details:q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:c,part:d,chunkMeta:f,error:w,err:w,fatal:!1},M=(P=this.media)==null?void 0:P.error;if(w.code===DOMException.QUOTA_EXCEEDED_ERR||w.name=="QuotaExceededError"||"quota"in w)B.details=q.BUFFER_FULL_ERROR;else if(w.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)B.errorAction=br(!0);else if(w.name===Gv&&this.sourceBufferCount===0)B.errorAction=br(!0);else{const K=++this.appendErrors[a];this.warn(`Failed ${K}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${M||"no media error"})`),(K>=this.hls.config.appendErrorMaxRetry||M)&&(B.fatal=!0)}this.hls.trigger(R.ERROR,B)}};this.log(`queuing "${a}" append sn: ${g}${d?" p: "+d.index:""} of ${c.type===mt.MAIN?"level":"track"} ${c.level} cc: ${v}`),this.append(N,a,this.isPending(this.tracks[a]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(R.BUFFER_FLUSHED,{type:t})},onError:n=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,n)}}}onBufferFlushing(t,e){const{type:i,startOffset:n,endOffset:a}=e;i?this.append(this.getFlushOp(i,n,a),i):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,n,a),o)})}onFragParsed(t,e){const{frag:i,part:n}=e,a=[],o=n?n.elementaryStreams:i.elementaryStreams;o[Wt.AUDIOVIDEO]?a.push("audiovideo"):(o[Wt.AUDIO]&&a.push("audio"),o[Wt.VIDEO]&&a.push("video"));const c=()=>{const d=self.performance.now();i.stats.buffering.end=d,n&&(n.stats.buffering.end=d);const f=n?n.stats:i.stats;this.hls.trigger(R.FRAG_BUFFERED,{frag:i,part:n,stats:f,id:i.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(c,a).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([t])=>{if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1})}onBufferEos(t,e){var i;this.sourceBuffers.forEach(([o])=>{if(o){const c=this.tracks[o];(!e.type||e.type===o)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${o} buffer reached EOS`)))}});const n=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var c;return o&&!((c=this.tracks[o])!=null&&c.ended)})?n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(R.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(R.BUFFERED_TO_END,void 0)):e.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([t])=>{if(t!==null){const e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)})}onError(t,e){if(e.details===q.BUFFER_APPEND_ERROR&&e.frag){var i;const n=(i=e.errorAction)==null?void 0:i.nextAutoLevel;ht(n)&&n!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||e===null||!this.sourceBufferCount)return;const n=t.config,a=i.currentTime,o=e.levelTargetDuration,c=e.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(ht(c)&&c>=0){const f=Math.max(c,o),m=Math.floor(a/o)*o-f;this.flushBackBuffer(a,o,m)}const d=n.frontBufferFlushThreshold;if(ht(d)&&d>0){const f=Math.max(n.maxBufferLength,d),m=Math.max(f,o),p=Math.floor(a/o)*o+m;this.flushFrontBuffer(a,o,p)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach(([n,a])=>{if(a){const c=At.getBuffered(a);if(c.length>0&&i>c.start(0)){var o;this.hls.trigger(R.BACK_BUFFER_REACHED,{bufferEnd:i});const d=this.tracks[n];if((o=this.details)!=null&&o.live)this.hls.trigger(R.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(d!=null&&d.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:n})}}})}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach(([n,a])=>{if(a){const o=At.getBuffered(a),c=o.length;if(c<2)return;const d=o.start(c-1),f=o.end(c-1);if(i>d||t>=d&&t<=f)return;this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:n})}})}getDurationAndRange(){var t;const{details:e,mediaSource:i}=this;if(!e||!this.media||i?.readyState!=="open")return null;const n=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&i.setLiveSeekableRange){const f=Math.max(0,e.fragmentStart),m=Math.max(f,n);return{duration:1/0,start:f,end:m}}return{duration:1/0}}const a=(t=this.overrides)==null?void 0:t.duration;if(a)return ht(a)?{duration:a}:null;const o=this.media.duration,c=ht(i.duration)?i.duration:0;return n>c&&n>o||!ht(o)?{duration:n}:null}updateMediaSource({duration:t,start:e,end:i}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==t&&(ht(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),n.duration=t),e!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${e}-${i}.`),n.setLiveSeekableRange(e,i)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${Zt(i)}`),this.tracksReady){var n;const a=(n=this.transferData)==null?void 0:n.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach(([e,i])=>{if(e){const n=this.tracks[e];t[e]={buffer:i,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(R.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in t){const o=a,c=t[o];if(this.isPending(c)){const d=this.getTrackCodec(c,o),f=`${c.container};codecs=${d}`;c.codec=d,this.log(`creating sourceBuffer(${f})${this.currentOp(o)?" Queued":""} ${Zt(c)}`);try{const m=i.addSourceBuffer(f),p=kf(o),g=[o,m];e[p]=g,c.buffer=m}catch(m){var n;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(o),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[o],this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:o,mimeType:f,parent:c.id});return}this.trackSourceBuffer(o,c)}}this.bufferCreated()}getTrackCodec(t,e){const i=t.supplemental;let n=t.codec;i&&(e==="video"||e==="audiovideo")&&ka(i,"video")&&(n=eb(n,i));const a=Ao(n,t.levelCodec);return a?e.slice(0,5)==="audio"?Mo(a,this.appendSource):a:""}trackSourceBuffer(t,e){const i=e.buffer;if(!i)return;const n=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:n,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(a,o)=>{const c=o.removedRanges;c!=null&&c.length&&this.hls.trigger(R.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var t,e;const i=((t=this.media)==null||(e=t.querySelector)==null?void 0:e.call(t,"source"))||this.media;return i?.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if(((e=this.mediaSource)==null?void 0:e.readyState)==="closed"){this.resetBuffer(t);return}const i=this.currentOp(t);i&&(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;const n=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${n}`,e),this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:n,fatal:!1});const a=this.currentOp(t);a&&a.onError(n)}updateTimestampOffset(t,e,i,n,a,o){const c=e-t.timestampOffset;Math.abs(c)>=i&&(this.log(`Updating ${n} SourceBuffer timestampOffset to ${e} (sn: ${a} cc: ${o})`),t.timestampOffset=e)}removeExecutor(t,e,i){const{media:n,mediaSource:a}=this,o=this.tracks[t],c=o?.buffer;if(!n||!a||!c){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(t);return}const d=ht(n.duration)?n.duration:1/0,f=ht(a.duration)?a.duration:1/0,m=Math.max(0,e),p=Math.min(i,d,f);p>m&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${m},${p}] from the ${t} SourceBuffer`),c.remove(m,p)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.tracks[e],n=i?.buffer;if(!n)throw new cL(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,n.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([t,e])=>t&&e.updating)}isQueued(){return this.sourceBuffers.some(([t])=>t&&!!this.currentOp(t))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:i}=this,n=e.map(o=>this.appendBlocker(o));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(o=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(e=>{var i;const n=(i=this.tracks[e])==null?void 0:i.buffer;!n||n.updating||this.shiftAndExecuteNext(e)})}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,[e])=>t+(e?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([t])=>t).filter(t=>!!t)}addBufferListener(t,e,i){const n=this.tracks[t];if(!n)return;const a=n.buffer;if(!a)return;const o=i.bind(this,t);n.listeners.push({event:e,listener:o}),a.addEventListener(e,o)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const i=e.buffer;i&&(e.listeners.forEach(n=>{i.removeEventListener(n.event,n.listener)}),e.listeners.length=0)}}function W0(l){const t=l.querySelectorAll("source");[].slice.call(t).forEach(e=>{l.removeChild(e)})}function dL(l,t){const e=self.document.createElement("source");e.type="video/mp4",e.src=t,l.appendChild(e)}function kf(l){return l==="audio"?1:0}class Bd{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(R.BUFFER_CODECS,this.onBufferCodecs,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(R.BUFFER_CODECS,this.onBufferCodecs,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&ht(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter((n,a)=>this.isLevelAllowed(n)&&a<=t);return this.clientRect=null,Bd.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,!e.width&&!e.height&&(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch{}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(i=>t.bitrate===i.bitrate&&t.width===i.width&&t.height===i.height)}static getMaxLevelByMediaSize(t,e,i){if(!(t!=null&&t.length))return-1;const n=(c,d)=>d?c.width!==d.width||c.height!==d.height:!0;let a=t.length-1;const o=Math.max(e,i);for(let c=0;c<t.length;c+=1){const d=t[c];if((d.width>=o||d.height>=o)&&n(d,t[c+1])){a=c;break}}return a}}const hL={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ti=hL,mL={HLS:"h"},pL=mL;class Vi{constructor(t,e){Array.isArray(t)&&(t=t.map(i=>i instanceof Vi?i:new Vi(i))),this.value=t,this.params=e}}const gL="Dict";function yL(l){return Array.isArray(l)?JSON.stringify(l):l instanceof Map?"Map{}":l instanceof Set?"Set{}":typeof l=="object"?JSON.stringify(l):String(l)}function vL(l,t,e,i){return new Error(`failed to ${l} "${yL(t)}" as ${e}`,{cause:i})}function Ki(l,t,e){return vL("serialize",l,t,e)}class Hv{constructor(t){this.description=t}}const Z0="Bare Item",EL="Boolean";function SL(l){if(typeof l!="boolean")throw Ki(l,EL);return l?"?1":"?0"}function TL(l){return btoa(String.fromCharCode(...l))}const xL="Byte Sequence";function bL(l){if(ArrayBuffer.isView(l)===!1)throw Ki(l,xL);return`:${TL(l)}:`}const AL="Integer";function LL(l){return l<-999999999999999||999999999999999<l}function zv(l){if(LL(l))throw Ki(l,AL);return l.toString()}function RL(l){return`@${zv(l.getTime()/1e3)}`}function Vv(l,t){if(l<0)return-Vv(-l,t);const e=Math.pow(10,t);if(Math.abs(l*e%1-.5)<Number.EPSILON){const n=Math.floor(l*e);return(n%2===0?n:n+1)/e}else return Math.round(l*e)/e}const _L="Decimal";function IL(l){const t=Vv(l,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Ki(l,_L);const e=t.toString();return e.includes(".")?e:`${e}.0`}const DL="String",CL=/[\x00-\x1f\x7f]+/;function wL(l){if(CL.test(l))throw Ki(l,DL);return`"${l.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function kL(l){return l.description||l.toString().slice(7,-1)}const OL="Token";function J0(l){const t=kL(l);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw Ki(t,OL);return t}function rd(l){switch(typeof l){case"number":if(!ht(l))throw Ki(l,Z0);return Number.isInteger(l)?zv(l):IL(l);case"string":return wL(l);case"symbol":return J0(l);case"boolean":return SL(l);case"object":if(l instanceof Date)return RL(l);if(l instanceof Uint8Array)return bL(l);if(l instanceof Hv)return J0(l);default:throw Ki(l,Z0)}}const ML="Key";function ad(l){if(/^[a-z*][a-z0-9\-_.*]*$/.test(l)===!1)throw Ki(l,ML);return l}function Fd(l){return l==null?"":Object.entries(l).map(([t,e])=>e===!0?`;${ad(t)}`:`;${ad(t)}=${rd(e)}`).join("")}function Kv(l){return l instanceof Vi?`${rd(l.value)}${Fd(l.params)}`:rd(l)}function PL(l){return`(${l.value.map(Kv).join(" ")})${Fd(l.params)}`}function NL(l,t={whitespace:!0}){if(typeof l!="object"||l==null)throw Ki(l,gL);const e=l instanceof Map?l.entries():Object.entries(l),i=t?.whitespace?" ":"";return Array.from(e).map(([n,a])=>{a instanceof Vi||(a=new Vi(a));let o=ad(n);return a.value===!0?o+=Fd(a.params):(o+="=",Array.isArray(a.value)?o+=PL(a):o+=Kv(a)),o}).join(`,${i}`)}function qv(l,t){return NL(l,t)}const Ui="CMCD-Object",de="CMCD-Request",Tn="CMCD-Session",Ys="CMCD-Status",BL={br:Ui,ab:Ui,d:Ui,ot:Ui,tb:Ui,tpb:Ui,lb:Ui,tab:Ui,lab:Ui,url:Ui,pb:de,bl:de,tbl:de,dl:de,ltc:de,mtp:de,nor:de,nrr:de,rc:de,sn:de,sta:de,su:de,ttfb:de,ttfbb:de,ttlb:de,cmsdd:de,cmsds:de,smrt:de,df:de,cs:de,ts:de,cid:Tn,pr:Tn,sf:Tn,sid:Tn,st:Tn,v:Tn,msd:Tn,bs:Ys,bsd:Ys,cdn:Ys,rtp:Ys,bg:Ys,pt:Ys,ec:Ys,e:Ys},FL={REQUEST:de};function UL(l){return Object.keys(l).reduce((t,e)=>{var i;return(i=l[e])===null||i===void 0||i.forEach(n=>t[n]=e),t},{})}function $L(l,t){const e={};if(!l)return e;const i=Object.keys(l),n=t?UL(t):{};return i.reduce((a,o)=>{var c;const d=BL[o]||n[o]||FL.REQUEST,f=(c=a[d])!==null&&c!==void 0?c:a[d]={};return f[o]=l[o],a},e)}function jL(l){return["ot","sf","st","e","sta"].includes(l)}function GL(l){return typeof l=="number"?ht(l):l!=null&&l!==""&&l!==!1}const Yv="event";function HL(l,t){const e=new URL(l),i=new URL(t);if(e.origin!==i.origin)return l;const n=e.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);for(;n[0]===a[0];)n.shift(),a.shift();for(;a.length;)a.shift(),n.unshift("..");return n.join("/")+e.search+e.hash}const Do=l=>Math.round(l),ld=(l,t)=>Array.isArray(l)?l.map(e=>ld(e,t)):l instanceof Vi&&typeof l.value=="string"?new Vi(ld(l.value,t),l.params):(t.baseUrl&&(l=HL(l,t.baseUrl)),t.version===1?encodeURIComponent(l):l),mo=l=>Do(l/100)*100,zL=(l,t)=>{let e=l;return t.version>=2&&(l instanceof Vi&&typeof l.value=="string"?e=new Vi([l]):typeof l=="string"&&(e=[l])),ld(e,t)},VL={br:Do,d:Do,bl:mo,dl:mo,mtp:mo,nor:zL,rtp:mo,tb:Do},Xv="request",Qv="response",Ud=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],KL=["e"],qL=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Yo(l){return qL.test(l)}function YL(l){return Ud.includes(l)||KL.includes(l)||Yo(l)}const Wv=["d","dl","nor","ot","rtp","su"];function XL(l){return Ud.includes(l)||Wv.includes(l)||Yo(l)}const QL=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function WL(l){return Ud.includes(l)||Wv.includes(l)||QL.includes(l)||Yo(l)}const ZL=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function JL(l){return ZL.includes(l)||Yo(l)}const tR={[Qv]:WL,[Yv]:YL,[Xv]:XL};function Zv(l,t={}){const e={};if(l==null||typeof l!="object")return e;const i=t.version||l.v||1,n=t.reportingMode||Xv,a=i===1?JL:tR[n];let o=Object.keys(l).filter(a);const c=t.filter;typeof c=="function"&&(o=o.filter(c));const d=n===Qv||n===Yv;d&&!o.includes("ts")&&o.push("ts"),i>1&&!o.includes("v")&&o.push("v");const f=Xt({},VL,t.formatters),m={version:i,reportingMode:n,baseUrl:t.baseUrl};return o.sort().forEach(p=>{let g=l[p];const v=f[p];if(typeof v=="function"&&(g=v(g,m)),p==="v"){if(i===1)return;g=i}p=="pr"&&g===1||(d&&p==="ts"&&!ht(g)&&(g=Date.now()),GL(g)&&(jL(p)&&typeof g=="string"&&(g=new Hv(g)),e[p]=g))}),e}function eR(l,t={}){const e={};if(!l)return e;const i=Zv(l,t),n=$L(i,t?.customHeaderMap);return Object.entries(n).reduce((a,[o,c])=>{const d=qv(c,{whitespace:!1});return d&&(a[o]=d),a},e)}function iR(l,t,e){return Xt(l,eR(t,e))}const sR="CMCD";function nR(l,t={}){return l?qv(Zv(l,t),{whitespace:!1}):""}function rR(l,t={}){if(!l)return"";const e=nR(l,t);return encodeURIComponent(e)}function aR(l,t={}){if(!l)return"";const e=rR(l,t);return`${sR}=${e}`}const ty=/CMCD=[^&#]+/;function lR(l,t,e){const i=aR(t,e);if(!i)return l;if(ty.test(l))return l.replace(ty,i);const n=l.includes("?")?"&":"?";return`${l}${n}${i}`}class oR{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:ti.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=n=>{try{const{frag:a,part:o}=n,c=this.hls.levels[a.level],d=this.getObjectType(a),f={d:(o||a).duration*1e3,ot:d};(d===ti.VIDEO||d===ti.AUDIO||d==ti.MUXED)&&(f.br=c.bitrate/1e3,f.tb=this.getTopBandwidth(d)/1e3,f.bl=this.getBufferLength(d));const m=o?this.getNextPart(o):this.getNextFrag(a);m!=null&&m.url&&m.url!==a.url&&(f.nor=m.url),this.apply(n,f)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;i!=null&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHED,this.onMediaDetached,this),t.on(R.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHED,this.onMediaDetached,this),t.off(R.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,n;this.audioBuffer=(i=e.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(n=e.tracks.video)==null?void 0:n.buffer}createData(){var t;return{v:1,sf:pL.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){Xt(e,this.createData());const i=e.ot===ti.INIT||e.ot===ti.VIDEO||e.ot===ti.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),e.su==null&&(e.su=this.buffering);const{includeKeys:n}=this;n&&(e=Object.keys(e).reduce((o,c)=>(n.includes(c)&&(o[c]=e[c]),o),{}));const a={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),iR(t.headers,e,a)):t.url=lR(t.url,e,a)}getNextFrag(t){var e;const i=(e=this.hls.levels[t.level])==null?void 0:e.details;if(i){const n=t.sn-i.startSN;return i.fragments[n+1]}}getNextPart(t){var e;const{index:i,fragment:n}=t,a=(e=this.hls.levels[n.level])==null||(e=e.details)==null?void 0:e.partList;if(a){const{sn:o}=n;for(let c=a.length-1;c>=0;c--){const d=a[c];if(d.index===i&&d.fragment.sn===o)return a[c+1]}}}getObjectType(t){const{type:e}=t;if(e==="subtitle")return ti.TIMED_TEXT;if(t.sn==="initSegment")return ti.INIT;if(e==="audio")return ti.AUDIO;if(e==="main")return this.hls.audioTracks.length?ti.VIDEO:ti.MUXED}getTopBandwidth(t){let e=0,i;const n=this.hls;if(t===ti.AUDIO)i=n.audioTracks;else{const a=n.maxAutoLevel,o=a>-1?a+1:n.levels.length;i=n.levels.slice(0,o)}return i.forEach(a=>{a.bitrate>e&&(e=a.bitrate)}),e>0?e:NaN}getBufferLength(t){const e=this.media,i=t===ti.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!e?NaN:At.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,o,c){e(a),this.loader.load(a,o,c)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,o,c){e(a),this.loader.load(a,o,c)}}}}const uR=3e5;class cR extends Ri{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(t.indexOf(e.pathwayId)===-1&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter(i=>i!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if(i?.action===Pe.SendAlternateToPenaltyBox&&i.flags===ci.MoveAllAlternatesMatchingHost){const n=this.levels;let a=this._pathwayPriority,o=this.pathwayId;if(e.context){const{groupId:c,pathwayId:d,type:f}=e.context;c&&n?o=this.getPathwayForGroupId(c,f,o):d&&(o=d)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!a&&n&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),i.resolved=this.pathwayId!==o),e.details===q.BUFFER_APPEND_ERROR&&!e.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${o} levels: ${n&&n.length} priorities: ${Zt(a)} penalized: ${Zt(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(e.length===0){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){this._pathwayPriority=t;let e;const i=this.penalizedPathways,n=performance.now();Object.keys(i).forEach(a=>{n-i[a]>uR&&delete i[a]});for(let a=0;a<t.length;a++){const o=t[a];if(o in i)continue;if(o===this.pathwayId)return;const c=this.hls.nextLoadLevel,d=this.hls.levels[c];if(e=this.getLevelsForPathway(o),e.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,vv(e),this.hls.trigger(R.LEVELS_UPDATED,{levels:e});const f=this.hls.levels[c];d&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(t,e,i){const n=this.getLevelsForPathway(i).concat(this.levels||[]);for(let a=0;a<n.length;a++)if(e===wt.AUDIO_TRACK&&n[a].hasAudioGroup(t)||e===wt.SUBTITLE_TRACK&&n[a].hasSubtitleGroup(t))return n[a].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},n={};t.forEach(a=>{const{ID:o,"BASE-ID":c,"URI-REPLACEMENT":d}=a;if(e.some(m=>m.pathwayId===o))return;const f=this.getLevelsForPathway(c).map(m=>{const p=new se(m.attrs);p["PATHWAY-ID"]=o;const g=p.AUDIO&&`${p.AUDIO}_clone_${o}`,v=p.SUBTITLES&&`${p.SUBTITLES}_clone_${o}`;g&&(i[p.AUDIO]=g,p.AUDIO=g),v&&(n[p.SUBTITLES]=v,p.SUBTITLES=v);const E=Jv(m.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),x=new Ma({attrs:p,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:E,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let T=1;T<m.audioGroups.length;T++)x.addGroupId("audio",`${m.audioGroups[T]}_clone_${o}`);if(m.subtitleGroups)for(let T=1;T<m.subtitleGroups.length;T++)x.addGroupId("text",`${m.subtitleGroups[T]}_clone_${o}`);return x});e.push(...f),ey(this.audioTracks,i,d,o),ey(this.subtitleTracks,n,d,o)})}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;this.loader&&this.loader.destroy(),this.loader=new i(e);let n;try{n=new self.URL(t)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(n.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+m)}const a={responseType:"json",url:n.href},o=e.steeringManifestLoadPolicy.default,c=o.errorRetry||o.timeoutRetry||{},d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},f={onSuccess:(m,p,g,v)=>{this.log(`Loaded steering manifest: "${n}"`);const E=m.data;if(E?.VERSION!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":A}=E;if(x)try{this.uri=new self.URL(x,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||g.url),T&&this.clonePathways(T);const b={steeringManifest:E,url:n.toString()};this.hls.trigger(R.STEERING_MANIFEST_LOADED,b),A&&this.updatePathwayPriority(A)},onError:(m,p,g,v)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${p.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let E=this.timeToLoad*1e3;if(m.code===429){const x=this.loader;if(typeof x?.getResponseHeader=="function"){const T=x.getResponseHeader("Retry-After");T&&(E=parseFloat(T)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,E)},onTimeout:(m,p,g)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(a,d,f)}scheduleRefresh(t,e=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const n=(i=this.hls)==null?void 0:i.media;if(n&&!n.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},e)}}function ey(l,t,e,i){l&&Object.keys(t).forEach(n=>{const a=l.filter(o=>o.groupId===n).map(o=>{const c=Xt({},o);return c.details=void 0,c.attrs=new se(c.attrs),c.url=c.attrs.URI=Jv(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",e),c.groupId=c.attrs["GROUP-ID"]=t[n],c.attrs["PATHWAY-ID"]=i,c});l.push(...a)})}function Jv(l,t,e,i){const{HOST:n,PARAMS:a,[e]:o}=i;let c;t&&(c=o?.[t],c&&(l=c));const d=new self.URL(l);return n&&!c&&(d.host=n),a&&Object.keys(a).sort().forEach(f=>{f&&d.searchParams.set(f,a[f])}),d.href}class Lr extends Ri{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Lr.CDMCleanupPromise?[Lr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=e=>{const{initDataType:i,initData:n}=e,a=`"${e.type}" event: init data type: "${i}"`;if(this.debug(a),n!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=_a(this.config));const c=o.map(Af).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(o=>{const c=Ro(o);if(i!=="sinf"||c!==ne.FAIRPLAY){this.log(`Ignoring "${e.type}" event with init data type: "${i}" for selected key-system ${c}`);return}let d;try{const v=be(new Uint8Array(n)),E=_d(JSON.parse(v).sinf),x=qy(E);if(!x)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(x.subarray(8,24))}catch(v){this.warn(`${a} Failed to parse sinf: ${v}`);return}const f=ze(d),{keyIdToKeySessionPromise:m,mediaKeySessions:p}=this;let g=m[f];for(let v=0;v<p.length;v++){const E=p[v],x=E.decryptdata;if(!x.keyId)continue;const T=ze(x.keyId);if(Uo(d,x.keyId)||x.uri.replace(/-/g,"").indexOf(f)!==-1){if(g=m[T],!g)continue;if(x.pssh)break;delete m[T],x.pssh=new Uint8Array(n),x.keyId=d,g=m[f]=g.then(()=>this.generateRequestWithPreferredKeySession(E,i,n,"encrypted-event-key-match")),g.catch(A=>this.handleError(A));break}}g||this.handleError(new Error(`Key ID ${f} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(R.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(R.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:i}=this.config,n=e?.[t];if(n)return n.licenseUrl;if(t===ne.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(e===void 0)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,i=e?.[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,i=(o,c,d)=>!!o&&d.indexOf(o)===c,n=e.map(o=>o.audioCodec).filter(i),a=e.map(o=>o.videoCodec).filter(i);return n.length+a.length===0&&a.push("avc1.42e01e"),new Promise((o,c)=>{const d=f=>{const m=f.shift();this.getMediaKeysPromise(m,n,a).then(p=>o({keySystem:m,mediaKeys:p})).catch(p=>{f.length?d(f):p instanceof ui?c(p):c(new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(t)})}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${i}`;return cv===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return i(t,e)}getMediaKeysPromise(t,e,i){var n;const a=zb(t,e,i,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[t],c=(n=o)==null?void 0:n.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${t}" key-system access with config: ${Zt(a)}`),c=this.requestMediaKeySystemAccess(t,a);const d=o=this.keySystemAccessPromises[t]={keySystemAccess:c};return c.catch(f=>{this.log(`Failed to obtain access to key-system "${t}": ${f}`)}),c.then(f=>{this.log(`Access for key-system "${f.keySystem}" obtained`);const m=this.fetchServerCertificate(t);this.log(`Create media-keys for "${t}"`);const p=d.mediaKeys=f.createMediaKeys().then(g=>(this.log(`Media-keys created for "${t}"`),d.hasMediaKeys=!0,m.then(v=>v?this.setMediaKeysServerCertificate(g,t,v):g)));return p.catch(g=>{this.error(`Failed to create media-keys for "${t}"}: ${g}`)}),p})}return c.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:i}){this.log(`Creating key-system session "${e}" keyId: ${ze(t.keyId||[])} keyUri: ${t.uri}`);const n=i.createSession(),a={decryptdata:t,keySystem:e,mediaKeys:i,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const i=this.createMediaKeySessionContext(t),n=po(e),a="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(i,a,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}updateKeySession(t,e){const i=t.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${ze(t.decryptdata.keyId||[])}
      } (data length: ${e.byteLength})`),i.update(e)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(t=>({keySystem:t,hasMediaKeys:this.keySystemAccessPromises[t].hasMediaKeys})).filter(({hasMediaKeys:t})=>!!t).map(({keySystem:t})=>Af(t)).filter(t=>!!t)}getKeySystemAccess(t){return this.getKeySystemSelectionPromise(t).then(({keySystem:e,mediaKeys:i})=>this.attemptSetMediaKeys(e,i))}selectKeySystem(t){return new Promise((e,i)=>{this.getKeySystemSelectionPromise(t).then(({keySystem:n})=>{const a=Af(n);a?e(a):i(new Error(`Unable to find format for key-system "${n}"`))}).catch(i)})}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){const e=_a(this.config),i=t.map(Ro).filter(n=>!!n&&e.indexOf(n)!==-1);return this.selectKeySystem(i)}getKeyStatus(t){const{mediaKeySessions:e}=this;for(let i=0;i<e.length;i++){const n=fR(t,e[i]);if(n)return n}}loadKey(t){const e=t.keyInfo.decryptdata,i=po(e),n=this.bannedKeyIds[i];if(n||this.getKeyStatus(e)==="internal-error"){const c=iy(n||"internal-error",e);return this.handleError(c,t.frag),Promise.reject(c)}const a=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${a}`);const o=this.keyIdToKeySessionPromise[i];if(!o){const c=this.getKeySystemForKeyPromise(e).then(({keySystem:d,mediaKeys:f})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${a}`),this.attemptSetMediaKeys(d,f).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:d,mediaKeys:f,decryptdata:e}))))).then(d=>{const f="cenc",m=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(d,f,m,"playlist-key")});return c.catch(d=>this.handleError(d,t.frag)),this.keyIdToKeySessionPromise[i]=c,c}return o.catch(c=>{if(c instanceof ui){const d=zt({},c.data);this.getKeyStatus(e)==="internal-error"&&(d.decryptdata=e);const f=new ui(d,c.message);this.handleError(f,t.frag)}}),o}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t,e){if(this.hls)if(t instanceof ui){e&&(t.data.frag=e);const i=t.data.decryptdata;this.error(`${t.message}${i?` (${ze(i.keyId||[])})`:""}`),this.hls.trigger(R.ERROR,t.data)}else this.error(t.message),this.hls.trigger(R.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0})}getKeySystemForKeyPromise(t){const e=po(t),i=this.keyIdToKeySessionPromise[e];if(!i){const n=Ro(t.keyFormat),a=n?[n]:_a(this.config);return this.attemptKeySystemAccess(a)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=_a(this.config)),t.length===0)throw new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Zt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){if(this.mediaResolved=void 0,this.mediaKeys===e)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const n=Promise.all(i).then(()=>this.media?this.media.setMediaKeys(e):new Promise((a,o)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return o(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=e,this.media.setMediaKeys(e).then(a).catch(o)}}));return this.mediaKeys=e,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${t}"`),i.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>i.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(t,e,i,n){var a;const o=(a=this.config.drmSystems)==null||(a=a[t.keySystem])==null?void 0:a.generateRequest;if(o)try{const E=o.call(this.hls,e,i,t);if(!E)throw new Error("Invalid response from configured generateRequest filter");e=E.initDataType,i=E.initData?E.initData:null,t.decryptdata.pssh=i?new Uint8Array(i):null}catch(E){if(this.warn(E.message),this.hls&&this.hls.config.debug)throw E}if(i===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(t);const c=po(t.decryptdata),d=t.decryptdata.uri;this.log(`Generating key-session request for "${n}" keyId: ${c} URI: ${d} (init data type: ${e} length: ${i.byteLength})`);const f=new Dd,m=t._onmessage=E=>{const x=t.mediaKeysSession;if(!x){f.emit("error",new Error("invalid state"));return}const{messageType:T,message:A}=E;this.log(`"${T}" message event for session "${x.sessionId}" message size: ${A.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(t,A).catch(b=>{f.eventNames().length?f.emit("error",b):this.handleError(b)}):T==="license-release"?t.keySystem===ne.FAIRPLAY&&this.updateKeySession(t,Jf("acknowledged")).then(()=>this.removeSession(t)).catch(b=>this.handleError(b)):this.warn(`unhandled media key message type "${T}"`)},p=(E,x)=>{x.keyStatus=E;let T;E.startsWith("usable")?f.emit("resolved"):E==="internal-error"||E==="output-restricted"||E==="output-downscaled"?T=iy(E,x.decryptdata):E==="expired"?T=new Error(`key expired (keyId: ${c})`):E==="released"?T=new Error("key released"):E==="status-pending"||this.warn(`unhandled key status change "${E}" (keyId: ${c})`),T&&(f.eventNames().length?f.emit("error",T):this.handleError(T))},g=t._onkeystatuseschange=E=>{if(!t.mediaKeysSession){f.emit("error",new Error("invalid state"));return}const T=this.getKeyStatuses(t);if(!Object.keys(T).some(I=>T[I]!=="status-pending"))return;if(T[c]==="expired"){this.log(`Expired key ${Zt(T)} in key-session "${t.mediaKeysSession.sessionId}"`),this.renewKeySession(t);return}let b=T[c];if(b)p(b,t);else{var _;t.keyStatusTimeouts||(t.keyStatusTimeouts={}),(_=t.keyStatusTimeouts)[c]||(_[c]=self.setTimeout(()=>{if(!t.mediaKeysSession||!this.mediaKeys)return;const C=this.getKeyStatus(t.decryptdata);if(C&&C!=="status-pending")return this.log(`No status for keyId ${c} in key-session "${t.mediaKeysSession.sessionId}". Using session key-status ${C} from other session.`),p(C,t);this.log(`key status for ${c} in key-session "${t.mediaKeysSession.sessionId}" timed out after 1000ms`),b="internal-error",p(b,t)},1e3)),this.log(`No status for keyId ${c} (${Zt(T)}).`)}};Ve(t.mediaKeysSession,"message",m),Ve(t.mediaKeysSession,"keystatuseschange",g);const v=new Promise((E,x)=>{f.on("error",x),f.on("resolved",E)});return t.mediaKeysSession.generateRequest(e,i).then(()=>{this.log(`Request generated for key-session "${t.mediaKeysSession.sessionId}" keyId: ${c} URI: ${d}`)}).catch(E=>{throw new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_SESSION,error:E,decryptdata:t.decryptdata,fatal:!1},`Error generating key-session request: ${E}`)}).then(()=>v).catch(E=>(f.removeAllListeners(),this.removeSession(t).then(()=>{throw E}))).then(()=>(f.removeAllListeners(),t))}getKeyStatuses(t){const e={};return t.mediaKeysSession.keyStatuses.forEach((i,n)=>{if(typeof n=="string"&&typeof i=="object"){const c=n;n=i,i=c}const a="buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n);t.keySystem===ne.PLAYREADY&&a.length===16&&ov(a);const o=ze(a);i==="internal-error"&&(this.bannedKeyIds[o]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${o} key-session "${t.mediaKeysSession.sessionId}"`),e[o]=i}),e}fetchServerCertificate(t){const e=this.config,i=e.loader,n=new i(e),a=this.getServerCertificateUrl(t);return a?(this.log(`Fetching server certificate for "${t}"`),new Promise((o,c)=>{const d={responseType:"arraybuffer",url:a},f=e.certLoadPolicy.default,m={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,E,x)=>{o(g.data)},onError:(g,v,E,x)=>{c(new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:zt({url:d.url,data:void 0},g)},`"${t}" certificate request failed (${a}). Status: ${g.code} (${g.text})`))},onTimeout:(g,v,E)=>{c(new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:d.url,data:void 0}},`"${t}" certificate request timed out (${a})`))},onAbort:(g,v,E)=>{c(new Error("aborted"))}};n.load(d,m,p)})):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise((n,a)=>{t.setServerCertificate(i).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${i.byteLength}) on "${e}"`),n(t)}).catch(o=>{a(new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then(i=>this.updateKeySession(t,new Uint8Array(i)).catch(n=>{throw new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:t.decryptdata,error:n,fatal:!1},n.message)}))}unpackPlayReadyKeyMessage(t,e){const i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const n=new DOMParser().parseFromString(i,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0){let m;for(let p=0,g=a.length;p<g;p++){var o,c;m=a[p];const v=(o=m.querySelector("name"))==null?void 0:o.textContent,E=(c=m.querySelector("value"))==null?void 0:c.textContent;v&&E&&t.setRequestHeader(v,E)}}const d=n.querySelector("Challenge"),f=d?.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return Jf(atob(f))}setupLicenseXHR(t,e,i,n){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,t,e,i,n)}).catch(o=>{if(!i.decryptdata)throw o;return t.open("POST",e,!0),a.call(this.hls,t,e,i,n)}).then(o=>(t.readyState||t.open("POST",e,!0),{xhr:t,licenseChallenge:o||n})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:n}))}requestLicense(t,e){const i=this.config.keyLoadPolicy.default;return new Promise((n,a)=>{const o=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${o}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return a(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let d=c.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const f=this.config.licenseResponseCallback;if(f)try{d=f.call(this.hls,c,o,t)}catch(m){this.error(m)}n(d)}else{const d=i.errorRetry,f=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||c.status>=400&&c.status<500)a(new ui({type:vt.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:t.decryptdata,fatal:!0,networkDetails:c,response:{url:o,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${o}). Status: ${c.status} (${c.statusText})`));else{const m=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(t,e).then(n,a)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=c,this.setupLicenseXHR(c,o,t,e).then(({xhr:d,licenseChallenge:f})=>{t.keySystem==ne.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(d,f)),d.send(f)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const i=e.media;this.media=i,Ve(i,"encrypted",this.onMediaEncrypted),Ve(i,"waitingforkey",this.onWaitingForKey);const n=this.mediaResolved;n?n():this.mediaKeys=i.mediaKeys}onMediaDetached(){const t=this.media;t&&(ei(t,"encrypted",this.onMediaEncrypted),ei(t,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var t;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const e=this.mediaResolved;if(e&&e(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const i=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Rn.clearKeyUriToKeyIdMap();const a=n.length;Lr.CDMCleanupPromise=Promise.all(n.map(o=>this.removeSession(o)).concat((i==null||(t=i.setMediaKeys(null))==null?void 0:t.catch(o=>{this.log(`Could not clear media keys: ${o}`),this.hls&&this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${o}`)})}))||Promise.resolve())).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}`),this.hls&&this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${o}`)})}).then(()=>{a&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(t,{sessionKeys:e}){if(!(!e||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=e.reduce((n,a)=>(n.indexOf(a.keyFormat)===-1&&n.push(a.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:i,decryptdata:n}=t;if(e){this.log(`Remove licenses and keys and close session "${e.sessionId}" keyId: ${ze(n?.keyId||[])}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(t);a>-1&&this.mediaKeySessions.splice(a,1);const{keyStatusTimeouts:o}=t;o&&Object.keys(o).forEach(f=>self.clearTimeout(o[f]));const{drmSystemOptions:c}=this.config;return(Kb(c)?new Promise((f,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),e.remove().then(f).catch(m)}):Promise.resolve()).catch(f=>{this.log(`Could not remove session: ${f}`),this.hls&&this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${f}`)})}).then(()=>e.close()).catch(f=>{this.log(`Could not close session: ${f}`),this.hls&&this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${f}`)})})}return Promise.resolve()}}Lr.CDMCleanupPromise=void 0;function po(l){if(!l)throw new Error("Could not read keyId of undefined decryptdata");if(l.keyId===null)throw new Error("keyId is null");return ze(l.keyId)}function fR(l,t){if(l.keyId&&t.mediaKeysSession.keyStatuses.has(l.keyId))return t.mediaKeysSession.keyStatuses.get(l.keyId);if(l.matches(t.decryptdata))return t.keyStatus}class ui extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function iy(l,t){const e=l==="output-restricted",i=e?q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:q.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new ui({type:vt.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},e?"HDCP level output restricted":`key status changed to "${l}"`)}class dR{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const n=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){const n=performance.now();if(e){if(this.lastTime){const a=n-this.lastTime,o=i-this.lastDroppedFrames,c=e-this.lastDecodedFrames,d=1e3*o/a,f=this.hls;if(f.trigger(R.FPS_DROP,{currentDropped:o,currentDecoded:c,totalDroppedFrames:i}),d>0&&o>f.config.fpsDroppedMonitoringThreshold*c){let m=f.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=m)&&(m=m-1,f.trigger(R.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:f.currentLevel}),f.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}function tE(l,t){let e;try{e=new Event("addtrack")}catch{e=document.createEvent("Event"),e.initEvent("addtrack",!1,!1)}e.track=l,t.dispatchEvent(e)}function eE(l,t){const e=l.mode;if(e==="disabled"&&(l.mode="hidden"),l.cues&&!l.cues.getCueById(t.id))try{if(l.addCue(t),!l.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){Vt.debug(`[texttrack-utils]: ${i}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,l.addCue(n)}catch(n){Vt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}e==="disabled"&&(l.mode=e)}function xr(l,t){const e=l.mode;if(e==="disabled"&&(l.mode="hidden"),l.cues)for(let i=l.cues.length;i--;)t&&l.cues[i].removeEventListener("enter",t),l.removeCue(l.cues[i]);e==="disabled"&&(l.mode=e)}function od(l,t,e,i){const n=l.mode;if(n==="disabled"&&(l.mode="hidden"),l.cues&&l.cues.length>0){const a=mR(l.cues,t,e);for(let o=0;o<a.length;o++)(!i||i(a[o]))&&l.removeCue(a[o])}n==="disabled"&&(l.mode=n)}function hR(l,t){if(t<=l[0].startTime)return 0;const e=l.length-1;if(t>l[e].endTime)return-1;let i=0,n=e,a;for(;i<=n;)if(a=Math.floor((n+i)/2),t<l[a].startTime)n=a-1;else if(t>l[a].startTime&&i<e)i=a+1;else return a;return l[i].startTime-t<t-l[n].startTime?i:n}function mR(l,t,e){const i=[],n=hR(l,t);if(n>-1)for(let a=n,o=l.length;a<o;a++){const c=l[a];if(c.startTime>=t&&c.endTime<=e)i.push(c);else if(c.startTime>e)return i}return i}function Co(l){const t=[];for(let e=0;e<l.length;e++){const i=l[e];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&t.push(l[e])}return t}class pR extends Nd{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const i=Co(this.media.textTracks);for(let a=0;a<i.length;a++)if(i[a].mode==="hidden")e=i[a];else if(i[a].mode==="showing"){e=i[a];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.LEVEL_LOADING,this.onLevelLoading,this),t.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.LEVEL_LOADING,this.onLevelLoading,this),t.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(R.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const i=this.media;if(!i)return;const n=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;Co(i.textTracks).forEach(o=>{xr(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:n,details:a}=e,o=this.tracksInGroup[i];if(!o||o.groupId!==n){this.warn(`Subtitle track with id:${i} and group:${n} not found in active group ${o?.groupId}`);return}const c=o.details;o.details=e.details,this.log(`Subtitle track ${i} "${o.name}" lang:${o.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,c)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,n=this.groupIds;let a=this.currentTrack;if(!i||n?.length!==i?.length||i!=null&&i.some(o=>n?.indexOf(o)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(m=>!i||i.indexOf(m.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(m=>m.default)&&(this.selectDefaultTrack=!1),o.forEach((m,p)=>{m.id=p});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const c=this.hls.config.subtitlePreference;if(!a&&c){this.selectDefaultTrack=!1;const m=Gi(c,o);if(m>-1)a=o[m];else{const p=Gi(c,this.tracks);a=this.tracks[p]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const f={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${i?.join(",")}" group-id`),this.hls.trigger(R.SUBTITLE_TRACKS_UPDATED,f),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let n=0;n<e.length;n++){const a=e[n];if(!(i&&!a.default||!i&&!t)&&(!t||Ln(a,t)))return n}if(t){for(let n=0;n<e.length;n++){const a=e[n];if(Fa(t.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<e.length;n++){const a=e[n];if(Fa(t.attrs,a.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const n=e[i];if(nd(n,t))return i}}return-1}onError(t,e){e.fatal||!e.context||e.context.type===wt.SUBTITLE_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(t.id===-1)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&Ln(t,i))return i;const n=Gi(t,this.tracksInGroup);if(n>-1){const a=this.tracksInGroup[n];return this.setSubtitleTrack(n),a}else{if(i)return null;{const a=Gi(t,e);if(a>-1)return e[a]}}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,n=t.groupId,a=this.getUrlWithDirectives(t.url,e),o=t.details,c=o?.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${n}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${a}`),this.hls.trigger(R.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=Co(t.textTracks),i=this.currentTrack;let n;if(i&&(n=e.filter(a=>nd(i,a))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach(a=>{a.mode!=="disabled"&&a!==n&&(a.mode="disabled")}),n){const a=this.subtitleDisplay?"showing":"hidden";n.mode!==a&&(n.mode=a)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=e.length||!ht(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,n=e[t]||null;if(this.trackId=t,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:t});return}const a=!!n.details&&!n.details.live;if(t===this.trackId&&n===i&&a)return;this.log(`Switching to subtitle-track ${t}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:o,groupId:c="",name:d,type:f,url:m}=n;this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:o,groupId:c,name:d,type:f,url:m});const p=this.switchParams(n.url,i?.details,n.details);this.loadPlaylist(p)}}function gR(){try{return crypto.randomUUID()}catch{try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch{let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const a=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(n=="x"?a:a&3|8).toString(16)})}}}function Ca(l){let t=5381,e=l.length;for(;e;)t=t*33^l.charCodeAt(--e);return(t>>>0).toString()}const Rr=.025;let Ho=(function(l){return l[l.Point=0]="Point",l[l.Range=1]="Range",l})({});function yR(l,t,e){return`${l.identifier}-${e+1}-${Ca(t)}`}class vR{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,(t=this.assetListLoader)==null||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const i=this.playoutLimit;return t<=0||isNaN(i)?!1:i===0?!0:(((e=this.assetList[t])==null?void 0:e.startOffset)||0)>i}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return Of(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime,i=Of(e,t);return e-i<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=ht(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return Of(t,e)}return t}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Rr))}set appendInPlace(t){if(this.appendInPlaceStarted){this.resetOnResume=!t;return}this.appendInPlaceDisabled=!t}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return this._duration!==null?e=this._duration:this.dateRange.duration?e=this.dateRange.duration:e=this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Ho.Range:Ho.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return ER(this)}}function Of(l,t){return l-t.start<t.duration/2&&!(Math.abs(l-(t.start+t.duration))<Rr)?t.start:t.start+t.duration}function iE(l,t,e){const i=new self.URL(l,e);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",t),i}function Mf(l,t){for(;(e=l.assetList[++t])!=null&&e.error;)var e;return t}function ER(l){return`["${l.identifier}" ${l.cue.pre?"<pre>":l.cue.post?"<post>":""}${l.timelineStart.toFixed(2)}-${l.resumeTime.toFixed(2)}]`}function Sr(l){const t=l.timelineStart,e=l.duration||0;return`["${l.identifier}" ${t.toFixed(2)}-${(t+e).toFixed(2)}]`}class SR{constructor(t,e,i,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(R.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new t(e);this.interstitial=i,this.assetItem=n;const o=()=>{this.hasDetails=!0};a.once(R.LEVEL_LOADED,o),a.once(R.AUDIO_TRACK_LOADED,o),a.once(R.SUBTITLE_TRACK_LOADED,o),a.on(R.MEDIA_ATTACHING,(c,{media:d})=>{this.removeMediaListeners(),this.mediaAttached=d,this.interstitial.playoutLimit&&(d.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(R.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,a.trigger(R.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=iE(e,t.config.primarySessionId||"").href}catch{}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if((e=this.hls)!=null&&e.bufferedToEnd)return!0;if(!t)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,a=At.bufferInfo(t,n,0);return this.getAssetTime(a.end)>=i-.02}reachedPlayout(t){const i=this.interstitial.playoutLimit;return this.startOffset+t>=i}get destroyed(){var t;return!((t=this.hls)!=null&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return((t=this.hls)==null?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=At.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const i=e-this.startOffset;if(i>0&&i<t)return i}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return((t=this.hls)==null?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const i=t-e;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,t-e),i)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var t;(t=this.hls)!=null&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),(e=this.hls)==null||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,(t=this.hls)==null||t.detachMedia()}resumeBuffering(){var t;(t=this.hls)==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.hls)==null||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),((t=this.hls)==null?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=i=>delete i.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,i){var n;(n=this.hls)==null||n.on(t,e)}once(t,e,i){var n;(n=this.hls)==null||n.once(t,e)}off(t,e,i){var n;(n=this.hls)==null||n.off(t,e)}toString(){var t;return`HlsAssetPlayer: ${Sr(this.assetItem)} ${(t=this.hls)==null?void 0:t.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const sy=.033;class TR extends Ri{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((i,n)=>t<=n.startOffset&&e>n.startOffset?(delete n.error,i+1):i,0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);const n=this.items;if(n)for(n[i]||(e===void 0&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&(a=n[i])!=null&&a.event;){var a;i--}return i}findItemIndexAtTime(t,e){const i=this.items;if(i)for(let n=0;n<i.length;n++){let a=i[n];if(e&&e!=="primary"&&(a=a[e]),t===a.start||t>a.start&&t<a.end)return n}return-1}findJumpRestrictedIndex(t,e){const i=this.items;if(i)for(let n=t;n<=e&&i[n];n++){const a=i[n].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return n}return-1}findEventIndex(t){const e=this.items;if(e)for(let n=e.length;n--;){var i;if(((i=e[n].event)==null?void 0:i.identifier)===t)return n}return-1}findAssetIndex(t,e){const i=t.assetList,n=i.length;if(n>1)for(let a=0;a<n;a++){const o=i[a];if(!o.error){const c=o.timelineStart;if(e===c||e>c&&(e<c+(o.duration||0)||a===n-1))return a}}return 0}get assetIdAtEnd(){var t;const e=(t=this.items)==null||(t=t[this.length-1])==null?void 0:t.event;if(e){const i=e.assetList,n=i[i.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(t,e){const i=t.main.details,{dateRanges:n}=i,a=this.events,o=this.parseDateRanges(n,{url:i.url},e),c=Object.keys(n),d=a?a.filter(f=>!c.includes(f.identifier)):[];o.length&&o.sort((f,m)=>{const p=f.cue.pre,g=f.cue.post,v=m.cue.pre,E=m.cue.post;if(p&&!v)return-1;if(v&&!p||g&&!E)return 1;if(E&&!g)return-1;if(!p&&!v&&!g&&!E){const x=f.startTime,T=m.startTime;if(x!==T)return x-T}return f.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=o,d.forEach(f=>{this.removeEvent(f)}),this.updateSchedule(t,d)}updateSchedule(t,e=[],i=!1){const n=this.events||[];if(n.length||e.length||this.length<2){const a=this.items,o=this.parseSchedule(n,t);(i||e.length||a?.length!==o.length||o.some((d,f)=>Math.abs(d.playout.start-a[f].playout.start)>.005||Math.abs(d.playout.end-a[f].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(e,a))}}parseDateRanges(t,e,i){const n=[],a=Object.keys(t);for(let o=0;o<a.length;o++){const c=a[o],d=t[c];if(d.isInterstitial){let f=this.eventMap[c];f?f.setDateRange(d):(f=new vR(d,e),this.eventMap[c]=f,i===!1&&(f.appendInPlace=i)),n.push(f)}}return n}parseSchedule(t,e){const i=[],n=e.main.details,a=n.live?1/0:n.edge;let o=0;if(t=t.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),t.length){this.resolveOffsets(t,e);let d=0,f=0;if(t.forEach((m,p)=>{const g=m.cue.pre,v=m.cue.post,E=t[p-1]||null,x=m.appendInPlace,T=v?a:m.startOffset,A=m.duration,b=m.timelineOccupancy===Ho.Range?A:0,_=m.resumptionOffset,I=E?.startTime===T,C=T+m.cumulativeDuration;let N=x?C+A:T+_;if(g||!v&&T<=0){const P=f;f+=b,m.timelineStart=C;const B=o;o+=A,i.push({event:m,start:C,end:N,playout:{start:B,end:o},integrated:{start:P,end:f}})}else if(T<=a){if(!I){const M=T-d;if(M>sy){const K=d,tt=f;f+=M;const H=o;o+=M;const G={previousEvent:t[p-1]||null,nextEvent:m,start:K,end:K+M,playout:{start:H,end:o},integrated:{start:tt,end:f}};i.push(G)}else M>0&&E&&(E.cumulativeDuration+=M,i[i.length-1].end=T)}v&&(N=C),m.timelineStart=C;const P=f;f+=b;const B=o;o+=A,i.push({event:m,start:C,end:N,playout:{start:B,end:o},integrated:{start:P,end:f}})}else return;const w=m.resumeTime;v||w>a?d=a:d=w}),d<a){var c;const m=d,p=f,g=a-d;f+=g;const v=o;o+=g,i.push({previousEvent:((c=i[i.length-1])==null?void 0:c.event)||null,nextEvent:null,start:d,end:m+g,playout:{start:v,end:o},integrated:{start:p,end:f}})}this.setDurations(a,o,f)}else i.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){const i=e.main.details,n=i.live?1/0:i.edge;let a=0,o=-1;t.forEach((c,d)=>{const f=c.cue.pre,m=c.cue.post,p=f?0:m?n:c.startTime;this.updateAssetDurations(c),o===p?c.cumulativeDuration=a:(a=0,o=p),!m&&c.snapOptions.in&&(c.resumeAnchor=_n(null,i.fragments,c.startOffset+c.resumptionOffset,0,0)||void 0),c.appendInPlace&&!c.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(c,e)||(c.appendInPlace=!1)),!c.appendInPlace&&d+1<t.length&&t[d+1].startTime-t[d].resumeTime<sy&&(t[d+1].appendInPlace=!1,t[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${c}`));const v=ht(c.resumeOffset)?c.resumeOffset:c.duration;a+=v})}primaryCanResumeInPlaceAt(t,e){const i=t.resumeTime,n=t.startTime+t.resumptionOffset;return Math.abs(i-n)>Rr?(this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${n}`),!1):!Object.keys(e).some(o=>{const c=e[o].details,d=c.edge;if(i>=d)return this.log(`"${t.identifier}" resumption ${i} past ${o} playlist end ${d}`),!1;const f=_n(null,c.fragments,i);if(!f)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${o} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const m=o==="audio"?.175:0;return Math.abs(f.start-i)<Rr+m||Math.abs(f.end-i)<Rr+m?!1:(this.log(`"${t.identifier}" resumption ${i} not aligned with ${o} fragment bounds (${f.start}-${f.end} sn: ${f.sn} cc: ${f.cc})`),!0)})}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let i=0,n=!1,a=!1;for(let o=0;o<t.assetList.length;o++){const c=t.assetList[o],d=e+i;c.startOffset=i,c.timelineStart=d,n||(n=c.duration===null),a||(a=!!c.error);const f=c.error?0:c.duration||0;i+=f}n&&!a?t.duration=Math.max(i,t.duration):t.duration=i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function Ci(l){return`[${l.event?'"'+l.event.identifier+'"':"primary"}: ${l.start.toFixed(2)}-${l.end.toFixed(2)}]`}class xR{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const i=t.assetListUrl;let n;try{n=iE(i,this.hls.sessionId,t.baseUrl)}catch(g){const v=this.assignAssetListError(t,q.ASSET_LIST_LOAD_ERROR,g,i);this.hls.trigger(R.ERROR,v);return}e&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+e);const a=this.hls.config,o=a.loader,c=new o(a),d={responseType:"json",url:n.href},f=a.interstitialAssetListLoadPolicy.default,m={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,E,x)=>{const T=g.data,A=T?.ASSETS;if(!Array.isArray(A)){const b=this.assignAssetListError(t,q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),E.url,v,x);this.hls.trigger(R.ERROR,b);return}t.assetListResponse=T,this.hls.trigger(R.ASSET_LIST_LOADED,{event:t,assetListResponse:T,networkDetails:x})},onError:(g,v,E,x)=>{const T=this.assignAssetListError(t,q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${g.code} ${g.text} (${v.url})`),v.url,x,E);this.hls.trigger(R.ERROR,T)},onTimeout:(g,v,E)=>{const x=this.assignAssetListError(t,q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,g,E);this.hls.trigger(R.ERROR,x)}};return c.load(d,m,p),this.hls.trigger(R.ASSET_LIST_LOADING,{event:t}),c}assignAssetListError(t,e,i,n,a,o){return t.error=i,{type:vt.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:n,error:i,networkDetails:o,stats:a}}}function ny(l){var t;l==null||(t=l.play())==null||t.catch(()=>{})}function go(l,t){return`[${l}] Advancing timeline position to ${t}`}class bR extends Ri{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const n=i-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const o=n<=-.01;this.timelinePos=i,this.bufferedPos=i;const c=this.playingItem;if(!c){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(i,i-n)&&this.updateSchedule(!0),this.checkBuffer(),o&&i<c.start||i>=c.end){var d;const v=this.findItemIndex(c);let E=this.schedule.findItemIndexAtTime(i);if(E===-1&&(E=v+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${i} (resolving from ${v} to ${E})`)),!this.isInterstitial(c)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!o&&E>v){const x=this.schedule.findJumpRestrictedIndex(v+1,E);if(x>v){this.setSchedulePosition(x);return}}this.setSchedulePosition(E);return}const f=this.playingAsset;if(!f){if(this.playingLastItem&&this.isInterstitial(c)){const v=c.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,v))}return}const m=f.timelineStart,p=f.duration||0;if(o&&i<m||i>=m+p){var g;(g=c.event)!=null&&g.appendInPlace&&(this.clearInterstitial(c.event,c),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,f)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(i>=n.end){this.timelinePos=n.end;const c=this.findItemIndex(n);this.setSchedulePosition(c+1)}const a=this.playingAsset;if(!a)return;const o=a.timelineStart+(a.duration||0);i>=o&&this.setScheduleToAssetAtTime(i,a)},this.onScheduleUpdate=(i,n)=>{const a=this.schedule;if(!a)return;const o=this.playingItem,c=a.events||[],d=a.items||[],f=a.durations,m=i.map(x=>x.identifier),p=!!(c.length||m.length);(p||n)&&this.log(`INTERSTITIALS_UPDATED (${c.length}): ${c}
Schedule: ${d.map(x=>Ci(x))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let g=null,v=null;o&&(g=this.updateItem(o,this.timelinePos),this.itemsMatch(o,g)?this.playingItem=g:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const E=this.bufferingItem;if(E&&(v=this.updateItem(E,this.bufferedPos),this.itemsMatch(E,v)?this.bufferingItem=v:E.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(E.event,null))),i.forEach(x=>{x.assetList.forEach(T=>{this.clearAssetPlayer(T.identifier,null)})}),this.playerQueue.forEach(x=>{if(x.interstitial.appendInPlace){const T=x.assetItem.timelineStart,A=x.timelineOffset-T;if(A)try{x.timelineOffset=T}catch(b){Math.abs(A)>Rr&&this.warn(`${b} ("${x.assetId}" ${x.timelineOffset}->${T})`)}}}),p||n){if(this.hls.trigger(R.INTERSTITIALS_UPDATED,{events:c.slice(0),schedule:d.slice(0),durations:f,removedIds:m}),this.isInterstitial(o)&&m.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(g,o),E&&v!==g&&this.trimInPlace(v,E),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new xR(t),this.schedule=new TR(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(R.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(R.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(R.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(R.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(R.BUFFER_APPENDED,this.onBufferAppended,this),t.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(R.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(R.MEDIA_ENDED,this.onMediaEnded,this),t.on(R.ERROR,this.onError,this),t.on(R.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(R.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(R.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(R.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(R.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(R.BUFFER_CODECS,this.onBufferCodecs,this),t.off(R.BUFFER_APPENDED,this.onBufferAppended,this),t.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(R.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(R.MEDIA_ENDED,this.onMediaEnded,this),t.off(R.ERROR,this.onError,this),t.off(R.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;(t=this.getBufferingPlayer())==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.getBufferingPlayer())==null||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){ei(t,"play",this.onPlay),ei(t,"pause",this.onPause),ei(t,"seeking",this.onSeeking),ei(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const i=this.media=e.media;Ve(i,"seeking",this.onSeeking),Ve(i,"timeupdate",this.onTimeupdate),Ve(i,"play",this.onPlay),Ve(i,"pause",this.onPause)}onMediaAttached(t,e){const i=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!n){this.clearScheduleState();const a=this.findItemIndex(i);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const i=!!e.transferMedia,n=this.media;if(this.media=null,!i&&(n&&this.removeMediaListeners(n),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,i=p=>p&&t.getAssetPlayer(p.identifier),n=(p,g,v,E,x)=>{if(p){let T=p[g].start;const A=p.event;if(A){if(g==="playout"||A.timelineOccupancy!==Ho.Point){const b=i(v);b?.interstitial===A&&(T+=b.assetItem.startOffset+b[x])}}else{const b=E==="bufferedPos"?o():t[E];T+=b-p.start}return T}return 0},a=(p,g)=>{var v;if(p!==0&&g!=="primary"&&(v=t.schedule)!=null&&v.length){var E;const x=t.schedule.findItemIndexAtTime(p),T=(E=t.schedule.items)==null?void 0:E[x];if(T){const A=T[g].start-T.start;return p+A}}return p},o=()=>{const p=t.bufferedPos;return p===Number.MAX_VALUE?c("primary"):Math.max(p,0)},c=p=>{var g,v;return(g=t.primaryDetails)!=null&&g.live?t.primaryDetails.edge:((v=t.schedule)==null?void 0:v.durations[p])||0},d=(p,g)=>{var v,E;const x=t.effectivePlayingItem;if(x!=null&&(v=x.event)!=null&&v.restrictions.skip||!t.schedule)return;t.log(`seek to ${p} "${g}"`);const T=t.effectivePlayingItem,A=t.schedule.findItemIndexAtTime(p,g),b=(E=t.schedule.items)==null?void 0:E[A],_=t.getBufferingPlayer(),I=_?.interstitial,C=I?.appendInPlace,N=T&&t.itemsMatch(T,b);if(T&&(C||N)){const w=i(t.playingAsset),P=w?.media||t.primaryMedia;if(P){const B=g==="primary"?P.currentTime:n(T,g,t.playingAsset,"timelinePos","currentTime"),M=p-B,K=(C?B:P.currentTime)+M;if(K>=0&&(!w||C||K<=w.duration)){P.currentTime=K;return}}}if(b){let w=p;if(g!=="primary"){const B=b[g].start,M=p-B;w=b.start+M}const P=!t.isInterstitial(b);if((!t.isInterstitial(T)||T.event.appendInPlace)&&(P||b.event.appendInPlace)){const B=t.media||(C?_?.media:null);B&&(B.currentTime=w)}else if(T){const B=t.findItemIndex(T);if(A>B){const K=t.schedule.findJumpRestrictedIndex(B+1,A);if(K>B){t.setSchedulePosition(K);return}}let M=0;if(P)t.timelinePos=w,t.checkBuffer();else{const K=b.event.assetList,tt=p-(b[g]||b).start;for(let H=K.length;H--;){const G=K[H];if(G.duration&&tt>=G.startOffset&&tt<G.startOffset+G.duration){M=H;break}}}t.setSchedulePosition(A,M)}}},f=()=>{const p=t.effectivePlayingItem;if(t.isInterstitial(p))return p;const g=e();return t.isInterstitial(g)?g:null},m={get bufferedEnd(){const p=e(),g=t.bufferingItem;if(g&&g===p){var v;return n(g,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-g.playout.start||((v=t.bufferingAsset)==null?void 0:v.startOffset)||0}return 0},get currentTime(){const p=f(),g=t.effectivePlayingItem;return g&&g===p?n(g,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-g.playout.start:0},set currentTime(p){const g=f(),v=t.effectivePlayingItem;v&&v===g&&d(p+v.playout.start,"playout")},get duration(){const p=f();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const g=(p=f())==null?void 0:p.event.assetList;return g?g.map(v=>t.getAssetPlayer(v.identifier)):[]},get playingIndex(){var p;const g=(p=f())==null?void 0:p.event;return g&&t.effectivePlayingAsset?g.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return f()}};return this.manager={get events(){var p;return((p=t.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=t.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return f()?m:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const p=e();return t.findItemIndex(p)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const p=t.effectivePlayingItem;return t.findItemIndex(p)},primary:{get bufferedEnd(){return o()},get currentTime(){const p=t.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return c("primary")},get seekableStart(){var p;return((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return c("integrated")},get seekableStart(){var p;return a(((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=t.effectivePlayingItem,g=p?.event;if(g&&!g.restrictions.skip){const v=t.findItemIndex(p);if(g.appendInPlace){const E=p.playout.start+p.event.duration;d(E+.001,"playout")}else t.advanceAfterAssetEnded(g,v,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,i=(t=this.schedule)==null?void 0:t.items;return!this.playbackStarted||!e||!i?!1:this.findItemIndex(e)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var t,e;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let n=this.media;!n&&(t=this.bufferingItem)!=null&&(t=t.event)!=null&&t.appendInPlace&&(n=this.primaryMedia);const a=(e=n)==null?void 0:e.currentTime;if(!(a===void 0||!ht(a)))return a}get primaryMedia(){var t;return this.media||((t=this.detachedData)==null?void 0:t.media)||null}isInterstitial(t){return!!(t!=null&&t.event)}retreiveMediaSource(t,e){const i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){const i=t.interstitial.appendInPlace,n=t.media;if(i&&n===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&n){this.detachedData={media:n};return}const a=t.transferMedia();this.log(`transfer MediaSource from ${t} ${Zt(a)}`),this.detachedData=a}else e&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(t,e){var i,n;if(t.media===e)return;let a=null;const o=this.hls,c=t!==o,d=c&&t.interstitial.appendInPlace,f=(i=this.detachedData)==null?void 0:i.mediaSource;let m;if(o.media)d&&(a=o.transferMedia(),this.detachedData=a),m="Primary";else if(f){const E=this.getBufferingPlayer();E?(a=E.transferMedia(),m=`${E}`):m="detached MediaSource"}else m="detached media";if(!a){if(f)a=this.detachedData,this.log(`using detachedData: MediaSource ${Zt(a)}`);else if(!this.detachedData||o.media===e){const E=this.playerQueue;E.length>1&&E.forEach(x=>{if(c&&x.interstitial.appendInPlace!==d){const T=x.interstitial;this.clearInterstitial(x.interstitial,null),T.appendInPlace=!1,T.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${T}`)}}),this.hls.detachMedia(),this.detachedData={media:e}}}const p=a&&"mediaSource"in a&&((n=a.mediaSource)==null?void 0:n.readyState)!=="closed",g=p&&a?a:e;this.log(`${p?"transfering MediaSource":"attaching media"} to ${c?t:"Primary"} from ${m} (media.currentTime: ${e.currentTime})`);const v=this.schedule;if(g===a&&v){const E=c&&t.assetId===v.assetIdAtEnd;g.overrides={duration:v.duration,endOfStream:!c||E,cueRemoval:!c}}t.attachMedia(g)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=t?.events;if(!e||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,n=this.effectivePlayingItem;if(i===-1){const a=this.hls.startPosition;if(this.log(go("checkStart",a)),this.timelinePos=a,e.length&&e[0].cue.pre){const o=t.findEventIndex(e[0].identifier);this.setSchedulePosition(o)}else if(a>=0||!this.primaryLive){const o=this.timelinePos=a>0?a:0,c=t.findItemIndexAtTime(o);this.setSchedulePosition(c)}}else if(n&&!this.playingItem){const a=t.findItemIndex(n);this.setSchedulePosition(a)}}advanceAssetBuffering(t,e){const i=t.event,n=i.findAssetIndex(e),a=Mf(i,n);if(!i.isAssetPastPlayoutLimit(a))this.bufferedToEvent(t,a);else if(this.schedule){var o;const c=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(t)+1];c&&this.bufferedToItem(c)}}advanceAfterAssetEnded(t,e,i){const n=Mf(t,i);if(t.isAssetPastPlayoutLimit(n)){if(this.schedule){const a=this.schedule.items;if(a){const o=e+1,c=a.length;if(o>=c){this.setSchedulePosition(-1);return}const d=t.resumeTime;this.timelinePos<d&&(this.log(go("advanceAfterAssetEnded",d)),this.timelinePos=d,t.appendInPlace&&this.advanceInPlace(d),this.checkBuffer(this.bufferedPos<d)),this.setSchedulePosition(o)}}}else{if(t.appendInPlace){const a=t.assetList[n];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(e,n)}}setScheduleToAssetAtTime(t,e){const i=this.schedule;if(!i)return;const n=e.parentIdentifier,a=i.getEvent(n);if(a){const o=i.findEventIndex(n),c=i.findAssetIndex(a,t);this.advanceAfterAssetEnded(a,o,c-1)}}setSchedulePosition(t,e){var i;const n=(i=this.schedule)==null?void 0:i.items;if(!n||this.playbackDisabled)return;const a=t>=0?n[t]:null;this.log(`setSchedulePosition ${t}, ${e} (${a&&Ci(a)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,c=this.playingLastItem;if(this.isInterstitial(o)){const m=o.event,p=this.playingAsset,g=p?.identifier,v=g?this.getAssetPlayer(g):null;if(v&&g&&(!this.eventItemsMatch(o,a)||e!==void 0&&g!==m.assetList[e].identifier)){var d;const E=m.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${E+1}/${m.assetList.length} ${Sr(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(R.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:E,event:m,schedule:n.slice(0),scheduleIndex:t,player:v}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),E);return}this.retreiveMediaSource(g,a),v.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(o,a)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${Ci(o)}`),m.hasPlayed=!0,this.hls.trigger(R.INTERSTITIAL_ENDED,{event:m,schedule:n.slice(0),scheduleIndex:t}),m.cue.once)){var f;this.updateSchedule();const E=(f=this.schedule)==null?void 0:f.items;if(a&&E){const x=this.findItemIndex(a);this.advanceSchedule(x,E,e,o,c)}return}}this.advanceSchedule(t,n,e,o,c)}advanceSchedule(t,e,i,n,a){const o=this.schedule;if(!o)return;const c=e[t]||null,d=this.primaryMedia,f=this.playerQueue;if(f.length&&f.forEach(m=>{const p=m.interstitial,g=o.findEventIndex(p.identifier);(g<t||g>t+1)&&this.clearInterstitial(p,c)}),this.isInterstitial(c)){this.timelinePos=Math.min(Math.max(this.timelinePos,c.start),c.end);const m=c.event;if(i===void 0){i=o.findAssetIndex(m,this.timelinePos);const E=Mf(m,i-1);if(m.isAssetPastPlayoutLimit(E)||m.appendInPlace&&this.timelinePos===c.end){this.advanceAfterAssetEnded(m,t,i);return}i=E}const p=this.waitingItem;this.assetsBuffered(c,d)||this.setBufferingItem(c);let g=this.preloadAssets(m,i);if(this.eventItemsMatch(c,p||n)||(this.waitingItem=c,this.log(`INTERSTITIAL_STARTED ${Ci(c)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(R.INTERSTITIAL_STARTED,{event:m,schedule:e.slice(0),scheduleIndex:t})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!d){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=c;const v=m.assetList[i];if(!v){this.advanceAfterAssetEnded(m,t,i||0);return}if(g||(g=this.getAssetPlayer(v.identifier)),g===null||g.destroyed){const E=m.assetList.length;this.warn(`asset ${i+1}/${E} player destroyed ${m}`),g=this.createAssetPlayer(m,v,i),g.loadSource()}if(!this.eventItemsMatch(c,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(g,i,e,t,d),this.shouldPlay&&ny(g.media)}else c?(this.resumePrimary(c,t,n),this.shouldPlay&&ny(this.hls.media)):a&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var t;return(t=this.mediaSelection)==null?void 0:t.main.details}get primaryLive(){var t;return!!((t=this.primaryDetails)!=null&&t.live)}resumePrimary(t,e,i){var n,a;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${Ci(t)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let c=this.timelinePos;(c<t.start||c>=t.end)&&(c=this.getPrimaryResumption(t,e),this.log(go("resumePrimary",c)),this.timelinePos=c),this.attachPrimary(c,t)}if(!i)return;const o=(a=this.schedule)==null?void 0:a.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Ci(t)}`),this.hls.trigger(R.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const i=t.start;if(this.primaryLive){const n=this.primaryDetails;if(e===0)return this.hls.startPosition;if(n&&(i<n.fragmentStart||i>n.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);return e!=null&&e.hls?e.hls.bufferedToEnd:At.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,n),i&&this.startLoadingPrimaryAt(t,i)),i||(this.log(go("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((i=n.mainForwardBufferInfo)==null?void 0:i.start)||n.media.currentTime)-t)>.5?n.startLoad(t,e):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),(t=this.schedule)==null||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(R.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(R.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(e.level===-1||!this.schedule)return;const i=this.hls.levels[e.level];if(!i.details)return;const n=zt(zt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const i=this.hls.audioTracks[e.id],n=this.mediaSelection;if(!n){this.altSelection=zt(zt({},this.altSelection),{},{audio:i});return}const a=zt(zt({},n),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(t,e){const i=this.hls.subtitleTracks[e.id],n=this.mediaSelection;if(!n){this.altSelection=zt(zt({},this.altSelection),{},{subtitles:i});return}const a=zt(zt({},n),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(t,e){const i=h0(e);this.playerQueue.forEach(({hls:n})=>n&&(n.setAudioOption(e)||n.setAudioOption(i)))}onSubtitleTrackSwitch(t,e){const i=h0(e);this.playerQueue.forEach(({hls:n})=>n&&(n.setSubtitleOption(e)||e.id!==-1&&n.setSubtitleOption(i)))}onBufferCodecs(t,e){const i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let n=0;n<e.length;n++){const a=e[n];if(a.cue.post){var i;const o=this.schedule.findEventIndex(a.identifier),c=(i=this.schedule.items)==null?void 0:i[o];this.isInterstitial(c)&&this.eventItemsMatch(c,this.bufferingItem)&&this.bufferedToItem(c,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const i=this.findItemIndex(e);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(t,e){var i;const n=(i=this.schedule)==null?void 0:i.items;if(t&&n){const a=this.findItemIndex(t,e);return n[a]||null}return null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach((a,o)=>{t.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(a.identifier,null)});const i=t.end+.25,n=At.bufferInfo(this.primaryMedia,i,0);(n.end>i||(n.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${Ci(t)} (was ${Ci(e)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===((i=e.event)==null?void 0:i.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(t=!1){var e;const i=this.mediaSelection;i&&((e=this.schedule)==null||e.updateSchedule(i,[],t))}checkBuffer(t){var e;const i=(e=this.schedule)==null?void 0:e.items;if(!i)return;const n=At.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=n.len<1),this.updateBufferedPos(n.end,i,t)}updateBufferedPos(t,e,i){const n=this.schedule,a=this.bufferingItem;if(this.bufferedPos>t||!n)return;if(e.length===1&&this.itemsMatch(e[0],a)){this.bufferedPos=t;return}const o=this.playingItem,c=this.findItemIndex(o);let d=n.findItemIndexAtTime(t);if(this.bufferedPos<t){var f;const m=this.findItemIndex(a),p=Math.min(m+1,e.length-1),g=e[p];if((d===-1&&a&&t>=a.end||(f=g.event)!=null&&f.appendInPlace&&t+.01>=g.start)&&(d=p),this.isInterstitial(a)){const v=a.event;if(p-c>1&&v.appendInPlace===!1||v.assetList.length===0&&v.assetListLoader)return}if(this.bufferedPos=t,d>m&&d>c)this.bufferedToItem(g);else{const v=this.primaryDetails;this.primaryLive&&v&&t>v.edge-v.targetduration&&g.start<v.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else i&&o&&!this.itemsMatch(o,a)&&(d===c?this.bufferedToItem(o):d===c+1&&this.bufferedToItem(e[d]))}assetsBuffered(t,e){return t.event.assetList.length===0?!1:!t.event.assetList.some(n=>{const a=this.getAssetPlayer(n.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(e))})}setBufferingItem(t){const e=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(t,e)&&i){const{items:n,events:a}=i;if(!n||!a)return e;const o=this.isInterstitial(t),c=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const d=c?c.remaining:e?e.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Ci(t)}`+(e?` (${d.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const f=i.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach((m,p)=>{const g=this.getAssetPlayer(m.identifier);g&&(p===f&&g.loadSource(),g.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(f=>f.pauseBuffering());this.hls.trigger(R.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t,e=0){const i=this.setBufferingItem(t);if(!this.playbackDisabled){if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(i!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(t.start,t,!0):this.preloadPrimary(t):this.preloadPrimary(t)}}}preloadPrimary(t){const e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){const i=t.event,n=i.assetList.length===0&&!i.assetListLoader,a=i.cue.once;if(n||!a){const o=this.preloadAssets(i,e);if(o!=null&&o.interstitial.appendInPlace){const c=this.primaryMedia;c&&this.bufferAssetPlayer(o,c)}}}preloadAssets(t,e){const i=t.assetUrl,n=t.assetList.length,a=n===0&&!t.assetListLoader,o=t.cue.once;if(a){const d=t.timelineStart;if(t.appendInPlace){var c;const g=this.playingItem;!this.isInterstitial(g)&&(g==null||(c=g.nextEvent)==null?void 0:c.identifier)===t.identifier&&this.flushFrontBuffer(d+.25)}let f,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(t.cue.pre||t.cue.post)){const g=m-d;g>0&&(f=Math.round(g*1e3)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:n} ${t}${f?` live-start: ${m} start-offset: ${f}`:""}`),i)return this.createAsset(t,0,0,d,t.duration,i);const p=this.assetListLoader.loadAssetList(t,f);p&&(t.assetListLoader=p)}else if(!o&&n){for(let f=e;f<n;f++){const m=t.assetList[f],p=this.getAssetPlayerQueueIndex(m.identifier);(p===-1||this.playerQueue[p].destroyed)&&!m.error&&this.createAssetPlayer(t,m,f)}const d=t.assetList[e];if(d){const f=this.getAssetPlayer(d.identifier);return f&&f.loadSource(),f}}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`),Object.keys(e).forEach(n=>{this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e){for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i]}return null}createAsset(t,e,i,n,a,o){const c={parentIdentifier:t.identifier,identifier:yR(t,o,e),duration:a,startOffset:i,timelineStart:n,uri:o};return this.createAssetPlayer(t,c,e)}createAssetPlayer(t,e,i){const n=this.hls,a=n.userConfig;let o=a.videoPreference;const c=n.loadLevelObj||n.levels[n.currentLevel];(o||c)&&(o=Xt({},o),c.videoCodec&&(o.videoCodec=c.videoCodec),c.videoRange&&(o.allowedVideoRanges=[c.videoRange]));const d=n.audioTracks[n.audioTrack],f=n.subtitleTracks[n.subtitleTrack];let m=0;if(this.primaryLive||t.appendInPlace){const I=this.timelinePos-e.timelineStart;if(I>1){const C=e.duration;C&&I<C&&(m=I)}}const p=e.identifier,g=zt(zt({},a),{},{maxMaxBufferLength:Math.min(180,n.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:d||a.audioPreference,subtitlePreference:f||a.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(g.timelineOffset=e.timelineStart));const v=g.cmcd;v!=null&&v.sessionId&&v.contentId&&(g.cmcd=Xt({},v,{contentId:Ca(e.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${t} and asset ${p}`);const E=new SR(this.HlsPlayerClass,g,t,e);this.playerQueue.push(E),t.assetList[i]=e;let x=!0;const T=I=>{if(I.live){var C;const P=new Error(`Interstitials MUST be VOD assets ${t}`),B={fatal:!0,type:vt.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:P},M=((C=this.schedule)==null?void 0:C.findEventIndex(t.identifier))||-1;this.handleAssetItemError(B,t,M,i,P.message);return}const N=I.edge-I.fragmentStart,w=e.duration;(x||w===null||N>w)&&(x=!1,this.log(`Interstitial asset "${p}" duration change ${w} > ${N}`),e.duration=N,this.updateSchedule())};E.on(R.LEVEL_UPDATED,(I,{details:C})=>T(C)),E.on(R.LEVEL_PTS_UPDATED,(I,{details:C})=>T(C)),E.on(R.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const A=(I,C)=>{const N=this.getAssetPlayer(p);if(N&&C.tracks){N.off(R.BUFFER_CODECS,A),N.tracks=C.tracks;const w=this.primaryMedia;this.bufferingAsset===N.assetItem&&w&&!N.media&&this.bufferAssetPlayer(N,w)}};E.on(R.BUFFER_CODECS,A);const b=()=>{var I;const C=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${C}`),!C||!this.schedule)return;const N=this.schedule.findEventIndex(t.identifier),w=(I=this.schedule.items)==null?void 0:I[N];this.isInterstitial(w)&&this.advanceAssetBuffering(w,e)};E.on(R.BUFFERED_TO_END,b);const _=I=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const N=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,N,I)};return E.once(R.MEDIA_ENDED,_(i)),E.once(R.PLAYOUT_LIMIT_REACHED,_(1/0)),E.on(R.ERROR,(I,C)=>{if(!this.schedule)return;const N=this.getAssetPlayer(p);if(C.details===q.BUFFER_STALLED_ERROR){if(N!=null&&N.appendInPlace){this.handleInPlaceStall(t);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(C,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${C.error} ${t}`)}),E.on(R.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const C=new Error(`Asset player destroyed unexpectedly ${p}`),N={fatal:!0,type:vt.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(N,t,this.schedule.findEventIndex(t.identifier),i,C.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Sr(e)}`),this.hls.trigger(R.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:E}),E}clearInterstitial(t,e){t.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,e)}),t.reset()}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(e!==-1){this.log(`reset asset player "${t}" after error`);const i=this.playerQueue[e];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(t,e){const i=this.getAssetPlayerQueueIndex(t);if(i!==-1){const n=this.playerQueue[i];this.log(`clear ${n} toSegment: ${e&&Ci(e)}`),this.transferMediaFromPlayer(n,e),this.playerQueue.splice(i,1),n.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,n,a){const{interstitial:o,assetItem:c,assetId:d}=t,f=o.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=c,(!m||m.identifier!==d)&&(m&&(this.clearAssetPlayer(m.identifier,i[n]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${f} ${Sr(c)}`),this.hls.trigger(R.INTERSTITIAL_ASSET_STARTED,{asset:c,assetListIndex:e,event:o,schedule:i.slice(0),scheduleIndex:n,player:t})),this.bufferAssetPlayer(t,a)}bufferAssetPlayer(t,e){var i,n;if(!this.schedule)return;const{interstitial:a,assetItem:o}=t,c=this.schedule.findEventIndex(a.identifier),d=(i=this.schedule.items)==null?void 0:i[c];if(!d)return;t.loadSource(),this.setBufferingItem(d),this.bufferingAsset=o;const f=this.getBufferingPlayer();if(f===t)return;const m=a.appendInPlace;if(m&&f?.interstitial.appendInPlace===!1)return;const p=f?.tracks||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(m&&o!==this.playingAsset){if(!t.tracks){this.log(`Waiting for track info before buffering ${t}`);return}if(p&&!Fy(p,t.tracks)){const g=new Error(`Asset ${Sr(o)} SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),v={fatal:!0,type:vt.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:g},E=a.findAssetIndex(o);this.handleAssetItemError(v,a,c,E,g.message);return}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,i=this.primaryMedia;if(!e||!i)return;const n=i.currentTime,a=e.findAssetIndex(t,n),o=t.assetList[a];if(o){const c=this.getAssetPlayer(o.identifier);if(c){const d=c.currentTime||n-o.timelineStart,f=c.duration-d;if(this.warn(`Stalled at ${d} of ${d+f} in ${c} ${t} (media.currentTime: ${n})`),d&&(f/i.playbackRate<.5||c.bufferedInPlaceToEnd(i))&&c.hls){const m=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,m,a)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,i,n,a){if(t.details===q.BUFFER_STALLED_ERROR)return;const o=e.assetList[n]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&Sr(o)} ${t.error}`),!this.schedule)return;const c=o?.identifier||"",d=this.getAssetPlayerQueueIndex(c),f=this.playerQueue[d]||null,m=this.schedule.items,p=Xt({},t,{fatal:!1,errorAction:br(!0),asset:o,assetListIndex:n,event:e,schedule:m,scheduleIndex:i,player:f});if(this.hls.trigger(R.INTERSTITIAL_ASSET_ERROR,p),!t.fatal)return;const g=this.playingAsset,v=this.bufferingAsset,E=new Error(a);if(o&&(this.clearAssetPlayer(c,null),o.error=E),!e.assetList.some(x=>!x.error))e.error=E;else for(let x=n;x<e.assetList.length;x++)this.resetAssetPlayer(e.assetList[x].identifier);this.updateSchedule(!0),e.error?this.primaryFallback(e):g&&g.identifier===c?this.advanceAfterAssetEnded(e,i,n):v&&v.identifier===c&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,v)}primaryFallback(t){const e=t.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${Ci(i)} error: ${t.error}`);let n=this.timelinePos;n===-1&&(n=this.hls.startPosition);const a=this.updateItem(i,n);if(this.itemsMatch(i,a)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e)),!this.schedule)return;const o=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(t,e){var i,n;const a=e.event,o=a.identifier,c=e.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(o)))return;const d=a.timelineStart,f=a.duration;let m=0;c.forEach((x,T)=>{const A=parseFloat(x.DURATION);this.createAsset(a,T,m,d+m,A,x.URI),m+=A}),a.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${f}) ${a}`);const p=this.waitingItem,g=p?.event.identifier===o;this.updateSchedule();const v=(n=this.bufferingItem)==null?void 0:n.event;if(g){var E;const x=this.schedule.findEventIndex(o),T=(E=this.schedule.items)==null?void 0:E[x];if(T){if(!this.playingItem&&this.timelinePos>T.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==x){a.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${a}`),this.updateSchedule(!0),this.primaryFallback(a);return}this.setBufferingItem(T)}this.setSchedulePosition(x)}else if(v?.identifier===o){const x=a.assetList[0];if(x){const T=this.getAssetPlayer(x.identifier);if(v.appendInPlace){const A=this.primaryMedia;T&&A&&this.bufferAssetPlayer(T,A)}else T&&T.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case q.ASSET_LIST_PARSING_ERROR:case q.ASSET_LIST_LOAD_ERROR:case q.ASSET_LIST_LOAD_TIMEOUT:{const i=e.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case q.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const ry=500;class AR extends Id{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller",mt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(R.LEVEL_LOADED,this.onLevelLoaded,this),t.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(R.LEVEL_LOADED,this.onLevelLoaded,this),t.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=nt.IDLE,this.setInterval(ry),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:n}=e;if(this.fragContextChanged(i)||(Ee(i)&&(this.fragPrevious=i),this.state=nt.IDLE),!n)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let o;const c=i.start;for(let f=0;f<a.length;f++)if(c>=a[f].start&&c<=a[f].end){o=a[f];break}const d=i.start+i.duration;o?o.end=d:(o={start:c,end:d},a.push(o)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:i,endOffset:n}=e;if(i===0&&n!==Number.POSITIVE_INFINITY){const a=n-1;if(a<=0)return;e.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(o=>{for(let c=0;c<o.length;){if(o[c].end<=a){o.shift();continue}else if(o[c].start<a)o[c].start=a;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(i,a,mt.SUBTITLE)}}onError(t,e){const i=e.frag;i?.type===mt.SUBTITLE&&(e.details===q.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==nt.STOPPED&&(this.state=nt.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){if(this.levels&&jv(this.levels,e)){this.levels=e.map(i=>new Ma(i));return}this.tracksBuffered=[],this.levels=e.map(i=>{const n=new Ma(i);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,mt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==nt.STOPPED&&this.setInterval(ry)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:n,levels:a}=this,{details:o,id:c}=e;if(!a){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const d=a[c];if(c>=a.length||!d)return;this.log(`Subtitle track ${c} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(o.live||(i=d.details)!=null&&i.live){if(o.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const g=p.fragments[0];if(!d.details)o.hasProgramDateTime&&p.hasProgramDateTime?(jo(o,p),f=o.fragmentStart):g&&(f=g.start,ed(o,f));else{var m;f=this.alignPlaylists(o,d.details,(m=this.levelLastLoaded)==null?void 0:m.details),f===0&&g&&(f=g.start,ed(o,f))}p&&!this.startFragRequested&&this.setStartPosition(p,f)}d.details=o,this.levelLastLoaded=d,c===n&&(this.hls.trigger(R.SUBTITLE_TRACK_UPDATED,{details:o,id:c,groupId:e.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===nt.IDLE&&(_n(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,n=e.decryptdata,a=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&n!=null&&n.key&&n.iv&&Ar(n.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),n.key.buffer,n.iv.buffer,Rd(n.method)).catch(c=>{throw a.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:e}),c}).then(c=>{const d=performance.now();a.trigger(R.FRAG_DECRYPTED,{frag:e,payload:c,stats:{tstart:o,tdecrypt:d}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=nt.IDLE})}}doTick(){if(!this.media){this.state=nt.IDLE;return}if(this.state===nt.IDLE){const{currentTrackId:t,levels:e}=this,i=e?.[t];if(!i||!e.length||!i.details||this.waitForLive(i))return;const{config:n}=this,a=this.getLoadPosition(),o=At.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),{end:c,len:d}=o,f=i.details,m=this.hls.maxBufferLength+f.levelTargetDuration;if(d>m)return;const p=f.fragments,g=p.length,v=f.edge;let E=null;const x=this.fragPrevious;if(c<v){const b=n.maxFragLookUpTolerance,_=c>v-b?0:b;E=_n(x,p,Math.max(p[0].start,c),_),!E&&x&&x.start<p[0].start&&(E=p[0])}else E=p[g-1];if(E=this.filterReplacedPrimary(E,i.details),!E)return;const T=E.sn-f.startSN,A=p[T-1];if(A&&A.cc===E.cc&&this.fragmentTracker.getState(A)===Ae.NOT_LOADED&&(E=A),this.fragmentTracker.getState(E)===Ae.NOT_LOADED){const b=this.mapToInitFragWhenRequired(E);b&&this.loadFragment(b,i,c)}}}loadFragment(t,e,i){Ee(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new LR(this.tracksBuffered[this.currentTrackId]||[])}}class LR{constructor(t){this.buffered=void 0;const e=(i,n,a)=>{if(n=n>>>0,n>a-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${a})`);return t[n][i]};this.buffered={get length(){return t.length},end(i){return e("end",i,t.length)},start(i){return e("start",i,t.length)}}}}const RR={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},sE=l=>String.fromCharCode(RR[l]||l),wi=15,gs=100,_R={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},IR={17:2,18:4,21:6,22:8,23:10,19:13,20:15},DR={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},CR={25:2,26:4,29:6,30:8,31:10,27:13,28:15},wR=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class kR{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i=typeof e=="function"?e():e;Vt.log(`${this.time} [${t}] ${i}`)}}}const xn=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class nE{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const n=e[i];t.hasOwnProperty(n)&&(this[n]=t[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class OR{constructor(){this.uchar=" ",this.penState=new nE}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class MR{constructor(t){this.chars=[],this.pos=0,this.currPenState=new nE,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<gs;e++)this.chars.push(new OR);this.logger=t}equals(t){for(let e=0;e<gs;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<gs;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<gs;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>gs&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=gs)}moveCursor(t){const e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=sE(t);if(this.pos>=gs){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)}clearFromPos(t){let e;for(e=t;e<gs;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<gs;i++){const n=this.chars[i].uchar;n!==" "&&(e=!1),t.push(n)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class Pf{constructor(t){this.rows=[],this.currRow=wi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<wi;e++)this.rows.push(new MR(t));this.logger=t}reset(){for(let t=0;t<wi;t++)this.rows[t].clear();this.currRow=wi-1}equals(t){let e=!0;for(let i=0;i<wi;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<wi;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<wi;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+Zt(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let c=0;c<wi;c++)this.rows[c].clear();const a=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const c=o.rows[a].cueStartTime,d=this.logger.time;if(c!==null&&d!==null&&c<d)for(let f=0;f<this.nrRollUpRows;f++)this.rows[e-this.nrRollUpRows+f+1].copy(o.rows[a+f])}}this.currRow=e;const i=this.rows[this.currRow];if(t.indent!==null){const a=t.indent,o=Math.max(a-1,0);i.setCursor(t.indent),t.color=i.chars[o].penState.foreground}const n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+Zt(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",n=-1;for(let a=0;a<wi;a++){const o=this.rows[a].getTextString();o&&(n=a+1,t?e.push("Row "+n+": '"+o+"'"):e.push(o.trim()))}return e.length>0&&(t?i="["+e.join(" | ")+"]":i=e.join(`
`)),i}getTextAndFormat(){return this.rows}}class ay{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Pf(i),this.nonDisplayedMemory=new Pf(i),this.lastOutputScreen=new Pf(i),this.currRollUpRow=this.displayedMemory.rows[wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=n[i]}this.logger.log(2,"MIDROW: "+Zt(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;e!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=e:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class ly{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=NR(),this.logger=void 0;const n=this.logger=new kR;this.channels=[null,new ay(t,e,n),new ay(t+1,i,n)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){const n=e[i]&127,a=e[i+1]&127;let o=!1,c=null;if(n===0&&a===0)continue;this.logger.log(3,()=>"["+xn([e[i],e[i+1]])+"] -> ("+xn([n,a])+")");const d=this.cmdHistory;if(n>=16&&n<=31){if(PR(n,a,d)){yo(null,null,d),this.logger.log(3,()=>"Repeated command ("+xn([n,a])+") is dropped");continue}yo(n,a,this.cmdHistory),o=this.parseCmd(n,a),o||(o=this.parseMidrow(n,a)),o||(o=this.parsePAC(n,a)),o||(o=this.parseBackgroundAttributes(n,a))}else yo(null,null,d);if(!o&&(c=this.parseChars(n,a),c)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+xn([n,a])+" orig: "+xn([e[i],e[i+1]]))}}parseCmd(t,e){const i=(t===20||t===28||t===21||t===29)&&e>=32&&e<=47,n=(t===23||t===31)&&e>=33&&e<=35;if(!(i||n))return!1;const a=t===20||t===21||t===23?1:2,o=this.channels[a];return t===20||t===21||t===28||t===29?e===32?o.ccRCL():e===33?o.ccBS():e===34?o.ccAOF():e===35?o.ccAON():e===36?o.ccDER():e===37?o.ccRU(2):e===38?o.ccRU(3):e===39?o.ccRU(4):e===40?o.ccFON():e===41?o.ccRDC():e===42?o.ccTR():e===43?o.ccRTD():e===44?o.ccEDM():e===45?o.ccCR():e===46?o.ccENM():e===47&&o.ccEOC():o.ccTO(e-32),this.currentChannel=a,!0}parseMidrow(t,e){let i=0;if((t===17||t===25)&&e>=32&&e<=47){if(t===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[i];return n?(n.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+xn([t,e])+")"),!0):!1}return!1}parsePAC(t,e){let i;const n=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,a=(t===16||t===24)&&e>=64&&e<=95;if(!(n||a))return!1;const o=t<=23?1:2;e>=64&&e<=95?i=o===1?_R[t]:DR[t]:i=o===1?IR[t]:CR[t];const c=this.channels[o];return c?(c.setPAC(this.interpretPAC(i,e)),this.currentChannel=o,!0):!1}interpretPAC(t,e){let i;const n={color:null,italics:!1,indent:null,underline:!1,row:t};return e>95?i=e-96:i=e-64,n.underline=(i&1)===1,i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((i-16)/2)*4,n}parseChars(t,e){let i,n=null,a=null;if(t>=25?(i=2,a=t-8):(i=1,a=t),a>=17&&a<=19){let o;a===17?o=e+80:a===18?o=e+112:o=e+144,this.logger.log(2,()=>"Special char '"+sE(o)+"' in channel "+i),n=[o]}else t>=32&&t<=127&&(n=e===0?[t]:[t,e]);return n&&this.logger.log(3,()=>"Char codes =  "+xn(n).join(",")),n}parseBackgroundAttributes(t,e){const i=(t===16||t===24)&&e>=32&&e<=47,n=(t===23||t===31)&&e>=45&&e<=47;if(!(i||n))return!1;let a;const o={};t===16||t===24?(a=Math.floor((e-32)/2),o.background=wR[a],e%2===1&&(o.background=o.background+"_semi")):e===45?o.background="transparent":(o.foreground="black",e===47&&(o.underline=!0));const c=t<=23?1:2;return this.channels[c].setBkgData(o),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}yo(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function yo(l,t,e){e.a=l,e.b=t}function PR(l,t,e){return e.a===l&&e.b===t}function NR(){return{a:null,b:null}}var $d=(function(){if($o!=null&&$o.VTTCue)return self.VTTCue;const l=["","lr","rl"],t=["start","middle","end","left","right"];function e(c,d){if(typeof d!="string"||!Array.isArray(c))return!1;const f=d.toLowerCase();return~c.indexOf(f)?f:!1}function i(c){return e(l,c)}function n(c){return e(t,c)}function a(c,...d){let f=1;for(;f<arguments.length;f++){const m=arguments[f];for(const p in m)c[p]=m[p]}return c}function o(c,d,f){const m=this,p={enumerable:!0};m.hasBeenReset=!1;let g="",v=!1,E=c,x=d,T=f,A=null,b="",_=!0,I="auto",C="start",N=50,w="middle",P=50,B="middle";Object.defineProperty(m,"id",a({},p,{get:function(){return g},set:function(M){g=""+M}})),Object.defineProperty(m,"pauseOnExit",a({},p,{get:function(){return v},set:function(M){v=!!M}})),Object.defineProperty(m,"startTime",a({},p,{get:function(){return E},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");E=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",a({},p,{get:function(){return x},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");x=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",a({},p,{get:function(){return T},set:function(M){T=""+M,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",a({},p,{get:function(){return A},set:function(M){A=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",a({},p,{get:function(){return b},set:function(M){const K=i(M);if(K===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",a({},p,{get:function(){return _},set:function(M){_=!!M,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",a({},p,{get:function(){return I},set:function(M){if(typeof M!="number"&&M!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");I=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",a({},p,{get:function(){return C},set:function(M){const K=n(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");C=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",a({},p,{get:function(){return N},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");N=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",a({},p,{get:function(){return w},set:function(M){const K=n(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");w=K,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",a({},p,{get:function(){return P},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");P=M,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",a({},p,{get:function(){return B},set:function(M){const K=n(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");B=K,this.hasBeenReset=!0}})),m.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o})();class BR{decode(t,e){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function rE(l){function t(i,n,a,o){return(i|0)*3600+(n|0)*60+(a|0)+parseFloat(o||0)}const e=l.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return e?parseFloat(e[2])>59?t(e[2],e[3],0,e[4]):t(e[1],e[2],e[3],e[4]):null}class FR{constructor(){this.values=Object.create(null)}set(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function aE(l,t,e,i){const n=i?l.split(i):[l];for(const a in n){if(typeof n[a]!="string")continue;const o=n[a].split(e);if(o.length!==2)continue;const c=o[0],d=o[1];t(c,d)}}const ud=new $d(0,0,""),vo=ud.align==="middle"?"middle":"center";function UR(l,t,e){const i=l;function n(){const c=rE(l);if(c===null)throw new Error("Malformed timestamp: "+i);return l=l.replace(/^[^\sa-zA-Z-]+/,""),c}function a(c,d){const f=new FR;aE(c,function(g,v){let E;switch(g){case"region":for(let x=e.length-1;x>=0;x--)if(e[x].id===v){f.set(g,e[x].region);break}break;case"vertical":f.alt(g,v,["rl","lr"]);break;case"line":E=v.split(","),f.integer(g,E[0]),f.percent(g,E[0])&&f.set("snapToLines",!1),f.alt(g,E[0],["auto"]),E.length===2&&f.alt("lineAlign",E[1],["start",vo,"end"]);break;case"position":E=v.split(","),f.percent(g,E[0]),E.length===2&&f.alt("positionAlign",E[1],["start",vo,"end","line-left","line-right","auto"]);break;case"size":f.percent(g,v);break;case"align":f.alt(g,v,["start",vo,"end","left","right"]);break}},/:/,/\s/),d.region=f.get("region",null),d.vertical=f.get("vertical","");let m=f.get("line","auto");m==="auto"&&ud.line===-1&&(m=-1),d.line=m,d.lineAlign=f.get("lineAlign","start"),d.snapToLines=f.get("snapToLines",!0),d.size=f.get("size",100),d.align=f.get("align",vo);let p=f.get("position","auto");p==="auto"&&ud.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function o(){l=l.replace(/^\s+/,"")}if(o(),t.startTime=n(),o(),l.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);l=l.slice(3),o(),t.endTime=n(),o(),a(l,t)}function lE(l){return l.replace(/<br(?: \/)?>/gi,`
`)}class $R{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new BR,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){let a=e.buffer,o=0;for(a=lE(a);o<a.length&&a[o]!=="\r"&&a[o]!==`
`;)++o;const c=a.slice(0,o);return a[o]==="\r"&&++o,a[o]===`
`&&++o,e.buffer=a.slice(o),c}function n(a){aE(a,function(o,c){},/:/)}try{let a="";if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;a=i();const c=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let o=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(o?o=!1:a=i(),e.state){case"HEADER":/:/.test(a)?n(a):a||(e.state="ID");continue;case"NOTE":a||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){e.state="NOTE";break}if(!a)continue;if(e.cue=new $d(0,0,""),e.state="CUE",a.indexOf("-->")===-1){e.cue.id=a;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{UR(a,e.cue,e.regionList)}catch{e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const c=a.indexOf("-->")!==-1;if(!a||c&&(o=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(e.cue===null)continue;e.cue.text&&(e.cue.text+=`
`),e.cue.text+=a}continue;case"BADCUE":a||(e.state="ID")}}}catch{e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const jR=/\r\n|\n\r|\n|\r/g,Nf=function(t,e,i=0){return t.slice(i,i+e.length)===e},GR=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),n=parseInt(t.slice(-9,-7)),a=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!ht(e)||!ht(i)||!ht(n)||!ht(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=60*1e3*n,e+=3600*1e3*a,e};function jd(l,t,e){return Ca(l.toString())+Ca(t.toString())+Ca(e)}const HR=function(t,e,i){let n=t[e],a=t[n.prevCC];if(!a||!a.new&&n.new){t.ccOffset=t.presentationOffset=n.start,n.new=!1;return}for(;(o=a)!=null&&o.new;){var o;t.ccOffset+=n.start-a.start,n.new=!1,n=a,a=t[n.prevCC]}t.presentationOffset=i};function zR(l,t,e,i,n,a,o){const c=new $R,d=hi(new Uint8Array(l)).trim().replace(jR,`
`).split(`
`),f=[],m=t?QA(t.baseTime,t.timescale):0;let p="00:00.000",g=0,v=0,E,x=!0;c.oncue=function(T){const A=e[i];let b=e.ccOffset;const _=(g-m)/9e4;if(A!=null&&A.new&&(v!==void 0?b=e.ccOffset=A.start:HR(e,i,_)),_){if(!t){E=new Error("Missing initPTS for VTT MPEGTS");return}b=_-e.presentationOffset}const I=T.endTime-T.startTime,C=fi((T.startTime+b-v)*9e4,n*9e4)/9e4;T.startTime=Math.max(C,0),T.endTime=Math.max(C+I,0);const N=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(N)),T.id||(T.id=jd(T.startTime,T.endTime,N)),T.endTime>0&&f.push(T)},c.onparsingerror=function(T){E=T},c.onflush=function(){if(E){o(E);return}a(f)},d.forEach(T=>{if(x)if(Nf(T,"X-TIMESTAMP-MAP=")){x=!1,T.slice(16).split(",").forEach(A=>{Nf(A,"LOCAL:")?p=A.slice(6):Nf(A,"MPEGTS:")&&(g=parseInt(A.slice(7)))});try{v=GR(p)/1e3}catch(A){E=A}return}else T===""&&(x=!1);c.parse(T+`
`)}),c.flush()}const Bf="stpp.ttml.im1t",oE=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,uE=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,VR={left:"start",center:"center",right:"end",start:"start",end:"end"};function oy(l,t,e,i){const n=Ct(new Uint8Array(l),["mdat"]);if(n.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const a=n.map(c=>hi(c)),o=XA(t.baseTime,1,t.timescale);try{a.forEach(c=>e(KR(c,o)))}catch(c){i(c)}}function KR(l,t){const n=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(a).reduce((p,g)=>(p[g]=n.getAttribute(`ttp:${g}`)||a[g],p),{}),c=n.getAttribute("xml:space")!=="preserve",d=uy(Ff(n,"styling","style")),f=uy(Ff(n,"layout","region")),m=Ff(n,"body","[begin]");return[].map.call(m,p=>{const g=cE(p,c);if(!g||!p.hasAttribute("begin"))return null;const v=$f(p.getAttribute("begin"),o),E=$f(p.getAttribute("dur"),o);let x=$f(p.getAttribute("end"),o);if(v===null)throw cy(p);if(x===null){if(E===null)throw cy(p);x=v+E}const T=new $d(v-t,x-t,g);T.id=jd(T.startTime,T.endTime,T.text);const A=f[p.getAttribute("region")],b=d[p.getAttribute("style")],_=qR(A,b,d),{textAlign:I}=_;if(I){const C=VR[I];C&&(T.lineAlign=C),T.align=I}return Xt(T,_),T}).filter(p=>p!==null)}function Ff(l,t,e){const i=l.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(e)):[]}function uy(l){return l.reduce((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t},{})}function cE(l,t){return[].slice.call(l.childNodes).reduce((e,i,n)=>{var a;return i.nodeName==="br"&&n?e+`
`:(a=i.childNodes)!=null&&a.length?cE(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function qR(l,t,e){const i="http://www.w3.org/ns/ttml#styling";let n=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=l!=null&&l.hasAttribute("style")?l.getAttribute("style"):null;return o&&e.hasOwnProperty(o)&&(n=e[o]),a.reduce((c,d)=>{const f=Uf(t,i,d)||Uf(l,i,d)||Uf(n,i,d);return f&&(c[d]=f),c},{})}function Uf(l,t,e){return l&&l.hasAttributeNS(t,e)?l.getAttributeNS(t,e):null}function cy(l){return new Error(`Could not parse ttml timestamp ${l}`)}function $f(l,t){if(!l)return null;let e=rE(l);return e===null&&(oE.test(l)?e=YR(l,t):uE.test(l)&&(e=XR(l,t))),e}function YR(l,t){const e=oE.exec(l),i=(e[4]|0)+(e[5]|0)/t.subFrameRate;return(e[1]|0)*3600+(e[2]|0)*60+(e[3]|0)+i/t.frameRate}function XR(l,t){const e=uE.exec(l),i=Number(e[1]);switch(e[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class Eo{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class QR{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=dy(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(R.FRAG_LOADING,this.onFragLoading,this),t.on(R.FRAG_LOADED,this.onFragLoaded,this),t.on(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(R.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(R.FRAG_LOADING,this.onFragLoading,this),t.off(R.FRAG_LOADED,this.onFragLoaded,this),t.off(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(R.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new Eo(this,"textTrack1"),e=new Eo(this,"textTrack2"),i=new Eo(this,"textTrack3"),n=new Eo(this,"textTrack4");this.cea608Parser1=new ly(1,t,e),this.cea608Parser2=new ly(3,i,n)}addCues(t,e,i,n,a){let o=!1;for(let c=a.length;c--;){const d=a[c],f=WR(d[0],d[1],e,i);if(f>=0&&(d[0]=Math.min(d[0],e),d[1]=Math.max(d[1],i),o=!0,f/(i-e)>.5))return}if(o||a.push([e,i]),this.config.renderTextTracksNatively){const c=this.captionsTracks[t];this.Cues.newCue(c,e,i,n)}else{const c=this.Cues.newCue(null,e,i,n);this.hls.trigger(R.CUES_PARSED,{type:"captions",cues:c,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:n,timescale:a,trackId:o}){const{unparsedVttFrags:c}=this;i===mt.MAIN&&(this.initPTS[e.cc]={baseTime:n,timescale:a,trackId:o}),c.length&&(this.unparsedVttFrags=[],c.forEach(d=>{this.initPTS[d.frag.cc]?this.onFragLoaded(R.FRAG_LOADED,d):this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let n=0;n<i.textTracks.length;n++){const a=i.textTracks[n];if(fy(a,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:n}=this,{label:a,languageCode:o}=e[t],c=this.getExistingTrack(a,o);if(c)i[t]=c,xr(i[t]),tE(i[t],n);else{const d=this.createTextTrack("captions",a,o);d&&(d[t]=!0,i[t]=d)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const i=e.label,n={_id:t,label:i,kind:"captions",default:e.media?!!e.media.default:!1,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=n,this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(t,e,i){const n=this.media;if(n)return n.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const i=!!e.transferMedia;if(this.media=null,i)return;const{captionsTracks:n}=this;Object.keys(n).forEach(a=>{xr(n[a]),delete n[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=dy(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let i=0;i<e.length;i++)xr(e[i])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],n=i.some(a=>a.textCodec===Bf);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(jv(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media,c=o?Co(o.textTracks):null;if(this.tracks.forEach((d,f)=>{let m;if(c){let p=null;for(let g=0;g<c.length;g++)if(c[g]&&fy(c[g],d)){p=c[g],c[g]=null;break}p&&(m=p)}if(m)xr(m);else{const p=fE(d);m=this.createTextTrack(p,d.name,d.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),c!=null&&c.length){const d=c.filter(f=>f!==null).map(f=>f.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(i=>{const n=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!n)return;const a=`textTrack${n[1]}`,o=this.captionsProperties[a];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return e?.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===mt.MAIN){var i,n;const{cea608Parser1:a,cea608Parser2:o,lastSn:c}=this,{cc:d,sn:f}=e.frag,m=(i=(n=e.part)==null?void 0:n.index)!=null?i:-1;a&&o&&(f!==c+1||f===c&&m!==this.lastPartIndex+1||d!==this.lastCc)&&(a.reset(),o.reset()),this.lastCc=d,this.lastSn=f,this.lastPartIndex=m}}onFragLoaded(t,e){const{frag:i,payload:n}=e;if(i.type===mt.SUBTITLE)if(n.byteLength){const a=i.decryptdata,o="stats"in e;if(a==null||!a.encrypted||o){const c=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),c&&c.textCodec===Bf?this._parseIMSC1(i,n):this._parseVTTs(e)}}else this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;oy(e,this.initPTS[t.cc],n=>{this._appendCues(n,t.level),i.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},n=>{i.logger.log(`Failed to parse IMSC1: ${n}`),i.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:n})})}_parseVTTs(t){var e;const{frag:i,payload:n}=t,{initPTS:a,unparsedVttFrags:o}=this,c=a.length-1;if(!a[i.cc]&&c===-1){o.push(t);return}const d=this.hls,f=(e=i.initSegment)!=null&&e.data?Li(i.initSegment.data,new Uint8Array(n)).buffer:n;zR(f,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,m=>{this._appendCues(m,i.level),d.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},m=>{const p=m.message==="Missing initPTS for VTT MPEGTS";p?o.push(t):this._fallbackToIMSC1(i,n),d.logger.log(`Failed to parse VTT cue: ${m}`),!(p&&c>i.cc)&&d.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:m})})}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||oy(e,this.initPTS[t.cc],()=>{i.textCodec=Bf,this._parseIMSC1(t,e)},()=>{i.textCodec="wvtt"})}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[e];if(!n||n.mode==="disabled")return;t.forEach(a=>eE(n,a))}else{const n=this.tracks[e];if(!n)return;const a=n.default?"default":"subtitles"+e;i.trigger(R.CUES_PARSED,{type:"subtitles",cues:t,track:a})}}onFragDecrypted(t,e){const{frag:i}=e;i.type===mt.SUBTITLE&&this.onFragLoaded(R.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:n}=e;if(!(i.type===mt.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let a=0;a<n.length;a++){const o=n[a].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const c=this.extractCea608Data(o);this.cea608Parser1.addData(n[a].pts,c[0]),this.cea608Parser2.addData(n[a].pts,c[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:n,type:a}){const{media:o}=this;if(!(!o||o.currentTime<i)){if(!a||a==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(d=>od(c[d],e,i))}if(this.config.renderTextTracksNatively&&e===0&&n!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(d=>od(c[d],e,n))}}}extractCea608Data(t){const e=[[],[]],i=t[0]&31;let n=2;for(let a=0;a<i;a++){const o=t[n++],c=127&t[n++],d=127&t[n++];if(c===0&&d===0)continue;if((4&o)!==0){const m=3&o;(m===0||m===1)&&(e[m].push(c),e[m].push(d))}}return e}}function fE(l){return l.characteristics&&/transcribes-spoken-dialog/gi.test(l.characteristics)&&/describes-music-and-sound/gi.test(l.characteristics)?"captions":"subtitles"}function fy(l,t){return!!l&&l.kind===fE(t)&&nd(t,l)}function WR(l,t,e,i){return Math.min(t,i)-Math.max(l,e)}function dy(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const ZR=/\s/,JR={newCue(l,t,e,i){const n=[];let a,o,c,d,f;const m=self.VTTCue||self.TextTrackCue;for(let g=0;g<i.rows.length;g++)if(a=i.rows[g],c=!0,d=0,f="",!a.isEmpty()){var p;for(let x=0;x<a.chars.length;x++)ZR.test(a.chars[x].uchar)&&c?d++:(f+=a.chars[x].uchar,c=!1);a.cueStartTime=t,t===e&&(e+=1e-4),d>=16?d--:d++;const v=lE(f.trim()),E=jd(t,e,v);l!=null&&(p=l.cues)!=null&&p.getCueById(E)||(o=new m(t,e,v),o.id=E,o.line=g+1,o.align="left",o.position=10+Math.min(80,Math.floor(d*8/32)*10),n.push(o))}return l&&n.length&&(n.sort((g,v)=>g.line==="auto"||v.line==="auto"?0:g.line>8&&v.line>8?v.line-g.line:g.line-v.line),n.forEach(g=>eE(l,g))),n}};function t_(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const e_=/(\d+)-(\d+)\/(\d+)/;class hy{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||r_,this.controller=new self.AbortController,this.stats=new Ed}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const a=i_(t,this.controller.signal),o=t.responseType==="arraybuffer",c=o?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:f}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,a),self.clearTimeout(this.requestTimeout),e.timeout=d&&ht(d)?d:f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,t,this.response))},e.timeout),(Ba(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var g;this.response=this.loader=p;const v=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,t,this.response))},f-(v-n.loading.start)),!p.ok){const{status:x,statusText:T}=p;throw new a_(T||"fetch, bad network response",x,p)}n.loading.first=v,n.total=n_(p.headers)||n.total;const E=(g=this.callbacks)==null?void 0:g.onProgress;return E&&ht(e.highWaterMark)?this.loadProgressively(p,n,t,e.highWaterMark,E):o?p.arrayBuffer():t.responseType==="json"?p.json():p.text()}).then(p=>{var g,v;const E=this.response;if(!E)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const x=p[c];x&&(n.loaded=n.total=x);const T={url:E.url,data:p,code:E.status},A=(g=this.callbacks)==null?void 0:g.onProgress;A&&!ht(e.highWaterMark)&&A(n,t,p,E),(v=this.callbacks)==null||v.onSuccess(T,n,t,E)}).catch(p=>{var g;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const v=p&&p.code||0,E=p?p.message:null;(g=this.callbacks)==null||g.onError({code:v,text:E},t,p?p.details:null,n)})}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,n=0,a){const o=new Tv,c=t.body.getReader(),d=()=>c.read().then(f=>{if(f.done)return o.dataLength&&a(e,i,o.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const m=f.value,p=m.length;return e.loaded+=p,p<n||o.dataLength?(o.push(m),o.dataLength>=n&&a(e,i,o.flush().buffer,t)):a(e,i,m.buffer,t),d()}).catch(()=>Promise.reject());return d()}}function i_(l,t){const e={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Xt({},l.headers))};return l.rangeEnd&&e.headers.set("Range","bytes="+l.rangeStart+"-"+String(l.rangeEnd-1)),e}function s_(l){const t=e_.exec(l);if(t)return parseInt(t[2])-parseInt(t[1])+1}function n_(l){const t=l.get("Content-Range");if(t){const i=s_(t);if(ht(i))return i}const e=l.get("Content-Length");if(e)return parseInt(e)}function r_(l,t){return new self.Request(l.url,t)}class a_ extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const l_=/^age:\s*[\d.]+\s*$/im;class dE{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Ed,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return a(i,e.url)}).catch(o=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",e.url,!0),a(i,e.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)}).catch(o=>{var c;(c=this.callbacks)==null||c.onError({code:i.status,text:o.message},e,i,n)}):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const n=e.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:o}=i.loadPolicy;if(n)for(const c in n)t.setRequestHeader(c,n[c]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&ht(a)?a:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const n=e.readyState,a=this.config;if(!i.aborted&&n>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const f=e.status,m=e.responseType==="text"?e.responseText:null;if(f>=200&&f<300){const E=m??e.response;if(E!=null){var o,c;i.loading.end=Math.max(self.performance.now(),i.loading.first);const x=e.responseType==="arraybuffer"?E.byteLength:E.length;i.loaded=i.total=x,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const T=(o=this.callbacks)==null?void 0:o.onProgress;T&&T(i,t,E,e);const A={url:e.responseURL,data:E,code:f};(c=this.callbacks)==null||c.onSuccess(A,i,t,e);return}}const p=a.loadPolicy.errorRetry,g=i.retry,v={url:t.url,data:void 0,code:f};if(Fo(p,g,!1,v))this.retry(p);else{var d;Vt.error(`${f} while loading ${t.url}`),(d=this.callbacks)==null||d.onError({code:f,text:e.statusText},t,e,i)}}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry,e=this.stats.retry;if(Fo(t,e,!0))this.retry(t);else{var i;Vt.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=bd(t,i.retry),i.retry++,Vt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e?.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&l_.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const o_={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},u_=zt(zt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:dE,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Tb,bufferController:fL,capLevelController:Bd,errorController:Rb,fpsController:dR,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:cv,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:o_},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},c_()),{},{subtitleStreamController:AR,subtitleTrackController:pR,timelineController:QR,audioStreamController:lL,audioTrackController:oL,emeController:Lr,cmcdController:oR,contentSteeringController:cR,interstitialsController:bR});function c_(){return{cueHandler:JR,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function f_(l,t,e){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=cd(l),n=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(o=>{const c=`${o==="level"?"playlist":o}LoadPolicy`,d=t[c]===void 0,f=[];a.forEach(m=>{const p=`${o}Loading${m}`,g=t[p];if(g!==void 0&&d){f.push(p);const v=i[c].default;switch(t[c]={default:v},m){case"TimeOut":v.maxLoadTimeMs=g,v.maxTimeToFirstByteMs=g;break;case"MaxRetry":v.errorRetry.maxNumRetry=g,v.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":v.errorRetry.retryDelayMs=g,v.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=g,v.timeoutRetry.maxRetryDelayMs=g;break}}}),f.length&&e.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${c}": ${Zt(t[c])}`)}),zt(zt({},i),t)}function cd(l){return l&&typeof l=="object"?Array.isArray(l)?l.map(cd):Object.keys(l).reduce((t,e)=>(t[e]=cd(l[e]),t),{}):l}function d_(l,t){const e=l.loader;e!==hy&&e!==dE?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),l.progressive=!1):t_()&&(l.loader=hy,l.progressive=!0,l.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}const wo=2,h_=.1,m_=.05,p_=100;class g_ extends rv{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!1})}},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(p_),this.mediaSource=e.mediaSource;const i=this.media=e.media;Ve(i,"playing",this.onMediaPlaying),Ve(i,"waiting",this.onMediaWaiting),Ve(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:i}=this;i&&(ei(i,"playing",this.onMediaPlaying),ei(i,"waiting",this.onMediaWaiting),ei(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(!((t=this.media)!=null&&t.readyState)||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,n;const a=(i=this.hls)==null?void 0:i.config;if(!a)return;const o=this.media;if(!o)return;const{seeking:c}=o,d=this.seeking&&!c,f=!this.seeking&&c,m=o.paused&&!c||o.ended||o.playbackRate===0;if(this.seeking=c,t!==e){e&&(this.ended=0),this.moved=!0,c||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!m&&t>e&&this.nudgeOnVideoHole(t,e)),this.waiting===0&&this.stallResolved(t);return}if(f||d){d&&this.stallResolved(t);return}if(m){this.nudgeRetry=0,this.stallResolved(t),!this.ended&&o.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!1}));return}if(!At.getBuffered(o).length){this.nudgeRetry=0;return}const p=At.bufferInfo(o,t,0),g=p.nextStart||0,v=this.fragmentTracker;if(c&&v&&this.hls){const N=my(this.hls.inFlightFragments,t),w=p.len>wo,P=!g||N||g-t>wo&&!v.getPartialFragment(t);if(w||P)return;this.moved=!1}const E=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(p.len>0)&&!g)return;const w=Math.max(g,p.start||0)-t,B=!!(E!=null&&E.live)?E.targetduration*2:wo,M=So(t,v);if(w>0&&(w<=B||M)){o.paused||this._trySkipBufferHole(M);return}}const x=a.detectStallWithCurrentTimeMs,T=self.performance.now(),A=this.waiting;let b=this.stalled;if(b===null)if(A>0&&T-A<x)b=this.stalled=A;else{this.stalled=T;return}const _=T-b;if(!c&&(_>=x||A)&&this.hls){var I;if(((I=this.mediaSource)==null?void 0:I.readyState)==="ended"&&!(E!=null&&E.live)&&Math.abs(t-(E?.edge||0))<1){if(this.ended)return;this.ended=t||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const C=At.bufferInfo(o,t,a.maxBufferHole);this._tryFixBufferStall(C,_,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(R.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&n&&n.length>1&&t>n.end(0)){const a=At.bufferedInfo(At.timeRangesToArray(this.buffered.audio),t,0);if(a.len>1&&e>=a.start){const o=At.timeRangesToArray(n),c=At.bufferedInfo(o,e,0).bufferedIndex;if(c>-1&&c<o.length-1){const d=At.bufferedInfo(o,t,0).bufferedIndex,f=o[c].end,m=o[c+1].start;if((d===-1||d>c)&&m-f<1&&t-f<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${f} -> ${m} buffered index: ${d}`);this.warn(p.message),this.media.currentTime+=1e-6;let g=So(t,this.fragmentTracker);g&&"fragment"in g?g=g.fragment:g||(g=void 0);const v=At.bufferInfo(this.media,t,0);this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:g,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(t,e,i){var n,a;const{fragmentTracker:o,media:c}=this,d=(n=this.hls)==null?void 0:n.config;if(!c||!o||!d)return;const f=(a=this.hls)==null?void 0:a.latestLevelDetails,m=So(i,o);if((m||f!=null&&f.live&&i<f.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const p=t.buffered,g=this.adjacentTraversal(t,i);(p&&p.length>1&&t.len>d.maxBufferHole||t.nextStart&&(t.nextStart-i<d.maxBufferHole||g))&&(e>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const i=this.fragmentTracker,n=t.nextStart;if(i&&n){const a=i.getFragAtPos(e,mt.MAIN),o=i.getFragAtPos(n,mt.MAIN);if(a&&o)return o.sn-a.sn<2}return!1}_reportStall(t){const{hls:e,media:i,stallReported:n,stalled:a}=this;if(!n&&a!==null&&i&&e){this.stallReported=!0;const o=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Zt(t)})`);this.warn(o.message),e.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:t.len,bufferInfo:t,stalled:{start:a}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:i,media:n}=this,a=(e=this.hls)==null?void 0:e.config;if(!n||!i||!a)return 0;const o=n.currentTime,c=At.bufferInfo(n,o,0),d=o<c.start?c.start:c.nextStart;if(d&&this.hls){const m=c.len<=a.maxBufferHole,p=c.len>0&&c.len<1&&n.readyState<3,g=d-o;if(g>0&&(m||p)){if(g>a.maxBufferHole){let E=!1;if(o===0){const x=i.getAppendedFrag(0,mt.MAIN);x&&d<x.end&&(E=!0)}if(!E&&t){var f;if(!((f=this.hls.loadLevelObj)!=null&&f.details)||my(this.hls.inFlightFragments,d))return 0;let T=!1,A=t.end;for(;A<d;){const b=So(A,i);if(b)A+=b.duration;else{T=!0;break}}if(T)return 0}}const v=Math.max(d+m_,o+h_);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${v}`),this.moved=!0,n.currentTime=v,!(t!=null&&t.gap)){const E=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${v}`),x={type:vt.MEDIA_ERROR,details:q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,buffer:c.len,bufferInfo:c};t&&("fragment"in t?x.part=t:x.frag=t),this.hls.trigger(R.ERROR,x)}return v}}return 0}_tryNudgeBuffer(t){const{hls:e,media:i,nudgeRetry:n}=this,a=e?.config;if(!i||!a)return 0;const o=i.currentTime;if(this.nudgeRetry++,n<a.nudgeMaxRetry){const c=o+(n+1)*a.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${o} to ${c}`);this.warn(d.message),i.currentTime=c,e.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:t.len,bufferInfo:t})}else{const c=new Error(`Playhead still not moving while enough data buffered @${o} after ${a.nudgeMaxRetry} nudges`);this.error(c.message),e.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.BUFFER_STALLED_ERROR,error:c,fatal:!0,buffer:t.len,bufferInfo:t})}}}function my(l,t){const e=py(l.main);if(e&&e.start<=t)return e;const i=py(l.audio);return i&&i.start<=t?i:null}function py(l){if(!l)return null;switch(l.state){case nt.IDLE:case nt.STOPPED:case nt.ENDED:case nt.ERROR:return null}return l.frag}function So(l,t){return t.getAppendedFrag(l,mt.MAIN)||t.getPartialFragment(l)}const y_=.25;function fd(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function jf(l,t,e,i,n){let a=new l(t,e,"");try{a.value=i,n&&(a.type=n)}catch{a=new l(t,e,Zt(n?zt({type:n},i):i))}return a}const To=(()=>{const l=fd();try{l&&new l(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class v_{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(R.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(R.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(R.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var i;this.media=e.media,((i=e.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var t;const e=(t=this.hls)==null?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null,!e.transferMedia&&(this.id3Track&&(this.removeCues&&xr(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if(i.kind==="metadata"&&i.label==="id3")return tE(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:n}=this.hls.config;if(!i&&!n)return;const{samples:a}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=fd();if(o)for(let c=0;c<a.length;c++){const d=a[c].type;if(d===di.emsg&&!i||!n)continue;const f=Iv(a[c].data),m=a[c].pts;let p=m+a[c].duration;p>To&&(p=To),p-m<=0&&(p=m+y_);for(let v=0;v<f.length;v++){const E=f[v];if(!Dv(E)){this.updateId3CueEnds(m,d);const x=jf(o,m,p,E,d);x&&this.id3Track.addCue(x)}}}}updateId3CueEnds(t,e){var i;const n=(i=this.id3Track)==null?void 0:i.cues;if(n)for(let a=n.length;a--;){const o=n[a];o.type===e&&o.startTime<t&&o.endTime===To&&(o.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:n}){const{id3Track:a,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}=o;if(a&&(c||d)){let f;n==="audio"?f=m=>m.type===di.audioId3&&d:n==="video"?f=m=>m.type===di.emsg&&c:f=m=>m.type===di.audioId3&&d||m.type===di.emsg&&c,od(a,e,i,f)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:n,enableDateRangeMetadataCues:a,interstitialsController:o}=this.hls.config;if(!a)return;const c=fd();if(i&&n&&!o){const{fragmentStart:x,fragmentEnd:T}=t;let A=this.assetCue;A?(A.startTime=x,A.endTime=T):c&&(A=this.assetCue=jf(c,x,T,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),A&&(A.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(A),A.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:d}=this,{dateRanges:f}=t,m=Object.keys(f);let p=this.dateRangeCuesAppended;if(d&&e){var g;if((g=d.cues)!=null&&g.length){const x=Object.keys(p).filter(T=>!m.includes(T));for(let T=x.length;T--;){var v;const A=x[T],b=(v=p[A])==null?void 0:v.cues;delete p[A],b&&Object.keys(b).forEach(_=>{const I=b[_];if(I){I.removeEventListener("enter",this.onEventCueEnter);try{d.removeCue(I)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const E=t.fragments[t.fragments.length-1];if(!(m.length===0||!ht(E?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let x=0;x<m.length;x++){const T=m[x],A=f[T],b=A.startTime,_=p[T],I=_?.cues||{};let C=_?.durationKnown||!1,N=To;const{duration:w,endDate:P}=A;if(P&&w!==null)N=b+w,C=!0;else if(A.endOnNext&&!C){const M=m.reduce((K,tt)=>{if(tt!==A.id){const H=f[tt];if(H.class===A.class&&H.startDate>A.startDate&&(!K||A.startDate<K.startDate))return H}return K},null);M&&(N=M.startTime,C=!0)}const B=Object.keys(A.attr);for(let M=0;M<B.length;M++){const K=B[M];if(!Ub(K))continue;const tt=I[K];if(tt)C&&!(_!=null&&_.durationKnown)?tt.endTime=N:Math.abs(tt.startTime-b)>.01&&(tt.startTime=b,tt.endTime=N);else if(c){let H=A.attr[K];$b(K)&&(H=Uy(H));const Y=jf(c,b,N,{key:K,data:H},di.dateRange);Y&&(Y.id=T,this.id3Track.addCue(Y),I[K]=Y,o&&(K==="X-ASSET-LIST"||K==="X-ASSET-URL")&&Y.addEventListener("enter",this.onEventCueEnter))}}p[T]={cues:I,dateRange:A,durationKnown:C}}}}}class E_{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,i=this.levelDetails;if(!e||!i)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:o}=this.config;if(!a||o===1||!i.live)return;const c=this.targetLatency;if(c===null)return;const d=n-c,f=Math.min(this.maxLatency,c+i.targetduration);if(d<f&&d>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,o)),g=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,v=Math.min(p,Math.max(1,g));this.changeMediaPlaybackRate(e,v)}else e.playbackRate!==1&&e.playbackRate!==0&&this.changeMediaPlaybackRate(e,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return((t=this.hls)==null?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(t.liveMaxLatencyDuration!==void 0)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(t===null||this.hls===null)return null;const{holdBack:e,partHoldBack:i,targetduration:n}=t,{liveSyncDuration:a,liveSyncDurationCount:o,lowLatencyMode:c}=this.config,d=this.hls.userConfig;let f=c&&i||e;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||f===0)&&(f=a!==void 0?a:o*n);const m=n;return f+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(t===null||e===null)return null;const i=this.levelDetails;if(i===null)return null;const n=i.edge,a=t-e-this.edgeStalled,o=n-i.totalduration,c=n-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(o,a),c)}get drift(){const t=this.levelDetails;return t===null?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(t===null)return 0;const e=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(R.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(R.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,n;t.playbackRate!==e&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}class S_ extends Nd{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(R.LEVEL_LOADED,this.onLevelLoaded,this),t.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(R.FRAG_BUFFERED,this.onFragBuffered,this),t.on(R.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(R.LEVEL_LOADED,this.onLevelLoaded,this),t.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(R.FRAG_BUFFERED,this.onFragBuffered,this),t.off(R.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,n=[],a={},o={};let c=!1,d=!1,f=!1;e.levels.forEach(m=>{const p=m.attrs;let{audioCodec:g,videoCodec:v}=m;g&&(m.audioCodec=g=Mo(g,i)||void 0),v&&(v=m.videoCodec=ib(v));const{width:E,height:x,unknownCodecs:T}=m,A=T?.length||0;if(c||(c=!!(E&&x)),d||(d=!!v),f||(f=!!g),A||g&&!this.isAudioSupported(g)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:b,"FRAME-RATE":_,"HDCP-LEVEL":I,"PATHWAY-ID":C,RESOLUTION:N,"VIDEO-RANGE":w}=p,B=`${`${C||"."}-`}${m.bitrate}-${N}-${_}-${b}-${w}-${I}`;if(a[B])if(a[B].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const M=o[B]+=1;m.attrs["PATHWAY-ID"]=new Array(M+1).join(".");const K=this.createLevel(m);a[B]=K,n.push(K)}else a[B].addGroupId("audio",p.AUDIO),a[B].addGroupId("text",p.SUBTITLES);else{const M=this.createLevel(m);a[B]=M,o[B]=1,n.push(M)}}),this.filterAndSortMediaOptions(n,e,c,d,f)}createLevel(t){const e=new Ma(t),i=t.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(n.message),e.supportedResult=Wy(n,[])}return e}isAudioSupported(t){return ka(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return ka(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,n,a){var o;let c=[],d=[],f=t;const m=((o=e.stats)==null?void 0:o.parsing)||{};if((i||n)&&a&&(f=f.filter(({videoCodec:b,videoRange:_,width:I,height:C})=>(!!b||!!(I&&C))&&db(_))),f.length===0){Promise.resolve().then(()=>{if(this.hls){let b="no level with compatible codecs found in manifest",_=b;e.levels.length&&(_=`one or more CODECS in variant not supported: ${Zt(e.levels.map(C=>C.attrs.CODECS).filter((C,N,w)=>w.indexOf(C)===N))}`,this.warn(_),b+=` (${_})`);const I=new Error(b);this.hls.trigger(R.ERROR,{type:vt.MEDIA_ERROR,details:q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:I,reason:_})}}),m.end=performance.now();return}e.audioTracks&&(c=e.audioTracks.filter(b=>!b.audioCodec||this.isAudioSupported(b.audioCodec)),gy(c)),e.subtitles&&(d=e.subtitles,gy(d));const p=f.slice(0);f.sort((b,_)=>{if(b.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(b.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&b.height!==_.height)return b.height-_.height;if(b.frameRate!==_.frameRate)return b.frameRate-_.frameRate;if(b.videoRange!==_.videoRange)return Po.indexOf(b.videoRange)-Po.indexOf(_.videoRange);if(b.videoCodec!==_.videoCodec){const I=l0(b.videoCodec),C=l0(_.videoCodec);if(I!==C)return C-I}if(b.uri===_.uri&&b.codecSet!==_.codecSet){const I=Oo(b.codecSet),C=Oo(_.codecSet);if(I!==C)return C-I}return b.averageBitrate!==_.averageBitrate?b.averageBitrate-_.averageBitrate:0});let g=p[0];if(this.steering&&(f=this.steering.filterParsedLevels(f),f.length!==p.length)){for(let b=0;b<p.length;b++)if(p[b].pathwayId===f[0].pathwayId){g=p[b];break}}this._levels=f;for(let b=0;b<f.length;b++)if(f[b]===g){var v;this._firstLevel=b;const _=g.bitrate,I=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${f.length} level(s) found, first bitrate: ${_}`),((v=this.hls.userConfig)==null?void 0:v.abrEwmaDefaultEstimate)===void 0){const C=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);C>I&&I===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=C)}break}const E=a&&!n,x=this.hls.config,T=!!(x.audioStreamController&&x.audioTrackController),A={levels:f,audioTracks:c,subtitleTracks:d,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:n,altAudio:T&&!E&&c.some(b=>!!b.url)};m.end=performance.now(),this.hls.trigger(R.MANIFEST_PARSED,A)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(e.length===0)return;if(t<0||t>=e.length){const m=new Error("invalid level idx"),p=t<0;if(this.hls.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.LEVEL_SWITCH_ERROR,level:t,fatal:p,error:m,reason:m.message}),p)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,n=this.currentLevel,a=n?n.attrs["PATHWAY-ID"]:void 0,o=e[t],c=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=o,i===t&&n&&a===c)return;this.log(`Switching to level ${t} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${c?" with Pathway "+c:""} from level ${i}${a?" with Pathway "+a:""}`);const d={level:t,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(R.LEVEL_SWITCHING,d);const f=o.details;if(!f||f.live){const m=this.switchParams(o.uri,n?.details,f);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),i=t.filter(n=>e.indexOf(n)!==-1);if(t.length<1){this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);return}this.steering.pathwayPriority=i}}onError(t,e){e.fatal||!e.context||e.context.type===wt.LEVEL&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(e!==void 0&&e.type===mt.MAIN){const i=e.elementaryStreams;if(!Object.keys(i).some(a=>!!i[a]))return;const n=this._levels[e.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(t,e){var i;const{level:n,details:a}=e,o=e.levelInfo;if(!o){var c;this.warn(`Invalid level index ${n}`),(c=e.deliveryDirectives)!=null&&c.skip&&(a.deltaUpdateFailed=!0);return}if(o===this.currentLevel||e.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let d=o.details;d===e.details&&d.advanced&&(d=void 0),this.playlistLoaded(n,e,d)}else(i=e.deliveryDirectives)!=null&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=this.getUrlWithDirectives(t.uri,e),n=this.currentLevelIndex,a=t.attrs["PATHWAY-ID"],o=t.details,c=o?.age;this.log(`Loading level index ${n}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${a?" Pathway "+a:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(R.LEVEL_LOADING,{url:i,level:n,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(this._levels.length===1)return;const i=this._levels.filter((a,o)=>o!==t?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(c=>c.level=-1)),!1));vv(i),this._levels=i,this.currentLevelIndex>-1&&(e=this.currentLevel)!=null&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=i.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(R.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(R.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function gy(l){const t={};l.forEach(e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function hE(){return self.SourceBuffer||self.WebKitSourceBuffer}function mE(){if(!Ws())return!1;const t=hE();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function T_(){if(!mE())return!1;const l=Ws();return typeof l?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>l.isTypeSupported(Oa(t,"video")))||["mp4a.40.2","fLaC"].some(t=>l.isTypeSupported(Oa(t,"audio"))))}function x_(){var l;const t=hE();return typeof(t==null||(l=t.prototype)==null?void 0:l.changeType)=="function"}const b_=100;class A_ extends Id{constructor(t,e,i){super(t,e,i,"stream-controller",mt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,a=n?n.currentTime:null;if(a===null||!ht(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const o=this.getFwdBufferInfoAtPos(n,a,mt.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(R.MANIFEST_PARSED,this.onManifestParsed,this),t.on(R.LEVEL_LOADING,this.onLevelLoading,this),t.on(R.LEVEL_LOADED,this.onLevelLoaded,this),t.on(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(R.BUFFER_CREATED,this.onBufferCreated,this),t.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(R.MANIFEST_PARSED,this.onManifestParsed,this),t.off(R.LEVEL_LOADED,this.onLevelLoaded,this),t.off(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(R.BUFFER_CREATED,this.onBufferCreated,this),t.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:i,hls:n}=this;if(this.stopLoad(),this.setInterval(b_),this.level=-1,!this.startFragRequested){let a=n.startLevel;a===-1&&(n.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=n.firstAutoLevel),n.nextLoadLevel=a,this.level=n.loadLevel,this._hasEnoughToStart=!!e}i>0&&t===-1&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=nt.IDLE,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=nt.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case nt.WAITING_LEVEL:{const{levels:t,level:e}=this,i=t?.[e],n=i?.details;if(n&&(!n.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(n))break;this.state=nt.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=nt.IDLE;break}break}case nt.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===nt.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),(t=this.media)!=null&&t.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:n}=this;if(e===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?t.nextLoadLevel:t.loadLevel;if(!(i!=null&&i[a]))return;const o=i[a],c=this.getMainFwdBufferInfo();if(c===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(c,d)){const x={};this.altAudio===2&&(x.type="video"),this.hls.trigger(R.BUFFER_EOS,x),this.state=nt.ENDED;return}if(!this.buffering)return;t.loadLevel!==a&&t.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=t.nextLoadLevel=a;const f=o.details;if(!f||this.state===nt.WAITING_LEVEL||this.waitForLive(o)){this.level=a,this.state=nt.WAITING_LEVEL,this.startFragRequested=!1;return}const m=c.len,p=this.getMaxBufferLength(o.maxBitrate);if(m>=p)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:c.end;let v=this.getNextFragment(g,f);if(this.couldBacktrack&&!this.fragPrevious&&v&&Ee(v)&&this.fragmentTracker.getState(v)!==Ae.OK){var E;const T=((E=this.backtrackFragment)!=null?E:v).sn-f.startSN,A=f.fragments[T-1];A&&v.cc===A.cc&&(v=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,g)){if(!v.gap){const T=this.audioOnly&&!this.altAudio?Wt.AUDIO:Wt.VIDEO,A=(T===Wt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,T,mt.MAIN)}v=this.getNextFragmentLoopLoading(v,f,c,mt.MAIN,p)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,o,g))}loadFragment(t,e,i){const n=this.fragmentTracker.getState(t);n===Ae.NOT_LOADED||n===Ae.PARTIAL?Ee(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,mt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(e!=null&&e.readyState){let i;const n=this.getAppendedFrag(e.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<a.targetduration*2)return}if(!e.paused&&t){const c=this.hls.nextLoadLevel,d=t[c],f=this.fragLastKbps;f&&this.fragCurrent?i=this.fragCurrent.duration*d.maxBitrate/(1e3*f)+1:i=0}else i=0;const o=this.getBufferedFrag(e.currentTime+i);if(o){const c=this.followingBufferedFrag(o);if(c){this.abortCurrentFrag();const d=c.maxStartPTS?c.maxStartPTS:c.start,f=c.duration,m=Math.max(o.end,d+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case nt.KEY_LOADING:case nt.FRAG_LOADING:case nt.FRAG_LOADING_WAITING_RETRY:case nt.PARSING:case nt.PARSED:this.state=nt.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio===2?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;Ve(i,"playing",this.onMediaPlaying),Ve(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:i}=this;i&&(ei(i,"playing",this.onMediaPlaying),ei(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e),!e.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,n=!1;for(let a=0;a<e.levels.length;a++){const o=e.levels[a].audioCodec;o&&(i=i||o.indexOf("mp4a.40.2")!==-1,n=n||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&n&&!x_(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==nt.IDLE)return;const n=e.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=nt.WAITING_LEVEL)}onLevelLoaded(t,e){var i;const{levels:n,startFragRequested:a}=this,o=e.level,c=e.details,d=c.totalduration;if(!n){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${d}`);const f=e.levelInfo,m=this.fragCurrent;m&&(this.state===nt.FRAG_LOADING||this.state===nt.FRAG_LOADING_WAITING_RETRY)&&m.level!==e.level&&m.loader&&this.abortCurrentFrag();let p=0;if(c.live||(i=f.details)!=null&&i.live){var g;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;p=this.alignPlaylists(c,f.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(f.details=c,this.levelLastLoaded=f,a||this.setStartPosition(c,p),this.hls.trigger(R.LEVEL_UPDATED,{details:c,level:o}),this.state===nt.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=nt.IDLE}a&&c.live&&this.synchronizeToLiveEdge(c),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const n=this.hls.liveSyncPosition,a=this.getLoadPosition(),o=t.fragmentStart,c=t.edge,d=a>=o-e.maxFragLookUpTolerance&&a<=c;if(n!==null&&i.duration>n&&(a<n||!d)){const m=e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;if((!d&&i.readyState<4||a<c-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var f;const p=At.bufferInfo(i,n,0);if(!((f=p.buffered)!=null&&f.length)){i.currentTime=n;return}if(p.start<=a){i.currentTime=n;return}const{nextStart:v}=At.bufferedInfo(p.buffered,a,0);v&&(i.currentTime=v)}else i.currentTime=n}}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:n,payload:a}=t,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const c=o[i.level];if(!c){this.warn(`Level ${i.level} not found on progress`);return}const d=c.details;if(!d){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const f=c.videoCodec,m=d.PTSKnown||!d.live,p=(e=i.initSegment)==null?void 0:e.data,g=this._getAudioCodec(c),v=this.transmuxer=this.transmuxer||new $v(this.hls,mt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=n?n.index:-1,x=E!==-1,T=new Ld(i.level,i.sn,i.stats.chunkCount,a.byteLength,E,x),A=this.initPTS[i.cc];v.push(a,p,g,f,i,n,d.totalduration,m,T,A)}onAudioTrackSwitching(t,e){const i=this.hls,n=this.altAudio===2;if(No(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.fragmentTracker.removeAllFragments(),i.once(R.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(R.AUDIO_TRACK_SWITCHED,e)}),i.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(R.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=No(e.url,this.hls);if(i){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){const i=e.tracks;let n,a,o=!1;for(const c in i){const d=i[c];if(d.id==="main"){if(a=c,n=d,c==="video"){const f=i[c];f&&(this.videoBuffer=f.buffer)}}else o=!0}o&&n?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:n}=e,a=i.type===mt.MAIN;if(a){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===nt.PARSED&&(this.state=nt.IDLE);return}const c=n?n.stats:i.stats;this.fragLastKbps=Math.round(8*c.total/(c.buffering.end-c.loading.first)),Ee(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,n)}const o=this.media;o&&(!this._hasEnoughToStart&&At.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal){this.state=nt.ERROR;return}switch(e.details){case q.FRAG_GAP:case q.FRAG_PARSING_ERROR:case q.FRAG_DECRYPT_ERROR:case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.MAIN,e);break;case q.LEVEL_LOAD_ERROR:case q.LEVEL_LOAD_TIMEOUT:case q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===nt.WAITING_LEVEL&&((i=e.context)==null?void 0:i.type)===wt.LEVEL&&(this.state=nt.IDLE);break;case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case q.BUFFER_FULL_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onFragLoadEmergencyAborted(){this.state=nt.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==Wt.AUDIO||!this.altAudio){const i=(e===Wt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,e,mt.MAIN),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking){this.log(`could not seek to ${i}, already seeking at ${e}`);return}const n=this.timelineOffset;n&&i&&(i+=n);const a=this.getLevelDetails(),o=At.getBuffered(t),c=o.length?o.start(0):0,d=c-i,f=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<f||this.loadingParts&&d<2*(a?.partTarget||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),i+=d,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${c}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e.indexOf("mp4a.40.5")!==-1?e="mp4a.40.2":e="mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(i=>{const{hls:n}=this,a=i?.frag;if(!a||this.fragContextChanged(a))return;e.fragmentError=0,this.state=nt.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=a.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),n.trigger(R.FRAG_LOADED,i),a.bitrateTest=!1}).catch(i=>{this.state===nt.STOPPED||this.state===nt.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}_handleTransmuxComplete(t){const e=this.playlistType,{hls:i}=this,{remuxResult:n,chunkMeta:a}=t,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:c,part:d,level:f}=o,{video:m,text:p,id3:g,initSegment:v}=n,{details:E}=f,x=this.altAudio?void 0:n.audio;if(this.fragContextChanged(c)){this.fragmentTracker.removeFragment(c);return}if(this.state=nt.PARSING,v){const T=v.tracks;if(T){const I=c.initSegment||c;if(this.unhandledEncryptionError(v,c))return;this._bufferInitSegment(f,T,I,a),i.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:e,tracks:T})}const A=v.initPTS,b=v.timescale,_=this.initPTS[c.cc];if(ht(A)&&(!_||_.baseTime!==A||_.timescale!==b)){const I=v.trackId;this.initPTS[c.cc]={baseTime:A,timescale:b,trackId:I},i.trigger(R.INIT_PTS_FOUND,{frag:c,id:e,initPTS:A,timescale:b,trackId:I})}}if(m&&E){x&&m.type==="audiovideo"&&this.logMuxedErr(c);const T=E.fragments[c.sn-1-E.startSN],A=c.sn===E.startSN,b=!T||c.cc>T.cc;if(n.independent!==!1){const{startPTS:_,endPTS:I,startDTS:C,endDTS:N}=m;if(d)d.elementaryStreams[m.type]={startPTS:_,endPTS:I,startDTS:C,endDTS:N};else if(m.firstKeyFrame&&m.independent&&a.id===1&&!b&&(this.couldBacktrack=!0),m.dropped&&m.independent){const w=this.getMainFwdBufferInfo(),P=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,B=m.firstKeyFramePTS?m.firstKeyFramePTS:_;if(!A&&P<B-this.config.maxBufferHole&&!b){this.backtrack(c);return}else b&&(c.gap=!0);c.setElementaryStreamInfo(m.type,c.start,I,c.start,N,!0)}else A&&_-(E.appliedTimelineOffset||0)>wo&&(c.gap=!0);c.setElementaryStreamInfo(m.type,_,I,C,N),this.backtrackFragment&&(this.backtrackFragment=c),this.bufferFragmentData(m,c,d,a,A||b)}else if(A||b)c.gap=!0;else{this.backtrack(c);return}}if(x){const{startPTS:T,endPTS:A,startDTS:b,endDTS:_}=x;d&&(d.elementaryStreams[Wt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:_}),c.setElementaryStreamInfo(Wt.AUDIO,T,A,b,_),this.bufferFragmentData(x,c,d,a)}if(E&&g!=null&&g.samples.length){const T={id:e,frag:c,details:E,samples:g.samples};i.trigger(R.FRAG_PARSING_METADATA,T)}if(E&&p){const T={id:e,frag:c,details:E,samples:p.samples};i.trigger(R.FRAG_PARSING_USERDATA,T)}}logMuxedErr(t){this.warn(`${Ee(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,n){if(this.state!==nt.PARSING)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));const{audio:a,video:o,audiovideo:c}=e;if(a){const f=t.audioCodec;let m=Ao(a.codec,f);m==="mp4a"&&(m="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const g=a.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),f&&f!==m&&this.log(`Swapping manifest audio codec "${f}" for "${m}"`),a.levelCodec=m,a.id=mt.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${m||""}/${f||""}/${a.codec}]`),delete e.audiovideo}if(o){o.levelCodec=t.videoCodec,o.id=mt.MAIN;const f=o.codec;if(f?.length===4)switch(f){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${t.videoCodec||""}/${f}]${o.codec!==f?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete e.audiovideo}c&&(this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${t.codecs}/${c.codec}]`),delete e.video,delete e.audio);const d=Object.keys(e);if(d.length){if(this.hls.trigger(R.BUFFER_CODECS,e),!this.hls)return;d.forEach(f=>{const p=e[f].initSegment;p!=null&&p.byteLength&&this.hls.trigger(R.BUFFER_APPENDING,{type:f,data:p,frag:i,part:null,chunkMeta:n,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,mt.MAIN)}get maxBufferLength(){const{levels:t,level:e}=this,i=t?.[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=nt.IDLE}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&t.seeking===!1){const i=t.currentTime;if(At.isBuffered(t,i)?e=this.getAppendedFrag(i):At.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const n=this.fragPlaying,a=e.level;(!n||e.sn!==n.sn||n.level!==a)&&(this.fragPlaying=e,this.hls.trigger(R.FRAG_CHANGED,{frag:e}),(!n||n.level!==a)&&this.hls.trigger(R.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;return ht(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;if(ht(e)){const i=this.getLevelDetails(),n=this.currentFrag||(i?_n(null,i.fragments,e):null);if(n){const a=n.programDateTime;if(a!==null){const o=a+(e-n.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class L_ extends Ri{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[i].loader;if(n){var e;if(t&&t!==((e=n.context)==null?void 0:e.frag.type))return;n.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t,e=q.KEY_LOAD_ERROR,i,n,a){return new ys({type:vt.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:a,error:i,networkDetails:n})}loadClear(t,e,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let n=0,a=e.length;n<a;n++){const o=e[n];if(t.cc<=o.cc&&(!Ee(t)||!Ee(o)||t.sn<o.sn)||!i&&n==a-1)return this.emeController.selectKeySystemFormat(o).then(c=>{if(!this.emeController)return;o.setKeyFormat(c);const d=Ro(c);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const n=_a(this.config);if(n.length)return this.emeController.getKeySystemAccess(n)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var i,n;e&&t.setKeyFormat(e);const a=t.decryptdata;if(!a){const f=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(t,q.KEY_LOAD_ERROR,f))}const o=a.uri;if(!o)return Promise.reject(this.createKeyLoadError(t,q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const c=Gf(a);let d=this.keyIdToKeyInfo[c];if((i=d)!=null&&i.decryptdata.key)return a.key=d.decryptdata.key,Promise.resolve({frag:t,keyInfo:d});if(this.emeController&&(n=d)!=null&&n.keyLoadPromise)switch(this.emeController.getKeyStatus(d.decryptdata)){case"usable":case"usable-in-future":return d.keyLoadPromise.then(m=>{const{keyInfo:p}=m;return a.key=p.decryptdata.key,{frag:t,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[c]?"Rel":"L"}oading${a.keyId?" keyId: "+ze(a.keyId):""} URI: ${a.uri} from ${t.type} ${t.level}`),d=this.keyIdToKeyInfo[c]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(d,t):this.loadKeyEME(d,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(d,t);default:return Promise.reject(this.createKeyLoadError(t,q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var n;if(!t.decryptdata.keyId&&(n=e.initSegment)!=null&&n.data){const o=z1(e.initSegment.data);if(o.length){const c=o[0];c.some(d=>d!==0)&&(this.log(`Using keyId found in init segment ${ze(c)}`),t.decryptdata.keyId=c,Rn.setKeyIdForUri(t.decryptdata.uri,c))}}const a=this.emeController.loadKey(i);return(t.keyLoadPromise=a.then(o=>(t.mediaKeySessionContext=o,i))).catch(o=>{throw t.keyLoadPromise=null,"data"in o&&(o.data.frag=e),o})}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,n=i.loader,a=new n(i);return e.keyLoader=t.loader=a,t.keyLoadPromise=new Promise((o,c)=>{const d={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},f=i.keyLoadPolicy.default,m={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,v,E,x)=>{const{frag:T,keyInfo:A}=E,b=Gf(A.decryptdata);if(!T.decryptdata||A!==this.keyIdToKeyInfo[b])return c(this.createKeyLoadError(T,q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));A.decryptdata.key=T.decryptdata.key=new Uint8Array(g.data),T.keyLoader=null,A.loader=null,o({frag:T,keyInfo:A})},onError:(g,v,E,x)=>{this.resetLoader(v),c(this.createKeyLoadError(e,q.KEY_LOAD_ERROR,new Error(`HTTP Error ${g.code} loading key ${g.text}`),E,zt({url:d.url,data:void 0},g)))},onTimeout:(g,v,E)=>{this.resetLoader(v),c(this.createKeyLoadError(e,q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(g,v,E)=>{this.resetLoader(v),c(this.createKeyLoadError(e,q.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};a.load(d,m,p)})}resetLoader(t){const{frag:e,keyInfo:i,url:n}=t,a=i.loader;e.keyLoader===a&&(e.keyLoader=null,i.loader=null);const o=Gf(i.decryptdata)||n;delete this.keyIdToKeyInfo[o],a&&a.destroy()}}function Gf(l){if(l.keyFormat!==Ne.FAIRPLAY){const t=l.keyId;if(t)return ze(t)}return l.uri}function yy(l){const{type:t}=l;switch(t){case wt.AUDIO_TRACK:return mt.AUDIO;case wt.SUBTITLE_TRACK:return mt.SUBTITLE;default:return mt.MAIN}}function Hf(l,t){let e=l.url;return(e===void 0||e.indexOf("data:")===0)&&(e=t.url),e}class R_{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(R.MANIFEST_LOADING,this.onManifestLoading,this),t.on(R.LEVEL_LOADING,this.onLevelLoading,this),t.on(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(R.MANIFEST_LOADING,this.onManifestLoading,this),t.off(R.LEVEL_LOADING,this.onLevelLoading,this),t.off(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,n=e.loader,a=i||n,o=new a(e);return this.loaders[t.type]=o,o}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:wt.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:i,level:n,pathwayId:a,url:o,deliveryDirectives:c,levelInfo:d}=e;this.load({id:i,level:n,pathwayId:a,responseType:"text",type:wt.LEVEL,url:o,deliveryDirectives:c,levelOrTrack:d})}onAudioTrackLoading(t,e){const{id:i,groupId:n,url:a,deliveryDirectives:o,track:c}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:wt.AUDIO_TRACK,url:a,deliveryDirectives:o,levelOrTrack:c})}onSubtitleTrackLoading(t,e){const{id:i,groupId:n,url:a,deliveryDirectives:o,track:c}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:wt.SUBTITLE_TRACK,url:a,deliveryDirectives:o,levelOrTrack:c})}onLevelsUpdated(t,e){const i=this.loaders[wt.LEVEL];if(i){const n=i.context;n&&!e.levels.some(a=>a===n.levelOrTrack)&&(i.abort(),delete this.loaders[wt.LEVEL])}}load(t){var e;const i=this.hls.config;let n=this.getInternalLoader(t);if(n){const f=this.hls.logger,m=n.context;if(m&&m.levelOrTrack===t.levelOrTrack&&(m.url===t.url||m.deliveryDirectives&&!t.deliveryDirectives)){m.url===t.url?f.log(`[playlist-loader]: ignore ${t.url} ongoing request`):f.log(`[playlist-loader]: ignore ${t.url} in favor of ${m.url}`);return}f.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),n.abort()}let a;if(t.type===wt.MANIFEST?a=i.manifestLoadPolicy.default:a=Xt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(t),ht((e=t.deliveryDirectives)==null?void 0:e.part)){let f;if(t.type===wt.LEVEL&&t.level!==null?f=this.hls.levels[t.level].details:t.type===wt.AUDIO_TRACK&&t.id!==null?f=this.hls.audioTracks[t.id].details:t.type===wt.SUBTITLE_TRACK&&t.id!==null&&(f=this.hls.subtitleTracks[t.id].details),f){const m=f.partTarget,p=f.targetduration;if(m&&p){const g=Math.max(m*3,p*.8)*1e3;a=Xt({},a,{maxTimeToFirstByteMs:Math.min(g,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(g,a.maxTimeToFirstByteMs)})}}}const o=a.errorRetry||a.timeoutRetry||{},c={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},d={onSuccess:(f,m,p,g)=>{const v=this.getInternalLoader(p);this.resetInternalLoader(p.type);const E=f.data;m.parsing.start=performance.now(),Hi.isMediaPlaylist(E)||p.type!==wt.MANIFEST?this.handleTrackOrLevelPlaylist(f,m,p,g||null,v):this.handleMasterPlaylist(f,m,p,g)},onError:(f,m,p,g)=>{this.handleNetworkError(m,p,!1,f,g)},onTimeout:(f,m,p)=>{this.handleNetworkError(m,p,!0,void 0,f)}};n.load(t,c,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,n){const a=this.hls,o=t.data,c=Hf(t,i),d=Hi.parseMasterPlaylist(o,c);if(d.playlistParsingError){e.parsing.end=performance.now(),this.handleManifestParsingError(t,i,d.playlistParsingError,n,e);return}const{contentSteering:f,levels:m,sessionData:p,sessionKeys:g,startTimeOffset:v,variableList:E}=d;this.variableList=E,m.forEach(b=>{const{unknownCodecs:_}=b;if(_){const{preferManagedMediaSource:I}=this.hls.config;let{audioCodec:C,videoCodec:N}=b;for(let w=_.length;w--;){const P=_[w];ka(P,"audio",I)?(b.audioCodec=C=C?`${C},${P}`:P,_r.audio[C.substring(0,4)]=2,_.splice(w,1)):ka(P,"video",I)&&(b.videoCodec=N=N?`${N},${P}`:P,_r.video[N.substring(0,4)]=2,_.splice(w,1))}}});const{AUDIO:x=[],SUBTITLES:T,"CLOSED-CAPTIONS":A}=Hi.parseMasterPlaylistMedia(o,c,d);x.length&&!x.some(_=>!_.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new se({}),bitrate:0,url:""})),a.trigger(R.MANIFEST_LOADED,{levels:m,audioTracks:x,subtitles:T,captions:A,contentSteering:f,url:c,stats:e,networkDetails:n,sessionData:p,sessionKeys:g,startTimeOffset:v,variableList:E})}handleTrackOrLevelPlaylist(t,e,i,n,a){const o=this.hls,{id:c,level:d,type:f}=i,m=Hf(t,i),p=ht(d)?d:ht(c)?c:0,g=yy(i),v=Hi.parseLevelPlaylist(t.data,m,p,g,0,this.variableList);if(f===wt.MANIFEST){const E={attrs:new se({}),bitrate:0,details:v,name:"",url:m};v.requestScheduled=e.loading.start+pv(v,0),o.trigger(R.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:m,stats:e,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=v,this.handlePlaylistLoaded(v,t,e,i,n,a)}handleManifestParsingError(t,e,i,n,a){this.hls.trigger(R.ERROR,{type:vt.NETWORK_ERROR,details:q.MANIFEST_PARSING_ERROR,fatal:e.type===wt.MANIFEST,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:n,stats:a})}handleNetworkError(t,e,i=!1,n,a){let o=`A network ${i?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${t.type}`;t.type===wt.LEVEL?o+=`: ${t.level} id: ${t.id}`:(t.type===wt.AUDIO_TRACK||t.type===wt.SUBTITLE_TRACK)&&(o+=` id: ${t.id} group-id: "${t.groupId}"`);const c=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let d=q.UNKNOWN,f=!1;const m=this.getInternalLoader(t);switch(t.type){case wt.MANIFEST:d=i?q.MANIFEST_LOAD_TIMEOUT:q.MANIFEST_LOAD_ERROR,f=!0;break;case wt.LEVEL:d=i?q.LEVEL_LOAD_TIMEOUT:q.LEVEL_LOAD_ERROR,f=!1;break;case wt.AUDIO_TRACK:d=i?q.AUDIO_TRACK_LOAD_TIMEOUT:q.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case wt.SUBTITLE_TRACK:d=i?q.SUBTITLE_TRACK_LOAD_TIMEOUT:q.SUBTITLE_LOAD_ERROR,f=!1;break}m&&this.resetInternalLoader(t.type);const p={type:vt.NETWORK_ERROR,details:d,fatal:f,url:t.url,loader:m,context:t,error:c,networkDetails:e,stats:a};if(n){const g=e?.url||t.url;p.response=zt({url:g,data:void 0},n)}this.hls.trigger(R.ERROR,p)}handlePlaylistLoaded(t,e,i,n,a,o){const c=this.hls,{type:d,level:f,levelOrTrack:m,id:p,groupId:g,deliveryDirectives:v}=n,E=Hf(e,n),x=yy(n);let T=typeof n.level=="number"&&x===mt.MAIN?f:void 0;const A=t.playlistParsingError;if(A){if(this.hls.logger.warn(`${A} ${t.url}`),!c.config.ignorePlaylistParsingErrors){c.trigger(R.ERROR,{type:vt.NETWORK_ERROR,details:q.LEVEL_PARSING_ERROR,fatal:!1,url:E,error:A,reason:A.message,response:e,context:n,level:T,parent:x,networkDetails:a,stats:i});return}t.playlistParsingError=null}if(!t.fragments.length){const b=t.playlistParsingError=new Error("No Segments found in Playlist");c.trigger(R.ERROR,{type:vt.NETWORK_ERROR,details:q.LEVEL_EMPTY_ERROR,fatal:!1,url:E,error:b,reason:b.message,response:e,context:n,level:T,parent:x,networkDetails:a,stats:i});return}switch(t.live&&o&&(o.getCacheAge&&(t.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),d){case wt.MANIFEST:case wt.LEVEL:if(T){if(!m)T=0;else if(m!==c.levels[T]){const b=c.levels.indexOf(m);b>-1&&(T=b)}}c.trigger(R.LEVEL_LOADED,{details:t,levelInfo:m||c.levels[0],level:T||0,id:p||0,stats:i,networkDetails:a,deliveryDirectives:v,withoutMultiVariant:d===wt.MANIFEST});break;case wt.AUDIO_TRACK:c.trigger(R.AUDIO_TRACK_LOADED,{details:t,track:m,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:v});break;case wt.SUBTITLE_TRACK:c.trigger(R.SUBTITLE_TRACK_LOADED,{details:t,track:m,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:v});break}}}class Es{static get version(){return Pa}static isMSESupported(){return mE()}static isSupported(){return T_()}static getMediaSource(){return Ws()}static get Events(){return R}static get MetadataSchema(){return di}static get ErrorTypes(){return vt}static get ErrorDetails(){return q}static get DefaultConfig(){return Es.defaultConfig?Es.defaultConfig:u_}static set DefaultConfig(t){Es.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Dd,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=k1(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=f_(Es.DefaultConfig,t,e);this.userConfig=t,i.progressive&&d_(i,e);const{abrController:n,bufferController:a,capLevelController:o,errorController:c,fpsController:d}=i,f=new c(this),m=this.abrController=new n(this),p=new _b(this),g=i.interstitialsController,v=g?this.interstitialsController=new g(this,Es):null,E=this.bufferController=new a(this,p),x=this.capLevelController=new o(this),T=new d(this),A=new R_(this),b=i.contentSteeringController,_=b?new b(this):null,I=this.levelController=new S_(this,_),C=new v_(this),N=new L_(this.config,this.logger),w=this.streamController=new A_(this,p,N),P=this.gapController=new g_(this,p);x.setStreamController(w),T.setStreamController(w);const B=[A,I,w];v&&B.splice(1,0,v),_&&B.splice(1,0,_),this.networkControllers=B;const M=[m,E,P,x,T,C,p];this.audioTrackController=this.createController(i.audioTrackController,B);const K=i.audioStreamController;K&&B.push(this.audioStreamController=new K(this,p,N)),this.subtitleTrackController=this.createController(i.subtitleTrackController,B);const tt=i.subtitleStreamController;tt&&B.push(this.subtititleStreamController=new tt(this,p,N)),this.createController(i.timelineController,M),N.emeController=this.emeController=this.createController(i.emeController,M),this.cmcdController=this.createController(i.cmcdController,M),this.latencyController=this.createController(E_,M),this.coreComponents=M,B.push(f);const H=f.onErrorOut;typeof H=="function"&&this.on(R.ERROR,H,f),this.on(R.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(t,e){if(t){const i=new t(this);return e&&e.push(i),i}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,n){this._emitter.off(t,e,i,n)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const n=t===R.ERROR;this.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,fatal:n,event:t,error:i}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(R.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const a=new Error(`attachMedia failed: invalid argument (${t})`);this.trigger(R.ERROR,{type:vt.OTHER_ERROR,details:q.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,i=e?t.media:t,n=e?t:{media:i};this._media=i,this.trigger(R.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(R.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(R.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,i=this._url,n=this._url=vd.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),e&&i&&(i!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(R.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(t=-1,e){this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!(this.started||!this.networkControllers));t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()}))}get inFlightFragments(){const t={[mt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[mt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[mt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=t?.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=gR()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){fb(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let n=0;n<i;n++)if(t[n].maxBitrate>=e)return n;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this;let n;if(e===-1&&t!=null&&t.length?n=t.length-1:n=e,i)for(let a=n;a--;){const o=t[a].attrs["HDCP-LEVEL"];if(o&&o<=i)return a}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return((e=this.audioTrackController)==null?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return((e=this.subtitleTrackController)==null?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!!((t=this.bufferController)!=null&&t.bufferedToEnd)}get interstitialsManager(){var t;return((t=this.interstitialsController)==null?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t,e=this.allAudioTracks){const i=tv(e);return Zy(t,i,navigator.mediaCapabilities)}}Es.defaultConfig=void 0;function __({url:l,containerRef:t}){const e=J.useRef(null);return J.useEffect(()=>{if(!t?.current)return;const i=new b1({container:t.current,url:l,type:"m3u8",autoSize:!0,fullscreen:!0,fullscreenWeb:!0,playbackRate:!0,aspectRatio:!0,setting:!0,customType:{m3u8:(o,c)=>{if(Es.isSupported()){const d=new Es;d.loadSource(c),d.attachMedia(o)}else o.canPlayType("application/vnd.apple.mpegurl")&&(o.src=c)}}});e.current=i;const n=o=>{(o.key==="f"||o.key==="F")&&(i.fullscreen=!i.fullscreen)};let a=!1;return i.on("focus",()=>{a||(window.addEventListener("keydown",n),a=!0)}),i.on("blur",()=>{a&&(window.removeEventListener("keydown",n),a=!1)}),()=>{i&&i.destroy(!0)}},[]),J.useEffect(()=>{e.current&&e.current.url!==l&&e.current.switchUrl(l,"Tp mi")},[l]),null}const I_="_watch_ysw7b_2",D_="_info_ysw7b_83",C_="_episodes_ysw7b_159",w_="_active_ysw7b_178",k_={watch:I_,"watch-container":"_watch-container_ysw7b_7","watch-player":"_watch-player_ysw7b_7","player-center":"_player-center_ysw7b_16","player-return":"_player-return_ysw7b_27","player-ratio":"_player-ratio_ysw7b_40","watch-main":"_watch-main_ysw7b_62","watch-info":"_watch-info_ysw7b_71","thumb-container":"_thumb-container_ysw7b_79","info-thumb":"_info-thumb_ysw7b_83",info:D_,"info-name":"_info-name_ysw7b_105","info-alias-name":"_info-alias-name_ysw7b_111","info-detail":"_info-detail_ysw7b_118","detail-tags":"_detail-tags_ysw7b_124","tag-topic":"_tag-topic_ysw7b_129","detail-desc":"_detail-desc_ysw7b_138",episodes:C_,"episodes-button":"_episodes-button_ysw7b_165",active:w_,"watch-side":"_watch-side_ysw7b_192","actors-header":"_actors-header_ysw7b_197","actors-container":"_actors-container_ysw7b_202","actors-item":"_actors-item_ysw7b_209","actors-img":"_actors-img_ysw7b_215","actors-name":"_actors-name_ysw7b_222"},O_=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M73.4 297.4C60.9 309.9 60.9 330.2 73.4 342.7L233.4 502.7C245.9 515.2 266.2 515.2 278.7 502.7C291.2 490.2 291.2 469.9 278.7 457.4L173.3 352L544 352C561.7 352 576 337.7 576 320C576 302.3 561.7 288 544 288L173.3 288L278.7 182.6C291.2 170.1 291.2 149.8 278.7 137.3C266.2 124.8 245.9 124.8 233.4 137.3L73.4 297.3z"})),M_=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M187.2 100.9C174.8 94.1 159.8 94.4 147.6 101.6C135.4 108.8 128 121.9 128 136L128 504C128 518.1 135.5 531.2 147.6 538.4C159.7 545.6 174.8 545.9 187.2 539.1L523.2 355.1C536 348.1 544 334.6 544 320C544 305.4 536 291.9 523.2 284.9L187.2 100.9z"})),Ft=wr.bind(k_);function vy(){const{slug:l,episodeSlug:t}=Ex(),[e,i]=J.useState(null),[n,a]=J.useState(null),o=J.useRef();J.useEffect(()=>{const g=`https://ophim1.com/v1/api/phim/${l}`;fetch(g,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>i(T.data)).catch(T=>console.error(T));const E=g+"/peoples";fetch(E,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>a(T.data)).catch(T=>console.error(T))},[l]);const c=J.useMemo(()=>e?.breadCrumb.slice(0,2)||[],[e]),d=J.useMemo(()=>e?.breadCrumb.slice(2,e?.breadCrumb.length-1)||[],[e]),f=J.useMemo(()=>e?.item.episodes[0].server_data||[],[e]),m=J.useMemo(()=>f.length?t&&f.find(g=>g.slug===t)||f[0]:null,[f,t]),p=J.useMemo(()=>e?.item?.content&&new DOMParser().parseFromString(e.item.content,"text/html").body.textContent||"",[e]);return l?e?lt.jsxs("div",{className:Ft("watch"),children:[lt.jsxs("div",{className:Ft("watch-player"),children:[lt.jsxs("div",{className:Ft("player-center"),children:[lt.jsx(Tr,{to:`/movies/${l}`,className:Ft("player-return"),children:lt.jsx(O_,{})}),lt.jsxs("div",{className:Ft("player-name"),children:["X l focus blur input B call API ly nh thanh search https://img.ophim.live/uploads/movies/ + path CSS control Thm webkit gii hn cho desc Xem phim ",e.item.name]})]}),lt.jsx("div",{className:Ft("player-ratio"),ref:o,children:lt.jsx(__,{url:m?.link_m3u8,containerRef:o})})]}),lt.jsxs("div",{className:Ft("watch-container"),children:[lt.jsxs("div",{className:Ft("watch-main"),children:[lt.jsxs("div",{className:Ft("watch-info"),children:[lt.jsx("div",{className:Ft("thumb-container"),children:lt.jsx("div",{className:Ft("info-thumb"),children:lt.jsx("img",{src:e.APP_DOMAIN_CDN_IMAGE+"/uploads/"+e.seoOnPage.og_image[0],alt:e.item.name})})}),lt.jsx("div",{className:Ft("info"),children:lt.jsxs("div",{children:[lt.jsx("div",{className:Ft("info-name"),children:lt.jsx(Tr,{to:`/movies/${e.params.slug}`,children:e.item.name})}),lt.jsx("div",{className:Ft("info-alias-name"),children:e.item.origin_name}),lt.jsxs("div",{className:Ft("info-detail"),children:[lt.jsx("div",{className:Ft("detail-tags"),children:c.map((g,v)=>lt.jsx("a",{className:Ft("tag-topic"),href:g.slug,children:g.name},v))}),lt.jsx("div",{className:Ft("detail-tags"),children:d.map((g,v)=>lt.jsx("a",{className:Ft("tag-topic"),href:g.slug,children:g.name},v))})]})]})}),lt.jsxs("div",{className:Ft("detail-desc"),children:[lt.jsx("div",{className:Ft("desc"),children:p}),lt.jsxs(Tr,{to:`/movies/${e.params.slug}`,children:["Thng tin phim",lt.jsx(By,{})]})]})]}),lt.jsx("div",{className:Ft("watch-episodes"),children:lt.jsx("div",{className:Ft("episodes"),children:f.length>1&&f.map(g=>{const v=t===g.slug||!t&&g.slug===f[0].slug;return lt.jsxs(Tr,{to:`/watch/${l}/${g.slug}`,className:Ft("episodes-button",{active:v}),children:[lt.jsx(M_,{}),"Tp ",g.name]},g.slug)})})})]}),lt.jsxs("div",{className:Ft("watch-side"),children:[lt.jsx("div",{className:Ft("side-rate")}),lt.jsxs("div",{className:Ft("side-actors"),children:[lt.jsx("div",{className:Ft("actors-header"),children:"Din vin"}),lt.jsx("div",{className:Ft("actors-container"),children:n&&n.peoples.map(g=>lt.jsxs("div",{className:Ft("actors-item"),children:[lt.jsx("div",{className:Ft("actors-img"),children:lt.jsx("img",{src:n.profile_sizes.original+g.profile_path,alt:g.name})}),lt.jsx("div",{className:Ft("actors-name"),children:g.name})]},g.id))})]})]})]})]}):lt.jsx("div",{className:Ft("loading"),children:"ang ti phim..."}):lt.jsxs("div",{children:[lt.jsx("h1",{children:"Trang danh sch phim (Watch)"}),lt.jsx("p",{children:"Hin th danh sch cc phim..."})]})}const P_="_fixed_4e0uc_8",N_="_header_4e0uc_1",B_="_logo_4e0uc_29",F_={"header-wrapper":"_header-wrapper_4e0uc_1",fixed:P_,header:N_,logo:B_},U_="_search_1as0s_2",$_="_fadeInUp_1as0s_1",j_="_item_1as0s_94",G_="_spinner_1as0s_1",H_={search:U_,"search-container":"_search-container_1as0s_6","search-element":"_search-element_1as0s_10","search-icon":"_search-icon_1as0s_14","remove-icon":"_remove-icon_1as0s_28","search-input":"_search-input_1as0s_42","search-list":"_search-list_1as0s_56",fadeInUp:$_,"list-container":"_list-container_1as0s_82","list-title":"_list-title_1as0s_89",item:j_,"item-poster-container":"_item-poster-container_1as0s_108","item-poster":"_item-poster_1as0s_108","item-desc":"_item-desc_1as0s_130","item-name":"_item-name_1as0s_149","item-tag-span":"_item-tag-span_1as0s_155","view-all":"_view-all_1as0s_173","no-result":"_no-result_1as0s_190","loading-icon":"_loading-icon_1as0s_207",spinner:G_},z_=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M480 272C480 317.9 465.1 360.3 440 394.7L566.6 521.4C579.1 533.9 579.1 554.2 566.6 566.7C554.1 579.2 533.8 579.2 521.3 566.7L394.7 440C360.3 465.1 317.9 480 272 480C157.1 480 64 386.9 64 272C64 157.1 157.1 64 272 64C386.9 64 480 157.1 480 272zM272 416C351.5 416 416 351.5 416 272C416 192.5 351.5 128 272 128C192.5 128 128 192.5 128 272C128 351.5 192.5 416 272 416z"})),V_=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM231 231C240.4 221.6 255.6 221.6 264.9 231L319.9 286L374.9 231C384.3 221.6 399.5 221.6 408.8 231C418.1 240.4 418.2 255.6 408.8 264.9L353.8 319.9L408.8 374.9C418.2 384.3 418.2 399.5 408.8 408.8C399.4 418.1 384.2 418.2 374.9 408.8L319.9 353.8L264.9 408.8C255.5 418.2 240.3 418.2 231 408.8C221.7 399.4 221.6 384.2 231 374.9L286 319.9L231 264.9C221.6 255.5 221.6 240.3 231 231z"})),K_=l=>J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...l},J.createElement("path",{d:"M272 112C272 85.5 293.5 64 320 64C346.5 64 368 85.5 368 112C368 138.5 346.5 160 320 160C293.5 160 272 138.5 272 112zM272 528C272 501.5 293.5 480 320 480C346.5 480 368 501.5 368 528C368 554.5 346.5 576 320 576C293.5 576 272 554.5 272 528zM112 272C138.5 272 160 293.5 160 320C160 346.5 138.5 368 112 368C85.5 368 64 346.5 64 320C64 293.5 85.5 272 112 272zM480 320C480 293.5 501.5 272 528 272C554.5 272 576 293.5 576 320C576 346.5 554.5 368 528 368C501.5 368 480 346.5 480 320zM139 433.1C157.8 414.3 188.1 414.3 206.9 433.1C225.7 451.9 225.7 482.2 206.9 501C188.1 519.8 157.8 519.8 139 501C120.2 482.2 120.2 451.9 139 433.1zM139 139C157.8 120.2 188.1 120.2 206.9 139C225.7 157.8 225.7 188.1 206.9 206.9C188.1 225.7 157.8 225.7 139 206.9C120.2 188.1 120.2 157.8 139 139zM501 433.1C519.8 451.9 519.8 482.2 501 501C482.2 519.8 451.9 519.8 433.1 501C414.3 482.2 414.3 451.9 433.1 433.1C451.9 414.3 482.2 414.3 501 433.1z"})),fe=wr.bind(H_);function q_(){const[l,t]=J.useState(""),[e,i]=J.useState([]),[n,a]=J.useState(!0),[o,c]=J.useState(!0),[d,f]=J.useState(!0),m=J.useRef(null);return J.useEffect(()=>{if(!l.trim()){i([]);return}const p=setTimeout(()=>{const g=`https://ophim1.com/v1/api/tim-kiem?keyword=${l}`,v={method:"GET",headers:{accept:"application/json"}};fetch(g,v).then(E=>E.json()).then(E=>{c(!0);const T=(E.data.items||[]).slice(0,5);if(console.log(T),T.length===0){i([]);return}const A=T.map(b=>{const _=`https://ophim1.com/v1/api/phim/${b.slug}/images`;return fetch(_,v).then(I=>I.json()).then(I=>{const w=`https://image.tmdb.org/t/p/original${I.data.images.find(P=>P.type==="poster").file_path}`;return b.posterHandlePath=w,b}).catch(I=>(console.error(`Li khi ly nh cho ${b.slug}:`,I),b))});return Promise.all(A)}).then(E=>{E&&(i(E),c(!1))}).catch(E=>{console.error("Li trong chui API:",E),i([])})},400);return()=>{clearTimeout(p)}},[l]),lt.jsx("div",{className:fe("search"),children:lt.jsxs("div",{className:fe("search-container"),children:[lt.jsxs("div",{className:fe("search-element"),children:[lt.jsx("div",{className:fe("search-icon"),children:lt.jsx(z_,{})}),lt.jsx("input",{value:l,onChange:p=>t(p.target.value),id:"main-search",className:fe("search-input"),type:"text",placeholder:"Tm kim phim",autoComplete:"off",ref:m}),lt.jsx("div",{onClick:()=>{t(""),m.current.focus()},className:fe("remove-icon"),children:l.length>0&&lt.jsx(V_,{})})]}),n&&l&&lt.jsxs("div",{className:fe("search-list"),children:[l.length>0&&e.length==0&&lt.jsx("div",{className:fe("no-result"),children:"Khng tm thy kt qu"}),o&&d&&lt.jsx(K_,{className:fe("loading-icon")}),!o&&l.length>0&&e.length>0&&lt.jsxs("div",{className:fe("list-container"),children:[lt.jsx("div",{className:fe("list-title"),children:"Danh sch phim"}),lt.jsx("div",{className:fe("list-result"),children:l.length>0&&e.map(p=>lt.jsxs("a",{className:fe("item"),href:`/watch/${p.slug}`,children:[lt.jsx("div",{className:fe("item-poster-container"),children:lt.jsx("div",{className:fe("item-poster"),children:lt.jsx("img",{onLoad:()=>f(!1),src:p.posterHandlePath,alt:"poster"})})}),lt.jsxs("div",{className:fe("item-desc"),children:[lt.jsx("div",{className:fe("item-name"),children:p.name}),lt.jsx("div",{className:fe("item-origin-name"),children:p.origin_name}),lt.jsxs("div",{className:fe("item-tag"),children:[lt.jsx("span",{children:p.year}),lt.jsx("span",{className:fe("item-tag-span"),children:p.time}),lt.jsx("span",{className:fe("item-tag-span"),children:p.episode_current||p.time})]})]})]},p._id))})]}),l.length>0&&e.length>0&&lt.jsx("a",{className:fe("view-all"),href:"/tim-kiem?q=a",children:"Ton b kt qu"})]})]})})}const zf=wr.bind(F_);function pE(){return lt.jsx("div",{className:zf("header-wrapper","fixed"),children:lt.jsxs("div",{className:zf("header"),children:[lt.jsx("a",{href:"/",className:zf("logo"),children:lt.jsx("img",{src:"/logo.svg",alt:"ATPhim"})}),lt.jsx(q_,{}),lt.jsx("div",{style:{backgroundColor:"blue",width:"882px",height:"40px"}})]})})}function Y_(){}function X_({children:l}){return lt.jsxs("div",{children:[lt.jsx(pE,{}),lt.jsxs("div",{className:"container",children:[lt.jsx(Y_,{}),l]})]})}function Ey({children:l}){return lt.jsxs("div",{children:[lt.jsx(pE,{}),lt.jsx("div",{className:"contaier",children:l})]})}const Q_=[{path:"/",component:x1},{path:"/watch/:slug",component:vy,layout:Ey},{path:"/watch/:slug/:episodeSlug",component:vy,layout:Ey}];function W_(){return lt.jsx(lt.Fragment,{children:lt.jsx(s1,{children:lt.jsx("div",{className:"app",children:lt.jsx(Mx,{children:Q_.map((l,t)=>{const e=l.component;let i=X_;return l.layout?i=l.layout:l.layout===null&&(i=J.Fragment),lt.jsx(wy,{path:l.path,element:lt.jsx(i,{children:lt.jsx(e,{})})},t)})})})})})}jT.createRoot(document.getElementById("root")).render(lt.jsx(J.StrictMode,{children:lt.jsx(GT,{children:lt.jsx(W_,{})})}))});export default Z_();
