var kb=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var h2=kb((ES,$s)=>{function Mb(r,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in r)){const a=Object.getOwnPropertyDescriptor(i,s);a&&Object.defineProperty(r,s,a.get?a:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();function oh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Jf={exports:{}},Va={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V0;function Pb(){if(V0)return Va;V0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:r,type:i,key:l,ref:s!==void 0?s:null,props:a}}return Va.Fragment=t,Va.jsx=e,Va.jsxs=e,Va}var K0;function Nb(){return K0||(K0=1,Jf.exports=Pb()),Jf.exports}var X=Nb(),td={exports:{}},Rt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q0;function Fb(){if(q0)return Rt;q0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function y(k){return k===null||typeof k!="object"?null:(k=g&&k[g]||k["@@iterator"],typeof k=="function"?k:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,T={};function A(k,$,st){this.props=k,this.context=$,this.refs=T,this.updater=st||v}A.prototype.isReactComponent={},A.prototype.setState=function(k,$){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,$,"setState")},A.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function b(){}b.prototype=A.prototype;function R(k,$,st){this.props=k,this.context=$,this.refs=T,this.updater=st||v}var C=R.prototype=new b;C.constructor=R,S(C,A.prototype),C.isPureReactComponent=!0;var D=Array.isArray;function N(){}var w={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function B(k,$,st){var ct=st.ref;return{$$typeof:r,type:k,key:$,ref:ct!==void 0?ct:null,props:st}}function M(k,$){return B(k.type,$,k.props)}function K(k){return typeof k=="object"&&k!==null&&k.$$typeof===r}function tt(k){var $={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(st){return $[st]})}var z=/\/+/g;function G(k,$){return typeof k=="object"&&k!==null&&k.key!=null?tt(""+k.key):$.toString(36)}function Y(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(N,N):(k.status="pending",k.then(function($){k.status==="pending"&&(k.status="fulfilled",k.value=$)},function($){k.status==="pending"&&(k.status="rejected",k.reason=$)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function O(k,$,st,ct,ft){var dt=typeof k;(dt==="undefined"||dt==="boolean")&&(k=null);var Et=!1;if(k===null)Et=!0;else switch(dt){case"bigint":case"string":case"number":Et=!0;break;case"object":switch(k.$$typeof){case r:case t:Et=!0;break;case h:return Et=k._init,O(Et(k._payload),$,st,ct,ft)}}if(Et)return ft=ft(k),Et=ct===""?"."+G(k,0):ct,D(ft)?(st="",Et!=null&&(st=Et.replace(z,"$&/")+"/"),O(ft,$,st,"",function(ee){return ee})):ft!=null&&(K(ft)&&(ft=M(ft,st+(ft.key==null||k&&k.key===ft.key?"":(""+ft.key).replace(z,"$&/")+"/")+Et)),$.push(ft)),1;Et=0;var Lt=ct===""?".":ct+":";if(D(k))for(var _t=0;_t<k.length;_t++)ct=k[_t],dt=Lt+G(ct,_t),Et+=O(ct,$,st,dt,ft);else if(_t=y(k),typeof _t=="function")for(k=_t.call(k),_t=0;!(ct=k.next()).done;)ct=ct.value,dt=Lt+G(ct,_t++),Et+=O(ct,$,st,dt,ft);else if(dt==="object"){if(typeof k.then=="function")return O(Y(k),$,st,ct,ft);throw $=String(k),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return Et}function j(k,$,st){if(k==null)return k;var ct=[],ft=0;return O(k,ct,"","",function(dt){return $.call(st,dt,ft++)}),ct}function V(k){if(k._status===-1){var $=k._result;$=$(),$.then(function(st){(k._status===0||k._status===-1)&&(k._status=1,k._result=st)},function(st){(k._status===0||k._status===-1)&&(k._status=2,k._result=st)}),k._status===-1&&(k._status=0,k._result=$)}if(k._status===1)return k._result.default;throw k._result}var nt=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},ut={map:j,forEach:function(k,$,st){j(k,function(){$.apply(this,arguments)},st)},count:function(k){var $=0;return j(k,function(){$++}),$},toArray:function(k){return j(k,function($){return $})||[]},only:function(k){if(!K(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return Rt.Activity=p,Rt.Children=ut,Rt.Component=A,Rt.Fragment=e,Rt.Profiler=s,Rt.PureComponent=R,Rt.StrictMode=i,Rt.Suspense=d,Rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,Rt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return w.H.useMemoCache(k)}},Rt.cache=function(k){return function(){return k.apply(null,arguments)}},Rt.cacheSignal=function(){return null},Rt.cloneElement=function(k,$,st){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var ct=S({},k.props),ft=k.key;if($!=null)for(dt in $.key!==void 0&&(ft=""+$.key),$)!P.call($,dt)||dt==="key"||dt==="__self"||dt==="__source"||dt==="ref"&&$.ref===void 0||(ct[dt]=$[dt]);var dt=arguments.length-2;if(dt===1)ct.children=st;else if(1<dt){for(var Et=Array(dt),Lt=0;Lt<dt;Lt++)Et[Lt]=arguments[Lt+2];ct.children=Et}return B(k.type,ft,ct)},Rt.createContext=function(k){return k={$$typeof:l,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},Rt.createElement=function(k,$,st){var ct,ft={},dt=null;if($!=null)for(ct in $.key!==void 0&&(dt=""+$.key),$)P.call($,ct)&&ct!=="key"&&ct!=="__self"&&ct!=="__source"&&(ft[ct]=$[ct]);var Et=arguments.length-2;if(Et===1)ft.children=st;else if(1<Et){for(var Lt=Array(Et),_t=0;_t<Et;_t++)Lt[_t]=arguments[_t+2];ft.children=Lt}if(k&&k.defaultProps)for(ct in Et=k.defaultProps,Et)ft[ct]===void 0&&(ft[ct]=Et[ct]);return B(k,dt,ft)},Rt.createRef=function(){return{current:null}},Rt.forwardRef=function(k){return{$$typeof:u,render:k}},Rt.isValidElement=K,Rt.lazy=function(k){return{$$typeof:h,_payload:{_status:-1,_result:k},_init:V}},Rt.memo=function(k,$){return{$$typeof:f,type:k,compare:$===void 0?null:$}},Rt.startTransition=function(k){var $=w.T,st={};w.T=st;try{var ct=k(),ft=w.S;ft!==null&&ft(st,ct),typeof ct=="object"&&ct!==null&&typeof ct.then=="function"&&ct.then(N,nt)}catch(dt){nt(dt)}finally{$!==null&&st.types!==null&&($.types=st.types),w.T=$}},Rt.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},Rt.use=function(k){return w.H.use(k)},Rt.useActionState=function(k,$,st){return w.H.useActionState(k,$,st)},Rt.useCallback=function(k,$){return w.H.useCallback(k,$)},Rt.useContext=function(k){return w.H.useContext(k)},Rt.useDebugValue=function(){},Rt.useDeferredValue=function(k,$){return w.H.useDeferredValue(k,$)},Rt.useEffect=function(k,$){return w.H.useEffect(k,$)},Rt.useEffectEvent=function(k){return w.H.useEffectEvent(k)},Rt.useId=function(){return w.H.useId()},Rt.useImperativeHandle=function(k,$,st){return w.H.useImperativeHandle(k,$,st)},Rt.useInsertionEffect=function(k,$){return w.H.useInsertionEffect(k,$)},Rt.useLayoutEffect=function(k,$){return w.H.useLayoutEffect(k,$)},Rt.useMemo=function(k,$){return w.H.useMemo(k,$)},Rt.useOptimistic=function(k,$){return w.H.useOptimistic(k,$)},Rt.useReducer=function(k,$,st){return w.H.useReducer(k,$,st)},Rt.useRef=function(k){return w.H.useRef(k)},Rt.useState=function(k){return w.H.useState(k)},Rt.useSyncExternalStore=function(k,$,st){return w.H.useSyncExternalStore(k,$,st)},Rt.useTransition=function(){return w.H.useTransition()},Rt.version="19.2.0",Rt}var Y0;function lh(){return Y0||(Y0=1,td.exports=Fb()),td.exports}var F=lh();const Bb=oh(F),Ub=Mb({__proto__:null,default:Bb},[F]);var ed={exports:{}},Ka={},id={exports:{}},nd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X0;function $b(){return X0||(X0=1,(function(r){function t(O,j){var V=O.length;O.push(j);t:for(;0<V;){var nt=V-1>>>1,ut=O[nt];if(0<s(ut,j))O[nt]=j,O[V]=ut,V=nt;else break t}}function e(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var j=O[0],V=O.pop();if(V!==j){O[0]=V;t:for(var nt=0,ut=O.length,k=ut>>>1;nt<k;){var $=2*(nt+1)-1,st=O[$],ct=$+1,ft=O[ct];if(0>s(st,V))ct<ut&&0>s(ft,st)?(O[nt]=ft,O[ct]=V,nt=ct):(O[nt]=st,O[$]=V,nt=$);else if(ct<ut&&0>s(ft,V))O[nt]=ft,O[ct]=V,nt=ct;else break t}}return j}function s(O,j){var V=O.sortIndex-j.sortIndex;return V!==0?V:O.id-j.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var d=[],f=[],h=1,p=null,g=3,y=!1,v=!1,S=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function C(O){for(var j=e(f);j!==null;){if(j.callback===null)i(f);else if(j.startTime<=O)i(f),j.sortIndex=j.expirationTime,t(d,j);else break;j=e(f)}}function D(O){if(S=!1,C(O),!v)if(e(d)!==null)v=!0,N||(N=!0,tt());else{var j=e(f);j!==null&&Y(D,j.startTime-O)}}var N=!1,w=-1,P=5,B=-1;function M(){return T?!0:!(r.unstable_now()-B<P)}function K(){if(T=!1,N){var O=r.unstable_now();B=O;var j=!0;try{t:{v=!1,S&&(S=!1,b(w),w=-1),y=!0;var V=g;try{e:{for(C(O),p=e(d);p!==null&&!(p.expirationTime>O&&M());){var nt=p.callback;if(typeof nt=="function"){p.callback=null,g=p.priorityLevel;var ut=nt(p.expirationTime<=O);if(O=r.unstable_now(),typeof ut=="function"){p.callback=ut,C(O),j=!0;break e}p===e(d)&&i(d),C(O)}else i(d);p=e(d)}if(p!==null)j=!0;else{var k=e(f);k!==null&&Y(D,k.startTime-O),j=!1}}break t}finally{p=null,g=V,y=!1}j=void 0}}finally{j?tt():N=!1}}}var tt;if(typeof R=="function")tt=function(){R(K)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,G=z.port2;z.port1.onmessage=K,tt=function(){G.postMessage(null)}}else tt=function(){A(K,0)};function Y(O,j){w=A(function(){O(r.unstable_now())},j)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(O){O.callback=null},r.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<O?Math.floor(1e3/O):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_next=function(O){switch(g){case 1:case 2:case 3:var j=3;break;default:j=g}var V=g;g=j;try{return O()}finally{g=V}},r.unstable_requestPaint=function(){T=!0},r.unstable_runWithPriority=function(O,j){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var V=g;g=O;try{return j()}finally{g=V}},r.unstable_scheduleCallback=function(O,j,V){var nt=r.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?nt+V:nt):V=nt,O){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=V+ut,O={id:h++,callback:j,priorityLevel:O,startTime:V,expirationTime:ut,sortIndex:-1},V>nt?(O.sortIndex=V,t(f,O),e(d)===null&&O===e(f)&&(S?(b(w),w=-1):S=!0,Y(D,V-nt))):(O.sortIndex=ut,t(d,O),v||y||(v=!0,N||(N=!0,tt()))),O},r.unstable_shouldYield=M,r.unstable_wrapCallback=function(O){var j=g;return function(){var V=g;g=j;try{return O.apply(this,arguments)}finally{g=V}}}})(nd)),nd}var W0;function jb(){return W0||(W0=1,id.exports=$b()),id.exports}var sd={exports:{}},$e={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q0;function Gb(){if(Q0)return $e;Q0=1;var r=lh();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:d,containerInfo:f,implementation:h}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return $e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$e.createPortal=function(d,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,h)},$e.flushSync=function(d){var f=l.T,h=i.p;try{if(l.T=null,i.p=2,d)return d()}finally{l.T=f,i.p=h,i.d.f()}},$e.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},$e.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},$e.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var h=f.as,p=u(h,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:y}):h==="script"&&i.d.X(d,{crossOrigin:p,integrity:g,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},$e.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},$e.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=u(h,f.crossOrigin);i.d.L(d,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},$e.preloadModule=function(d,f){if(typeof d=="string")if(f){var h=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},$e.requestFormReset=function(d){i.d.r(d)},$e.unstable_batchedUpdates=function(d,f){return d(f)},$e.useFormState=function(d,f,h){return l.H.useFormState(d,f,h)},$e.useFormStatus=function(){return l.H.useHostTransitionStatus()},$e.version="19.2.0",$e}var Z0;function jv(){if(Z0)return sd.exports;Z0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),sd.exports=Gb(),sd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0;function Hb(){if(J0)return Ka;J0=1;var r=jb(),t=lh(),e=jv();function i(n){var o="https://react.dev/errors/"+n;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function a(n){var o=n,c=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(c=o.return),n=o.return;while(n)}return o.tag===3?c:null}function l(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function u(n){if(n.tag===31){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function d(n){if(a(n)!==n)throw Error(i(188))}function f(n){var o=n.alternate;if(!o){if(o=a(n),o===null)throw Error(i(188));return o!==n?null:n}for(var c=n,m=o;;){var E=c.return;if(E===null)break;var x=E.alternate;if(x===null){if(m=E.return,m!==null){c=m;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===c)return d(E),n;if(x===m)return d(E),o;x=x.sibling}throw Error(i(188))}if(c.return!==m.return)c=E,m=x;else{for(var L=!1,I=E.child;I;){if(I===c){L=!0,c=E,m=x;break}if(I===m){L=!0,m=E,c=x;break}I=I.sibling}if(!L){for(I=x.child;I;){if(I===c){L=!0,c=x,m=E;break}if(I===m){L=!0,m=x,c=E;break}I=I.sibling}if(!L)throw Error(i(189))}}if(c.alternate!==m)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?n:o}function h(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n;for(n=n.child;n!==null;){if(o=h(n),o!==null)return o;n=n.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),R=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function tt(n){return n===null||typeof n!="object"?null:(n=K&&n[K]||n["@@iterator"],typeof n=="function"?n:null)}var z=Symbol.for("react.client.reference");function G(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===z?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case D:return"Suspense";case N:return"SuspenseList";case B:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case v:return"Portal";case R:return n.displayName||"Context";case b:return(n._context.displayName||"Context")+".Consumer";case C:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case w:return o=n.displayName||null,o!==null?o:G(n.type)||"Memo";case P:o=n._payload,n=n._init;try{return G(n(o))}catch{}}return null}var Y=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},nt=[],ut=-1;function k(n){return{current:n}}function $(n){0>ut||(n.current=nt[ut],nt[ut]=null,ut--)}function st(n,o){ut++,nt[ut]=n.current,n.current=o}var ct=k(null),ft=k(null),dt=k(null),Et=k(null);function Lt(n,o){switch(st(dt,o),st(ft,n),st(ct,null),o.nodeType){case 9:case 11:n=(n=o.documentElement)&&(n=n.namespaceURI)?m0(n):0;break;default:if(n=o.tagName,o=o.namespaceURI)o=m0(o),n=p0(o,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}$(ct),st(ct,n)}function _t(){$(ct),$(ft),$(dt)}function ee(n){n.memoizedState!==null&&st(Et,n);var o=ct.current,c=p0(o,n.type);o!==c&&(st(ft,n),st(ct,c))}function he(n){ft.current===n&&($(ct),$(ft)),Et.current===n&&($(Et),ja._currentValue=V)}var Re,De;function Le(n){if(Re===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Re=o&&o[1]||"",De=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+n+De}var Fi=!1;function bt(n,o){if(!n||Fi)return"";Fi=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(o){var lt=function(){throw Error()};if(Object.defineProperty(lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(lt,[])}catch(it){var et=it}Reflect.construct(n,[],lt)}else{try{lt.call()}catch(it){et=it}n.call(lt.prototype)}}else{try{throw Error()}catch(it){et=it}(lt=n())&&typeof lt.catch=="function"&&lt.catch(function(){})}}catch(it){if(it&&et&&typeof it.stack=="string")return[it.stack,et.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=m.DetermineComponentFrameRoot(),L=x[0],I=x[1];if(L&&I){var U=L.split(`
`),J=I.split(`
`);for(E=m=0;m<U.length&&!U[m].includes("DetermineComponentFrameRoot");)m++;for(;E<J.length&&!J[E].includes("DetermineComponentFrameRoot");)E++;if(m===U.length||E===J.length)for(m=U.length-1,E=J.length-1;1<=m&&0<=E&&U[m]!==J[E];)E--;for(;1<=m&&0<=E;m--,E--)if(U[m]!==J[E]){if(m!==1||E!==1)do if(m--,E--,0>E||U[m]!==J[E]){var rt=`
`+U[m].replace(" at new "," at ");return n.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",n.displayName)),rt}while(1<=m&&0<=E);break}}}finally{Fi=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?Le(c):""}function pt(n,o){switch(n.tag){case 26:case 27:case 5:return Le(n.type);case 16:return Le("Lazy");case 13:return n.child!==o&&o!==null?Le("Suspense Fallback"):Le("Suspense");case 19:return Le("SuspenseList");case 0:case 15:return bt(n.type,!1);case 11:return bt(n.type.render,!1);case 1:return bt(n.type,!0);case 31:return Le("Activity");default:return""}}function Se(n){try{var o="",c=null;do o+=pt(n,c),c=n,n=n.return;while(n);return o}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var oe=Object.prototype.hasOwnProperty,le=r.unstable_scheduleCallback,Ie=r.unstable_cancelCallback,Ue=r.unstable_shouldYield,je=r.unstable_requestPaint,ie=r.unstable_now,on=r.unstable_getCurrentPriorityLevel,qe=r.unstable_ImmediatePriority,ps=r.unstable_UserBlockingPriority,Nn=r.unstable_NormalPriority,Xs=r.unstable_LowPriority,gs=r.unstable_IdlePriority,ln=r.log,Fu=r.unstable_setDisableYieldValue,ys=null,Ge=null;function Bi(n){if(typeof ln=="function"&&Fu(n),Ge&&typeof Ge.setStrictMode=="function")try{Ge.setStrictMode(ys,n)}catch{}}var He=Math.clz32?Math.clz32:Ot,Bu=Math.log,Uu=Math.LN2;function Ot(n){return n>>>=0,n===0?32:31-(Bu(n)/Uu|0)|0}var mo=256,po=262144,go=4194304;function vs(n){var o=n&42;if(o!==0)return o;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function yo(n,o,c){var m=n.pendingLanes;if(m===0)return 0;var E=0,x=n.suspendedLanes,L=n.pingedLanes;n=n.warmLanes;var I=m&134217727;return I!==0?(m=I&~x,m!==0?E=vs(m):(L&=I,L!==0?E=vs(L):c||(c=I&~n,c!==0&&(E=vs(c))))):(I=m&~x,I!==0?E=vs(I):L!==0?E=vs(L):c||(c=m&~n,c!==0&&(E=vs(c)))),E===0?0:o!==0&&o!==E&&(o&x)===0&&(x=E&-E,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:E}function ta(n,o){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&o)===0}function xS(n,o){switch(n){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xh(){var n=go;return go<<=1,(go&62914560)===0&&(go=4194304),n}function $u(n){for(var o=[],c=0;31>c;c++)o.push(n);return o}function ea(n,o){n.pendingLanes|=o,o!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function SS(n,o,c,m,E,x){var L=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var I=n.entanglements,U=n.expirationTimes,J=n.hiddenUpdates;for(c=L&~c;0<c;){var rt=31-He(c),lt=1<<rt;I[rt]=0,U[rt]=-1;var et=J[rt];if(et!==null)for(J[rt]=null,rt=0;rt<et.length;rt++){var it=et[rt];it!==null&&(it.lane&=-536870913)}c&=~lt}m!==0&&Wh(n,m,0),x!==0&&E===0&&n.tag!==0&&(n.suspendedLanes|=x&~(L&~o))}function Wh(n,o,c){n.pendingLanes|=o,n.suspendedLanes&=~o;var m=31-He(o);n.entangledLanes|=o,n.entanglements[m]=n.entanglements[m]|1073741824|c&261930}function Qh(n,o){var c=n.entangledLanes|=o;for(n=n.entanglements;c;){var m=31-He(c),E=1<<m;E&o|n[m]&o&&(n[m]|=o),c&=~E}}function Zh(n,o){var c=o&-o;return c=(c&42)!==0?1:ju(c),(c&(n.suspendedLanes|o))!==0?0:c}function ju(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Gu(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Jh(){var n=j.p;return n!==0?n:(n=window.event,n===void 0?32:B0(n.type))}function tm(n,o){var c=j.p;try{return j.p=n,o()}finally{j.p=c}}var Fn=Math.random().toString(36).slice(2),Oe="__reactFiber$"+Fn,Ye="__reactProps$"+Fn,Ws="__reactContainer$"+Fn,Hu="__reactEvents$"+Fn,TS="__reactListeners$"+Fn,bS="__reactHandles$"+Fn,em="__reactResources$"+Fn,ia="__reactMarker$"+Fn;function zu(n){delete n[Oe],delete n[Ye],delete n[Hu],delete n[TS],delete n[bS]}function Qs(n){var o=n[Oe];if(o)return o;for(var c=n.parentNode;c;){if(o=c[Ws]||c[Oe]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(n=T0(n);n!==null;){if(c=n[Oe])return c;n=T0(n)}return o}n=c,c=n.parentNode}return null}function Zs(n){if(n=n[Oe]||n[Ws]){var o=n.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return n}return null}function na(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n.stateNode;throw Error(i(33))}function Js(n){var o=n[em];return o||(o=n[em]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function _e(n){n[ia]=!0}var im=new Set,nm={};function Es(n,o){tr(n,o),tr(n+"Capture",o)}function tr(n,o){for(nm[n]=o,n=0;n<o.length;n++)im.add(o[n])}var AS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sm={},rm={};function RS(n){return oe.call(rm,n)?!0:oe.call(sm,n)?!1:AS.test(n)?rm[n]=!0:(sm[n]=!0,!1)}function vo(n,o,c){if(RS(o))if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(o);return;case"boolean":var m=o.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){n.removeAttribute(o);return}}n.setAttribute(o,""+c)}}function Eo(n,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttribute(o,""+c)}}function un(n,o,c,m){if(m===null)n.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(o,c,""+m)}}function yi(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function am(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function LS(n,o,c){var m=Object.getOwnPropertyDescriptor(n.constructor.prototype,o);if(!n.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var E=m.get,x=m.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return E.call(this)},set:function(L){c=""+L,x.call(this,L)}}),Object.defineProperty(n,o,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(L){c=""+L},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Vu(n){if(!n._valueTracker){var o=am(n)?"checked":"value";n._valueTracker=LS(n,o,""+n[o])}}function om(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return n&&(m=am(n)?n.checked?"true":"false":n.value),n=m,n!==c?(o.setValue(n),!0):!1}function xo(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var _S=/[\n"\\]/g;function vi(n){return n.replace(_S,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ku(n,o,c,m,E,x,L,I){n.name="",L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.type=L:n.removeAttribute("type"),o!=null?L==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+yi(o)):n.value!==""+yi(o)&&(n.value=""+yi(o)):L!=="submit"&&L!=="reset"||n.removeAttribute("value"),o!=null?qu(n,L,yi(o)):c!=null?qu(n,L,yi(c)):m!=null&&n.removeAttribute("value"),E==null&&x!=null&&(n.defaultChecked=!!x),E!=null&&(n.checked=E&&typeof E!="function"&&typeof E!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?n.name=""+yi(I):n.removeAttribute("name")}function lm(n,o,c,m,E,x,L,I){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){Vu(n);return}c=c!=null?""+yi(c):"",o=o!=null?""+yi(o):c,I||o===n.value||(n.value=o),n.defaultValue=o}m=m??E,m=typeof m!="function"&&typeof m!="symbol"&&!!m,n.checked=I?n.checked:!!m,n.defaultChecked=!!m,L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(n.name=L),Vu(n)}function qu(n,o,c){o==="number"&&xo(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function er(n,o,c,m){if(n=n.options,o){o={};for(var E=0;E<c.length;E++)o["$"+c[E]]=!0;for(c=0;c<n.length;c++)E=o.hasOwnProperty("$"+n[c].value),n[c].selected!==E&&(n[c].selected=E),E&&m&&(n[c].defaultSelected=!0)}else{for(c=""+yi(c),o=null,E=0;E<n.length;E++){if(n[E].value===c){n[E].selected=!0,m&&(n[E].defaultSelected=!0);return}o!==null||n[E].disabled||(o=n[E])}o!==null&&(o.selected=!0)}}function um(n,o,c){if(o!=null&&(o=""+yi(o),o!==n.value&&(n.value=o),c==null)){n.defaultValue!==o&&(n.defaultValue=o);return}n.defaultValue=c!=null?""+yi(c):""}function cm(n,o,c,m){if(o==null){if(m!=null){if(c!=null)throw Error(i(92));if(Y(m)){if(1<m.length)throw Error(i(93));m=m[0]}c=m}c==null&&(c=""),o=c}c=yi(o),n.defaultValue=c,m=n.textContent,m===c&&m!==""&&m!==null&&(n.value=m),Vu(n)}function ir(n,o){if(o){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=o;return}}n.textContent=o}var CS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fm(n,o,c){var m=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?n.setProperty(o,""):o==="float"?n.cssFloat="":n[o]="":m?n.setProperty(o,c):typeof c!="number"||c===0||CS.has(o)?o==="float"?n.cssFloat=c:n[o]=(""+c).trim():n[o]=c+"px"}function dm(n,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(n=n.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||o!=null&&o.hasOwnProperty(m)||(m.indexOf("--")===0?n.setProperty(m,""):m==="float"?n.cssFloat="":n[m]="");for(var E in o)m=o[E],o.hasOwnProperty(E)&&c[E]!==m&&fm(n,E,m)}else for(var x in o)o.hasOwnProperty(x)&&fm(n,x,o[x])}function Yu(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),DS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function So(n){return DS.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function cn(){}var Xu=null;function Wu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var nr=null,sr=null;function hm(n){var o=Zs(n);if(o&&(n=o.stateNode)){var c=n[Ye]||null;t:switch(n=o.stateNode,o.type){case"input":if(Ku(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+vi(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==n&&m.form===n.form){var E=m[Ye]||null;if(!E)throw Error(i(90));Ku(m,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(o=0;o<c.length;o++)m=c[o],m.form===n.form&&om(m)}break t;case"textarea":um(n,c.value,c.defaultValue);break t;case"select":o=c.value,o!=null&&er(n,!!c.multiple,o,!1)}}}var Qu=!1;function mm(n,o,c){if(Qu)return n(o,c);Qu=!0;try{var m=n(o);return m}finally{if(Qu=!1,(nr!==null||sr!==null)&&(ll(),nr&&(o=nr,n=sr,sr=nr=null,hm(o),n)))for(o=0;o<n.length;o++)hm(n[o])}}function sa(n,o){var c=n.stateNode;if(c===null)return null;var m=c[Ye]||null;if(m===null)return null;c=m[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break t;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zu=!1;if(fn)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){Zu=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{Zu=!1}var Bn=null,Ju=null,To=null;function pm(){if(To)return To;var n,o=Ju,c=o.length,m,E="value"in Bn?Bn.value:Bn.textContent,x=E.length;for(n=0;n<c&&o[n]===E[n];n++);var L=c-n;for(m=1;m<=L&&o[c-m]===E[x-m];m++);return To=E.slice(n,1<m?1-m:void 0)}function bo(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Ao(){return!0}function gm(){return!1}function Xe(n){function o(c,m,E,x,L){this._reactName=c,this._targetInst=E,this.type=m,this.nativeEvent=x,this.target=L,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(c=n[I],this[I]=c?c(x):x[I]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ao:gm,this.isPropagationStopped=gm,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ao)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ao)},persist:function(){},isPersistent:Ao}),o}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=Xe(xs),aa=p({},xs,{view:0,detail:0}),IS=Xe(aa),tc,ec,oa,Lo=p({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==oa&&(oa&&n.type==="mousemove"?(tc=n.screenX-oa.screenX,ec=n.screenY-oa.screenY):ec=tc=0,oa=n),tc)},movementY:function(n){return"movementY"in n?n.movementY:ec}}),ym=Xe(Lo),OS=p({},Lo,{dataTransfer:0}),kS=Xe(OS),MS=p({},aa,{relatedTarget:0}),ic=Xe(MS),PS=p({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),NS=Xe(PS),FS=p({},xs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),BS=Xe(FS),US=p({},xs,{data:0}),vm=Xe(US),$S={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HS(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=GS[n])?!!o[n]:!1}function nc(){return HS}var zS=p({},aa,{key:function(n){if(n.key){var o=$S[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=bo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?jS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nc,charCode:function(n){return n.type==="keypress"?bo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?bo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),VS=Xe(zS),KS=p({},Lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Em=Xe(KS),qS=p({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nc}),YS=Xe(qS),XS=p({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),WS=Xe(XS),QS=p({},Lo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ZS=Xe(QS),JS=p({},xs,{newState:0,oldState:0}),tT=Xe(JS),eT=[9,13,27,32],sc=fn&&"CompositionEvent"in window,la=null;fn&&"documentMode"in document&&(la=document.documentMode);var iT=fn&&"TextEvent"in window&&!la,xm=fn&&(!sc||la&&8<la&&11>=la),Sm=" ",Tm=!1;function bm(n,o){switch(n){case"keyup":return eT.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Am(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var rr=!1;function nT(n,o){switch(n){case"compositionend":return Am(o);case"keypress":return o.which!==32?null:(Tm=!0,Sm);case"textInput":return n=o.data,n===Sm&&Tm?null:n;default:return null}}function sT(n,o){if(rr)return n==="compositionend"||!sc&&bm(n,o)?(n=pm(),To=Ju=Bn=null,rr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return xm&&o.locale!=="ko"?null:o.data;default:return null}}var rT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rm(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!rT[n.type]:o==="textarea"}function Lm(n,o,c,m){nr?sr?sr.push(m):sr=[m]:nr=m,o=pl(o,"onChange"),0<o.length&&(c=new Ro("onChange","change",null,c,m),n.push({event:c,listeners:o}))}var ua=null,ca=null;function aT(n){l0(n,0)}function _o(n){var o=na(n);if(om(o))return n}function _m(n,o){if(n==="change")return o}var Cm=!1;if(fn){var rc;if(fn){var ac="oninput"in document;if(!ac){var wm=document.createElement("div");wm.setAttribute("oninput","return;"),ac=typeof wm.oninput=="function"}rc=ac}else rc=!1;Cm=rc&&(!document.documentMode||9<document.documentMode)}function Dm(){ua&&(ua.detachEvent("onpropertychange",Im),ca=ua=null)}function Im(n){if(n.propertyName==="value"&&_o(ca)){var o=[];Lm(o,ca,n,Wu(n)),mm(aT,o)}}function oT(n,o,c){n==="focusin"?(Dm(),ua=o,ca=c,ua.attachEvent("onpropertychange",Im)):n==="focusout"&&Dm()}function lT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _o(ca)}function uT(n,o){if(n==="click")return _o(o)}function cT(n,o){if(n==="input"||n==="change")return _o(o)}function fT(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var ni=typeof Object.is=="function"?Object.is:fT;function fa(n,o){if(ni(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var c=Object.keys(n),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var E=c[m];if(!oe.call(o,E)||!ni(n[E],o[E]))return!1}return!0}function Om(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function km(n,o){var c=Om(n);n=0;for(var m;c;){if(c.nodeType===3){if(m=n+c.textContent.length,n<=o&&m>=o)return{node:c,offset:o-n};n=m}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Om(c)}}function Mm(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Mm(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Pm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var o=xo(n.document);o instanceof n.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)n=o.contentWindow;else break;o=xo(n.document)}return o}function oc(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}var dT=fn&&"documentMode"in document&&11>=document.documentMode,ar=null,lc=null,da=null,uc=!1;function Nm(n,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;uc||ar==null||ar!==xo(m)||(m=ar,"selectionStart"in m&&oc(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),da&&fa(da,m)||(da=m,m=pl(lc,"onSelect"),0<m.length&&(o=new Ro("onSelect","select",null,o,c),n.push({event:o,listeners:m}),o.target=ar)))}function Ss(n,o){var c={};return c[n.toLowerCase()]=o.toLowerCase(),c["Webkit"+n]="webkit"+o,c["Moz"+n]="moz"+o,c}var or={animationend:Ss("Animation","AnimationEnd"),animationiteration:Ss("Animation","AnimationIteration"),animationstart:Ss("Animation","AnimationStart"),transitionrun:Ss("Transition","TransitionRun"),transitionstart:Ss("Transition","TransitionStart"),transitioncancel:Ss("Transition","TransitionCancel"),transitionend:Ss("Transition","TransitionEnd")},cc={},Fm={};fn&&(Fm=document.createElement("div").style,"AnimationEvent"in window||(delete or.animationend.animation,delete or.animationiteration.animation,delete or.animationstart.animation),"TransitionEvent"in window||delete or.transitionend.transition);function Ts(n){if(cc[n])return cc[n];if(!or[n])return n;var o=or[n],c;for(c in o)if(o.hasOwnProperty(c)&&c in Fm)return cc[n]=o[c];return n}var Bm=Ts("animationend"),Um=Ts("animationiteration"),$m=Ts("animationstart"),hT=Ts("transitionrun"),mT=Ts("transitionstart"),pT=Ts("transitioncancel"),jm=Ts("transitionend"),Gm=new Map,fc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fc.push("scrollEnd");function Di(n,o){Gm.set(n,o),Es(o,[n])}var Co=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Ei=[],lr=0,dc=0;function wo(){for(var n=lr,o=dc=lr=0;o<n;){var c=Ei[o];Ei[o++]=null;var m=Ei[o];Ei[o++]=null;var E=Ei[o];Ei[o++]=null;var x=Ei[o];if(Ei[o++]=null,m!==null&&E!==null){var L=m.pending;L===null?E.next=E:(E.next=L.next,L.next=E),m.pending=E}x!==0&&Hm(c,E,x)}}function Do(n,o,c,m){Ei[lr++]=n,Ei[lr++]=o,Ei[lr++]=c,Ei[lr++]=m,dc|=m,n.lanes|=m,n=n.alternate,n!==null&&(n.lanes|=m)}function hc(n,o,c,m){return Do(n,o,c,m),Io(n)}function bs(n,o){return Do(n,null,null,o),Io(n)}function Hm(n,o,c){n.lanes|=c;var m=n.alternate;m!==null&&(m.lanes|=c);for(var E=!1,x=n.return;x!==null;)x.childLanes|=c,m=x.alternate,m!==null&&(m.childLanes|=c),x.tag===22&&(n=x.stateNode,n===null||n._visibility&1||(E=!0)),n=x,x=x.return;return n.tag===3?(x=n.stateNode,E&&o!==null&&(E=31-He(c),n=x.hiddenUpdates,m=n[E],m===null?n[E]=[o]:m.push(o),o.lane=c|536870912),x):null}function Io(n){if(50<Ma)throw Ma=0,bf=null,Error(i(185));for(var o=n.return;o!==null;)n=o,o=n.return;return n.tag===3?n.stateNode:null}var ur={};function gT(n,o,c,m){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(n,o,c,m){return new gT(n,o,c,m)}function mc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function dn(n,o){var c=n.alternate;return c===null?(c=si(n.tag,o,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=o,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,o=n.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function zm(n,o){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,o=c.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),n}function Oo(n,o,c,m,E,x){var L=0;if(m=n,typeof n=="function")mc(n)&&(L=1);else if(typeof n=="string")L=Sb(n,c,ct.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case B:return n=si(31,c,o,E),n.elementType=B,n.lanes=x,n;case S:return As(c.children,E,x,o);case T:L=8,E|=24;break;case A:return n=si(12,c,o,E|2),n.elementType=A,n.lanes=x,n;case D:return n=si(13,c,o,E),n.elementType=D,n.lanes=x,n;case N:return n=si(19,c,o,E),n.elementType=N,n.lanes=x,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case R:L=10;break t;case b:L=9;break t;case C:L=11;break t;case w:L=14;break t;case P:L=16,m=null;break t}L=29,c=Error(i(130,n===null?"null":typeof n,"")),m=null}return o=si(L,c,o,E),o.elementType=n,o.type=m,o.lanes=x,o}function As(n,o,c,m){return n=si(7,n,m,o),n.lanes=c,n}function pc(n,o,c){return n=si(6,n,null,o),n.lanes=c,n}function Vm(n){var o=si(18,null,null,0);return o.stateNode=n,o}function gc(n,o,c){return o=si(4,n.children!==null?n.children:[],n.key,o),o.lanes=c,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}var Km=new WeakMap;function xi(n,o){if(typeof n=="object"&&n!==null){var c=Km.get(n);return c!==void 0?c:(o={value:n,source:o,stack:Se(o)},Km.set(n,o),o)}return{value:n,source:o,stack:Se(o)}}var cr=[],fr=0,ko=null,ha=0,Si=[],Ti=0,Un=null,Ui=1,$i="";function hn(n,o){cr[fr++]=ha,cr[fr++]=ko,ko=n,ha=o}function qm(n,o,c){Si[Ti++]=Ui,Si[Ti++]=$i,Si[Ti++]=Un,Un=n;var m=Ui;n=$i;var E=32-He(m)-1;m&=~(1<<E),c+=1;var x=32-He(o)+E;if(30<x){var L=E-E%5;x=(m&(1<<L)-1).toString(32),m>>=L,E-=L,Ui=1<<32-He(o)+E|c<<E|m,$i=x+n}else Ui=1<<x|c<<E|m,$i=n}function yc(n){n.return!==null&&(hn(n,1),qm(n,1,0))}function vc(n){for(;n===ko;)ko=cr[--fr],cr[fr]=null,ha=cr[--fr],cr[fr]=null;for(;n===Un;)Un=Si[--Ti],Si[Ti]=null,$i=Si[--Ti],Si[Ti]=null,Ui=Si[--Ti],Si[Ti]=null}function Ym(n,o){Si[Ti++]=Ui,Si[Ti++]=$i,Si[Ti++]=Un,Ui=o.id,$i=o.overflow,Un=n}var ke=null,Jt=null,Ft=!1,$n=null,bi=!1,Ec=Error(i(519));function jn(n){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ma(xi(o,n)),Ec}function Xm(n){var o=n.stateNode,c=n.type,m=n.memoizedProps;switch(o[Oe]=n,o[Ye]=m,c){case"dialog":Mt("cancel",o),Mt("close",o);break;case"iframe":case"object":case"embed":Mt("load",o);break;case"video":case"audio":for(c=0;c<Na.length;c++)Mt(Na[c],o);break;case"source":Mt("error",o);break;case"img":case"image":case"link":Mt("error",o),Mt("load",o);break;case"details":Mt("toggle",o);break;case"input":Mt("invalid",o),lm(o,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Mt("invalid",o);break;case"textarea":Mt("invalid",o),cm(o,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||m.suppressHydrationWarning===!0||d0(o.textContent,c)?(m.popover!=null&&(Mt("beforetoggle",o),Mt("toggle",o)),m.onScroll!=null&&Mt("scroll",o),m.onScrollEnd!=null&&Mt("scrollend",o),m.onClick!=null&&(o.onclick=cn),o=!0):o=!1,o||jn(n,!0)}function Wm(n){for(ke=n.return;ke;)switch(ke.tag){case 5:case 31:case 13:bi=!1;return;case 27:case 3:bi=!0;return;default:ke=ke.return}}function dr(n){if(n!==ke)return!1;if(!Ft)return Wm(n),Ft=!0,!1;var o=n.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||Bf(n.type,n.memoizedProps)),c=!c),c&&Jt&&jn(n),Wm(n),o===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Jt=S0(n)}else if(o===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Jt=S0(n)}else o===27?(o=Jt,es(n.type)?(n=Hf,Hf=null,Jt=n):Jt=o):Jt=ke?Ri(n.stateNode.nextSibling):null;return!0}function Rs(){Jt=ke=null,Ft=!1}function xc(){var n=$n;return n!==null&&(Je===null?Je=n:Je.push.apply(Je,n),$n=null),n}function ma(n){$n===null?$n=[n]:$n.push(n)}var Sc=k(null),Ls=null,mn=null;function Gn(n,o,c){st(Sc,o._currentValue),o._currentValue=c}function pn(n){n._currentValue=Sc.current,$(Sc)}function Tc(n,o,c){for(;n!==null;){var m=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),n===c)break;n=n.return}}function bc(n,o,c,m){var E=n.child;for(E!==null&&(E.return=n);E!==null;){var x=E.dependencies;if(x!==null){var L=E.child;x=x.firstContext;t:for(;x!==null;){var I=x;x=E;for(var U=0;U<o.length;U++)if(I.context===o[U]){x.lanes|=c,I=x.alternate,I!==null&&(I.lanes|=c),Tc(x.return,c,n),m||(L=null);break t}x=I.next}}else if(E.tag===18){if(L=E.return,L===null)throw Error(i(341));L.lanes|=c,x=L.alternate,x!==null&&(x.lanes|=c),Tc(L,c,n),L=null}else L=E.child;if(L!==null)L.return=E;else for(L=E;L!==null;){if(L===n){L=null;break}if(E=L.sibling,E!==null){E.return=L.return,L=E;break}L=L.return}E=L}}function hr(n,o,c,m){n=null;for(var E=o,x=!1;E!==null;){if(!x){if((E.flags&524288)!==0)x=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var L=E.alternate;if(L===null)throw Error(i(387));if(L=L.memoizedProps,L!==null){var I=E.type;ni(E.pendingProps.value,L.value)||(n!==null?n.push(I):n=[I])}}else if(E===Et.current){if(L=E.alternate,L===null)throw Error(i(387));L.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(n!==null?n.push(ja):n=[ja])}E=E.return}n!==null&&bc(o,n,c,m),o.flags|=262144}function Mo(n){for(n=n.firstContext;n!==null;){if(!ni(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function _s(n){Ls=n,mn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Me(n){return Qm(Ls,n)}function Po(n,o){return Ls===null&&_s(n),Qm(n,o)}function Qm(n,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},mn===null){if(n===null)throw Error(i(308));mn=o,n.dependencies={lanes:0,firstContext:o},n.flags|=524288}else mn=mn.next=o;return c}var yT=typeof AbortController<"u"?AbortController:function(){var n=[],o=this.signal={aborted:!1,addEventListener:function(c,m){n.push(m)}};this.abort=function(){o.aborted=!0,n.forEach(function(c){return c()})}},vT=r.unstable_scheduleCallback,ET=r.unstable_NormalPriority,ge={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ac(){return{controller:new yT,data:new Map,refCount:0}}function pa(n){n.refCount--,n.refCount===0&&vT(ET,function(){n.controller.abort()})}var ga=null,Rc=0,mr=0,pr=null;function xT(n,o){if(ga===null){var c=ga=[];Rc=0,mr=wf(),pr={status:"pending",value:void 0,then:function(m){c.push(m)}}}return Rc++,o.then(Zm,Zm),o}function Zm(){if(--Rc===0&&ga!==null){pr!==null&&(pr.status="fulfilled");var n=ga;ga=null,mr=0,pr=null;for(var o=0;o<n.length;o++)(0,n[o])()}}function ST(n,o){var c=[],m={status:"pending",value:null,reason:null,then:function(E){c.push(E)}};return n.then(function(){m.status="fulfilled",m.value=o;for(var E=0;E<c.length;E++)(0,c[E])(o)},function(E){for(m.status="rejected",m.reason=E,E=0;E<c.length;E++)(0,c[E])(void 0)}),m}var Jm=O.S;O.S=function(n,o){Ng=ie(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&xT(n,o),Jm!==null&&Jm(n,o)};var Cs=k(null);function Lc(){var n=Cs.current;return n!==null?n:Wt.pooledCache}function No(n,o){o===null?st(Cs,Cs.current):st(Cs,o.pool)}function tp(){var n=Lc();return n===null?null:{parent:ge._currentValue,pool:n}}var gr=Error(i(460)),_c=Error(i(474)),Fo=Error(i(542)),Bo={then:function(){}};function ep(n){return n=n.status,n==="fulfilled"||n==="rejected"}function ip(n,o,c){switch(c=n[c],c===void 0?n.push(o):c!==o&&(o.then(cn,cn),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,sp(n),n;default:if(typeof o.status=="string")o.then(cn,cn);else{if(n=Wt,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=o,n.status="pending",n.then(function(m){if(o.status==="pending"){var E=o;E.status="fulfilled",E.value=m}},function(m){if(o.status==="pending"){var E=o;E.status="rejected",E.reason=m}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,sp(n),n}throw Ds=o,gr}}function ws(n){try{var o=n._init;return o(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ds=c,gr):c}}var Ds=null;function np(){if(Ds===null)throw Error(i(459));var n=Ds;return Ds=null,n}function sp(n){if(n===gr||n===Fo)throw Error(i(483))}var yr=null,ya=0;function Uo(n){var o=ya;return ya+=1,yr===null&&(yr=[]),ip(yr,n,o)}function va(n,o){o=o.props.ref,n.ref=o!==void 0?o:null}function $o(n,o){throw o.$$typeof===g?Error(i(525)):(n=Object.prototype.toString.call(o),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n)))}function rp(n){function o(q,H){if(n){var Z=q.deletions;Z===null?(q.deletions=[H],q.flags|=16):Z.push(H)}}function c(q,H){if(!n)return null;for(;H!==null;)o(q,H),H=H.sibling;return null}function m(q){for(var H=new Map;q!==null;)q.key!==null?H.set(q.key,q):H.set(q.index,q),q=q.sibling;return H}function E(q,H){return q=dn(q,H),q.index=0,q.sibling=null,q}function x(q,H,Z){return q.index=Z,n?(Z=q.alternate,Z!==null?(Z=Z.index,Z<H?(q.flags|=67108866,H):Z):(q.flags|=67108866,H)):(q.flags|=1048576,H)}function L(q){return n&&q.alternate===null&&(q.flags|=67108866),q}function I(q,H,Z,ot){return H===null||H.tag!==6?(H=pc(Z,q.mode,ot),H.return=q,H):(H=E(H,Z),H.return=q,H)}function U(q,H,Z,ot){var xt=Z.type;return xt===S?rt(q,H,Z.props.children,ot,Z.key):H!==null&&(H.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===P&&ws(xt)===H.type)?(H=E(H,Z.props),va(H,Z),H.return=q,H):(H=Oo(Z.type,Z.key,Z.props,null,q.mode,ot),va(H,Z),H.return=q,H)}function J(q,H,Z,ot){return H===null||H.tag!==4||H.stateNode.containerInfo!==Z.containerInfo||H.stateNode.implementation!==Z.implementation?(H=gc(Z,q.mode,ot),H.return=q,H):(H=E(H,Z.children||[]),H.return=q,H)}function rt(q,H,Z,ot,xt){return H===null||H.tag!==7?(H=As(Z,q.mode,ot,xt),H.return=q,H):(H=E(H,Z),H.return=q,H)}function lt(q,H,Z){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=pc(""+H,q.mode,Z),H.return=q,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case y:return Z=Oo(H.type,H.key,H.props,null,q.mode,Z),va(Z,H),Z.return=q,Z;case v:return H=gc(H,q.mode,Z),H.return=q,H;case P:return H=ws(H),lt(q,H,Z)}if(Y(H)||tt(H))return H=As(H,q.mode,Z,null),H.return=q,H;if(typeof H.then=="function")return lt(q,Uo(H),Z);if(H.$$typeof===R)return lt(q,Po(q,H),Z);$o(q,H)}return null}function et(q,H,Z,ot){var xt=H!==null?H.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return xt!==null?null:I(q,H,""+Z,ot);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:return Z.key===xt?U(q,H,Z,ot):null;case v:return Z.key===xt?J(q,H,Z,ot):null;case P:return Z=ws(Z),et(q,H,Z,ot)}if(Y(Z)||tt(Z))return xt!==null?null:rt(q,H,Z,ot,null);if(typeof Z.then=="function")return et(q,H,Uo(Z),ot);if(Z.$$typeof===R)return et(q,H,Po(q,Z),ot);$o(q,Z)}return null}function it(q,H,Z,ot,xt){if(typeof ot=="string"&&ot!==""||typeof ot=="number"||typeof ot=="bigint")return q=q.get(Z)||null,I(H,q,""+ot,xt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case y:return q=q.get(ot.key===null?Z:ot.key)||null,U(H,q,ot,xt);case v:return q=q.get(ot.key===null?Z:ot.key)||null,J(H,q,ot,xt);case P:return ot=ws(ot),it(q,H,Z,ot,xt)}if(Y(ot)||tt(ot))return q=q.get(Z)||null,rt(H,q,ot,xt,null);if(typeof ot.then=="function")return it(q,H,Z,Uo(ot),xt);if(ot.$$typeof===R)return it(q,H,Z,Po(H,ot),xt);$o(H,ot)}return null}function gt(q,H,Z,ot){for(var xt=null,Ut=null,yt=H,wt=H=0,Nt=null;yt!==null&&wt<Z.length;wt++){yt.index>wt?(Nt=yt,yt=null):Nt=yt.sibling;var $t=et(q,yt,Z[wt],ot);if($t===null){yt===null&&(yt=Nt);break}n&&yt&&$t.alternate===null&&o(q,yt),H=x($t,H,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t,yt=Nt}if(wt===Z.length)return c(q,yt),Ft&&hn(q,wt),xt;if(yt===null){for(;wt<Z.length;wt++)yt=lt(q,Z[wt],ot),yt!==null&&(H=x(yt,H,wt),Ut===null?xt=yt:Ut.sibling=yt,Ut=yt);return Ft&&hn(q,wt),xt}for(yt=m(yt);wt<Z.length;wt++)Nt=it(yt,q,wt,Z[wt],ot),Nt!==null&&(n&&Nt.alternate!==null&&yt.delete(Nt.key===null?wt:Nt.key),H=x(Nt,H,wt),Ut===null?xt=Nt:Ut.sibling=Nt,Ut=Nt);return n&&yt.forEach(function(as){return o(q,as)}),Ft&&hn(q,wt),xt}function St(q,H,Z,ot){if(Z==null)throw Error(i(151));for(var xt=null,Ut=null,yt=H,wt=H=0,Nt=null,$t=Z.next();yt!==null&&!$t.done;wt++,$t=Z.next()){yt.index>wt?(Nt=yt,yt=null):Nt=yt.sibling;var as=et(q,yt,$t.value,ot);if(as===null){yt===null&&(yt=Nt);break}n&&yt&&as.alternate===null&&o(q,yt),H=x(as,H,wt),Ut===null?xt=as:Ut.sibling=as,Ut=as,yt=Nt}if($t.done)return c(q,yt),Ft&&hn(q,wt),xt;if(yt===null){for(;!$t.done;wt++,$t=Z.next())$t=lt(q,$t.value,ot),$t!==null&&(H=x($t,H,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t);return Ft&&hn(q,wt),xt}for(yt=m(yt);!$t.done;wt++,$t=Z.next())$t=it(yt,q,wt,$t.value,ot),$t!==null&&(n&&$t.alternate!==null&&yt.delete($t.key===null?wt:$t.key),H=x($t,H,wt),Ut===null?xt=$t:Ut.sibling=$t,Ut=$t);return n&&yt.forEach(function(Ob){return o(q,Ob)}),Ft&&hn(q,wt),xt}function Yt(q,H,Z,ot){if(typeof Z=="object"&&Z!==null&&Z.type===S&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:t:{for(var xt=Z.key;H!==null;){if(H.key===xt){if(xt=Z.type,xt===S){if(H.tag===7){c(q,H.sibling),ot=E(H,Z.props.children),ot.return=q,q=ot;break t}}else if(H.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===P&&ws(xt)===H.type){c(q,H.sibling),ot=E(H,Z.props),va(ot,Z),ot.return=q,q=ot;break t}c(q,H);break}else o(q,H);H=H.sibling}Z.type===S?(ot=As(Z.props.children,q.mode,ot,Z.key),ot.return=q,q=ot):(ot=Oo(Z.type,Z.key,Z.props,null,q.mode,ot),va(ot,Z),ot.return=q,q=ot)}return L(q);case v:t:{for(xt=Z.key;H!==null;){if(H.key===xt)if(H.tag===4&&H.stateNode.containerInfo===Z.containerInfo&&H.stateNode.implementation===Z.implementation){c(q,H.sibling),ot=E(H,Z.children||[]),ot.return=q,q=ot;break t}else{c(q,H);break}else o(q,H);H=H.sibling}ot=gc(Z,q.mode,ot),ot.return=q,q=ot}return L(q);case P:return Z=ws(Z),Yt(q,H,Z,ot)}if(Y(Z))return gt(q,H,Z,ot);if(tt(Z)){if(xt=tt(Z),typeof xt!="function")throw Error(i(150));return Z=xt.call(Z),St(q,H,Z,ot)}if(typeof Z.then=="function")return Yt(q,H,Uo(Z),ot);if(Z.$$typeof===R)return Yt(q,H,Po(q,Z),ot);$o(q,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,H!==null&&H.tag===6?(c(q,H.sibling),ot=E(H,Z),ot.return=q,q=ot):(c(q,H),ot=pc(Z,q.mode,ot),ot.return=q,q=ot),L(q)):c(q,H)}return function(q,H,Z,ot){try{ya=0;var xt=Yt(q,H,Z,ot);return yr=null,xt}catch(yt){if(yt===gr||yt===Fo)throw yt;var Ut=si(29,yt,null,q.mode);return Ut.lanes=ot,Ut.return=q,Ut}finally{}}}var Is=rp(!0),ap=rp(!1),Hn=!1;function Cc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wc(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function zn(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Vn(n,o,c){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,(jt&2)!==0){var E=m.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),m.pending=o,o=Io(n),Hm(n,null,c),o}return Do(n,m,o,c),Io(n)}function Ea(n,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var m=o.lanes;m&=n.pendingLanes,c|=m,o.lanes=c,Qh(n,c)}}function Dc(n,o){var c=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var E=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var L={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?E=x=L:x=x.next=L,c=c.next}while(c!==null);x===null?E=x=o:x=x.next=o}else E=x=o;c={baseState:m.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:m.shared,callbacks:m.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=o:n.next=o,c.lastBaseUpdate=o}var Ic=!1;function xa(){if(Ic){var n=pr;if(n!==null)throw n}}function Sa(n,o,c,m){Ic=!1;var E=n.updateQueue;Hn=!1;var x=E.firstBaseUpdate,L=E.lastBaseUpdate,I=E.shared.pending;if(I!==null){E.shared.pending=null;var U=I,J=U.next;U.next=null,L===null?x=J:L.next=J,L=U;var rt=n.alternate;rt!==null&&(rt=rt.updateQueue,I=rt.lastBaseUpdate,I!==L&&(I===null?rt.firstBaseUpdate=J:I.next=J,rt.lastBaseUpdate=U))}if(x!==null){var lt=E.baseState;L=0,rt=J=U=null,I=x;do{var et=I.lane&-536870913,it=et!==I.lane;if(it?(Pt&et)===et:(m&et)===et){et!==0&&et===mr&&(Ic=!0),rt!==null&&(rt=rt.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});t:{var gt=n,St=I;et=o;var Yt=c;switch(St.tag){case 1:if(gt=St.payload,typeof gt=="function"){lt=gt.call(Yt,lt,et);break t}lt=gt;break t;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=St.payload,et=typeof gt=="function"?gt.call(Yt,lt,et):gt,et==null)break t;lt=p({},lt,et);break t;case 2:Hn=!0}}et=I.callback,et!==null&&(n.flags|=64,it&&(n.flags|=8192),it=E.callbacks,it===null?E.callbacks=[et]:it.push(et))}else it={lane:et,tag:I.tag,payload:I.payload,callback:I.callback,next:null},rt===null?(J=rt=it,U=lt):rt=rt.next=it,L|=et;if(I=I.next,I===null){if(I=E.shared.pending,I===null)break;it=I,I=it.next,it.next=null,E.lastBaseUpdate=it,E.shared.pending=null}}while(!0);rt===null&&(U=lt),E.baseState=U,E.firstBaseUpdate=J,E.lastBaseUpdate=rt,x===null&&(E.shared.lanes=0),Wn|=L,n.lanes=L,n.memoizedState=lt}}function op(n,o){if(typeof n!="function")throw Error(i(191,n));n.call(o)}function lp(n,o){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)op(c[n],o)}var vr=k(null),jo=k(0);function up(n,o){n=An,st(jo,n),st(vr,o),An=n|o.baseLanes}function Oc(){st(jo,An),st(vr,vr.current)}function kc(){An=jo.current,$(vr),$(jo)}var ri=k(null),Ai=null;function Kn(n){var o=n.alternate;st(me,me.current&1),st(ri,n),Ai===null&&(o===null||vr.current!==null||o.memoizedState!==null)&&(Ai=n)}function Mc(n){st(me,me.current),st(ri,n),Ai===null&&(Ai=n)}function cp(n){n.tag===22?(st(me,me.current),st(ri,n),Ai===null&&(Ai=n)):qn()}function qn(){st(me,me.current),st(ri,ri.current)}function ai(n){$(ri),Ai===n&&(Ai=null),$(me)}var me=k(0);function Go(n){for(var o=n;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||jf(c)||Gf(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var gn=0,Ct=null,Kt=null,ye=null,Ho=!1,Er=!1,Os=!1,zo=0,Ta=0,xr=null,TT=0;function ue(){throw Error(i(321))}function Pc(n,o){if(o===null)return!1;for(var c=0;c<o.length&&c<n.length;c++)if(!ni(n[c],o[c]))return!1;return!0}function Nc(n,o,c,m,E,x){return gn=x,Ct=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,O.H=n===null||n.memoizedState===null?qp:Qc,Os=!1,x=c(m,E),Os=!1,Er&&(x=dp(o,c,m,E)),fp(n),x}function fp(n){O.H=Ra;var o=Kt!==null&&Kt.next!==null;if(gn=0,ye=Kt=Ct=null,Ho=!1,Ta=0,xr=null,o)throw Error(i(300));n===null||ve||(n=n.dependencies,n!==null&&Mo(n)&&(ve=!0))}function dp(n,o,c,m){Ct=n;var E=0;do{if(Er&&(xr=null),Ta=0,Er=!1,25<=E)throw Error(i(301));if(E+=1,ye=Kt=null,n.updateQueue!=null){var x=n.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}O.H=Yp,x=o(c,m)}while(Er);return x}function bT(){var n=O.H,o=n.useState()[0];return o=typeof o.then=="function"?ba(o):o,n=n.useState()[0],(Kt!==null?Kt.memoizedState:null)!==n&&(Ct.flags|=1024),o}function Fc(){var n=zo!==0;return zo=0,n}function Bc(n,o,c){o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~c}function Uc(n){if(Ho){for(n=n.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}Ho=!1}gn=0,ye=Kt=Ct=null,Er=!1,Ta=zo=0,xr=null}function ze(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ye===null?Ct.memoizedState=ye=n:ye=ye.next=n,ye}function pe(){if(Kt===null){var n=Ct.alternate;n=n!==null?n.memoizedState:null}else n=Kt.next;var o=ye===null?Ct.memoizedState:ye.next;if(o!==null)ye=o,Kt=n;else{if(n===null)throw Ct.alternate===null?Error(i(467)):Error(i(310));Kt=n,n={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},ye===null?Ct.memoizedState=ye=n:ye=ye.next=n}return ye}function Vo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ba(n){var o=Ta;return Ta+=1,xr===null&&(xr=[]),n=ip(xr,n,o),o=Ct,(ye===null?o.memoizedState:ye.next)===null&&(o=o.alternate,O.H=o===null||o.memoizedState===null?qp:Qc),n}function Ko(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ba(n);if(n.$$typeof===R)return Me(n)}throw Error(i(438,String(n)))}function $c(n){var o=null,c=Ct.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var m=Ct.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(o={data:m.data.map(function(E){return E.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Vo(),Ct.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(n),m=0;m<n;m++)c[m]=M;return o.index++,c}function yn(n,o){return typeof o=="function"?o(n):o}function qo(n){var o=pe();return jc(o,Kt,n)}function jc(n,o,c){var m=n.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=c;var E=n.baseQueue,x=m.pending;if(x!==null){if(E!==null){var L=E.next;E.next=x.next,x.next=L}o.baseQueue=E=x,m.pending=null}if(x=n.baseState,E===null)n.memoizedState=x;else{o=E.next;var I=L=null,U=null,J=o,rt=!1;do{var lt=J.lane&-536870913;if(lt!==J.lane?(Pt&lt)===lt:(gn&lt)===lt){var et=J.revertLane;if(et===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),lt===mr&&(rt=!0);else if((gn&et)===et){J=J.next,et===mr&&(rt=!0);continue}else lt={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=lt,L=x):U=U.next=lt,Ct.lanes|=et,Wn|=et;lt=J.action,Os&&c(x,lt),x=J.hasEagerState?J.eagerState:c(x,lt)}else et={lane:lt,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=et,L=x):U=U.next=et,Ct.lanes|=lt,Wn|=lt;J=J.next}while(J!==null&&J!==o);if(U===null?L=x:U.next=I,!ni(x,n.memoizedState)&&(ve=!0,rt&&(c=pr,c!==null)))throw c;n.memoizedState=x,n.baseState=L,n.baseQueue=U,m.lastRenderedState=x}return E===null&&(m.lanes=0),[n.memoizedState,m.dispatch]}function Gc(n){var o=pe(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=n;var m=c.dispatch,E=c.pending,x=o.memoizedState;if(E!==null){c.pending=null;var L=E=E.next;do x=n(x,L.action),L=L.next;while(L!==E);ni(x,o.memoizedState)||(ve=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,m]}function hp(n,o,c){var m=Ct,E=pe(),x=Ft;if(x){if(c===void 0)throw Error(i(407));c=c()}else c=o();var L=!ni((Kt||E).memoizedState,c);if(L&&(E.memoizedState=c,ve=!0),E=E.queue,Vc(gp.bind(null,m,E,n),[n]),E.getSnapshot!==o||L||ye!==null&&ye.memoizedState.tag&1){if(m.flags|=2048,Sr(9,{destroy:void 0},pp.bind(null,m,E,c,o),null),Wt===null)throw Error(i(349));x||(gn&127)!==0||mp(m,o,c)}return c}function mp(n,o,c){n.flags|=16384,n={getSnapshot:o,value:c},o=Ct.updateQueue,o===null?(o=Vo(),Ct.updateQueue=o,o.stores=[n]):(c=o.stores,c===null?o.stores=[n]:c.push(n))}function pp(n,o,c,m){o.value=c,o.getSnapshot=m,yp(o)&&vp(n)}function gp(n,o,c){return c(function(){yp(o)&&vp(n)})}function yp(n){var o=n.getSnapshot;n=n.value;try{var c=o();return!ni(n,c)}catch{return!0}}function vp(n){var o=bs(n,2);o!==null&&ti(o,n,2)}function Hc(n){var o=ze();if(typeof n=="function"){var c=n;if(n=c(),Os){Bi(!0);try{c()}finally{Bi(!1)}}}return o.memoizedState=o.baseState=n,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:n},o}function Ep(n,o,c,m){return n.baseState=c,jc(n,Kt,typeof m=="function"?m:yn)}function AT(n,o,c,m,E){if(Wo(n))throw Error(i(485));if(n=o.action,n!==null){var x={payload:E,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(L){x.listeners.push(L)}};O.T!==null?c(!0):x.isTransition=!1,m(x),c=o.pending,c===null?(x.next=o.pending=x,xp(o,x)):(x.next=c.next,o.pending=c.next=x)}}function xp(n,o){var c=o.action,m=o.payload,E=n.state;if(o.isTransition){var x=O.T,L={};O.T=L;try{var I=c(E,m),U=O.S;U!==null&&U(L,I),Sp(n,o,I)}catch(J){zc(n,o,J)}finally{x!==null&&L.types!==null&&(x.types=L.types),O.T=x}}else try{x=c(E,m),Sp(n,o,x)}catch(J){zc(n,o,J)}}function Sp(n,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Tp(n,o,m)},function(m){return zc(n,o,m)}):Tp(n,o,c)}function Tp(n,o,c){o.status="fulfilled",o.value=c,bp(o),n.state=c,o=n.pending,o!==null&&(c=o.next,c===o?n.pending=null:(c=c.next,o.next=c,xp(n,c)))}function zc(n,o,c){var m=n.pending;if(n.pending=null,m!==null){m=m.next;do o.status="rejected",o.reason=c,bp(o),o=o.next;while(o!==m)}n.action=null}function bp(n){n=n.listeners;for(var o=0;o<n.length;o++)(0,n[o])()}function Ap(n,o){return o}function Rp(n,o){if(Ft){var c=Wt.formState;if(c!==null){t:{var m=Ct;if(Ft){if(Jt){e:{for(var E=Jt,x=bi;E.nodeType!==8;){if(!x){E=null;break e}if(E=Ri(E.nextSibling),E===null){E=null;break e}}x=E.data,E=x==="F!"||x==="F"?E:null}if(E){Jt=Ri(E.nextSibling),m=E.data==="F!";break t}}jn(m)}m=!1}m&&(o=c[0])}}return c=ze(),c.memoizedState=c.baseState=o,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ap,lastRenderedState:o},c.queue=m,c=zp.bind(null,Ct,m),m.dispatch=c,m=Hc(!1),x=Wc.bind(null,Ct,!1,m.queue),m=ze(),E={state:o,dispatch:null,action:n,pending:null},m.queue=E,c=AT.bind(null,Ct,E,x,c),E.dispatch=c,m.memoizedState=n,[o,c,!1]}function Lp(n){var o=pe();return _p(o,Kt,n)}function _p(n,o,c){if(o=jc(n,o,Ap)[0],n=qo(yn)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var m=ba(o)}catch(L){throw L===gr?Fo:L}else m=o;o=pe();var E=o.queue,x=E.dispatch;return c!==o.memoizedState&&(Ct.flags|=2048,Sr(9,{destroy:void 0},RT.bind(null,E,c),null)),[m,x,n]}function RT(n,o){n.action=o}function Cp(n){var o=pe(),c=Kt;if(c!==null)return _p(o,c,n);pe(),o=o.memoizedState,c=pe();var m=c.queue.dispatch;return c.memoizedState=n,[o,m,!1]}function Sr(n,o,c,m){return n={tag:n,create:c,deps:m,inst:o,next:null},o=Ct.updateQueue,o===null&&(o=Vo(),Ct.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=n.next=n:(m=c.next,c.next=n,n.next=m,o.lastEffect=n),n}function wp(){return pe().memoizedState}function Yo(n,o,c,m){var E=ze();Ct.flags|=n,E.memoizedState=Sr(1|o,{destroy:void 0},c,m===void 0?null:m)}function Xo(n,o,c,m){var E=pe();m=m===void 0?null:m;var x=E.memoizedState.inst;Kt!==null&&m!==null&&Pc(m,Kt.memoizedState.deps)?E.memoizedState=Sr(o,x,c,m):(Ct.flags|=n,E.memoizedState=Sr(1|o,x,c,m))}function Dp(n,o){Yo(8390656,8,n,o)}function Vc(n,o){Xo(2048,8,n,o)}function LT(n){Ct.flags|=4;var o=Ct.updateQueue;if(o===null)o=Vo(),Ct.updateQueue=o,o.events=[n];else{var c=o.events;c===null?o.events=[n]:c.push(n)}}function Ip(n){var o=pe().memoizedState;return LT({ref:o,nextImpl:n}),function(){if((jt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function Op(n,o){return Xo(4,2,n,o)}function kp(n,o){return Xo(4,4,n,o)}function Mp(n,o){if(typeof o=="function"){n=n();var c=o(n);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function Pp(n,o,c){c=c!=null?c.concat([n]):null,Xo(4,4,Mp.bind(null,o,n),c)}function Kc(){}function Np(n,o){var c=pe();o=o===void 0?null:o;var m=c.memoizedState;return o!==null&&Pc(o,m[1])?m[0]:(c.memoizedState=[n,o],n)}function Fp(n,o){var c=pe();o=o===void 0?null:o;var m=c.memoizedState;if(o!==null&&Pc(o,m[1]))return m[0];if(m=n(),Os){Bi(!0);try{n()}finally{Bi(!1)}}return c.memoizedState=[m,o],m}function qc(n,o,c){return c===void 0||(gn&1073741824)!==0&&(Pt&261930)===0?n.memoizedState=o:(n.memoizedState=c,n=Bg(),Ct.lanes|=n,Wn|=n,c)}function Bp(n,o,c,m){return ni(c,o)?c:vr.current!==null?(n=qc(n,c,m),ni(n,o)||(ve=!0),n):(gn&42)===0||(gn&1073741824)!==0&&(Pt&261930)===0?(ve=!0,n.memoizedState=c):(n=Bg(),Ct.lanes|=n,Wn|=n,o)}function Up(n,o,c,m,E){var x=j.p;j.p=x!==0&&8>x?x:8;var L=O.T,I={};O.T=I,Wc(n,!1,o,c);try{var U=E(),J=O.S;if(J!==null&&J(I,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var rt=ST(U,m);Aa(n,o,rt,ui(n))}else Aa(n,o,m,ui(n))}catch(lt){Aa(n,o,{then:function(){},status:"rejected",reason:lt},ui())}finally{j.p=x,L!==null&&I.types!==null&&(L.types=I.types),O.T=L}}function _T(){}function Yc(n,o,c,m){if(n.tag!==5)throw Error(i(476));var E=$p(n).queue;Up(n,E,o,V,c===null?_T:function(){return jp(n),c(m)})}function $p(n){var o=n.memoizedState;if(o!==null)return o;o={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:V},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:c},next:null},n.memoizedState=o,n=n.alternate,n!==null&&(n.memoizedState=o),o}function jp(n){var o=$p(n);o.next===null&&(o=n.alternate.memoizedState),Aa(n,o.next.queue,{},ui())}function Xc(){return Me(ja)}function Gp(){return pe().memoizedState}function Hp(){return pe().memoizedState}function CT(n){for(var o=n.return;o!==null;){switch(o.tag){case 24:case 3:var c=ui();n=zn(c);var m=Vn(o,n,c);m!==null&&(ti(m,o,c),Ea(m,o,c)),o={cache:Ac()},n.payload=o;return}o=o.return}}function wT(n,o,c){var m=ui();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Wo(n)?Vp(o,c):(c=hc(n,o,c,m),c!==null&&(ti(c,n,m),Kp(c,o,m)))}function zp(n,o,c){var m=ui();Aa(n,o,c,m)}function Aa(n,o,c,m){var E={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Wo(n))Vp(o,E);else{var x=n.alternate;if(n.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var L=o.lastRenderedState,I=x(L,c);if(E.hasEagerState=!0,E.eagerState=I,ni(I,L))return Do(n,o,E,0),Wt===null&&wo(),!1}catch{}finally{}if(c=hc(n,o,E,m),c!==null)return ti(c,n,m),Kp(c,o,m),!0}return!1}function Wc(n,o,c,m){if(m={lane:2,revertLane:wf(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Wo(n)){if(o)throw Error(i(479))}else o=hc(n,c,m,2),o!==null&&ti(o,n,2)}function Wo(n){var o=n.alternate;return n===Ct||o!==null&&o===Ct}function Vp(n,o){Er=Ho=!0;var c=n.pending;c===null?o.next=o:(o.next=c.next,c.next=o),n.pending=o}function Kp(n,o,c){if((c&4194048)!==0){var m=o.lanes;m&=n.pendingLanes,c|=m,o.lanes=c,Qh(n,c)}}var Ra={readContext:Me,use:Ko,useCallback:ue,useContext:ue,useEffect:ue,useImperativeHandle:ue,useLayoutEffect:ue,useInsertionEffect:ue,useMemo:ue,useReducer:ue,useRef:ue,useState:ue,useDebugValue:ue,useDeferredValue:ue,useTransition:ue,useSyncExternalStore:ue,useId:ue,useHostTransitionStatus:ue,useFormState:ue,useActionState:ue,useOptimistic:ue,useMemoCache:ue,useCacheRefresh:ue};Ra.useEffectEvent=ue;var qp={readContext:Me,use:Ko,useCallback:function(n,o){return ze().memoizedState=[n,o===void 0?null:o],n},useContext:Me,useEffect:Dp,useImperativeHandle:function(n,o,c){c=c!=null?c.concat([n]):null,Yo(4194308,4,Mp.bind(null,o,n),c)},useLayoutEffect:function(n,o){return Yo(4194308,4,n,o)},useInsertionEffect:function(n,o){Yo(4,2,n,o)},useMemo:function(n,o){var c=ze();o=o===void 0?null:o;var m=n();if(Os){Bi(!0);try{n()}finally{Bi(!1)}}return c.memoizedState=[m,o],m},useReducer:function(n,o,c){var m=ze();if(c!==void 0){var E=c(o);if(Os){Bi(!0);try{c(o)}finally{Bi(!1)}}}else E=o;return m.memoizedState=m.baseState=E,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:E},m.queue=n,n=n.dispatch=wT.bind(null,Ct,n),[m.memoizedState,n]},useRef:function(n){var o=ze();return n={current:n},o.memoizedState=n},useState:function(n){n=Hc(n);var o=n.queue,c=zp.bind(null,Ct,o);return o.dispatch=c,[n.memoizedState,c]},useDebugValue:Kc,useDeferredValue:function(n,o){var c=ze();return qc(c,n,o)},useTransition:function(){var n=Hc(!1);return n=Up.bind(null,Ct,n.queue,!0,!1),ze().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,o,c){var m=Ct,E=ze();if(Ft){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),Wt===null)throw Error(i(349));(Pt&127)!==0||mp(m,o,c)}E.memoizedState=c;var x={value:c,getSnapshot:o};return E.queue=x,Dp(gp.bind(null,m,x,n),[n]),m.flags|=2048,Sr(9,{destroy:void 0},pp.bind(null,m,x,c,o),null),c},useId:function(){var n=ze(),o=Wt.identifierPrefix;if(Ft){var c=$i,m=Ui;c=(m&~(1<<32-He(m)-1)).toString(32)+c,o="_"+o+"R_"+c,c=zo++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=TT++,o="_"+o+"r_"+c.toString(32)+"_";return n.memoizedState=o},useHostTransitionStatus:Xc,useFormState:Rp,useActionState:Rp,useOptimistic:function(n){var o=ze();o.memoizedState=o.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Wc.bind(null,Ct,!0,c),c.dispatch=o,[n,o]},useMemoCache:$c,useCacheRefresh:function(){return ze().memoizedState=CT.bind(null,Ct)},useEffectEvent:function(n){var o=ze(),c={impl:n};return o.memoizedState=c,function(){if((jt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Qc={readContext:Me,use:Ko,useCallback:Np,useContext:Me,useEffect:Vc,useImperativeHandle:Pp,useInsertionEffect:Op,useLayoutEffect:kp,useMemo:Fp,useReducer:qo,useRef:wp,useState:function(){return qo(yn)},useDebugValue:Kc,useDeferredValue:function(n,o){var c=pe();return Bp(c,Kt.memoizedState,n,o)},useTransition:function(){var n=qo(yn)[0],o=pe().memoizedState;return[typeof n=="boolean"?n:ba(n),o]},useSyncExternalStore:hp,useId:Gp,useHostTransitionStatus:Xc,useFormState:Lp,useActionState:Lp,useOptimistic:function(n,o){var c=pe();return Ep(c,Kt,n,o)},useMemoCache:$c,useCacheRefresh:Hp};Qc.useEffectEvent=Ip;var Yp={readContext:Me,use:Ko,useCallback:Np,useContext:Me,useEffect:Vc,useImperativeHandle:Pp,useInsertionEffect:Op,useLayoutEffect:kp,useMemo:Fp,useReducer:Gc,useRef:wp,useState:function(){return Gc(yn)},useDebugValue:Kc,useDeferredValue:function(n,o){var c=pe();return Kt===null?qc(c,n,o):Bp(c,Kt.memoizedState,n,o)},useTransition:function(){var n=Gc(yn)[0],o=pe().memoizedState;return[typeof n=="boolean"?n:ba(n),o]},useSyncExternalStore:hp,useId:Gp,useHostTransitionStatus:Xc,useFormState:Cp,useActionState:Cp,useOptimistic:function(n,o){var c=pe();return Kt!==null?Ep(c,Kt,n,o):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:$c,useCacheRefresh:Hp};Yp.useEffectEvent=Ip;function Zc(n,o,c,m){o=n.memoizedState,c=c(m,o),c=c==null?o:p({},o,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var Jc={enqueueSetState:function(n,o,c){n=n._reactInternals;var m=ui(),E=zn(m);E.payload=o,c!=null&&(E.callback=c),o=Vn(n,E,m),o!==null&&(ti(o,n,m),Ea(o,n,m))},enqueueReplaceState:function(n,o,c){n=n._reactInternals;var m=ui(),E=zn(m);E.tag=1,E.payload=o,c!=null&&(E.callback=c),o=Vn(n,E,m),o!==null&&(ti(o,n,m),Ea(o,n,m))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var c=ui(),m=zn(c);m.tag=2,o!=null&&(m.callback=o),o=Vn(n,m,c),o!==null&&(ti(o,n,c),Ea(o,n,c))}};function Xp(n,o,c,m,E,x,L){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,x,L):o.prototype&&o.prototype.isPureReactComponent?!fa(c,m)||!fa(E,x):!0}function Wp(n,o,c,m){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==n&&Jc.enqueueReplaceState(o,o.state,null)}function ks(n,o){var c=o;if("ref"in o){c={};for(var m in o)m!=="ref"&&(c[m]=o[m])}if(n=n.defaultProps){c===o&&(c=p({},c));for(var E in n)c[E]===void 0&&(c[E]=n[E])}return c}function Qp(n){Co(n)}function Zp(n){console.error(n)}function Jp(n){Co(n)}function Qo(n,o){try{var c=n.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(m){setTimeout(function(){throw m})}}function tg(n,o,c){try{var m=n.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function tf(n,o,c){return c=zn(c),c.tag=3,c.payload={element:null},c.callback=function(){Qo(n,o)},c}function eg(n){return n=zn(n),n.tag=3,n}function ig(n,o,c,m){var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var x=m.value;n.payload=function(){return E(x)},n.callback=function(){tg(o,c,m)}}var L=c.stateNode;L!==null&&typeof L.componentDidCatch=="function"&&(n.callback=function(){tg(o,c,m),typeof E!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var I=m.stack;this.componentDidCatch(m.value,{componentStack:I!==null?I:""})})}function DT(n,o,c,m,E){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(o=c.alternate,o!==null&&hr(o,c,E,!0),c=ri.current,c!==null){switch(c.tag){case 31:case 13:return Ai===null?ul():c.alternate===null&&ce===0&&(ce=3),c.flags&=-257,c.flags|=65536,c.lanes=E,m===Bo?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([m]):o.add(m),Lf(n,m,E)),!1;case 22:return c.flags|=65536,m===Bo?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([m]):c.add(m)),Lf(n,m,E)),!1}throw Error(i(435,c.tag))}return Lf(n,m,E),ul(),!1}if(Ft)return o=ri.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=E,m!==Ec&&(n=Error(i(422),{cause:m}),ma(xi(n,c)))):(m!==Ec&&(o=Error(i(423),{cause:m}),ma(xi(o,c))),n=n.current.alternate,n.flags|=65536,E&=-E,n.lanes|=E,m=xi(m,c),E=tf(n.stateNode,m,E),Dc(n,E),ce!==4&&(ce=2)),!1;var x=Error(i(520),{cause:m});if(x=xi(x,c),ka===null?ka=[x]:ka.push(x),ce!==4&&(ce=2),o===null)return!0;m=xi(m,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,n=E&-E,c.lanes|=n,n=tf(c.stateNode,m,n),Dc(c,n),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Qn===null||!Qn.has(x))))return c.flags|=65536,E&=-E,c.lanes|=E,E=eg(E),ig(E,n,c,m),Dc(c,E),!1}c=c.return}while(c!==null);return!1}var ef=Error(i(461)),ve=!1;function Pe(n,o,c,m){o.child=n===null?ap(o,null,c,m):Is(o,n.child,c,m)}function ng(n,o,c,m,E){c=c.render;var x=o.ref;if("ref"in m){var L={};for(var I in m)I!=="ref"&&(L[I]=m[I])}else L=m;return _s(o),m=Nc(n,o,c,L,x,E),I=Fc(),n!==null&&!ve?(Bc(n,o,E),vn(n,o,E)):(Ft&&I&&yc(o),o.flags|=1,Pe(n,o,m,E),o.child)}function sg(n,o,c,m,E){if(n===null){var x=c.type;return typeof x=="function"&&!mc(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,rg(n,o,x,m,E)):(n=Oo(c.type,null,m,o,o.mode,E),n.ref=o.ref,n.return=o,o.child=n)}if(x=n.child,!cf(n,E)){var L=x.memoizedProps;if(c=c.compare,c=c!==null?c:fa,c(L,m)&&n.ref===o.ref)return vn(n,o,E)}return o.flags|=1,n=dn(x,m),n.ref=o.ref,n.return=o,o.child=n}function rg(n,o,c,m,E){if(n!==null){var x=n.memoizedProps;if(fa(x,m)&&n.ref===o.ref)if(ve=!1,o.pendingProps=m=x,cf(n,E))(n.flags&131072)!==0&&(ve=!0);else return o.lanes=n.lanes,vn(n,o,E)}return nf(n,o,c,m,E)}function ag(n,o,c,m){var E=m.children,x=n!==null?n.memoizedState:null;if(n===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,n!==null){for(m=o.child=n.child,E=0;m!==null;)E=E|m.lanes|m.childLanes,m=m.sibling;m=E&~x}else m=0,o.child=null;return og(n,o,x,c,m)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},n!==null&&No(o,x!==null?x.cachePool:null),x!==null?up(o,x):Oc(),cp(o);else return m=o.lanes=536870912,og(n,o,x!==null?x.baseLanes|c:c,c,m)}else x!==null?(No(o,x.cachePool),up(o,x),qn(),o.memoizedState=null):(n!==null&&No(o,null),Oc(),qn());return Pe(n,o,E,c),o.child}function La(n,o){return n!==null&&n.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function og(n,o,c,m,E){var x=Lc();return x=x===null?null:{parent:ge._currentValue,pool:x},o.memoizedState={baseLanes:c,cachePool:x},n!==null&&No(o,null),Oc(),cp(o),n!==null&&hr(n,o,m,!0),o.childLanes=E,null}function Zo(n,o){return o=tl({mode:o.mode,children:o.children},n.mode),o.ref=n.ref,n.child=o,o.return=n,o}function lg(n,o,c){return Is(o,n.child,null,c),n=Zo(o,o.pendingProps),n.flags|=2,ai(o),o.memoizedState=null,n}function IT(n,o,c){var m=o.pendingProps,E=(o.flags&128)!==0;if(o.flags&=-129,n===null){if(Ft){if(m.mode==="hidden")return n=Zo(o,m),o.lanes=536870912,La(null,n);if(Mc(o),(n=Jt)?(n=x0(n,bi),n=n!==null&&n.data==="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:Un!==null?{id:Ui,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},c=Vm(n),c.return=o,o.child=c,ke=o,Jt=null)):n=null,n===null)throw jn(o);return o.lanes=536870912,null}return Zo(o,m)}var x=n.memoizedState;if(x!==null){var L=x.dehydrated;if(Mc(o),E)if(o.flags&256)o.flags&=-257,o=lg(n,o,c);else if(o.memoizedState!==null)o.child=n.child,o.flags|=128,o=null;else throw Error(i(558));else if(ve||hr(n,o,c,!1),E=(c&n.childLanes)!==0,ve||E){if(m=Wt,m!==null&&(L=Zh(m,c),L!==0&&L!==x.retryLane))throw x.retryLane=L,bs(n,L),ti(m,n,L),ef;ul(),o=lg(n,o,c)}else n=x.treeContext,Jt=Ri(L.nextSibling),ke=o,Ft=!0,$n=null,bi=!1,n!==null&&Ym(o,n),o=Zo(o,m),o.flags|=4096;return o}return n=dn(n.child,{mode:m.mode,children:m.children}),n.ref=o.ref,o.child=n,n.return=o,n}function Jo(n,o){var c=o.ref;if(c===null)n!==null&&n.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(n===null||n.ref!==c)&&(o.flags|=4194816)}}function nf(n,o,c,m,E){return _s(o),c=Nc(n,o,c,m,void 0,E),m=Fc(),n!==null&&!ve?(Bc(n,o,E),vn(n,o,E)):(Ft&&m&&yc(o),o.flags|=1,Pe(n,o,c,E),o.child)}function ug(n,o,c,m,E,x){return _s(o),o.updateQueue=null,c=dp(o,m,c,E),fp(n),m=Fc(),n!==null&&!ve?(Bc(n,o,x),vn(n,o,x)):(Ft&&m&&yc(o),o.flags|=1,Pe(n,o,c,x),o.child)}function cg(n,o,c,m,E){if(_s(o),o.stateNode===null){var x=ur,L=c.contextType;typeof L=="object"&&L!==null&&(x=Me(L)),x=new c(m,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Jc,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=m,x.state=o.memoizedState,x.refs={},Cc(o),L=c.contextType,x.context=typeof L=="object"&&L!==null?Me(L):ur,x.state=o.memoizedState,L=c.getDerivedStateFromProps,typeof L=="function"&&(Zc(o,c,L,m),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(L=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),L!==x.state&&Jc.enqueueReplaceState(x,x.state,null),Sa(o,m,x,E),xa(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),m=!0}else if(n===null){x=o.stateNode;var I=o.memoizedProps,U=ks(c,I);x.props=U;var J=x.context,rt=c.contextType;L=ur,typeof rt=="object"&&rt!==null&&(L=Me(rt));var lt=c.getDerivedStateFromProps;rt=typeof lt=="function"||typeof x.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,rt||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(I||J!==L)&&Wp(o,x,m,L),Hn=!1;var et=o.memoizedState;x.state=et,Sa(o,m,x,E),xa(),J=o.memoizedState,I||et!==J||Hn?(typeof lt=="function"&&(Zc(o,c,lt,m),J=o.memoizedState),(U=Hn||Xp(o,c,U,m,et,J,L))?(rt||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=J),x.props=m,x.state=J,x.context=L,m=U):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{x=o.stateNode,wc(n,o),L=o.memoizedProps,rt=ks(c,L),x.props=rt,lt=o.pendingProps,et=x.context,J=c.contextType,U=ur,typeof J=="object"&&J!==null&&(U=Me(J)),I=c.getDerivedStateFromProps,(J=typeof I=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(L!==lt||et!==U)&&Wp(o,x,m,U),Hn=!1,et=o.memoizedState,x.state=et,Sa(o,m,x,E),xa();var it=o.memoizedState;L!==lt||et!==it||Hn||n!==null&&n.dependencies!==null&&Mo(n.dependencies)?(typeof I=="function"&&(Zc(o,c,I,m),it=o.memoizedState),(rt=Hn||Xp(o,c,rt,m,et,it,U)||n!==null&&n.dependencies!==null&&Mo(n.dependencies))?(J||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(m,it,U),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(m,it,U)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=it),x.props=m,x.state=it,x.context=U,m=rt):(typeof x.componentDidUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||L===n.memoizedProps&&et===n.memoizedState||(o.flags|=1024),m=!1)}return x=m,Jo(n,o),m=(o.flags&128)!==0,x||m?(x=o.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,n!==null&&m?(o.child=Is(o,n.child,null,E),o.child=Is(o,null,c,E)):Pe(n,o,c,E),o.memoizedState=x.state,n=o.child):n=vn(n,o,E),n}function fg(n,o,c,m){return Rs(),o.flags|=256,Pe(n,o,c,m),o.child}var sf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function rf(n){return{baseLanes:n,cachePool:tp()}}function af(n,o,c){return n=n!==null?n.childLanes&~c:0,o&&(n|=li),n}function dg(n,o,c){var m=o.pendingProps,E=!1,x=(o.flags&128)!==0,L;if((L=x)||(L=n!==null&&n.memoizedState===null?!1:(me.current&2)!==0),L&&(E=!0,o.flags&=-129),L=(o.flags&32)!==0,o.flags&=-33,n===null){if(Ft){if(E?Kn(o):qn(),(n=Jt)?(n=x0(n,bi),n=n!==null&&n.data!=="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:Un!==null?{id:Ui,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},c=Vm(n),c.return=o,o.child=c,ke=o,Jt=null)):n=null,n===null)throw jn(o);return Gf(n)?o.lanes=32:o.lanes=536870912,null}var I=m.children;return m=m.fallback,E?(qn(),E=o.mode,I=tl({mode:"hidden",children:I},E),m=As(m,E,c,null),I.return=o,m.return=o,I.sibling=m,o.child=I,m=o.child,m.memoizedState=rf(c),m.childLanes=af(n,L,c),o.memoizedState=sf,La(null,m)):(Kn(o),of(o,I))}var U=n.memoizedState;if(U!==null&&(I=U.dehydrated,I!==null)){if(x)o.flags&256?(Kn(o),o.flags&=-257,o=lf(n,o,c)):o.memoizedState!==null?(qn(),o.child=n.child,o.flags|=128,o=null):(qn(),I=m.fallback,E=o.mode,m=tl({mode:"visible",children:m.children},E),I=As(I,E,c,null),I.flags|=2,m.return=o,I.return=o,m.sibling=I,o.child=m,Is(o,n.child,null,c),m=o.child,m.memoizedState=rf(c),m.childLanes=af(n,L,c),o.memoizedState=sf,o=La(null,m));else if(Kn(o),Gf(I)){if(L=I.nextSibling&&I.nextSibling.dataset,L)var J=L.dgst;L=J,m=Error(i(419)),m.stack="",m.digest=L,ma({value:m,source:null,stack:null}),o=lf(n,o,c)}else if(ve||hr(n,o,c,!1),L=(c&n.childLanes)!==0,ve||L){if(L=Wt,L!==null&&(m=Zh(L,c),m!==0&&m!==U.retryLane))throw U.retryLane=m,bs(n,m),ti(L,n,m),ef;jf(I)||ul(),o=lf(n,o,c)}else jf(I)?(o.flags|=192,o.child=n.child,o=null):(n=U.treeContext,Jt=Ri(I.nextSibling),ke=o,Ft=!0,$n=null,bi=!1,n!==null&&Ym(o,n),o=of(o,m.children),o.flags|=4096);return o}return E?(qn(),I=m.fallback,E=o.mode,U=n.child,J=U.sibling,m=dn(U,{mode:"hidden",children:m.children}),m.subtreeFlags=U.subtreeFlags&65011712,J!==null?I=dn(J,I):(I=As(I,E,c,null),I.flags|=2),I.return=o,m.return=o,m.sibling=I,o.child=m,La(null,m),m=o.child,I=n.child.memoizedState,I===null?I=rf(c):(E=I.cachePool,E!==null?(U=ge._currentValue,E=E.parent!==U?{parent:U,pool:U}:E):E=tp(),I={baseLanes:I.baseLanes|c,cachePool:E}),m.memoizedState=I,m.childLanes=af(n,L,c),o.memoizedState=sf,La(n.child,m)):(Kn(o),c=n.child,n=c.sibling,c=dn(c,{mode:"visible",children:m.children}),c.return=o,c.sibling=null,n!==null&&(L=o.deletions,L===null?(o.deletions=[n],o.flags|=16):L.push(n)),o.child=c,o.memoizedState=null,c)}function of(n,o){return o=tl({mode:"visible",children:o},n.mode),o.return=n,n.child=o}function tl(n,o){return n=si(22,n,null,o),n.lanes=0,n}function lf(n,o,c){return Is(o,n.child,null,c),n=of(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function hg(n,o,c){n.lanes|=o;var m=n.alternate;m!==null&&(m.lanes|=o),Tc(n.return,o,c)}function uf(n,o,c,m,E,x){var L=n.memoizedState;L===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:E,treeForkCount:x}:(L.isBackwards=o,L.rendering=null,L.renderingStartTime=0,L.last=m,L.tail=c,L.tailMode=E,L.treeForkCount=x)}function mg(n,o,c){var m=o.pendingProps,E=m.revealOrder,x=m.tail;m=m.children;var L=me.current,I=(L&2)!==0;if(I?(L=L&1|2,o.flags|=128):L&=1,st(me,L),Pe(n,o,m,c),m=Ft?ha:0,!I&&n!==null&&(n.flags&128)!==0)t:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&hg(n,c,o);else if(n.tag===19)hg(n,c,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break t;for(;n.sibling===null;){if(n.return===null||n.return===o)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(E){case"forwards":for(c=o.child,E=null;c!==null;)n=c.alternate,n!==null&&Go(n)===null&&(E=c),c=c.sibling;c=E,c===null?(E=o.child,o.child=null):(E=c.sibling,c.sibling=null),uf(o,!1,E,c,x,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,E=o.child,o.child=null;E!==null;){if(n=E.alternate,n!==null&&Go(n)===null){o.child=E;break}n=E.sibling,E.sibling=c,c=E,E=n}uf(o,!0,c,null,x,m);break;case"together":uf(o,!1,null,null,void 0,m);break;default:o.memoizedState=null}return o.child}function vn(n,o,c){if(n!==null&&(o.dependencies=n.dependencies),Wn|=o.lanes,(c&o.childLanes)===0)if(n!==null){if(hr(n,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(n!==null&&o.child!==n.child)throw Error(i(153));if(o.child!==null){for(n=o.child,c=dn(n,n.pendingProps),o.child=c,c.return=o;n.sibling!==null;)n=n.sibling,c=c.sibling=dn(n,n.pendingProps),c.return=o;c.sibling=null}return o.child}function cf(n,o){return(n.lanes&o)!==0?!0:(n=n.dependencies,!!(n!==null&&Mo(n)))}function OT(n,o,c){switch(o.tag){case 3:Lt(o,o.stateNode.containerInfo),Gn(o,ge,n.memoizedState.cache),Rs();break;case 27:case 5:ee(o);break;case 4:Lt(o,o.stateNode.containerInfo);break;case 10:Gn(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Mc(o),null;break;case 13:var m=o.memoizedState;if(m!==null)return m.dehydrated!==null?(Kn(o),o.flags|=128,null):(c&o.child.childLanes)!==0?dg(n,o,c):(Kn(o),n=vn(n,o,c),n!==null?n.sibling:null);Kn(o);break;case 19:var E=(n.flags&128)!==0;if(m=(c&o.childLanes)!==0,m||(hr(n,o,c,!1),m=(c&o.childLanes)!==0),E){if(m)return mg(n,o,c);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),st(me,me.current),m)break;return null;case 22:return o.lanes=0,ag(n,o,c,o.pendingProps);case 24:Gn(o,ge,n.memoizedState.cache)}return vn(n,o,c)}function pg(n,o,c){if(n!==null)if(n.memoizedProps!==o.pendingProps)ve=!0;else{if(!cf(n,c)&&(o.flags&128)===0)return ve=!1,OT(n,o,c);ve=(n.flags&131072)!==0}else ve=!1,Ft&&(o.flags&1048576)!==0&&qm(o,ha,o.index);switch(o.lanes=0,o.tag){case 16:t:{var m=o.pendingProps;if(n=ws(o.elementType),o.type=n,typeof n=="function")mc(n)?(m=ks(n,m),o.tag=1,o=cg(null,o,n,m,c)):(o.tag=0,o=nf(null,o,n,m,c));else{if(n!=null){var E=n.$$typeof;if(E===C){o.tag=11,o=ng(null,o,n,m,c);break t}else if(E===w){o.tag=14,o=sg(null,o,n,m,c);break t}}throw o=G(n)||n,Error(i(306,o,""))}}return o;case 0:return nf(n,o,o.type,o.pendingProps,c);case 1:return m=o.type,E=ks(m,o.pendingProps),cg(n,o,m,E,c);case 3:t:{if(Lt(o,o.stateNode.containerInfo),n===null)throw Error(i(387));m=o.pendingProps;var x=o.memoizedState;E=x.element,wc(n,o),Sa(o,m,null,c);var L=o.memoizedState;if(m=L.cache,Gn(o,ge,m),m!==x.cache&&bc(o,[ge],c,!0),xa(),m=L.element,x.isDehydrated)if(x={element:m,isDehydrated:!1,cache:L.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=fg(n,o,m,c);break t}else if(m!==E){E=xi(Error(i(424)),o),ma(E),o=fg(n,o,m,c);break t}else{switch(n=o.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Jt=Ri(n.firstChild),ke=o,Ft=!0,$n=null,bi=!0,c=ap(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Rs(),m===E){o=vn(n,o,c);break t}Pe(n,o,m,c)}o=o.child}return o;case 26:return Jo(n,o),n===null?(c=L0(o.type,null,o.pendingProps,null))?o.memoizedState=c:Ft||(c=o.type,n=o.pendingProps,m=gl(dt.current).createElement(c),m[Oe]=o,m[Ye]=n,Ne(m,c,n),_e(m),o.stateNode=m):o.memoizedState=L0(o.type,n.memoizedProps,o.pendingProps,n.memoizedState),null;case 27:return ee(o),n===null&&Ft&&(m=o.stateNode=b0(o.type,o.pendingProps,dt.current),ke=o,bi=!0,E=Jt,es(o.type)?(Hf=E,Jt=Ri(m.firstChild)):Jt=E),Pe(n,o,o.pendingProps.children,c),Jo(n,o),n===null&&(o.flags|=4194304),o.child;case 5:return n===null&&Ft&&((E=m=Jt)&&(m=lb(m,o.type,o.pendingProps,bi),m!==null?(o.stateNode=m,ke=o,Jt=Ri(m.firstChild),bi=!1,E=!0):E=!1),E||jn(o)),ee(o),E=o.type,x=o.pendingProps,L=n!==null?n.memoizedProps:null,m=x.children,Bf(E,x)?m=null:L!==null&&Bf(E,L)&&(o.flags|=32),o.memoizedState!==null&&(E=Nc(n,o,bT,null,null,c),ja._currentValue=E),Jo(n,o),Pe(n,o,m,c),o.child;case 6:return n===null&&Ft&&((n=c=Jt)&&(c=ub(c,o.pendingProps,bi),c!==null?(o.stateNode=c,ke=o,Jt=null,n=!0):n=!1),n||jn(o)),null;case 13:return dg(n,o,c);case 4:return Lt(o,o.stateNode.containerInfo),m=o.pendingProps,n===null?o.child=Is(o,null,m,c):Pe(n,o,m,c),o.child;case 11:return ng(n,o,o.type,o.pendingProps,c);case 7:return Pe(n,o,o.pendingProps,c),o.child;case 8:return Pe(n,o,o.pendingProps.children,c),o.child;case 12:return Pe(n,o,o.pendingProps.children,c),o.child;case 10:return m=o.pendingProps,Gn(o,o.type,m.value),Pe(n,o,m.children,c),o.child;case 9:return E=o.type._context,m=o.pendingProps.children,_s(o),E=Me(E),m=m(E),o.flags|=1,Pe(n,o,m,c),o.child;case 14:return sg(n,o,o.type,o.pendingProps,c);case 15:return rg(n,o,o.type,o.pendingProps,c);case 19:return mg(n,o,c);case 31:return IT(n,o,c);case 22:return ag(n,o,c,o.pendingProps);case 24:return _s(o),m=Me(ge),n===null?(E=Lc(),E===null&&(E=Wt,x=Ac(),E.pooledCache=x,x.refCount++,x!==null&&(E.pooledCacheLanes|=c),E=x),o.memoizedState={parent:m,cache:E},Cc(o),Gn(o,ge,E)):((n.lanes&c)!==0&&(wc(n,o),Sa(o,null,null,c),xa()),E=n.memoizedState,x=o.memoizedState,E.parent!==m?(E={parent:m,cache:m},o.memoizedState=E,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=E),Gn(o,ge,m)):(m=x.cache,Gn(o,ge,m),m!==E.cache&&bc(o,[ge],c,!0))),Pe(n,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function En(n){n.flags|=4}function ff(n,o,c,m,E){if((o=(n.mode&32)!==0)&&(o=!1),o){if(n.flags|=16777216,(E&335544128)===E)if(n.stateNode.complete)n.flags|=8192;else if(Gg())n.flags|=8192;else throw Ds=Bo,_c}else n.flags&=-16777217}function gg(n,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!I0(o))if(Gg())n.flags|=8192;else throw Ds=Bo,_c}function el(n,o){o!==null&&(n.flags|=4),n.flags&16384&&(o=n.tag!==22?Xh():536870912,n.lanes|=o,Rr|=o)}function _a(n,o){if(!Ft)switch(n.tailMode){case"hidden":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function te(n){var o=n.alternate!==null&&n.alternate.child===n.child,c=0,m=0;if(o)for(var E=n.child;E!==null;)c|=E.lanes|E.childLanes,m|=E.subtreeFlags&65011712,m|=E.flags&65011712,E.return=n,E=E.sibling;else for(E=n.child;E!==null;)c|=E.lanes|E.childLanes,m|=E.subtreeFlags,m|=E.flags,E.return=n,E=E.sibling;return n.subtreeFlags|=m,n.childLanes=c,o}function kT(n,o,c){var m=o.pendingProps;switch(vc(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return te(o),null;case 1:return te(o),null;case 3:return c=o.stateNode,m=null,n!==null&&(m=n.memoizedState.cache),o.memoizedState.cache!==m&&(o.flags|=2048),pn(ge),_t(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(dr(o)?En(o):n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xc())),te(o),null;case 26:var E=o.type,x=o.memoizedState;return n===null?(En(o),x!==null?(te(o),gg(o,x)):(te(o),ff(o,E,null,m,c))):x?x!==n.memoizedState?(En(o),te(o),gg(o,x)):(te(o),o.flags&=-16777217):(n=n.memoizedProps,n!==m&&En(o),te(o),ff(o,E,n,m,c)),null;case 27:if(he(o),c=dt.current,E=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==m&&En(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return te(o),null}n=ct.current,dr(o)?Xm(o):(n=b0(E,m,c),o.stateNode=n,En(o))}return te(o),null;case 5:if(he(o),E=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==m&&En(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return te(o),null}if(x=ct.current,dr(o))Xm(o);else{var L=gl(dt.current);switch(x){case 1:x=L.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:x=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":x=L.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":x=L.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":x=L.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof m.is=="string"?L.createElement("select",{is:m.is}):L.createElement("select"),m.multiple?x.multiple=!0:m.size&&(x.size=m.size);break;default:x=typeof m.is=="string"?L.createElement(E,{is:m.is}):L.createElement(E)}}x[Oe]=o,x[Ye]=m;t:for(L=o.child;L!==null;){if(L.tag===5||L.tag===6)x.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===o)break t;for(;L.sibling===null;){if(L.return===null||L.return===o)break t;L=L.return}L.sibling.return=L.return,L=L.sibling}o.stateNode=x;t:switch(Ne(x,E,m),E){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break t;case"img":m=!0;break t;default:m=!1}m&&En(o)}}return te(o),ff(o,o.type,n===null?null:n.memoizedProps,o.pendingProps,c),null;case 6:if(n&&o.stateNode!=null)n.memoizedProps!==m&&En(o);else{if(typeof m!="string"&&o.stateNode===null)throw Error(i(166));if(n=dt.current,dr(o)){if(n=o.stateNode,c=o.memoizedProps,m=null,E=ke,E!==null)switch(E.tag){case 27:case 5:m=E.memoizedProps}n[Oe]=o,n=!!(n.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||d0(n.nodeValue,c)),n||jn(o,!0)}else n=gl(n).createTextNode(m),n[Oe]=o,o.stateNode=n}return te(o),null;case 31:if(c=o.memoizedState,n===null||n.memoizedState!==null){if(m=dr(o),c!==null){if(n===null){if(!m)throw Error(i(318));if(n=o.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Oe]=o}else Rs(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;te(o),n=!1}else c=xc(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return o.flags&256?(ai(o),o):(ai(o),null);if((o.flags&128)!==0)throw Error(i(558))}return te(o),null;case 13:if(m=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(E=dr(o),m!==null&&m.dehydrated!==null){if(n===null){if(!E)throw Error(i(318));if(E=o.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(i(317));E[Oe]=o}else Rs(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;te(o),E=!1}else E=xc(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=E),E=!0;if(!E)return o.flags&256?(ai(o),o):(ai(o),null)}return ai(o),(o.flags&128)!==0?(o.lanes=c,o):(c=m!==null,n=n!==null&&n.memoizedState!==null,c&&(m=o.child,E=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(E=m.alternate.memoizedState.cachePool.pool),x=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(x=m.memoizedState.cachePool.pool),x!==E&&(m.flags|=2048)),c!==n&&c&&(o.child.flags|=8192),el(o,o.updateQueue),te(o),null);case 4:return _t(),n===null&&kf(o.stateNode.containerInfo),te(o),null;case 10:return pn(o.type),te(o),null;case 19:if($(me),m=o.memoizedState,m===null)return te(o),null;if(E=(o.flags&128)!==0,x=m.rendering,x===null)if(E)_a(m,!1);else{if(ce!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if(x=Go(n),x!==null){for(o.flags|=128,_a(m,!1),n=x.updateQueue,o.updateQueue=n,el(o,n),o.subtreeFlags=0,n=c,c=o.child;c!==null;)zm(c,n),c=c.sibling;return st(me,me.current&1|2),Ft&&hn(o,m.treeForkCount),o.child}n=n.sibling}m.tail!==null&&ie()>al&&(o.flags|=128,E=!0,_a(m,!1),o.lanes=4194304)}else{if(!E)if(n=Go(x),n!==null){if(o.flags|=128,E=!0,n=n.updateQueue,o.updateQueue=n,el(o,n),_a(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!Ft)return te(o),null}else 2*ie()-m.renderingStartTime>al&&c!==536870912&&(o.flags|=128,E=!0,_a(m,!1),o.lanes=4194304);m.isBackwards?(x.sibling=o.child,o.child=x):(n=m.last,n!==null?n.sibling=x:o.child=x,m.last=x)}return m.tail!==null?(n=m.tail,m.rendering=n,m.tail=n.sibling,m.renderingStartTime=ie(),n.sibling=null,c=me.current,st(me,E?c&1|2:c&1),Ft&&hn(o,m.treeForkCount),n):(te(o),null);case 22:case 23:return ai(o),kc(),m=o.memoizedState!==null,n!==null?n.memoizedState!==null!==m&&(o.flags|=8192):m&&(o.flags|=8192),m?(c&536870912)!==0&&(o.flags&128)===0&&(te(o),o.subtreeFlags&6&&(o.flags|=8192)):te(o),c=o.updateQueue,c!==null&&el(o,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==c&&(o.flags|=2048),n!==null&&$(Cs),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),pn(ge),te(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function MT(n,o){switch(vc(o),o.tag){case 1:return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return pn(ge),_t(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 26:case 27:case 5:return he(o),null;case 31:if(o.memoizedState!==null){if(ai(o),o.alternate===null)throw Error(i(340));Rs()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 13:if(ai(o),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Rs()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return $(me),null;case 4:return _t(),null;case 10:return pn(o.type),null;case 22:case 23:return ai(o),kc(),n!==null&&$(Cs),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 24:return pn(ge),null;case 25:return null;default:return null}}function yg(n,o){switch(vc(o),o.tag){case 3:pn(ge),_t();break;case 26:case 27:case 5:he(o);break;case 4:_t();break;case 31:o.memoizedState!==null&&ai(o);break;case 13:ai(o);break;case 19:$(me);break;case 10:pn(o.type);break;case 22:case 23:ai(o),kc(),n!==null&&$(Cs);break;case 24:pn(ge)}}function Ca(n,o){try{var c=o.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var E=m.next;c=E;do{if((c.tag&n)===n){m=void 0;var x=c.create,L=c.inst;m=x(),L.destroy=m}c=c.next}while(c!==E)}}catch(I){Ht(o,o.return,I)}}function Yn(n,o,c){try{var m=o.updateQueue,E=m!==null?m.lastEffect:null;if(E!==null){var x=E.next;m=x;do{if((m.tag&n)===n){var L=m.inst,I=L.destroy;if(I!==void 0){L.destroy=void 0,E=o;var U=c,J=I;try{J()}catch(rt){Ht(E,U,rt)}}}m=m.next}while(m!==x)}}catch(rt){Ht(o,o.return,rt)}}function vg(n){var o=n.updateQueue;if(o!==null){var c=n.stateNode;try{lp(o,c)}catch(m){Ht(n,n.return,m)}}}function Eg(n,o,c){c.props=ks(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(m){Ht(n,o,m)}}function wa(n,o){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var m=n.stateNode;break;case 30:m=n.stateNode;break;default:m=n.stateNode}typeof c=="function"?n.refCleanup=c(m):c.current=m}}catch(E){Ht(n,o,E)}}function ji(n,o){var c=n.ref,m=n.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(E){Ht(n,o,E)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(E){Ht(n,o,E)}else c.current=null}function xg(n){var o=n.type,c=n.memoizedProps,m=n.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break t;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(E){Ht(n,n.return,E)}}function df(n,o,c){try{var m=n.stateNode;ib(m,n.type,c,o),m[Ye]=o}catch(E){Ht(n,n.return,E)}}function Sg(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&es(n.type)||n.tag===4}function hf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Sg(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&es(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function mf(n,o,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(n),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=cn));else if(m!==4&&(m===27&&es(n.type)&&(c=n.stateNode,o=null),n=n.child,n!==null))for(mf(n,o,c),n=n.sibling;n!==null;)mf(n,o,c),n=n.sibling}function il(n,o,c){var m=n.tag;if(m===5||m===6)n=n.stateNode,o?c.insertBefore(n,o):c.appendChild(n);else if(m!==4&&(m===27&&es(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(il(n,o,c),n=n.sibling;n!==null;)il(n,o,c),n=n.sibling}function Tg(n){var o=n.stateNode,c=n.memoizedProps;try{for(var m=n.type,E=o.attributes;E.length;)o.removeAttributeNode(E[0]);Ne(o,m,c),o[Oe]=n,o[Ye]=c}catch(x){Ht(n,n.return,x)}}var xn=!1,Ee=!1,pf=!1,bg=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function PT(n,o){if(n=n.containerInfo,Nf=bl,n=Pm(n),oc(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else t:{c=(c=n.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var E=m.anchorOffset,x=m.focusNode;m=m.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break t}var L=0,I=-1,U=-1,J=0,rt=0,lt=n,et=null;e:for(;;){for(var it;lt!==c||E!==0&&lt.nodeType!==3||(I=L+E),lt!==x||m!==0&&lt.nodeType!==3||(U=L+m),lt.nodeType===3&&(L+=lt.nodeValue.length),(it=lt.firstChild)!==null;)et=lt,lt=it;for(;;){if(lt===n)break e;if(et===c&&++J===E&&(I=L),et===x&&++rt===m&&(U=L),(it=lt.nextSibling)!==null)break;lt=et,et=lt.parentNode}lt=it}c=I===-1||U===-1?null:{start:I,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ff={focusedElem:n,selectionRange:c},bl=!1,Ce=o;Ce!==null;)if(o=Ce,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,Ce=n;else for(;Ce!==null;){switch(o=Ce,x=o.alternate,n=o.flags,o.tag){case 0:if((n&4)!==0&&(n=o.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)E=n[c],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&x!==null){n=void 0,c=o,E=x.memoizedProps,x=x.memoizedState,m=c.stateNode;try{var gt=ks(c.type,E);n=m.getSnapshotBeforeUpdate(gt,x),m.__reactInternalSnapshotBeforeUpdate=n}catch(St){Ht(c,c.return,St)}}break;case 3:if((n&1024)!==0){if(n=o.stateNode.containerInfo,c=n.nodeType,c===9)$f(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":$f(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=o.sibling,n!==null){n.return=o.return,Ce=n;break}Ce=o.return}}function Ag(n,o,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:Tn(n,c),m&4&&Ca(5,c);break;case 1:if(Tn(n,c),m&4)if(n=c.stateNode,o===null)try{n.componentDidMount()}catch(L){Ht(c,c.return,L)}else{var E=ks(c.type,o.memoizedProps);o=o.memoizedState;try{n.componentDidUpdate(E,o,n.__reactInternalSnapshotBeforeUpdate)}catch(L){Ht(c,c.return,L)}}m&64&&vg(c),m&512&&wa(c,c.return);break;case 3:if(Tn(n,c),m&64&&(n=c.updateQueue,n!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{lp(n,o)}catch(L){Ht(c,c.return,L)}}break;case 27:o===null&&m&4&&Tg(c);case 26:case 5:Tn(n,c),o===null&&m&4&&xg(c),m&512&&wa(c,c.return);break;case 12:Tn(n,c);break;case 31:Tn(n,c),m&4&&_g(n,c);break;case 13:Tn(n,c),m&4&&Cg(n,c),m&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=zT.bind(null,c),cb(n,c))));break;case 22:if(m=c.memoizedState!==null||xn,!m){o=o!==null&&o.memoizedState!==null||Ee,E=xn;var x=Ee;xn=m,(Ee=o)&&!x?bn(n,c,(c.subtreeFlags&8772)!==0):Tn(n,c),xn=E,Ee=x}break;case 30:break;default:Tn(n,c)}}function Rg(n){var o=n.alternate;o!==null&&(n.alternate=null,Rg(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&zu(o)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ne=null,We=!1;function Sn(n,o,c){for(c=c.child;c!==null;)Lg(n,o,c),c=c.sibling}function Lg(n,o,c){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(ys,c)}catch{}switch(c.tag){case 26:Ee||ji(c,o),Sn(n,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ee||ji(c,o);var m=ne,E=We;es(c.type)&&(ne=c.stateNode,We=!1),Sn(n,o,c),Ba(c.stateNode),ne=m,We=E;break;case 5:Ee||ji(c,o);case 6:if(m=ne,E=We,ne=null,Sn(n,o,c),ne=m,We=E,ne!==null)if(We)try{(ne.nodeType===9?ne.body:ne.nodeName==="HTML"?ne.ownerDocument.body:ne).removeChild(c.stateNode)}catch(x){Ht(c,o,x)}else try{ne.removeChild(c.stateNode)}catch(x){Ht(c,o,x)}break;case 18:ne!==null&&(We?(n=ne,v0(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),kr(n)):v0(ne,c.stateNode));break;case 4:m=ne,E=We,ne=c.stateNode.containerInfo,We=!0,Sn(n,o,c),ne=m,We=E;break;case 0:case 11:case 14:case 15:Yn(2,c,o),Ee||Yn(4,c,o),Sn(n,o,c);break;case 1:Ee||(ji(c,o),m=c.stateNode,typeof m.componentWillUnmount=="function"&&Eg(c,o,m)),Sn(n,o,c);break;case 21:Sn(n,o,c);break;case 22:Ee=(m=Ee)||c.memoizedState!==null,Sn(n,o,c),Ee=m;break;default:Sn(n,o,c)}}function _g(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{kr(n)}catch(c){Ht(o,o.return,c)}}}function Cg(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{kr(n)}catch(c){Ht(o,o.return,c)}}function NT(n){switch(n.tag){case 31:case 13:case 19:var o=n.stateNode;return o===null&&(o=n.stateNode=new bg),o;case 22:return n=n.stateNode,o=n._retryCache,o===null&&(o=n._retryCache=new bg),o;default:throw Error(i(435,n.tag))}}function nl(n,o){var c=NT(n);o.forEach(function(m){if(!c.has(m)){c.add(m);var E=VT.bind(null,n,m);m.then(E,E)}})}function Qe(n,o){var c=o.deletions;if(c!==null)for(var m=0;m<c.length;m++){var E=c[m],x=n,L=o,I=L;t:for(;I!==null;){switch(I.tag){case 27:if(es(I.type)){ne=I.stateNode,We=!1;break t}break;case 5:ne=I.stateNode,We=!1;break t;case 3:case 4:ne=I.stateNode.containerInfo,We=!0;break t}I=I.return}if(ne===null)throw Error(i(160));Lg(x,L,E),ne=null,We=!1,x=E.alternate,x!==null&&(x.return=null),E.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)wg(o,n),o=o.sibling}var Ii=null;function wg(n,o){var c=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Qe(o,n),Ze(n),m&4&&(Yn(3,n,n.return),Ca(3,n),Yn(5,n,n.return));break;case 1:Qe(o,n),Ze(n),m&512&&(Ee||c===null||ji(c,c.return)),m&64&&xn&&(n=n.updateQueue,n!==null&&(m=n.callbacks,m!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var E=Ii;if(Qe(o,n),Ze(n),m&512&&(Ee||c===null||ji(c,c.return)),m&4){var x=c!==null?c.memoizedState:null;if(m=n.memoizedState,c===null)if(m===null)if(n.stateNode===null){t:{m=n.type,c=n.memoizedProps,E=E.ownerDocument||E;e:switch(m){case"title":x=E.getElementsByTagName("title")[0],(!x||x[ia]||x[Oe]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=E.createElement(m),E.head.insertBefore(x,E.querySelector("head > title"))),Ne(x,m,c),x[Oe]=n,_e(x),m=x;break t;case"link":var L=w0("link","href",E).get(m+(c.href||""));if(L){for(var I=0;I<L.length;I++)if(x=L[I],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){L.splice(I,1);break e}}x=E.createElement(m),Ne(x,m,c),E.head.appendChild(x);break;case"meta":if(L=w0("meta","content",E).get(m+(c.content||""))){for(I=0;I<L.length;I++)if(x=L[I],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){L.splice(I,1);break e}}x=E.createElement(m),Ne(x,m,c),E.head.appendChild(x);break;default:throw Error(i(468,m))}x[Oe]=n,_e(x),m=x}n.stateNode=m}else D0(E,n.type,n.stateNode);else n.stateNode=C0(E,m,n.memoizedProps);else x!==m?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,m===null?D0(E,n.type,n.stateNode):C0(E,m,n.memoizedProps)):m===null&&n.stateNode!==null&&df(n,n.memoizedProps,c.memoizedProps)}break;case 27:Qe(o,n),Ze(n),m&512&&(Ee||c===null||ji(c,c.return)),c!==null&&m&4&&df(n,n.memoizedProps,c.memoizedProps);break;case 5:if(Qe(o,n),Ze(n),m&512&&(Ee||c===null||ji(c,c.return)),n.flags&32){E=n.stateNode;try{ir(E,"")}catch(gt){Ht(n,n.return,gt)}}m&4&&n.stateNode!=null&&(E=n.memoizedProps,df(n,E,c!==null?c.memoizedProps:E)),m&1024&&(pf=!0);break;case 6:if(Qe(o,n),Ze(n),m&4){if(n.stateNode===null)throw Error(i(162));m=n.memoizedProps,c=n.stateNode;try{c.nodeValue=m}catch(gt){Ht(n,n.return,gt)}}break;case 3:if(El=null,E=Ii,Ii=yl(o.containerInfo),Qe(o,n),Ii=E,Ze(n),m&4&&c!==null&&c.memoizedState.isDehydrated)try{kr(o.containerInfo)}catch(gt){Ht(n,n.return,gt)}pf&&(pf=!1,Dg(n));break;case 4:m=Ii,Ii=yl(n.stateNode.containerInfo),Qe(o,n),Ze(n),Ii=m;break;case 12:Qe(o,n),Ze(n);break;case 31:Qe(o,n),Ze(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,nl(n,m)));break;case 13:Qe(o,n),Ze(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(rl=ie()),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,nl(n,m)));break;case 22:E=n.memoizedState!==null;var U=c!==null&&c.memoizedState!==null,J=xn,rt=Ee;if(xn=J||E,Ee=rt||U,Qe(o,n),Ee=rt,xn=J,Ze(n),m&8192)t:for(o=n.stateNode,o._visibility=E?o._visibility&-2:o._visibility|1,E&&(c===null||U||xn||Ee||Ms(n)),c=null,o=n;;){if(o.tag===5||o.tag===26){if(c===null){U=c=o;try{if(x=U.stateNode,E)L=x.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none";else{I=U.stateNode;var lt=U.memoizedProps.style,et=lt!=null&&lt.hasOwnProperty("display")?lt.display:null;I.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(gt){Ht(U,U.return,gt)}}}else if(o.tag===6){if(c===null){U=o;try{U.stateNode.nodeValue=E?"":U.memoizedProps}catch(gt){Ht(U,U.return,gt)}}}else if(o.tag===18){if(c===null){U=o;try{var it=U.stateNode;E?E0(it,!0):E0(U.stateNode,!1)}catch(gt){Ht(U,U.return,gt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===n)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break t;for(;o.sibling===null;){if(o.return===null||o.return===n)break t;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}m&4&&(m=n.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,nl(n,c))));break;case 19:Qe(o,n),Ze(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,nl(n,m)));break;case 30:break;case 21:break;default:Qe(o,n),Ze(n)}}function Ze(n){var o=n.flags;if(o&2){try{for(var c,m=n.return;m!==null;){if(Sg(m)){c=m;break}m=m.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var E=c.stateNode,x=hf(n);il(n,x,E);break;case 5:var L=c.stateNode;c.flags&32&&(ir(L,""),c.flags&=-33);var I=hf(n);il(n,I,L);break;case 3:case 4:var U=c.stateNode.containerInfo,J=hf(n);mf(n,J,U);break;default:throw Error(i(161))}}catch(rt){Ht(n,n.return,rt)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function Dg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var o=n;Dg(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),n=n.sibling}}function Tn(n,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Ag(n,o.alternate,o),o=o.sibling}function Ms(n){for(n=n.child;n!==null;){var o=n;switch(o.tag){case 0:case 11:case 14:case 15:Yn(4,o,o.return),Ms(o);break;case 1:ji(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&Eg(o,o.return,c),Ms(o);break;case 27:Ba(o.stateNode);case 26:case 5:ji(o,o.return),Ms(o);break;case 22:o.memoizedState===null&&Ms(o);break;case 30:Ms(o);break;default:Ms(o)}n=n.sibling}}function bn(n,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var m=o.alternate,E=n,x=o,L=x.flags;switch(x.tag){case 0:case 11:case 15:bn(E,x,c),Ca(4,x);break;case 1:if(bn(E,x,c),m=x,E=m.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(J){Ht(m,m.return,J)}if(m=x,E=m.updateQueue,E!==null){var I=m.stateNode;try{var U=E.shared.hiddenCallbacks;if(U!==null)for(E.shared.hiddenCallbacks=null,E=0;E<U.length;E++)op(U[E],I)}catch(J){Ht(m,m.return,J)}}c&&L&64&&vg(x),wa(x,x.return);break;case 27:Tg(x);case 26:case 5:bn(E,x,c),c&&m===null&&L&4&&xg(x),wa(x,x.return);break;case 12:bn(E,x,c);break;case 31:bn(E,x,c),c&&L&4&&_g(E,x);break;case 13:bn(E,x,c),c&&L&4&&Cg(E,x);break;case 22:x.memoizedState===null&&bn(E,x,c),wa(x,x.return);break;case 30:break;default:bn(E,x,c)}o=o.sibling}}function gf(n,o){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(n=o.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&pa(c))}function yf(n,o){n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&pa(n))}function Oi(n,o,c,m){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ig(n,o,c,m),o=o.sibling}function Ig(n,o,c,m){var E=o.flags;switch(o.tag){case 0:case 11:case 15:Oi(n,o,c,m),E&2048&&Ca(9,o);break;case 1:Oi(n,o,c,m);break;case 3:Oi(n,o,c,m),E&2048&&(n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&pa(n)));break;case 12:if(E&2048){Oi(n,o,c,m),n=o.stateNode;try{var x=o.memoizedProps,L=x.id,I=x.onPostCommit;typeof I=="function"&&I(L,o.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){Ht(o,o.return,U)}}else Oi(n,o,c,m);break;case 31:Oi(n,o,c,m);break;case 13:Oi(n,o,c,m);break;case 23:break;case 22:x=o.stateNode,L=o.alternate,o.memoizedState!==null?x._visibility&2?Oi(n,o,c,m):Da(n,o):x._visibility&2?Oi(n,o,c,m):(x._visibility|=2,Tr(n,o,c,m,(o.subtreeFlags&10256)!==0||!1)),E&2048&&gf(L,o);break;case 24:Oi(n,o,c,m),E&2048&&yf(o.alternate,o);break;default:Oi(n,o,c,m)}}function Tr(n,o,c,m,E){for(E=E&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=n,L=o,I=c,U=m,J=L.flags;switch(L.tag){case 0:case 11:case 15:Tr(x,L,I,U,E),Ca(8,L);break;case 23:break;case 22:var rt=L.stateNode;L.memoizedState!==null?rt._visibility&2?Tr(x,L,I,U,E):Da(x,L):(rt._visibility|=2,Tr(x,L,I,U,E)),E&&J&2048&&gf(L.alternate,L);break;case 24:Tr(x,L,I,U,E),E&&J&2048&&yf(L.alternate,L);break;default:Tr(x,L,I,U,E)}o=o.sibling}}function Da(n,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=n,m=o,E=m.flags;switch(m.tag){case 22:Da(c,m),E&2048&&gf(m.alternate,m);break;case 24:Da(c,m),E&2048&&yf(m.alternate,m);break;default:Da(c,m)}o=o.sibling}}var Ia=8192;function br(n,o,c){if(n.subtreeFlags&Ia)for(n=n.child;n!==null;)Og(n,o,c),n=n.sibling}function Og(n,o,c){switch(n.tag){case 26:br(n,o,c),n.flags&Ia&&n.memoizedState!==null&&Tb(c,Ii,n.memoizedState,n.memoizedProps);break;case 5:br(n,o,c);break;case 3:case 4:var m=Ii;Ii=yl(n.stateNode.containerInfo),br(n,o,c),Ii=m;break;case 22:n.memoizedState===null&&(m=n.alternate,m!==null&&m.memoizedState!==null?(m=Ia,Ia=16777216,br(n,o,c),Ia=m):br(n,o,c));break;default:br(n,o,c)}}function kg(n){var o=n.alternate;if(o!==null&&(n=o.child,n!==null)){o.child=null;do o=n.sibling,n.sibling=null,n=o;while(n!==null)}}function Oa(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];Ce=m,Pg(m,n)}kg(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Mg(n),n=n.sibling}function Mg(n){switch(n.tag){case 0:case 11:case 15:Oa(n),n.flags&2048&&Yn(9,n,n.return);break;case 3:Oa(n);break;case 12:Oa(n);break;case 22:var o=n.stateNode;n.memoizedState!==null&&o._visibility&2&&(n.return===null||n.return.tag!==13)?(o._visibility&=-3,sl(n)):Oa(n);break;default:Oa(n)}}function sl(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];Ce=m,Pg(m,n)}kg(n)}for(n=n.child;n!==null;){switch(o=n,o.tag){case 0:case 11:case 15:Yn(8,o,o.return),sl(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,sl(o));break;default:sl(o)}n=n.sibling}}function Pg(n,o){for(;Ce!==null;){var c=Ce;switch(c.tag){case 0:case 11:case 15:Yn(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:pa(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,Ce=m;else t:for(c=n;Ce!==null;){m=Ce;var E=m.sibling,x=m.return;if(Rg(m),m===c){Ce=null;break t}if(E!==null){E.return=x,Ce=E;break t}Ce=x}}}var FT={getCacheForType:function(n){var o=Me(ge),c=o.data.get(n);return c===void 0&&(c=n(),o.data.set(n,c)),c},cacheSignal:function(){return Me(ge).controller.signal}},BT=typeof WeakMap=="function"?WeakMap:Map,jt=0,Wt=null,kt=null,Pt=0,Gt=0,oi=null,Xn=!1,Ar=!1,vf=!1,An=0,ce=0,Wn=0,Ps=0,Ef=0,li=0,Rr=0,ka=null,Je=null,xf=!1,rl=0,Ng=0,al=1/0,ol=null,Qn=null,Te=0,Zn=null,Lr=null,Rn=0,Sf=0,Tf=null,Fg=null,Ma=0,bf=null;function ui(){return(jt&2)!==0&&Pt!==0?Pt&-Pt:O.T!==null?wf():Jh()}function Bg(){if(li===0)if((Pt&536870912)===0||Ft){var n=po;po<<=1,(po&3932160)===0&&(po=262144),li=n}else li=536870912;return n=ri.current,n!==null&&(n.flags|=32),li}function ti(n,o,c){(n===Wt&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)&&(_r(n,0),Jn(n,Pt,li,!1)),ea(n,c),((jt&2)===0||n!==Wt)&&(n===Wt&&((jt&2)===0&&(Ps|=c),ce===4&&Jn(n,Pt,li,!1)),Gi(n))}function Ug(n,o,c){if((jt&6)!==0)throw Error(i(327));var m=!c&&(o&127)===0&&(o&n.expiredLanes)===0||ta(n,o),E=m?jT(n,o):Rf(n,o,!0),x=m;do{if(E===0){Ar&&!m&&Jn(n,o,0,!1);break}else{if(c=n.current.alternate,x&&!UT(c)){E=Rf(n,o,!1),x=!1;continue}if(E===2){if(x=o,n.errorRecoveryDisabledLanes&x)var L=0;else L=n.pendingLanes&-536870913,L=L!==0?L:L&536870912?536870912:0;if(L!==0){o=L;t:{var I=n;E=ka;var U=I.current.memoizedState.isDehydrated;if(U&&(_r(I,L).flags|=256),L=Rf(I,L,!1),L!==2){if(vf&&!U){I.errorRecoveryDisabledLanes|=x,Ps|=x,E=4;break t}x=Je,Je=E,x!==null&&(Je===null?Je=x:Je.push.apply(Je,x))}E=L}if(x=!1,E!==2)continue}}if(E===1){_r(n,0),Jn(n,o,0,!0);break}t:{switch(m=n,x=E,x){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Jn(m,o,li,!Xn);break t;case 2:Je=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(E=rl+300-ie(),10<E)){if(Jn(m,o,li,!Xn),yo(m,0,!0)!==0)break t;Rn=o,m.timeoutHandle=g0($g.bind(null,m,c,Je,ol,xf,o,li,Ps,Rr,Xn,x,"Throttled",-0,0),E);break t}$g(m,c,Je,ol,xf,o,li,Ps,Rr,Xn,x,null,-0,0)}}break}while(!0);Gi(n)}function $g(n,o,c,m,E,x,L,I,U,J,rt,lt,et,it){if(n.timeoutHandle=-1,lt=o.subtreeFlags,lt&8192||(lt&16785408)===16785408){lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cn},Og(o,x,lt);var gt=(x&62914560)===x?rl-ie():(x&4194048)===x?Ng-ie():0;if(gt=bb(lt,gt),gt!==null){Rn=x,n.cancelPendingCommit=gt(Yg.bind(null,n,o,x,c,m,E,L,I,U,rt,lt,null,et,it)),Jn(n,x,L,!J);return}}Yg(n,o,x,c,m,E,L,I,U)}function UT(n){for(var o=n;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var E=c[m],x=E.getSnapshot;E=E.value;try{if(!ni(x(),E))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Jn(n,o,c,m){o&=~Ef,o&=~Ps,n.suspendedLanes|=o,n.pingedLanes&=~o,m&&(n.warmLanes|=o),m=n.expirationTimes;for(var E=o;0<E;){var x=31-He(E),L=1<<x;m[x]=-1,E&=~L}c!==0&&Wh(n,c,o)}function ll(){return(jt&6)===0?(Pa(0),!1):!0}function Af(){if(kt!==null){if(Gt===0)var n=kt.return;else n=kt,mn=Ls=null,Uc(n),yr=null,ya=0,n=kt;for(;n!==null;)yg(n.alternate,n),n=n.return;kt=null}}function _r(n,o){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,rb(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),Rn=0,Af(),Wt=n,kt=c=dn(n.current,null),Pt=o,Gt=0,oi=null,Xn=!1,Ar=ta(n,o),vf=!1,Rr=li=Ef=Ps=Wn=ce=0,Je=ka=null,xf=!1,(o&8)!==0&&(o|=o&32);var m=n.entangledLanes;if(m!==0)for(n=n.entanglements,m&=o;0<m;){var E=31-He(m),x=1<<E;o|=n[E],m&=~x}return An=o,wo(),c}function jg(n,o){Ct=null,O.H=Ra,o===gr||o===Fo?(o=np(),Gt=3):o===_c?(o=np(),Gt=4):Gt=o===ef?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,oi=o,kt===null&&(ce=1,Qo(n,xi(o,n.current)))}function Gg(){var n=ri.current;return n===null?!0:(Pt&4194048)===Pt?Ai===null:(Pt&62914560)===Pt||(Pt&536870912)!==0?n===Ai:!1}function Hg(){var n=O.H;return O.H=Ra,n===null?Ra:n}function zg(){var n=O.A;return O.A=FT,n}function ul(){ce=4,Xn||(Pt&4194048)!==Pt&&ri.current!==null||(Ar=!0),(Wn&134217727)===0&&(Ps&134217727)===0||Wt===null||Jn(Wt,Pt,li,!1)}function Rf(n,o,c){var m=jt;jt|=2;var E=Hg(),x=zg();(Wt!==n||Pt!==o)&&(ol=null,_r(n,o)),o=!1;var L=ce;t:do try{if(Gt!==0&&kt!==null){var I=kt,U=oi;switch(Gt){case 8:Af(),L=6;break t;case 3:case 2:case 9:case 6:ri.current===null&&(o=!0);var J=Gt;if(Gt=0,oi=null,Cr(n,I,U,J),c&&Ar){L=0;break t}break;default:J=Gt,Gt=0,oi=null,Cr(n,I,U,J)}}$T(),L=ce;break}catch(rt){jg(n,rt)}while(!0);return o&&n.shellSuspendCounter++,mn=Ls=null,jt=m,O.H=E,O.A=x,kt===null&&(Wt=null,Pt=0,wo()),L}function $T(){for(;kt!==null;)Vg(kt)}function jT(n,o){var c=jt;jt|=2;var m=Hg(),E=zg();Wt!==n||Pt!==o?(ol=null,al=ie()+500,_r(n,o)):Ar=ta(n,o);t:do try{if(Gt!==0&&kt!==null){o=kt;var x=oi;e:switch(Gt){case 1:Gt=0,oi=null,Cr(n,o,x,1);break;case 2:case 9:if(ep(x)){Gt=0,oi=null,Kg(o);break}o=function(){Gt!==2&&Gt!==9||Wt!==n||(Gt=7),Gi(n)},x.then(o,o);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:ep(x)?(Gt=0,oi=null,Kg(o)):(Gt=0,oi=null,Cr(n,o,x,7));break;case 5:var L=null;switch(kt.tag){case 26:L=kt.memoizedState;case 5:case 27:var I=kt;if(L?I0(L):I.stateNode.complete){Gt=0,oi=null;var U=I.sibling;if(U!==null)kt=U;else{var J=I.return;J!==null?(kt=J,cl(J)):kt=null}break e}}Gt=0,oi=null,Cr(n,o,x,5);break;case 6:Gt=0,oi=null,Cr(n,o,x,6);break;case 8:Af(),ce=6;break t;default:throw Error(i(462))}}GT();break}catch(rt){jg(n,rt)}while(!0);return mn=Ls=null,O.H=m,O.A=E,jt=c,kt!==null?0:(Wt=null,Pt=0,wo(),ce)}function GT(){for(;kt!==null&&!Ue();)Vg(kt)}function Vg(n){var o=pg(n.alternate,n,An);n.memoizedProps=n.pendingProps,o===null?cl(n):kt=o}function Kg(n){var o=n,c=o.alternate;switch(o.tag){case 15:case 0:o=ug(c,o,o.pendingProps,o.type,void 0,Pt);break;case 11:o=ug(c,o,o.pendingProps,o.type.render,o.ref,Pt);break;case 5:Uc(o);default:yg(c,o),o=kt=zm(o,An),o=pg(c,o,An)}n.memoizedProps=n.pendingProps,o===null?cl(n):kt=o}function Cr(n,o,c,m){mn=Ls=null,Uc(o),yr=null,ya=0;var E=o.return;try{if(DT(n,E,o,c,Pt)){ce=1,Qo(n,xi(c,n.current)),kt=null;return}}catch(x){if(E!==null)throw kt=E,x;ce=1,Qo(n,xi(c,n.current)),kt=null;return}o.flags&32768?(Ft||m===1?n=!0:Ar||(Pt&536870912)!==0?n=!1:(Xn=n=!0,(m===2||m===9||m===3||m===6)&&(m=ri.current,m!==null&&m.tag===13&&(m.flags|=16384))),qg(o,n)):cl(o)}function cl(n){var o=n;do{if((o.flags&32768)!==0){qg(o,Xn);return}n=o.return;var c=kT(o.alternate,o,An);if(c!==null){kt=c;return}if(o=o.sibling,o!==null){kt=o;return}kt=o=n}while(o!==null);ce===0&&(ce=5)}function qg(n,o){do{var c=MT(n.alternate,n);if(c!==null){c.flags&=32767,kt=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(n=n.sibling,n!==null)){kt=n;return}kt=n=c}while(n!==null);ce=6,kt=null}function Yg(n,o,c,m,E,x,L,I,U){n.cancelPendingCommit=null;do fl();while(Te!==0);if((jt&6)!==0)throw Error(i(327));if(o!==null){if(o===n.current)throw Error(i(177));if(x=o.lanes|o.childLanes,x|=dc,SS(n,c,x,L,I,U),n===Wt&&(kt=Wt=null,Pt=0),Lr=o,Zn=n,Rn=c,Sf=x,Tf=E,Fg=m,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,KT(Nn,function(){return Jg(),null})):(n.callbackNode=null,n.callbackPriority=0),m=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||m){m=O.T,O.T=null,E=j.p,j.p=2,L=jt,jt|=4;try{PT(n,o,c)}finally{jt=L,j.p=E,O.T=m}}Te=1,Xg(),Wg(),Qg()}}function Xg(){if(Te===1){Te=0;var n=Zn,o=Lr,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=O.T,O.T=null;var m=j.p;j.p=2;var E=jt;jt|=4;try{wg(o,n);var x=Ff,L=Pm(n.containerInfo),I=x.focusedElem,U=x.selectionRange;if(L!==I&&I&&I.ownerDocument&&Mm(I.ownerDocument.documentElement,I)){if(U!==null&&oc(I)){var J=U.start,rt=U.end;if(rt===void 0&&(rt=J),"selectionStart"in I)I.selectionStart=J,I.selectionEnd=Math.min(rt,I.value.length);else{var lt=I.ownerDocument||document,et=lt&&lt.defaultView||window;if(et.getSelection){var it=et.getSelection(),gt=I.textContent.length,St=Math.min(U.start,gt),Yt=U.end===void 0?St:Math.min(U.end,gt);!it.extend&&St>Yt&&(L=Yt,Yt=St,St=L);var q=km(I,St),H=km(I,Yt);if(q&&H&&(it.rangeCount!==1||it.anchorNode!==q.node||it.anchorOffset!==q.offset||it.focusNode!==H.node||it.focusOffset!==H.offset)){var Z=lt.createRange();Z.setStart(q.node,q.offset),it.removeAllRanges(),St>Yt?(it.addRange(Z),it.extend(H.node,H.offset)):(Z.setEnd(H.node,H.offset),it.addRange(Z))}}}}for(lt=[],it=I;it=it.parentNode;)it.nodeType===1&&lt.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<lt.length;I++){var ot=lt[I];ot.element.scrollLeft=ot.left,ot.element.scrollTop=ot.top}}bl=!!Nf,Ff=Nf=null}finally{jt=E,j.p=m,O.T=c}}n.current=o,Te=2}}function Wg(){if(Te===2){Te=0;var n=Zn,o=Lr,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=O.T,O.T=null;var m=j.p;j.p=2;var E=jt;jt|=4;try{Ag(n,o.alternate,o)}finally{jt=E,j.p=m,O.T=c}}Te=3}}function Qg(){if(Te===4||Te===3){Te=0,je();var n=Zn,o=Lr,c=Rn,m=Fg;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Te=5:(Te=0,Lr=Zn=null,Zg(n,n.pendingLanes));var E=n.pendingLanes;if(E===0&&(Qn=null),Gu(c),o=o.stateNode,Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(ys,o,void 0,(o.current.flags&128)===128)}catch{}if(m!==null){o=O.T,E=j.p,j.p=2,O.T=null;try{for(var x=n.onRecoverableError,L=0;L<m.length;L++){var I=m[L];x(I.value,{componentStack:I.stack})}}finally{O.T=o,j.p=E}}(Rn&3)!==0&&fl(),Gi(n),E=n.pendingLanes,(c&261930)!==0&&(E&42)!==0?n===bf?Ma++:(Ma=0,bf=n):Ma=0,Pa(0)}}function Zg(n,o){(n.pooledCacheLanes&=o)===0&&(o=n.pooledCache,o!=null&&(n.pooledCache=null,pa(o)))}function fl(){return Xg(),Wg(),Qg(),Jg()}function Jg(){if(Te!==5)return!1;var n=Zn,o=Sf;Sf=0;var c=Gu(Rn),m=O.T,E=j.p;try{j.p=32>c?32:c,O.T=null,c=Tf,Tf=null;var x=Zn,L=Rn;if(Te=0,Lr=Zn=null,Rn=0,(jt&6)!==0)throw Error(i(331));var I=jt;if(jt|=4,Mg(x.current),Ig(x,x.current,L,c),jt=I,Pa(0,!1),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(ys,x)}catch{}return!0}finally{j.p=E,O.T=m,Zg(n,o)}}function t0(n,o,c){o=xi(c,o),o=tf(n.stateNode,o,2),n=Vn(n,o,2),n!==null&&(ea(n,2),Gi(n))}function Ht(n,o,c){if(n.tag===3)t0(n,n,c);else for(;o!==null;){if(o.tag===3){t0(o,n,c);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Qn===null||!Qn.has(m))){n=xi(c,n),c=eg(2),m=Vn(o,c,2),m!==null&&(ig(c,m,o,n),ea(m,2),Gi(m));break}}o=o.return}}function Lf(n,o,c){var m=n.pingCache;if(m===null){m=n.pingCache=new BT;var E=new Set;m.set(o,E)}else E=m.get(o),E===void 0&&(E=new Set,m.set(o,E));E.has(c)||(vf=!0,E.add(c),n=HT.bind(null,n,o,c),o.then(n,n))}function HT(n,o,c){var m=n.pingCache;m!==null&&m.delete(o),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,Wt===n&&(Pt&c)===c&&(ce===4||ce===3&&(Pt&62914560)===Pt&&300>ie()-rl?(jt&2)===0&&_r(n,0):Ef|=c,Rr===Pt&&(Rr=0)),Gi(n)}function e0(n,o){o===0&&(o=Xh()),n=bs(n,o),n!==null&&(ea(n,o),Gi(n))}function zT(n){var o=n.memoizedState,c=0;o!==null&&(c=o.retryLane),e0(n,c)}function VT(n,o){var c=0;switch(n.tag){case 31:case 13:var m=n.stateNode,E=n.memoizedState;E!==null&&(c=E.retryLane);break;case 19:m=n.stateNode;break;case 22:m=n.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(o),e0(n,c)}function KT(n,o){return le(n,o)}var dl=null,wr=null,_f=!1,hl=!1,Cf=!1,ts=0;function Gi(n){n!==wr&&n.next===null&&(wr===null?dl=wr=n:wr=wr.next=n),hl=!0,_f||(_f=!0,YT())}function Pa(n,o){if(!Cf&&hl){Cf=!0;do for(var c=!1,m=dl;m!==null;){if(n!==0){var E=m.pendingLanes;if(E===0)var x=0;else{var L=m.suspendedLanes,I=m.pingedLanes;x=(1<<31-He(42|n)+1)-1,x&=E&~(L&~I),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,r0(m,x))}else x=Pt,x=yo(m,m===Wt?x:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(x&3)===0||ta(m,x)||(c=!0,r0(m,x));m=m.next}while(c);Cf=!1}}function qT(){i0()}function i0(){hl=_f=!1;var n=0;ts!==0&&sb()&&(n=ts);for(var o=ie(),c=null,m=dl;m!==null;){var E=m.next,x=n0(m,o);x===0?(m.next=null,c===null?dl=E:c.next=E,E===null&&(wr=c)):(c=m,(n!==0||(x&3)!==0)&&(hl=!0)),m=E}Te!==0&&Te!==5||Pa(n),ts!==0&&(ts=0)}function n0(n,o){for(var c=n.suspendedLanes,m=n.pingedLanes,E=n.expirationTimes,x=n.pendingLanes&-62914561;0<x;){var L=31-He(x),I=1<<L,U=E[L];U===-1?((I&c)===0||(I&m)!==0)&&(E[L]=xS(I,o)):U<=o&&(n.expiredLanes|=I),x&=~I}if(o=Wt,c=Pt,c=yo(n,n===o?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m=n.callbackNode,c===0||n===o&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)return m!==null&&m!==null&&Ie(m),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||ta(n,c)){if(o=c&-c,o===n.callbackPriority)return o;switch(m!==null&&Ie(m),Gu(c)){case 2:case 8:c=ps;break;case 32:c=Nn;break;case 268435456:c=gs;break;default:c=Nn}return m=s0.bind(null,n),c=le(c,m),n.callbackPriority=o,n.callbackNode=c,o}return m!==null&&m!==null&&Ie(m),n.callbackPriority=2,n.callbackNode=null,2}function s0(n,o){if(Te!==0&&Te!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(fl()&&n.callbackNode!==c)return null;var m=Pt;return m=yo(n,n===Wt?m:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m===0?null:(Ug(n,m,o),n0(n,ie()),n.callbackNode!=null&&n.callbackNode===c?s0.bind(null,n):null)}function r0(n,o){if(fl())return null;Ug(n,o,!0)}function YT(){ab(function(){(jt&6)!==0?le(qe,qT):i0()})}function wf(){if(ts===0){var n=mr;n===0&&(n=mo,mo<<=1,(mo&261888)===0&&(mo=256)),ts=n}return ts}function a0(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:So(""+n)}function o0(n,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,n.id&&c.setAttribute("form",n.id),o.parentNode.insertBefore(c,o),n=new FormData(n),c.parentNode.removeChild(c),n}function XT(n,o,c,m,E){if(o==="submit"&&c&&c.stateNode===E){var x=a0((E[Ye]||null).action),L=m.submitter;L&&(o=(o=L[Ye]||null)?a0(o.formAction):L.getAttribute("formAction"),o!==null&&(x=o,L=null));var I=new Ro("action","action",null,m,E);n.push({event:I,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(ts!==0){var U=L?o0(E,L):new FormData(E);Yc(c,{pending:!0,data:U,method:E.method,action:x},null,U)}}else typeof x=="function"&&(I.preventDefault(),U=L?o0(E,L):new FormData(E),Yc(c,{pending:!0,data:U,method:E.method,action:x},x,U))},currentTarget:E}]})}}for(var Df=0;Df<fc.length;Df++){var If=fc[Df],WT=If.toLowerCase(),QT=If[0].toUpperCase()+If.slice(1);Di(WT,"on"+QT)}Di(Bm,"onAnimationEnd"),Di(Um,"onAnimationIteration"),Di($m,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(hT,"onTransitionRun"),Di(mT,"onTransitionStart"),Di(pT,"onTransitionCancel"),Di(jm,"onTransitionEnd"),tr("onMouseEnter",["mouseout","mouseover"]),tr("onMouseLeave",["mouseout","mouseover"]),tr("onPointerEnter",["pointerout","pointerover"]),tr("onPointerLeave",["pointerout","pointerover"]),Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Es("onBeforeInput",["compositionend","keypress","textInput","paste"]),Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Na));function l0(n,o){o=(o&4)!==0;for(var c=0;c<n.length;c++){var m=n[c],E=m.event;m=m.listeners;t:{var x=void 0;if(o)for(var L=m.length-1;0<=L;L--){var I=m[L],U=I.instance,J=I.currentTarget;if(I=I.listener,U!==x&&E.isPropagationStopped())break t;x=I,E.currentTarget=J;try{x(E)}catch(rt){Co(rt)}E.currentTarget=null,x=U}else for(L=0;L<m.length;L++){if(I=m[L],U=I.instance,J=I.currentTarget,I=I.listener,U!==x&&E.isPropagationStopped())break t;x=I,E.currentTarget=J;try{x(E)}catch(rt){Co(rt)}E.currentTarget=null,x=U}}}}function Mt(n,o){var c=o[Hu];c===void 0&&(c=o[Hu]=new Set);var m=n+"__bubble";c.has(m)||(u0(o,n,2,!1),c.add(m))}function Of(n,o,c){var m=0;o&&(m|=4),u0(c,n,m,o)}var ml="_reactListening"+Math.random().toString(36).slice(2);function kf(n){if(!n[ml]){n[ml]=!0,im.forEach(function(c){c!=="selectionchange"&&(ZT.has(c)||Of(c,!1,n),Of(c,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[ml]||(o[ml]=!0,Of("selectionchange",!1,o))}}function u0(n,o,c,m){switch(B0(o)){case 2:var E=Lb;break;case 8:E=_b;break;default:E=Yf}c=E.bind(null,o,c,n),E=void 0,!Zu||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),m?E!==void 0?n.addEventListener(o,c,{capture:!0,passive:E}):n.addEventListener(o,c,!0):E!==void 0?n.addEventListener(o,c,{passive:E}):n.addEventListener(o,c,!1)}function Mf(n,o,c,m,E){var x=m;if((o&1)===0&&(o&2)===0&&m!==null)t:for(;;){if(m===null)return;var L=m.tag;if(L===3||L===4){var I=m.stateNode.containerInfo;if(I===E)break;if(L===4)for(L=m.return;L!==null;){var U=L.tag;if((U===3||U===4)&&L.stateNode.containerInfo===E)return;L=L.return}for(;I!==null;){if(L=Qs(I),L===null)return;if(U=L.tag,U===5||U===6||U===26||U===27){m=x=L;continue t}I=I.parentNode}}m=m.return}mm(function(){var J=x,rt=Wu(c),lt=[];t:{var et=Gm.get(n);if(et!==void 0){var it=Ro,gt=n;switch(n){case"keypress":if(bo(c)===0)break t;case"keydown":case"keyup":it=VS;break;case"focusin":gt="focus",it=ic;break;case"focusout":gt="blur",it=ic;break;case"beforeblur":case"afterblur":it=ic;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=ym;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=kS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=YS;break;case Bm:case Um:case $m:it=NS;break;case jm:it=WS;break;case"scroll":case"scrollend":it=IS;break;case"wheel":it=ZS;break;case"copy":case"cut":case"paste":it=BS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=Em;break;case"toggle":case"beforetoggle":it=tT}var St=(o&4)!==0,Yt=!St&&(n==="scroll"||n==="scrollend"),q=St?et!==null?et+"Capture":null:et;St=[];for(var H=J,Z;H!==null;){var ot=H;if(Z=ot.stateNode,ot=ot.tag,ot!==5&&ot!==26&&ot!==27||Z===null||q===null||(ot=sa(H,q),ot!=null&&St.push(Fa(H,ot,Z))),Yt)break;H=H.return}0<St.length&&(et=new it(et,gt,null,c,rt),lt.push({event:et,listeners:St}))}}if((o&7)===0){t:{if(et=n==="mouseover"||n==="pointerover",it=n==="mouseout"||n==="pointerout",et&&c!==Xu&&(gt=c.relatedTarget||c.fromElement)&&(Qs(gt)||gt[Ws]))break t;if((it||et)&&(et=rt.window===rt?rt:(et=rt.ownerDocument)?et.defaultView||et.parentWindow:window,it?(gt=c.relatedTarget||c.toElement,it=J,gt=gt?Qs(gt):null,gt!==null&&(Yt=a(gt),St=gt.tag,gt!==Yt||St!==5&&St!==27&&St!==6)&&(gt=null)):(it=null,gt=J),it!==gt)){if(St=ym,ot="onMouseLeave",q="onMouseEnter",H="mouse",(n==="pointerout"||n==="pointerover")&&(St=Em,ot="onPointerLeave",q="onPointerEnter",H="pointer"),Yt=it==null?et:na(it),Z=gt==null?et:na(gt),et=new St(ot,H+"leave",it,c,rt),et.target=Yt,et.relatedTarget=Z,ot=null,Qs(rt)===J&&(St=new St(q,H+"enter",gt,c,rt),St.target=Z,St.relatedTarget=Yt,ot=St),Yt=ot,it&&gt)e:{for(St=JT,q=it,H=gt,Z=0,ot=q;ot;ot=St(ot))Z++;ot=0;for(var xt=H;xt;xt=St(xt))ot++;for(;0<Z-ot;)q=St(q),Z--;for(;0<ot-Z;)H=St(H),ot--;for(;Z--;){if(q===H||H!==null&&q===H.alternate){St=q;break e}q=St(q),H=St(H)}St=null}else St=null;it!==null&&c0(lt,et,it,St,!1),gt!==null&&Yt!==null&&c0(lt,Yt,gt,St,!0)}}t:{if(et=J?na(J):window,it=et.nodeName&&et.nodeName.toLowerCase(),it==="select"||it==="input"&&et.type==="file")var Ut=_m;else if(Rm(et))if(Cm)Ut=cT;else{Ut=lT;var yt=oT}else it=et.nodeName,!it||it.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?J&&Yu(J.elementType)&&(Ut=_m):Ut=uT;if(Ut&&(Ut=Ut(n,J))){Lm(lt,Ut,c,rt);break t}yt&&yt(n,et,J),n==="focusout"&&J&&et.type==="number"&&J.memoizedProps.value!=null&&qu(et,"number",et.value)}switch(yt=J?na(J):window,n){case"focusin":(Rm(yt)||yt.contentEditable==="true")&&(ar=yt,lc=J,da=null);break;case"focusout":da=lc=ar=null;break;case"mousedown":uc=!0;break;case"contextmenu":case"mouseup":case"dragend":uc=!1,Nm(lt,c,rt);break;case"selectionchange":if(dT)break;case"keydown":case"keyup":Nm(lt,c,rt)}var wt;if(sc)t:{switch(n){case"compositionstart":var Nt="onCompositionStart";break t;case"compositionend":Nt="onCompositionEnd";break t;case"compositionupdate":Nt="onCompositionUpdate";break t}Nt=void 0}else rr?bm(n,c)&&(Nt="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(xm&&c.locale!=="ko"&&(rr||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&rr&&(wt=pm()):(Bn=rt,Ju="value"in Bn?Bn.value:Bn.textContent,rr=!0)),yt=pl(J,Nt),0<yt.length&&(Nt=new vm(Nt,n,null,c,rt),lt.push({event:Nt,listeners:yt}),wt?Nt.data=wt:(wt=Am(c),wt!==null&&(Nt.data=wt)))),(wt=iT?nT(n,c):sT(n,c))&&(Nt=pl(J,"onBeforeInput"),0<Nt.length&&(yt=new vm("onBeforeInput","beforeinput",null,c,rt),lt.push({event:yt,listeners:Nt}),yt.data=wt)),XT(lt,n,J,c,rt)}l0(lt,o)})}function Fa(n,o,c){return{instance:n,listener:o,currentTarget:c}}function pl(n,o){for(var c=o+"Capture",m=[];n!==null;){var E=n,x=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||x===null||(E=sa(n,c),E!=null&&m.unshift(Fa(n,E,x)),E=sa(n,o),E!=null&&m.push(Fa(n,E,x))),n.tag===3)return m;n=n.return}return[]}function JT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function c0(n,o,c,m,E){for(var x=o._reactName,L=[];c!==null&&c!==m;){var I=c,U=I.alternate,J=I.stateNode;if(I=I.tag,U!==null&&U===m)break;I!==5&&I!==26&&I!==27||J===null||(U=J,E?(J=sa(c,x),J!=null&&L.unshift(Fa(c,J,U))):E||(J=sa(c,x),J!=null&&L.push(Fa(c,J,U)))),c=c.return}L.length!==0&&n.push({event:o,listeners:L})}var tb=/\r\n?/g,eb=/\u0000|\uFFFD/g;function f0(n){return(typeof n=="string"?n:""+n).replace(tb,`
`).replace(eb,"")}function d0(n,o){return o=f0(o),f0(n)===o}function qt(n,o,c,m,E,x){switch(c){case"children":typeof m=="string"?o==="body"||o==="textarea"&&m===""||ir(n,m):(typeof m=="number"||typeof m=="bigint")&&o!=="body"&&ir(n,""+m);break;case"className":Eo(n,"class",m);break;case"tabIndex":Eo(n,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Eo(n,c,m);break;case"style":dm(n,m,x);break;case"data":if(o!=="object"){Eo(n,"data",m);break}case"src":case"href":if(m===""&&(o!=="a"||c!=="href")){n.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=So(""+m),n.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&qt(n,o,"name",E.name,E,null),qt(n,o,"formEncType",E.formEncType,E,null),qt(n,o,"formMethod",E.formMethod,E,null),qt(n,o,"formTarget",E.formTarget,E,null)):(qt(n,o,"encType",E.encType,E,null),qt(n,o,"method",E.method,E,null),qt(n,o,"target",E.target,E,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(c);break}m=So(""+m),n.setAttribute(c,m);break;case"onClick":m!=null&&(n.onclick=cn);break;case"onScroll":m!=null&&Mt("scroll",n);break;case"onScrollEnd":m!=null&&Mt("scrollend",n);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(E.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"multiple":n.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":n.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){n.removeAttribute("xlink:href");break}c=So(""+m),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""+m):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":m===!0?n.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(c,m):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?n.setAttribute(c,m):n.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?n.removeAttribute(c):n.setAttribute(c,m);break;case"popover":Mt("beforetoggle",n),Mt("toggle",n),vo(n,"popover",m);break;case"xlinkActuate":un(n,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":un(n,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":un(n,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":un(n,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":un(n,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":un(n,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":un(n,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":un(n,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":un(n,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":vo(n,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=wS.get(c)||c,vo(n,c,m))}}function Pf(n,o,c,m,E,x){switch(c){case"style":dm(n,m,x);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(E.children!=null)throw Error(i(60));n.innerHTML=c}}break;case"children":typeof m=="string"?ir(n,m):(typeof m=="number"||typeof m=="bigint")&&ir(n,""+m);break;case"onScroll":m!=null&&Mt("scroll",n);break;case"onScrollEnd":m!=null&&Mt("scrollend",n);break;case"onClick":m!=null&&(n.onclick=cn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nm.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(E=c.endsWith("Capture"),o=c.slice(2,E?c.length-7:void 0),x=n[Ye]||null,x=x!=null?x[c]:null,typeof x=="function"&&n.removeEventListener(o,x,E),typeof m=="function")){typeof x!="function"&&x!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(o,m,E);break t}c in n?n[c]=m:m===!0?n.setAttribute(c,""):vo(n,c,m)}}}function Ne(n,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",n),Mt("load",n);var m=!1,E=!1,x;for(x in c)if(c.hasOwnProperty(x)){var L=c[x];if(L!=null)switch(x){case"src":m=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:qt(n,o,x,L,c,null)}}E&&qt(n,o,"srcSet",c.srcSet,c,null),m&&qt(n,o,"src",c.src,c,null);return;case"input":Mt("invalid",n);var I=x=L=E=null,U=null,J=null;for(m in c)if(c.hasOwnProperty(m)){var rt=c[m];if(rt!=null)switch(m){case"name":E=rt;break;case"type":L=rt;break;case"checked":U=rt;break;case"defaultChecked":J=rt;break;case"value":x=rt;break;case"defaultValue":I=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(i(137,o));break;default:qt(n,o,m,rt,c,null)}}lm(n,x,I,U,J,L,E,!1);return;case"select":Mt("invalid",n),m=L=x=null;for(E in c)if(c.hasOwnProperty(E)&&(I=c[E],I!=null))switch(E){case"value":x=I;break;case"defaultValue":L=I;break;case"multiple":m=I;default:qt(n,o,E,I,c,null)}o=x,c=L,n.multiple=!!m,o!=null?er(n,!!m,o,!1):c!=null&&er(n,!!m,c,!0);return;case"textarea":Mt("invalid",n),x=E=m=null;for(L in c)if(c.hasOwnProperty(L)&&(I=c[L],I!=null))switch(L){case"value":m=I;break;case"defaultValue":E=I;break;case"children":x=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:qt(n,o,L,I,c,null)}cm(n,m,E,x);return;case"option":for(U in c)if(c.hasOwnProperty(U)&&(m=c[U],m!=null))switch(U){case"selected":n.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:qt(n,o,U,m,c,null)}return;case"dialog":Mt("beforetoggle",n),Mt("toggle",n),Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":Mt("load",n);break;case"video":case"audio":for(m=0;m<Na.length;m++)Mt(Na[m],n);break;case"image":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"embed":case"source":case"link":Mt("error",n),Mt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in c)if(c.hasOwnProperty(J)&&(m=c[J],m!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:qt(n,o,J,m,c,null)}return;default:if(Yu(o)){for(rt in c)c.hasOwnProperty(rt)&&(m=c[rt],m!==void 0&&Pf(n,o,rt,m,c,void 0));return}}for(I in c)c.hasOwnProperty(I)&&(m=c[I],m!=null&&qt(n,o,I,m,c,null))}function ib(n,o,c,m){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,x=null,L=null,I=null,U=null,J=null,rt=null;for(it in c){var lt=c[it];if(c.hasOwnProperty(it)&&lt!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":U=lt;default:m.hasOwnProperty(it)||qt(n,o,it,null,m,lt)}}for(var et in m){var it=m[et];if(lt=c[et],m.hasOwnProperty(et)&&(it!=null||lt!=null))switch(et){case"type":x=it;break;case"name":E=it;break;case"checked":J=it;break;case"defaultChecked":rt=it;break;case"value":L=it;break;case"defaultValue":I=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(i(137,o));break;default:it!==lt&&qt(n,o,et,it,m,lt)}}Ku(n,L,I,U,J,rt,x,E);return;case"select":it=L=I=et=null;for(x in c)if(U=c[x],c.hasOwnProperty(x)&&U!=null)switch(x){case"value":break;case"multiple":it=U;default:m.hasOwnProperty(x)||qt(n,o,x,null,m,U)}for(E in m)if(x=m[E],U=c[E],m.hasOwnProperty(E)&&(x!=null||U!=null))switch(E){case"value":et=x;break;case"defaultValue":I=x;break;case"multiple":L=x;default:x!==U&&qt(n,o,E,x,m,U)}o=I,c=L,m=it,et!=null?er(n,!!c,et,!1):!!m!=!!c&&(o!=null?er(n,!!c,o,!0):er(n,!!c,c?[]:"",!1));return;case"textarea":it=et=null;for(I in c)if(E=c[I],c.hasOwnProperty(I)&&E!=null&&!m.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:qt(n,o,I,null,m,E)}for(L in m)if(E=m[L],x=c[L],m.hasOwnProperty(L)&&(E!=null||x!=null))switch(L){case"value":et=E;break;case"defaultValue":it=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:E!==x&&qt(n,o,L,E,m,x)}um(n,et,it);return;case"option":for(var gt in c)if(et=c[gt],c.hasOwnProperty(gt)&&et!=null&&!m.hasOwnProperty(gt))switch(gt){case"selected":n.selected=!1;break;default:qt(n,o,gt,null,m,et)}for(U in m)if(et=m[U],it=c[U],m.hasOwnProperty(U)&&et!==it&&(et!=null||it!=null))switch(U){case"selected":n.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:qt(n,o,U,et,m,it)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var St in c)et=c[St],c.hasOwnProperty(St)&&et!=null&&!m.hasOwnProperty(St)&&qt(n,o,St,null,m,et);for(J in m)if(et=m[J],it=c[J],m.hasOwnProperty(J)&&et!==it&&(et!=null||it!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(i(137,o));break;default:qt(n,o,J,et,m,it)}return;default:if(Yu(o)){for(var Yt in c)et=c[Yt],c.hasOwnProperty(Yt)&&et!==void 0&&!m.hasOwnProperty(Yt)&&Pf(n,o,Yt,void 0,m,et);for(rt in m)et=m[rt],it=c[rt],!m.hasOwnProperty(rt)||et===it||et===void 0&&it===void 0||Pf(n,o,rt,et,m,it);return}}for(var q in c)et=c[q],c.hasOwnProperty(q)&&et!=null&&!m.hasOwnProperty(q)&&qt(n,o,q,null,m,et);for(lt in m)et=m[lt],it=c[lt],!m.hasOwnProperty(lt)||et===it||et==null&&it==null||qt(n,o,lt,et,m,it)}function h0(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,o=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var E=c[m],x=E.transferSize,L=E.initiatorType,I=E.duration;if(x&&I&&h0(L)){for(L=0,I=E.responseEnd,m+=1;m<c.length;m++){var U=c[m],J=U.startTime;if(J>I)break;var rt=U.transferSize,lt=U.initiatorType;rt&&h0(lt)&&(U=U.responseEnd,L+=rt*(U<I?1:(I-J)/(U-J)))}if(--m,o+=8*(x+L)/(E.duration/1e3),n++,10<n)break}}if(0<n)return o/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Nf=null,Ff=null;function gl(n){return n.nodeType===9?n:n.ownerDocument}function m0(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function p0(n,o){if(n===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&o==="foreignObject"?0:n}function Bf(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Uf=null;function sb(){var n=window.event;return n&&n.type==="popstate"?n===Uf?!1:(Uf=n,!0):(Uf=null,!1)}var g0=typeof setTimeout=="function"?setTimeout:void 0,rb=typeof clearTimeout=="function"?clearTimeout:void 0,y0=typeof Promise=="function"?Promise:void 0,ab=typeof queueMicrotask=="function"?queueMicrotask:typeof y0<"u"?function(n){return y0.resolve(null).then(n).catch(ob)}:g0;function ob(n){setTimeout(function(){throw n})}function es(n){return n==="head"}function v0(n,o){var c=o,m=0;do{var E=c.nextSibling;if(n.removeChild(c),E&&E.nodeType===8)if(c=E.data,c==="/$"||c==="/&"){if(m===0){n.removeChild(E),kr(o);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")Ba(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Ba(c);for(var x=c.firstChild;x;){var L=x.nextSibling,I=x.nodeName;x[ia]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=L}}else c==="body"&&Ba(n.ownerDocument.body);c=E}while(c);kr(o)}function E0(n,o){var c=n;n=0;do{var m=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=m}while(c)}function $f(n){var o=n.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":$f(c),zu(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function lb(n,o,c,m){for(;n.nodeType===1;){var E=c;if(n.nodeName.toLowerCase()!==o.toLowerCase()){if(!m&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(m){if(!n[ia])switch(o){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(x=n.getAttribute("rel"),x==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(x!==E.rel||n.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||n.getAttribute("title")!==(E.title==null?null:E.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(x=n.getAttribute("src"),(x!==(E.src==null?null:E.src)||n.getAttribute("type")!==(E.type==null?null:E.type)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&x&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(o==="input"&&n.type==="hidden"){var x=E.name==null?null:""+E.name;if(E.type==="hidden"&&n.getAttribute("name")===x)return n}else return n;if(n=Ri(n.nextSibling),n===null)break}return null}function ub(n,o,c){if(o==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=Ri(n.nextSibling),n===null))return null;return n}function x0(n,o){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Ri(n.nextSibling),n===null))return null;return n}function jf(n){return n.data==="$?"||n.data==="$~"}function Gf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function cb(n,o){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=o;else if(n.data!=="$?"||c.readyState!=="loading")o();else{var m=function(){o(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),n._reactRetry=m}}function Ri(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return n}var Hf=null;function S0(n){n=n.nextSibling;for(var o=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(o===0)return Ri(n.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}n=n.nextSibling}return null}function T0(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return n;o--}else c!=="/$"&&c!=="/&"||o++}n=n.previousSibling}return null}function b0(n,o,c){switch(o=gl(c),n){case"html":if(n=o.documentElement,!n)throw Error(i(452));return n;case"head":if(n=o.head,!n)throw Error(i(453));return n;case"body":if(n=o.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Ba(n){for(var o=n.attributes;o.length;)n.removeAttributeNode(o[0]);zu(n)}var Li=new Map,A0=new Set;function yl(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ln=j.d;j.d={f:fb,r:db,D:hb,C:mb,L:pb,m:gb,X:vb,S:yb,M:Eb};function fb(){var n=Ln.f(),o=ll();return n||o}function db(n){var o=Zs(n);o!==null&&o.tag===5&&o.type==="form"?jp(o):Ln.r(n)}var Dr=typeof document>"u"?null:document;function R0(n,o,c){var m=Dr;if(m&&typeof o=="string"&&o){var E=vi(o);E='link[rel="'+n+'"][href="'+E+'"]',typeof c=="string"&&(E+='[crossorigin="'+c+'"]'),A0.has(E)||(A0.add(E),n={rel:n,crossOrigin:c,href:o},m.querySelector(E)===null&&(o=m.createElement("link"),Ne(o,"link",n),_e(o),m.head.appendChild(o)))}}function hb(n){Ln.D(n),R0("dns-prefetch",n,null)}function mb(n,o){Ln.C(n,o),R0("preconnect",n,o)}function pb(n,o,c){Ln.L(n,o,c);var m=Dr;if(m&&n&&o){var E='link[rel="preload"][as="'+vi(o)+'"]';o==="image"&&c&&c.imageSrcSet?(E+='[imagesrcset="'+vi(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(E+='[imagesizes="'+vi(c.imageSizes)+'"]')):E+='[href="'+vi(n)+'"]';var x=E;switch(o){case"style":x=Ir(n);break;case"script":x=Or(n)}Li.has(x)||(n=p({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:n,as:o},c),Li.set(x,n),m.querySelector(E)!==null||o==="style"&&m.querySelector(Ua(x))||o==="script"&&m.querySelector($a(x))||(o=m.createElement("link"),Ne(o,"link",n),_e(o),m.head.appendChild(o)))}}function gb(n,o){Ln.m(n,o);var c=Dr;if(c&&n){var m=o&&typeof o.as=="string"?o.as:"script",E='link[rel="modulepreload"][as="'+vi(m)+'"][href="'+vi(n)+'"]',x=E;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Or(n)}if(!Li.has(x)&&(n=p({rel:"modulepreload",href:n},o),Li.set(x,n),c.querySelector(E)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector($a(x)))return}m=c.createElement("link"),Ne(m,"link",n),_e(m),c.head.appendChild(m)}}}function yb(n,o,c){Ln.S(n,o,c);var m=Dr;if(m&&n){var E=Js(m).hoistableStyles,x=Ir(n);o=o||"default";var L=E.get(x);if(!L){var I={loading:0,preload:null};if(L=m.querySelector(Ua(x)))I.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":o},c),(c=Li.get(x))&&zf(n,c);var U=L=m.createElement("link");_e(U),Ne(U,"link",n),U._p=new Promise(function(J,rt){U.onload=J,U.onerror=rt}),U.addEventListener("load",function(){I.loading|=1}),U.addEventListener("error",function(){I.loading|=2}),I.loading|=4,vl(L,o,m)}L={type:"stylesheet",instance:L,count:1,state:I},E.set(x,L)}}}function vb(n,o){Ln.X(n,o);var c=Dr;if(c&&n){var m=Js(c).hoistableScripts,E=Or(n),x=m.get(E);x||(x=c.querySelector($a(E)),x||(n=p({src:n,async:!0},o),(o=Li.get(E))&&Vf(n,o),x=c.createElement("script"),_e(x),Ne(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},m.set(E,x))}}function Eb(n,o){Ln.M(n,o);var c=Dr;if(c&&n){var m=Js(c).hoistableScripts,E=Or(n),x=m.get(E);x||(x=c.querySelector($a(E)),x||(n=p({src:n,async:!0,type:"module"},o),(o=Li.get(E))&&Vf(n,o),x=c.createElement("script"),_e(x),Ne(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},m.set(E,x))}}function L0(n,o,c,m){var E=(E=dt.current)?yl(E):null;if(!E)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Ir(c.href),c=Js(E).hoistableStyles,m=c.get(o),m||(m={type:"style",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=Ir(c.href);var x=Js(E).hoistableStyles,L=x.get(n);if(L||(E=E.ownerDocument||E,L={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(n,L),(x=E.querySelector(Ua(n)))&&!x._p&&(L.instance=x,L.state.loading=5),Li.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Li.set(n,c),x||xb(E,n,c,L.state))),o&&m===null)throw Error(i(528,""));return L}if(o&&m!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Or(c),c=Js(E).hoistableScripts,m=c.get(o),m||(m={type:"script",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Ir(n){return'href="'+vi(n)+'"'}function Ua(n){return'link[rel="stylesheet"]['+n+"]"}function _0(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function xb(n,o,c,m){n.querySelector('link[rel="preload"][as="style"]['+o+"]")?m.loading=1:(o=n.createElement("link"),m.preload=o,o.addEventListener("load",function(){return m.loading|=1}),o.addEventListener("error",function(){return m.loading|=2}),Ne(o,"link",c),_e(o),n.head.appendChild(o))}function Or(n){return'[src="'+vi(n)+'"]'}function $a(n){return"script[async]"+n}function C0(n,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var m=n.querySelector('style[data-href~="'+vi(c.href)+'"]');if(m)return o.instance=m,_e(m),m;var E=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(n.ownerDocument||n).createElement("style"),_e(m),Ne(m,"style",E),vl(m,c.precedence,n),o.instance=m;case"stylesheet":E=Ir(c.href);var x=n.querySelector(Ua(E));if(x)return o.state.loading|=4,o.instance=x,_e(x),x;m=_0(c),(E=Li.get(E))&&zf(m,E),x=(n.ownerDocument||n).createElement("link"),_e(x);var L=x;return L._p=new Promise(function(I,U){L.onload=I,L.onerror=U}),Ne(x,"link",m),o.state.loading|=4,vl(x,c.precedence,n),o.instance=x;case"script":return x=Or(c.src),(E=n.querySelector($a(x)))?(o.instance=E,_e(E),E):(m=c,(E=Li.get(x))&&(m=p({},c),Vf(m,E)),n=n.ownerDocument||n,E=n.createElement("script"),_e(E),Ne(E,"link",m),n.head.appendChild(E),o.instance=E);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(m=o.instance,o.state.loading|=4,vl(m,c.precedence,n));return o.instance}function vl(n,o,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=m.length?m[m.length-1]:null,x=E,L=0;L<m.length;L++){var I=m[L];if(I.dataset.precedence===o)x=I;else if(x!==E)break}x?x.parentNode.insertBefore(n,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(n,o.firstChild))}function zf(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.title==null&&(n.title=o.title)}function Vf(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.integrity==null&&(n.integrity=o.integrity)}var El=null;function w0(n,o,c){if(El===null){var m=new Map,E=El=new Map;E.set(c,m)}else E=El,m=E.get(c),m||(m=new Map,E.set(c,m));if(m.has(n))return m;for(m.set(n,null),c=c.getElementsByTagName(n),E=0;E<c.length;E++){var x=c[E];if(!(x[ia]||x[Oe]||n==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var L=x.getAttribute(o)||"";L=n+L;var I=m.get(L);I?I.push(x):m.set(L,[x])}}return m}function D0(n,o,c){n=n.ownerDocument||n,n.head.insertBefore(c,o==="title"?n.querySelector("head > title"):null)}function Sb(n,o,c){if(c===1||o.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return n=o.disabled,typeof o.precedence=="string"&&n==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function I0(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function Tb(n,o,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var E=Ir(m.href),x=o.querySelector(Ua(E));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(n.count++,n=xl.bind(n),o.then(n,n)),c.state.loading|=4,c.instance=x,_e(x);return}x=o.ownerDocument||o,m=_0(m),(E=Li.get(E))&&zf(m,E),x=x.createElement("link"),_e(x);var L=x;L._p=new Promise(function(I,U){L.onload=I,L.onerror=U}),Ne(x,"link",m),c.instance=x}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=xl.bind(n),o.addEventListener("load",c),o.addEventListener("error",c))}}var Kf=0;function bb(n,o){return n.stylesheets&&n.count===0&&Tl(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var m=setTimeout(function(){if(n.stylesheets&&Tl(n,n.stylesheets),n.unsuspend){var x=n.unsuspend;n.unsuspend=null,x()}},6e4+o);0<n.imgBytes&&Kf===0&&(Kf=62500*nb());var E=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Tl(n,n.stylesheets),n.unsuspend)){var x=n.unsuspend;n.unsuspend=null,x()}},(n.imgBytes>Kf?50:800)+o);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(m),clearTimeout(E)}}:null}function xl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tl(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Sl=null;function Tl(n,o){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Sl=new Map,o.forEach(Ab,n),Sl=null,xl.call(n))}function Ab(n,o){if(!(o.state.loading&4)){var c=Sl.get(n);if(c)var m=c.get(null);else{c=new Map,Sl.set(n,c);for(var E=n.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<E.length;x++){var L=E[x];(L.nodeName==="LINK"||L.getAttribute("media")!=="not all")&&(c.set(L.dataset.precedence,L),m=L)}m&&c.set(null,m)}E=o.instance,L=E.getAttribute("data-precedence"),x=c.get(L)||m,x===m&&c.set(null,E),c.set(L,E),this.count++,m=xl.bind(this),E.addEventListener("load",m),E.addEventListener("error",m),x?x.parentNode.insertBefore(E,x.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(E,n.firstChild)),o.state.loading|=4}}var ja={$$typeof:R,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Rb(n,o,c,m,E,x,L,I,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$u(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$u(0),this.hiddenUpdates=$u(null),this.identifierPrefix=m,this.onUncaughtError=E,this.onCaughtError=x,this.onRecoverableError=L,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function O0(n,o,c,m,E,x,L,I,U,J,rt,lt){return n=new Rb(n,o,c,L,U,J,rt,lt,I),o=1,x===!0&&(o|=24),x=si(3,null,null,o),n.current=x,x.stateNode=n,o=Ac(),o.refCount++,n.pooledCache=o,o.refCount++,x.memoizedState={element:m,isDehydrated:c,cache:o},Cc(x),n}function k0(n){return n?(n=ur,n):ur}function M0(n,o,c,m,E,x){E=k0(E),m.context===null?m.context=E:m.pendingContext=E,m=zn(o),m.payload={element:c},x=x===void 0?null:x,x!==null&&(m.callback=x),c=Vn(n,m,o),c!==null&&(ti(c,n,o),Ea(c,n,o))}function P0(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<o?c:o}}function qf(n,o){P0(n,o),(n=n.alternate)&&P0(n,o)}function N0(n){if(n.tag===13||n.tag===31){var o=bs(n,67108864);o!==null&&ti(o,n,67108864),qf(n,67108864)}}function F0(n){if(n.tag===13||n.tag===31){var o=ui();o=ju(o);var c=bs(n,o);c!==null&&ti(c,n,o),qf(n,o)}}var bl=!0;function Lb(n,o,c,m){var E=O.T;O.T=null;var x=j.p;try{j.p=2,Yf(n,o,c,m)}finally{j.p=x,O.T=E}}function _b(n,o,c,m){var E=O.T;O.T=null;var x=j.p;try{j.p=8,Yf(n,o,c,m)}finally{j.p=x,O.T=E}}function Yf(n,o,c,m){if(bl){var E=Xf(m);if(E===null)Mf(n,o,m,Al,c),U0(n,m);else if(wb(E,n,o,c,m))m.stopPropagation();else if(U0(n,m),o&4&&-1<Cb.indexOf(n)){for(;E!==null;){var x=Zs(E);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var L=vs(x.pendingLanes);if(L!==0){var I=x;for(I.pendingLanes|=2,I.entangledLanes|=2;L;){var U=1<<31-He(L);I.entanglements[1]|=U,L&=~U}Gi(x),(jt&6)===0&&(al=ie()+500,Pa(0))}}break;case 31:case 13:I=bs(x,2),I!==null&&ti(I,x,2),ll(),qf(x,2)}if(x=Xf(m),x===null&&Mf(n,o,m,Al,c),x===E)break;E=x}E!==null&&m.stopPropagation()}else Mf(n,o,m,null,c)}}function Xf(n){return n=Wu(n),Wf(n)}var Al=null;function Wf(n){if(Al=null,n=Qs(n),n!==null){var o=a(n);if(o===null)n=null;else{var c=o.tag;if(c===13){if(n=l(o),n!==null)return n;n=null}else if(c===31){if(n=u(o),n!==null)return n;n=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}return Al=n,null}function B0(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(on()){case qe:return 2;case ps:return 8;case Nn:case Xs:return 32;case gs:return 268435456;default:return 32}default:return 32}}var Qf=!1,is=null,ns=null,ss=null,Ga=new Map,Ha=new Map,rs=[],Cb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function U0(n,o){switch(n){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":ns=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":Ga.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ha.delete(o.pointerId)}}function za(n,o,c,m,E,x){return n===null||n.nativeEvent!==x?(n={blockedOn:o,domEventName:c,eventSystemFlags:m,nativeEvent:x,targetContainers:[E]},o!==null&&(o=Zs(o),o!==null&&N0(o)),n):(n.eventSystemFlags|=m,o=n.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),n)}function wb(n,o,c,m,E){switch(o){case"focusin":return is=za(is,n,o,c,m,E),!0;case"dragenter":return ns=za(ns,n,o,c,m,E),!0;case"mouseover":return ss=za(ss,n,o,c,m,E),!0;case"pointerover":var x=E.pointerId;return Ga.set(x,za(Ga.get(x)||null,n,o,c,m,E)),!0;case"gotpointercapture":return x=E.pointerId,Ha.set(x,za(Ha.get(x)||null,n,o,c,m,E)),!0}return!1}function $0(n){var o=Qs(n.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){n.blockedOn=o,tm(n.priority,function(){F0(c)});return}}else if(o===31){if(o=u(c),o!==null){n.blockedOn=o,tm(n.priority,function(){F0(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Rl(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var c=Xf(n.nativeEvent);if(c===null){c=n.nativeEvent;var m=new c.constructor(c.type,c);Xu=m,c.target.dispatchEvent(m),Xu=null}else return o=Zs(c),o!==null&&N0(o),n.blockedOn=c,!1;o.shift()}return!0}function j0(n,o,c){Rl(n)&&c.delete(o)}function Db(){Qf=!1,is!==null&&Rl(is)&&(is=null),ns!==null&&Rl(ns)&&(ns=null),ss!==null&&Rl(ss)&&(ss=null),Ga.forEach(j0),Ha.forEach(j0)}function Ll(n,o){n.blockedOn===o&&(n.blockedOn=null,Qf||(Qf=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Db)))}var _l=null;function G0(n){_l!==n&&(_l=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){_l===n&&(_l=null);for(var o=0;o<n.length;o+=3){var c=n[o],m=n[o+1],E=n[o+2];if(typeof m!="function"){if(Wf(m||c)===null)continue;break}var x=Zs(c);x!==null&&(n.splice(o,3),o-=3,Yc(x,{pending:!0,data:E,method:c.method,action:m},m,E))}}))}function kr(n){function o(U){return Ll(U,n)}is!==null&&Ll(is,n),ns!==null&&Ll(ns,n),ss!==null&&Ll(ss,n),Ga.forEach(o),Ha.forEach(o);for(var c=0;c<rs.length;c++){var m=rs[c];m.blockedOn===n&&(m.blockedOn=null)}for(;0<rs.length&&(c=rs[0],c.blockedOn===null);)$0(c),c.blockedOn===null&&rs.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var E=c[m],x=c[m+1],L=E[Ye]||null;if(typeof x=="function")L||G0(c);else if(L){var I=null;if(x&&x.hasAttribute("formAction")){if(E=x,L=x[Ye]||null)I=L.formAction;else if(Wf(E)!==null)continue}else I=L.action;typeof I=="function"?c[m+1]=I:(c.splice(m,3),m-=3),G0(c)}}}function H0(){function n(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(L){return E=L})},focusReset:"manual",scroll:"manual"})}function o(){E!==null&&(E(),E=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,E=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),E!==null&&(E(),E=null)}}}function Zf(n){this._internalRoot=n}Cl.prototype.render=Zf.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,m=ui();M0(c,m,n,o,null,null)},Cl.prototype.unmount=Zf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;M0(n.current,2,null,n,null,null),ll(),o[Ws]=null}};function Cl(n){this._internalRoot=n}Cl.prototype.unstable_scheduleHydration=function(n){if(n){var o=Jh();n={blockedOn:null,target:n,priority:o};for(var c=0;c<rs.length&&o!==0&&o<rs[c].priority;c++);rs.splice(c,0,n),c===0&&$0(n)}};var z0=t.version;if(z0!=="19.2.0")throw Error(i(527,z0,"19.2.0"));j.findDOMNode=function(n){var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(o),n=n!==null?h(n):null,n=n===null?null:n.stateNode,n};var Ib={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{ys=wl.inject(Ib),Ge=wl}catch{}}return Ka.createRoot=function(n,o){if(!s(n))throw Error(i(299));var c=!1,m="",E=Qp,x=Zp,L=Jp;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(E=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError)),o=O0(n,1,!1,null,null,c,m,null,E,x,L,H0),n[Ws]=o.current,kf(n),new Zf(o)},Ka.hydrateRoot=function(n,o,c){if(!s(n))throw Error(i(299));var m=!1,E="",x=Qp,L=Zp,I=Jp,U=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(I=c.onRecoverableError),c.formState!==void 0&&(U=c.formState)),o=O0(n,1,!0,o,c??null,m,E,U,x,L,I,H0),o.context=k0(null),c=o.current,m=ui(),m=ju(m),E=zn(m),E.callback=null,Vn(c,E,m),c=m,o.current.lanes=c,ea(o,c),Gi(o),n[Ws]=o.current,kf(n),new Cl(o)},Ka.version="19.2.0",Ka}var ty;function zb(){if(ty)return ed.exports;ty=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),ed.exports=Hb(),ed.exports}var Vb=zb();function Kb({children:r}){return r}/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ey="popstate";function qb(r={}){function t(i,s){let{pathname:a,search:l,hash:u}=i.location;return Nd("",{pathname:a,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(i,s){return typeof s=="string"?s:Ja(s)}return Xb(t,e,null,r)}function ae(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Ji(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Yb(){return Math.random().toString(36).substring(2,10)}function iy(r,t){return{usr:r.state,key:r.key,idx:t}}function Nd(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Xr(t):t,state:e,key:t&&t.key||i||Yb()}}function Ja({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Xr(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function Xb(r,t,e,i={}){let{window:s=document.defaultView,v5Compat:a=!1}=i,l=s.history,u="POP",d=null,f=h();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function h(){return(l.state||{idx:null}).idx}function p(){u="POP";let T=h(),A=T==null?null:T-f;f=T,d&&d({action:u,location:S.location,delta:A})}function g(T,A){u="PUSH";let b=Nd(S.location,T,A);f=h()+1;let R=iy(b,f),C=S.createHref(b);try{l.pushState(R,"",C)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(C)}a&&d&&d({action:u,location:S.location,delta:1})}function y(T,A){u="REPLACE";let b=Nd(S.location,T,A);f=h();let R=iy(b,f),C=S.createHref(b);l.replaceState(R,"",C),a&&d&&d({action:u,location:S.location,delta:0})}function v(T){return Wb(T)}let S={get action(){return u},get location(){return r(s,l)},listen(T){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(ey,p),d=T,()=>{s.removeEventListener(ey,p),d=null}},createHref(T){return t(s,T)},createURL:v,encodeLocation(T){let A=v(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:g,replace:y,go(T){return l.go(T)}};return S}function Wb(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),ae(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:Ja(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function Gv(r,t,e="/"){return Qb(r,t,e,!1)}function Qb(r,t,e,i){let s=typeof t=="string"?Xr(t):t,a=kn(s.pathname||"/",e);if(a==null)return null;let l=Hv(r);Zb(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let f=u1(a);u=o1(l[d],f,i)}return u}function Hv(r,t=[],e=[],i="",s=!1){let a=(l,u,d=s,f)=>{let h={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(i)&&d)return;ae(h.relativePath.startsWith(i),`Absolute route path "${h.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(i.length)}let p=On([i,h.relativePath]),g=e.concat(h);l.children&&l.children.length>0&&(ae(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Hv(l.children,t,g,p,d)),!(l.path==null&&!l.index)&&t.push({path:p,score:r1(p,l.index),routesMeta:g})};return r.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))a(l,u);else for(let d of zv(l.path))a(l,u,!0,d)}),t}function zv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,s=e.endsWith("?"),a=e.replace(/\?$/,"");if(i.length===0)return s?[a,""]:[a];let l=zv(i.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&u.push(...l),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function Zb(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:a1(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var Jb=/^:[\w-]+$/,t1=3,e1=2,i1=1,n1=10,s1=-2,ny=r=>r==="*";function r1(r,t){let e=r.split("/"),i=e.length;return e.some(ny)&&(i+=s1),t&&(i+=e1),e.filter(s=>!ny(s)).reduce((s,a)=>s+(Jb.test(a)?t1:a===""?i1:n1),i)}function a1(r,t){return r.length===t.length&&r.slice(0,-1).every((i,s)=>i===t[s])?r[r.length-1]-t[t.length-1]:0}function o1(r,t,e=!1){let{routesMeta:i}=r,s={},a="/",l=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,h=a==="/"?t:t.slice(a.length)||"/",p=au({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},h),g=d.route;if(!p&&f&&e&&!i[i.length-1].route.index&&(p=au({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),l.push({params:s,pathname:On([a,p.pathname]),pathnameBase:h1(On([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=On([a,p.pathnameBase]))}return l}function au(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=l1(r.path,r.caseSensitive,r.end),s=t.match(e);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:i.reduce((f,{paramName:h,isOptional:p},g)=>{if(h==="*"){let v=u[g]||"";l=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const y=u[g];return p&&!y?f[h]=void 0:f[h]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:r}}function l1(r,t=!1,e=!0){Ji(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),i]}function u1(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ji(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function kn(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}function c1(r,t="/"){let{pathname:e,search:i="",hash:s=""}=typeof r=="string"?Xr(r):r;return{pathname:e?e.startsWith("/")?e:f1(e,t):t,search:m1(i),hash:p1(s)}}function f1(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function rd(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function d1(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Vv(r){let t=d1(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function Kv(r,t,e,i=!1){let s;typeof r=="string"?s=Xr(r):(s={...r},ae(!s.pathname||!s.pathname.includes("?"),rd("?","pathname","search",s)),ae(!s.pathname||!s.pathname.includes("#"),rd("#","pathname","hash",s)),ae(!s.search||!s.search.includes("#"),rd("#","search","hash",s)));let a=r===""||s.pathname==="",l=a?"/":s.pathname,u;if(l==null)u=e;else{let p=t.length-1;if(!i&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}u=p>=0?t[p]:"/"}let d=c1(s,u),f=l&&l!=="/"&&l.endsWith("/"),h=(a||l===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||h)&&(d.pathname+="/"),d}var On=r=>r.join("/").replace(/\/\/+/g,"/"),h1=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),m1=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,p1=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function g1(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var qv=["POST","PUT","PATCH","DELETE"];new Set(qv);var y1=["GET",...qv];new Set(y1);var Wr=F.createContext(null);Wr.displayName="DataRouter";var Au=F.createContext(null);Au.displayName="DataRouterState";F.createContext(!1);var Yv=F.createContext({isTransitioning:!1});Yv.displayName="ViewTransition";var v1=F.createContext(new Map);v1.displayName="Fetchers";var E1=F.createContext(null);E1.displayName="Await";var sn=F.createContext(null);sn.displayName="Navigation";var uo=F.createContext(null);uo.displayName="Location";var rn=F.createContext({outlet:null,matches:[],isDataRoute:!1});rn.displayName="Route";var uh=F.createContext(null);uh.displayName="RouteError";function x1(r,{relative:t}={}){ae(co(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=F.useContext(sn),{hash:s,pathname:a,search:l}=fo(r,{relative:t}),u=a;return e!=="/"&&(u=a==="/"?e:On([e,a])),i.createHref({pathname:u,search:l,hash:s})}function co(){return F.useContext(uo)!=null}function Ks(){return ae(co(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(uo).location}var Xv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wv(r){F.useContext(sn).static||F.useLayoutEffect(r)}function S1(){let{isDataRoute:r}=F.useContext(rn);return r?P1():T1()}function T1(){ae(co(),"useNavigate() may be used only in the context of a <Router> component.");let r=F.useContext(Wr),{basename:t,navigator:e}=F.useContext(sn),{matches:i}=F.useContext(rn),{pathname:s}=Ks(),a=JSON.stringify(Vv(i)),l=F.useRef(!1);return Wv(()=>{l.current=!0}),F.useCallback((d,f={})=>{if(Ji(l.current,Xv),!l.current)return;if(typeof d=="number"){e.go(d);return}let h=Kv(d,JSON.parse(a),s,f.relative==="path");r==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:On([t,h.pathname])),(f.replace?e.replace:e.push)(h,f.state,f)},[t,e,a,s,r])}F.createContext(null);function b1(){let{matches:r}=F.useContext(rn),t=r[r.length-1];return t?t.params:{}}function fo(r,{relative:t}={}){let{matches:e}=F.useContext(rn),{pathname:i}=Ks(),s=JSON.stringify(Vv(e));return F.useMemo(()=>Kv(r,JSON.parse(s),i,t==="path"),[r,s,i,t])}function A1(r,t){return Qv(r,t)}function Qv(r,t,e,i,s){ae(co(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=F.useContext(sn),{matches:l}=F.useContext(rn),u=l[l.length-1],d=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",p=u&&u.route;{let b=p&&p.path||"";Zv(f,!p||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let g=Ks(),y;if(t){let b=typeof t=="string"?Xr(t):t;ae(h==="/"||b.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${b.pathname}" was given in the \`location\` prop.`),y=b}else y=g;let v=y.pathname||"/",S=v;if(h!=="/"){let b=h.replace(/^\//,"").split("/");S="/"+v.replace(/^\//,"").split("/").slice(b.length).join("/")}let T=Gv(r,{pathname:S});Ji(p||T!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Ji(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=w1(T&&T.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:On([h,a.encodeLocation?a.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:On([h,a.encodeLocation?a.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),l,e,i,s);return t&&A?F.createElement(uo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},A):A}function R1(){let r=M1(),t=g1(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",r),l=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:a},"ErrorBoundary")," or"," ",F.createElement("code",{style:a},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},t),e?F.createElement("pre",{style:s},e):null,l)}var L1=F.createElement(R1,null),_1=class extends F.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.unstable_onError?this.props.unstable_onError(r,t):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?F.createElement(rn.Provider,{value:this.props.routeContext},F.createElement(uh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function C1({routeContext:r,match:t,children:e}){let i=F.useContext(Wr);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),F.createElement(rn.Provider,{value:r},e)}function w1(r,t=[],e=null,i=null,s=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,l=e?.errors;if(l!=null){let f=a.findIndex(h=>h.route.id&&l?.[h.route.id]!==void 0);ae(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(e)for(let f=0;f<a.length;f++){let h=a[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=f),h.route.id){let{loaderData:p,errors:g}=e,y=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||y){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,h,p)=>{let g,y=!1,v=null,S=null;e&&(g=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||L1,u&&(d<0&&p===0?(Zv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,S=null):d===p&&(y=!0,S=h.route.hydrateFallbackElement||null)));let T=t.concat(a.slice(0,p+1)),A=()=>{let b;return g?b=v:y?b=S:h.route.Component?b=F.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=f,F.createElement(C1,{match:h,routeContext:{outlet:f,matches:T,isDataRoute:e!=null},children:b})};return e&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?F.createElement(_1,{location:e.location,revalidation:e.revalidation,component:v,error:g,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:i}):A()},null)}function ch(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function D1(r){let t=F.useContext(Wr);return ae(t,ch(r)),t}function I1(r){let t=F.useContext(Au);return ae(t,ch(r)),t}function O1(r){let t=F.useContext(rn);return ae(t,ch(r)),t}function fh(r){let t=O1(r),e=t.matches[t.matches.length-1];return ae(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function k1(){return fh("useRouteId")}function M1(){let r=F.useContext(uh),t=I1("useRouteError"),e=fh("useRouteError");return r!==void 0?r:t.errors?.[e]}function P1(){let{router:r}=D1("useNavigate"),t=fh("useNavigate"),e=F.useRef(!1);return Wv(()=>{e.current=!0}),F.useCallback(async(s,a={})=>{Ji(e.current,Xv),e.current&&(typeof s=="number"?r.navigate(s):await r.navigate(s,{fromRouteId:t,...a}))},[r,t])}var sy={};function Zv(r,t,e){!t&&!sy[r]&&(sy[r]=!0,Ji(!1,e))}F.memo(N1);function N1({routes:r,future:t,state:e,unstable_onError:i}){return Qv(r,void 0,e,i,t)}function Jv(r){ae(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function F1({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:s,static:a=!1}){ae(!co(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),u=F.useMemo(()=>({basename:l,navigator:s,static:a,future:{}}),[l,s,a]);typeof e=="string"&&(e=Xr(e));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:g="default"}=e,y=F.useMemo(()=>{let v=kn(d,l);return v==null?null:{location:{pathname:v,search:f,hash:h,state:p,key:g},navigationType:i}},[l,d,f,h,p,g,i]);return Ji(y!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:F.createElement(sn.Provider,{value:u},F.createElement(uo.Provider,{children:t,value:y}))}function B1({children:r,location:t}){return A1(Fd(r),t)}function Fd(r,t=[]){let e=[];return F.Children.forEach(r,(i,s)=>{if(!F.isValidElement(i))return;let a=[...t,s];if(i.type===F.Fragment){e.push.apply(e,Fd(i.props.children,a));return}ae(i.type===Jv,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ae(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=Fd(i.props.children,a)),e.push(l)}),e}var Xl="get",Wl="application/x-www-form-urlencoded";function Ru(r){return r!=null&&typeof r.tagName=="string"}function U1(r){return Ru(r)&&r.tagName.toLowerCase()==="button"}function $1(r){return Ru(r)&&r.tagName.toLowerCase()==="form"}function j1(r){return Ru(r)&&r.tagName.toLowerCase()==="input"}function G1(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function H1(r,t){return r.button===0&&(!t||t==="_self")&&!G1(r)}var Dl=null;function z1(){if(Dl===null)try{new FormData(document.createElement("form"),0),Dl=!1}catch{Dl=!0}return Dl}var V1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ad(r){return r!=null&&!V1.has(r)?(Ji(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Wl}"`),null):r}function K1(r,t){let e,i,s,a,l;if($1(r)){let u=r.getAttribute("action");i=u?kn(u,t):null,e=r.getAttribute("method")||Xl,s=ad(r.getAttribute("enctype"))||Wl,a=new FormData(r)}else if(U1(r)||j1(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?kn(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Xl,s=ad(r.getAttribute("formenctype"))||ad(u.getAttribute("enctype"))||Wl,a=new FormData(u,r),!z1()){let{name:f,type:h,value:p}=r;if(h==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,p)}}else{if(Ru(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Xl,i=null,s=Wl,l=r}return a&&s==="text/plain"&&(l=a,a=void 0),{action:i,method:e.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dh(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function q1(r,t,e){let i=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return i.pathname==="/"?i.pathname=`_root.${e}`:t&&kn(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${e}`,i}async function Y1(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function X1(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function W1(r,t,e){let i=await Promise.all(r.map(async s=>{let a=t.routes[s.route.id];if(a){let l=await Y1(a,e);return l.links?l.links():[]}return[]}));return tA(i.flat(1).filter(X1).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ry(r,t,e,i,s,a){let l=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return a==="assets"?t.filter((d,f)=>l(d,f)||u(d,f)):a==="data"?t.filter((d,f)=>{let h=i.routes[d.route.id];if(!h||!h.hasLoader)return!1;if(l(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function Q1(r,t,{includeHydrateFallback:e}={}){return Z1(r.map(i=>{let s=t.routes[i.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function Z1(r){return[...new Set(r)]}function J1(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function tA(r,t){let e=new Set;return new Set(t),r.reduce((i,s)=>{let a=JSON.stringify(J1(s));return e.has(a)||(e.add(a),i.push({key:a,link:s})),i},[])}function tE(){let r=F.useContext(Wr);return dh(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function eA(){let r=F.useContext(Au);return dh(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var hh=F.createContext(void 0);hh.displayName="FrameworkContext";function eE(){let r=F.useContext(hh);return dh(r,"You must render this element inside a <HydratedRouter> element"),r}function iA(r,t){let e=F.useContext(hh),[i,s]=F.useState(!1),[a,l]=F.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=t,g=F.useRef(null);F.useEffect(()=>{if(r==="render"&&l(!0),r==="viewport"){let S=A=>{A.forEach(b=>{l(b.isIntersecting)})},T=new IntersectionObserver(S,{threshold:.5});return g.current&&T.observe(g.current),()=>{T.disconnect()}}},[r]),F.useEffect(()=>{if(i){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[i]);let y=()=>{s(!0)},v=()=>{s(!1),l(!1)};return e?r!=="intent"?[a,g,{}]:[a,g,{onFocus:qa(u,y),onBlur:qa(d,v),onMouseEnter:qa(f,y),onMouseLeave:qa(h,v),onTouchStart:qa(p,y)}]:[!1,g,{}]}function qa(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function nA({page:r,...t}){let{router:e}=tE(),i=F.useMemo(()=>Gv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?F.createElement(rA,{page:r,matches:i,...t}):null}function sA(r){let{manifest:t,routeModules:e}=eE(),[i,s]=F.useState([]);return F.useEffect(()=>{let a=!1;return W1(r,t,e).then(l=>{a||s(l)}),()=>{a=!0}},[r,t,e]),i}function rA({page:r,matches:t,...e}){let i=Ks(),{manifest:s,routeModules:a}=eE(),{basename:l}=tE(),{loaderData:u,matches:d}=eA(),f=F.useMemo(()=>ry(r,t,d,s,i,"data"),[r,t,d,s,i]),h=F.useMemo(()=>ry(r,t,d,s,i,"assets"),[r,t,d,s,i]),p=F.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let v=new Set,S=!1;if(t.forEach(A=>{let b=s.routes[A.route.id];!b||!b.hasLoader||(!f.some(R=>R.route.id===A.route.id)&&A.route.id in u&&a[A.route.id]?.shouldRevalidate||b.hasClientLoader?S=!0:v.add(A.route.id))}),v.size===0)return[];let T=q1(r,l,"data");return S&&v.size>0&&T.searchParams.set("_routes",t.filter(A=>v.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[l,u,i,s,f,t,r,a]),g=F.useMemo(()=>Q1(h,s),[h,s]),y=sA(h);return F.createElement(F.Fragment,null,p.map(v=>F.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...e})),g.map(v=>F.createElement("link",{key:v,rel:"modulepreload",href:v,...e})),y.map(({key:v,link:S})=>F.createElement("link",{key:v,nonce:e.nonce,...S})))}function aA(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var iE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iE&&(window.__reactRouterVersion="7.9.4")}catch{}function oA({basename:r,children:t,window:e}){let i=F.useRef();i.current==null&&(i.current=qb({window:e,v5Compat:!0}));let s=i.current,[a,l]=F.useState({action:s.action,location:s.location}),u=F.useCallback(d=>{F.startTransition(()=>l(d))},[l]);return F.useLayoutEffect(()=>s.listen(u),[s,u]),F.createElement(F1,{basename:r,children:t,location:a.location,navigationType:a.action,navigator:s})}var nE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ur=F.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:s,reloadDocument:a,replace:l,state:u,target:d,to:f,preventScrollReset:h,viewTransition:p,...g},y){let{basename:v}=F.useContext(sn),S=typeof f=="string"&&nE.test(f),T,A=!1;if(typeof f=="string"&&S&&(T=f,iE))try{let B=new URL(window.location.href),M=f.startsWith("//")?new URL(B.protocol+f):new URL(f),K=kn(M.pathname,v);M.origin===B.origin&&K!=null?f=K+M.search+M.hash:A=!0}catch{Ji(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=x1(f,{relative:s}),[R,C,D]=iA(i,g),N=fA(f,{replace:l,state:u,target:d,preventScrollReset:h,relative:s,viewTransition:p});function w(B){t&&t(B),B.defaultPrevented||N(B)}let P=F.createElement("a",{...g,...D,href:T||b,onClick:A||a?t:w,ref:aA(y,C),target:d,"data-discover":!S&&e==="render"?"true":void 0});return R&&!S?F.createElement(F.Fragment,null,P,F.createElement(nA,{page:b})):P});Ur.displayName="Link";var lA=F.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:s=!1,style:a,to:l,viewTransition:u,children:d,...f},h){let p=fo(l,{relative:f.relative}),g=Ks(),y=F.useContext(Au),{navigator:v,basename:S}=F.useContext(sn),T=y!=null&&gA(p)&&u===!0,A=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,b=g.pathname,R=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;e||(b=b.toLowerCase(),R=R?R.toLowerCase():null,A=A.toLowerCase()),R&&S&&(R=kn(R,S)||R);const C=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let D=b===A||!s&&b.startsWith(A)&&b.charAt(C)==="/",N=R!=null&&(R===A||!s&&R.startsWith(A)&&R.charAt(A.length)==="/"),w={isActive:D,isPending:N,isTransitioning:T},P=D?t:void 0,B;typeof i=="function"?B=i(w):B=[i,D?"active":null,N?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(w):a;return F.createElement(Ur,{...f,"aria-current":P,className:B,ref:h,style:M,to:l,viewTransition:u},typeof d=="function"?d(w):d)});lA.displayName="NavLink";var uA=F.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:s,state:a,method:l=Xl,action:u,onSubmit:d,relative:f,preventScrollReset:h,viewTransition:p,...g},y)=>{let v=mA(),S=pA(u,{relative:f}),T=l.toLowerCase()==="get"?"get":"post",A=typeof u=="string"&&nE.test(u),b=R=>{if(d&&d(R),R.defaultPrevented)return;R.preventDefault();let C=R.nativeEvent.submitter,D=C?.getAttribute("formmethod")||l;v(C||R.currentTarget,{fetcherKey:t,method:D,navigate:e,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:p})};return F.createElement("form",{ref:y,method:T,action:S,onSubmit:i?d:b,...g,"data-discover":!A&&r==="render"?"true":void 0})});uA.displayName="Form";function cA(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sE(r){let t=F.useContext(Wr);return ae(t,cA(r)),t}function fA(r,{target:t,replace:e,state:i,preventScrollReset:s,relative:a,viewTransition:l}={}){let u=S1(),d=Ks(),f=fo(r,{relative:a});return F.useCallback(h=>{if(H1(h,t)){h.preventDefault();let p=e!==void 0?e:Ja(d)===Ja(f);u(r,{replace:p,state:i,preventScrollReset:s,relative:a,viewTransition:l})}},[d,u,f,e,i,t,r,s,a,l])}var dA=0,hA=()=>`__${String(++dA)}__`;function mA(){let{router:r}=sE("useSubmit"),{basename:t}=F.useContext(sn),e=k1();return F.useCallback(async(i,s={})=>{let{action:a,method:l,encType:u,formData:d,body:f}=K1(i,t);if(s.navigate===!1){let h=s.fetcherKey||hA();await r.fetch(h,e,s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:f,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await r.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:f,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,t,e])}function pA(r,{relative:t}={}){let{basename:e}=F.useContext(sn),i=F.useContext(rn);ae(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),a={...fo(r||".",{relative:t})},l=Ks();if(r==null){a.search=l.search;let u=new URLSearchParams(a.search),d=u.getAll("index");if(d.some(h=>h==="")){u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let h=u.toString();a.search=h?`?${h}`:""}}return(!r||r===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:On([e,a.pathname])),Ja(a)}function gA(r,{relative:t}={}){let e=F.useContext(Yv);ae(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=sE("useViewTransitionState"),s=fo(r,{relative:t});if(!e.isTransitioning)return!1;let a=kn(e.currentLocation.pathname,i)||e.currentLocation.pathname,l=kn(e.nextLocation.pathname,i)||e.nextLocation.pathname;return au(s.pathname,l)!=null||au(s.pathname,a)!=null}var mh=jv();const yA=oh(mh);var od={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var ay;function vA(){return ay||(ay=1,(function(r){(function(){var t={}.hasOwnProperty;function e(){for(var a="",l=0;l<arguments.length;l++){var u=arguments[l];u&&(a=s(a,i.call(this,u)))}return a}function i(a){if(typeof a=="string"||typeof a=="number")return this&&this[a]||a;if(typeof a!="object")return"";if(Array.isArray(a))return e.apply(this,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var l="";for(var u in a)t.call(a,u)&&a[u]&&(l=s(l,this&&this[u]||u));return l}function s(a,l){return l?a?a+" "+l:a+l:a}r.exports?(e.default=e,r.exports=e):window.classNames=e})()})(od)),od.exports}var EA=vA();const qs=oh(EA),xA="_slide_1o53q_1",SA={slide:xA,"slide-title":"_slide-title_1o53q_7","title-text":"_title-text_1o53q_16","title-info":"_title-info_1o53q_23","slide-wrapper":"_slide-wrapper_1o53q_43","slide-content":"_slide-content_1o53q_49","slide-group":"_slide-group_1o53q_54","slide-nav":"_slide-nav_1o53q_63","slide-nav-prev":"_slide-nav-prev_1o53q_84","slide-nav-next":"_slide-nav-next_1o53q_89"};function _i(r,t,{checkForDefaultPrevented:e=!0}={}){return function(s){if(r?.(s),e===!1||!s.defaultPrevented)return t?.(s)}}function rE(r,t=[]){let e=[];function i(a,l){const u=F.createContext(l),d=e.length;e=[...e,l];const f=p=>{const{scope:g,children:y,...v}=p,S=g?.[r]?.[d]||u,T=F.useMemo(()=>v,Object.values(v));return X.jsx(S.Provider,{value:T,children:y})};f.displayName=a+"Provider";function h(p,g){const y=g?.[r]?.[d]||u,v=F.useContext(y);if(v)return v;if(l!==void 0)return l;throw new Error(`\`${p}\` must be used within \`${a}\``)}return[f,h]}const s=()=>{const a=e.map(l=>F.createContext(l));return function(u){const d=u?.[r]||a;return F.useMemo(()=>({[`__scope${r}`]:{...u,[r]:d}}),[u,d])}};return s.scopeName=r,[i,TA(s,...t)]}function TA(...r){const t=r[0];if(r.length===1)return t;const e=()=>{const i=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const l=i.reduce((u,{useScope:d,scopeName:f})=>{const p=d(a)[`__scope${f}`];return{...u,...p}},{});return F.useMemo(()=>({[`__scope${t.scopeName}`]:l}),[l])}};return e.scopeName=t.scopeName,e}var Hs=globalThis?.document?F.useLayoutEffect:()=>{},bA=Ub[" useInsertionEffect ".trim().toString()]||Hs;function AA({prop:r,defaultProp:t,onChange:e=()=>{},caller:i}){const[s,a,l]=RA({defaultProp:t,onChange:e}),u=r!==void 0,d=u?r:s;{const h=F.useRef(r!==void 0);F.useEffect(()=>{const p=h.current;p!==u&&console.warn(`${i} is changing from ${p?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=u},[u,i])}const f=F.useCallback(h=>{if(u){const p=LA(h)?h(r):h;p!==r&&l.current?.(p)}else a(h)},[u,r,a,l]);return[d,f]}function RA({defaultProp:r,onChange:t}){const[e,i]=F.useState(r),s=F.useRef(e),a=F.useRef(t);return bA(()=>{a.current=t},[t]),F.useEffect(()=>{s.current!==e&&(a.current?.(e),s.current=e)},[e,s]),[e,i,a]}function LA(r){return typeof r=="function"}function oy(r,t){if(typeof r=="function")return r(t);r!=null&&(r.current=t)}function aE(...r){return t=>{let e=!1;const i=r.map(s=>{const a=oy(s,t);return!e&&typeof a=="function"&&(e=!0),a});if(e)return()=>{for(let s=0;s<i.length;s++){const a=i[s];typeof a=="function"?a():oy(r[s],null)}}}}function Qr(...r){return F.useCallback(aE(...r),r)}const _A=["top","right","bottom","left"],fs=Math.min,hi=Math.max,ou=Math.round,Il=Math.floor,Zi=r=>({x:r,y:r}),CA={left:"right",right:"left",bottom:"top",top:"bottom"},wA={start:"end",end:"start"};function Bd(r,t,e){return hi(r,fs(t,e))}function Mn(r,t){return typeof r=="function"?r(t):r}function Pn(r){return r.split("-")[0]}function Zr(r){return r.split("-")[1]}function ph(r){return r==="x"?"y":"x"}function gh(r){return r==="y"?"height":"width"}const DA=new Set(["top","bottom"]);function Xi(r){return DA.has(Pn(r))?"y":"x"}function yh(r){return ph(Xi(r))}function IA(r,t,e){e===void 0&&(e=!1);const i=Zr(r),s=yh(r),a=gh(s);let l=s==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(l=lu(l)),[l,lu(l)]}function OA(r){const t=lu(r);return[Ud(r),t,Ud(t)]}function Ud(r){return r.replace(/start|end/g,t=>wA[t])}const ly=["left","right"],uy=["right","left"],kA=["top","bottom"],MA=["bottom","top"];function PA(r,t,e){switch(r){case"top":case"bottom":return e?t?uy:ly:t?ly:uy;case"left":case"right":return t?kA:MA;default:return[]}}function NA(r,t,e,i){const s=Zr(r);let a=PA(Pn(r),e==="start",i);return s&&(a=a.map(l=>l+"-"+s),t&&(a=a.concat(a.map(Ud)))),a}function lu(r){return r.replace(/left|right|bottom|top/g,t=>CA[t])}function FA(r){return{top:0,right:0,bottom:0,left:0,...r}}function oE(r){return typeof r!="number"?FA(r):{top:r,right:r,bottom:r,left:r}}function uu(r){const{x:t,y:e,width:i,height:s}=r;return{width:i,height:s,top:e,left:t,right:t+i,bottom:e+s,x:t,y:e}}function cy(r,t,e){let{reference:i,floating:s}=r;const a=Xi(t),l=yh(t),u=gh(l),d=Pn(t),f=a==="y",h=i.x+i.width/2-s.width/2,p=i.y+i.height/2-s.height/2,g=i[u]/2-s[u]/2;let y;switch(d){case"top":y={x:h,y:i.y-s.height};break;case"bottom":y={x:h,y:i.y+i.height};break;case"right":y={x:i.x+i.width,y:p};break;case"left":y={x:i.x-s.width,y:p};break;default:y={x:i.x,y:i.y}}switch(Zr(t)){case"start":y[l]-=g*(e&&f?-1:1);break;case"end":y[l]+=g*(e&&f?-1:1);break}return y}const BA=async(r,t,e)=>{const{placement:i="bottom",strategy:s="absolute",middleware:a=[],platform:l}=e,u=a.filter(Boolean),d=await(l.isRTL==null?void 0:l.isRTL(t));let f=await l.getElementRects({reference:r,floating:t,strategy:s}),{x:h,y:p}=cy(f,i,d),g=i,y={},v=0;for(let S=0;S<u.length;S++){const{name:T,fn:A}=u[S],{x:b,y:R,data:C,reset:D}=await A({x:h,y:p,initialPlacement:i,placement:g,strategy:s,middlewareData:y,rects:f,platform:l,elements:{reference:r,floating:t}});h=b??h,p=R??p,y={...y,[T]:{...y[T],...C}},D&&v<=50&&(v++,typeof D=="object"&&(D.placement&&(g=D.placement),D.rects&&(f=D.rects===!0?await l.getElementRects({reference:r,floating:t,strategy:s}):D.rects),{x:h,y:p}=cy(f,g,d)),S=-1)}return{x:h,y:p,placement:g,strategy:s,middlewareData:y}};async function to(r,t){var e;t===void 0&&(t={});const{x:i,y:s,platform:a,rects:l,elements:u,strategy:d}=r,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:p="floating",altBoundary:g=!1,padding:y=0}=Mn(t,r),v=oE(y),T=u[g?p==="floating"?"reference":"floating":p],A=uu(await a.getClippingRect({element:(e=await(a.isElement==null?void 0:a.isElement(T)))==null||e?T:T.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(u.floating)),boundary:f,rootBoundary:h,strategy:d})),b=p==="floating"?{x:i,y:s,width:l.floating.width,height:l.floating.height}:l.reference,R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u.floating)),C=await(a.isElement==null?void 0:a.isElement(R))?await(a.getScale==null?void 0:a.getScale(R))||{x:1,y:1}:{x:1,y:1},D=uu(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:b,offsetParent:R,strategy:d}):b);return{top:(A.top-D.top+v.top)/C.y,bottom:(D.bottom-A.bottom+v.bottom)/C.y,left:(A.left-D.left+v.left)/C.x,right:(D.right-A.right+v.right)/C.x}}const UA=r=>({name:"arrow",options:r,async fn(t){const{x:e,y:i,placement:s,rects:a,platform:l,elements:u,middlewareData:d}=t,{element:f,padding:h=0}=Mn(r,t)||{};if(f==null)return{};const p=oE(h),g={x:e,y:i},y=yh(s),v=gh(y),S=await l.getDimensions(f),T=y==="y",A=T?"top":"left",b=T?"bottom":"right",R=T?"clientHeight":"clientWidth",C=a.reference[v]+a.reference[y]-g[y]-a.floating[v],D=g[y]-a.reference[y],N=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f));let w=N?N[R]:0;(!w||!await(l.isElement==null?void 0:l.isElement(N)))&&(w=u.floating[R]||a.floating[v]);const P=C/2-D/2,B=w/2-S[v]/2-1,M=fs(p[A],B),K=fs(p[b],B),tt=M,z=w-S[v]-K,G=w/2-S[v]/2+P,Y=Bd(tt,G,z),O=!d.arrow&&Zr(s)!=null&&G!==Y&&a.reference[v]/2-(G<tt?M:K)-S[v]/2<0,j=O?G<tt?G-tt:G-z:0;return{[y]:g[y]+j,data:{[y]:Y,centerOffset:G-Y-j,...O&&{alignmentOffset:j}},reset:O}}}),$A=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:s,middlewareData:a,rects:l,initialPlacement:u,platform:d,elements:f}=t,{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:S=!0,...T}=Mn(r,t);if((e=a.arrow)!=null&&e.alignmentOffset)return{};const A=Pn(s),b=Xi(u),R=Pn(u)===u,C=await(d.isRTL==null?void 0:d.isRTL(f.floating)),D=g||(R||!S?[lu(u)]:OA(u)),N=v!=="none";!g&&N&&D.push(...NA(u,S,v,C));const w=[u,...D],P=await to(t,T),B=[];let M=((i=a.flip)==null?void 0:i.overflows)||[];if(h&&B.push(P[A]),p){const G=IA(s,l,C);B.push(P[G[0]],P[G[1]])}if(M=[...M,{placement:s,overflows:B}],!B.every(G=>G<=0)){var K,tt;const G=(((K=a.flip)==null?void 0:K.index)||0)+1,Y=w[G];if(Y&&(!(p==="alignment"?b!==Xi(Y):!1)||M.every(V=>Xi(V.placement)===b?V.overflows[0]>0:!0)))return{data:{index:G,overflows:M},reset:{placement:Y}};let O=(tt=M.filter(j=>j.overflows[0]<=0).sort((j,V)=>j.overflows[1]-V.overflows[1])[0])==null?void 0:tt.placement;if(!O)switch(y){case"bestFit":{var z;const j=(z=M.filter(V=>{if(N){const nt=Xi(V.placement);return nt===b||nt==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(nt=>nt>0).reduce((nt,ut)=>nt+ut,0)]).sort((V,nt)=>V[1]-nt[1])[0])==null?void 0:z[0];j&&(O=j);break}case"initialPlacement":O=u;break}if(s!==O)return{reset:{placement:O}}}return{}}}};function fy(r,t){return{top:r.top-t.height,right:r.right-t.width,bottom:r.bottom-t.height,left:r.left-t.width}}function dy(r){return _A.some(t=>r[t]>=0)}const jA=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(t){const{rects:e}=t,{strategy:i="referenceHidden",...s}=Mn(r,t);switch(i){case"referenceHidden":{const a=await to(t,{...s,elementContext:"reference"}),l=fy(a,e.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:dy(l)}}}case"escaped":{const a=await to(t,{...s,altBoundary:!0}),l=fy(a,e.floating);return{data:{escapedOffsets:l,escaped:dy(l)}}}default:return{}}}}},lE=new Set(["left","top"]);async function GA(r,t){const{placement:e,platform:i,elements:s}=r,a=await(i.isRTL==null?void 0:i.isRTL(s.floating)),l=Pn(e),u=Zr(e),d=Xi(e)==="y",f=lE.has(l)?-1:1,h=a&&d?-1:1,p=Mn(t,r);let{mainAxis:g,crossAxis:y,alignmentAxis:v}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return u&&typeof v=="number"&&(y=u==="end"?v*-1:v),d?{x:y*h,y:g*f}:{x:g*f,y:y*h}}const HA=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(t){var e,i;const{x:s,y:a,placement:l,middlewareData:u}=t,d=await GA(t,r);return l===((e=u.offset)==null?void 0:e.placement)&&(i=u.arrow)!=null&&i.alignmentOffset?{}:{x:s+d.x,y:a+d.y,data:{...d,placement:l}}}}},zA=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:s}=t,{mainAxis:a=!0,crossAxis:l=!1,limiter:u={fn:T=>{let{x:A,y:b}=T;return{x:A,y:b}}},...d}=Mn(r,t),f={x:e,y:i},h=await to(t,d),p=Xi(Pn(s)),g=ph(p);let y=f[g],v=f[p];if(a){const T=g==="y"?"top":"left",A=g==="y"?"bottom":"right",b=y+h[T],R=y-h[A];y=Bd(b,y,R)}if(l){const T=p==="y"?"top":"left",A=p==="y"?"bottom":"right",b=v+h[T],R=v-h[A];v=Bd(b,v,R)}const S=u.fn({...t,[g]:y,[p]:v});return{...S,data:{x:S.x-e,y:S.y-i,enabled:{[g]:a,[p]:l}}}}}},VA=function(r){return r===void 0&&(r={}),{options:r,fn(t){const{x:e,y:i,placement:s,rects:a,middlewareData:l}=t,{offset:u=0,mainAxis:d=!0,crossAxis:f=!0}=Mn(r,t),h={x:e,y:i},p=Xi(s),g=ph(p);let y=h[g],v=h[p];const S=Mn(u,t),T=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(d){const R=g==="y"?"height":"width",C=a.reference[g]-a.floating[R]+T.mainAxis,D=a.reference[g]+a.reference[R]-T.mainAxis;y<C?y=C:y>D&&(y=D)}if(f){var A,b;const R=g==="y"?"width":"height",C=lE.has(Pn(s)),D=a.reference[p]-a.floating[R]+(C&&((A=l.offset)==null?void 0:A[p])||0)+(C?0:T.crossAxis),N=a.reference[p]+a.reference[R]+(C?0:((b=l.offset)==null?void 0:b[p])||0)-(C?T.crossAxis:0);v<D?v=D:v>N&&(v=N)}return{[g]:y,[p]:v}}}},KA=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(t){var e,i;const{placement:s,rects:a,platform:l,elements:u}=t,{apply:d=()=>{},...f}=Mn(r,t),h=await to(t,f),p=Pn(s),g=Zr(s),y=Xi(s)==="y",{width:v,height:S}=a.floating;let T,A;p==="top"||p==="bottom"?(T=p,A=g===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(A=p,T=g==="end"?"top":"bottom");const b=S-h.top-h.bottom,R=v-h.left-h.right,C=fs(S-h[T],b),D=fs(v-h[A],R),N=!t.middlewareData.shift;let w=C,P=D;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(P=R),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(w=b),N&&!g){const M=hi(h.left,0),K=hi(h.right,0),tt=hi(h.top,0),z=hi(h.bottom,0);y?P=v-2*(M!==0||K!==0?M+K:hi(h.left,h.right)):w=S-2*(tt!==0||z!==0?tt+z:hi(h.top,h.bottom))}await d({...t,availableWidth:P,availableHeight:w});const B=await l.getDimensions(u.floating);return v!==B.width||S!==B.height?{reset:{rects:!0}}:{}}}};function Lu(){return typeof window<"u"}function Jr(r){return uE(r)?(r.nodeName||"").toLowerCase():"#document"}function pi(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function an(r){var t;return(t=(uE(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function uE(r){return Lu()?r instanceof Node||r instanceof pi(r).Node:!1}function Pi(r){return Lu()?r instanceof Element||r instanceof pi(r).Element:!1}function tn(r){return Lu()?r instanceof HTMLElement||r instanceof pi(r).HTMLElement:!1}function hy(r){return!Lu()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof pi(r).ShadowRoot}const qA=new Set(["inline","contents"]);function ho(r){const{overflow:t,overflowX:e,overflowY:i,display:s}=Ni(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!qA.has(s)}const YA=new Set(["table","td","th"]);function XA(r){return YA.has(Jr(r))}const WA=[":popover-open",":modal"];function _u(r){return WA.some(t=>{try{return r.matches(t)}catch{return!1}})}const QA=["transform","translate","scale","rotate","perspective"],ZA=["transform","translate","scale","rotate","perspective","filter"],JA=["paint","layout","strict","content"];function vh(r){const t=Eh(),e=Pi(r)?Ni(r):r;return QA.some(i=>e[i]?e[i]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||ZA.some(i=>(e.willChange||"").includes(i))||JA.some(i=>(e.contain||"").includes(i))}function tR(r){let t=ds(r);for(;tn(t)&&!Kr(t);){if(vh(t))return t;if(_u(t))return null;t=ds(t)}return null}function Eh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const eR=new Set(["html","body","#document"]);function Kr(r){return eR.has(Jr(r))}function Ni(r){return pi(r).getComputedStyle(r)}function Cu(r){return Pi(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function ds(r){if(Jr(r)==="html")return r;const t=r.assignedSlot||r.parentNode||hy(r)&&r.host||an(r);return hy(t)?t.host:t}function cE(r){const t=ds(r);return Kr(t)?r.ownerDocument?r.ownerDocument.body:r.body:tn(t)&&ho(t)?t:cE(t)}function eo(r,t,e){var i;t===void 0&&(t=[]),e===void 0&&(e=!0);const s=cE(r),a=s===((i=r.ownerDocument)==null?void 0:i.body),l=pi(s);if(a){const u=$d(l);return t.concat(l,l.visualViewport||[],ho(s)?s:[],u&&e?eo(u):[])}return t.concat(s,eo(s,[],e))}function $d(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function fE(r){const t=Ni(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=tn(r),a=s?r.offsetWidth:e,l=s?r.offsetHeight:i,u=ou(e)!==a||ou(i)!==l;return u&&(e=a,i=l),{width:e,height:i,$:u}}function xh(r){return Pi(r)?r:r.contextElement}function jr(r){const t=xh(r);if(!tn(t))return Zi(1);const e=t.getBoundingClientRect(),{width:i,height:s,$:a}=fE(t);let l=(a?ou(e.width):e.width)/i,u=(a?ou(e.height):e.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const iR=Zi(0);function dE(r){const t=pi(r);return!Eh()||!t.visualViewport?iR:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function nR(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==pi(r)?!1:t}function zs(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const s=r.getBoundingClientRect(),a=xh(r);let l=Zi(1);t&&(i?Pi(i)&&(l=jr(i)):l=jr(r));const u=nR(a,e,i)?dE(a):Zi(0);let d=(s.left+u.x)/l.x,f=(s.top+u.y)/l.y,h=s.width/l.x,p=s.height/l.y;if(a){const g=pi(a),y=i&&Pi(i)?pi(i):i;let v=g,S=$d(v);for(;S&&i&&y!==v;){const T=jr(S),A=S.getBoundingClientRect(),b=Ni(S),R=A.left+(S.clientLeft+parseFloat(b.paddingLeft))*T.x,C=A.top+(S.clientTop+parseFloat(b.paddingTop))*T.y;d*=T.x,f*=T.y,h*=T.x,p*=T.y,d+=R,f+=C,v=pi(S),S=$d(v)}}return uu({width:h,height:p,x:d,y:f})}function wu(r,t){const e=Cu(r).scrollLeft;return t?t.left+e:zs(an(r)).left+e}function hE(r,t){const e=r.getBoundingClientRect(),i=e.left+t.scrollLeft-wu(r,e),s=e.top+t.scrollTop;return{x:i,y:s}}function sR(r){let{elements:t,rect:e,offsetParent:i,strategy:s}=r;const a=s==="fixed",l=an(i),u=t?_u(t.floating):!1;if(i===l||u&&a)return e;let d={scrollLeft:0,scrollTop:0},f=Zi(1);const h=Zi(0),p=tn(i);if((p||!p&&!a)&&((Jr(i)!=="body"||ho(l))&&(d=Cu(i)),tn(i))){const y=zs(i);f=jr(i),h.x=y.x+i.clientLeft,h.y=y.y+i.clientTop}const g=l&&!p&&!a?hE(l,d):Zi(0);return{width:e.width*f.x,height:e.height*f.y,x:e.x*f.x-d.scrollLeft*f.x+h.x+g.x,y:e.y*f.y-d.scrollTop*f.y+h.y+g.y}}function rR(r){return Array.from(r.getClientRects())}function aR(r){const t=an(r),e=Cu(r),i=r.ownerDocument.body,s=hi(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),a=hi(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let l=-e.scrollLeft+wu(r);const u=-e.scrollTop;return Ni(i).direction==="rtl"&&(l+=hi(t.clientWidth,i.clientWidth)-s),{width:s,height:a,x:l,y:u}}const my=25;function oR(r,t){const e=pi(r),i=an(r),s=e.visualViewport;let a=i.clientWidth,l=i.clientHeight,u=0,d=0;if(s){a=s.width,l=s.height;const h=Eh();(!h||h&&t==="fixed")&&(u=s.offsetLeft,d=s.offsetTop)}const f=wu(i);if(f<=0){const h=i.ownerDocument,p=h.body,g=getComputedStyle(p),y=h.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,v=Math.abs(i.clientWidth-p.clientWidth-y);v<=my&&(a-=v)}else f<=my&&(a+=f);return{width:a,height:l,x:u,y:d}}const lR=new Set(["absolute","fixed"]);function uR(r,t){const e=zs(r,!0,t==="fixed"),i=e.top+r.clientTop,s=e.left+r.clientLeft,a=tn(r)?jr(r):Zi(1),l=r.clientWidth*a.x,u=r.clientHeight*a.y,d=s*a.x,f=i*a.y;return{width:l,height:u,x:d,y:f}}function py(r,t,e){let i;if(t==="viewport")i=oR(r,e);else if(t==="document")i=aR(an(r));else if(Pi(t))i=uR(t,e);else{const s=dE(r);i={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return uu(i)}function mE(r,t){const e=ds(r);return e===t||!Pi(e)||Kr(e)?!1:Ni(e).position==="fixed"||mE(e,t)}function cR(r,t){const e=t.get(r);if(e)return e;let i=eo(r,[],!1).filter(u=>Pi(u)&&Jr(u)!=="body"),s=null;const a=Ni(r).position==="fixed";let l=a?ds(r):r;for(;Pi(l)&&!Kr(l);){const u=Ni(l),d=vh(l);!d&&u.position==="fixed"&&(s=null),(a?!d&&!s:!d&&u.position==="static"&&!!s&&lR.has(s.position)||ho(l)&&!d&&mE(r,l))?i=i.filter(h=>h!==l):s=u,l=ds(l)}return t.set(r,i),i}function fR(r){let{element:t,boundary:e,rootBoundary:i,strategy:s}=r;const l=[...e==="clippingAncestors"?_u(t)?[]:cR(t,this._c):[].concat(e),i],u=l[0],d=l.reduce((f,h)=>{const p=py(t,h,s);return f.top=hi(p.top,f.top),f.right=fs(p.right,f.right),f.bottom=fs(p.bottom,f.bottom),f.left=hi(p.left,f.left),f},py(t,u,s));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function dR(r){const{width:t,height:e}=fE(r);return{width:t,height:e}}function hR(r,t,e){const i=tn(t),s=an(t),a=e==="fixed",l=zs(r,!0,a,t);let u={scrollLeft:0,scrollTop:0};const d=Zi(0);function f(){d.x=wu(s)}if(i||!i&&!a)if((Jr(t)!=="body"||ho(s))&&(u=Cu(t)),i){const y=zs(t,!0,a,t);d.x=y.x+t.clientLeft,d.y=y.y+t.clientTop}else s&&f();a&&!i&&s&&f();const h=s&&!i&&!a?hE(s,u):Zi(0),p=l.left+u.scrollLeft-d.x-h.x,g=l.top+u.scrollTop-d.y-h.y;return{x:p,y:g,width:l.width,height:l.height}}function ld(r){return Ni(r).position==="static"}function gy(r,t){if(!tn(r)||Ni(r).position==="fixed")return null;if(t)return t(r);let e=r.offsetParent;return an(r)===e&&(e=e.ownerDocument.body),e}function pE(r,t){const e=pi(r);if(_u(r))return e;if(!tn(r)){let s=ds(r);for(;s&&!Kr(s);){if(Pi(s)&&!ld(s))return s;s=ds(s)}return e}let i=gy(r,t);for(;i&&XA(i)&&ld(i);)i=gy(i,t);return i&&Kr(i)&&ld(i)&&!vh(i)?e:i||tR(r)||e}const mR=async function(r){const t=this.getOffsetParent||pE,e=this.getDimensions,i=await e(r.floating);return{reference:hR(r.reference,await t(r.floating),r.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function pR(r){return Ni(r).direction==="rtl"}const gR={convertOffsetParentRelativeRectToViewportRelativeRect:sR,getDocumentElement:an,getClippingRect:fR,getOffsetParent:pE,getElementRects:mR,getClientRects:rR,getDimensions:dR,getScale:jr,isElement:Pi,isRTL:pR};function gE(r,t){return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}function yR(r,t){let e=null,i;const s=an(r);function a(){var u;clearTimeout(i),(u=e)==null||u.disconnect(),e=null}function l(u,d){u===void 0&&(u=!1),d===void 0&&(d=1),a();const f=r.getBoundingClientRect(),{left:h,top:p,width:g,height:y}=f;if(u||t(),!g||!y)return;const v=Il(p),S=Il(s.clientWidth-(h+g)),T=Il(s.clientHeight-(p+y)),A=Il(h),R={rootMargin:-v+"px "+-S+"px "+-T+"px "+-A+"px",threshold:hi(0,fs(1,d))||1};let C=!0;function D(N){const w=N[0].intersectionRatio;if(w!==d){if(!C)return l();w?l(!1,w):i=setTimeout(()=>{l(!1,1e-7)},1e3)}w===1&&!gE(f,r.getBoundingClientRect())&&l(),C=!1}try{e=new IntersectionObserver(D,{...R,root:s.ownerDocument})}catch{e=new IntersectionObserver(D,R)}e.observe(r)}return l(!0),a}function vR(r,t,e,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:d=!1}=i,f=xh(r),h=s||a?[...f?eo(f):[],...eo(t)]:[];h.forEach(A=>{s&&A.addEventListener("scroll",e,{passive:!0}),a&&A.addEventListener("resize",e)});const p=f&&u?yR(f,e):null;let g=-1,y=null;l&&(y=new ResizeObserver(A=>{let[b]=A;b&&b.target===f&&y&&(y.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var R;(R=y)==null||R.observe(t)})),e()}),f&&!d&&y.observe(f),y.observe(t));let v,S=d?zs(r):null;d&&T();function T(){const A=zs(r);S&&!gE(S,A)&&e(),S=A,v=requestAnimationFrame(T)}return e(),()=>{var A;h.forEach(b=>{s&&b.removeEventListener("scroll",e),a&&b.removeEventListener("resize",e)}),p?.(),(A=y)==null||A.disconnect(),y=null,d&&cancelAnimationFrame(v)}}const ER=HA,xR=zA,SR=$A,TR=KA,bR=jA,yy=UA,AR=VA,RR=(r,t,e)=>{const i=new Map,s={platform:gR,...e},a={...s.platform,_c:i};return BA(r,t,{...s,platform:a})};var LR=typeof document<"u",_R=function(){},Ql=LR?F.useLayoutEffect:_R;function cu(r,t){if(r===t)return!0;if(typeof r!=typeof t)return!1;if(typeof r=="function"&&r.toString()===t.toString())return!0;let e,i,s;if(r&&t&&typeof r=="object"){if(Array.isArray(r)){if(e=r.length,e!==t.length)return!1;for(i=e;i--!==0;)if(!cu(r[i],t[i]))return!1;return!0}if(s=Object.keys(r),e=s.length,e!==Object.keys(t).length)return!1;for(i=e;i--!==0;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=e;i--!==0;){const a=s[i];if(!(a==="_owner"&&r.$$typeof)&&!cu(r[a],t[a]))return!1}return!0}return r!==r&&t!==t}function yE(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function vy(r,t){const e=yE(r);return Math.round(t*e)/e}function ud(r){const t=F.useRef(r);return Ql(()=>{t.current=r}),t}function CR(r){r===void 0&&(r={});const{placement:t="bottom",strategy:e="absolute",middleware:i=[],platform:s,elements:{reference:a,floating:l}={},transform:u=!0,whileElementsMounted:d,open:f}=r,[h,p]=F.useState({x:0,y:0,strategy:e,placement:t,middlewareData:{},isPositioned:!1}),[g,y]=F.useState(i);cu(g,i)||y(i);const[v,S]=F.useState(null),[T,A]=F.useState(null),b=F.useCallback(V=>{V!==N.current&&(N.current=V,S(V))},[]),R=F.useCallback(V=>{V!==w.current&&(w.current=V,A(V))},[]),C=a||v,D=l||T,N=F.useRef(null),w=F.useRef(null),P=F.useRef(h),B=d!=null,M=ud(d),K=ud(s),tt=ud(f),z=F.useCallback(()=>{if(!N.current||!w.current)return;const V={placement:t,strategy:e,middleware:g};K.current&&(V.platform=K.current),RR(N.current,w.current,V).then(nt=>{const ut={...nt,isPositioned:tt.current!==!1};G.current&&!cu(P.current,ut)&&(P.current=ut,mh.flushSync(()=>{p(ut)}))})},[g,t,e,K,tt]);Ql(()=>{f===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,p(V=>({...V,isPositioned:!1})))},[f]);const G=F.useRef(!1);Ql(()=>(G.current=!0,()=>{G.current=!1}),[]),Ql(()=>{if(C&&(N.current=C),D&&(w.current=D),C&&D){if(M.current)return M.current(C,D,z);z()}},[C,D,z,M,B]);const Y=F.useMemo(()=>({reference:N,floating:w,setReference:b,setFloating:R}),[b,R]),O=F.useMemo(()=>({reference:C,floating:D}),[C,D]),j=F.useMemo(()=>{const V={position:e,left:0,top:0};if(!O.floating)return V;const nt=vy(O.floating,h.x),ut=vy(O.floating,h.y);return u?{...V,transform:"translate("+nt+"px, "+ut+"px)",...yE(O.floating)>=1.5&&{willChange:"transform"}}:{position:e,left:nt,top:ut}},[e,u,O.floating,h.x,h.y]);return F.useMemo(()=>({...h,update:z,refs:Y,elements:O,floatingStyles:j}),[h,z,Y,O,j])}const wR=r=>{function t(e){return{}.hasOwnProperty.call(e,"current")}return{name:"arrow",options:r,fn(e){const{element:i,padding:s}=typeof r=="function"?r(e):r;return i&&t(i)?i.current!=null?yy({element:i.current,padding:s}).fn(e):{}:i?yy({element:i,padding:s}).fn(e):{}}}},DR=(r,t)=>({...ER(r),options:[r,t]}),IR=(r,t)=>({...xR(r),options:[r,t]}),OR=(r,t)=>({...AR(r),options:[r,t]}),kR=(r,t)=>({...SR(r),options:[r,t]}),MR=(r,t)=>({...TR(r),options:[r,t]}),PR=(r,t)=>({...bR(r),options:[r,t]}),NR=(r,t)=>({...wR(r),options:[r,t]});function FR(r){const t=BR(r),e=F.forwardRef((i,s)=>{const{children:a,...l}=i,u=F.Children.toArray(a),d=u.find($R);if(d){const f=d.props.children,h=u.map(p=>p===d?F.Children.count(f)>1?F.Children.only(null):F.isValidElement(f)?f.props.children:null:p);return X.jsx(t,{...l,ref:s,children:F.isValidElement(f)?F.cloneElement(f,void 0,h):null})}return X.jsx(t,{...l,ref:s,children:a})});return e.displayName=`${r}.Slot`,e}function BR(r){const t=F.forwardRef((e,i)=>{const{children:s,...a}=e;if(F.isValidElement(s)){const l=GR(s),u=jR(a,s.props);return s.type!==F.Fragment&&(u.ref=i?aE(i,l):l),F.cloneElement(s,u)}return F.Children.count(s)>1?F.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var UR=Symbol("radix.slottable");function $R(r){return F.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===UR}function jR(r,t){const e={...t};for(const i in t){const s=r[i],a=t[i];/^on[A-Z]/.test(i)?s&&a?e[i]=(...u)=>{const d=a(...u);return s(...u),d}:s&&(e[i]=s):i==="style"?e[i]={...s,...a}:i==="className"&&(e[i]=[s,a].filter(Boolean).join(" "))}return{...r,...e}}function GR(r){let t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=Object.getOwnPropertyDescriptor(r,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}var HR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ys=HR.reduce((r,t)=>{const e=FR(`Primitive.${t}`),i=F.forwardRef((s,a)=>{const{asChild:l,...u}=s,d=l?e:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),X.jsx(d,{...u,ref:a})});return i.displayName=`Primitive.${t}`,{...r,[t]:i}},{});function zR(r,t){r&&mh.flushSync(()=>r.dispatchEvent(t))}var VR="Arrow",vE=F.forwardRef((r,t)=>{const{children:e,width:i=10,height:s=5,...a}=r;return X.jsx(Ys.svg,{...a,ref:t,width:i,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?e:X.jsx("polygon",{points:"0,0 30,0 15,10"})})});vE.displayName=VR;var KR=vE;function Du(r){const t=F.useRef(r);return F.useEffect(()=>{t.current=r}),F.useMemo(()=>(...e)=>t.current?.(...e),[])}function qR(r){const[t,e]=F.useState(void 0);return Hs(()=>{if(r){e({width:r.offsetWidth,height:r.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let l,u;if("borderBoxSize"in a){const d=a.borderBoxSize,f=Array.isArray(d)?d[0]:d;l=f.inlineSize,u=f.blockSize}else l=r.offsetWidth,u=r.offsetHeight;e({width:l,height:u})});return i.observe(r,{box:"border-box"}),()=>i.unobserve(r)}else e(void 0)},[r]),t}var Sh="Popper",[EE,xE]=rE(Sh),[YR,SE]=EE(Sh),TE=r=>{const{__scopePopper:t,children:e}=r,[i,s]=F.useState(null);return X.jsx(YR,{scope:t,anchor:i,onAnchorChange:s,children:e})};TE.displayName=Sh;var bE="PopperAnchor",AE=F.forwardRef((r,t)=>{const{__scopePopper:e,virtualRef:i,...s}=r,a=SE(bE,e),l=F.useRef(null),u=Qr(t,l),d=F.useRef(null);return F.useEffect(()=>{const f=d.current;d.current=i?.current||l.current,f!==d.current&&a.onAnchorChange(d.current)}),i?null:X.jsx(Ys.div,{...s,ref:u})});AE.displayName=bE;var Th="PopperContent",[XR,WR]=EE(Th),RE=F.forwardRef((r,t)=>{const{__scopePopper:e,side:i="bottom",sideOffset:s=0,align:a="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:d=!0,collisionBoundary:f=[],collisionPadding:h=0,sticky:p="partial",hideWhenDetached:g=!1,updatePositionStrategy:y="optimized",onPlaced:v,...S}=r,T=SE(Th,e),[A,b]=F.useState(null),R=Qr(t,Et=>b(Et)),[C,D]=F.useState(null),N=qR(C),w=N?.width??0,P=N?.height??0,B=i+(a!=="center"?"-"+a:""),M=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},K=Array.isArray(f)?f:[f],tt=K.length>0,z={padding:M,boundary:K.filter(ZR),altBoundary:tt},{refs:G,floatingStyles:Y,placement:O,isPositioned:j,middlewareData:V}=CR({strategy:"fixed",placement:B,whileElementsMounted:(...Et)=>vR(...Et,{animationFrame:y==="always"}),elements:{reference:T.anchor},middleware:[DR({mainAxis:s+P,alignmentAxis:l}),d&&IR({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?OR():void 0,...z}),d&&kR({...z}),MR({...z,apply:({elements:Et,rects:Lt,availableWidth:_t,availableHeight:ee})=>{const{width:he,height:Re}=Lt.reference,De=Et.floating.style;De.setProperty("--radix-popper-available-width",`${_t}px`),De.setProperty("--radix-popper-available-height",`${ee}px`),De.setProperty("--radix-popper-anchor-width",`${he}px`),De.setProperty("--radix-popper-anchor-height",`${Re}px`)}}),C&&NR({element:C,padding:u}),JR({arrowWidth:w,arrowHeight:P}),g&&PR({strategy:"referenceHidden",...z})]}),[nt,ut]=CE(O),k=Du(v);Hs(()=>{j&&k?.()},[j,k]);const $=V.arrow?.x,st=V.arrow?.y,ct=V.arrow?.centerOffset!==0,[ft,dt]=F.useState();return Hs(()=>{A&&dt(window.getComputedStyle(A).zIndex)},[A]),X.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:j?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ft,"--radix-popper-transform-origin":[V.transformOrigin?.x,V.transformOrigin?.y].join(" "),...V.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:X.jsx(XR,{scope:e,placedSide:nt,onArrowChange:D,arrowX:$,arrowY:st,shouldHideArrow:ct,children:X.jsx(Ys.div,{"data-side":nt,"data-align":ut,...S,ref:R,style:{...S.style,animation:j?void 0:"none"}})})})});RE.displayName=Th;var LE="PopperArrow",QR={top:"bottom",right:"left",bottom:"top",left:"right"},_E=F.forwardRef(function(t,e){const{__scopePopper:i,...s}=t,a=WR(LE,i),l=QR[a.placedSide];return X.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:X.jsx(KR,{...s,ref:e,style:{...s.style,display:"block"}})})});_E.displayName=LE;function ZR(r){return r!==null}var JR=r=>({name:"transformOrigin",options:r,fn(t){const{placement:e,rects:i,middlewareData:s}=t,l=s.arrow?.centerOffset!==0,u=l?0:r.arrowWidth,d=l?0:r.arrowHeight,[f,h]=CE(e),p={start:"0%",center:"50%",end:"100%"}[h],g=(s.arrow?.x??0)+u/2,y=(s.arrow?.y??0)+d/2;let v="",S="";return f==="bottom"?(v=l?p:`${g}px`,S=`${-d}px`):f==="top"?(v=l?p:`${g}px`,S=`${i.floating.height+d}px`):f==="right"?(v=`${-d}px`,S=l?p:`${y}px`):f==="left"&&(v=`${i.floating.width+d}px`,S=l?p:`${y}px`),{data:{x:v,y:S}}}});function CE(r){const[t,e="center"]=r.split("-");return[t,e]}var tL=TE,eL=AE,iL=RE,nL=_E,sL="Portal",wE=F.forwardRef((r,t)=>{const{container:e,...i}=r,[s,a]=F.useState(!1);Hs(()=>a(!0),[]);const l=e||s&&globalThis?.document?.body;return l?yA.createPortal(X.jsx(Ys.div,{...i,ref:t}),l):null});wE.displayName=sL;function rL(r,t){return F.useReducer((e,i)=>t[e][i]??e,r)}var bh=r=>{const{present:t,children:e}=r,i=aL(t),s=typeof e=="function"?e({present:i.isPresent}):F.Children.only(e),a=Qr(i.ref,oL(s));return typeof e=="function"||i.isPresent?F.cloneElement(s,{ref:a}):null};bh.displayName="Presence";function aL(r){const[t,e]=F.useState(),i=F.useRef(null),s=F.useRef(r),a=F.useRef("none"),l=r?"mounted":"unmounted",[u,d]=rL(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return F.useEffect(()=>{const f=Ol(i.current);a.current=u==="mounted"?f:"none"},[u]),Hs(()=>{const f=i.current,h=s.current;if(h!==r){const g=a.current,y=Ol(f);r?d("MOUNT"):y==="none"||f?.display==="none"?d("UNMOUNT"):d(h&&g!==y?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,d]),Hs(()=>{if(t){let f;const h=t.ownerDocument.defaultView??window,p=y=>{const S=Ol(i.current).includes(CSS.escape(y.animationName));if(y.target===t&&S&&(d("ANIMATION_END"),!s.current)){const T=t.style.animationFillMode;t.style.animationFillMode="forwards",f=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=T)})}},g=y=>{y.target===t&&(a.current=Ol(i.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p),()=>{h.clearTimeout(f),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",p),t.removeEventListener("animationend",p)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:F.useCallback(f=>{i.current=f?getComputedStyle(f):null,e(f)},[])}}function Ol(r){return r?.animationName||"none"}function oL(r){let t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=Object.getOwnPropertyDescriptor(r,"ref")?.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}function lL(r,t=globalThis?.document){const e=Du(r);F.useEffect(()=>{const i=s=>{s.key==="Escape"&&e(s)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[e,t])}var uL="DismissableLayer",jd="dismissableLayer.update",cL="dismissableLayer.pointerDownOutside",fL="dismissableLayer.focusOutside",Ey,DE=F.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),IE=F.forwardRef((r,t)=>{const{disableOutsidePointerEvents:e=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,onDismiss:u,...d}=r,f=F.useContext(DE),[h,p]=F.useState(null),g=h?.ownerDocument??globalThis?.document,[,y]=F.useState({}),v=Qr(t,w=>p(w)),S=Array.from(f.layers),[T]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),A=S.indexOf(T),b=h?S.indexOf(h):-1,R=f.layersWithOutsidePointerEventsDisabled.size>0,C=b>=A,D=mL(w=>{const P=w.target,B=[...f.branches].some(M=>M.contains(P));!C||B||(s?.(w),l?.(w),w.defaultPrevented||u?.())},g),N=pL(w=>{const P=w.target;[...f.branches].some(M=>M.contains(P))||(a?.(w),l?.(w),w.defaultPrevented||u?.())},g);return lL(w=>{b===f.layers.size-1&&(i?.(w),!w.defaultPrevented&&u&&(w.preventDefault(),u()))},g),F.useEffect(()=>{if(h)return e&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(Ey=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(h)),f.layers.add(h),xy(),()=>{e&&f.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=Ey)}},[h,g,e,f]),F.useEffect(()=>()=>{h&&(f.layers.delete(h),f.layersWithOutsidePointerEventsDisabled.delete(h),xy())},[h,f]),F.useEffect(()=>{const w=()=>y({});return document.addEventListener(jd,w),()=>document.removeEventListener(jd,w)},[]),X.jsx(Ys.div,{...d,ref:v,style:{pointerEvents:R?C?"auto":"none":void 0,...r.style},onFocusCapture:_i(r.onFocusCapture,N.onFocusCapture),onBlurCapture:_i(r.onBlurCapture,N.onBlurCapture),onPointerDownCapture:_i(r.onPointerDownCapture,D.onPointerDownCapture)})});IE.displayName=uL;var dL="DismissableLayerBranch",hL=F.forwardRef((r,t)=>{const e=F.useContext(DE),i=F.useRef(null),s=Qr(t,i);return F.useEffect(()=>{const a=i.current;if(a)return e.branches.add(a),()=>{e.branches.delete(a)}},[e.branches]),X.jsx(Ys.div,{...r,ref:s})});hL.displayName=dL;function mL(r,t=globalThis?.document){const e=Du(r),i=F.useRef(!1),s=F.useRef(()=>{});return F.useEffect(()=>{const a=u=>{if(u.target&&!i.current){let d=function(){OE(cL,e,f,{discrete:!0})};const f={originalEvent:u};u.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=d,t.addEventListener("click",s.current,{once:!0})):d()}else t.removeEventListener("click",s.current);i.current=!1},l=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,e]),{onPointerDownCapture:()=>i.current=!0}}function pL(r,t=globalThis?.document){const e=Du(r),i=F.useRef(!1);return F.useEffect(()=>{const s=a=>{a.target&&!i.current&&OE(fL,e,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,e]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function xy(){const r=new CustomEvent(jd);document.dispatchEvent(r)}function OE(r,t,e,{discrete:i}){const s=e.originalEvent.target,a=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:e});t&&s.addEventListener(r,t,{once:!0}),i?zR(s,a):s.dispatchEvent(a)}var cd,Iu="HoverCard",[kE]=rE(Iu,[xE]),Ou=xE(),[gL,ku]=kE(Iu),ME=r=>{const{__scopeHoverCard:t,children:e,open:i,defaultOpen:s,onOpenChange:a,openDelay:l=700,closeDelay:u=300}=r,d=Ou(t),f=F.useRef(0),h=F.useRef(0),p=F.useRef(!1),g=F.useRef(!1),[y,v]=AA({prop:i,defaultProp:s??!1,onChange:a,caller:Iu}),S=F.useCallback(()=>{clearTimeout(h.current),f.current=window.setTimeout(()=>v(!0),l)},[l,v]),T=F.useCallback(()=>{clearTimeout(f.current),!p.current&&!g.current&&(h.current=window.setTimeout(()=>v(!1),u))},[u,v]),A=F.useCallback(()=>v(!1),[v]);return F.useEffect(()=>()=>{clearTimeout(f.current),clearTimeout(h.current)},[]),X.jsx(gL,{scope:t,open:y,onOpenChange:v,onOpen:S,onClose:T,onDismiss:A,hasSelectionRef:p,isPointerDownOnContentRef:g,children:X.jsx(tL,{...d,children:e})})};ME.displayName=Iu;var PE="HoverCardTrigger",NE=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,...i}=r,s=ku(PE,e),a=Ou(e);return X.jsx(eL,{asChild:!0,...a,children:X.jsx(Ys.a,{"data-state":s.open?"open":"closed",...i,ref:t,onPointerEnter:_i(r.onPointerEnter,du(s.onOpen)),onPointerLeave:_i(r.onPointerLeave,du(s.onClose)),onFocus:_i(r.onFocus,s.onOpen),onBlur:_i(r.onBlur,s.onClose),onTouchStart:_i(r.onTouchStart,l=>l.preventDefault())})})});NE.displayName=PE;var Ah="HoverCardPortal",[yL,vL]=kE(Ah,{forceMount:void 0}),FE=r=>{const{__scopeHoverCard:t,forceMount:e,children:i,container:s}=r,a=ku(Ah,t);return X.jsx(yL,{scope:t,forceMount:e,children:X.jsx(bh,{present:e||a.open,children:X.jsx(wE,{asChild:!0,container:s,children:i})})})};FE.displayName=Ah;var fu="HoverCardContent",BE=F.forwardRef((r,t)=>{const e=vL(fu,r.__scopeHoverCard),{forceMount:i=e.forceMount,...s}=r,a=ku(fu,r.__scopeHoverCard);return X.jsx(bh,{present:i||a.open,children:X.jsx(EL,{"data-state":a.open?"open":"closed",...s,onPointerEnter:_i(r.onPointerEnter,du(a.onOpen)),onPointerLeave:_i(r.onPointerLeave,du(a.onClose)),ref:t})})});BE.displayName=fu;var EL=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,...u}=r,d=ku(fu,e),f=Ou(e),h=F.useRef(null),p=Qr(t,h),[g,y]=F.useState(!1);return F.useEffect(()=>{if(g){const v=document.body;return cd=v.style.userSelect||v.style.webkitUserSelect,v.style.userSelect="none",v.style.webkitUserSelect="none",()=>{v.style.userSelect=cd,v.style.webkitUserSelect=cd}}},[g]),F.useEffect(()=>{if(h.current){const v=()=>{y(!1),d.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(d.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",v),()=>{document.removeEventListener("pointerup",v),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!1}}},[d.isPointerDownOnContentRef,d.hasSelectionRef]),F.useEffect(()=>{h.current&&TL(h.current).forEach(S=>S.setAttribute("tabindex","-1"))}),X.jsx(IE,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:l,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:_i(a,v=>{v.preventDefault()}),onDismiss:d.onDismiss,children:X.jsx(iL,{...f,...u,onPointerDown:_i(u.onPointerDown,v=>{v.currentTarget.contains(v.target)&&y(!0),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!0}),ref:p,style:{...u.style,userSelect:g?"text":void 0,WebkitUserSelect:g?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),xL="HoverCardArrow",SL=F.forwardRef((r,t)=>{const{__scopeHoverCard:e,...i}=r,s=Ou(e);return X.jsx(nL,{...s,...i,ref:t})});SL.displayName=xL;function du(r){return t=>t.pointerType==="touch"?void 0:r()}function TL(r){const t=[],e=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;e.nextNode();)t.push(e.currentNode);return t}var bL=ME,AL=NE,RL=FE,LL=BE;const _L={"hover-container":"_hover-container_pw03f_1","hover-poster":"_hover-poster_pw03f_8","hover-info":"_hover-info_pw03f_23"},UE=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M187.2 100.9C174.8 94.1 159.8 94.4 147.6 101.6C135.4 108.8 128 121.9 128 136L128 504C128 518.1 135.5 531.2 147.6 538.4C159.7 545.6 174.8 545.9 187.2 539.1L523.2 355.1C536 348.1 544 334.6 544 320C544 305.4 536 291.9 523.2 284.9L187.2 100.9z"})),CL=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M305 151.1L320 171.8L335 151.1C360 116.5 400.2 96 442.9 96C516.4 96 576 155.6 576 229.1L576 231.7C576 343.9 436.1 474.2 363.1 529.9C350.7 539.3 335.5 544 320 544C304.5 544 289.2 539.4 276.9 529.9C203.9 474.2 64 343.9 64 231.7L64 229.1C64 155.6 123.6 96 197.1 96C239.8 96 280 116.5 305 151.1z"})),wL=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM288 224C288 206.3 302.3 192 320 192C337.7 192 352 206.3 352 224C352 241.7 337.7 256 320 256C302.3 256 288 241.7 288 224zM280 288L328 288C341.3 288 352 298.7 352 312L352 400L360 400C373.3 400 384 410.7 384 424C384 437.3 373.3 448 360 448L280 448C266.7 448 256 437.3 256 424C256 410.7 266.7 400 280 400L304 400L304 336L280 336C266.7 336 256 325.3 256 312C256 298.7 266.7 288 280 288z"})),Hi=qs.bind(_L);function DL({movieData:r,imgDom:t}){return console.log(r),X.jsx("div",{className:Hi("hover-container"),children:X.jsxs("div",{className:Hi("hover"),children:[X.jsx("div",{className:Hi("hover-poster"),children:X.jsx("img",{src:t+"/uploads/movies/"+r.poster_url})}),X.jsxs("div",{className:Hi("hover-info"),children:[X.jsx("div",{className:Hi("hover-name"),children:r.name}),X.jsx("div",{className:Hi("hover-origin-name"),children:r.origin_name}),X.jsxs("div",{className:Hi("hover-control"),children:[X.jsxs("button",{className:Hi("control-play"),children:[X.jsx(UE,{}),"Xem ngay"]}),X.jsxs("button",{className:Hi("control-like"),children:[X.jsx(CL,{}),"Thich"]}),X.jsxs("button",{className:Hi("control-detail"),children:[X.jsx(wL,{}),"Chi tit"]})]}),X.jsx("div",{}),X.jsx("div",{})]})]})})}const IL="_name_1nvdw_35",OL={"slide-card":"_slide-card_1nvdw_1","slide-poster":"_slide-poster_1nvdw_7","slide-img":"_slide-img_1nvdw_17","slide-name":"_slide-name_1nvdw_24",name:IL,"origin-name":"_origin-name_1nvdw_41","hover-preview":"_hover-preview_1nvdw_51"},Ns=qs.bind(OL);function kL({movieData:r,width:t,imgDom:e}){return console.log(t),X.jsxs("div",{className:Ns("slide-card"),children:[X.jsxs(bL,{openDelay:250,closeDelay:150,open:!0,children:[X.jsx(AL,{asChild:!0,children:X.jsx("a",{className:Ns("slide-poster"),href:`/phim/${r.slug}`,children:X.jsx("img",{className:Ns("slide-img"),src:e+"/uploads/movies/"+r.poster_url})})}),X.jsx(RL,{children:X.jsx(LL,{side:"center",align:"center",sideOffset:0,className:Ns("hover-preview"),style:{width:`${t}px`},children:X.jsx(DL,{movieData:r,imgDom:e})})})]}),X.jsxs("div",{className:Ns("slide-name"),children:[X.jsx("div",{className:Ns("name"),children:X.jsx("a",{href:`/phim/${r.slug}`,children:r.name})}),X.jsx("div",{className:Ns("origin-name"),children:X.jsx("a",{href:`/phim/${r.slug}`,children:r.origin_name})})]})]})}const $E=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M98.9 114.6C91.5 130.6 98.5 149.7 114.5 157.1L467.6 320L114.6 483C98.6 490.4 91.5 509.4 99 525.5C106.5 541.6 125.4 548.5 141.5 541.1L557.5 349.1C568.8 343.9 576.1 332.5 576.1 320C576.1 307.5 568.8 296.2 557.5 290.9L141.4 99C125.4 91.6 106.3 98.6 98.9 114.6z"})),ML=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M439.1 297.4C451.6 309.9 451.6 330.2 439.1 342.7L279.1 502.7C266.6 515.2 246.3 515.2 233.8 502.7C221.3 490.2 221.3 469.9 233.8 457.4L371.2 320L233.9 182.6C221.4 170.1 221.4 149.8 233.9 137.3C246.4 124.8 266.7 124.8 279.2 137.3L439.2 297.3z"})),PL=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M201.4 297.4C188.9 309.9 188.9 330.2 201.4 342.7L361.4 502.7C373.9 515.2 394.2 515.2 406.7 502.7C419.2 490.2 419.2 469.9 406.7 457.4L269.3 320L406.6 182.6C419.1 170.1 419.1 149.8 406.6 137.3C394.1 124.8 373.8 124.8 361.3 137.3L201.3 297.3z"})),zi=qs.bind(SA);function NL({data:r}){const[t,e]=F.useState(0),[i,s]=F.useState(0),[a,l]=F.useState(""),u=F.useRef(null),d=F.useRef(null),f=F.useRef(null);return F.useEffect(()=>{l(`#${Math.floor(Math.random()*16777215).toString(16)}`);var h=u.current.children[0],p=u.current.children[1];s(p.getBoundingClientRect().left-h.getBoundingClientRect().left)},[]),F.useEffect(()=>{u.current.style.transform=`translateX(${-t*i}px)`},[t]),X.jsxs("div",{className:zi("slide"),children:[X.jsxs("div",{className:zi("slide-title"),children:[X.jsxs("div",{className:zi("title-text"),style:{background:`linear-gradient(
    235deg,
    rgb(255, 255, 255) 30%,
    ${a} 100%
  )`},children:[r.seoOnPage.titleHead," mi"]}),X.jsx("div",{className:zi("title-info"),children:X.jsxs("a",{href:r.seoOnPage.og_url,children:[X.jsx("span",{children:"Xem toan b"}),X.jsx($E,{})]})})]}),X.jsxs("div",{className:zi("slide-wrapper"),children:[X.jsxs("div",{className:zi("slide-nav"),children:[t!=0&&X.jsx("button",{type:"button",className:zi("slide-nav-prev"),ref:d,onClick:()=>{e((h=>h-1))},children:X.jsx(PL,{})}),t!=r.params.pagination.totalItemsPerPage-3&&X.jsx("button",{type:"button",className:zi("slide-nav-next"),ref:f,onClick:()=>{e((h=>h+1))},children:X.jsx(ML,{})})]}),X.jsx("div",{className:zi("slide-content"),children:X.jsx("div",{className:zi("slide-group"),ref:u,children:r.items.map(h=>X.jsx(kL,{movieData:h,width:i,imgDom:r.APP_DOMAIN_CDN_IMAGE},h._id))})})]})]})}const FL={"home-container":"_home-container_1rwka_1","slide-container":"_slide-container_1rwka_7"},Sy=qs.bind(FL);function BL(){const[r,t]=F.useState(null);return F.useEffect(()=>{fetch("https://ophim1.com/v1/api/quoc-gia/han-quoc",{method:"GET",headers:{accept:"application/json"}}).then(s=>s.json()).then(s=>t(s.data)).catch(s=>console.error(s))},[]),X.jsx("div",{className:Sy("home-container"),children:X.jsx("div",{className:Sy("slide-container"),children:r&&X.jsx(NL,{data:r})})})}/*!
 * artplayer.js v5.3.0
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(r,t,e,i,s,a,l,u){var d=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},f=typeof d[i]=="function"&&d[i],h=f.i||{},p=f.cache||{},g=typeof $s<"u"&&typeof $s.require=="function"&&$s.require.bind($s);function y(T,A){if(!p[T]){if(!r[T]){if(s[T])return s[T];var b=typeof d[i]=="function"&&d[i];if(!A&&b)return b(T,!0);if(f)return f(T,!0);if(g&&typeof T=="string")return g(T);var R=Error("Cannot find module '"+T+"'");throw R.code="MODULE_NOT_FOUND",R}D.resolve=function(N){var w=r[T][1][N];return w??N},D.cache={};var C=p[T]=new y.Module(T);r[T][0].call(C.exports,D,C,C.exports,d)}return p[T].exports;function D(N){var w=D.resolve(N);return w===!1?{}:y(w)}}y.isParcelRequire=!0,y.Module=function(T){this.id=T,this.bundle=y,this.require=g,this.exports={}},y.modules=r,y.cache=p,y.parent=f,y.distDir=void 0,y.publicUrl=void 0,y.devServer=void 0,y.i=h,y.register=function(T,A){r[T]=[function(b,R){R.exports=A},{}]},Object.defineProperty(y,"root",{get:function(){return d[i]}}),d[i]=y;for(var v=0;v<t.length;v++)y(t[v]);{var S=y(e);typeof ES=="object"&&typeof $s<"u"?$s.exports=S:typeof define=="function"&&define.amd&&define(function(){return S})}})({esqvp:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("bundle-text:./style/index.less"),l=s.interopDefault(a),u=r("option-validator"),d=s.interopDefault(u),f=r("../package.json"),h=r("./config"),p=s.interopDefault(h),g=r("./contextmenu"),y=s.interopDefault(g),v=r("./control"),S=s.interopDefault(v),T=r("./events"),A=s.interopDefault(T),b=r("./hotkey"),R=s.interopDefault(b),C=r("./i18n"),D=s.interopDefault(C),N=r("./icons"),w=s.interopDefault(N),P=r("./info"),B=s.interopDefault(P),M=r("./layer"),K=s.interopDefault(M),tt=r("./loading"),z=s.interopDefault(tt),G=r("./mask"),Y=s.interopDefault(G),O=r("./notice"),j=s.interopDefault(O),V=r("./player"),nt=s.interopDefault(V),ut=r("./plugins"),k=s.interopDefault(ut),$=r("./scheme"),st=s.interopDefault($),ct=r("./setting"),ft=s.interopDefault(ct),dt=r("./storage"),Et=s.interopDefault(dt),Lt=r("./subtitle"),_t=s.interopDefault(Lt),ee=r("./template"),he=s.interopDefault(ee),Re=r("./utils"),De=r("./utils/emitter"),Le=s.interopDefault(De);let Fi=0,bt=[];class pt extends Le.default{constructor(oe,le){if(super(),!Re.isBrowser)throw Error("Artplayer can only be used in the browser environment");this.id=++Fi;let Ie=Re.mergeDeep(pt.option,oe);if(Ie.container=oe.container,this.option=(0,d.default)(Ie,st.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isRotate=!1,this.isDestroy=!1,this.template=new he.default(this),this.events=new A.default(this),this.storage=new Et.default(this),this.icons=new w.default(this),this.i18n=new D.default(this),this.notice=new j.default(this),this.player=new nt.default(this),this.layers=new K.default(this),this.controls=new S.default(this),this.contextmenu=new y.default(this),this.subtitle=new _t.default(this),this.info=new B.default(this),this.loading=new z.default(this),this.hotkey=new R.default(this),this.mask=new Y.default(this),this.setting=new ft.default(this),this.plugins=new k.default(this),typeof le=="function"&&this.on("ready",()=>le.call(this,this)),pt.DEBUG){let Ue=je=>console.log(`[ART.${this.id}] -> ${je}`);Ue(`Version@${pt.version}`);for(let je=0;je<p.default.events.length;je++)this.on(`video:${p.default.events[je]}`,ie=>Ue(`Event@${ie.type}`))}bt.push(this)}static get instances(){return bt}static get version(){return f.version}static get config(){return p.default}static get utils(){return Re}static get scheme(){return st.default}static get Emitter(){return Le.default}static get validator(){return d.default}static get kindOf(){return d.default.kindOf}static get html(){return he.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,gesture:!0,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,proxy:void 0,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],thumbnails:{url:"",number:60,column:10,width:0,height:0,scale:1},subtitle:{url:"",type:"",style:{},name:"",escape:!0,encoding:"utf-8",onVttLoad:oe=>oe},moreVideoAttr:{controls:!1,preload:Re.isSafari?"auto":"metadata"},i18n:{},icons:{},cssVar:{},customType:{},lang:navigator?.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}get video(){return this.template.$video}destroy(oe=!0){pt.REMOVE_SRC_WHEN_DESTROY&&this.video.removeAttribute("src"),this.events.destroy(),this.template.destroy(oe),bt.splice(bt.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}e.default=pt,pt.STYLE=l.default,pt.DEBUG=!1,pt.CONTEXTMENU=!0,pt.NOTICE_TIME=2e3,pt.SETTING_WIDTH=250,pt.SETTING_ITEM_WIDTH=200,pt.SETTING_ITEM_HEIGHT=35,pt.RESIZE_TIME=200,pt.SCROLL_TIME=200,pt.SCROLL_GAP=50,pt.AUTO_PLAYBACK_MAX=10,pt.AUTO_PLAYBACK_MIN=5,pt.AUTO_PLAYBACK_TIMEOUT=3e3,pt.RECONNECT_TIME_MAX=5,pt.RECONNECT_SLEEP_TIME=1e3,pt.CONTROL_HIDE_TIME=3e3,pt.DBCLICK_TIME=300,pt.DBCLICK_FULLSCREEN=!0,pt.MOBILE_DBCLICK_PLAY=!0,pt.MOBILE_CLICK_PLAY=!1,pt.AUTO_ORIENTATION_TIME=200,pt.INFO_LOOP_TIME=1e3,pt.FAST_FORWARD_VALUE=3,pt.FAST_FORWARD_TIME=1e3,pt.TOUCH_MOVE_RATIO=.5,pt.VOLUME_STEP=.1,pt.SEEK_STEP=5,pt.PLAYBACK_RATE=[.5,.75,1,1.25,1.5,2],pt.ASPECT_RATIO=["default","4:3","16:9"],pt.FLIP=["normal","horizontal","vertical"],pt.FULLSCREEN_WEB_IN_BODY=!1,pt.LOG_VERSION=!0,pt.USE_RAF=!1,pt.REMOVE_SRC_WHEN_DESTROY=!0,Re.isBrowser&&(window.Artplayer=pt,Re.setStyleText("artplayer-style",l.default),setTimeout(()=>{pt.LOG_VERSION&&console.log(`%c ArtPlayer %c ${pt.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},100))},{"bundle-text:./style/index.less":"2wh8D","option-validator":"g7VGh","../package.json":"lh3R5","./config":"eJfh8","./contextmenu":"9zso8","./control":"dp1yk","./events":"jmVSD","./hotkey":"dswts","./i18n":"d9ktO","./icons":"fFHY0","./info":"kZ0F8","./layer":"j9lbi","./loading":"bMjWd","./mask":"k1nkQ","./notice":"fPVaU","./player":"uR0Sw","./plugins":"cjxJL","./scheme":"biLjm","./setting":"bwLGT","./storage":"kwqbK","./subtitle":"k5613","./template":"fwOA1","./utils":"aBlEo","./utils/emitter":"4NM7P","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2wh8D":[function(r,t,e,i){t.exports='.art-video-player{--art-theme:red;--art-font-color:#fff;--art-background-color:#000;--art-text-shadow-color:#00000080;--art-transition-duration:.2s;--art-padding:10px;--art-border-radius:3px;--art-progress-height:6px;--art-progress-color:#ffffff40;--art-hover-color:#ffffff40;--art-loaded-color:#ffffff40;--art-state-size:80px;--art-state-opacity:.8;--art-bottom-height:100px;--art-bottom-offset:20px;--art-bottom-gap:5px;--art-highlight-width:8px;--art-highlight-color:#ffffff80;--art-control-height:46px;--art-control-opacity:.75;--art-control-icon-size:36px;--art-control-icon-scale:1.1;--art-volume-height:120px;--art-volume-handle-size:14px;--art-lock-size:36px;--art-indicator-scale:0;--art-indicator-size:16px;--art-fullscreen-web-index:9999;--art-settings-icon-size:24px;--art-settings-max-height:300px;--art-selector-max-height:300px;--art-contextmenus-min-width:250px;--art-subtitle-font-size:20px;--art-subtitle-gap:5px;--art-subtitle-bottom:15px;--art-subtitle-border:#000;--art-widget-background:#000000d9;--art-tip-background:#000000b3;--art-scrollbar-size:4px;--art-scrollbar-background:#ffffff40;--art-scrollbar-background-hover:#ffffff80;--art-mini-progress-height:2px}.art-bg-cover{background-position:50%;background-repeat:no-repeat;background-size:cover}.art-bottom-gradient{background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x}.art-backdrop-filter{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.art-video-player{zoom:1;text-align:left;user-select:none;box-sizing:border-box;width:100%;height:100%;color:var(--art-font-color);background-color:var(--art-background-color);text-shadow:0 0 2px var(--art-text-shadow-color);-webkit-tap-highlight-color:#0000;-ms-touch-action:manipulation;touch-action:manipulation;-ms-high-contrast-adjust:none;direction:ltr;outline:0;margin:0 auto;padding:0;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Roboto,Arial,sans-serif;font-size:14px;line-height:1.3;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box}.art-video-player ::-webkit-scrollbar{width:var(--art-scrollbar-size);height:var(--art-scrollbar-size)}.art-video-player ::-webkit-scrollbar-thumb{background-color:var(--art-scrollbar-background)}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:var(--art-scrollbar-background-hover)}.art-video-player img{vertical-align:top;max-width:100%}.art-video-player svg{fill:var(--art-font-color)}.art-video-player a{color:var(--art-font-color);text-decoration:none}.art-icon{justify-content:center;align-items:center;line-height:1;display:flex}.art-video-player.art-backdrop .art-contextmenus,.art-video-player.art-backdrop .art-info,.art-video-player.art-backdrop .art-settings,.art-video-player.art-backdrop .art-layer-auto-playback,.art-video-player.art-backdrop .art-selector-list,.art-video-player.art-backdrop .art-volume-inner{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-video{z-index:10;cursor:pointer;width:100%;height:100%;position:absolute;inset:0}.art-poster{z-index:11;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;width:100%;height:100%;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;text-align:center;pointer-events:none;justify-content:center;align-items:center;gap:var(--art-subtitle-gap);width:100%;bottom:var(--art-subtitle-bottom);font-size:var(--art-subtitle-font-size);transition:bottom var(--art-transition-duration)ease;text-shadow:var(--art-subtitle-border)1px 0 1px,var(--art-subtitle-border)0 1px 1px,var(--art-subtitle-border)-1px 0 1px,var(--art-subtitle-border)0 -1px 1px,var(--art-subtitle-border)1px 1px 1px,var(--art-subtitle-border)-1px -1px 1px,var(--art-subtitle-border)1px -1px 1px,var(--art-subtitle-border)-1px 1px 1px;flex-direction:column;padding:0 5%;display:none;position:absolute}.art-video-player.art-subtitle-show .art-subtitle{display:flex}.art-video-player.art-control-show .art-subtitle{bottom:calc(var(--art-control-height) + var(--art-subtitle-bottom))}.art-danmuku{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;pointer-events:none;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:flex}.art-video-player .art-mask{z-index:50;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;inset:0}.art-video-player .art-mask .art-state{opacity:0;width:var(--art-state-size);height:var(--art-state-size);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.art-video-player.art-mask-show .art-state{cursor:pointer;pointer-events:auto;opacity:var(--art-state-opacity);transform:scale(1)}.art-video-player.art-loading-show .art-state{display:none}.art-video-player .art-loading{z-index:70;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;opacity:0;pointer-events:none;width:100%;height:100%;padding:0 var(--art-padding);transition:all var(--art-transition-duration)ease;background-size:100% var(--art-bottom-height);background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:flex-end;display:flex;position:absolute;inset:0;overflow:hidden}.art-video-player .art-bottom .art-controls,.art-video-player .art-bottom .art-progress{transform:translateY(var(--art-bottom-offset));transition:transform var(--art-transition-duration)ease}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1}.art-video-player.art-control-show .art-bottom .art-controls,.art-video-player.art-hover .art-bottom .art-controls,.art-video-player.art-control-show .art-bottom .art-progress,.art-video-player.art-hover .art-bottom .art-progress{transform:translateY(0)}.art-bottom .art-progress{z-index:0;pointer-events:auto;padding-bottom:var(--art-bottom-gap);position:relative}.art-bottom .art-progress .art-control-progress{cursor:pointer;height:var(--art-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner{width:100%;height:50%;transition:height var(--art-transition-duration)ease;background-color:var(--art-progress-color);align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-hover{z-index:0;background-color:var(--art-hover-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;background-color:var(--art-loaded-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;background-color:var(--art-theme);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{z-index:0;pointer-events:auto;width:100%;height:100%;transform:translateX(calc(var(--art-highlight-width)/-2));background-color:var(--art-highlight-color);position:absolute;inset:0 auto 0 0;width:var(--art-highlight-width)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{z-index:40;width:var(--art-indicator-size);height:var(--art-indicator-size);transform:scale(var(--art-indicator-scale));margin-left:calc(var(--art-indicator-size)/-2);transition:transform var(--art-transition-duration)ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{pointer-events:none;width:100%;height:100%}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:hover{transform:scale(1.2)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:active{transform:scale(1)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;border-radius:var(--art-border-radius);white-space:nowrap;background-color:var(--art-tip-background);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.art-bottom .art-progress .art-control-progress:hover .art-control-progress-inner{height:100%}.art-bottom .art-progress .art-control-thumbnails{bottom:calc(var(--art-bottom-gap) + 10px);border-radius:var(--art-border-radius);pointer-events:none;background-color:var(--art-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px #0003,0 1px 2px -1px #0003}.art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{transform:scale(1)}.art-controls{z-index:10;pointer-events:auto;height:var(--art-control-height);justify-content:space-between;align-items:center;display:flex;position:relative}.art-controls .art-controls-left,.art-controls .art-controls-right{height:100%;display:flex}.art-controls .art-controls-center{flex:1;justify-content:center;align-items:center;height:100%;padding:0 10px;display:none}.art-controls .art-controls-right{justify-content:flex-end}.art-controls .art-control{cursor:pointer;white-space:nowrap;opacity:var(--art-control-opacity);min-height:var(--art-control-height);min-width:var(--art-control-height);transition:opacity var(--art-transition-duration)ease;flex-shrink:0;justify-content:center;align-items:center;display:flex}.art-controls .art-control .art-icon{height:var(--art-control-icon-size);width:var(--art-control-icon-size);transform:scale(var(--art-control-icon-scale));transition:transform var(--art-transition-duration)ease}.art-controls .art-control .art-icon:active{transform:scale(calc(var(--art-control-icon-scale)*.8))}.art-controls .art-control:hover{opacity:1}.art-control-volume{position:relative}.art-control-volume .art-volume-panel{text-align:center;cursor:default;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--art-control-height);width:var(--art-control-height);height:var(--art-volume-height);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;transform:translateY(10px)}.art-control-volume .art-volume-panel .art-volume-inner{border-radius:var(--art-border-radius);background-color:var(--art-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider{cursor:pointer;flex:1;justify-content:center;width:100%;display:flex;position:relative}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle{border-radius:var(--art-border-radius);background-color:#ffffff40;justify-content:center;width:2px;display:flex;position:relative;overflow:hidden}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle .art-volume-loaded{z-index:0;background-color:var(--art-theme);width:100%;height:100%;position:absolute;inset:0}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-indicator{width:var(--art-volume-handle-size);height:var(--art-volume-handle-size);margin-top:calc(var(--art-volume-handle-size)/-2);background-color:var(--art-theme);transition:transform var(--art-transition-duration)ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider:active .art-volume-indicator{transform:scale(.9)}.art-control-volume:hover .art-volume-panel{opacity:1;pointer-events:auto;transform:translateY(0)}.art-video-player .art-notice{z-index:80;width:100%;height:auto;padding:var(--art-padding);pointer-events:none;display:none;position:absolute;inset:0 0 auto}.art-video-player .art-notice .art-notice-inner{border-radius:var(--art-border-radius);background-color:var(--art-tip-background);padding:5px;line-height:1;display:inline-flex}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);min-width:var(--art-contextmenus-min-width);flex-direction:column;padding:5px 0;font-size:12px;display:none;position:absolute}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;border-bottom:1px solid #ffffff1a;padding:10px 15px;display:flex}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 8px}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:var(--art-theme)}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;border-radius:var(--art-border-radius);max-height:var(--art-settings-max-height);left:auto;right:var(--art-padding);bottom:var(--art-control-height);transition:all var(--art-transition-duration)ease;background-color:var(--art-widget-background);flex-direction:column;display:none;position:absolute;overflow:hidden auto}.art-video-player .art-settings .art-setting-panel{flex-direction:column;display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item{cursor:pointer;transition:background-color var(--art-transition-duration)ease;justify-content:space-between;align-items:center;padding:0 5px;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover{background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:var(--art-theme)}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{flex-shrink:0;justify-content:center;align-items:center;gap:5px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:var(--art-settings-icon-size);width:var(--art-settings-icon-size);justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{justify-content:center;align-items:center;gap:5px;font-size:12px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{justify-content:center;align-items:center;min-width:32px;height:24px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{appearance:none;background-color:#fff3;outline:none;width:80px;height:3px}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:flex}.art-video-player .art-info{left:var(--art-padding);top:var(--art-padding);z-index:100;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);padding:10px;font-size:12px;display:none;position:absolute}.art-video-player .art-info .art-info-panel{flex-direction:column;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item{align-items:center;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item .art-info-title{text-align:right;width:100px}.art-video-player .art-info .art-info-panel .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;user-select:all;width:250px;overflow:hidden}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio]{overflow:hidden}.art-video-player[data-aspect-ratio] .art-video{object-fit:fill;box-sizing:content-box}.art-fullscreen{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3}.art-fullscreen-web{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3;z-index:var(--art-fullscreen-web-index);width:100%;height:100%;position:fixed;inset:0}.art-mini-popup{z-index:9999;border-radius:var(--art-border-radius);cursor:move;user-select:none;background:#000;width:320px;height:180px;transition:opacity .2s;position:fixed;overflow:hidden;box-shadow:0 0 5px #00000080}.art-mini-popup svg{fill:#fff}.art-mini-popup .art-video{pointer-events:none}.art-mini-popup .art-mini-close{z-index:20;cursor:pointer;opacity:0;transition:opacity .2s;position:absolute;top:10px;right:10px}.art-mini-popup .art-mini-state{z-index:30;pointer-events:none;opacity:0;background-color:#00000040;justify-content:center;align-items:center;width:100%;height:100%;transition:opacity .2s;display:flex;position:absolute;inset:0}.art-mini-popup .art-mini-state .art-icon{opacity:.75;cursor:pointer;pointer-events:auto;transition:transform .2s;transform:scale(3)}.art-mini-popup .art-mini-state .art-icon:active{transform:scale(2.5)}.art-mini-popup.art-mini-dragging{opacity:.9}.art-mini-popup:hover .art-mini-close,.art-mini-popup:hover .art-mini-state{opacity:1}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-lock{height:var(--art-lock-size);width:var(--art-lock-size);top:50%;left:var(--art-padding);background-color:var(--art-tip-background);border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;transform:translateY(-50%)}.art-video-player .art-layer-auto-playback{border-radius:var(--art-border-radius);left:var(--art-padding);bottom:calc(var(--art-control-height) + var(--art-bottom-gap) + 10px);background-color:var(--art-widget-background);align-items:center;gap:10px;padding:10px;line-height:1;display:none;position:absolute}.art-video-player .art-layer-auto-playback .art-auto-playback-close{cursor:pointer;justify-content:center;align-items:center;display:flex}.art-video-player .art-layer-auto-playback .art-auto-playback-close svg{width:15px;height:15px;fill:var(--art-theme)}.art-video-player .art-layer-auto-playback .art-auto-playback-jump{color:var(--art-theme);cursor:pointer}.art-video-player.art-lock .art-subtitle{bottom:var(--art-subtitle-bottom)!important}.art-video-player.art-mini-progress-bar .art-bottom,.art-video-player.art-lock .art-bottom{opacity:1;background-image:none;padding:0}.art-video-player.art-mini-progress-bar .art-bottom .art-controls,.art-video-player.art-lock .art-bottom .art-controls,.art-video-player.art-mini-progress-bar .art-bottom .art-progress,.art-video-player.art-lock .art-bottom .art-progress{transform:translateY(calc(var(--art-control-height) + var(--art-bottom-gap) + var(--art-progress-height)/4))}.art-video-player.art-mini-progress-bar .art-bottom .art-progress-indicator,.art-video-player.art-lock .art-bottom .art-progress-indicator{display:none!important}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-control-selector{justify-content:center;display:flex;position:relative}.art-control-selector .art-selector-list{text-align:center;border-radius:var(--art-border-radius);opacity:0;pointer-events:none;bottom:var(--art-control-height);max-height:var(--art-selector-max-height);background-color:var(--art-widget-background);transition:all var(--art-transition-duration)ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto;transform:translateY(10px)}.art-control-selector .art-selector-list .art-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex}.art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-control-selector .art-selector-list .art-selector-item:hover,.art-control-selector .art-selector-list .art-selector-item.art-current{color:var(--art-theme)}.art-control-selector:hover .art-selector-list{opacity:1;pointer-events:auto;transform:translateY(0)}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.art-video-player.art-mobile{--art-bottom-gap:10px;--art-control-height:38px;--art-control-icon-scale:1;--art-state-size:60px;--art-settings-max-height:180px;--art-selector-max-height:180px;--art-indicator-scale:1;--art-control-opacity:1}.art-video-player.art-mobile .art-controls-left{margin-left:calc(var(--art-padding)/-1)}.art-video-player.art-mobile .art-controls-right{margin-right:calc(var(--art-padding)/-1)}'},{}],g7VGh:[function(r,t,e,i){t.exports=(function(){function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(p)}var a=Object.prototype.toString,l=function(p){if(p===void 0)return"undefined";if(p===null)return"null";var g=s(p);if(g==="boolean")return"boolean";if(g==="string")return"string";if(g==="number")return"number";if(g==="symbol")return"symbol";if(g==="function")return u(p)==="GeneratorFunction"?"generatorfunction":"function";if(Array.isArray?Array.isArray(p):p instanceof Array)return"array";if(p.constructor&&typeof p.constructor.isBuffer=="function"&&p.constructor.isBuffer(p))return"buffer";if((function(y){try{if(typeof y.length=="number"&&typeof y.callee=="function")return!0}catch(v){if(v.message.indexOf("callee")!==-1)return!0}return!1})(p))return"arguments";if(p instanceof Date||typeof p.toDateString=="function"&&typeof p.getDate=="function"&&typeof p.setDate=="function")return"date";if(p instanceof Error||typeof p.message=="string"&&p.constructor&&typeof p.constructor.stackTraceLimit=="number")return"error";if(p instanceof RegExp||typeof p.flags=="string"&&typeof p.ignoreCase=="boolean"&&typeof p.multiline=="boolean"&&typeof p.global=="boolean")return"regexp";switch(u(p)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(typeof p.throw=="function"&&typeof p.return=="function"&&typeof p.next=="function")return"generator";switch(g=a.call(p)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return g.slice(8,-1).toLowerCase().replace(/\s/g,"")};function u(p){return p.constructor?p.constructor.name:null}function d(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return f(p,g,y),h(p,g,y),(function(v,S,T){var A=l(S),b=l(v);if(A==="object"){if(b!=="object")throw Error("[Type Error]: '".concat(T.join("."),"' require 'object' type, but got '").concat(b,"'"));Object.keys(S).forEach(function(R){var C=v[R],D=S[R],N=T.slice();N.push(R),f(C,D,N),h(C,D,N),d(C,D,N)})}if(A==="array"){if(b!=="array")throw Error("[Type Error]: '".concat(T.join("."),"' require 'array' type, but got '").concat(b,"'"));v.forEach(function(R,C){var D=v[C],N=S[C]||S[0],w=T.slice();w.push(C),f(D,N,w),h(D,N,w),d(D,N,w)})}})(p,g,y),p}function f(p,g,y){if(l(g)==="string"){var v=l(p);if(g[0]==="?"&&(g=g.slice(1)+"|undefined"),!(-1<g.indexOf("|")?g.split("|").map(function(S){return S.toLowerCase().trim()}).filter(Boolean).some(function(S){return v===S}):g.toLowerCase().trim()===v))throw Error("[Type Error]: '".concat(y.join("."),"' require '").concat(g,"' type, but got '").concat(v,"'"))}}function h(p,g,y){if(l(g)==="function"){var v=g(p,l(p),y);if(v!==!0){var S=l(v);throw S==="string"?Error(v):S==="error"?v:Error("[Validator Error]: The scheme for '".concat(y.join("."),"' validator require return true, but got '").concat(v,"'"))}}}return d.kindOf=l,d})()},{}],lh3R5:[function(r,t,e,i){t.exports=JSON.parse('{"name":"artplayer","version":"5.3.0","description":"ArtPlayer.js is a modern and full featured HTML5 video player","author":"Harvey Zack <laozhaochaguan@gmail.com>","license":"MIT","homepage":"https://artplayer.org","repository":{"type":"git","url":"git+https://github.com/zhw2590582/ArtPlayer.git"},"bugs":{"url":"https://github.com/zhw2590582/ArtPlayer/issues"},"keywords":["html5","video","player"],"exports":{".":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.mjs","require":"./dist/artplayer.js"},"./legacy":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.legacy.js","require":"./dist/artplayer.legacy.js"},"./i18n/*":{"types":"./types/i18n.d.ts","import":"./dist/i18n/*.mjs","require":"./dist/i18n/*.js"}},"main":"./dist/artplayer.js","module":"./dist/artplayer.mjs","types":"./types/artplayer.d.ts","typesVersions":{"*":{"i18n/*":["types/i18n.d.ts"],"legacy":["types/artplayer.d.ts"]}},"legacy":"./dist/artplayer.legacy.js","browserslist":"last 1 Chrome version","dependencies":{"option-validator":"^2.0.6"}}')},{}],eJfh8:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default={properties:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],loqXi:[function(r,t,e,i){e.interopDefault=function(s){return s&&s.__esModule?s:{default:s}},e.defineInteropFlag=function(s){Object.defineProperty(s,"__esModule",{value:!0})},e.exportAll=function(s,a){return Object.keys(s).forEach(function(l){l==="default"||l==="__esModule"||Object.prototype.hasOwnProperty.call(a,l)||Object.defineProperty(a,l,{enumerable:!0,get:function(){return s[l]}})}),a},e.export=function(s,a,l){Object.defineProperty(s,a,{enumerable:!0,get:l})}},{}],"9zso8":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./aspectRatio"),f=s.interopDefault(d),h=r("./close"),p=s.interopDefault(h),g=r("./flip"),y=s.interopDefault(g),v=r("./info"),S=s.interopDefault(v),T=r("./playbackRate"),A=s.interopDefault(T),b=r("./version"),R=s.interopDefault(b);class C extends u.default{constructor(N){super(N),this.name="contextmenu",this.$parent=N.template.$contextmenu,a.isMobile||this.init()}init(){let{option:N,proxy:w,template:{$player:P,$contextmenu:B}}=this.art;N.playbackRate&&this.add((0,A.default)({name:"playbackRate",index:10})),N.aspectRatio&&this.add((0,f.default)({name:"aspectRatio",index:20})),N.flip&&this.add((0,y.default)({name:"flip",index:30})),this.add((0,S.default)({name:"info",index:40})),this.add((0,R.default)({name:"version",index:50})),this.add((0,p.default)({name:"close",index:60}));for(let M=0;M<N.contextmenu.length;M++)this.add(N.contextmenu[M]);w(P,"contextmenu",M=>{if(!this.art.constructor.CONTEXTMENU)return;M.preventDefault(),this.show=!0;let K=M.clientX,tt=M.clientY,{height:z,width:G,left:Y,top:O}=(0,a.getRect)(P),{height:j,width:V}=(0,a.getRect)(B),nt=K-Y,ut=tt-O;K+V>Y+G&&(nt=G-V),tt+j>O+z&&(ut=z-j),(0,a.setStyles)(B,{top:`${ut}px`,left:`${nt}px`})}),w(P,"click",M=>{(0,a.includeFromEvent)(M,B)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}e.default=C},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"6XHP2","./close":"eF6AX","./flip":"7Wg1P","./info":"fjRnU","./playbackRate":"hm1DY","./version":"aJBeL","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBlEo:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./compatibility");s.exportAll(a,e);var l=r("./dom");s.exportAll(l,e);var u=r("./error");s.exportAll(u,e);var d=r("./file");s.exportAll(d,e);var f=r("./format");s.exportAll(f,e);var h=r("./property");s.exportAll(h,e);var p=r("./subtitle");s.exportAll(p,e);var g=r("./time");s.exportAll(g,e)},{"./compatibility":"jg0yq","./dom":"eANXw","./error":"4FwTI","./file":"i2JbS","./format":"dy9GH","./property":"jY49c","./subtitle":"ke7ox","./time":"f7gsx","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jg0yq:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"userAgent",()=>a),s.export(e,"isSafari",()=>l),s.export(e,"isIOS",()=>u),s.export(e,"isIOS13",()=>d),s.export(e,"isMobile",()=>f),s.export(e,"isBrowser",()=>h);let a=globalThis?.CUSTOM_USER_AGENT??(typeof navigator<"u"?navigator.userAgent:""),l=/^(?:(?!chrome|android).)*safari/i.test(a),u=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream,d=u||a.includes("Macintosh")&&navigator.maxTouchPoints>=1,f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)||d,h=typeof window<"u"&&typeof document<"u"},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eANXw:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"query",()=>l),s.export(e,"queryAll",()=>u),s.export(e,"addClass",()=>d),s.export(e,"removeClass",()=>f),s.export(e,"hasClass",()=>h),s.export(e,"append",()=>p),s.export(e,"remove",()=>g),s.export(e,"setStyle",()=>y),s.export(e,"setStyles",()=>v),s.export(e,"getStyle",()=>S),s.export(e,"siblings",()=>T),s.export(e,"inverseClass",()=>A),s.export(e,"tooltip",()=>b),s.export(e,"isInViewport",()=>R),s.export(e,"includeFromEvent",()=>C),s.export(e,"replaceElement",()=>D),s.export(e,"createElement",()=>N),s.export(e,"getIcon",()=>w),s.export(e,"setStyleText",()=>P),s.export(e,"supportsFlex",()=>B),s.export(e,"getRect",()=>M),s.export(e,"loadImg",()=>K),s.export(e,"getComposedPath",()=>tt);var a=r("./compatibility");function l(z,G=document){return G.querySelector(z)}function u(z,G=document){return Array.from(G.querySelectorAll(z))}function d(z,G){return z.classList.add(G)}function f(z,G){return z.classList.remove(G)}function h(z,G){return z.classList.contains(G)}function p(z,G){return G instanceof Element?z.appendChild(G):z.insertAdjacentHTML("beforeend",String(G)),z.lastElementChild||z.lastChild}function g(z){return z.parentNode.removeChild(z)}function y(z,G,Y){return z.style[G]=Y,z}function v(z,G){for(let Y in G)y(z,Y,G[Y]);return z}function S(z,G,Y=!0){let O=window.getComputedStyle(z,null).getPropertyValue(G);return Y?Number.parseFloat(O):O}function T(z){return Array.from(z.parentElement.children).filter(G=>G!==z)}function A(z,G){T(z).forEach(Y=>f(Y,G)),d(z,G)}function b(z,G,Y="top"){a.isMobile||(z.setAttribute("aria-label",G),d(z,"hint--rounded"),d(z,`hint--${Y}`))}function R(z,G=0){let Y=z.getBoundingClientRect(),O=window.innerHeight||document.documentElement.clientHeight,j=window.innerWidth||document.documentElement.clientWidth,V=Y.top-G<=O&&Y.top+Y.height+G>=0,nt=Y.left-G<=j+G&&Y.left+Y.width+G>=0;return V&&nt}function C(z,G){return tt(z).includes(G)}function D(z,G){return G.parentNode.replaceChild(z,G),z}function N(z){return document.createElement(z)}function w(z="",G=""){let Y=N("i");return d(Y,"art-icon"),d(Y,`art-icon-${z}`),p(Y,G),Y}function P(z,G){let Y=document.getElementById(z);Y||((Y=document.createElement("style")).id=z,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(Y)}):(document.head||document.documentElement).appendChild(Y)),Y.textContent=G}function B(){let z=document.createElement("div");return z.style.display="flex",z.style.display==="flex"}function M(z){return z.getBoundingClientRect()}function K(z,G){return new Promise((Y,O)=>{let j=new Image;j.onload=function(){if(G&&G!==1){let V=document.createElement("canvas"),nt=V.getContext("2d");V.width=j.width*G,V.height=j.height*G,nt.drawImage(j,0,0,V.width,V.height),V.toBlob(ut=>{let k=URL.createObjectURL(ut),$=new Image;$.onload=function(){Y($)},$.onerror=function(){URL.revokeObjectURL(k),O(Error(`Image load failed: ${z}`))},$.src=k})}else Y(j)},j.onerror=function(){O(Error(`Image load failed: ${z}`))},j.src=z})}function tt(z){if(z.composedPath)return z.composedPath();let G=[],Y=z.target;for(;Y;)G.push(Y),Y=Y.parentNode;return G.includes(window)||window===void 0||G.push(window),G}},{"./compatibility":"jg0yq","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4FwTI":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"ArtPlayerError",()=>a),s.export(e,"errorHandle",()=>l);class a extends Error{constructor(d,f){super(d),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,f||this.constructor),this.name="ArtPlayerError"}}function l(u,d){if(!u)throw new a(d);return u}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i2JbS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let d=document.createElement("a");d.style.display="none",d.href=l,d.download=u,document.body.appendChild(d),d.click(),document.body.removeChild(d)}s.defineInteropFlag(e),s.export(e,"getExt",()=>function l(u){return u.includes("?")?l(u.split("?")[0]):u.includes("#")?l(u.split("#")[0]):u.trim().toLowerCase().split(".").pop()}),s.export(e,"download",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dy9GH:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h,p,g){return Math.max(Math.min(h,Math.max(p,g)),Math.min(p,g))}function l(h){return h.charAt(0).toUpperCase()+h.slice(1)}function u(h){if(!h)return"00:00";let p=Math.floor(h/3600),g=Math.floor((h-3600*p)/60),y=Math.floor(h-3600*p-60*g);return(p>0?[p,g,y]:[g,y]).map(v=>v<10?`0${v}`:String(v)).join(":")}function d(h){return h.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}function f(h){let p={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'},g=RegExp(`(${Object.keys(p).join("|")})`,"g");return h.replace(g,y=>p[y]||y)}s.defineInteropFlag(e),s.export(e,"clamp",()=>a),s.export(e,"capitalize",()=>l),s.export(e,"secondToTime",()=>u),s.export(e,"escape",()=>d),s.export(e,"unescape",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jY49c:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"def",()=>a),s.export(e,"has",()=>u),s.export(e,"get",()=>d),s.export(e,"mergeDeep",()=>function f(...h){let p=g=>g&&typeof g=="object"&&!Array.isArray(g);return h.reduce((g,y)=>(Object.keys(y).forEach(v=>{let S=g[v],T=y[v];Array.isArray(S)&&Array.isArray(T)?g[v]=S.concat(...T):p(S)&&p(T)?g[v]=f(S,T):g[v]=T}),g),{})});let a=Object.defineProperty,{hasOwnProperty:l}=Object.prototype;function u(f,h){return l.call(f,h)}function d(f,h){return Object.getOwnPropertyDescriptor(f,h)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ke7ox:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(d){return`WEBVTT \r
\r
`.concat(d.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(f,h,p)=>{let g=p.slice(0,3);return p.length===1&&(g=`${p}00`),p.length===2&&(g=`${p}0`),`${h},${g}`}).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/\{[\s\S]*?\}/g,"").concat(`\r
\r
`))}function l(d){return URL.createObjectURL(new Blob([d],{type:"text/vtt"}))}function u(d){let f=RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function h(p=""){return p.split(/[:.]/).map((g,y,v)=>{if(y===v.length-1){if(g.length===1)return`.${g}00`;if(g.length===2)return`.${g}0`}else if(g.length===1)return(y===0?"0":":0")+g;return y===0?g:y===v.length-1?`.${g}`:`:${g}`}).join("")}return`WEBVTT ${d.split(/\r?\n/).map(p=>{let g=p.match(f);return g?{start:h(g[1].trim()),end:h(g[2].trim()),text:g[5].replace(/\{[\s\S]*?\}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(y=>y.trim()).join(`
`)}:null}).filter(p=>p).map((p,g)=>p?`${g+1} ${p.start} --> ${p.end} ${p.text}`:"").filter(p=>p.trim()).join(`

`)}`}s.defineInteropFlag(e),s.export(e,"srtToVtt",()=>a),s.export(e,"vttToBlob",()=>l),s.export(e,"assToVtt",()=>u)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f7gsx:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(d=0){return new Promise(f=>setTimeout(f,d))}function l(d,f){let h;return function(...p){let g=()=>(h=null,d.apply(this,p));clearTimeout(h),h=setTimeout(g,f)}}function u(d,f){let h=!1;return function(...p){h||(d.apply(this,p),h=!0,setTimeout(()=>{h=!1},f))}}s.defineInteropFlag(e),s.export(e,"sleep",()=>a),s.export(e,"debounce",()=>l),s.export(e,"throttle",()=>u)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],idCEj:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("option-validator"),l=s.interopDefault(a),u=r("../scheme"),d=r("./dom"),f=r("./error");e.default=class{constructor(h){this.id=0,this.art=h,this.cache=new Map,this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.update=this.update.bind(this)}get show(){return(0,d.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(h){let{$player:p}=this.art.template,g=`art-${this.name}-show`;h?(0,d.addClass)(p,g):(0,d.removeClass)(p,g),this.art.emit(this.name,h)}toggle(){this.show=!this.show}add(h){let p=typeof h=="function"?h(this.art):h;if(p.html=p.html||"",(0,l.default)(p,u.ComponentOption),!this.$parent||!this.name||p.disable)return;let g=p.name||`${this.name}${this.id}`,y=this.cache.get(g);(0,f.errorHandle)(!y,`Can't add an existing [${g}] to the [${this.name}]`),this.id+=1;let v=(0,d.createElement)("div");(0,d.addClass)(v,`art-${this.name}`),(0,d.addClass)(v,`art-${this.name}-${g}`);let S=Array.from(this.$parent.children);v.dataset.index=p.index||this.id;let T=S.find(b=>Number(b.dataset.index)>=Number(v.dataset.index));T?T.insertAdjacentElement("beforebegin",v):(0,d.append)(this.$parent,v),p.html&&(0,d.append)(v,p.html),p.style&&(0,d.setStyles)(v,p.style),p.tooltip&&(0,d.tooltip)(v,p.tooltip);let A=[];if(p.click){let b=this.art.events.proxy(v,"click",R=>{R.preventDefault(),p.click.call(this.art,this,R)});A.push(b)}return p.selector&&["left","right"].includes(p.position)&&this.selector(p,v,A),this[g]=v,this.cache.set(g,{$ref:v,events:A,option:p}),p.mounted&&p.mounted.call(this.art,v),v}remove(h){let p=this.cache.get(h);(0,f.errorHandle)(p,`Can't find [${h}] from the [${this.name}]`),p.option.beforeUnmount&&p.option.beforeUnmount.call(this.art,p.$ref);for(let g=0;g<p.events.length;g++)this.art.events.remove(p.events[g]);this.cache.delete(h),delete this[h],(0,d.remove)(p.$ref)}update(h){let p=this.cache.get(h.name);return p&&(h=Object.assign(p.option,h),this.remove(h.name)),this.add(h)}}},{"option-validator":"g7VGh","../scheme":"biLjm","./dom":"eANXw","./error":"4FwTI","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],biLjm:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"ComponentOption",()=>y);var a=r("../utils");let l="array",u="boolean",d="string",f="number",h="object",p="function";function g(v,S,T){return(0,a.errorHandle)(S===d||S===f||v instanceof Element,`${T.join(".")} require '${d}' or 'Element' type`)}let y={html:g,disable:`?${u}`,name:`?${d}`,index:`?${f}`,style:`?${h}`,click:`?${p}`,mounted:`?${p}`,tooltip:`?${d}|${f}`,width:`?${f}`,selector:`?${l}`,onSelect:`?${p}`,switch:`?${u}`,onSwitch:`?${p}`,range:`?${l}`,onRange:`?${p}`,onChange:`?${p}`};e.default={id:d,container:g,url:d,poster:d,type:d,theme:d,lang:d,volume:f,isLive:u,muted:u,autoplay:u,autoSize:u,autoMini:u,loop:u,flip:u,playbackRate:u,aspectRatio:u,screenshot:u,setting:u,hotkey:u,pip:u,mutex:u,backdrop:u,fullscreen:u,fullscreenWeb:u,subtitleOffset:u,miniProgressBar:u,useSSR:u,playsInline:u,lock:u,gesture:u,fastForward:u,autoPlayback:u,autoOrientation:u,airplay:u,proxy:`?${p}`,plugins:[p],layers:[y],contextmenu:[y],settings:[y],controls:[{...y,position:(v,S,T)=>{let A=["top","left","right"];return(0,a.errorHandle)(A.includes(v),`${T.join(".")} only accept ${A.toString()} as parameters`)}}],quality:[{default:`?${u}`,html:d,url:d}],highlight:[{time:f,text:d}],thumbnails:{url:d,number:f,column:f,width:f,height:f,scale:f},subtitle:{url:d,name:d,type:d,style:h,escape:u,encoding:d,onVttLoad:p},moreVideoAttr:h,i18n:h,icons:h,cssVar:h,customType:h}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6XHP2":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{ASPECT_RATIO:h}}=d,p=h.map(g=>`<span data-value="${g}">${g==="default"?f.get("Default"):g}</span>`).join("");return{...u,html:`${f.get("Aspect Ratio")}: ${p}`,click:(g,y)=>{let{value:v}=y.target.dataset;v&&(d.aspectRatio=v,g.show=!1)},mounted:g=>{let y=(0,a.query)('[data-value="default"]',g);y&&(0,a.inverseClass)(y,"art-current"),d.on("aspectRatio",v=>{let S=(0,a.queryAll)("span",g).find(T=>T.dataset.value===v);S&&(0,a.inverseClass)(S,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eF6AX:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return u=>({...l,html:u.i18n.get("Close"),click:d=>{d.show=!1}})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7Wg1P":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{FLIP:h}}=d,p=h.map(g=>`<span data-value="${g}">${f.get((0,a.capitalize)(g))}</span>`).join("");return{...u,html:`${f.get("Video Flip")}: ${p}`,click:(g,y)=>{let{value:v}=y.target.dataset;v&&(d.flip=v.toLowerCase(),g.show=!1)},mounted:g=>{let y=(0,a.query)('[data-value="normal"]',g);y&&(0,a.inverseClass)(y,"art-current"),d.on("flip",v=>{let S=(0,a.queryAll)("span",g).find(T=>T.dataset.value===v);S&&(0,a.inverseClass)(S,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjRnU:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return u=>({...l,html:u.i18n.get("Video Info"),click:d=>{u.info.show=!0,d.show=!1}})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hm1DY:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>{let{i18n:f,constructor:{PLAYBACK_RATE:h}}=d,p=h.map(g=>`<span data-value="${g}">${g===1?f.get("Normal"):g.toFixed(1)}</span>`).join("");return{...u,html:`${f.get("Play Speed")}: ${p}`,click:(g,y)=>{let{value:v}=y.target.dataset;v&&(d.playbackRate=Number(v),g.show=!1)},mounted:g=>{let y=(0,a.query)('[data-value="1"]',g);y&&(0,a.inverseClass)(y,"art-current"),d.on("video:ratechange",()=>{let v=(0,a.queryAll)("span",g).find(S=>Number(S.dataset.value)===d.playbackRate);v&&(0,a.inverseClass)(v,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aJBeL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>function(l){return{...l,html:`<a href="https://artplayer.org" target="_blank">ArtPlayer ${a.version}</a>`}});var a=r("../../package.json")},{"../../package.json":"lh3R5","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dp1yk:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./airplay"),f=s.interopDefault(d),h=r("./fullscreen"),p=s.interopDefault(h),g=r("./fullscreenWeb"),y=s.interopDefault(g),v=r("./pip"),S=s.interopDefault(v),T=r("./playAndPause"),A=s.interopDefault(T),b=r("./progress"),R=s.interopDefault(b),C=r("./screenshot"),D=s.interopDefault(C),N=r("./setting"),w=s.interopDefault(N),P=r("./time"),B=s.interopDefault(P),M=r("./volume"),K=s.interopDefault(M);class tt extends u.default{constructor(G){super(G),this.isHover=!1,this.name="control",this.timer=Date.now();let{constructor:Y}=G,{$player:O,$bottom:j}=this.art.template;G.on("mousemove",()=>{a.isMobile||(this.show=!0)}),G.on("click",()=>{a.isMobile?this.toggle():this.show=!0}),G.on("document:mousemove",V=>{this.isHover=(0,a.includeFromEvent)(V,j)}),G.on("video:timeupdate",()=>{!G.setting.show&&!this.isHover&&!G.isInput&&G.playing&&this.show&&Date.now()-this.timer>=Y.CONTROL_HIDE_TIME&&(this.show=!1)}),G.on("control",V=>{V?((0,a.removeClass)(O,"art-hide-cursor"),(0,a.addClass)(O,"art-hover"),this.timer=Date.now()):((0,a.addClass)(O,"art-hide-cursor"),(0,a.removeClass)(O,"art-hover"))}),this.init()}init(){let{option:G}=this.art;G.isLive||this.add((0,R.default)({name:"progress",position:"top",index:10})),this.add({name:"thumbnails",position:"top",index:20}),this.add((0,A.default)({name:"playAndPause",position:"left",index:10})),this.add((0,K.default)({name:"volume",position:"left",index:20})),G.isLive||this.add((0,B.default)({name:"time",position:"left",index:30})),G.quality.length&&(0,a.sleep)().then(()=>{this.art.quality=G.quality}),G.screenshot&&!a.isMobile&&this.add((0,D.default)({name:"screenshot",position:"right",index:20})),G.setting&&this.add((0,w.default)({name:"setting",position:"right",index:30})),G.pip&&this.add((0,S.default)({name:"pip",position:"right",index:40})),G.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,f.default)({name:"airplay",position:"right",index:50})),G.fullscreenWeb&&this.add((0,y.default)({name:"fullscreenWeb",position:"right",index:60})),G.fullscreen&&this.add((0,p.default)({name:"fullscreen",position:"right",index:70}));for(let Y=0;Y<G.controls.length;Y++)this.add(G.controls[Y])}add(G){let Y=typeof G=="function"?G(this.art):G,{$progress:O,$controlsLeft:j,$controlsRight:V}=this.art.template;switch(Y.position){case"top":this.$parent=O;break;case"left":this.$parent=j;break;case"right":this.$parent=V;break;default:(0,a.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(Y)}check(G){G.$control_value.innerHTML=G.html;for(let Y=0;Y<G.$control_option.length;Y++){let O=G.$control_option[Y];O.default=O===G,O.default&&(0,a.inverseClass)(O.$control_item,"art-current")}}selector(G,Y,O){let{proxy:j}=this.art.events;(0,a.addClass)(Y,"art-control-selector");let V=(0,a.createElement)("div");(0,a.addClass)(V,"art-selector-value"),(0,a.append)(V,G.html),Y.textContent="",(0,a.append)(Y,V);let nt=(0,a.createElement)("div");(0,a.addClass)(nt,"art-selector-list"),(0,a.append)(Y,nt);for(let k=0;k<G.selector.length;k++){let $=G.selector[k],st=(0,a.createElement)("div");(0,a.addClass)(st,"art-selector-item"),$.default&&(0,a.addClass)(st,"art-current"),st.dataset.index=k,st.dataset.value=$.value,st.innerHTML=$.html,(0,a.append)(nt,st),(0,a.def)($,"$control_option",{get:()=>G.selector}),(0,a.def)($,"$control_item",{get:()=>st}),(0,a.def)($,"$control_value",{get:()=>V})}let ut=j(nt,"click",async k=>{let $=(0,a.getComposedPath)(k),st=G.selector.find(ct=>ct.$control_item===$.find(ft=>ct.$control_item===ft));this.check(st),G.onSelect&&(V.innerHTML=await G.onSelect.call(this.art,st,st.$control_item,k))});O.push(ut)}}e.default=tt},{"../utils":"aBlEo","../utils/component":"idCEj","./airplay":"amOzz","./fullscreen":"3GuBU","./fullscreenWeb":"jj1KV","./pip":"jMeHN","./playAndPause":"u3h8M","./progress":"1XZSS","./screenshot":"dIscA","./setting":"aqA0g","./time":"ihweO","./volume":"fJVWn","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],amOzz:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("AirPlay"),mounted:f=>{let{proxy:h,icons:p}=d;(0,a.append)(f,p.airplay),h(f,"click",()=>d.airplay())}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3GuBU":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Fullscreen"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,y=(0,a.append)(f,p.fullscreenOn),v=(0,a.append)(f,p.fullscreenOff);(0,a.setStyle)(v,"display","none"),h(f,"click",()=>{d.fullscreen=!d.fullscreen}),d.on("fullscreen",S=>{S?((0,a.tooltip)(f,g.get("Exit Fullscreen")),(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(v,"display","inline-flex")):((0,a.tooltip)(f,g.get("Fullscreen")),(0,a.setStyle)(y,"display","inline-flex"),(0,a.setStyle)(v,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jj1KV:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Web Fullscreen"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,y=(0,a.append)(f,p.fullscreenWebOn),v=(0,a.append)(f,p.fullscreenWebOff);(0,a.setStyle)(v,"display","none"),h(f,"click",()=>{d.fullscreenWeb=!d.fullscreenWeb}),d.on("fullscreenWeb",S=>{S?((0,a.tooltip)(f,g.get("Exit Web Fullscreen")),(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(v,"display","inline-flex")):((0,a.tooltip)(f,g.get("Web Fullscreen")),(0,a.setStyle)(y,"display","inline-flex"),(0,a.setStyle)(v,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jMeHN:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("PIP Mode"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d;(0,a.append)(f,p.pip),h(f,"click",()=>{d.pip=!d.pip}),d.on("pip",y=>{(0,a.tooltip)(f,g.get(y?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],u3h8M:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,mounted:f=>{let{proxy:h,icons:p,i18n:g}=d,y=(0,a.append)(f,p.play),v=(0,a.append)(f,p.pause);function S(){(0,a.setStyle)(y,"display","flex"),(0,a.setStyle)(v,"display","none")}function T(){(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(v,"display","flex")}(0,a.tooltip)(y,g.get("Play")),(0,a.tooltip)(v,g.get("Pause")),h(y,"click",()=>{d.play()}),h(v,"click",()=>{d.pause()}),d.playing?T():S(),d.on("video:playing",()=>{T()}),d.on("video:pause",()=>{S()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1XZSS":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"getPosFromEvent",()=>l),s.export(e,"setCurrentTime",()=>u),s.export(e,"default",()=>d);var a=r("../utils");function l(f,h){let{$progress:p}=f.template,{left:g}=(0,a.getRect)(p),y=a.isMobile?h.touches[0].clientX:h.clientX,v=(0,a.clamp)(y-g,0,p.clientWidth),S=v/p.clientWidth*f.duration,T=(0,a.secondToTime)(S),A=(0,a.clamp)(v/p.clientWidth,0,1);return{second:S,time:T,width:v,percentage:A}}function u(f,h){if(f.isRotate){let p=h.touches[0].clientY/f.height,g=p*f.duration;f.emit("setBar","played",p,h),f.seek=g}else{let{second:p,percentage:g}=l(f,h);f.emit("setBar","played",g,h),f.seek=p}}function d(f){return h=>{let{icons:p,option:g,proxy:y}=h;return{...f,html:'<div class="art-control-progress-inner"><div class="art-progress-hover"></div><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:v=>{let S=null,T=!1,A=(0,a.query)(".art-progress-hover",v),b=(0,a.query)(".art-progress-loaded",v),R=(0,a.query)(".art-progress-played",v),C=(0,a.query)(".art-progress-highlight",v),D=(0,a.query)(".art-progress-indicator",v),N=(0,a.query)(".art-progress-tip",v);function w(P,B){let{width:M,time:K}=B||l(h,P);N.textContent=K;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>v.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${v.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}p.indicator?(0,a.append)(D,p.indicator):(0,a.setStyle)(D,"backgroundColor","var(--art-theme)"),h.on("setBar",function(P,B,M){let K=P==="played"&&M&&a.isMobile;P==="loaded"&&(0,a.setStyle)(b,"width",`${100*B}%`),P==="hover"&&(0,a.setStyle)(A,"width",`${100*B}%`),P==="played"&&((0,a.setStyle)(R,"width",`${100*B}%`),(0,a.setStyle)(D,"left",`${100*B}%`)),K&&((0,a.setStyle)(N,"display","flex"),w(M,{width:v.clientWidth*B,time:(0,a.secondToTime)(B*h.duration)}),clearTimeout(S),S=setTimeout(()=>{(0,a.setStyle)(N,"display","none")},500))}),h.on("video:loadedmetadata",function(){C.textContent="";for(let P=0;P<g.highlight.length;P++){let B=g.highlight[P],M=(0,a.clamp)(B.time,0,h.duration)/h.duration*100,K=`<span data-text="${B.text}" data-time="${B.time}" style="left: ${M}%"></span>`;(0,a.append)(C,K)}}),h.constructor.USE_RAF?h.on("raf",()=>{h.emit("setBar","played",h.played),h.emit("setBar","loaded",h.loaded)}):(h.on("video:timeupdate",()=>{h.emit("setBar","played",h.played)}),h.on("video:progress",()=>{h.emit("setBar","loaded",h.loaded)}),h.on("video:ended",()=>{h.emit("setBar","played",1)})),h.emit("setBar","loaded",h.loaded||0),a.isMobile||(y(v,"click",P=>{P.target!==D&&u(h,P)}),y(v,"mousemove",P=>{let{percentage:B}=l(h,P);if(h.emit("setBar","hover",B,P),(0,a.setStyle)(N,"display","flex"),(0,a.includeFromEvent)(P,C)){let{width:M}=l(h,P),{text:K}=P.target.dataset;N.textContent=K;let tt=N.clientWidth;M<=tt/2?(0,a.setStyle)(N,"left",0):M>v.clientWidth-tt/2?(0,a.setStyle)(N,"left",`${v.clientWidth-tt}px`):(0,a.setStyle)(N,"left",`${M-tt/2}px`)}else w(P)}),y(v,"mouseleave",P=>{(0,a.setStyle)(N,"display","none"),h.emit("setBar","hover",0,P)}),y(v,"mousedown",P=>{T=P.button===0}),h.on("document:mousemove",P=>{if(T){let{second:B,percentage:M}=l(h,P);h.emit("setBar","played",M,P),h.seek=B}}),h.on("document:mouseup",()=>{T&&(T=!1)}))}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dIscA:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Screenshot"),mounted:f=>{let{proxy:h,icons:p}=d;(0,a.append)(f,p.screenshot),h(f,"click",()=>{d.screenshot()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aqA0g:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,tooltip:d.i18n.get("Show Setting"),mounted:f=>{let{proxy:h,icons:p,i18n:g}=d;(0,a.append)(f,p.setting),h(f,"click",()=>{d.setting.toggle(),d.setting.resize()}),d.on("setting",y=>{(0,a.tooltip)(f,g.get(y?"Hide Setting":"Show Setting"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ihweO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,style:a.isMobile?{fontSize:"12px",padding:"0 5px"}:{cursor:"auto",padding:"0 10px"},mounted:f=>{function h(){let g=`${(0,a.secondToTime)(d.currentTime)} / ${(0,a.secondToTime)(d.duration)}`;g!==f.textContent&&(f.textContent=g)}h();let p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let g=0;g<p.length;g++)d.on(p[g],h)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fJVWn:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return d=>({...u,mounted:f=>{let{proxy:h,icons:p}=d,g=(0,a.append)(f,p.volume),y=(0,a.append)(f,p.volumeClose),v=(0,a.append)(f,'<div class="art-volume-panel"></div>'),S=(0,a.append)(v,'<div class="art-volume-inner"></div>'),T=(0,a.append)(S,'<div class="art-volume-val"></div>'),A=(0,a.append)(S,'<div class="art-volume-slider"></div>'),b=(0,a.append)(A,'<div class="art-volume-handle"></div>'),R=(0,a.append)(b,'<div class="art-volume-loaded"></div>'),C=(0,a.append)(A,'<div class="art-volume-indicator"></div>');function D(w){let{top:P,height:B}=(0,a.getRect)(A);return 1-(w.clientY-P)/B}function N(){if(d.muted||d.volume===0)(0,a.setStyle)(g,"display","none"),(0,a.setStyle)(y,"display","flex"),(0,a.setStyle)(C,"top","100%"),(0,a.setStyle)(R,"top","100%"),T.textContent=0;else{let w=100*d.volume;(0,a.setStyle)(g,"display","flex"),(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(C,"top",`${100-w}%`),(0,a.setStyle)(R,"top",`${100-w}%`),T.textContent=Math.floor(w)}}if(N(),d.on("video:volumechange",N),h(g,"click",()=>{d.muted=!0}),h(y,"click",()=>{d.muted=!1}),a.isMobile)(0,a.setStyle)(v,"display","none");else{let w=!1;h(A,"mousedown",P=>{w=P.button===0,d.volume=D(P)}),d.on("document:mousemove",P=>{w&&(d.muted=!1,d.volume=D(P))}),d.on("document:mouseup",()=>{w&&(w=!1)})}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jmVSD:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./clickInit"),l=s.interopDefault(a),u=r("./gestureInit"),d=s.interopDefault(u),f=r("./globalInit"),h=s.interopDefault(f),p=r("./hoverInit"),g=s.interopDefault(p),y=r("./moveInit"),v=s.interopDefault(y),S=r("./resizeInit"),T=s.interopDefault(S),A=r("./updateInit"),b=s.interopDefault(A),R=r("./viewInit"),C=s.interopDefault(R);e.default=class{constructor(D){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),(0,l.default)(D,this),(0,g.default)(D,this),(0,v.default)(D,this),(0,T.default)(D,this),(0,d.default)(D,this),(0,C.default)(D,this),(0,h.default)(D,this),(0,b.default)(D,this)}proxy(D,N,w,P={}){if(Array.isArray(N))return N.map(M=>this.proxy(D,M,w,P));D.addEventListener(N,w,P);let B=()=>D.removeEventListener(N,w,P);return this.destroyEvents.push(B),B}hover(D,N,w){N&&this.proxy(D,"mouseenter",N),w&&this.proxy(D,"mouseleave",w)}remove(D){let N=this.destroyEvents.indexOf(D);N>-1&&(D(),this.destroyEvents.splice(N,1))}destroy(){for(let D=0;D<this.destroyEvents.length;D++)this.destroyEvents[D]()}}},{"./clickInit":"i8G6V","./gestureInit":"9wEzB","./globalInit":"ikBrS","./hoverInit":"jwNq0","./moveInit":"eqSsP","./resizeInit":"42JNz","./updateInit":"7kM1M","./viewInit":"2IW9m","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i8G6V:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{constructor:f,template:{$player:h,$video:p}}=u;function g(v){(0,a.includeFromEvent)(v,h)?(u.isInput=v.target.tagName==="INPUT",u.isFocus=!0,u.emit("focus",v)):(u.isInput=!1,u.isFocus=!1,u.emit("blur",v))}u.on("document:click",g),u.on("document:contextmenu",g);let y=[];d.proxy(p,"click",v=>{let S=Date.now();y.push(S);let{MOBILE_CLICK_PLAY:T,DBCLICK_TIME:A,MOBILE_DBCLICK_PLAY:b,DBCLICK_FULLSCREEN:R}=f,C=y.filter(D=>S-D<=A);switch(C.length){case 1:u.emit("click",v),a.isMobile?!u.isLock&&T&&u.toggle():u.toggle(),y=C;break;case 2:u.emit("dblclick",v),a.isMobile?!u.isLock&&b&&u.toggle():R&&(u.fullscreen=!u.fullscreen),y=[];break;default:y=[]}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"9wEzB":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>u);var a=r("../control/progress"),l=r("../utils");function u(d,f){if(l.isMobile&&!d.option.isLive){let{$video:h,$progress:p}=d.template,g=null,y=!1,v=0,S=0,T=0,A=R=>{if(R.touches.length===1&&!d.isLock){g===p&&(0,a.setCurrentTime)(d,R),y=!0;let{pageX:C,pageY:D}=R.touches[0];v=C,S=D,T=d.currentTime}},b=R=>{if(R.touches.length===1&&y&&d.duration){let{pageX:C,pageY:D}=R.touches[0],N=(function(B,M,K,tt){let z=M-tt,G=K-B,Y=0;if(2>Math.abs(G)&&2>Math.abs(z))return Y;let O=180*Math.atan2(z,G)/Math.PI;return O>=-45&&O<45?Y=4:O>=45&&O<135?Y=1:O>=-135&&O<-45?Y=2:(O>=135&&O<=180||O>=-180&&O<-135)&&(Y=3),Y})(v,S,C,D),w=[3,4].includes(N),P=[1,2].includes(N);if(w&&!d.isRotate||P&&d.isRotate){let B=(0,l.clamp)((C-v)/d.width,-1,1),M=(0,l.clamp)((D-S)/d.height,-1,1),K=d.isRotate?M:B,tt=g===h?d.constructor.TOUCH_MOVE_RATIO:1,z=(0,l.clamp)(T+d.duration*K*tt,0,d.duration);d.seek=z,d.emit("setBar","played",(0,l.clamp)(z/d.duration,0,1),R),d.notice.show=`${(0,l.secondToTime)(z)} / ${(0,l.secondToTime)(d.duration)}`}}};d.option.gesture&&(f.proxy(h,"touchstart",R=>{g=h,A(R)}),f.proxy(h,"touchmove",b)),f.proxy(p,"touchstart",R=>{g=p,A(R)}),f.proxy(p,"touchmove",b),d.on("document:touchend",()=>{y&&(v=0,S=0,T=0,y=!1,g=null)})}}},{"../control/progress":"1XZSS","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ikBrS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let d=["click","mouseup","keydown","touchend","touchmove","mousemove","pointerup","contextmenu","pointermove","visibilitychange","webkitfullscreenchange"],f=["resize","scroll","orientationchange"],h=[];function p(g={}){for(let v=0;v<h.length;v++)u.remove(h[v]);h.length=0;let{$player:y}=l.template;d.forEach(v=>{let S=g.document||y.ownerDocument||document,T=u.proxy(S,v,A=>{l.emit(`document:${v}`,A)});h.push(T)}),f.forEach(v=>{let S=g.window||y.ownerDocument?.defaultView||window,T=u.proxy(S,v,A=>{l.emit(`window:${v}`,A)});h.push(T)})}p(),u.bindGlobalEvents=p}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jwNq0:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{$player:f}=u.template;d.hover(f,h=>{(0,a.addClass)(f,"art-hover"),u.emit("hover",!0,h)},h=>{(0,a.removeClass)(f,"art-hover"),u.emit("hover",!1,h)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eqSsP:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l,u){let{$player:d}=l.template;u.proxy(d,"mousemove",f=>{l.emit("mousemove",f)})}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"42JNz":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u,d){let{option:f,constructor:h}=u;u.on("resize",()=>{let{aspectRatio:g,notice:y}=u;u.state==="standard"&&f.autoSize&&u.autoSize(),u.aspectRatio=g,y.show=""});let p=(0,a.debounce)(()=>u.emit("resize"),h.RESIZE_TIME);u.on("window:orientationchange",()=>p()),u.on("window:resize",()=>p()),screen&&screen.orientation&&screen.orientation.onchange&&d.proxy(screen.orientation,"change",()=>p())}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7kM1M":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){if(l.constructor.USE_RAF){let u=null;(function d(){l.playing&&l.emit("raf"),l.isDestroy||(u=requestAnimationFrame(d))})(),l.on("destroy",()=>{cancelAnimationFrame(u)})}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2IW9m":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,constructor:f,template:{$container:h}}=u,p=(0,a.throttle)(()=>{u.emit("view",(0,a.isInViewport)(h,f.SCROLL_GAP))},f.SCROLL_TIME);u.on("window:scroll",()=>p()),u.on("view",g=>{d.autoMini&&(u.mini=!g)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dswts:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("./utils");e.default=class{constructor(a){this.art=a,this.keys={},a.option.hotkey&&!s.isMobile&&this.init()}init(){let{constructor:a}=this.art;this.add("Escape",()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add("Space",()=>{this.art.toggle()}),this.add("ArrowLeft",()=>{this.art.backward=a.SEEK_STEP}),this.add("ArrowUp",()=>{this.art.volume+=a.VOLUME_STEP}),this.add("ArrowRight",()=>{this.art.forward=a.SEEK_STEP}),this.add("ArrowDown",()=>{this.art.volume-=a.VOLUME_STEP}),this.art.on("document:keydown",l=>{if(this.art.isFocus){let u=document.activeElement.tagName.toUpperCase(),d=document.activeElement.getAttribute("contenteditable");if(u!=="INPUT"&&u!=="TEXTAREA"&&d!==""&&d!=="true"&&!l.altKey&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey){let f=this.keys[l.code];if(f){l.preventDefault();for(let h=0;h<f.length;h++)f[h].call(this.art,l);this.art.emit("hotkey",l)}}}this.art.emit("keydown",l)})}add(a,l){return this.keys[a]?this.keys[a].push(l):this.keys[a]=[l],this}remove(a,l){if(this.keys[a]){let u=this.keys[a].indexOf(l);u!==-1&&this.keys[a].splice(u,1)}return this}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d9ktO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("./zh-cn"),u=s.interopDefault(l);e.default=class{constructor(d){this.art=d,this.languages={"zh-cn":u.default},this.language={},this.update(d.option.i18n)}init(){let d=this.art.option.lang.toLowerCase();this.language=this.languages[d]||{}}get(d){return this.language[d]||d}update(d){this.languages=(0,a.mergeDeep)(this.languages,d),this.init()}}},{"../utils":"aBlEo","./zh-cn":"3hyaR","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3hyaR":[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let s={"Video Info":"",Close:"","Video Load Failed":"",Volume:"",Play:"",Pause:"",Rate:"",Mute:"","Video Flip":"",Horizontal:"",Vertical:"",Reconnect:"","Show Setting":"","Hide Setting":"",Screenshot:"","Play Speed":"","Aspect Ratio":"",Default:"",Normal:"",Open:"","Switch Video":"","Switch Subtitle":"",Fullscreen:"","Exit Fullscreen":"","Web Fullscreen":"","Exit Web Fullscreen":"","Mini Player":"","PIP Mode":"","Exit PIP Mode":"","PIP Not Supported":"","Fullscreen Not Supported":"","Subtitle Offset":"","Last Seen":"","Jump Play":"",AirPlay:"","AirPlay Not Available":""};e.default=s,typeof window<"u"&&(window["artplayer-i18n-zh-cn"]=s)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fFHY0:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("bundle-text:./airplay.svg"),l=s.interopDefault(a),u=r("bundle-text:./arrow-left.svg"),d=s.interopDefault(u),f=r("bundle-text:./arrow-right.svg"),h=s.interopDefault(f),p=r("bundle-text:./aspect-ratio.svg"),g=s.interopDefault(p),y=r("bundle-text:./check.svg"),v=s.interopDefault(y),S=r("bundle-text:./close.svg"),T=s.interopDefault(S),A=r("bundle-text:./config.svg"),b=s.interopDefault(A),R=r("bundle-text:./error.svg"),C=s.interopDefault(R),D=r("bundle-text:./flip.svg"),N=s.interopDefault(D),w=r("bundle-text:./fullscreen-off.svg"),P=s.interopDefault(w),B=r("bundle-text:./fullscreen-on.svg"),M=s.interopDefault(B),K=r("bundle-text:./fullscreen-web-off.svg"),tt=s.interopDefault(K),z=r("bundle-text:./fullscreen-web-on.svg"),G=s.interopDefault(z),Y=r("bundle-text:./loading.svg"),O=s.interopDefault(Y),j=r("bundle-text:./lock.svg"),V=s.interopDefault(j),nt=r("bundle-text:./pause.svg"),ut=s.interopDefault(nt),k=r("bundle-text:./pip.svg"),$=s.interopDefault(k),st=r("bundle-text:./play.svg"),ct=s.interopDefault(st),ft=r("bundle-text:./playback-rate.svg"),dt=s.interopDefault(ft),Et=r("bundle-text:./screenshot.svg"),Lt=s.interopDefault(Et),_t=r("bundle-text:./setting.svg"),ee=s.interopDefault(_t),he=r("bundle-text:./state.svg"),Re=s.interopDefault(he),De=r("bundle-text:./switch-off.svg"),Le=s.interopDefault(De),Fi=r("bundle-text:./switch-on.svg"),bt=s.interopDefault(Fi),pt=r("bundle-text:./unlock.svg"),Se=s.interopDefault(pt),oe=r("bundle-text:./volume-close.svg"),le=s.interopDefault(oe),Ie=r("bundle-text:./volume.svg"),Ue=s.interopDefault(Ie),je=r("../utils");e.default=class{constructor(ie){let on={loading:O.default,state:Re.default,play:ct.default,pause:ut.default,check:v.default,volume:Ue.default,volumeClose:le.default,screenshot:Lt.default,setting:ee.default,pip:$.default,arrowLeft:d.default,arrowRight:h.default,playbackRate:dt.default,aspectRatio:g.default,config:b.default,lock:V.default,flip:N.default,unlock:Se.default,fullscreenOff:P.default,fullscreenOn:M.default,fullscreenWebOff:tt.default,fullscreenWebOn:G.default,switchOn:bt.default,switchOff:Le.default,error:C.default,close:T.default,airplay:l.default,...ie.option.icons};for(let qe in on)(0,je.def)(this,qe,{get:()=>(0,je.getIcon)(qe,on[qe])})}}},{"bundle-text:./airplay.svg":"gkZgZ","bundle-text:./arrow-left.svg":"kQyD4","bundle-text:./arrow-right.svg":"64ztm","bundle-text:./aspect-ratio.svg":"72LvA","bundle-text:./check.svg":"4QmBo","bundle-text:./close.svg":"j1hoe","bundle-text:./config.svg":"hNZaT","bundle-text:./error.svg":"dKh4l","bundle-text:./flip.svg":"lIEIE","bundle-text:./fullscreen-off.svg":"1533e","bundle-text:./fullscreen-on.svg":"76ut3","bundle-text:./fullscreen-web-off.svg":"3NzMk","bundle-text:./fullscreen-web-on.svg":"12xHc","bundle-text:./loading.svg":"iVcUF","bundle-text:./lock.svg":"1J4so","bundle-text:./pause.svg":"1KgkK","bundle-text:./pip.svg":"4h4tM","bundle-text:./play.svg":"jecAY","bundle-text:./playback-rate.svg":"anPe9","bundle-text:./screenshot.svg":"9BPYQ","bundle-text:./setting.svg":"hsI9k","bundle-text:./state.svg":"gr1ZU","bundle-text:./switch-off.svg":"6kdAr","bundle-text:./switch-on.svg":"ksdMo","bundle-text:./unlock.svg":"iz5Qc","bundle-text:./volume-close.svg":"3OZoa","bundle-text:./volume.svg":"hRYA4","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],gkZgZ:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/><path d="M4 17h10l-5-6Z"/></svg>'},{}],kQyD4:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6Z"/></svg>'},{}],"64ztm":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6Z"/></svg>'},{}],"72LvA":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;transform:translate(0)" viewBox="0 0 88 88"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0Z"/></clipPath></defs><g clip-path="url(#__lottie_element_216)"><g style="display:block"><path d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 1.4495849676166017e-7l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31C14.488-13.492 13.228-13.492 12.438-12.702m-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13ZM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8Z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></g></svg>'},{}],"4QmBo":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%" viewBox="0 0 24 24"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4Z"/></svg>'},{}],j1hoe:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733C823.467 166.4 797.867 166.4 780.8 183.466L512 452.267l-268.8-268.8C226.133 166.4 200.533 166.4 183.467 183.466c-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733Z"/></svg>'},{}],hNZaT:[function(r,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M15 17h6v1h-6Zm-4 0H3v1h8v2h1v-5h-1Zm3-9h1V3h-1v2H3v1h11Zm4-3v1h3V5ZM6 14h1V9H6v2H3v1h3Zm4-2h11v-1H10Z" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],dKh4l:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.1 93.1 0 0 1 34.447 33.341M512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88m0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2"/></svg>'},{}],lIEIE:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon" viewBox="0 0 1024 1024"><path d="M554.667 810.667V896h-85.333v-85.333Zm-384-632.662a42.67 42.67 0 0 1 34.987 18.219l203.903 291.328a42.67 42.67 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667m682.666 0a42.667 42.667 0 0 1 42.368 37.717l.299 4.95v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.67 42.67 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.67 42.67 0 0 1 34.944-18.219M554.667 640v85.333h-85.333V640Zm-358.4-320.896V716.8L335.957 512 196.31 319.104Zm358.4 150.23v85.333h-85.333v-85.333Zm0-170.667V384h-85.333v-85.333Zm0-170.667v85.333h-85.333V128Z"/></svg>'},{}],"1533e":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M768 298.667h170.667V384h-256V128H768ZM341.333 384h-256v-85.333H256V128h85.333ZM768 725.333V896h-85.333V640h256v85.333ZM341.333 640v256H256V725.333H85.333V640Z"/></svg>'},{}],"76ut3":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M625.778 256H768v142.222h113.778v-256h-256ZM256 398.222V256h142.222V142.222h-256v256Zm512 227.556V768H625.778v113.778h256v-256ZM398.222 768H256V625.778H142.222v256h256Z"/></svg>'},{}],"3NzMk":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128ZM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384Zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448Z"/></svg>'},{}],"12xHc":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128Zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448Zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384Z"/></svg>'},{}],iVcUF:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" class="uil-default" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><path fill="none" d="M0 0h100v100H0Z" class="bk"/><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="translate(0 -30)"><animate attributeName="opacity" begin="-1s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(30 105.98 65)"><animate attributeName="opacity" begin="-0.9166666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(60 75.98 65)"><animate attributeName="opacity" begin="-0.8333333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(90 65 65)"><animate attributeName="opacity" begin="-0.75s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(120 58.66 65)"><animate attributeName="opacity" begin="-0.6666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(150 54.02 65)"><animate attributeName="opacity" begin="-0.5833333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="matrix(-1 0 0 -1 100 130)"><animate attributeName="opacity" begin="-0.5s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(210 45.98 65)"><animate attributeName="opacity" begin="-0.4166666666666667s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(240 41.34 65)"><animate attributeName="opacity" begin="-0.3333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-90 35 65)"><animate attributeName="opacity" begin="-0.25s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" begin="-0.16666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" begin="-0.08333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect></svg>'},{}],"1J4so":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="M298.667 426.667v-85.333a213.333 213.333 0 1 1 426.667 0v85.333H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667ZM512 213.333a128 128 0 0 0-128 128v85.333h256v-85.333a128 128 0 0 0-128-128"/></svg>'},{}],"1KgkK":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2m8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2"/></svg>'},{}],"4h4tM":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 1024 1024"><path d="M844.8 219.648H179.2c-6.144 0-10.24 4.608-10.24 10.752v563.2c0 5.632 4.096 10.24 10.24 10.24h256V896h-256A102.4 102.4 0 0 1 76.8 793.6V230.4c0-56.832 45.568-102.4 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v204.8h-92.16V230.4c0-6.144-4.608-10.752-10.24-10.752M614.4 588.8c-28.672 0-51.2 22.528-51.2 51.2v204.8c0 28.16 22.528 51.2 51.2 51.2H896c28.16 0 51.2-23.04 51.2-51.2V640c0-28.672-23.04-51.2-51.2-51.2Z"/></svg>'},{}],jecAY:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45"/></svg>'},{}],anPe9:[function(r,t,e,i){t.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M10 8v8l6-4ZM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2M5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8m0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4Zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22ZM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"9BPYQ":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10m0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8"/></svg>'},{}],hsI9k:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a7 7 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1 1 0 0 0-1.272.23l-1.008 1.225a7 7 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A7 7 0 0 0 4.4 8.6l-1.564.261A1 1 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.1 7.1 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a1 1 0 0 0 .835-.986V9.847a1 1 0 0 0-.836-.986M11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8"/></svg>'},{}],gr1ZU:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><path d="M9.5 9.325v5.35q0 .575.525.875t1.025-.05l4.15-2.65q.475-.3.475-.85t-.475-.85L11.05 8.5q-.5-.35-1.025-.05t-.525.875M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12t.788-3.9 2.137-3.175q1.35-1.35 3.175-2.137T12 2t3.9.788 3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22"/></svg>'},{}],"6kdAr":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1740 1024"><path d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898m-.564-975.36A464.589 464.589 0 1 1 48.025 513.024 463.87 463.87 0 0 1 511.335 48.435Z"/></svg>'},{}],ksdMo:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1664 1024"><path fill="#648ffc" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448"/></svg>'},{}],iz5Qc:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.333a213.333 213.333 0 0 1 368.085-146.816"/></svg>'},{}],"3OZoa":[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M15 11a4 4 0 0 0-2-3.465v2.636l1.865 1.865A4 4 0 0 0 15 11"/><path d="M13.583 5.583A6 6 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8 8 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805m5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806q.322-.154.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416M11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172Z"/></svg>'},{}],hRYA4:[function(r,t,e,i){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39m4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8 8 0 0 0 19 11a8 8 0 0 0-4.554-7.222"/><path d="M15 11a4 4 0 0 0-2-3.465v6.93A4 4 0 0 0 15 11"/></svg>'},{}],kZ0F8:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="info",a.isMobile||this.init()}init(){let{proxy:h,constructor:p,template:{$infoPanel:g,$infoClose:y,$video:v}}=this.art;h(y,"click",()=>{this.show=!1});let S=null,T=(0,a.queryAll)("[data-video]",g)||[];this.art.on("destroy",()=>clearTimeout(S)),(function A(){for(let b=0;b<T.length;b++){let R=T[b],C=v[R.dataset.video],D=typeof C=="number"?C.toFixed(2):C;R.textContent!==D&&(R.textContent=D)}S=setTimeout(A,p.INFO_LOOP_TIME)})()}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j9lbi:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils/component"),l=s.interopDefault(a);class u extends l.default{constructor(f){super(f);let{option:h,template:{$layer:p}}=f;this.name="layer",this.$parent=p;for(let g=0;g<h.layers.length;g++)this.add(h.layers[g])}}e.default=u},{"./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bMjWd:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="loading",(0,a.append)(h.template.$loading,h.icons.loading)}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k1nkQ:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./utils"),l=r("./utils/component"),u=s.interopDefault(l);class d extends u.default{constructor(h){super(h),this.name="mask";let{template:p,icons:g,events:y}=h,v=(0,a.append)(p.$state,g.state),S=(0,a.append)(p.$state,g.error);(0,a.setStyle)(S,"display","none"),h.on("destroy",()=>{(0,a.setStyle)(v,"display","none"),(0,a.setStyle)(S,"display",null)}),y.proxy(p.$state,"click",()=>h.play())}}e.default=d},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fPVaU:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("./utils");e.default=class{constructor(a){this.art=a,this.timer=null}set show(a){let{constructor:l,template:{$player:u,$noticeInner:d}}=this.art;a?(d.textContent=a instanceof Error?a.message.trim():a,(0,s.addClass)(u,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{d.textContent="",(0,s.removeClass)(u,"art-notice-show")},l.NOTICE_TIME)):(0,s.removeClass)(u,"art-notice-show")}get show(){let{template:{$player:a}}=this.art;return a.classList.contains("art-notice-show")}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],uR0Sw:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("./airplayMix"),l=s.interopDefault(a),u=r("./aspectRatioMix"),d=s.interopDefault(u),f=r("./attrMix"),h=s.interopDefault(f),p=r("./autoHeightMix"),g=s.interopDefault(p),y=r("./autoSizeMix"),v=s.interopDefault(y),S=r("./cssVarMix"),T=s.interopDefault(S),A=r("./currentTimeMix"),b=s.interopDefault(A),R=r("./durationMix"),C=s.interopDefault(R),D=r("./eventInit"),N=s.interopDefault(D),w=r("./flipMix"),P=s.interopDefault(w),B=r("./fullscreenMix"),M=s.interopDefault(B),K=r("./fullscreenWebMix"),tt=s.interopDefault(K),z=r("./loadedMix"),G=s.interopDefault(z),Y=r("./miniMix"),O=s.interopDefault(Y),j=r("./optionInit"),V=s.interopDefault(j),nt=r("./pauseMix"),ut=s.interopDefault(nt),k=r("./pipMix"),$=s.interopDefault(k),st=r("./playbackRateMix"),ct=s.interopDefault(st),ft=r("./playedMix"),dt=s.interopDefault(ft),Et=r("./playingMix"),Lt=s.interopDefault(Et),_t=r("./playMix"),ee=s.interopDefault(_t),he=r("./posterMix"),Re=s.interopDefault(he),De=r("./qualityMix"),Le=s.interopDefault(De),Fi=r("./rectMix"),bt=s.interopDefault(Fi),pt=r("./screenshotMix"),Se=s.interopDefault(pt),oe=r("./seekMix"),le=s.interopDefault(oe),Ie=r("./stateMix"),Ue=s.interopDefault(Ie),je=r("./subtitleOffsetMix"),ie=s.interopDefault(je),on=r("./switchMix"),qe=s.interopDefault(on),ps=r("./themeMix"),Nn=s.interopDefault(ps),Xs=r("./thumbnailsMix"),gs=s.interopDefault(Xs),ln=r("./toggleMix"),Fu=s.interopDefault(ln),ys=r("./typeMix"),Ge=s.interopDefault(ys),Bi=r("./urlMix"),He=s.interopDefault(Bi),Bu=r("./volumeMix"),Uu=s.interopDefault(Bu);e.default=class{constructor(Ot){(0,He.default)(Ot),(0,h.default)(Ot),(0,ee.default)(Ot),(0,ut.default)(Ot),(0,Fu.default)(Ot),(0,le.default)(Ot),(0,Uu.default)(Ot),(0,b.default)(Ot),(0,C.default)(Ot),(0,qe.default)(Ot),(0,ct.default)(Ot),(0,d.default)(Ot),(0,Se.default)(Ot),(0,M.default)(Ot),(0,tt.default)(Ot),(0,$.default)(Ot),(0,G.default)(Ot),(0,dt.default)(Ot),(0,Lt.default)(Ot),(0,v.default)(Ot),(0,bt.default)(Ot),(0,P.default)(Ot),(0,O.default)(Ot),(0,Re.default)(Ot),(0,g.default)(Ot),(0,T.default)(Ot),(0,Nn.default)(Ot),(0,Ge.default)(Ot),(0,Ue.default)(Ot),(0,ie.default)(Ot),(0,l.default)(Ot),(0,Le.default)(Ot),(0,gs.default)(Ot),(0,N.default)(Ot),(0,V.default)(Ot)}}},{"./airplayMix":"d8BTB","./aspectRatioMix":"aQNJl","./attrMix":"5DA9e","./autoHeightMix":"1swKn","./autoSizeMix":"lSbiD","./cssVarMix":"32Hp1","./currentTimeMix":"kfZbu","./durationMix":"eV1ag","./eventInit":"f8NQq","./flipMix":"ea3Qm","./fullscreenMix":"ffXE3","./fullscreenWebMix":"8tarF","./loadedMix":"f9syH","./miniMix":"dLuS7","./optionInit":"d1F69","./pauseMix":"kewk9","./pipMix":"4XzDs","./playbackRateMix":"jphfi","./playedMix":"iNpeS","./playingMix":"aBIWL","./playMix":"hRBri","./posterMix":"fgfXC","./qualityMix":"17rUP","./rectMix":"55qzI","./screenshotMix":"bC6TG","./seekMix":"j8GRO","./stateMix":"cn7iR","./subtitleOffsetMix":"2k4nP","./switchMix":"6SU6j","./themeMix":"7iMuh","./thumbnailsMix":"6P0RS","./toggleMix":"eNi78","./typeMix":"7AUBD","./urlMix":"cnlLL","./volumeMix":"iX66j","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d8BTB:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,proxy:h,template:{$video:p}}=u,g=!0;window.WebKitPlaybackTargetAvailabilityEvent&&p.webkitShowPlaybackTargetPicker?h(p,"webkitplaybacktargetavailabilitychanged",y=>{switch(y.availability){case"available":g=!0;break;case"not-available":g=!1}}):g=!1,(0,a.def)(u,"airplay",{value(){g?(p.webkitShowPlaybackTargetPicker(),u.emit("airplay")):f.show=d.get("AirPlay Not Available")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aQNJl:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,template:{$video:h,$player:p}}=u;(0,a.def)(u,"aspectRatio",{get:()=>p.dataset.aspectRatio||"default",set(g){if(g||(g="default"),g==="default")(0,a.setStyle)(h,"width",null),(0,a.setStyle)(h,"height",null),(0,a.setStyle)(h,"margin",null),delete p.dataset.aspectRatio;else{let y=g.split(":").map(Number),{clientWidth:v,clientHeight:S}=p,T=y[0]/y[1];v/S>T?((0,a.setStyle)(h,"width",`${T*S}px`),(0,a.setStyle)(h,"height","100%"),(0,a.setStyle)(h,"margin","0 auto")):((0,a.setStyle)(h,"width","100%"),(0,a.setStyle)(h,"height",`${v/T}px`),(0,a.setStyle)(h,"margin","auto 0")),p.dataset.aspectRatio=g}f.show=`${d.get("Aspect Ratio")}: ${g==="default"?d.get("Default"):g}`,u.emit("aspectRatio",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"5DA9e":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d}}=u;(0,a.def)(u,"attr",{value(f,h){if(h===void 0)return d[f];d[f]=h}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1swKn":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$container:d,$video:f}}=u;(0,a.def)(u,"autoHeight",{value(){let{clientWidth:h}=d,{videoHeight:p,videoWidth:g}=f,y=h/g*p;(0,a.setStyle)(d,"height",`${y}px`),u.emit("autoHeight",y)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],lSbiD:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$container:d,$player:f,$video:h}=u.template;(0,a.def)(u,"autoSize",{value(){let{videoWidth:p,videoHeight:g}=h,{width:y,height:v}=(0,a.getRect)(d),S=p/g;y/v>S?((0,a.setStyle)(f,"width",`${v*S/y*100}%`),(0,a.setStyle)(f,"height","100%")):((0,a.setStyle)(f,"width","100%"),(0,a.setStyle)(f,"height",`${y/S/v*100}%`)),u.emit("autoSize",{width:u.width,height:u.height})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"32Hp1":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$player:d}=u.template;(0,a.def)(u,"cssVar",{value:(f,h)=>h?d.style.setProperty(f,h):getComputedStyle(d).getPropertyValue(f)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kfZbu:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"currentTime",{get:()=>d.currentTime||0,set:f=>{Number.isNaN(f=Number.parseFloat(f))||(d.currentTime=(0,a.clamp)(f,0,u.duration))}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eV1ag:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"duration",{get:()=>{let{duration:d}=u.template.$video;return d===1/0?0:d||0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f8NQq:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>d);var a=r("../config"),l=s.interopDefault(a),u=r("../utils");function d(f){let{i18n:h,notice:p,option:g,constructor:y,proxy:v,template:{$player:S,$video:T,$poster:A}}=f,b=0;for(let R=0;R<l.default.events.length;R++)v(T,l.default.events[R],C=>{f.emit(`video:${C.type}`,C)});f.on("video:canplay",()=>{b=0,f.loading.show=!1}),f.once("video:canplay",()=>{f.loading.show=!1,f.controls.show=!0,f.mask.show=!0,f.isReady=!0,f.emit("ready")}),f.on("video:ended",()=>{g.loop?(f.seek=0,f.play(),f.controls.show=!1,f.mask.show=!1):(f.controls.show=!0,f.mask.show=!0)}),f.on("video:error",async R=>{b<y.RECONNECT_TIME_MAX?(await(0,u.sleep)(y.RECONNECT_SLEEP_TIME),b+=1,f.url=g.url,p.show=`${h.get("Reconnect")}: ${b}`,f.emit("error",R,b)):(f.mask.show=!0,f.loading.show=!1,f.controls.show=!0,(0,u.addClass)(S,"art-error"),await(0,u.sleep)(y.RECONNECT_SLEEP_TIME),p.show=h.get("Video Load Failed"))}),f.on("video:loadedmetadata",()=>{f.emit("resize"),u.isMobile&&(f.loading.show=!1,f.controls.show=!0,f.mask.show=!0)}),f.on("video:loadstart",()=>{f.loading.show=!0,f.mask.show=!1,f.controls.show=!0}),f.on("video:pause",()=>{f.controls.show=!0,f.mask.show=!0}),f.on("video:play",()=>{f.mask.show=!1,(0,u.setStyle)(A,"display","none")}),f.on("video:playing",()=>{f.mask.show=!1}),f.on("video:progress",()=>{f.playing&&(f.loading.show=!1)}),f.on("video:seeked",()=>{f.loading.show=!1,f.mask.show=!0}),f.on("video:seeking",()=>{f.loading.show=!0,f.mask.show=!1}),f.on("video:timeupdate",()=>{f.mask.show=!1}),f.on("video:waiting",()=>{f.loading.show=!0,f.mask.show=!1})}},{"../config":"eJfh8","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ea3Qm:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$player:d},i18n:f,notice:h}=u;(0,a.def)(u,"flip",{get:()=>d.dataset.flip||"normal",set(p){p||(p="normal"),p==="normal"?delete d.dataset.flip:d.dataset.flip=p,h.show=`${f.get("Video Flip")}: ${f.get((0,a.capitalize)(p))}`,u.emit("flip",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ffXE3:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>d);var a=r("../libs/screenfull"),l=s.interopDefault(a),u=r("../utils");function d(f){let{i18n:h,notice:p,template:{$video:g,$player:y}}=f;f.once("video:loadedmetadata",()=>{l.default.isEnabled?(l.default.on("change",()=>{f.emit("fullscreen",l.default.isFullscreen),l.default.isFullscreen?(f.state="fullscreen",(0,u.addClass)(y,"art-fullscreen")):(0,u.removeClass)(y,"art-fullscreen"),f.emit("resize")}),l.default.on("error",v=>{f.emit("fullscreenError",v)}),(0,u.def)(f,"fullscreen",{get:()=>l.default.isFullscreen,async set(v){v?await l.default.request(y):await l.default.exit()}})):g.webkitSupportsFullscreen?(f.on("document:webkitfullscreenchange",()=>{f.emit("fullscreen",f.fullscreen),f.emit("resize")}),(0,u.def)(f,"fullscreen",{get:()=>document.fullscreenElement===g,set(v){v?(f.state="fullscreen",g.webkitEnterFullscreen()):g.webkitExitFullscreen()}})):(0,u.def)(f,"fullscreen",{get:()=>!1,set(){p.show=h.get("Fullscreen Not Supported")}}),(0,u.def)(f,"fullscreen",(0,u.get)(f,"fullscreen"))})}},{"../libs/screenfull":"iSPAQ","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iSPAQ:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);let s=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{if(typeof document>"u")return!1;let d=s[0],f={};for(let h of s)if(h[1]in document){for(let[p,g]of h.entries())f[d[p]]=g;return f}return!1})(),l={change:a.fullscreenchange,error:a.fullscreenerror},u={request:(d=document.documentElement,f)=>new Promise((h,p)=>{let g=()=>{u.off("change",g),h()};u.on("change",g);let y=d[a.requestFullscreen](f);y instanceof Promise&&y.then(g).catch(p)}),exit:()=>new Promise((d,f)=>{if(!u.isFullscreen)return void d();let h=()=>{u.off("change",h),d()};u.on("change",h);let p=document[a.exitFullscreen]();p instanceof Promise&&p.then(h).catch(f)}),toggle:(d,f)=>u.isFullscreen?u.exit():u.request(d,f),onchange(d){u.on("change",d)},onerror(d){u.on("error",d)},on(d,f){let h=l[d];h&&document.addEventListener(h,f,!1)},off(d,f){let h=l[d];h&&document.removeEventListener(h,f,!1)},raw:a};Object.defineProperties(u,{isFullscreen:{get:()=>!!document[a.fullscreenElement]},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>!!document[a.fullscreenEnabled]}}),e.default=u},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"8tarF":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{constructor:d,template:{$container:f,$player:h}}=u,p="";(0,a.def)(u,"fullscreenWeb",{get:()=>(0,a.hasClass)(h,"art-fullscreen-web"),set(g){g?(p=h.style.cssText,d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(document.body,h),u.state="fullscreenWeb",(0,a.setStyle)(h,"width","100%"),(0,a.setStyle)(h,"height","100%"),(0,a.addClass)(h,"art-fullscreen-web"),u.emit("fullscreenWeb",!0)):(d.FULLSCREEN_WEB_IN_BODY&&(0,a.append)(f,h),p&&(h.style.cssText=p,p=""),(0,a.removeClass)(h,"art-fullscreen-web"),u.emit("fullscreenWeb",!1)),u.emit("resize")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f9syH:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"loaded",{get:()=>u.loadedTime/d.duration}),(0,a.def)(u,"loadedTime",{get:()=>d.buffered.length?d.buffered.end(d.buffered.length-1):0})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dLuS7:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{icons:d,proxy:f,storage:h,template:{$player:p,$video:g}}=u,y=!1,v=0,S=0;function T(){let{$mini:R}=u.template;R&&((0,a.removeClass)(p,"art-mini"),(0,a.setStyle)(R,"display","none"),p.prepend(g),u.emit("mini",!1))}function A(R,C){u.playing?((0,a.setStyle)(R,"display","none"),(0,a.setStyle)(C,"display","flex")):((0,a.setStyle)(R,"display","flex"),(0,a.setStyle)(C,"display","none"))}function b(){let{$mini:R}=u.template,C=(0,a.getRect)(R),D=window.innerHeight-C.height-50,N=window.innerWidth-C.width-50;h.set("top",D),h.set("left",N),(0,a.setStyle)(R,"top",`${D}px`),(0,a.setStyle)(R,"left",`${N}px`)}(0,a.def)(u,"mini",{get:()=>(0,a.hasClass)(p,"art-mini"),set(R){if(R){u.state="mini",(0,a.addClass)(p,"art-mini");let C=(function(){let{$mini:w}=u.template;if(w)return(0,a.append)(w,g),(0,a.setStyle)(w,"display","flex");{let P=(0,a.createElement)("div");(0,a.addClass)(P,"art-mini-popup"),(0,a.append)(document.body,P),u.template.$mini=P,(0,a.append)(P,g);let B=(0,a.append)(P,'<div class="art-mini-close"></div>');(0,a.append)(B,d.close),f(B,"click",T);let M=(0,a.append)(P,'<div class="art-mini-state"></div>'),K=(0,a.append)(M,d.play),tt=(0,a.append)(M,d.pause);return f(K,"click",()=>u.play()),f(tt,"click",()=>u.pause()),A(K,tt),u.on("video:playing",()=>A(K,tt)),u.on("video:pause",()=>A(K,tt)),u.on("video:timeupdate",()=>A(K,tt)),f(P,"mousedown",z=>{y=z.button===0,v=z.pageX,S=z.pageY}),u.on("document:mousemove",z=>{if(y){(0,a.addClass)(P,"art-mini-dragging");let G=z.pageX-v,Y=z.pageY-S;(0,a.setStyle)(P,"transform",`translate(${G}px, ${Y}px)`)}}),u.on("document:mouseup",()=>{if(y){y=!1,(0,a.removeClass)(P,"art-mini-dragging");let z=(0,a.getRect)(P);h.set("left",z.left),h.set("top",z.top),(0,a.setStyle)(P,"left",`${z.left}px`),(0,a.setStyle)(P,"top",`${z.top}px`),(0,a.setStyle)(P,"transform",null)}}),P}})(),D=h.get("top"),N=h.get("left");typeof D=="number"&&typeof N=="number"?((0,a.setStyle)(C,"top",`${D}px`),(0,a.setStyle)(C,"left",`${N}px`),(0,a.isInViewport)(C)||b()):b(),u.emit("mini",!0)}else T()}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d1F69:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,storage:f,template:{$video:h,$poster:p}}=u;for(let y in d.moreVideoAttr)u.attr(y,d.moreVideoAttr[y]);d.muted&&(u.muted=d.muted),d.volume&&(h.volume=(0,a.clamp)(d.volume,0,1));let g=f.get("volume");for(let y in typeof g=="number"&&(h.volume=(0,a.clamp)(g,0,1)),d.poster&&(0,a.setStyle)(p,"backgroundImage",`url(${d.poster})`),d.autoplay&&(h.autoplay=d.autoplay),d.playsInline&&(h.playsInline=!0,h["webkit-playsinline"]=!0),d.theme&&(d.cssVar["--art-theme"]=d.theme),d.cssVar)u.cssVar(y,d.cssVar[y]);u.url=d.url}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kewk9:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h}=u;(0,a.def)(u,"pause",{value(){let p=d.pause();return h.show=f.get("Pause"),u.emit("pause"),p}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4XzDs":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,template:{$video:h}}=u;if(document.pictureInPictureEnabled){let{template:{$video:p},proxy:g,notice:y}=u;p.disablePictureInPicture=!1,(0,a.def)(u,"pip",{get:()=>document.pictureInPictureElement,set(v){v?(u.state="pip",p.requestPictureInPicture().catch(S=>{throw y.show=S,S})):document.exitPictureInPicture().catch(S=>{throw y.show=S,S})}}),g(p,"enterpictureinpicture",()=>{u.emit("pip",!0)}),g(p,"leavepictureinpicture",()=>{u.emit("pip",!1)})}else if(h.webkitSupportsPresentationMode){let{$video:p}=u.template;p.webkitSetPresentationMode("inline"),(0,a.def)(u,"pip",{get:()=>p.webkitPresentationMode==="picture-in-picture",set(g){g?(u.state="pip",p.webkitSetPresentationMode("picture-in-picture"),u.emit("pip",!0)):(p.webkitSetPresentationMode("inline"),u.emit("pip",!1))}})}else(0,a.def)(u,"pip",{get:()=>!1,set(){f.show=d.get("PIP Not Supported")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jphfi:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h}=u;(0,a.def)(u,"playbackRate",{get:()=>d.playbackRate,set(p){p?p!==d.playbackRate&&(d.playbackRate=p,h.show=`${f.get("Rate")}: ${p===1?f.get("Normal"):`${p}x`}`):u.playbackRate=1}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iNpeS:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"played",{get:()=>u.currentTime/u.duration})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBIWL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{$video:d}=u.template;(0,a.def)(u,"playing",{get:()=>typeof d.playing=="boolean"?d.playing:d.currentTime>0&&!d.paused&&!d.ended&&d.readyState>2})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hRBri:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,notice:f,option:h,constructor:{instances:p},template:{$video:g}}=u;(0,a.def)(u,"play",{async value(){let y=await g.play();if(f.show=d.get("Play"),u.emit("play"),h.mutex)for(let v=0;v<p.length;v++){let S=p[v];S!==u&&S.pause()}return y}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fgfXC:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$poster:d}}=u;(0,a.def)(u,"poster",{get:()=>{try{return d.style.backgroundImage.match(/"(.*)"/)[1]}catch{return""}},set(f){(0,a.setStyle)(d,"backgroundImage",`url(${f})`)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"17rUP":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"quality",{set(d){let{controls:f,notice:h,i18n:p}=u,g=d.find(y=>y.default)||d[0];f.update({name:"quality",position:"right",index:10,style:{marginRight:"10px"},html:g?.html||"",selector:d,onSelect:async y=>(await u.switchQuality(y.url),h.show=`${p.get("Switch Video")}: ${y.html}`,y.html)})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"55qzI":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"rect",{get:()=>(0,a.getRect)(u.template.$player)});let d=["bottom","height","left","right","top","width"];for(let f=0;f<d.length;f++){let h=d[f];(0,a.def)(u,h,{get:()=>u.rect[h]})}(0,a.def)(u,"x",{get:()=>u.left+window.pageXOffset}),(0,a.def)(u,"y",{get:()=>u.top+window.pageYOffset})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bC6TG:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,template:{$video:f}}=u,h=(0,a.createElement)("canvas");(0,a.def)(u,"getDataURL",{value:()=>new Promise((p,g)=>{try{h.width=f.videoWidth,h.height=f.videoHeight,h.getContext("2d").drawImage(f,0,0),p(h.toDataURL("image/png"))}catch(y){d.show=y,g(y)}})}),(0,a.def)(u,"getBlobUrl",{value:()=>new Promise((p,g)=>{try{h.width=f.videoWidth,h.height=f.videoHeight,h.getContext("2d").drawImage(f,0,0),h.toBlob(y=>{p(URL.createObjectURL(y))})}catch(y){d.show=y,g(y)}})}),(0,a.def)(u,"screenshot",{value:async p=>{let g=await u.getDataURL(),y=p||`artplayer_${(0,a.secondToTime)(f.currentTime)}`;return(0,a.download)(g,`${y}.png`),u.emit("screenshot",g),g}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j8GRO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d}=u;(0,a.def)(u,"seek",{set(f){u.currentTime=f,u.duration&&(d.show=`${(0,a.secondToTime)(u.currentTime)} / ${(0,a.secondToTime)(u.duration)}`),u.emit("seek",u.currentTime)}}),(0,a.def)(u,"forward",{set(f){u.seek=u.currentTime+f}}),(0,a.def)(u,"backward",{set(f){u.seek=u.currentTime-f}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cn7iR:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let d=["mini","pip","fullscreen","fullscreenWeb"];(0,a.def)(u,"state",{get:()=>d.find(f=>u[f])||"standard",set(f){for(let h=0;h<d.length;h++){let p=d[h];p!==f&&u[p]&&(u[p]=!1)}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2k4nP":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,i18n:f,template:h}=u;(0,a.def)(u,"subtitleOffset",{get:()=>h.$track?.offset||0,set(p){let{cues:g}=u.subtitle;if(!h.$track||g.length===0)return;let y=(0,a.clamp)(p,-10,10);h.$track.offset=y;for(let v=0;v<g.length;v++){let S=g[v];S.originalStartTime=S.originalStartTime??S.startTime,S.originalEndTime=S.originalEndTime??S.endTime,S.startTime=(0,a.clamp)(S.originalStartTime+y,0,u.duration),S.endTime=(0,a.clamp)(S.originalEndTime+y,0,u.duration)}u.subtitle.update(),d.show=`${f.get("Subtitle Offset")}: ${p}s`,u.emit("subtitleOffset",p)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6SU6j":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){function d(f,h){return new Promise((p,g)=>{if(f===u.url)return;let{playing:y,aspectRatio:v,playbackRate:S}=u;u.pause(),u.url=f,u.notice.show="",u.once("video:error",g),u.once("video:loadedmetadata",()=>{u.currentTime=h}),u.once("video:canplay",async()=>{u.playbackRate=S,u.aspectRatio=v,y&&await u.play(),u.notice.show="",p()})})}(0,a.def)(u,"switchQuality",{value:f=>d(f,u.currentTime)}),(0,a.def)(u,"switchUrl",{value:f=>d(f,0)}),(0,a.def)(u,"switch",{set:u.switchUrl})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7iMuh":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"theme",{get:()=>u.cssVar("--art-theme"),set(d){u.cssVar("--art-theme",d)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6P0RS":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{events:d,option:f,template:{$progress:h,$video:p}}=u,g=null,y=null,v=!1,S=!1,T=!1;d.hover(h,()=>{T=!0},()=>{T=!1}),u.on("setBar",async(A,b,R)=>{let C=u.controls?.thumbnails,{url:D,scale:N}=f.thumbnails;if(!C||!D)return;let w=A==="played"&&R&&a.isMobile;if(A==="hover"||w){if(v||(v=!0,y=await(0,a.loadImg)(D,N),S=!0),!S||!T)return;let P=h.clientWidth*b;(0,a.setStyle)(C,"display","flex"),P>0&&P<h.clientWidth?(function(B){let M=u.controls?.thumbnails;if(!M)return;let{number:K,column:tt,width:z,height:G,scale:Y}=f.thumbnails,O=z*Y||y.naturalWidth/tt,j=G*Y||O/(p.videoWidth/p.videoHeight),V=Math.floor(B/(h.clientWidth/K)),nt=Math.ceil(V/tt)-1;(0,a.setStyle)(M,"backgroundImage",`url(${y.src})`),(0,a.setStyle)(M,"height",`${j}px`),(0,a.setStyle)(M,"width",`${O}px`),(0,a.setStyle)(M,"backgroundPosition",`-${(V%tt||tt-1)*O}px -${nt*j}px`),B<=O/2?(0,a.setStyle)(M,"left",0):B>h.clientWidth-O/2?(0,a.setStyle)(M,"left",`${h.clientWidth-O}px`):(0,a.setStyle)(M,"left",`${B-O/2}px`)})(P):a.isMobile||(0,a.setStyle)(C,"display","none"),w&&(clearTimeout(g),g=setTimeout(()=>{(0,a.setStyle)(C,"display","none")},500))}}),(0,a.def)(u,"thumbnails",{get:()=>u.option.thumbnails,set(A){A.url&&!u.option.isLive&&(u.option.thumbnails=A,clearTimeout(g),g=null,y=null,v=!1,S=!1)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eNi78:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"toggle",{value:()=>u.playing?u.pause():u.play()})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7AUBD":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){(0,a.def)(u,"type",{get:()=>u.option.type,set(d){u.option.type=d}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cnlLL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{option:d,template:{$video:f}}=u;(0,a.def)(u,"url",{get:()=>f.src,async set(h){if(h){let p=u.url,g=d.type||(0,a.getExt)(h),y=d.customType[g];g&&y?(await(0,a.sleep)(),u.loading.show=!0,y.call(u,f,h,u)):(URL.revokeObjectURL(p),f.src=h),p!==u.url&&(u.option.url=h,u.isReady&&p&&u.once("video:canplay",()=>{u.emit("restart",h)}))}else await(0,a.sleep)(),u.loading.show=!0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iX66j:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{template:{$video:d},i18n:f,notice:h,storage:p}=u;(0,a.def)(u,"volume",{get:()=>d.volume||0,set:g=>{d.volume=(0,a.clamp)(g,0,1),h.show=`${f.get("Volume")}: ${Number.parseInt(100*d.volume,10)}`,d.volume!==0&&p.set("volume",d.volume)}}),(0,a.def)(u,"muted",{get:()=>d.muted,set:g=>{d.muted=g,u.emit("muted",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cjxJL:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("./autoOrientation"),u=s.interopDefault(l),d=r("./autoPlayback"),f=s.interopDefault(d),h=r("./fastForward"),p=s.interopDefault(h),g=r("./lock"),y=s.interopDefault(g),v=r("./miniProgressBar"),S=s.interopDefault(v);e.default=class{constructor(T){this.art=T,this.id=0;let{option:A}=T;A.miniProgressBar&&!A.isLive&&this.add(S.default),A.lock&&a.isMobile&&this.add(y.default),A.autoPlayback&&!A.isLive&&this.add(f.default),A.autoOrientation&&a.isMobile&&this.add(u.default),A.fastForward&&a.isMobile&&!A.isLive&&this.add(p.default);for(let b=0;b<A.plugins.length;b++)this.add(A.plugins[b])}add(T){this.id+=1;let A=T.call(this.art,this.art);return A instanceof Promise?A.then(b=>this.next(T,b)):this.next(T,A)}next(T,A){let b=A&&A.name||T.name||`plugin${this.id}`;return(0,a.errorHandle)(!(0,a.has)(this,b),`Cannot add a plugin that already has the same name: ${b}`),(0,a.def)(this,b,{value:A}),this}}},{"../utils":"aBlEo","./autoOrientation":"jb9jb","./autoPlayback":"21HWM","./fastForward":"4sxBO","./lock":"fjy9V","./miniProgressBar":"d0xRp","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jb9jb:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{notice:d,constructor:f,template:{$player:h,$video:p}}=u,g="art-auto-orientation",y="art-auto-orientation-fullscreen",v=!1;function S(){let{videoWidth:T,videoHeight:A}=p,b=document.documentElement.clientWidth,R=document.documentElement.clientHeight;return T>A&&b<R||T<A&&b>R}return u.on("fullscreenWeb",T=>{T?S()&&setTimeout(()=>{u.fullscreenWeb&&!(0,a.hasClass)(h,g)&&(function(){let A=document.documentElement.clientWidth,b=document.documentElement.clientHeight;(0,a.setStyle)(h,"width",`${b}px`),(0,a.setStyle)(h,"height",`${A}px`),(0,a.setStyle)(h,"transform-origin","0 0"),(0,a.setStyle)(h,"transform",`rotate(90deg) translate(0, -${A}px)`),(0,a.addClass)(h,g),u.isRotate=!0,u.emit("resize")})()},Number(f.AUTO_ORIENTATION_TIME??0)):(0,a.hasClass)(h,g)&&((0,a.setStyle)(h,"width",""),(0,a.setStyle)(h,"height",""),(0,a.setStyle)(h,"transform-origin",""),(0,a.setStyle)(h,"transform",""),(0,a.removeClass)(h,g),u.isRotate=!1,u.emit("resize"))}),u.on("fullscreen",async T=>{let A=!!screen?.orientation?.lock;if(T){if(A&&S())try{let b=screen.orientation.type.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(b),v=!0,(0,a.addClass)(h,y)}catch(b){v=!1,d.show=b}}else if((0,a.hasClass)(h,y)&&(0,a.removeClass)(h,y),A&&v){try{screen.orientation.unlock()}catch{}v=!1}}),{name:"autoOrientation",get state(){return(0,a.hasClass)(h,g)}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"21HWM":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,icons:f,storage:h,constructor:p,proxy:g,template:{$poster:y}}=u,v=u.layers.add({name:"auto-playback",html:'<div class="art-auto-playback-close"></div><div class="art-auto-playback-last"></div><div class="art-auto-playback-jump"></div>'}),S=(0,a.query)(".art-auto-playback-last",v),T=(0,a.query)(".art-auto-playback-jump",v),A=(0,a.query)(".art-auto-playback-close",v);(0,a.append)(A,f.close);let b=null;function R(){let C=(h.get("times")||{})[u.option.id||u.option.url];clearTimeout(b),(0,a.setStyle)(v,"display","none"),C&&C>=p.AUTO_PLAYBACK_MIN&&((0,a.setStyle)(v,"display","flex"),S.textContent=`${d.get("Last Seen")} ${(0,a.secondToTime)(C)}`,T.textContent=d.get("Jump Play"),g(A,"click",()=>{(0,a.setStyle)(v,"display","none")}),g(T,"click",()=>{u.seek=C,u.play(),(0,a.setStyle)(y,"display","none"),(0,a.setStyle)(v,"display","none")}),u.once("video:timeupdate",()=>{b=setTimeout(()=>{(0,a.setStyle)(v,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}return u.on("video:timeupdate",()=>{if(u.playing){let C=h.get("times")||{},D=Object.keys(C);D.length>p.AUTO_PLAYBACK_MAX&&delete C[D[0]],C[u.option.id||u.option.url]=u.currentTime,h.set("times",C)}}),u.on("ready",R),u.on("restart",R),{name:"auto-playback",get times(){return h.get("times")||{}},clear:()=>h.del("times"),delete(C){let D=h.get("times")||{};return delete D[C],h.set("times",D),D}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4sxBO":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{constructor:d,proxy:f,template:{$player:h,$video:p}}=u,g=null,y=!1,v=1,S=()=>{clearTimeout(g),y&&(y=!1,u.playbackRate=v,(0,a.removeClass)(h,"art-fast-forward"))};return f(p,"touchstart",T=>{T.touches.length===1&&u.playing&&!u.isLock&&(g=setTimeout(()=>{y=!0,v=u.playbackRate,u.playbackRate=d.FAST_FORWARD_VALUE,(0,a.addClass)(h,"art-fast-forward")},d.FAST_FORWARD_TIME))}),u.on("document:touchmove",S),u.on("document:touchend",S),{name:"fastForward",get state(){return(0,a.hasClass)(h,"art-fast-forward")}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjy9V:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{layers:d,icons:f,template:{$player:h}}=u;function p(){return(0,a.hasClass)(h,"art-lock")}function g(){(0,a.addClass)(h,"art-lock"),u.isLock=!0,u.emit("lock",!0)}function y(){(0,a.removeClass)(h,"art-lock"),u.isLock=!1,u.emit("lock",!1)}return d.add({name:"lock",mounted(v){let S=(0,a.append)(v,f.lock),T=(0,a.append)(v,f.unlock);(0,a.setStyle)(S,"display","none"),u.on("lock",A=>{A?((0,a.setStyle)(S,"display","inline-flex"),(0,a.setStyle)(T,"display","none")):((0,a.setStyle)(S,"display","none"),(0,a.setStyle)(T,"display","inline-flex"))})},click(){p()?y():g()}}),{name:"lock",get state(){return p()},set state(v){v?g():y()}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d0xRp:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){return u.on("control",d=>{d?(0,a.removeClass)(u.template.$player,"art-mini-progress-bar"):(0,a.addClass)(u.template.$player,"art-mini-progress-bar")}),{name:"mini-progress-bar"}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bwLGT:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("../utils"),l=r("../utils/component"),u=s.interopDefault(l),d=r("./aspectRatio"),f=s.interopDefault(d),h=r("./flip"),p=s.interopDefault(h),g=r("./playbackRate"),y=s.interopDefault(g),v=r("./subtitleOffset"),S=s.interopDefault(v);class T extends u.default{constructor(b){super(b);let{option:R,controls:C,template:{$setting:D}}=b;this.name="setting",this.$parent=D,this.id=0,this.active=null,this.cache=new Map,this.option=[...this.builtin,...R.settings],R.setting&&(this.format(),this.render(),b.on("blur",()=>{this.show&&(this.show=!1,this.render())}),b.on("focus",N=>{let w=(0,a.includeFromEvent)(N,C.setting),P=(0,a.includeFromEvent)(N,this.$parent);!this.show||w||P||(this.show=!1,this.render())}),b.on("resize",()=>this.resize()))}get builtin(){let b=[],{option:R}=this.art;return R.playbackRate&&b.push((0,y.default)(this.art)),R.aspectRatio&&b.push((0,f.default)(this.art)),R.flip&&b.push((0,p.default)(this.art)),R.subtitleOffset&&b.push((0,S.default)(this.art)),b}traverse(b,R=this.option){for(let C=0;C<R.length;C++){let D=R[C];b(D),D.selector?.length&&this.traverse(b,D.selector)}}check(b){b.$parent.tooltip=b.html,this.traverse(R=>{R.default=R===b,R.default&&R.$item&&(0,a.inverseClass)(R.$item,"art-current")},b.$option),this.render(b.$parents)}format(b=this.option,R,C,D=[]){for(let N=0;N<b.length;N++){let w=b[N];if(w?.name?((0,a.errorHandle)(!D.includes(w.name),`The [${w.name}] already exists in [setting]`),D.push(w.name)):w.name=`setting-${this.id++}`,!w.$formatted){(0,a.def)(w,"$parent",{get:()=>R}),(0,a.def)(w,"$parents",{get:()=>C}),(0,a.def)(w,"$option",{get:()=>b});let P=[];(0,a.def)(w,"$events",{get:()=>P}),(0,a.def)(w,"$formatted",{get:()=>!0})}this.format(w.selector||[],w,b,D)}this.option=b}find(b=""){let R=null;return this.traverse(C=>{C.name===b&&(R=C)}),R}resize(){let{controls:b,constructor:{SETTING_WIDTH:R,SETTING_ITEM_HEIGHT:C},template:{$player:D,$setting:N}}=this.art;if(b.setting&&this.show){let w=this.active[0]?.$parent?.width||R,{left:P,width:B}=(0,a.getRect)(b.setting),{left:M,width:K}=(0,a.getRect)(D),tt=P-M+B/2-w/2,z=this.active===this.option?this.active.length*C:(this.active.length+1)*C;if((0,a.setStyle)(N,"height",`${z}px`),(0,a.setStyle)(N,"width",`${w}px`),this.art.isRotate||a.isMobile)return;tt+w>K?((0,a.setStyle)(N,"left",null),(0,a.setStyle)(N,"right",null)):((0,a.setStyle)(N,"left",`${tt}px`),(0,a.setStyle)(N,"right","auto"))}}inactivate(b){for(let R=0;R<b.$events.length;R++)this.art.events.remove(b.$events[R]);b.$events.length=0}remove(b){let R=this.find(b);(0,a.errorHandle)(R,`Can't find [${b}] in the [setting]`);let C=R.$option.indexOf(R);R.$option.splice(C,1),this.inactivate(R),R.$item&&(0,a.remove)(R.$item),this.render()}update(b){let R=this.find(b.name);return R?(this.inactivate(R),Object.assign(R,b),this.format(),this.createItem(R,!0),this.render(),R):this.add(b)}add(b,R=this.option){return R.push(b),this.format(),this.createItem(b),this.render(),b}createHeader(b){if(!this.cache.has(b.$option))return;let R=this.cache.get(b.$option),{proxy:C,icons:{arrowLeft:D},constructor:{SETTING_ITEM_HEIGHT:N}}=this.art,w=(0,a.createElement)("div");(0,a.setStyle)(w,"height",`${N}px`),(0,a.addClass)(w,"art-setting-item"),(0,a.addClass)(w,"art-setting-item-back");let P=(0,a.append)(w,'<div class="art-setting-item-left"></div>'),B=(0,a.createElement)("div");(0,a.addClass)(B,"art-setting-item-left-icon"),(0,a.append)(B,D),(0,a.append)(P,B),(0,a.append)(P,b.$parent.html);let M=C(w,"click",()=>this.render(b.$parents));b.$parent.$events.push(M),(0,a.append)(R,w)}createItem(b,R=!1){if(!this.cache.has(b.$option))return;let C=this.cache.get(b.$option),D=b.$item,N="selector";(0,a.has)(b,"switch")&&(N="switch"),(0,a.has)(b,"range")&&(N="range"),(0,a.has)(b,"onClick")&&(N="button");let{icons:w,proxy:P,constructor:B}=this.art,M=(0,a.createElement)("div");(0,a.addClass)(M,"art-setting-item"),(0,a.setStyle)(M,"height",`${B.SETTING_ITEM_HEIGHT}px`),M.dataset.name=b.name||"",M.dataset.value=b.value||"";let K=(0,a.append)(M,'<div class="art-setting-item-left"></div>'),tt=(0,a.append)(M,'<div class="art-setting-item-right"></div>'),z=(0,a.createElement)("div");switch((0,a.addClass)(z,"art-setting-item-left-icon"),N){case"button":case"switch":case"range":(0,a.append)(z,b.icon||w.config);break;case"selector":b.selector?.length?(0,a.append)(z,b.icon||w.config):(0,a.append)(z,w.check)}(0,a.append)(K,z),(0,a.def)(b,"$icon",{configurable:!0,get:()=>z}),(0,a.def)(b,"icon",{configurable:!0,get:()=>z.innerHTML,set(O){z.innerHTML="",(0,a.append)(z,O)}});let G=(0,a.createElement)("div");(0,a.addClass)(G,"art-setting-item-left-text"),(0,a.append)(G,b.html||""),(0,a.append)(K,G),(0,a.def)(b,"$html",{configurable:!0,get:()=>G}),(0,a.def)(b,"html",{configurable:!0,get:()=>G.innerHTML,set(O){G.innerHTML="",(0,a.append)(G,O)}});let Y=(0,a.createElement)("div");switch((0,a.addClass)(Y,"art-setting-item-right-tooltip"),(0,a.append)(Y,b.tooltip||""),(0,a.append)(tt,Y),(0,a.def)(b,"$tooltip",{configurable:!0,get:()=>Y}),(0,a.def)(b,"tooltip",{configurable:!0,get:()=>Y.innerHTML,set(O){Y.innerHTML="",(0,a.append)(Y,O)}}),N){case"switch":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let j=(0,a.append)(O,w.switchOn),V=(0,a.append)(O,w.switchOff);(0,a.setStyle)(b.switch?V:j,"display","none"),(0,a.append)(tt,O),(0,a.def)(b,"$switch",{configurable:!0,get:()=>O});let nt=b.switch;(0,a.def)(b,"switch",{configurable:!0,get:()=>nt,set(ut){nt=ut,ut?((0,a.setStyle)(V,"display","none"),(0,a.setStyle)(j,"display",null)):((0,a.setStyle)(V,"display",null),(0,a.setStyle)(j,"display","none"))}});break}case"range":{let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon");let j=(0,a.append)(O,'<input type="range">');j.value=b.range[0],j.min=b.range[1],j.max=b.range[2],j.step=b.range[3],(0,a.addClass)(j,"art-setting-range"),(0,a.append)(tt,O),(0,a.def)(b,"$range",{configurable:!0,get:()=>j});let V=[...b.range];(0,a.def)(b,"range",{configurable:!0,get:()=>V,set(nt){V=[...nt],j.value=nt[0],j.min=nt[1],j.max=nt[2],j.step=nt[3]}})}break;case"selector":if(b.selector?.length){let O=(0,a.createElement)("div");(0,a.addClass)(O,"art-setting-item-right-icon"),(0,a.append)(O,w.arrowRight),(0,a.append)(tt,O)}}switch(N){case"switch":if(b.onSwitch){let O=P(M,"click",async j=>{b.switch=await b.onSwitch.call(this.art,b,M,j)});b.$events.push(O)}break;case"range":if(b.$range){if(b.onRange){let O=P(b.$range,"change",async j=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onRange.call(this.art,b,M,j)});b.$events.push(O)}if(b.onChange){let O=P(b.$range,"input",async j=>{b.range[0]=b.$range.valueAsNumber,b.tooltip=await b.onChange.call(this.art,b,M,j)});b.$events.push(O)}}break;case"selector":{let O=P(M,"click",async j=>{b.selector?.length?this.render(b.selector):(this.check(b),b.$parent.onSelect&&(b.$parent.tooltip=await b.$parent.onSelect.call(this.art,b,M,j)))});b.$events.push(O),b.default&&(0,a.addClass)(M,"art-current")}break;case"button":if(b.onClick){let O=P(M,"click",async j=>{b.tooltip=await b.onClick.call(this.art,b,M,j)});b.$events.push(O)}}(0,a.def)(b,"$item",{configurable:!0,get:()=>M}),R?(0,a.replaceElement)(M,D):(0,a.append)(C,M),b.mounted&&setTimeout(()=>b.mounted.call(this.art,b.$item,b),0)}render(b=this.option){if(this.active=b,this.cache.has(b)){let R=this.cache.get(b);(0,a.inverseClass)(R,"art-current")}else{let R=(0,a.createElement)("div");this.cache.set(b,R),(0,a.addClass)(R,"art-setting-panel"),(0,a.append)(this.$parent,R),(0,a.inverseClass)(R,"art-current"),b[0]?.$parent&&this.createHeader(b[0]);for(let C=0;C<b.length;C++)this.createItem(b[C])}this.resize()}}e.default=T},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"cb8VK","./flip":"ljJTO","./playbackRate":"3QcSQ","./subtitleOffset":"eB5hg","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cb8VK:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:{SETTING_ITEM_WIDTH:f,ASPECT_RATIO:h}}=l;function p(y){return y==="default"?u.get("Default"):y}function g(){let y=l.setting.find(`aspect-ratio-${l.aspectRatio}`);l.setting.check(y)}return{width:f,name:"aspect-ratio",html:u.get("Aspect Ratio"),icon:d.aspectRatio,tooltip:p(l.aspectRatio),selector:h.map(y=>({value:y,name:`aspect-ratio-${y}`,default:y===l.aspectRatio,html:p(y)})),onSelect:y=>(l.aspectRatio=y.value,y.html),mounted:()=>{g(),l.on("aspectRatio",()=>g())}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ljJTO:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e),s.export(e,"default",()=>l);var a=r("../utils");function l(u){let{i18n:d,icons:f,constructor:{SETTING_ITEM_WIDTH:h,FLIP:p}}=u;function g(v){return d.get((0,a.capitalize)(v))}function y(){let v=u.setting.find(`flip-${u.flip}`);u.setting.check(v)}return{width:h,name:"flip",html:d.get("Video Flip"),tooltip:g(u.flip),icon:f.flip,selector:p.map(v=>({value:v,name:`flip-${v}`,default:v===u.flip,html:g(v)})),onSelect:v=>(u.flip=v.value,v.html),mounted:()=>{y(),u.on("flip",()=>y())}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3QcSQ":[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:{SETTING_ITEM_WIDTH:f,PLAYBACK_RATE:h}}=l;function p(y){return y===1?u.get("Normal"):y.toFixed(1)}function g(){let y=l.setting.find(`playback-rate-${l.playbackRate}`);l.setting.check(y)}return{width:f,name:"playback-rate",html:u.get("Play Speed"),tooltip:p(l.playbackRate),icon:d.playbackRate,selector:h.map(y=>({value:y,name:`playback-rate-${y}`,default:y===l.playbackRate,html:p(y)})),onSelect:y=>(l.playbackRate=y.value,y.html),mounted:()=>{g(),l.on("video:ratechange",()=>g())}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eB5hg:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){let{i18n:u,icons:d,constructor:f}=l;return{width:f.SETTING_ITEM_WIDTH,name:"subtitle-offset",html:u.get("Subtitle Offset"),icon:d.subtitle,tooltip:"0s",range:[0,-10,10,.1],onChange:h=>(l.subtitleOffset=h.range[0],`${h.range[0]}s`),mounted:(h,p)=>{l.on("subtitleOffset",g=>{p.$range.value=g,p.tooltip=`${g}s`})}}}s.defineInteropFlag(e),s.export(e,"default",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kwqbK:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(s){try{let a=JSON.parse(window.localStorage.getItem(this.name))||{};return s?a[s]:a}catch{return s?this.settings[s]:this.settings}}set(s,a){try{let l=Object.assign({},this.get(),{[s]:a});window.localStorage.setItem(this.name,JSON.stringify(l))}catch{this.settings[s]=a}}del(s){try{let a=this.get();delete a[s],window.localStorage.setItem(this.name,JSON.stringify(a))}catch{delete this.settings[s]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k5613:[function(r,t,e,i){var s=r("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(e);var a=r("option-validator"),l=s.interopDefault(a),u=r("./scheme"),d=s.interopDefault(u),f=r("./utils"),h=r("./utils/component"),p=s.interopDefault(h);class g extends p.default{constructor(v){super(v),this.name="subtitle",this.option=null,this.destroyEvent=()=>null,this.init(v.option.subtitle);let S=!1;v.on("video:timeupdate",()=>{if(!this.url)return;let T=this.art.template.$video.webkitDisplayingFullscreen;typeof T=="boolean"&&T!==S&&(S=T,this.createTrack(T?"subtitles":"metadata",this.url))})}get url(){return this.art.template.$track.src}set url(v){this.switch(v)}get textTrack(){return this.art.template.$video?.textTracks?.[0]}get activeCues(){return this.textTrack?Array.from(this.textTrack.activeCues):[]}get cues(){return this.textTrack?Array.from(this.textTrack.cues):[]}style(v,S){let{$subtitle:T}=this.art.template;return typeof v=="object"?(0,f.setStyles)(T,v):(0,f.setStyle)(T,v,S)}update(){let{option:{subtitle:v},template:{$subtitle:S}}=this.art;S.innerHTML="",this.activeCues.length&&(this.art.emit("subtitleBeforeUpdate",this.activeCues),S.innerHTML=this.activeCues.map((T,A)=>T.text.split(/\r?\n/).filter(b=>b.trim()).map(b=>`<div class="art-subtitle-line" data-group="${A}">${v.escape?(0,f.escape)(b):b}</div>`).join("")).join(""),this.art.emit("subtitleAfterUpdate",this.activeCues))}async switch(v,S={}){let{i18n:T,notice:A,option:b}=this.art,R={...b.subtitle,...S,url:v},C=await this.init(R);return S.name&&(A.show=`${T.get("Switch Subtitle")}: ${S.name}`),C}createTrack(v,S){let{template:T,proxy:A,option:b}=this.art,{$video:R,$track:C}=T,D=(0,f.createElement)("track");D.default=!0,D.kind=v,D.src=S,D.label=b.subtitle.name||"Artplayer",D.track.mode="hidden",D.onload=()=>{this.art.emit("subtitleLoad",this.cues,this.option)},this.art.events.remove(this.destroyEvent),C.onload=null,(0,f.remove)(C),(0,f.append)(R,D),T.$track=D,this.destroyEvent=A(this.textTrack,"cuechange",()=>this.update())}async init(v){let{notice:S,template:{$subtitle:T}}=this.art;return this.textTrack?((0,l.default)(v,d.default.subtitle),v.url?(this.option=v,this.style(v.style),fetch(v.url).then(A=>A.arrayBuffer()).then(A=>{let b=new TextDecoder(v.encoding).decode(A);switch(v.type||(0,f.getExt)(v.url)){case"srt":{let R=(0,f.srtToVtt)(b),C=v.onVttLoad(R);return(0,f.vttToBlob)(C)}case"ass":{let R=(0,f.assToVtt)(b),C=v.onVttLoad(R);return(0,f.vttToBlob)(C)}case"vtt":{let R=v.onVttLoad(b);return(0,f.vttToBlob)(R)}default:return v.url}}).then(A=>(T.innerHTML="",this.url===A||(URL.revokeObjectURL(this.url),this.createTrack("metadata",A)),A)).catch(A=>{throw T.innerHTML="",S.show=A,A})):void 0):null}}e.default=g},{"option-validator":"g7VGh","./scheme":"biLjm","./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fwOA1:[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e);var s=r("../package.json"),a=r("./utils");class l{constructor(d){this.art=d;let{option:f,constructor:h}=d;f.container instanceof Element?this.$container=f.container:(this.$container=(0,a.query)(f.container),(0,a.errorHandle)(this.$container,`No container element found by ${f.container}`)),(0,a.errorHandle)((0,a.supportsFlex)(),"The current browser does not support flex layout");let p=this.$container.tagName.toLowerCase();(0,a.errorHandle)(p==="div",`Unsupported container element type, only support 'div' but got '${p}'`),(0,a.errorHandle)(h.instances.every(g=>g.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=d.id,this.init()}static get html(){return`<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"><track default kind="metadata" src=""></track></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">${s.version}</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span>x<span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-contextmenus"></div></div>`}query(d){return(0,a.query)(d,this.$container)}init(){let{option:d}=this.art;if(d.useSSR||(this.$container.innerHTML=l.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$track=this.query("track"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$contextmenu=this.query(".art-contextmenus"),d.proxy){let f=d.proxy.call(this.art,this.art);(0,a.errorHandle)(f instanceof HTMLVideoElement||f instanceof HTMLCanvasElement,"Function 'option.proxy' needs to return 'HTMLVideoElement' or 'HTMLCanvasElement'"),(0,a.replaceElement)(f,this.$video),f.className="art-video",this.$video=f}d.backdrop&&(0,a.addClass)(this.$player,"art-backdrop"),a.isMobile&&(0,a.addClass)(this.$player,"art-mobile")}destroy(d){d?this.$container.innerHTML="":(0,a.addClass)(this.$player,"art-destroy")}}e.default=l},{"../package.json":"lh3R5","./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4NM7P":[function(r,t,e,i){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(e),e.default=class{on(s,a,l){let u=this.e||(this.e={});return(u[s]||(u[s]=[])).push({fn:a,ctx:l}),this}once(s,a,l){let u=this;function d(...f){u.off(s,d),a.apply(l,f)}return d._=a,this.on(s,d,l)}emit(s,...a){let l=((this.e||(this.e={}))[s]||[]).slice();for(let u=0;u<l.length;u+=1)l[u].fn.apply(l[u].ctx,a);return this}off(s,a){let l=this.e||(this.e={}),u=l[s],d=[];if(u&&a)for(let f=0,h=u.length;f<h;f+=1)u[f].fn!==a&&u[f].fn._!==a&&d.push(u[f]);return d.length?l[s]=d:delete l[s],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}]},["esqvp"],"esqvp","parcelRequire4dc0",{});let{default:UL}=parcelRequire4dc0("esqvp");const ht=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},$L=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=jL},jL=Number.MAX_SAFE_INTEGER||9007199254740991;let vt=(function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r})({}),Q=(function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",r.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",r.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.ASSET_LIST_LOAD_ERROR="assetListLoadError",r.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",r.ASSET_LIST_PARSING_ERROR="assetListParsingError",r.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.ATTACH_MEDIA_ERROR="attachMediaError",r.UNKNOWN="unknown",r})({}),_=(function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.MEDIA_ENDED="hlsMediaEnded",r.STALL_RESOLVED="hlsStallResolved",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFERED_TO_END="hlsBufferedToEnd",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r.ASSET_LIST_LOADING="hlsAssetListLoading",r.ASSET_LIST_LOADED="hlsAssetListLoaded",r.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",r.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",r.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",r.INTERSTITIAL_STARTED="hlsInterstitialStarted",r.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",r.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",r.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",r.INTERSTITIAL_ENDED="hlsInterstitialEnded",r.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",r.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",r.EVENT_CUE_ENTER="hlsEventCueEnter",r})({});var It={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},mt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Mr{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class GL{constructor(t,e,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Mr(t),this.fast_=new Mr(e),this.defaultTTFB_=s,this.ttfb_=new Mr(t)}update(t,e){const{slow_:i,fast_:s,ttfb_:a}=this;i.halfLife!==t&&(this.slow_=new Mr(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.fast_=new Mr(e,s.getEstimate(),s.getTotalWeight())),a.halfLife!==t&&(this.ttfb_=new Mr(t,a.getEstimate(),a.getTotalWeight()))}sample(t,e){t=Math.max(t,this.minDelayMs_);const i=8*e,s=t/1e3,a=i/s;this.fast_.sample(s,a),this.slow_.sample(s,a)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function HL(r,t,e){return(t=VL(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function Xt(){return Xt=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Xt.apply(null,arguments)}function Ty(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),e.push.apply(e,i)}return e}function zt(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Ty(Object(e),!0).forEach(function(i){HL(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):Ty(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function zL(r,t){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function VL(r){var t=zL(r,"string");return typeof t=="symbol"?t:t+""}class wi{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${t}]:`;this.trace=us,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}}const us=function(){},KL={trace:us,debug:us,log:us,warn:us,info:us,error:us};function Gd(){return Xt({},KL)}function qL(r,t){const e=self.console[r];return e?e.bind(self.console,`${t?"["+t+"] ":""}[${r}] >`):us}function by(r,t,e){return t[r]?t[r].bind(t):qL(r,e)}const Hd=Gd();function YL(r,t,e){const i=Gd();if(typeof console=="object"&&r===!0||typeof r=="object"){const s=["debug","log","info","warn","error"];s.forEach(a=>{i[a]=by(a,r,e)});try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.14`)}catch{return Gd()}s.forEach(a=>{Hd[a]=by(a,r)})}else Xt(Hd,i);return i}const Vt=Hd;function hs(r=!0){return typeof self>"u"?void 0:(r||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function XL(r){return typeof self<"u"&&r===self.ManagedMediaSource}function jE(r,t){const e=Object.keys(r),i=Object.keys(t),s=e.length,a=i.length;return!s||!a||s===a&&!e.some(l=>i.indexOf(l)===-1)}function gi(r,t=!1){if(typeof TextDecoder<"u"){const f=new TextDecoder("utf-8").decode(r);if(t){const h=f.indexOf("\0");return h!==-1?f.substring(0,h):f}return f.replace(/\0/g,"")}const e=r.length;let i,s,a,l="",u=0;for(;u<e;){if(i=r[u++],i===0&&t)return l;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:s=r[u++],l+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=r[u++],a=r[u++],l+=String.fromCharCode((i&15)<<12|(s&63)<<6|(a&63)<<0);break}}return l}function Ve(r){let t="";for(let e=0;e<r.length;e++){let i=r[e].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function GE(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function WL(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var fd={exports:{}},Ay;function QL(){return Ay||(Ay=1,(function(r,t){(function(e){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(d,f,h){if(h=h||{},d=d.trim(),f=f.trim(),!f){if(!h.alwaysNormalize)return d;var p=u.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=u.normalizePath(p.path),u.buildURLFromParts(p)}var g=u.parseURL(f);if(!g)throw new Error("Error trying to parse relative URL.");if(g.scheme)return h.alwaysNormalize?(g.path=u.normalizePath(g.path),u.buildURLFromParts(g)):f;var y=u.parseURL(d);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var v=s.exec(y.path);y.netLoc=v[1],y.path=v[2]}y.netLoc&&!y.path&&(y.path="/");var S={scheme:y.scheme,netLoc:g.netLoc,path:null,params:g.params,query:g.query,fragment:g.fragment};if(!g.netLoc&&(S.netLoc=y.netLoc,g.path[0]!=="/"))if(!g.path)S.path=y.path,g.params||(S.params=y.params,g.query||(S.query=y.query));else{var T=y.path,A=T.substring(0,T.lastIndexOf("/")+1)+g.path;S.path=u.normalizePath(A)}return S.path===null&&(S.path=h.alwaysNormalize?u.normalizePath(g.path):g.path),u.buildURLFromParts(S)},parseURL:function(d){var f=i.exec(d);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(a,"");d.length!==(d=d.replace(l,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};r.exports=u})()})(fd)),fd.exports}var Rh=QL();class Lh{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Qt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class HE{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof t=="string"&&(t={url:t}),this.base=t,JL(this,"stats")}setByteRange(t,e){const i=t.split("@",2);let s;i.length===1?s=e?.byteRangeEndOffset||0:s=parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Qt.AUDIO]:null,[Qt.VIDEO]:null,[Qt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Lh),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Rh.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Qt.AUDIO]=null,t[Qt.VIDEO]=null,t[Qt.AUDIOVIDEO]=null}}function xe(r){return r.sn!=="initSegment"}class dd extends HE{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(ht(t)&&ht(e))return e-t}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){var t;const{levelkeys:e}=this;if(!e||e.NONE)return null;if(e.identity)this._decryptdata||(this._decryptdata=e.identity.getDecryptData(this.sn));else if(!((t=this._decryptdata)!=null&&t.keyId)){const i=Object.keys(e);if(i.length===1){const s=this._decryptdata=e[i[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,e))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const t=ht(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){var e;const i=Object.keys(this.levelkeys),s=i.length;if(s>1||s===1&&(e=this.levelkeys[i[0]])!=null&&e.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){if(!ht(t)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=t}get ref(){return xe(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){const e=this.levelkeys;if(e){var i;const s=e[t];s&&!((i=this._decryptdata)!=null&&i.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,e))}}abortRequests(){var t,e;(t=this.loader)==null||t.abort(),(e=this.keyLoader)==null||e.abort()}setElementaryStreamInfo(t,e,i,s,a,l=!1){const{elementaryStreams:u}=this,d=u[t];if(!d){u[t]={startPTS:e,endPTS:i,startDTS:s,endDTS:a,partial:l};return}d.startPTS=Math.min(d.startPTS,e),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,s),d.endDTS=Math.max(d.endDTS,a)}}class ZL extends HE{constructor(t,e,i,s,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=s;const l=t.enumeratedString("BYTERANGE");l&&this.setByteRange(l,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function zE(r,t){const e=Object.getPrototypeOf(r);if(e){const i=Object.getOwnPropertyDescriptor(e,t);return i||zE(e,t)}}function JL(r,t){const e=zE(r,t);e&&(e.enumerable=!0,Object.defineProperty(r,t,e))}const Ry=Math.pow(2,32)-1,t_=[].push,VE={video:1,audio:2,id3:3,text:4};function be(r){return String.fromCharCode.apply(null,r)}function KE(r,t){const e=r[t]<<8|r[t+1];return e<0?65536+e:e}function Tt(r,t){const e=qE(r,t);return e<0?4294967296+e:e}function Ly(r,t){let e=Tt(r,t);return e*=Math.pow(2,32),e+=Tt(r,t+4),e}function qE(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]}function e_(r){const t=r.byteLength;for(let e=0;e<t;){const i=Tt(r,e);if(i>8&&r[e+4]===109&&r[e+5]===111&&r[e+6]===111&&r[e+7]===102)return!0;e=i>1?e+i:t}return!1}function Dt(r,t){const e=[];if(!t.length)return e;const i=r.byteLength;for(let s=0;s<i;){const a=Tt(r,s),l=be(r.subarray(s+4,s+8)),u=a>1?s+a:i;if(l===t[0])if(t.length===1)e.push(r.subarray(s+8,u));else{const d=Dt(r.subarray(s+8,u),t.slice(1));d.length&&t_.apply(e,d)}s=u}return e}function i_(r){const t=[],e=r[0];let i=8;const s=Tt(r,i);i+=4;let a=0,l=0;e===0?(a=Tt(r,i),l=Tt(r,i+4),i+=8):(a=Ly(r,i),l=Ly(r,i+8),i+=16),i+=2;let u=r.length+l;const d=KE(r,i);i+=2;for(let f=0;f<d;f++){let h=i;const p=Tt(r,h);h+=4;const g=p&2147483647;if((p&2147483648)>>>31===1)return Vt.warn("SIDX has hierarchical references (not supported)"),null;const v=Tt(r,h);h+=4,t.push({referenceSize:g,subsegmentDuration:v,info:{duration:v/s,start:u,end:u+g-1}}),u+=g,h+=4,i=h}return{earliestPresentationTime:a,timescale:s,version:e,referencesCount:d,references:t}}function YE(r){const t=[],e=Dt(r,["moov","trak"]);for(let s=0;s<e.length;s++){const a=e[s],l=Dt(a,["tkhd"])[0];if(l){let u=l[0];const d=Tt(l,u===0?12:20),f=Dt(a,["mdia","mdhd"])[0];if(f){u=f[0];const h=Tt(f,u===0?12:20),p=Dt(a,["mdia","hdlr"])[0];if(p){const g=be(p.subarray(8,12)),y={soun:Qt.AUDIO,vide:Qt.VIDEO}[g],v=Dt(a,["mdia","minf","stbl","stsd"])[0],S=n_(v);y?(t[d]={timescale:h,type:y,stsd:S},t[y]=zt({timescale:h,id:d},S)):t[d]={timescale:h,type:g,stsd:S}}}}}return Dt(r,["moov","mvex","trex"]).forEach(s=>{const a=Tt(s,4),l=t[a];l&&(l.default={duration:Tt(s,12),flags:Tt(s,20)})}),t}function n_(r){const t=r.subarray(8),e=t.subarray(86),i=be(t.subarray(4,8));let s=i,a;const l=i==="enca"||i==="encv";if(l){const f=Dt(t,[i])[0].subarray(i==="enca"?28:78);Dt(f,["sinf"]).forEach(p=>{const g=Dt(p,["schm"])[0];if(g){const y=be(g.subarray(4,8));if(y==="cbcs"||y==="cenc"){const v=Dt(p,["frma"])[0];v&&(s=be(v))}}})}const u=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Dt(e,["avcC"])[0];d&&d.length>3&&(s+="."+Ml(d[1])+Ml(d[2])+Ml(d[3]),a=kl(u==="avc1"?"dva1":"dvav",e));break}case"mp4a":{const d=Dt(t,[i])[0],f=Dt(d.subarray(28),["esds"])[0];if(f&&f.length>7){let h=4;if(f[h++]!==3)break;h=hd(f,h),h+=2;const p=f[h++];if(p&128&&(h+=2),p&64&&(h+=f[h++]),f[h++]!==4)break;h=hd(f,h);const g=f[h++];if(g===64)s+="."+Ml(g);else break;if(h+=12,f[h++]!==5)break;h=hd(f,h);const y=f[h++];let v=(y&248)>>3;v===31&&(v+=1+((y&7)<<3)+((f[h]&224)>>5)),s+="."+v}break}case"hvc1":case"hev1":{const d=Dt(e,["hvcC"])[0];if(d&&d.length>12){const f=d[1],h=["","A","B","C"][f>>6],p=f&31,g=Tt(d,2),y=(f&32)>>5?"H":"L",v=d[12],S=d.subarray(6,12);s+="."+h+p,s+="."+s_(g).toString(16).toUpperCase(),s+="."+y+v;let T="";for(let A=S.length;A--;){const b=S[A];(b||T)&&(T="."+b.toString(16).toUpperCase()+T)}s+=T}a=kl(u=="hev1"?"dvhe":"dvh1",e);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=kl(s,e)||s;break}case"vp09":{const d=Dt(e,["vpcC"])[0];if(d&&d.length>6){const f=d[4],h=d[5],p=d[6]>>4&15;s+="."+qi(f)+"."+qi(h)+"."+qi(p)}break}case"av01":{const d=Dt(e,["av1C"])[0];if(d&&d.length>2){const f=d[1]>>>5,h=d[1]&31,p=d[2]>>>7?"H":"M",g=(d[2]&64)>>6,y=(d[2]&32)>>5,v=f===2&&g?y?12:10:g?10:8,S=(d[2]&16)>>4,T=(d[2]&8)>>3,A=(d[2]&4)>>2,b=d[2]&3;s+="."+f+"."+qi(h)+p+"."+qi(v)+"."+S+"."+T+A+b+"."+qi(1)+"."+qi(1)+"."+qi(1)+"."+0,a=kl("dav1",e)}break}}return{codec:s,encrypted:l,supplemental:a}}function kl(r,t){const e=Dt(t,["dvvC"]),i=e.length?e[0]:Dt(t,["dvcC"])[0];if(i){const s=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return r+"."+qi(s)+"."+qi(a)}}function s_(r){let t=0;for(let e=0;e<32;e++)t|=(r>>e&1)<<31-e;return t>>>0}function hd(r,t){const e=t+5;for(;r[t++]&128&&t<e;);return t}function Ml(r){return("0"+r.toString(16).toUpperCase()).slice(-2)}function qi(r){return(r<10?"0":"")+r}function r_(r,t){if(!r||!t)return;const e=t.keyId;e&&t.isCommonEncryption&&XE(r,(i,s)=>{const a=i.subarray(8,24);a.some(l=>l!==0)||(Vt.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${Ve(a)} -> ${Ve(e)}`),i.set(e,8))})}function a_(r){const t=[];return XE(r,e=>t.push(e.subarray(8,24))),t}function XE(r,t){Dt(r,["moov","trak"]).forEach(i=>{const s=Dt(i,["mdia","minf","stbl","stsd"])[0];if(!s)return;const a=s.subarray(8);let l=Dt(a,["enca"]);const u=l.length>0;u||(l=Dt(a,["encv"])),l.forEach(d=>{const f=u?d.subarray(28):d.subarray(78);Dt(f,["sinf"]).forEach(p=>{const g=WE(p);g&&t(g,u)})})})}function WE(r){const t=Dt(r,["schm"])[0];if(t){const e=be(t.subarray(4,8));if(e==="cbcs"||e==="cenc"){const i=Dt(r,["schi","tenc"])[0];if(i)return i}}}function o_(r,t,e){const i={},s=Dt(r,["moof","traf"]);for(let a=0;a<s.length;a++){const l=s[a],u=Dt(l,["tfhd"])[0],d=Tt(u,4),f=t[d];if(!f)continue;i[d]||(i[d]={start:NaN,duration:0,sampleCount:0,timescale:f.timescale,type:f.type});const h=i[d],p=Dt(l,["tfdt"])[0];if(p){const R=p[0];let C=Tt(p,4);R===1&&(C===Ry?e.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(C*=Ry+1,C+=Tt(p,8))),ht(C)&&(!ht(h.start)||C<h.start)&&(h.start=C)}const g=f.default,y=Tt(u,0)|g?.flags;let v=g?.duration||0;y&8&&(y&2?v=Tt(u,12):v=Tt(u,8));const S=Dt(l,["trun"]);let T=h.start||0,A=0,b=v;for(let R=0;R<S.length;R++){const C=S[R],D=Tt(C,4),N=h.sampleCount;h.sampleCount+=D;const w=C[3]&1,P=C[3]&4,B=C[2]&1,M=C[2]&2,K=C[2]&4,tt=C[2]&8;let z=8,G=D;for(w&&(z+=4),P&&D&&(!(C[z+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=N),z+=4,B?(b=Tt(C,z),z+=4):b=v,M&&(z+=4),tt&&(z+=4),T+=b,A+=b,G--);G--;)B?(b=Tt(C,z),z+=4):b=v,M&&(z+=4),K&&(C[z+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(G+1),h.keyFrameStart=T),z+=4),tt&&(z+=4),T+=b,A+=b;!A&&v&&(A+=v*D)}h.duration+=A}if(!Object.keys(i).some(a=>i[a].duration)){let a=1/0,l=0;const u=Dt(r,["sidx"]);for(let d=0;d<u.length;d++){const f=i_(u[d]);if(f!=null&&f.references){a=Math.min(a,f.earliestPresentationTime/f.timescale);const h=f.references.reduce((p,g)=>p+g.info.duration||0,0);l=Math.max(l,h+f.earliestPresentationTime/f.timescale)}}l&&ht(l)&&Object.keys(i).forEach(d=>{i[d].duration||(i[d].duration=l*i[d].timescale-i[d].start)})}return i}function l_(r){const t={valid:null,remainder:null},e=Dt(r,["moof"]);if(e.length<2)return t.remainder=r,t;const i=e[e.length-1];return t.valid=r.slice(0,i.byteOffset-8),t.remainder=r.slice(i.byteOffset-8),t}function Ci(r,t){const e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function _y(r,t){const e=[],i=t.samples,s=t.timescale,a=t.id;let l=!1;return Dt(i,["moof"]).map(d=>{const f=d.byteOffset-8;Dt(d,["traf"]).map(p=>{const g=Dt(p,["tfdt"]).map(y=>{const v=y[0];let S=Tt(y,4);return v===1&&(S*=Math.pow(2,32),S+=Tt(y,8)),S/s})[0];return g!==void 0&&(r=g),Dt(p,["tfhd"]).map(y=>{const v=Tt(y,4),S=Tt(y,0)&16777215,T=(S&1)!==0,A=(S&2)!==0,b=(S&8)!==0;let R=0;const C=(S&16)!==0;let D=0;const N=(S&32)!==0;let w=8;v===a&&(T&&(w+=8),A&&(w+=4),b&&(R=Tt(y,w),w+=4),C&&(D=Tt(y,w),w+=4),N&&(w+=4),t.type==="video"&&(l=Mu(t.codec)),Dt(p,["trun"]).map(P=>{const B=P[0],M=Tt(P,0)&16777215,K=(M&1)!==0;let tt=0;const z=(M&4)!==0,G=(M&256)!==0;let Y=0;const O=(M&512)!==0;let j=0;const V=(M&1024)!==0,nt=(M&2048)!==0;let ut=0;const k=Tt(P,4);let $=8;K&&(tt=Tt(P,$),$+=4),z&&($+=4);let st=tt+f;for(let ct=0;ct<k;ct++){if(G?(Y=Tt(P,$),$+=4):Y=R,O?(j=Tt(P,$),$+=4):j=D,V&&($+=4),nt&&(B===0?ut=Tt(P,$):ut=qE(P,$),$+=4),t.type===Qt.VIDEO){let ft=0;for(;ft<j;){const dt=Tt(i,st);if(st+=4,u_(l,i[st])){const Et=i.subarray(st,st+dt);_h(Et,l?2:1,r+ut/s,e)}st+=dt,ft+=dt+4}}r+=Y/s}}))})})}),e}function Mu(r){if(!r)return!1;const t=r.substring(0,4);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function u_(r,t){if(r){const e=t>>1&63;return e===39||e===40}else return(t&31)===6}function _h(r,t,e,i){const s=QE(r);let a=0;a+=t;let l=0,u=0,d=0;for(;a<s.length;){l=0;do{if(a>=s.length)break;d=s[a++],l+=d}while(d===255);u=0;do{if(a>=s.length)break;d=s[a++],u+=d}while(d===255);const f=s.length-a;let h=a;if(u<f)a+=u;else if(u>f){Vt.error(`Malformed SEI payload. ${u} is too small, only ${f} bytes left to parse.`);break}if(l===4){if(s[h++]===181){const g=KE(s,h);if(h+=2,g===49){const y=Tt(s,h);if(h+=4,y===1195456820){const v=s[h++];if(v===3){const S=s[h++],T=31&S,A=64&S,b=A?2+T*3:0,R=new Uint8Array(b);if(A){R[0]=S;for(let C=1;C<b;C++)R[C]=s[h++]}i.push({type:v,payloadType:l,pts:e,bytes:R})}}}}}else if(l===5&&u>16){const p=[];for(let v=0;v<16;v++){const S=s[h++].toString(16);p.push(S.length==1?"0"+S:S),(v===3||v===5||v===7||v===9)&&p.push("-")}const g=u-16,y=new Uint8Array(g);for(let v=0;v<g;v++)y[v]=s[h++];i.push({payloadType:l,pts:e,uuid:p.join(""),userData:gi(y),userDataBytes:y})}}}function QE(r){const t=r.byteLength,e=[];let i=1;for(;i<t-2;)r[i]===0&&r[i+1]===0&&r[i+2]===3?(e.push(i+2),i+=2):i++;if(e.length===0)return r;const s=t-e.length,a=new Uint8Array(s);let l=0;for(i=0;i<s;l++,i++)l===e[0]&&(l++,e.shift()),a[i]=r[l];return a}function c_(r){const t=r[0];let e="",i="",s=0,a=0,l=0,u=0,d=0,f=0;if(t===0){for(;be(r.subarray(f,f+1))!=="\0";)e+=be(r.subarray(f,f+1)),f+=1;for(e+=be(r.subarray(f,f+1)),f+=1;be(r.subarray(f,f+1))!=="\0";)i+=be(r.subarray(f,f+1)),f+=1;i+=be(r.subarray(f,f+1)),f+=1,s=Tt(r,12),a=Tt(r,16),u=Tt(r,20),d=Tt(r,24),f=28}else if(t===1){f+=4,s=Tt(r,f),f+=4;const p=Tt(r,f);f+=4;const g=Tt(r,f);for(f+=4,l=2**32*p+g,$L(l)||(l=Number.MAX_SAFE_INTEGER,Vt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Tt(r,f),f+=4,d=Tt(r,f),f+=4;be(r.subarray(f,f+1))!=="\0";)e+=be(r.subarray(f,f+1)),f+=1;for(e+=be(r.subarray(f,f+1)),f+=1;be(r.subarray(f,f+1))!=="\0";)i+=be(r.subarray(f,f+1)),f+=1;i+=be(r.subarray(f,f+1)),f+=1}const h=r.subarray(f,r.byteLength);return{schemeIdUri:e,value:i,timeScale:s,presentationTime:l,presentationTimeDelta:a,eventDuration:u,id:d,payload:h}}function f_(r,...t){const e=t.length;let i=8,s=e;for(;s--;)i+=t[s].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(r,4),s=0,i=8;s<e;s++)a.set(t[s],i),i+=t[s].byteLength;return a}function d_(r,t,e){if(r.byteLength!==16)throw new RangeError("Invalid system id");let i,s;i=0,s=new Uint8Array;let a;i>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;const l=new Uint8Array(4);return e.byteLength>0&&new DataView(l.buffer).setUint32(0,e.byteLength,!1),f_([112,115,115,104],new Uint8Array([i,0,0,0]),r,a,s,l,e)}function h_(r){const t=[];if(r instanceof ArrayBuffer){const e=r.byteLength;let i=0;for(;i+32<e;){const s=new DataView(r,i),a=m_(s);t.push(a),i+=a.size}}return t}function m_(r){const t=r.getUint32(0),e=r.byteOffset,i=r.byteLength;if(i<t)return{offset:e,size:i};if(r.getUint32(4)!==1886614376)return{offset:e,size:t};const a=r.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:e,size:t};const l=r.buffer,u=Ve(new Uint8Array(l,e+12,16));let d=null,f=null,h=0;if(a===0)h=28;else{const g=r.getUint32(28);if(!g||i<32+g*16)return{offset:e,size:t};d=[];for(let y=0;y<g;y++)d.push(new Uint8Array(l,e+32+y*16,16));h=32+g*16}if(!h)return{offset:e,size:t};const p=r.getUint32(h);return t-32<p?{offset:e,size:t}:(f=new Uint8Array(l,e+h+4,p),{version:a,systemId:u,kids:d,data:f,offset:e,size:t})}const ZE=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),qr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ch(r,t){const e=qr[t];return!!e&&!!e[r.slice(0,4)]}function io(r,t,e=!0){return!r.split(",").some(i=>!wh(i,t,e))}function wh(r,t,e=!0){var i;const s=hs(e);return(i=s?.isTypeSupported(no(r,t)))!=null?i:!1}function no(r,t){return`${t}/mp4;codecs=${r}`}function Cy(r){if(r){const t=r.substring(0,4);return qr.video[t]}return 2}function hu(r){const t=ZE();return r.split(",").reduce((e,i)=>{const a=t&&Mu(i)?9:qr.video[i];return a?(a*2+e)/(e?3:2):(qr.audio[i]+e)/(e?2:1)},0)}const md={};function p_(r,t=!0){if(md[r])return md[r];const e={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[r];for(let s=0;s<e.length;s++){var i;if(wh(e[s],"audio",t))return md[r]=e[s],e[s];if(e[s]==="mp3"&&(i=hs(t))!=null&&i.isTypeSupported("audio/mpeg"))return""}return r}const g_=/flac|opus|mp4a\.40\.34/i;function mu(r,t=!0){return r.replace(g_,e=>p_(e.toLowerCase(),t))}function y_(r,t){const e=[];if(r){const i=r.split(",");for(let s=0;s<i.length;s++)Ch(i[s],"video")||e.push(i[s])}return t&&e.push(t),e.join(",")}function Zl(r,t){if(r&&(r.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(r)!==-1)&&(wy(r,"audio")||wy(r,"video")))return r;if(t){const e=t.split(",");if(e.length>1){if(r){for(let i=e.length;i--;)if(e[i].substring(0,4)===r.substring(0,4))return e[i]}return e[0]}}return t||r}function wy(r,t){return Ch(r,t)&&wh(r,t)}function v_(r){const t=r.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(".");i.length>2&&i[0]==="avc1"&&(t[e]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return t.join(",")}function E_(r){if(r.startsWith("av01.")){const t=r.split("."),e=["0","111","01","01","01","0"];for(let i=t.length;i>4&&i<10;i++)t[i]=e[i-4];return t.join(".")}return r}function Dy(r){const t=hs(r)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function zd(r){return r.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const x_={supported:!0,powerEfficient:!0,smooth:!0},S_={supported:!1,smooth:!1,powerEfficient:!1},JE={supported:!0,configurations:[],decodingInfoResults:[x_]};function tx(r,t){return{supported:!1,configurations:t,decodingInfoResults:[S_],error:r}}function T_(r,t,e,i,s,a){const l=r.videoCodec,u=r.audioCodec?r.audioGroups:null,d=a?.audioCodec,f=a?.channels,h=f?parseInt(f):d?1/0:2;let p=null;if(u!=null&&u.length)try{u.length===1&&u[0]?p=t.groups[u[0]].channels:p=u.reduce((g,y)=>{if(y){const v=t.groups[y];if(!v)throw new Error(`Audio track group ${y} not found`);Object.keys(v.channels).forEach(S=>{g[S]=(g[S]||0)+v.channels[S]})}return g},{2:0})}catch{return!0}return l!==void 0&&(l.split(",").some(g=>Mu(g))||r.width>1920&&r.height>1088||r.height>1920&&r.width>1088||r.frameRate>Math.max(i,30)||r.videoRange!=="SDR"&&r.videoRange!==e||r.bitrate>Math.max(s,8e6))||!!p&&ht(h)&&Object.keys(p).some(g=>parseInt(g)>h)}function ex(r,t,e,i={}){const s=r.videoCodec;if(!s&&!r.audioCodec||!e)return Promise.resolve(JE);const a=[],l=b_(r),u=l.length,d=A_(r,t,u>0),f=d.length;for(let h=u||1*f||1;h--;){const p={type:"media-source"};if(u&&(p.video=l[h%u]),f){p.audio=d[h%f];const g=p.audio.bitrate;p.video&&g&&(p.video.bitrate-=g)}a.push(p)}if(s){const h=navigator.userAgent;if(s.split(",").some(p=>Mu(p))&&ZE())return Promise.resolve(tx(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${h})`),a))}return Promise.all(a.map(h=>{const p=L_(h);return i[p]||(i[p]=e.decodingInfo(h))})).then(h=>({supported:!h.some(p=>!p.supported),configurations:a,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:a,decodingInfoResults:[],error:h}))}function b_(r){var t;const e=(t=r.videoCodec)==null?void 0:t.split(","),i=ix(r),s=r.width||640,a=r.height||480,l=r.frameRate||30,u=r.videoRange.toLowerCase();return e?e.map(d=>{const f={contentType:no(E_(d),"video"),width:s,height:a,bitrate:i,framerate:l};return u!=="sdr"&&(f.transferFunction=u),f}):[]}function A_(r,t,e){var i;const s=(i=r.audioCodec)==null?void 0:i.split(","),a=ix(r);return s&&r.audioGroups?r.audioGroups.reduce((l,u)=>{var d;const f=u?(d=t.groups[u])==null?void 0:d.tracks:null;return f?f.reduce((h,p)=>{if(p.groupId===u){const g=parseFloat(p.channels||"");s.forEach(y=>{const v={contentType:no(y,"audio"),bitrate:e?R_(y,a):a};g&&(v.channels=""+g),h.push(v)})}return h},l):l},[]):[]}function R_(r,t){if(t<=1)return 1;let e=128e3;return r==="ec-3"?e=768e3:r==="ac-3"&&(e=64e4),Math.min(t/2,e)}function ix(r){return Math.ceil(Math.max(r.bitrate*.9,r.averageBitrate)/1e3)*1e3||1}function L_(r){let t="";const{audio:e,video:i}=r;if(i){const s=zd(i.contentType);t+=`${s}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(e){const s=zd(e.contentType);t+=`${i?"_":""}${s}_c${e.channels}`}return t}const Vd=["NONE","TYPE-0","TYPE-1",null];function __(r){return Vd.indexOf(r)>-1}const pu=["SDR","PQ","HLG"];function C_(r){return!!r&&pu.indexOf(r)>-1}var Jl={No:"",Yes:"YES",v2:"v2"};function Iy(r){const{canSkipUntil:t,canSkipDateRanges:e,age:i}=r,s=i<t/2;return t&&s?e?Jl.v2:Jl.Yes:Jl.No}class Oy{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return this.msn!==void 0&&e.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class so{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const i=(e=t.supplemental)==null?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return ky(this._audioGroups,t)}hasSubtitleGroup(t){return ky(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e){if(t==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(e)===-1&&i.push(e)}else if(t==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(e)===-1&&i.push(e)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function ky(r,t){return!t||!r?!1:r.indexOf(t)!==-1}function w_(){if(typeof matchMedia=="function"){const r=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(r.media!==t.media)return r.matches===!0}return!1}function D_(r,t){let e=!1,i=[];if(r&&(e=r!=="SDR",i=[r]),t){i=t.allowedVideoRanges||pu.slice(0);const s=i.join("")!=="SDR"&&!t.videoCodec;e=t.preferHDR!==void 0?t.preferHDR:s&&w_(),e||(i=["SDR"])}return{preferHDR:e,allowedVideoRanges:i}}const I_=r=>{const t=new WeakSet;return(e,i)=>{if(r&&(i=r(e,i)),typeof i=="object"&&i!==null){if(t.has(i))return;t.add(i)}return i}},Zt=(r,t)=>JSON.stringify(r,I_(t));function O_(r,t,e,i,s){const a=Object.keys(r),l=i?.channels,u=i?.audioCodec,d=s?.videoCodec,f=l&&parseInt(l)===2;let h=!1,p=!1,g=1/0,y=1/0,v=1/0,S=1/0,T=0,A=[];const{preferHDR:b,allowedVideoRanges:R}=D_(t,s);for(let P=a.length;P--;){const B=r[a[P]];h||(h=B.channels[2]>0),g=Math.min(g,B.minHeight),y=Math.min(y,B.minFramerate),v=Math.min(v,B.minBitrate),R.filter(K=>B.videoRanges[K]>0).length>0&&(p=!0)}g=ht(g)?g:0,y=ht(y)?y:0;const C=Math.max(1080,g),D=Math.max(30,y);v=ht(v)?v:e,e=Math.max(v,e),p||(t=void 0);const N=a.length>1;return{codecSet:a.reduce((P,B)=>{const M=r[B];if(B===P)return P;if(A=p?R.filter(K=>M.videoRanges[K]>0):[],N){if(M.minBitrate>e)return Vi(B,`min bitrate of ${M.minBitrate} > current estimate of ${e}`),P;if(!M.hasDefaultAudio)return Vi(B,"no renditions with default or auto-select sound found"),P;if(u&&B.indexOf(u.substring(0,4))%5!==0)return Vi(B,`audio codec preference "${u}" not found`),P;if(l&&!f){if(!M.channels[l])return Vi(B,`no renditions with ${l} channel sound found (channels options: ${Object.keys(M.channels)})`),P}else if((!u||f)&&h&&M.channels[2]===0)return Vi(B,"no renditions with stereo sound found"),P;if(M.minHeight>C)return Vi(B,`min resolution of ${M.minHeight} > maximum of ${C}`),P;if(M.minFramerate>D)return Vi(B,`min framerate of ${M.minFramerate} > maximum of ${D}`),P;if(!A.some(K=>M.videoRanges[K]>0))return Vi(B,`no variants with VIDEO-RANGE of ${Zt(A)} found`),P;if(d&&B.indexOf(d.substring(0,4))%5!==0)return Vi(B,`video codec preference "${d}" not found`),P;if(M.maxScore<T)return Vi(B,`max score of ${M.maxScore} < selected max of ${T}`),P}return P&&(hu(B)>=hu(P)||M.fragmentError>r[P].fragmentError)?P:(S=M.minIndex,T=M.maxScore,B)},void 0),videoRanges:A,preferHDR:b,minFramerate:y,minBitrate:v,minIndex:S}}function Vi(r,t){Vt.log(`[abr] start candidates with "${r}" ignored because ${t}`)}function nx(r){return r.reduce((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const s=e.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function k_(r,t,e,i){return r.slice(e,i+1).reduce((s,a,l)=>{if(!a.codecSet)return s;const u=a.audioGroups;let d=s[a.codecSet];d||(s[a.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,a.bitrate);const f=Math.min(a.height,a.width);return d.minHeight=Math.min(d.minHeight,f),d.minFramerate=Math.min(d.minFramerate,a.frameRate),d.minIndex=Math.min(d.minIndex,l),d.maxScore=Math.max(d.maxScore,a.score),d.fragmentError+=a.fragmentError,d.videoRanges[a.videoRange]=(d.videoRanges[a.videoRange]||0)+1,u&&u.forEach(h=>{if(!h)return;const p=t.groups[h];p&&(d.hasDefaultAudio=d.hasDefaultAudio||t.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(p.channels).forEach(g=>{d.channels[g]=(d.channels[g]||0)+p.channels[g]}))}),s},{})}function My(r){if(!r)return r;const{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:a}=r;return{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:a}}function Wi(r,t,e){if("attrs"in r){const i=t.indexOf(r);if(i!==-1)return i}for(let i=0;i<t.length;i++){const s=t[i];if(js(r,s,e))return i}return-1}function js(r,t,e){const{groupId:i,name:s,lang:a,assocLang:l,default:u}=r,d=r.forced;return(i===void 0||t.groupId===i)&&(s===void 0||t.name===s)&&(a===void 0||M_(a,t.lang))&&(a===void 0||t.assocLang===l)&&(u===void 0||t.default===u)&&(d===void 0||t.forced===d)&&(!("characteristics"in r)||P_(r.characteristics||"",t.characteristics))&&(e===void 0||e(r,t))}function M_(r,t="--"){return r.length===t.length?r===t:r.startsWith(t)||t.startsWith(r)}function P_(r,t=""){const e=r.split(","),i=t.split(",");return e.length===i.length&&!e.some(s=>i.indexOf(s)===-1)}function Us(r,t){const{audioCodec:e,channels:i}=r;return(e===void 0||(t.audioCodec||"").substring(0,4)===e.substring(0,4))&&(i===void 0||i===(t.channels||"2"))}function N_(r,t,e,i,s){const a=t[i],u=t.reduce((g,y,v)=>{const S=y.uri;return(g[S]||(g[S]=[])).push(v),g},{})[a.uri];u.length>1&&(i=Math.max.apply(Math,u));const d=a.videoRange,f=a.frameRate,h=a.codecSet.substring(0,4),p=Py(t,i,g=>{if(g.videoRange!==d||g.frameRate!==f||g.codecSet.substring(0,4)!==h)return!1;const y=g.audioGroups,v=e.filter(S=>!y||y.indexOf(S.groupId)!==-1);return Wi(r,v,s)>-1});return p>-1?p:Py(t,i,g=>{const y=g.audioGroups,v=e.filter(S=>!y||y.indexOf(S.groupId)!==-1);return Wi(r,v,s)>-1})}function Py(r,t,e){for(let i=t;i>-1;i--)if(e(r[i]))return i;for(let i=t+1;i<r.length;i++)if(e(r[i]))return i;return-1}function gu(r,t){var e;return!!r&&r!==((e=t.loadLevelObj)==null?void 0:e.uri)}class F_ extends wi{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var i;const{fragCurrent:s,partCurrent:a,hls:l}=this,{autoLevelEnabled:u,media:d}=l;if(!s||!d)return;const f=performance.now(),h=a?a.stats:s.stats,p=a?a.duration:s.duration,g=f-h.loading.start,y=l.minAutoLevel,v=s.level,S=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||v<=y){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const T=S>-1&&S!==v,A=!!e||T;if(!A&&(d.paused||!d.playbackRate||!d.readyState))return;const b=l.mainForwardBufferInfo;if(!A&&b===null)return;const R=this.bwEstimator.getEstimateTTFB(),C=Math.abs(d.playbackRate);if(g<=Math.max(R,1e3*(p/(C*2))))return;const D=b?b.len/C:0,N=h.loading.first?h.loading.first-h.loading.start:-1,w=h.loaded&&N>-1,P=this.getBwEstimate(),B=l.levels,M=B[v],K=Math.max(h.loaded,Math.round(p*(s.bitrate||M.averageBitrate)/8));let tt=w?g-N:g;tt<1&&w&&(tt=Math.min(g,h.loaded*8/P));const z=w?h.loaded*1e3/tt:0,G=R/1e3,Y=z?(K-h.loaded)/z:K*8/P+G;if(Y<=D)return;const O=z?z*8:P,j=((i=e?.details||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,V=this.hls.config.abrBandWidthUpFactor;let nt=Number.POSITIVE_INFINITY,ut;for(ut=v-1;ut>y;ut--){const ct=B[ut].maxBitrate,ft=!B[ut].details||j;if(nt=this.getTimeToLoadFrag(G,O,p*ct,ft),nt<Math.min(D,p+G))break}if(nt>=Y||nt>p*10)return;w?this.bwEstimator.sample(g-Math.min(R,N),h.loaded):this.bwEstimator.sampleTTFB(g);const k=B[ut].maxBitrate;this.getBwEstimate()*V>k&&this.resetEstimator(k);const $=this.findBestLevel(k,y,ut,0,D,1,1);$>-1&&(ut=$),this.warn(`Fragment ${s.sn}${a?" part "+a.index:""} of level ${v} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${D.toFixed(3)} s
      Estimated load time for current fragment: ${Y.toFixed(3)} s
      Estimated load time for down switch fragment: ${nt.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${ht(P)?P|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${ut} @ ${k|0} bps`),l.nextLoadLevel=l.nextAutoLevel=ut,this.clearTimer();const st=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===ut&&ut>0){const ct=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ut>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${ct.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,ut>y){let ft=this.findBestLevel(this.hls.levels[y].bitrate,y,ut,0,ct,1,1);ft===-1&&(ft=y),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ft,this.resetEstimator(this.hls.levels[ft].bitrate)}}};T||Y>nt*2?st():this.timer=self.setInterval(st,nt*1e3),l.trigger(_.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:a,stats:h})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new GL(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(_.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var s;this.fragCurrent=i,this.partCurrent=(s=e.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const i=e.frag,{fragCurrent:s,partCurrent:a}=this;if(i&&s&&i.sn===s.sn&&i.level===s.level){const l=performance.now(),u=a?a.stats:i.stats,d=l-u.loading.start,f=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&f>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,f),u.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(t,e,i,s){const a=t+i/e,l=s?t+this.lastLevelLoadSec:0;return a+l}onLevelLoaded(t,e){const i=this.hls.config,{loading:s}=e.stats,a=s.end-s.first;ht(a)&&(this.lastLevelLoadSec=a/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:i}){const s=i?i.stats:e.stats;if(e.type===mt.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=i?i.duration:e.duration,l=this.hls.levels[e.level],u=(l.loaded?l.loaded.bytes:0)+s.loaded,d=(l.loaded?l.loaded.duration:0)+a;l.loaded={bytes:u,duration:d},l.realBitrate=Math.round(8*u/d)}if(e.bitrateTest){const a={stats:s,frag:e,part:i,id:e.type};this.onFragBuffered(_.FRAG_BUFFERED,a),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:i,part:s}=e,a=s!=null&&s.stats.loaded?s.stats:i.stats;if(a.aborted||this.ignoreFragment(i))return;const l=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==mt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,e,t,0,s,1,1);if(a>-1)return a;const l=this.hls.firstLevel,u=Math.min(Math.max(l,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(t!==-1&&(!i||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const a=i&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const l=this.hls.levels;if(l.length>Math.max(t,a)&&l[t].loadError<=l[a].loadError)return t}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:s,config:a,minAutoLevel:l}=i,u=e?e.duration:t?t.duration:0,d=this.getBwEstimate(),f=this.getStarvationDelay();let h=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(f){const T=this.findBestLevel(d,l,s,f,0,h,p);if(T>=0)return this.rebufferNotice=-1,T}let g=u?Math.min(u,a.maxStarvationDelay):a.maxStarvationDelay;if(!f){const T=this.bitrateTestDelay;T&&(g=(u?Math.min(u,a.maxLoadingDelay):a.maxLoadingDelay)-T,this.info(`bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),h=p=1)}const y=this.findBestLevel(d,l,s,f,g,h,p);if(this.rebufferNotice!==y&&(this.rebufferNotice=y,this.info(`${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${y}`)),y>-1)return y;const v=i.levels[l],S=i.loadLevelObj;return S&&v?.bitrate<S.bitrate?l:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&e.playbackRate!==0?Math.abs(e.playbackRate):1,s=t.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,s,a,l,u){var d;const f=s+a,h=this.lastLoadedFragLevel,p=h===-1?this.hls.firstLevel:h,{fragCurrent:g,partCurrent:y}=this,{levels:v,allAudioTracks:S,loadLevel:T,config:A}=this.hls;if(v.length===1)return 0;const b=v[p],R=!!((d=this.hls.latestLevelDetails)!=null&&d.live),C=T===-1||h===-1;let D,N="SDR",w=b?.frameRate||0;const{audioPreference:P,videoPreference:B}=A,M=this.audioTracksByGroup||(this.audioTracksByGroup=nx(S));let K=-1;if(C){if(this.firstSelection!==-1)return this.firstSelection;const O=this.codecTiers||(this.codecTiers=k_(v,M,e,i)),j=O_(O,N,t,P,B),{codecSet:V,videoRanges:nt,minFramerate:ut,minBitrate:k,minIndex:$,preferHDR:st}=j;K=$,D=V,N=st?nt[nt.length-1]:nt[0],w=ut,t=Math.max(t,k),this.log(`picked start tier ${Zt(j)}`)}else D=b?.codecSet,N=b?.videoRange;const tt=y?y.duration:g?g.duration:0,z=this.bwEstimator.getEstimateTTFB()/1e3,G=[];for(let O=i;O>=e;O--){var Y;const j=v[O],V=O>p;if(!j)continue;if(A.useMediaCapabilities&&!j.supportedResult&&!j.supportedPromise){const ft=navigator.mediaCapabilities;typeof ft?.decodingInfo=="function"&&T_(j,M,N,w,t,P)?(j.supportedPromise=ex(j,M,ft,this.supportedCache),j.supportedPromise.then(dt=>{if(!this.hls)return;j.supportedResult=dt;const Et=this.hls.levels,Lt=Et.indexOf(j);dt.error?this.warn(`MediaCapabilities decodingInfo error: "${dt.error}" for level ${Lt} ${Zt(dt)}`):dt.supported?dt.decodingInfoResults.some(_t=>_t.smooth===!1||_t.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Lt} not smooth or powerEfficient: ${Zt(dt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Lt} ${Zt(dt)}`),Lt>-1&&Et.length>1&&(this.log(`Removing unsupported level ${Lt}`),this.hls.removeLevel(Lt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(dt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${dt}`)})):j.supportedResult=JE}if((D&&j.codecSet!==D||N&&j.videoRange!==N||V&&w>j.frameRate||!V&&w>0&&w<j.frameRate||(Y=j.supportedResult)!=null&&(Y=Y.decodingInfoResults)!=null&&Y.some(ft=>ft.smooth===!1))&&(!C||O!==K)){G.push(O);continue}const nt=j.details,ut=(y?nt?.partTarget:nt?.averagetargetduration)||tt;let k;V?k=u*t:k=l*t;const $=tt&&s>=tt*2&&a===0?j.averageBitrate:j.maxBitrate,st=this.getTimeToLoadFrag(z,k,$*ut,nt===void 0);if(k>=$&&(O===h||j.loadError===0&&j.fragmentError===0)&&(st<=z||!ht(st)||R&&!this.bitrateTestDelay||st<f)){const ft=this.forcedAutoLevel;return O!==T&&(ft===-1||ft!==T)&&(G.length&&this.trace(`Skipped level(s) ${G.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${v[G[0]].codecs}" ${v[G[0]].videoRange}; not compatible with "${D}" ${N}`),this.info(`switch candidate:${p}->${O} adjustedbw(${Math.round(k)})-bitrate=${Math.round(k-$)} ttfb:${z.toFixed(1)} avgDuration:${ut.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${st.toFixed(1)} firstSelection:${C} codecSet:${j.codecSet} videoRange:${j.videoRange} hls.loadLevel:${T}`)),C&&(this.firstSelection=O),O}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}}const sx={search:function(r,t){let e=0,i=r.length-1,s=null,a=null;for(;e<=i;){s=(e+i)/2|0,a=r[s];const l=t(a);if(l>0)e=s+1;else if(l<0)i=s-1;else return a}return null}};function B_(r,t,e){if(t===null||!Array.isArray(r)||!r.length||!ht(t))return null;const i=r[0].programDateTime;if(t<(i||0))return null;const s=r[r.length-1].endProgramDateTime;if(t>=(s||0))return null;for(let a=0;a<r.length;++a){const l=r[a];if($_(t,e,l))return l}return null}function Vs(r,t,e=0,i=0,s=.005){let a=null;if(r){a=t[1+r.sn-t[0].sn]||null;const u=r.endDTS-e;u>0&&u<15e-7&&(e+=15e-7),a&&r.level!==a.level&&a.end<=r.end&&(a=t[2+r.sn-t[0].sn]||null)}else e===0&&t[0].start===0&&(a=t[0]);if(a&&((!r||r.level===a.level)&&Ny(e,i,a)===0||U_(a,r,Math.min(s,i))))return a;const l=sx.search(t,Ny.bind(null,e,i));return l&&(l!==r||!a)?l:a}function U_(r,t,e){if(t&&t.start===0&&t.level<r.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((s,a)=>(a[0]==="INF"&&(s+=parseFloat(a[1])),s),e);return r.start<=i}return!1}function Ny(r=0,t=0,e){if(e.start<=r&&e.start+e.duration>r)return 0;const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-i<=r?1:e.start-i>r&&e.start?-1:0}function $_(r,t,e){const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0))*1e3;return(e.endProgramDateTime||0)-i>r}function rx(r,t,e){if(r&&r.startCC<=t&&r.endCC>=t){let i=r.fragments;const{fragmentHint:s}=r;s&&(i=i.concat(s));let a;return sx.search(i,l=>l.cc<t?1:l.cc>t?-1:(a=l,l.end<=e?1:l.start>e?-1:0)),a||null}return null}function yu(r){switch(r.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ax(r){return r.details.startsWith("key")}function ox(r){return ax(r)&&!!r.frag&&!r.frag.decryptdata}function Fy(r,t){const e=yu(t);return r.default[`${e?"timeout":"error"}Retry`]}function Dh(r,t){const e=r.backoff==="linear"?1:Math.pow(2,t);return Math.min(e*r.retryDelayMs,r.maxRetryDelayMs)}function By(r){return zt(zt({},r),{errorRetry:null,timeoutRetry:null})}function vu(r,t,e,i){if(!r)return!1;const s=i?.code,a=t<r.maxNumRetry&&(j_(s)||!!e);return r.shouldRetry?r.shouldRetry(r,t,e,i,a):a}function j_(r){return Kd(r)||!!r&&(r<400||r>499)}function Kd(r){return r===0&&navigator.onLine===!1}var Fe={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},fi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class G_ extends wi{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(_.ERROR,this.onError,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(_.ERROR,this.onError,this),t.off(_.ERROR,this.onErrorOut,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return t?.type===mt.MAIN?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,i=e.currentLevel;return(t=e.loadLevelObj)!=null&&t.details||i===-1?e.loadLevel:i}variantHasKey(t,e){if(t){var i;if((i=t.details)!=null&&i.hasKey(e))return!0;const s=t.audioGroups;if(s)return this.hls.allAudioTracks.filter(l=>s.indexOf(l.groupId)>=0).some(l=>{var u;return(u=l.details)==null?void 0:u.hasKey(e)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;const s=this.hls,a=e.context;switch(e.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:e.errorAction=this.getFragRetryOrSwitchAction(e);return;case Q.FRAG_PARSING_ERROR:if((i=e.frag)!=null&&i.gap){e.errorAction=Gr();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{e.errorAction=this.getFragRetryOrSwitchAction(e),e.errorAction.action=Fe.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var l;const d=e.parent===mt.MAIN?e.level:s.loadLevel;e.details===Q.LEVEL_EMPTY_ERROR&&((l=e.context)!=null&&(l=l.levelDetails)!=null&&l.live)?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,d):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,d))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof a?.level=="number"&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,a.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const d=s.loadLevelObj;if(d&&(a.type===It.AUDIO_TRACK&&d.hasAudioGroup(a.groupId)||a.type===It.SUBTITLE_TRACK&&d.hasSubtitleGroup(a.groupId))){e.errorAction=this.getPlaylistRetryOrSwitchAction(e,s.loadLevel),e.errorAction.action=Fe.SendAlternateToPenaltyBox,e.errorAction.flags=fi.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:e.errorAction={action:Fe.SendAlternateToPenaltyBox,flags:fi.MoveAllAlternatesMatchingHDCP};return;case Q.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Q.KEY_SYSTEM_NO_SESSION:e.errorAction={action:Fe.SendAlternateToPenaltyBox,flags:fi.MoveAllAlternatesMatchingKey};return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!e.errorAction){var u;e.errorAction=this.getLevelSwitchAction(e,(u=e.level)!=null?u:s.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:e.errorAction=Gr();return}e.type===vt.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=Gr())}getPlaylistRetryOrSwitchAction(t,e){const i=this.hls,s=Fy(i.config.playlistLoadPolicy,t),a=this.playlistError++;if(vu(s,a,yu(t),t.response))return{action:Fe.RetryRequest,flags:fi.None,retryConfig:s,retryCount:a};const u=this.getLevelSwitchAction(t,e);return s&&(u.retryConfig=s,u.retryCount=a),u}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),s=e.levels[i],{fragLoadPolicy:a,keyLoadPolicy:l}=e.config,u=Fy(ax(t)?l:a,t),d=e.levels.reduce((h,p)=>h+p.fragmentError,0);if(s&&(t.details!==Q.FRAG_GAP&&s.fragmentError++,!ox(t)&&vu(u,d,yu(t),t.response)))return{action:Fe.RetryRequest,flags:fi.None,retryConfig:u,retryCount:d};const f=this.getLevelSwitchAction(t,i);return u&&(f.retryConfig=u,f.retryCount=d),f}getLevelSwitchAction(t,e){const i=this.hls;e==null&&(e=i.loadLevel);const s=this.hls.levels[e];if(s){var a,l;const f=t.details;s.loadError++,f===Q.BUFFER_APPEND_ERROR&&s.fragmentError++;let h=-1;const{levels:p,loadLevel:g,minAutoLevel:y,maxAutoLevel:v}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const S=(a=t.frag)==null?void 0:a.type,A=(S===mt.AUDIO&&f===Q.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:N})=>s.audioCodec!==N),R=t.sourceBufferName==="video"&&(f===Q.BUFFER_ADD_CODEC_ERROR||f===Q.BUFFER_APPEND_ERROR)&&p.some(({codecSet:N,audioCodec:w})=>s.codecSet!==N&&s.audioCodec===w),{type:C,groupId:D}=(l=t.context)!=null?l:{};for(let N=p.length;N--;){const w=(N+g)%p.length;if(w!==g&&w>=y&&w<=v&&p[w].loadError===0){var u,d;const P=p[w];if(f===Q.FRAG_GAP&&S===mt.MAIN&&t.frag){const B=p[w].details;if(B){const M=Vs(t.frag,B.fragments,t.frag.start);if(M!=null&&M.gap)continue}}else{if(C===It.AUDIO_TRACK&&P.hasAudioGroup(D)||C===It.SUBTITLE_TRACK&&P.hasSubtitleGroup(D))continue;if(S===mt.AUDIO&&(u=s.audioGroups)!=null&&u.some(B=>P.hasAudioGroup(B))||S===mt.SUBTITLE&&(d=s.subtitleGroups)!=null&&d.some(B=>P.hasSubtitleGroup(B))||A&&s.audioCodec===P.audioCodec||R&&s.codecSet===P.codecSet||!A&&s.codecSet!==P.codecSet)continue}h=w;break}}if(h>-1&&i.loadLevel!==h)return t.levelRetry=!0,this.playlistError=0,{action:Fe.SendAlternateToPenaltyBox,flags:fi.None,nextAutoLevel:h}}return{action:Fe.SendAlternateToPenaltyBox,flags:fi.MoveAllAlternatesMatchingHost}}onErrorOut(t,e){var i;switch((i=e.errorAction)==null?void 0:i.action){case Fe.DoNothing:break;case Fe.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(e),!e.errorAction.resolved&&e.details!==Q.FRAG_GAP?e.fatal=!0:/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(e.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:s}=i,a=i.nextAutoLevel;switch(s){case fi.None:this.switchLevel(t,a);break;case fi.MoveAllAlternatesMatchingHDCP:{const d=this.getVariantLevelIndex(t.frag),f=e.levels[d],h=f?.attrs["HDCP-LEVEL"];if(i.hdcpLevel=h,h==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(h){e.maxHdcpLevel=Vd[Vd.indexOf(h)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}}case fi.MoveAllAlternatesMatchingKey:{const d=t.decryptdata;if(d){const f=this.hls.levels,h=f.length;for(let g=h;g--;)if(this.variantHasKey(f[g],d)){var l,u;this.log(`Banned key found in level ${g} (${f[g].bitrate}bps) or audio group "${(l=f[g].audioGroups)==null?void 0:l.join(",")}" (${(u=t.frag)==null?void 0:u.type} fragment) ${Ve(d.keyId||[])}`),f[g].fragmentError++,f[g].loadError++,this.log(`Removing level ${g} with key error (${t.error})`),this.hls.removeLevel(g)}const p=t.frag;if(this.hls.levels.length<h)i.resolved=!0;else if(p&&p.type!==mt.MAIN){const g=p.decryptdata;g&&!d.matches(g)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(t,a)}switchLevel(t,e){if(e!==void 0&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===Q.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&t.sourceBufferName!=="audiovideo")){const i=zd(t.mimeType),s=this.hls.levels;for(let a=s.length;a--;)s[a][`${t.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${a} for ${t.details} ("${i}" not supported)`),this.hls.removeLevel(a))}}}function Gr(r){const t={action:Fe.DoNothing,flags:fi.None};return r&&(t.resolved=!0),t}var Ae={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class H_{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let s=i.length;s--;){const a=i[s];if(!a)break;if(a.start<=t&&t<=a.end&&a.loaded)return a}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){const{fragments:s}=this,a=Object.keys(s);for(let l=a.length;l--;){const u=s[a[l]];if(u?.body.type===e&&(!i||u.buffered)){const d=u.body;if(d.start<=t&&t<=d.end)return d}}return null}detectEvictedFragments(t,e,i,s,a){this.timeRanges&&(this.timeRanges[t]=e);const l=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(u=>{const d=this.fragments[u];if(!d||l>=d.body.sn)return;if(!d.buffered&&(!d.loaded||a)){d.body.type===i&&this.removeFragment(d.body);return}const f=d.range[t];if(f){if(f.time.length===0){this.removeFragment(d.body);return}f.time.some(h=>{const p=!this.isTimeBuffered(h.startPTS,h.endPTS,e);return p&&this.removeFragment(d.body),p})}})}detectPartialFragments(t){const e=this.timeRanges;if(!e||t.frag.sn==="initSegment")return;const i=t.frag,s=Pr(i),a=this.fragments[s];if(!a||a.buffered&&i.gap)return;const l=!i.relurl;Object.keys(e).forEach(u=>{const d=i.elementaryStreams[u];if(!d)return;const f=e[u],h=l||d.partial===!0;a.range[u]=this.getBufferedTimes(i,t.part,h,f)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),Pl(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=Uy(i,s=>s.fragment.sn>=t))}fragBuffered(t,e){const i=Pr(t);let s=this.fragments[i];!s&&e&&(s=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(t,e,i,s){const a={time:[],partial:i},l=t.start,u=t.end,d=t.minEndPTS||u,f=t.maxStartPTS||l;for(let h=0;h<s.length;h++){const p=s.start(h)-this.bufferPadding,g=s.end(h)+this.bufferPadding;if(f>=p&&d<=g){a.time.push({startPTS:Math.max(l,s.start(h)),endPTS:Math.min(u,s.end(h))});break}else if(l<g&&u>p){const y=Math.max(l,s.start(h)),v=Math.min(u,s.end(h));v>y&&(a.partial=!0,a.time.push({startPTS:y,endPTS:v}))}else if(u<=p)break}return a}getPartialFragment(t){let e=null,i,s,a,l=0;const{bufferPadding:u,fragments:d}=this;return Object.keys(d).forEach(f=>{const h=d[f];h&&Pl(h)&&(s=h.body.start-u,a=h.body.end+u,t>=s&&t<=a&&(i=Math.min(t-s,a-t),l<=i&&(e=h.body,l=i)))}),e}isEndListAppended(t){const e=this.endListFragments[t];return e!==void 0&&(e.buffered||Pl(e))}getState(t){const e=Pr(t),i=this.fragments[e];return i?i.buffered?Pl(i)?Ae.PARTIAL:Ae.OK:Ae.APPENDING:Ae.NOT_LOADED}isTimeBuffered(t,e,i){let s,a;for(let l=0;l<i.length;l++){if(s=i.start(l)-this.bufferPadding,a=i.end(l)+this.bufferPadding,t>=s&&e<=a)return!0;if(e<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if(e.frag.sn==="initSegment"||e.frag.bitrateTest)return;const i=e.frag,s=e.part?null:e,a=Pr(i);this.fragments[a]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:s,timeRanges:a,type:l}=e;if(i.sn==="initSegment")return;const u=i.type;if(s){let f=this.activePartLists[u];f||(this.activePartLists[u]=f=[]),f.push(s)}this.timeRanges=a;const d=a[l];this.detectEvictedFragments(l,d,u,s)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=Pr(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let s=i.length;s--;){const a=e[i[s]];if(a?.body.type===t)return!0}return!1}hasParts(t){var e;return!!((e=this.activePartLists[t])!=null&&e.length)}removeFragmentsInRange(t,e,i,s,a){s&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u)return;const d=u.body;d.type!==i||s&&!d.gap||d.start<e&&d.end>t&&(u.buffered||a)&&this.removeFragment(d)})}removeFragment(t){const e=Pr(t);t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const s=t.sn;this.activePartLists[t.type]=Uy(i,a=>a.fragment.sn!==s)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=(t=this.hls)==null||(t=t.latestLevelDetails)==null?void 0:t.partList;e&&e.forEach(i=>i.clearElementaryStreamInfo())}}function Pl(r){var t,e,i;return r.buffered&&!!(r.body.gap||(t=r.range.video)!=null&&t.partial||(e=r.range.audio)!=null&&e.partial||(i=r.range.audiovideo)!=null&&i.partial)}function Pr(r){return`${r.type}_${r.level}_${r.sn}`}function Uy(r,t){return r.filter(e=>{const i=t(e);return i||e.clearElementaryStreamInfo(),i})}var ms={cbc:0,ctr:1};class z_{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case ms.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case ms.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function V_(r){const t=r.byteLength,e=t&&new DataView(r.buffer).getUint8(t-1);return e?r.slice(0,t-e):r}class K_{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let s=0;s<4;s++)i[s]=e.getUint32(s*4);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,s=i[0],a=i[1],l=i[2],u=i[3],d=this.invSubMix,f=d[0],h=d[1],p=d[2],g=d[3],y=new Uint32Array(256);let v=0,S=0,T=0;for(T=0;T<256;T++)T<128?y[T]=T<<1:y[T]=T<<1^283;for(T=0;T<256;T++){let A=S^S<<1^S<<2^S<<3^S<<4;A=A>>>8^A&255^99,t[v]=A,e[A]=v;const b=y[v],R=y[b],C=y[R];let D=y[A]*257^A*16843008;s[v]=D<<24|D>>>8,a[v]=D<<16|D>>>16,l[v]=D<<8|D>>>24,u[v]=D,D=C*16843009^R*65537^b*257^v*16843008,f[A]=D<<24|D>>>8,h[A]=D<<16|D>>>16,p[A]=D<<8|D>>>24,g[A]=D,v?(v=b^y[y[y[C^b]]],S^=y[y[S]]):v=S=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,s=0;for(;s<e.length&&i;)i=e[s]===this.key[s],s++;if(i)return;this.key=e;const a=this.keySize=e.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const l=this.ksRows=(a+6+1)*4;let u,d;const f=this.keySchedule=new Uint32Array(l),h=this.invKeySchedule=new Uint32Array(l),p=this.sBox,g=this.rcon,y=this.invSubMix,v=y[0],S=y[1],T=y[2],A=y[3];let b,R;for(u=0;u<l;u++){if(u<a){b=f[u]=e[u];continue}R=b,u%a===0?(R=R<<8|R>>>24,R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255],R^=g[u/a|0]<<24):a>6&&u%a===4&&(R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255]),f[u]=b=(f[u-a]^R)>>>0}for(d=0;d<l;d++)u=l-d,d&3?R=f[u]:R=f[u-4],d<4||u<=4?h[d]=R:h[d]=v[p[R>>>24]]^S[p[R>>>16&255]]^T[p[R>>>8&255]]^A[p[R&255]],h[d]=h[d]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,e,i){const s=this.keySize+6,a=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,d=u[0],f=u[1],h=u[2],p=u[3],g=this.uint8ArrayToUint32Array_(i);let y=g[0],v=g[1],S=g[2],T=g[3];const A=new Int32Array(t),b=new Int32Array(A.length);let R,C,D,N,w,P,B,M,K,tt,z,G,Y,O;const j=this.networkToHostOrderSwap;for(;e<A.length;){for(K=j(A[e]),tt=j(A[e+1]),z=j(A[e+2]),G=j(A[e+3]),w=K^a[0],P=G^a[1],B=z^a[2],M=tt^a[3],Y=4,O=1;O<s;O++)R=d[w>>>24]^f[P>>16&255]^h[B>>8&255]^p[M&255]^a[Y],C=d[P>>>24]^f[B>>16&255]^h[M>>8&255]^p[w&255]^a[Y+1],D=d[B>>>24]^f[M>>16&255]^h[w>>8&255]^p[P&255]^a[Y+2],N=d[M>>>24]^f[w>>16&255]^h[P>>8&255]^p[B&255]^a[Y+3],w=R,P=C,B=D,M=N,Y=Y+4;R=l[w>>>24]<<24^l[P>>16&255]<<16^l[B>>8&255]<<8^l[M&255]^a[Y],C=l[P>>>24]<<24^l[B>>16&255]<<16^l[M>>8&255]<<8^l[w&255]^a[Y+1],D=l[B>>>24]<<24^l[M>>16&255]<<16^l[w>>8&255]<<8^l[P&255]^a[Y+2],N=l[M>>>24]<<24^l[w>>16&255]<<16^l[P>>8&255]<<8^l[B&255]^a[Y+3],b[e]=j(R^y),b[e+1]=j(N^v),b[e+2]=j(D^S),b[e+3]=j(C^T),y=K,v=tt,S=z,T=G,e=e+4}return b.buffer}}class q_{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){const t=Y_(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}function Y_(r){switch(r){case ms.cbc:return"AES-CBC";case ms.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${r}`)}}const X_=16;class Ih{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?V_(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,s){return this.useSoftware?new Promise((a,l)=>{const u=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(u,e,i,s);const d=this.flush();d?a(d.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,s)}softwareDecrypt(t,e,i,s){const{currentIV:a,currentResult:l,remainderData:u}=this;if(s!==ms.cbc||e.byteLength!==16)return Vt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(t=Ci(u,t),this.remainderData=null);const d=this.getValidChunk(t);if(!d.length)return null;a&&(i=a);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new K_),f.expandKey(e);const h=l;return this.currentResult=f.decrypt(d.buffer,0,i),this.currentIV=d.slice(-16).buffer,h||null}webCryptoDecrypt(t,e,i,s){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,s));this.key=e,this.fastAesKey=new q_(this.subtle,e,s)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new z_(this.subtle,new Uint8Array(i),s).decrypt(t.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Vt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(t,e,i,s)))}onWebCryptoError(t,e,i,s){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,s);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%X_;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){this.logEnabled&&(Vt.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const $y=Math.pow(2,17);class W_{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new wn({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,a=s.fLoader,l=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(v=>v[0]==="GAP")){d(Gy(t));return}else t.gap=!1;const f=this.loader=a?new a(s):new l(s),h=jy(t);t.loader=f;const p=By(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:$y};t.stats=f.stats;const y={onSuccess:(v,S,T,A)=>{this.resetLoader(t,f);let b=v.data;T.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(b.slice(0,16)),b=b.slice(16)),u({frag:t,part:null,payload:b,networkDetails:A})},onError:(v,S,T,A)=>{this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:zt({url:i,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:T,stats:A}))},onAbort:(v,S,T)=>{this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:T,stats:v}))},onTimeout:(v,S,T)=>{this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:T,stats:v}))}};e&&(y.onProgress=(v,S,T,A)=>e({frag:t,part:null,payload:T,networkDetails:A})),f.load(h,g,y)})}loadPart(t,e,i){this.abort();const s=this.config,a=s.fLoader,l=s.loader;return new Promise((u,d)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap){d(Gy(t,e));return}const f=this.loader=a?new a(s):new l(s),h=jy(t,e);t.loader=f;const p=By(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:$y};e.stats=f.stats,f.load(h,g,{onSuccess:(y,v,S,T)=>{this.resetLoader(t,f),this.updateStatsFromPart(t,e);const A={frag:t,part:e,payload:y.data,networkDetails:T};i(A),u(A)},onError:(y,v,S,T)=>{this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:zt({url:h.url,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:S,stats:T}))},onAbort:(y,v,S)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:S,stats:y}))},onTimeout:(y,v,S)=>{this.resetLoader(t,f),d(new wn({type:vt.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:S,stats:y}))}})})}updateStatsFromPart(t,e){const i=t.stats,s=e.stats,a=s.total;if(i.loaded+=s.loaded,a){const d=Math.round(t.duration/e.duration),f=Math.min(Math.round(i.loaded/a),d),p=(d-f)*Math.round(i.loaded/f);i.total=i.loaded+p}else i.total=Math.max(i.loaded,i.total);const l=i.loading,u=s.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function jy(r,t=null){const e=t||r,i={frag:r,part:t,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},s=e.byteRangeStartOffset,a=e.byteRangeEndOffset;if(ht(s)&&ht(a)){var l;let u=s,d=a;if(r.sn==="initSegment"&&Q_((l=r.decryptdata)==null?void 0:l.method)){const f=a-s;f%16&&(d=a+(16-f%16)),s!==0&&(i.resetIV=!0,u=s-16)}i.rangeStart=u,i.rangeEnd=d}return i}function Gy(r,t){const e=new Error(`GAP ${r.gap?"tag":"attribute"} found`),i={type:vt.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:r,error:e,networkDetails:null};return t&&(i.part=t),(t||r).stats.aborted=!0,new wn(i)}function Q_(r){return r==="AES-128"||r==="AES-256"}class wn extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class lx extends wi{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Oh{constructor(t,e,i,s=0,a=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Nl(),this.buffering={audio:Nl(),video:Nl(),audiovideo:Nl()},this.level=t,this.sn=e,this.id=i,this.size=s,this.part=a,this.partial=l}}function Nl(){return{start:0,executeStart:0,executeEnd:0,end:0}}const Hy={length:0,start:()=>0,end:()=>0};class At{static isBuffered(t,e){if(t){const i=At.getBuffered(t);for(let s=i.length;s--;)if(e>=i.start(s)&&e<=i.end(s))return!0}return!1}static bufferedRanges(t){if(t){const e=At.getBuffered(t);return At.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){const s=At.bufferedRanges(t);if(s.length)return At.bufferedInfo(s,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort((h,p)=>h.start-p.start||p.end-h.end);let s=-1,a=[];if(i)for(let h=0;h<t.length;h++){e>=t[h].start&&e<=t[h].end&&(s=h);const p=a.length;if(p){const g=a[p-1].end;t[h].start-g<i?t[h].end>g&&(a[p-1].end=t[h].end):a.push(t[h])}else a.push(t[h])}else a=t;let l=0,u,d=e,f=e;for(let h=0;h<a.length;h++){const p=a[h].start,g=a[h].end;if(s===-1&&e>=p&&e<=g&&(s=h),e+i>=p&&e<g)d=p,f=g,l=f-e;else if(e+i<p){u=p;break}}return{len:l,start:d||0,end:f||0,nextStart:u,buffered:t,bufferedIndex:s}}static getBuffered(t){try{return t.buffered||Hy}catch(e){return Vt.log("failed to get media.buffered",e),Hy}}}const ux=/\{\$([a-zA-Z0-9-_]+)\}/g;function zy(r){return ux.test(r)}function qd(r,t){if(r.variableList!==null||r.hasVariableRefs){const e=r.variableList;return t.replace(ux,i=>{const s=i.substring(2,i.length-1),a=e?.[s];return a===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),i):a})}return t}function Vy(r,t,e){let i=r.variableList;i||(r.variableList=i={});let s,a;if("QUERYPARAM"in t){s=t.QUERYPARAM;try{const l=new self.URL(e).searchParams;if(l.has(s))a=l.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${e}"`)}catch(l){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else s=t.NAME,a=t.VALUE;s in i?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):i[s]=a||""}function Z_(r,t,e){const i=t.IMPORT;if(e&&i in e){let s=r.variableList;s||(r.variableList=s={}),s[i]=e[i]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const J_=/^(\d+)x(\d+)$/,Ky=/(.+?)=(".*?"|.*?)(?:,|$)/g;class se{constructor(t,e){typeof t=="string"&&(t=se.parseAttrList(t,e)),Xt(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(e.length&1?"0":"")+e;const i=new Uint8Array(e.length/2);for(let s=0;s<e.length/2;s++)i[s]=parseInt(e.slice(s*2,s*2+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const i=this[t];return(i?i.split(/[ ,]+/):[]).reduce((s,a)=>(s[a.toLowerCase()]=!0,s),e)}bool(t){return this[t]==="YES"}decimalResolution(t){const e=J_.exec(this[t]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i;const s={};for(Ky.lastIndex=0;(i=Ky.exec(t))!==null;){const l=i[1].trim();let u=i[2];const d=u.indexOf('"')===0&&u.lastIndexOf('"')===u.length-1;let f=!1;if(d)u=u.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":f=!0}if(e&&(d||f))u=qd(e,u);else if(!f&&!d)switch(l){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Vt.warn(`${t}: attribute ${l} is missing quotes`)}s[l]=u}return s}}const tC="com.apple.hls.interstitial";function eC(r){return r!=="ID"&&r!=="CLASS"&&r!=="CUE"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function iC(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"||r==="SCTE35-CMD"}class cx{constructor(t,e,i=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=e?.tagAnchor||null,this.tagOrder=(s=e?.tagOrder)!=null?s:i,e){const a=e.attr;for(const l in a)if(Object.prototype.hasOwnProperty.call(t,l)&&t[l]!==a[l]){Vt.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=l;break}t=Xt(new se({}),a,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=e?.endDate||new Date(this.attr["END-DATE"]);ht(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return t===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return t===null||t.programDateTime===null?(Vt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return e!==null?this._dateAtEnd=new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(ht(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===tC}get isValid(){return!!this.id&&!this._badValueForSameId&&ht(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const nC=10;class sC{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||e===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1}hasKey(t){return this.encryptedFragments.some(e=>{let i=e.decryptdata;return i||(e.setKeyFormat(t.keyFormat),i=e.decryptdata),!!i&&t.matches(i)})}get hasProgramDateTime(){return this.fragments.length?ht(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||nC}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(e!==-1){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function Eu(r,t){return r.length===t.length?!r.some((e,i)=>e!==t[i]):!1}function qy(r,t){return!r&&!t?!0:!r||!t?!1:Eu(r,t)}function Hr(r){return r==="AES-128"||r==="AES-256"||r==="AES-256-CTR"}function kh(r){switch(r){case"AES-128":case"AES-256":return ms.cbc;case"AES-256-CTR":return ms.ctr;default:throw new Error(`invalid full segment method ${r}`)}}function Mh(r){return Uint8Array.from(atob(r),t=>t.charCodeAt(0))}function Yd(r){return Uint8Array.from(unescape(encodeURIComponent(r)),t=>t.charCodeAt(0))}function rC(r){const t=Yd(r).subarray(0,16),e=new Uint8Array(16);return e.set(t,16-t.length),e}function fx(r){const t=function(i,s,a){const l=i[s];i[s]=i[a],i[a]=l};t(r,0,3),t(r,1,2),t(r,4,5),t(r,6,7)}function dx(r){const t=r.split(":");let e=null;if(t[0]==="data"&&t.length===2){const i=t[1].split(";"),s=i[i.length-1].split(",");if(s.length===2){const a=s[0]==="base64",l=s[1];a?(i.splice(-1,1),e=Mh(l)):e=rC(l)}}return e}const xu=typeof self<"u"?self:void 0;var re={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Be={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function tu(r){switch(r){case Be.FAIRPLAY:return re.FAIRPLAY;case Be.PLAYREADY:return re.PLAYREADY;case Be.WIDEVINE:return re.WIDEVINE;case Be.CLEARKEY:return re.CLEARKEY}}function pd(r){switch(r){case re.FAIRPLAY:return Be.FAIRPLAY;case re.PLAYREADY:return Be.PLAYREADY;case re.WIDEVINE:return Be.WIDEVINE;case re.CLEARKEY:return Be.CLEARKEY}}function Xa(r){const{drmSystems:t,widevineLicenseUrl:e}=r,i=t?[re.FAIRPLAY,re.WIDEVINE,re.PLAYREADY,re.CLEARKEY].filter(s=>!!t[s]):[];return!i[re.WIDEVINE]&&e&&i.push(re.WIDEVINE),i}const hx=(function(r){return xu!=null&&(r=xu.navigator)!=null&&r.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function aC(r,t,e,i){let s;switch(r){case re.FAIRPLAY:s=["cenc","sinf"];break;case re.WIDEVINE:case re.PLAYREADY:s=["cenc"];break;case re.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return oC(s,t,e,i)}function oC(r,t,e,i){return[{initDataTypes:r,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:e.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function lC(r){var t;return!!r&&(r.sessionType==="persistent-license"||!!((t=r.sessionTypes)!=null&&t.some(e=>e==="persistent-license")))}function mx(r){const t=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),e=String.fromCharCode.apply(null,Array.from(t)),i=e.substring(e.indexOf("<"),e.length),l=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(l){const u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){const d=Mh(u).subarray(0,16);return fx(d),d}}return null}let Fl={};class Gs{static clearKeyUriToKeyIdMap(){Fl={}}static setKeyIdForUri(t,e){Fl[t]=e}constructor(t,e,i,s=[1],a=null,l){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=s,this.iv=a,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Hr(t),l!=null&&l.startsWith("0x")&&(this.keyId=new Uint8Array(GE(l)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&Eu(t.keyFormatVersions,this.keyFormatVersions)&&qy(t.iv,this.iv)&&qy(t.keyId,this.keyId)}isSupported(){if(this.method){if(Hr(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Be.FAIRPLAY:case Be.WIDEVINE:case Be.PLAYREADY:case Be.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t,e){if(!this.encrypted||!this.uri)return null;if(Hr(this.method)){let a=this.iv;return a||(typeof t!="number"&&(Vt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0),a=cC(t)),new Gs(this.method,this.uri,"identity",this.keyFormatVersions,a)}if(this.keyId){const a=Fl[this.uri];if(a&&!Eu(this.keyId,a)&&Gs.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=dx(this.uri);if(i)switch(this.keyFormat){case Be.WIDEVINE:if(this.pssh=i,!this.keyId){const a=h_(i.buffer);if(a.length){var s;const l=a[0];this.keyId=(s=l.kids)!=null&&s.length?l.kids[0]:null}}this.keyId||(this.keyId=Yy(e));break;case Be.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=d_(a,null,i),this.keyId=mx(i);break}default:{let a=i.subarray(0,16);if(a.length!==16){const l=new Uint8Array(16);l.set(a,16-a.length),a=l}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a;a=uC(e),a||(a=Yy(e),a||(a=Fl[this.uri])),a&&(this.keyId=a,Gs.setKeyIdForUri(this.uri,a))}return this}}function uC(r){const t=r?.[Be.WIDEVINE];return t?t.keyId:null}function Yy(r){const t=r?.[Be.PLAYREADY];if(t){const e=dx(t.uri);if(e)return mx(e)}return null}function cC(r){const t=new Uint8Array(16);for(let e=12;e<16;e++)t[e]=r>>8*(15-e)&255;return t}const Xy=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Wy=/#EXT-X-MEDIA:(.*)/g,fC=/^#EXT(?:INF|-X-TARGETDURATION):/m,gd=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),dC=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Qi{static findGroup(t,e){for(let i=0;i<t.length;i++){const s=t[i];if(s.id===e)return s}}static resolve(t,e){return Rh.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return fC.test(t)}static parseMasterPlaylist(t,e){const i=zy(t),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},a=[];if(Xy.lastIndex=0,!t.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let l;for(;(l=Xy.exec(t))!=null;)if(l[1]){var u;const f=new se(l[1],s),h=qd(s,l[2]),p={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:Qi.resolve(h,e)},g=f.decimalResolution("RESOLUTION");g&&(p.width=g.width,p.height=g.height),Jy(f.CODECS,p);const y=f["SUPPLEMENTAL-CODECS"];y&&(p.supplemental={},Jy(y,p.supplemental)),(u=p.unknownCodecs)!=null&&u.length||a.push(p),s.levels.push(p)}else if(l[3]){const f=l[3],h=l[4];switch(f){case"SESSION-DATA":{const p=new se(h,s),g=p["DATA-ID"];g&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[g]=p);break}case"SESSION-KEY":{const p=Qy(h,e,s);p.encrypted&&p.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(p)):Vt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const p=new se(h,s);Vy(s,p,e)}break}case"CONTENT-STEERING":{const p=new se(h,s);s.contentSteering={uri:Qi.resolve(p["SERVER-URI"],e),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=Zy(h);break}}}const d=a.length>0&&a.length<s.levels.length;return s.levels=d?a:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(t,e,i){let s;const a={},l=i.levels,u={AUDIO:l.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:l.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(Wy.lastIndex=0;(s=Wy.exec(t))!==null;){const f=new se(s[1],i),h=f.TYPE;if(h){const p=u[h],g=a[h]||[];a[h]=g;const y=f.LANGUAGE,v=f["ASSOC-LANGUAGE"],S=f.CHANNELS,T=f.CHARACTERISTICS,A=f["INSTREAM-ID"],b={attrs:f,bitrate:0,id:d++,groupId:f["GROUP-ID"]||"",name:f.NAME||y||"",type:h,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:y,url:f.URI?Qi.resolve(f.URI,e):""};if(v&&(b.assocLang=v),S&&(b.channels=S),T&&(b.characteristics=T),A&&(b.instreamId=A),p!=null&&p.length){const R=Qi.findGroup(p,b.groupId)||p[0];tv(b,R,"audioCodec"),tv(b,R,"textCodec")}g.push(b)}}return a}static parseLevelPlaylist(t,e,i,s,a,l){var u;const d={url:e},f=new sC(e),h=f.fragments,p=[];let g=null,y=0,v=0,S=0,T=0,A=0,b=null,R=new dd(s,d),C,D,N,w=-1,P=!1,B=null,M;if(gd.lastIndex=0,f.m3u8=t,f.hasVariableRefs=zy(t),((u=gd.exec(t))==null?void 0:u[0])!=="#EXTM3U")return f.playlistParsingError=new Error("Missing format identifier #EXTM3U"),f;for(;(C=gd.exec(t))!==null;){P&&(P=!1,R=new dd(s,d),R.playlistOffset=S,R.setStart(S),R.sn=y,R.cc=T,A&&(R.bitrate=A),R.level=i,g&&(R.initSegment=g,g.rawProgramDateTime&&(R.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),B&&(R.setByteRange(B),B=null)));const G=C[1];if(G){R.duration=parseFloat(G);const Y=(" "+C[2]).slice(1);R.title=Y||null,R.tagList.push(Y?["INF",G,Y]:["INF",G])}else if(C[3]){if(ht(R.duration)){R.playlistOffset=S,R.setStart(S),N&&iv(R,N,f),R.sn=y,R.level=i,R.cc=T,h.push(R);const Y=(" "+C[3]).slice(1);R.relurl=qd(f,Y),Xd(R,b,p),b=R,S+=R.duration,y++,v=0,P=!0}}else{if(C=C[0].match(dC),!C){Vt.warn("No matches on slow regex match for level playlist!");continue}for(D=1;D<C.length&&C[D]===void 0;D++);const Y=(" "+C[D]).slice(1),O=(" "+C[D+1]).slice(1),j=C[D+2]?(" "+C[D+2]).slice(1):null;switch(Y){case"BYTERANGE":b?R.setByteRange(O,b):R.setByteRange(O);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=O,R.tagList.push(["PROGRAM-DATE-TIME",O]),w===-1&&(w=h.length);break;case"PLAYLIST-TYPE":f.type&&_n(f,Y,C),f.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":f.startSN!==0?_n(f,Y,C):h.length>0&&nv(f,Y,C),y=f.startSN=parseInt(O);break;case"SKIP":{f.skippedSegments&&_n(f,Y,C);const V=new se(O,f),nt=V.decimalInteger("SKIPPED-SEGMENTS");if(ht(nt)){f.skippedSegments+=nt;for(let k=nt;k--;)h.push(null);y+=nt}const ut=V.enumeratedString("RECENTLY-REMOVED-DATERANGES");ut&&(f.recentlyRemovedDateranges=(f.recentlyRemovedDateranges||[]).concat(ut.split("	")));break}case"TARGETDURATION":f.targetduration!==0&&_n(f,Y,C),f.targetduration=Math.max(parseInt(O),1);break;case"VERSION":f.version!==null&&_n(f,Y,C),f.version=parseInt(O);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":f.live||_n(f,Y,C),f.live=!1;break;case"#":(O||j)&&R.tagList.push(j?[O,j]:[O]);break;case"DISCONTINUITY":T++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([Y]);break;case"BITRATE":R.tagList.push([Y,O]),A=parseInt(O)*1e3,ht(A)?R.bitrate=A:A=0;break;case"DATERANGE":{const V=new se(O,f),nt=new cx(V,f.dateRanges[V.ID],f.dateRangeTagCount);f.dateRangeTagCount++,nt.isValid||f.skippedSegments?f.dateRanges[nt.id]=nt:Vt.warn(`Ignoring invalid DATERANGE tag: "${O}"`),R.tagList.push(["EXT-X-DATERANGE",O]);break}case"DEFINE":{{const V=new se(O,f);"IMPORT"in V?Z_(f,V,l):Vy(f,V,e)}break}case"DISCONTINUITY-SEQUENCE":f.startCC!==0?_n(f,Y,C):h.length>0&&nv(f,Y,C),f.startCC=T=parseInt(O);break;case"KEY":{const V=Qy(O,e,f);if(V.isSupported()){if(V.method==="NONE"){N=void 0;break}N||(N={});const nt=N[V.keyFormat];nt!=null&&nt.matches(V)||(nt&&(N=Xt({},N)),N[V.keyFormat]=V)}else Vt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${O}"`);break}case"START":f.startTimeOffset=Zy(O);break;case"MAP":{const V=new se(O,f);if(R.duration){const nt=new dd(s,d);ev(nt,V,i,N),g=nt,R.initSegment=g,g.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=g.rawProgramDateTime)}else{const nt=R.byteRangeEndOffset;if(nt){const ut=R.byteRangeStartOffset;B=`${nt-ut}@${ut}`}else B=null;ev(R,V,i,N),g=R,P=!0}g.cc=T;break}case"SERVER-CONTROL":{M&&_n(f,Y,C),M=new se(O),f.canBlockReload=M.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=M.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&M.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=M.optionalFloat("PART-HOLD-BACK",0),f.holdBack=M.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{f.partTarget&&_n(f,Y,C);const V=new se(O);f.partTarget=V.decimalFloatingPoint("PART-TARGET");break}case"PART":{let V=f.partList;V||(V=f.partList=[]);const nt=v>0?V[V.length-1]:void 0,ut=v++,k=new se(O,f),$=new ZL(k,R,d,ut,nt);V.push($),R.duration+=$.duration;break}case"PRELOAD-HINT":{const V=new se(O,f);f.preloadHint=V;break}case"RENDITION-REPORT":{const V=new se(O,f);f.renditionReports=f.renditionReports||[],f.renditionReports.push(V);break}default:Vt.warn(`line parsed but not handled: ${C}`);break}}}b&&!b.relurl?(h.pop(),S-=b.duration,f.partList&&(f.fragmentHint=b)):f.partList&&(Xd(R,b,p),R.cc=T,f.fragmentHint=R,N&&iv(R,N,f)),f.targetduration||(f.playlistParsingError=new Error("Missing Target Duration"));const K=h.length,tt=h[0],z=h[K-1];if(S+=f.skippedSegments*f.targetduration,S>0&&K&&z){f.averagetargetduration=S/K;const G=z.sn;f.endSN=G!=="initSegment"?G:0,f.live||(z.endList=!0),w>0&&(mC(h,w),tt&&p.unshift(tt))}return f.fragmentHint&&(S+=f.fragmentHint.duration),f.totalduration=S,p.length&&f.dateRangeTagCount&&tt&&px(p,f),f.endCC=T,f}}function px(r,t){let e=r.length;if(!e)if(t.hasProgramDateTime){const u=t.fragments[t.fragments.length-1];r.push(u),e++}else return;const i=r[e-1],s=t.live?1/0:t.totalduration,a=Object.keys(t.dateRanges);for(let u=a.length;u--;){const d=t.dateRanges[a[u]],f=d.startDate.getTime();d.tagAnchor=i.ref;for(let h=e;h--;){var l;if(((l=r[h])==null?void 0:l.sn)<t.startSN)break;const p=hC(t,f,r,h,s);if(p!==-1){d.tagAnchor=t.fragments[p].ref;break}}}}function hC(r,t,e,i,s){const a=e[i];if(a){const u=a.programDateTime;if(t>=u||i===0){var l;const d=(((l=e[i+1])==null?void 0:l.start)||s)-a.start;if(t<=u+d*1e3){const f=e[i].sn-r.startSN;if(f<0)return-1;const h=r.fragments;if(h.length>e.length){const g=(e[i+1]||h[h.length-1]).sn-r.startSN;for(let y=g;y>f;y--){const v=h[y].programDateTime;if(t>=v&&t<v+h[y].duration*1e3)return y}}return f}}}return-1}function Qy(r,t,e){var i,s;const a=new se(r,e),l=(i=a.METHOD)!=null?i:"",u=a.URI,d=a.hexadecimalInteger("IV"),f=a.KEYFORMATVERSIONS,h=(s=a.KEYFORMAT)!=null?s:"identity";u&&a.IV&&!d&&Vt.error(`Invalid IV: ${a.IV}`);const p=u?Qi.resolve(u,t):"",g=(f||"1").split("/").map(Number).filter(Number.isFinite);return new Gs(l,p,h,g,d,a.KEYID)}function Zy(r){const e=new se(r).decimalFloatingPoint("TIME-OFFSET");return ht(e)?e:null}function Jy(r,t){let e=(r||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const s=e.filter(a=>Ch(a,i));s.length&&(t[`${i}Codec`]=s.map(a=>a.split("/")[0]).join(","),e=e.filter(a=>s.indexOf(a)===-1))}),t.unknownCodecs=e}function tv(r,t,e){const i=t[e];i&&(r[e]=i)}function mC(r,t){let e=r[t];for(let i=t;i--;){const s=r[i];if(!s)return;s.programDateTime=e.programDateTime-s.duration*1e3,e=s}}function Xd(r,t,e){r.rawProgramDateTime?e.push(r):t!=null&&t.programDateTime&&(r.programDateTime=t.endProgramDateTime)}function ev(r,t,e,i){r.relurl=t.URI,t.BYTERANGE&&r.setByteRange(t.BYTERANGE),r.level=e,r.sn="initSegment",i&&(r.levelkeys=i),r.initSegment=null}function iv(r,t,e){r.levelkeys=t;const{encryptedFragments:i}=e;(!i.length||i[i.length-1].levelkeys!==t)&&Object.keys(t).some(s=>t[s].isCommonEncryption)&&i.push(r)}function _n(r,t,e){r.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${e[0]})`)}function nv(r,t,e){r.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${e[0]})`)}function yd(r,t){const e=t.startPTS;if(ht(e)){let i=0,s;t.sn>r.sn?(i=e-r.start,s=r):(i=r.start-e,s=t),s.duration!==i&&s.setDuration(i)}else t.sn>r.sn?r.cc===t.cc&&r.minEndPTS?t.setStart(r.start+(r.minEndPTS-r.start)):t.setStart(r.start+r.duration):t.setStart(Math.max(r.start-t.duration,0))}function gx(r,t,e,i,s,a,l){i-e<=0&&(l.warn("Fragment should have a positive duration",t),i=e+t.duration,a=s+t.duration);let d=e,f=i;const h=t.startPTS,p=t.endPTS;if(ht(h)){const A=Math.abs(h-e);r&&A>r.totalduration?l.warn(`media timestamps and playlist times differ by ${A}s for level ${t.level} ${r.url}`):ht(t.deltaPTS)?t.deltaPTS=Math.max(A,t.deltaPTS):t.deltaPTS=A,d=Math.max(e,h),e=Math.min(e,h),s=t.startDTS!==void 0?Math.min(s,t.startDTS):s,f=Math.min(i,p),i=Math.max(i,p),a=t.endDTS!==void 0?Math.max(a,t.endDTS):a}const g=e-t.start;t.start!==0&&t.setStart(e),t.setDuration(i-t.start),t.startPTS=e,t.maxStartPTS=d,t.startDTS=s,t.endPTS=i,t.minEndPTS=f,t.endDTS=a;const y=t.sn;if(!r||y<r.startSN||y>r.endSN)return 0;let v;const S=y-r.startSN,T=r.fragments;for(T[S]=t,v=S;v>0;v--)yd(T[v],T[v-1]);for(v=S;v<T.length-1;v++)yd(T[v],T[v+1]);return r.fragmentHint&&yd(T[T.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,g}function pC(r,t,e){if(r===t)return;let i=null;const s=r.fragments;for(let h=s.length-1;h>=0;h--){const p=s[h].initSegment;if(p){i=p;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let a;vC(r,t,(h,p,g,y)=>{if((!t.startCC||t.skippedSegments)&&p.cc!==h.cc){const v=h.cc-p.cc;for(let S=g;S<y.length;S++)y[S].cc+=v;t.endCC=y[y.length-1].cc}ht(h.startPTS)&&ht(h.endPTS)&&(p.setStart(p.startPTS=h.startPTS),p.startDTS=h.startDTS,p.maxStartPTS=h.maxStartPTS,p.endPTS=h.endPTS,p.endDTS=h.endDTS,p.minEndPTS=h.minEndPTS,p.setDuration(h.endPTS-h.startPTS),p.duration&&(a=p),t.PTSKnown=t.alignedSliding=!0),h.hasStreams&&(p.elementaryStreams=h.elementaryStreams),p.loader=h.loader,h.hasStats&&(p.stats=h.stats),h.initSegment&&(p.initSegment=h.initSegment,i=h.initSegment)});const l=t.fragments,u=t.fragmentHint?l.concat(t.fragmentHint):l;if(i&&u.forEach(h=>{var p;h&&(!h.initSegment||h.initSegment.relurl===((p=i)==null?void 0:p.relurl))&&(h.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=l.some(h=>!h),t.deltaUpdateFailed){e.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=t.skippedSegments;h--;)l.shift();t.startSN=l[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=gC(r.dateRanges,t,e));const h=r.fragments.filter(p=>p.rawProgramDateTime);if(r.hasProgramDateTime&&!t.hasProgramDateTime)for(let p=1;p<u.length;p++)u[p].programDateTime===null&&Xd(u[p],u[p-1],h);px(h,t)}t.endCC=l[l.length-1].cc}if(!t.startCC){var d;const h=Ex(r,t.startSN-1);t.startCC=(d=h?.cc)!=null?d:l[0].cc}yC(r.partList,t.partList,(h,p)=>{p.elementaryStreams=h.elementaryStreams,p.stats=h.stats}),a?gx(t,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS,e):yx(r,t),l.length&&(t.totalduration=t.edge-l[0].start),t.driftStartTime=r.driftStartTime,t.driftStart=r.driftStart;const f=t.advancedDateTime;if(t.advanced&&f){const h=t.edge;t.driftStart||(t.driftStartTime=f,t.driftStart=h),t.driftEndTime=f,t.driftEnd=h}else t.driftEndTime=r.driftEndTime,t.driftEnd=r.driftEnd,t.advancedDateTime=r.advancedDateTime;t.requestScheduled===-1&&(t.requestScheduled=r.requestScheduled)}function gC(r,t,e){const{dateRanges:i,recentlyRemovedDateranges:s}=t,a=Xt({},r);s&&s.forEach(d=>{delete a[d]});const u=Object.keys(a).length;return u?(Object.keys(i).forEach(d=>{const f=a[d],h=new cx(i[d].attr,f);h.isValid?(a[d]=h,f||(h.tagOrder+=u)):e.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Zt(i[d].attr)}"`)}),a):i}function yC(r,t,e){if(r&&t){let i=0;for(let s=0,a=r.length;s<=a;s++){const l=r[s],u=t[s+i];l&&u&&l.index===u.index&&l.fragment.sn===u.fragment.sn?e(l,u):i--}}}function vC(r,t,e){const i=t.skippedSegments,s=Math.max(r.startSN,t.startSN)-t.startSN,a=(r.fragmentHint?1:0)+(i?t.endSN:Math.min(r.endSN,t.endSN))-t.startSN,l=t.startSN-r.startSN,u=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,d=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let f=s;f<=a;f++){const h=d[l+f];let p=u[f];if(i&&!p&&h&&(p=t.fragments[f]=h),h&&p){e(h,p,f,u);const g=h.relurl,y=p.relurl;if(g&&EC(g,y)){t.playlistParsingError=sv(`media sequence mismatch ${p.sn}:`,r,t,h,p);return}else if(h.cc!==p.cc){t.playlistParsingError=sv(`discontinuity sequence mismatch (${h.cc}!=${p.cc})`,r,t,h,p);return}}}}function sv(r,t,e,i,s){return new Error(`${r} ${s.url}
Playlist starting @${t.startSN}
${t.m3u8}

Playlist starting @${e.startSN}
${e.m3u8}`)}function yx(r,t,e=!0){const i=t.startSN+t.skippedSegments-r.startSN,s=r.fragments,a=i>=0;let l=0;if(a&&i<s.length)l=s[i].start;else if(a&&t.startSN===r.endSN+1)l=r.fragmentEnd;else if(a&&e)l=r.fragmentStart+i*t.levelTargetDuration;else if(!t.skippedSegments&&t.fragmentStart===0)l=r.fragmentStart;else return;Wd(t,l)}function Wd(r,t){if(t){const e=r.fragments;for(let i=r.skippedSegments;i<e.length;i++)e[i].addStart(t);r.fragmentHint&&r.fragmentHint.addStart(t)}}function vx(r,t=1/0){let e=1e3*r.targetduration;if(r.updated){const i=r.fragments;if(i.length&&e*4>t){const a=i[i.length-1].duration*1e3;a<e&&(e=a)}}else e/=2;return Math.round(e)}function Ex(r,t,e){if(!r)return null;let i=r.fragments[t-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===t)?i:t<r.startSN&&e&&e.sn===t?e:null}function rv(r,t,e){return r?xx(r.partList,t,e):null}function xx(r,t,e){if(r)for(let i=r.length;i--;){const s=r[i];if(s.index===e&&s.fragment.sn===t)return s}return null}function Sx(r){r.forEach((t,e)=>{var i;(i=t.details)==null||i.fragments.forEach(s=>{s.level=e,s.initSegment&&(s.initSegment.level=e)})})}function EC(r,t){return r!==t&&t?av(r)!==av(t):!1}function av(r){return r.replace(/\?[^?]*$/,"")}function Wa(r,t){for(let i=0,s=r.length;i<s;i++){var e;if(((e=r[i])==null?void 0:e.cc)===t)return r[i]}return null}function xC(r,t){return!!(r&&t.startCC<r.endCC&&t.endCC>r.startCC)}function ov(r,t){const e=r.start+t;r.startPTS=e,r.setStart(e),r.endPTS=e+r.duration}function Tx(r,t){const e=t.fragments;for(let i=0,s=e.length;i<s;i++)ov(e[i],r);t.fragmentHint&&ov(t.fragmentHint,r),t.alignedSliding=!0}function SC(r,t){r&&(bx(t,r),t.alignedSliding||Su(t,r),!t.alignedSliding&&!t.skippedSegments&&yx(r,t,!1))}function bx(r,t){if(!xC(t,r))return;const e=Math.min(t.endCC,r.endCC),i=Wa(t.fragments,e),s=Wa(r.fragments,e);if(!i||!s)return;Vt.log(`Aligning playlist at start of dicontinuity sequence ${e}`);const a=i.start-s.start;Tx(a,r)}function Su(r,t){if(!r.hasProgramDateTime||!t.hasProgramDateTime)return;const e=r.fragments,i=t.fragments;if(!e.length||!i.length)return;let s,a;const l=Math.min(t.endCC,r.endCC);t.startCC<l&&r.startCC<l&&(s=Wa(i,l),a=Wa(e,l)),(!s||!a)&&(s=i[Math.floor(i.length/2)],a=Wa(e,s.cc)||e[Math.floor(e.length/2)]);const u=s.programDateTime,d=a.programDateTime;if(!u||!d)return;const f=(d-u)/1e3-(a.start-s.start);Tx(f,r)}function Ke(r,t,e){ii(r,t,e),r.addEventListener(t,e)}function ii(r,t,e){r.removeEventListener(t,e)}const TC={toString:function(r){let t="";const e=r.length;for(let i=0;i<e;i++)t+=`[${r.start(i).toFixed(3)}-${r.end(i).toFixed(3)}]`;return t}},at={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ph extends lx{constructor(t,e,i,s,a){super(s,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=at.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:u,media:d,mediaBuffer:f,state:h}=this,p=d?d.currentTime:0,g=At.bufferInfo(f||d,p,l.maxBufferHole),y=!g.len;if(this.log(`Media seeking to ${ht(p)?p.toFixed(3):p}, state: ${h}, ${y?"out of":"in"} buffer`),this.state===at.ENDED)this.resetLoadingState();else if(u){const v=l.maxFragLookUpTolerance,S=u.start-v,T=u.start+u.duration+v;if(y||T<g.start||S>g.end){const A=p>T;(p<S||A)&&(A&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const v=this.lastCurrentTime;if(p>v&&(this.lastCurrentTime=p),!this.loadingParts){const S=Math.max(g.end,p),T=this.shouldLoadParts(this.getLevelDetails(),S);T&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=T)}}this.hls.hasEnoughToStart||(this.log(`Setting ${y?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,y&&(this.startPosition=p)),y&&this.state===at.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=t,this.fragmentLoader=new W_(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Ih(t.config)}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===at.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=at.STOPPED}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return e===-1&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const i=t.end||0,s=this.config.timelineOffset||0;if(i<=s)return!1;const a=t.buffered;this.config.maxBufferHole&&a&&a.length>1&&(t=At.bufferedInfo(a,t.start,0));const l=t.nextStart;if(l&&l>s&&l<e.edge||this.media.currentTime<t.start)return!1;const d=e.partList;if(d!=null&&d.length){const h=d[d.length-1];return At.isBuffered(this.media,h.start+h.duration/2)}const f=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(f)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;if(t){var e;return((e=this.getLevelDetails())==null?void 0:e.appliedTimelineOffset)||t}return 0}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;Ke(i,"seeking",this.onMediaSeeking),Ke(i,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===at.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(t,e){const i=!!e.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ii(s,"seeking",this.onMediaSeeking),ii(s,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=at.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){const s=a=>{const l=a.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(l,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(t,e,i,s).then(a=>{if(!a)return;const l=this.state,u=a.frag;if(this.fragContextChanged(u)){(l===at.FRAG_LOADING||!this.fragCurrent&&l===at.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=at.IDLE);return}"payload"in a&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(_.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(`Frag error: ${a?.message||a}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if(i.getState(t)===Ae.APPENDING){const a=t.type,l=this.getFwdBufferInfo(this.mediaBuffer,a),u=Math.max(t.duration,l?l.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?t.sn-d.sn:0)===1||this.reduceMaxBufferLength(u,t.duration))&&i.removeFragment(t)}else((e=this.mediaBuffer)==null?void 0:e.buffered.length)===0?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===Ae.PARTIAL&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return e?.live&&e.type!=="EVENT"&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,i=null){if(!(t-e))return;const s={startOffset:t,endOffset:e,type:i};this.hls.trigger(_.BUFFER_FLUSHING,s)}_loadInitSegment(t,e){this._doFragLoad(t,e).then(i=>{const s=i?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:s}=this,{frag:a,payload:l}=i,u=a.decryptdata;if(l&&l.byteLength>0&&u!=null&&u.key&&u.iv&&Hr(u.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),u.key.buffer,u.iv.buffer,kh(u.method)).catch(f=>{throw s.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:a}),f}).then(f=>{const h=self.performance.now();return s.trigger(_.FRAG_DECRYPTED,{frag:a,payload:f,stats:{tstart:d,tdecrypt:h}}),i.payload=f,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;this.state!==at.STOPPED&&(this.state=at.IDLE),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var i,s;const a=t.tracks;if(a&&!e.encrypted&&((i=a.audio)!=null&&i.encrypted||(s=a.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const l=this.media,u=new Error(`Encrypted track with no key in ${this.fragInfo(e)} (media ${l?"attached mediaKeys: "+l.mediaKeys:"detached"})`);return this.warn(u.message),!l||l.mediaKeys?!1:(this.hls.trigger(_.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,fatal:!1,error:u,frag:e}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?TC.toString(At.getBuffered(i)):"(detached)"})`),xe(t)){var s;if(t.type!==mt.SUBTITLE){const l=t.elementaryStreams;if(!Object.keys(l).some(u=>!!l[u])){this.state=at.IDLE;return}}const a=(s=this.levels)==null?void 0:s[t.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=at.IDLE}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:s,partsLoaded:a}=t,l=!a||a.length===0||a.some(d=>!d),u=new Oh(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!l);e.flush(u)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,s){var a;this.fragCurrent=t;const l=e.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let u=null;if(t.encrypted&&!((a=t.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${t.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=at.KEY_LOADING,this.fragCurrent=t,u=this.keyLoader.load(t).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(_.KEY_LOADED,g),this.state===at.KEY_LOADING&&(this.state=at.IDLE),g}),this.hls.trigger(_.KEY_LOADING,{frag:t}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else t.encrypted||(u=this.keyLoader.loadClear(t,l.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(xe(t)&&(!d||t.sn!==d.sn)){const g=this.shouldLoadParts(e.details,t.end);g!==this.loadingParts&&(this.log(`LL-Part loading ${g?"ON":"OFF"} loading sn ${d?.sn}->${t.sn}`),this.loadingParts=g)}if(i=Math.max(t.start,i||0),this.loadingParts&&xe(t)){const g=l.partList;if(g&&s){i>l.fragmentEnd&&l.fragmentHint&&(t=l.fragmentHint);const y=this.getNextPart(g,t,i);if(y>-1){const v=g[y];t=this.fragCurrent=v.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${v.index} (${y}/${g.length-1}) of ${this.fragInfo(t,!1,v)}) cc: ${t.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=at.FRAG_LOADING;let S;return u?S=u.then(T=>!T||this.fragContextChanged(T.frag)?null:this.doFragPartsLoad(t,v,e,s)).catch(T=>this.handleFragLoadError(T)):S=this.doFragPartsLoad(t,v,e,s).catch(T=>this.handleFragLoadError(T)),this.hls.trigger(_.FRAG_LOADING,{frag:t,part:v,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!t.url||this.loadedEndOfParts(g,i))return Promise.resolve(null)}}if(xe(t)&&this.loadingParts){var f;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${t.sn} loaded parts: ${(f=l.partList)==null?void 0:f.filter(g=>g.loaded).map(g=>`[${g.start}-${g.end}]`)}`),this.loadingParts=!1}else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${"["+l.startSN+"-"+l.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),ht(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=at.FRAG_LOADING;const h=this.config.progressive;let p;return h&&u?p=u.then(g=>!g||this.fragContextChanged(g.frag)?null:this.fragmentLoader.load(t,s)).catch(g=>this.handleFragLoadError(g)):p=Promise.all([this.fragmentLoader.load(t,h?s:void 0),u]).then(([g])=>(!h&&s&&s(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(_.FRAG_LOADING,{frag:t,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(t,e,i,s){return new Promise((a,l)=>{var u;const d=[],f=(u=i.details)==null?void 0:u.partList,h=p=>{this.fragmentLoader.loadPart(t,p,s).then(g=>{d[p.index]=g;const y=g.part;this.hls.trigger(_.FRAG_LOADED,g);const v=rv(i.details,t.sn,p.index+1)||xx(f,t.sn,p.index+1);if(v)h(v);else return a({frag:t,part:y,partsLoaded:d})}).catch(l)};h(e)})}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===vt.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(e.frag)):this.hls.trigger(_.ERROR,e)}else this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==at.PARSING){!this.fragCurrent&&this.state!==at.STOPPED&&this.state!==at.ERROR&&(this.state=at.IDLE);return}const{frag:i,part:s,level:a}=e,l=self.performance.now();i.stats.parsing.end=l,s&&(s.stats.parsing.end=l);const u=this.getLevelDetails(),f=u&&i.sn>u.endSN||this.shouldLoadParts(u,i.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=f),this.updateLevelTiming(i,s,a,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var i;const a=t.partList[0];if(a.fragment.type===mt.SUBTITLE)return!1;const l=a.end+(((i=t.fragmentHint)==null?void 0:i.duration)||0);if(e>=l){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:s,sn:a,part:l}=t;if(!(e!=null&&e[s]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const u=e[s],d=u.details,f=l>-1?rv(d,a,l):null,h=f?f.fragment:Ex(d,a,i);return h?(i&&i!==h&&(h.stats=i.stats),{frag:h,part:f,level:u}):null}bufferFragmentData(t,e,i,s,a){if(this.state!==at.PARSING)return;const{data1:l,data2:u}=t;let d=l;if(u&&(d=Ci(l,u)),!d.length)return;const f=this.initPTS[e.cc],h=f?-f.baseTime/f.timescale:void 0,p={type:t.type,frag:e,part:i,chunkMeta:s,offset:h,parent:e.type,data:d};if(this.hls.trigger(_.BUFFER_APPENDING,p),t.dropped&&t.independent&&!i){if(a)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!At.isBuffered(e,e.currentTime)){this.flushMainBuffer(0,t.start);return}const i=e.currentTime,s=At.bufferInfo(e,i,0),a=t.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),u=Math.max(Math.min(t.start-l,s.end-l),i+l);t.start-u>l&&this.flushMainBuffer(u,t.start)}getFwdBufferInfo(t,e){var i;const s=this.getLoadPosition();if(!ht(s))return null;const l=this.lastCurrentTime>s||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,s,e,l)}getFwdBufferInfoAtPos(t,e,i,s){const a=At.bufferInfo(t,e,s);if(a.len===0&&a.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(e,i);if(l&&(a.nextStart<=l.end||l.gap)){const u=Math.max(Math.min(a.nextStart,l.end)-e,s);return At.bufferInfo(t,e,u)}}return a}getMaxBufferLength(t){const{config:e}=this;let i;return t?i=Math.max(8*e.maxBufferSize/t,e.maxBufferLength):i=e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const i=this.config,s=Math.max(Math.min(t-e,i.maxBufferLength),e),a=Math.max(t-e*3,i.maxMaxBufferLength/2,s);return a>=s?(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(t,e=mt.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(t,e){const i=e.fragments,s=i.length;if(!s)return null;const{config:a}=this,l=i[0].start,u=a.lowLatencyMode&&!!e.partList;let d=null;if(e.live){const p=a.initialLiveManifestSize;if(s<p)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${p})`),null;if(!e.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<l){var f;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(e);const g=this.hls.startPosition,y=this.hls.liveSyncPosition,v=d?(g!==-1&&g>=l?g:y)||d.start:t;this.log(`Setting startPosition to ${v} to match start frag at live edge. mainStart: ${g} liveSyncPosition: ${y} frag.start: ${(f=d)==null?void 0:f.start}`),this.startPosition=this.nextLoadPosition=v}}else t<=l&&(d=i[0]);if(!d){const p=this.loadingParts?e.partEnd:e.fragmentEnd;d=this.getFragmentAtPosition(t,p,e)}let h=this.filterReplacedPrimary(d,e);if(!h&&d){const p=d.sn-e.startSN;h=this.filterReplacedPrimary(i[p+1]||null,e)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return(i===Ae.OK||i===Ae.PARTIAL&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,s,a){let l=null;if(t.gap&&(l=this.getNextFragment(this.nextLoadPosition,e),l&&!l.gap&&i.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s,0);if(u!==null&&i.len+u.len>=a){const d=l.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(lv(this.config)){var t;if((t=this.hls.interstitialsManager)==null||(t=t.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(lv(this.config)&&t.type!==mt.SUBTITLE){const i=this.hls.interstitialsManager,s=i?.bufferingItem;if(s){const l=s.event;if(l){if(l.appendInPlace||Math.abs(t.start-s.start)>1||s.start===0)return null}else if(t.end<=s.start&&e?.live===!1||t.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||t.start-s.end>1))return null}const a=i?.playerQueue;if(a)for(let l=a.length;l--;){const u=a[l].interstitial;if(u.appendInPlace&&t.start>=u.startTime&&t.end<=u.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!t.initSegment.data&&!this.bitrateTest?t.initSegment:t}getNextPart(t,e,i){let s=-1,a=!1,l=!0;for(let u=0,d=t.length;u<d;u++){const f=t[u];if(l=l&&!f.independent,s>-1&&i<f.start)break;const h=f.loaded;h?s=-1:(a||(f.independent||l)&&f.fragment===e)&&(f.fragment!==e&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${f.start}`),s=u),a=h}return s}loadedEndOfParts(t,e){let i;for(let s=t.length;s--;){if(i=t[s],!i.loaded)return!1;if(e>i.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,i=this.fragPrevious;let s=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=B_(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const a=i.sn+1;if(a>=t.startSN&&a<=t.endSN){const l=e[a-t.startSN];i.cc===l.cc&&(s=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=rx(t,i.cc,i.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(s=this.getFragmentAtPosition(a,this.bitrateTest?t.fragmentEnd:t.edge,t))}return s}getFragmentAtPosition(t,e,i){const{config:s}=this;let{fragPrevious:a}=this,{fragments:l,endSN:u}=i;const{fragmentHint:d}=i,{maxFragLookUpTolerance:f}=s,h=i.partList,p=!!(this.loadingParts&&h!=null&&h.length&&d);p&&!this.bitrateTest&&h[h.length-1].fragment.sn===d.sn&&(l=l.concat(d),u=d.sn);let g;if(t<e){var y;const S=t<this.lastCurrentTime||t>e-f||(y=this.media)!=null&&y.paused||!this.startFragRequested?0:f;g=Vs(a,l,t,S)}else g=l[l.length-1];if(g){const v=g.sn-i.startSN,S=this.fragmentTracker.getState(g);if((S===Ae.OK||S===Ae.PARTIAL&&g.gap)&&(a=g),a&&g.sn===a.sn&&(!p||h[0].fragment.sn>g.sn||!i.live)&&g.level===a.level){const A=l[v+1];g.sn<u&&this.fragmentTracker.getState(A)!==Ae.OK?g=A:g=null}}return g}alignPlaylists(t,e,i){const s=t.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const a=t.fragmentStart,l=!e,u=t.alignedSliding&&ht(a);if(l||!u&&!a){SC(i,t);const d=t.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${s}`),d}return a}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*3)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);const s=this.timelineOffset;if(i===-1){const a=this.startTimeOffset!==null,l=a?this.startTimeOffset:t.startTimeOffset;l!==null&&ht(l)?(i=e+l,l<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${l} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+s}this.nextLoadPosition=i+s}getLoadPosition(){var t;const{media:e}=this;let i=0;return(t=this.hls)!=null&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&xe(t)&&t.stats.aborted&&(this.log(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==at.FRAG_LOADING_WAITING_RETRY)&&(this.state=at.IDLE)}onFragmentOrKeyLoadError(t,e){var i;if(e.chunkMeta&&!e.frag){const A=this.getCurrentContext(e.chunkMeta);A&&(e.frag=A.frag)}const s=e.frag;if(!s||s.type!==t||!this.levels)return;if(this.fragContextChanged(s)){var a;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const l=e.details===Q.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(s,!0);const u=e.errorAction;if(!u){this.state=at.ERROR;return}const{action:d,flags:f,retryCount:h=0,retryConfig:p}=u,g=!!p,y=g&&d===Fe.RetryRequest,v=g&&!u.resolved&&f===fi.MoveAllAlternatesMatchingHost,S=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!y&&v&&xe(s)&&!s.endList&&S&&!ox(e))this.resetFragmentErrors(t),this.treatAsGap(s),u.resolved=!0;else if((y||v)&&h<p.maxNumRetry){var T;const A=Kd((T=e.response)==null?void 0:T.code),b=Dh(p,h);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+b,this.state=at.FRAG_LOADING_WAITING_RETRY,u.resolved=!0,A){this.log("Waiting for connection (offline)"),this.retryDate=1/0,e.reason="offline";return}this.warn(`Fragment ${s.sn} of ${t} ${s.level} errored with ${e.details}, retrying loading ${h+1}/${p.maxNumRetry} in ${b}ms`)}else if(p)if(this.resetFragmentErrors(t),h<p.maxNumRetry)!l&&d!==Fe.RemoveAlternatePermanently&&(u.resolved=!0);else{this.warn(`${e.details} reached or exceeded max retry (${h})`);return}else d===Fe.SendAlternateToPenaltyBox?this.state=at.WAITING_LEVEL:this.state=at.ERROR;this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,i=e===1/0;(!e||t>=e||i&&!Kd(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=at.IDLE)}reduceLengthAndFlushBuffer(t){if(this.state===at.PARSING||this.state===at.PARSED){const e=t.frag,i=t.parent,s=this.getFwdBufferInfo(this.mediaBuffer,i),a=s&&s.len>.5;a&&this.reduceMaxBufferLength(s.len,e?.duration||10);const l=!a;return l&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(t){t===mt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==at.STOPPED&&(this.state=at.IDLE)}afterBufferFlushed(t,e,i){if(!t)return;const s=At.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,s,i),this.state===at.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==at.STOPPED&&(this.state=at.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;e!=null&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log(`Loading context changed while buffering sn ${t.sn} of ${this.playlistLabel()} ${t.level===-1?"<removed>":t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,s){const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((d,f)=>{const h=t.elementaryStreams[f];if(h){const p=h.endPTS-h.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${t.sn} ${f} duration reliably (${p})`),d||!1;const g=s?0:gx(a,t,h.startPTS,h.endPTS,h.startDTS,h.endDTS,this);return this.hls.trigger(_.LEVEL_PTS_UPDATED,{details:a,level:i,drift:g,type:f,frag:t,start:h.startPTS,end:h.endPTS}),!0}return d},!1)){var u;if(i.fragmentError===0&&this.treatAsGap(t,i),((u=this.transmuxer)==null?void 0:u.error)===null){const d=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=at.PARSED,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(_.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===mt.MAIN?"level":"track"}fragInfo(t,e=!0,i){var s,a;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${((s=e&&!i?t.startPTS:(i||t).start)!=null?s:NaN).toFixed(3)}-${((a=e&&!i?t.endPTS:(i||t).end)!=null?a:NaN).toFixed(3)}]${i&&t.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;(t=this.transmuxer)==null||t.reset()}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function lv(r){return!!r.interstitialsController&&r.enableInterstitialPlayback!==!1}class Ax{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;if(t.length)t.length===1?i=t[0]:i=bC(t,e);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function bC(r,t){const e=new Uint8Array(t);let i=0;for(let s=0;s<r.length;s++){const a=r[s];e.set(a,i),i+=a.length}return e}var vd={exports:{}},uv;function AC(){return uv||(uv=1,(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function a(d,f,h,p,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new s(h,p||d,g),v=e?e+f:f;return d._events[v]?d._events[v].fn?d._events[v]=[d._events[v],y]:d._events[v].push(y):(d._events[v]=y,d._eventsCount++),d}function l(d,f){--d._eventsCount===0?d._events=new i:delete d._events[f]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,p;if(this._eventsCount===0)return f;for(p in h=this._events)t.call(h,p)&&f.push(e?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=e?e+f:f,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,y=p.length,v=new Array(y);g<y;g++)v[g]=p[g].fn;return v},u.prototype.listenerCount=function(f){var h=e?e+f:f,p=this._events[h];return p?p.fn?1:p.length:0},u.prototype.emit=function(f,h,p,g,y,v){var S=e?e+f:f;if(!this._events[S])return!1;var T=this._events[S],A=arguments.length,b,R;if(T.fn){switch(T.once&&this.removeListener(f,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,p),!0;case 4:return T.fn.call(T.context,h,p,g),!0;case 5:return T.fn.call(T.context,h,p,g,y),!0;case 6:return T.fn.call(T.context,h,p,g,y,v),!0}for(R=1,b=new Array(A-1);R<A;R++)b[R-1]=arguments[R];T.fn.apply(T.context,b)}else{var C=T.length,D;for(R=0;R<C;R++)switch(T[R].once&&this.removeListener(f,T[R].fn,void 0,!0),A){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,h);break;case 3:T[R].fn.call(T[R].context,h,p);break;case 4:T[R].fn.call(T[R].context,h,p,g);break;default:if(!b)for(D=1,b=new Array(A-1);D<A;D++)b[D-1]=arguments[D];T[R].fn.apply(T[R].context,b)}}return!0},u.prototype.on=function(f,h,p){return a(this,f,h,p,!1)},u.prototype.once=function(f,h,p){return a(this,f,h,p,!0)},u.prototype.removeListener=function(f,h,p,g){var y=e?e+f:f;if(!this._events[y])return this;if(!h)return l(this,y),this;var v=this._events[y];if(v.fn)v.fn===h&&(!g||v.once)&&(!p||v.context===p)&&l(this,y);else{for(var S=0,T=[],A=v.length;S<A;S++)(v[S].fn!==h||g&&!v[S].once||p&&v[S].context!==p)&&T.push(v[S]);T.length?this._events[y]=T.length===1?T[0]:T:l(this,y)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=e?e+f:f,this._events[h]&&l(this,h)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,r.exports=u})(vd)),vd.exports}var RC=AC(),Nh=WL(RC);const ro="1.6.14",Yr={};function LC(){return typeof __HLS_WORKER_BUNDLE__=="function"}function _C(){const r=Yr[ro];if(r)return r.clientCount++,r;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t),s={worker:new self.Worker(e),objectURL:e,clientCount:1};return Yr[ro]=s,s}function CC(r){const t=Yr[r];if(t)return t.clientCount++,t;const e=new self.URL(r,self.location.href).href,s={worker:new self.Worker(e),scriptURL:e,clientCount:1};return Yr[r]=s,s}function wC(r){const t=Yr[r||ro];if(t&&t.clientCount--===1){const{worker:i,objectURL:s}=t;delete Yr[r||ro],s&&self.URL.revokeObjectURL(s),i.terminate()}}function Rx(r,t){return t+10<=r.length&&r[t]===51&&r[t+1]===68&&r[t+2]===73&&r[t+3]<255&&r[t+4]<255&&r[t+6]<128&&r[t+7]<128&&r[t+8]<128&&r[t+9]<128}function Fh(r,t){return t+10<=r.length&&r[t]===73&&r[t+1]===68&&r[t+2]===51&&r[t+3]<255&&r[t+4]<255&&r[t+6]<128&&r[t+7]<128&&r[t+8]<128&&r[t+9]<128}function Pu(r,t){let e=0;return e=(r[t]&127)<<21,e|=(r[t+1]&127)<<14,e|=(r[t+2]&127)<<7,e|=r[t+3]&127,e}function ao(r,t){const e=t;let i=0;for(;Fh(r,t);){i+=10;const s=Pu(r,t+6);i+=s,Rx(r,t+10)&&(i+=10),t+=i}if(i>0)return r.subarray(e,e+i)}function DC(r,t,e,i){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=t[e+2],l=a>>2&15;if(l>12){const y=new Error(`invalid ADTS sampling index:${l}`);r.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:y,reason:y.message});return}const u=(a>>6&3)+1,d=t[e+3]>>6&3|(a&1)<<2,f="mp4a.40."+u,h=s[l];let p=l;(u===5||u===29)&&(p-=3);const g=[u<<3|(p&14)>>1,(p&1)<<7|d<<3];return Vt.log(`manifest codec:${i}, parsed codec:${f}, channels:${d}, rate:${h} (ADTS object type:${u} sampling index:${l})`),{config:g,samplerate:h,channelCount:d,codec:f,parsedCodec:f,manifestCodec:i}}function Lx(r,t){return r[t]===255&&(r[t+1]&246)===240}function _x(r,t){return r[t+1]&1?7:9}function Bh(r,t){return(r[t+3]&3)<<11|r[t+4]<<3|(r[t+5]&224)>>>5}function IC(r,t){return t+5<r.length}function Tu(r,t){return t+1<r.length&&Lx(r,t)}function OC(r,t){return IC(r,t)&&Lx(r,t)&&Bh(r,t)<=r.length-t}function kC(r,t){if(Tu(r,t)){const e=_x(r,t);if(t+e>=r.length)return!1;const i=Bh(r,t);if(i<=e)return!1;const s=t+i;return s===r.length||Tu(r,s)}return!1}function Cx(r,t,e,i,s){if(!r.samplerate){const a=DC(t,e,i,s);if(!a)return;Xt(r,a)}}function wx(r){return 1024*9e4/r}function MC(r,t){const e=_x(r,t);if(t+e<=r.length){const i=Bh(r,t)-e;if(i>0)return{headerLength:e,frameLength:i}}}function Dx(r,t,e,i,s){const a=wx(r.samplerate),l=i+s*a,u=MC(t,e);let d;if(u){const{frameLength:p,headerLength:g}=u,y=g+p,v=Math.max(0,e+y-t.length);v?(d=new Uint8Array(y-g),d.set(t.subarray(e+g,t.length),0)):d=t.subarray(e+g,e+y);const S={unit:d,pts:l};return v||r.samples.push(S),{sample:S,length:y,missing:v}}const f=t.length-e;return d=new Uint8Array(f),d.set(t.subarray(e,t.length),0),{sample:{unit:d,pts:l},length:f,missing:-1}}function PC(r,t){return Fh(r,t)&&Pu(r,t+6)+10<=r.length-t}function NC(r){return r instanceof ArrayBuffer?r:r.byteOffset==0&&r.byteLength==r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}function Ed(r,t=0,e=1/0){return FC(r,t,e,Uint8Array)}function FC(r,t,e,i){const s=BC(r);let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const l=UC(r)?r.byteOffset:0,u=(l+r.byteLength)/a,d=(l+t)/a,f=Math.floor(Math.max(0,Math.min(d,u))),h=Math.floor(Math.min(f+Math.max(e,0),u));return new i(s,f,h-f)}function BC(r){return r instanceof ArrayBuffer?r:r.buffer}function UC(r){return r&&r.buffer instanceof ArrayBuffer&&r.byteLength!==void 0&&r.byteOffset!==void 0}function $C(r){const t={key:r.type,description:"",data:"",mimeType:null,pictureType:null},e=3;if(r.size<2)return;if(r.data[0]!==e){console.log("Ignore frame with unrecognized character encoding");return}const i=r.data.subarray(1).indexOf(0);if(i===-1)return;const s=gi(Ed(r.data,1,i)),a=r.data[2+i],l=r.data.subarray(3+i).indexOf(0);if(l===-1)return;const u=gi(Ed(r.data,3+i,l));let d;return s==="-->"?d=gi(Ed(r.data,4+i+l)):d=NC(r.data.subarray(4+i+l)),t.mimeType=s,t.pictureType=a,t.description=u,t.data=d,t}function jC(r){if(r.size<2)return;const t=gi(r.data,!0),e=new Uint8Array(r.data.subarray(t.length+1));return{key:r.type,info:t,data:e.buffer}}function GC(r){if(r.size<2)return;if(r.type==="TXXX"){let e=1;const i=gi(r.data.subarray(e),!0);e+=i.length+1;const s=gi(r.data.subarray(e));return{key:r.type,info:i,data:s}}const t=gi(r.data.subarray(1));return{key:r.type,info:"",data:t}}function HC(r){if(r.type==="WXXX"){if(r.size<2)return;let e=1;const i=gi(r.data.subarray(e),!0);e+=i.length+1;const s=gi(r.data.subarray(e));return{key:r.type,info:i,data:s}}const t=gi(r.data);return{key:r.type,info:"",data:t}}function zC(r){return r.type==="PRIV"?jC(r):r.type[0]==="W"?HC(r):r.type==="APIC"?$C(r):GC(r)}function VC(r){const t=String.fromCharCode(r[0],r[1],r[2],r[3]),e=Pu(r,4),i=10;return{type:t,size:e,data:r.subarray(i,i+e)}}const Bl=10,KC=10;function Ix(r){let t=0;const e=[];for(;Fh(r,t);){const i=Pu(r,t+6);r[t+5]>>6&1&&(t+=Bl),t+=Bl;const s=t+i;for(;t+KC<s;){const a=VC(r.subarray(t)),l=zC(a);l&&e.push(l),t+=a.size+Bl}Rx(r,t)&&(t+=Bl)}return e}function Ox(r){return r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp"}function qC(r){if(r.data.byteLength===8){const t=new Uint8Array(r.data),e=t[3]&1;let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,e&&(i+=4772185884e-2),Math.round(i)}}function Uh(r){const t=Ix(r);for(let e=0;e<t.length;e++){const i=t[e];if(Ox(i))return qC(i)}}let mi=(function(r){return r.audioId3="org.id3",r.dateRange="com.apple.quicktime.HLS",r.emsg="https://aomedia.org/emsg/ID3",r.misbklv="urn:misb:KLV:bin:1910.1",r})({});function Yi(r="",t=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class $h{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=Ci(this.cachedData,t),this.cachedData=null);let i=ao(t,0),s=i?i.length:0,a;const l=this._audioTrack,u=this._id3Track,d=i?Uh(i):void 0,f=t.length;for((this.basePTS===null||this.frameIndex===0&&ht(d))&&(this.basePTS=YC(d,e,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:mi.audioId3,duration:Number.POSITIVE_INFINITY});s<f;){if(this.canParse(t,s)){const h=this.appendFrame(l,t,s);h?(this.frameIndex++,this.lastPTS=h.sample.pts,s+=h.length,a=s):s=f}else PC(t,s)?(i=ao(t,s),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:mi.audioId3,duration:Number.POSITIVE_INFINITY}),s+=i.length,a=s):s++;if(s===f&&a!==f){const h=t.slice(a);this.cachedData?this.cachedData=Ci(this.cachedData,h):this.cachedData=h}}return{audioTrack:l,videoTrack:Yi(),id3Track:u,textTrack:Yi()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Yi(),id3Track:this._id3Track,textTrack:Yi()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const YC=(r,t,e)=>{if(ht(r))return r*90;const i=e?e.baseTime*9e4/e.timescale:0;return t*9e4+i};let Ul=null;const XC=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],WC=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],QC=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ZC=[0,1,1,4];function kx(r,t,e,i,s){if(e+24>t.length)return;const a=Mx(t,e);if(a&&e+a.frameLength<=t.length){const l=a.samplesPerFrame*9e4/a.sampleRate,u=i+s*l,d={unit:t.subarray(e,e+a.frameLength),pts:u,dts:u};return r.config=[],r.channelCount=a.channelCount,r.samplerate=a.sampleRate,r.samples.push(d),{sample:d,length:a.frameLength,missing:0}}}function Mx(r,t){const e=r[t+1]>>3&3,i=r[t+1]>>1&3,s=r[t+2]>>4&15,a=r[t+2]>>2&3;if(e!==1&&s!==0&&s!==15&&a!==3){const l=r[t+2]>>1&1,u=r[t+3]>>6,d=e===3?3-i:i===3?3:4,f=XC[d*14+s-1]*1e3,p=WC[(e===3?0:e===2?1:2)*3+a],g=u===3?1:2,y=QC[e][i],v=ZC[i],S=y*8*v,T=Math.floor(y*f/p+l)*v;if(Ul===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ul=R?parseInt(R[1]):0}return!!Ul&&Ul<=87&&i===2&&f>=224e3&&u===0&&(r[t+3]=r[t+3]|128),{sampleRate:p,channelCount:g,frameLength:T,samplesPerFrame:S}}}function jh(r,t){return r[t]===255&&(r[t+1]&224)===224&&(r[t+1]&6)!==0}function Px(r,t){return t+1<r.length&&jh(r,t)}function JC(r,t){return jh(r,t)&&4<=r.length-t}function Nx(r,t){if(t+1<r.length&&jh(r,t)){const i=Mx(r,t);let s=4;i!=null&&i.frameLength&&(s=i.frameLength);const a=t+s;return a===r.length||Px(r,a)}return!1}class tw extends $h{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const i=ao(t,0);let s=i?.length||0;if(Nx(t,s))return!1;for(let a=t.length;s<a;s++)if(kC(t,s))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return OC(t,e)}appendFrame(t,e,i){Cx(t,this.observer,e,i,t.manifestCodec);const s=Dx(t,e,i,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const Fx=(r,t)=>{let e=0,i=5;t+=i;const s=new Uint32Array(1),a=new Uint32Array(1),l=new Uint8Array(1);for(;i>0;){l[0]=r[t];const u=Math.min(i,8),d=8-u;a[0]=4278190080>>>24+d<<d,s[0]=(l[0]&a[0])>>d,e=e?e<<u|s[0]:s[0],t+=1,i-=u}return e};class ew extends $h{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const s=Bx(t,e,i,this.basePTS,this.frameIndex);if(s!==-1)return{sample:t.samples[t.samples.length-1],length:s,missing:0}}static probe(t){if(!t)return!1;const e=ao(t,0);if(!e)return!1;const i=e.length;return t[i]===11&&t[i+1]===119&&Uh(e)!==void 0&&Fx(t,i)<16}}function Bx(r,t,e,i,s){if(e+8>t.length||t[e]!==11||t[e+1]!==119)return-1;const a=t[e+4]>>6;if(a>=3)return-1;const u=[48e3,44100,32e3][a],d=t[e+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+a]*2;if(e+h>t.length)return-1;const p=t[e+6]>>5;let g=0;p===2?g+=2:(p&1&&p!==1&&(g+=2),p&4&&(g+=2));const y=(t[e+6]<<8|t[e+7])>>12-g&1,S=[2,1,2,3,3,4,4,5][p]+y,T=t[e+5]>>3,A=t[e+5]&7,b=new Uint8Array([a<<6|T<<1|A>>2,(A&3)<<6|p<<3|y<<2|d>>4,d<<4&224]),R=1536/u*9e4,C=i+s*R,D=t.subarray(e,e+h);return r.config=b,r.channelCount=S,r.samplerate=u,r.samples.push({unit:D,pts:C}),h}class iw extends $h{resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=ao(t,0);let i=e?.length||0;if(e&&t[i]===11&&t[i+1]===119&&Uh(e)!==void 0&&Fx(t,i)<=16)return!1;for(let s=t.length;i<s;i++)if(Nx(t,i))return Vt.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return JC(t,e)}appendFrame(t,e,i){if(this.basePTS!==null)return kx(t,e,i,this.basePTS,this.frameIndex)}}const nw=/\/emsg[-/]ID3/i;class sw{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,s){const a=this.videoTrack=Yi("video",1),l=this.audioTrack=Yi("audio",1),u=this.txtTrack=Yi("text",1);if(this.id3Track=Yi("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const d=YE(t);if(d.video){const{id:f,timescale:h,codec:p,supplemental:g}=d.video;a.id=f,a.timescale=u.timescale=h,a.codec=p,a.supplemental=g}if(d.audio){const{id:f,timescale:h,codec:p}=d.audio;l.id=f,l.timescale=h,l.codec=p}u.id=VE.text,a.sampleDuration=0,a.duration=l.duration=s}resetContiguity(){this.remainderData=null}static probe(t){return e_(t)}demux(t,e){this.timeOffset=e;let i=t;const s=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Ci(this.remainderData,t));const u=l_(i);this.remainderData=u.remainder,s.samples=u.valid||new Uint8Array}else s.samples=i;const l=this.extractID3Track(s,e);return a.samples=_y(e,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(e,this.timeOffset);return i.samples=_y(t,e),{videoTrack:e,audioTrack:Yi(),id3Track:s,textTrack:Yi()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const s=Dt(t.samples,["emsg"]);s&&s.forEach(a=>{const l=c_(a);if(nw.test(l.schemeIdUri)){const u=cv(l,e);let d=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const f=l.payload;i.samples.push({data:f,len:f.byteLength,dts:u,pts:u,type:mi.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=cv(l,e);i.samples.push({data:l.payload,len:l.payload.byteLength,dts:u,pts:u,type:mi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function cv(r,t){return ht(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale}class rw{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Ih(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,ms.cbc)}decryptAacSample(t,e,i){const s=t[e].unit;if(s.length<=16)return;const a=s.subarray(16,s.length-s.length%16),l=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(l).then(u=>{const d=new Uint8Array(u);s.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}).catch(i)}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length){i();return}if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=Math.floor((t.length-48)/160)*16+16,i=new Int8Array(e);let s=0;for(let a=32;a<t.length-16;a+=160,s+=16)i.set(t.subarray(a,a+16),s);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let s=0;for(let a=32;a<t.length-16;a+=160,s+=16)t.set(i.subarray(s,s+16),a);return t}decryptAvcSample(t,e,i,s,a){const l=QE(a.data),u=this.getAvcEncryptedData(l);this.decryptBuffer(u.buffer).then(d=>{a.data=this.getAvcDecryptedUnit(l,d),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,s)}).catch(s)}decryptAvcSamples(t,e,i,s){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length){s();return}const a=t[e].units;for(;!(i>=a.length);i++){const l=a[i];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(t,e,i,s,l),!this.decrypter.isSync()))return}}}}class Ux{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let i=this.VideoSample,s;if((!i||i.units.length===0)&&(i=t[t.length-1]),(e=i)!=null&&e.units){const a=i.units;s=a[a.length-1]}return s}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(t.pts===void 0){const i=e.samples,s=i.length;if(s){const a=i[s-1];t.pts=a.pts,t.dts=a.dts}else{e.dropped++;return}}e.samples.push(t)}}parseNALu(t,e,i){const s=e.byteLength;let a=t.naluState||0;const l=a,u=[];let d=0,f,h,p,g=-1,y=0;for(a===-1&&(g=0,y=this.getNALuType(e,0),a=0,d=1);d<s;){if(f=e[d++],!a){a=f?0:1;continue}if(a===1){a=f?0:2;continue}if(!f)a=3;else if(f===1){if(h=d-a-1,g>=0){const v={data:e.subarray(g,h),type:y};u.push(v)}else{const v=this.getLastNalUnit(t.samples);v&&(l&&d<=4-l&&v.state&&(v.data=v.data.subarray(0,v.data.byteLength-l)),h>0&&(v.data=Ci(v.data,e.subarray(0,h)),v.state=0))}d<s?(p=this.getNALuType(e,d),g=d,y=p,a=0):a=-1}else a=0}if(g>=0&&a>=0){const v={data:e.subarray(g,s),type:y,state:a};u.push(v)}if(u.length===0){const v=this.getLastNalUnit(t.samples);v&&(v.data=Ci(v.data,e))}return t.naluState=a,u}}class Qa{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,s=new Uint8Array(4),a=Math.min(4,e);if(a===0)throw new Error("no bytes available");s.set(t.subarray(i,i+a)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(t){let e;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&Vt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!==0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class aw extends Ux{parsePES(t,e,i,s){const a=this.parseNALu(t,i.data,s);let l=this.VideoSample,u,d=!1;i.data=null,l&&a.length&&!t.audFound&&(this.pushAccessUnit(l,t),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var h,p;switch(f.type){case 1:{let S=!1;u=!0;const T=f.data;if(d&&T.length>4){const A=this.readSliceType(T);(A===2||A===4||A===7||A===9)&&(S=!0)}if(S){var g;(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.frame=!0,l.key=S;break}case 5:u=!0,(h=l)!=null&&h.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 6:{u=!0,_h(f.data,1,i.pts,e.samples);break}case 7:{var y,v;u=!0,d=!0;const S=f.data,T=this.readSPS(S);if(!t.sps||t.width!==T.width||t.height!==T.height||((y=t.pixelRatio)==null?void 0:y[0])!==T.pixelRatio[0]||((v=t.pixelRatio)==null?void 0:v[1])!==T.pixelRatio[1]){t.width=T.width,t.height=T.height,t.pixelRatio=T.pixelRatio,t.sps=[S];const A=S.subarray(1,4);let b="avc1.";for(let R=0;R<3;R++){let C=A[R].toString(16);C.length<2&&(C="0"+C),b+=C}t.codec=b}break}case 8:u=!0,t.pps=[f.data];break;case 9:u=!0,t.audFound=!0,(p=l)!=null&&p.frame&&(this.pushAccessUnit(l,t),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:u=!0;break;default:u=!1;break}l&&u&&l.units.push(f)}),s&&l&&(this.pushAccessUnit(l,t),this.VideoSample=null)}getNALuType(t,e){return t[e]&31}readSliceType(t){const e=new Qa(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let i=8,s=8,a;for(let l=0;l<t;l++)s!==0&&(a=e.readEG(),s=(i+a+256)%256),i=s===0?i:s}readSPS(t){const e=new Qa(t);let i=0,s=0,a=0,l=0,u,d,f;const h=e.readUByte.bind(e),p=e.readBits.bind(e),g=e.readUEG.bind(e),y=e.readBoolean.bind(e),v=e.skipBits.bind(e),S=e.skipEG.bind(e),T=e.skipUEG.bind(e),A=this.skipScalingList.bind(this);h();const b=h();if(p(5),v(3),h(),T(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){const P=g();if(P===3&&v(1),T(),T(),v(1),y())for(d=P!==3?8:12,f=0;f<d;f++)y()&&(f<6?A(16,e):A(64,e))}T();const R=g();if(R===0)g();else if(R===1)for(v(1),S(),S(),u=g(),f=0;f<u;f++)S();T(),v(1);const C=g(),D=g(),N=p(1);N===0&&v(1),v(1),y()&&(i=g(),s=g(),a=g(),l=g());let w=[1,1];if(y()&&y())switch(h()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:{w=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((C+1)*16-i*2-s*2),height:(2-N)*(D+1)*16-(N?2:4)*(a+l),pixelRatio:w}}}class ow extends Ux{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,i,s){const a=this.parseNALu(t,i.data,s);let l=this.VideoSample,u,d=!1;i.data=null,l&&a.length&&!t.audFound&&(this.pushAccessUnit(l,t),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(f=>{var h,p;switch(f.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),l.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,d){var g;(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:u=!0,(h=l)!=null&&h.frame&&!l.key&&(this.pushAccessUnit(l,t),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0,l.frame=!0;break;case 39:u=!0,_h(f.data,2,i.pts,e.samples);break;case 32:u=!0,t.vps||(typeof t.params!="object"&&(t.params={}),t.params=Xt(t.params,this.readVPS(f.data)),this.initVPS=f.data),t.vps=[f.data];break;case 33:if(u=!0,d=!0,t.vps!==void 0&&t.vps[0]!==this.initVPS&&t.sps!==void 0&&!this.matchSPS(t.sps[0],f.data)&&(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const y=this.readSPS(f.data);t.width=y.width,t.height=y.height,t.pixelRatio=y.pixelRatio,t.codec=y.codecString,t.sps=[],typeof t.params!="object"&&(t.params={});for(const v in y.params)t.params[v]=y.params[v]}this.pushParameterSet(t.sps,f.data,t.vps),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),l.key=!0;break;case 34:if(u=!0,typeof t.params=="object"){if(!t.pps){t.pps=[];const y=this.readPPS(f.data);for(const v in y)t.params[v]=y[v]}this.pushParameterSet(t.pps,f.data,t.vps)}break;case 35:u=!0,t.audFound=!0,(p=l)!=null&&p.frame&&(this.pushAccessUnit(l,t),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:u=!1;break}l&&u&&l.units.push(f)}),s&&l&&(this.pushAccessUnit(l,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(t[e]&126)>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let i=0;for(let s=0;s<t.byteLength;s++)s>=2&&t[s]===3&&t[s-1]===0&&t[s-2]===0||(e[i]=t[s],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new Qa(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);const i=e.readBits(3),s=e.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:s}}readSPS(t){const e=new Qa(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const i=e.readBits(3);e.readBoolean();const s=e.readBits(2),a=e.readBoolean(),l=e.readBits(5),u=e.readUByte(),d=e.readUByte(),f=e.readUByte(),h=e.readUByte(),p=e.readUByte(),g=e.readUByte(),y=e.readUByte(),v=e.readUByte(),S=e.readUByte(),T=e.readUByte(),A=e.readUByte(),b=[],R=[];for(let bt=0;bt<i;bt++)b.push(e.readBoolean()),R.push(e.readBoolean());if(i>0)for(let bt=i;bt<8;bt++)e.readBits(2);for(let bt=0;bt<i;bt++)b[bt]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),R[bt]&&e.readUByte();e.readUEG();const C=e.readUEG();C==3&&e.skipBits(1);const D=e.readUEG(),N=e.readUEG(),w=e.readBoolean();let P=0,B=0,M=0,K=0;w&&(P+=e.readUEG(),B+=e.readUEG(),M+=e.readUEG(),K+=e.readUEG());const tt=e.readUEG(),z=e.readUEG(),G=e.readUEG(),Y=e.readBoolean();for(let bt=Y?0:i;bt<=i;bt++)e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.readBoolean()&&e.readBoolean())for(let pt=0;pt<4;pt++)for(let Se=0;Se<(pt===3?2:6);Se++)if(!e.readBoolean())e.readUEG();else{const le=Math.min(64,1<<4+(pt<<1));pt>1&&e.readEG();for(let Ie=0;Ie<le;Ie++)e.readEG()}e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const V=e.readUEG();let nt=0;for(let bt=0;bt<V;bt++){let pt=!1;if(bt!==0&&(pt=e.readBoolean()),pt){bt===V&&e.readUEG(),e.readBoolean(),e.readUEG();let Se=0;for(let oe=0;oe<=nt;oe++){const le=e.readBoolean();let Ie=!1;le||(Ie=e.readBoolean()),(le||Ie)&&Se++}nt=Se}else{const Se=e.readUEG(),oe=e.readUEG();nt=Se+oe;for(let le=0;le<Se;le++)e.readUEG(),e.readBoolean();for(let le=0;le<oe;le++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const bt=e.readUEG();for(let pt=0;pt<bt;pt++){for(let Se=0;Se<G+4;Se++)e.readBits(1);e.readBits(1)}}let k=0,$=1,st=1,ct=!0,ft=1,dt=0;e.readBoolean(),e.readBoolean();let Et=!1;if(e.readBoolean()){if(e.readBoolean()){const Ue=e.readUByte(),je=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ie=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Ue>0&&Ue<16?($=je[Ue-1],st=ie[Ue-1]):Ue===255&&($=e.readBits(16),st=e.readBits(16))}if(e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())),e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),Et=e.readBoolean(),Et&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG()),e.readBoolean()&&(ft=e.readBits(32),dt=e.readBits(32),e.readBoolean()&&e.readUEG(),e.readBoolean())){const ie=e.readBoolean(),on=e.readBoolean();let qe=!1;(ie||on)&&(qe=e.readBoolean(),qe&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),qe&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let ps=0;ps<=i;ps++){ct=e.readBoolean();const Nn=ct||e.readBoolean();let Xs=!1;Nn?e.readEG():Xs=e.readBoolean();const gs=Xs?1:e.readUEG()+1;if(ie)for(let ln=0;ln<gs;ln++)e.readUEG(),e.readUEG(),qe&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(on)for(let ln=0;ln<gs;ln++)e.readUEG(),e.readUEG(),qe&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),k=e.readUEG())}let _t=D,ee=N;if(w){let bt=1,pt=1;C===1?bt=pt=2:C==2&&(bt=2),_t=D-bt*B-bt*P,ee=N-pt*K-pt*M}const he=s?["A","B","C"][s]:"",Re=u<<24|d<<16|f<<8|h;let De=0;for(let bt=0;bt<32;bt++)De=(De|(Re>>bt&1)<<31-bt)>>>0;let Le=De.toString(16);return l===1&&Le==="2"&&(Le="6"),{codecString:`hvc1.${he}${l}.${Le}.${a?"H":"L"}${A}.B0`,params:{general_tier_flag:a,general_profile_idc:l,general_profile_space:s,general_profile_compatibility_flags:[u,d,f,h],general_constraint_indicator_flags:[p,g,y,v,S,T],general_level_idc:A,bit_depth:tt+8,bit_depth_luma_minus8:tt,bit_depth_chroma_minus8:z,min_spatial_segmentation_idc:k,chroma_format_idc:C,frame_rate:{fixed:ct,fps:dt/ft}},width:_t,height:ee,pixelRatio:[$,st]}}readPPS(t){const e=new Qa(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2),e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const s=e.readBoolean(),a=e.readBoolean();let l=1;return a&&s?l=0:a?l=3:s&&(l=2),{parallelismType:l}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const we=188;class cs{constructor(t,e,i,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=s,this.videoParser=null}static probe(t,e){const i=cs.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(t){const e=t.length;let i=Math.min(we*5,e-we)+1,s=0;for(;s<i;){let a=!1,l=-1,u=0;for(let d=s;d<e;d+=we)if(t[d]===71&&(e-d===we||t[d+we]===71)){if(u++,l===-1&&(l=d,l!==0&&(i=Math.min(l+we*99,t.length-we)+1)),a||(a=Qd(t,d)===0),a&&u>1&&(l===0&&u>2||d+we>i))return l}else{if(u)return-1;break}s++}return-1}static createTrack(t,e){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:VE[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?e:void 0}}resetInitSegment(t,e,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=cs.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=cs.createTrack("audio",s),this._id3Track=cs.createTrack("id3"),this._txtTrack=cs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,s=!1){i||(this.sampleAes=null);let a;const l=this._videoTrack,u=this._audioTrack,d=this._id3Track,f=this._txtTrack;let h=l.pid,p=l.pesData,g=u.pid,y=d.pid,v=u.pesData,S=d.pesData,T=null,A=this.pmtParsed,b=this._pmtId,R=t.length;if(this.remainderData&&(t=Ci(this.remainderData,t),R=t.length,this.remainderData=null),R<we&&!s)return this.remainderData=t,{audioTrack:u,videoTrack:l,id3Track:d,textTrack:f};const C=Math.max(0,cs.syncOffset(t));R-=(R-C)%we,R<t.byteLength&&!s&&(this.remainderData=new Uint8Array(t.buffer,R,t.buffer.byteLength-R));let D=0;for(let w=C;w<R;w+=we)if(t[w]===71){const P=!!(t[w+1]&64),B=Qd(t,w),M=(t[w+3]&48)>>4;let K;if(M>1){if(K=w+5+t[w+4],K===w+we)continue}else K=w+4;switch(B){case h:P&&(p&&(a=Nr(p,this.logger))&&(this.readyVideoParser(l.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(l,f,a,!1)),p={data:[],size:0}),p&&(p.data.push(t.subarray(K,w+we)),p.size+=w+we-K);break;case g:if(P){if(v&&(a=Nr(v,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,a);break;case"mp3":this.parseMPEGPES(u,a);break;case"ac3":this.parseAC3PES(u,a);break}v={data:[],size:0}}v&&(v.data.push(t.subarray(K,w+we)),v.size+=w+we-K);break;case y:P&&(S&&(a=Nr(S,this.logger))&&this.parseID3PES(d,a),S={data:[],size:0}),S&&(S.data.push(t.subarray(K,w+we)),S.size+=w+we-K);break;case 0:P&&(K+=t[K]+1),b=this._pmtId=lw(t,K);break;case b:{P&&(K+=t[K]+1);const tt=uw(t,K,this.typeSupported,i,this.observer,this.logger);h=tt.videoPid,h>0&&(l.pid=h,l.segmentCodec=tt.segmentVideoCodec),g=tt.audioPid,g>0&&(u.pid=g,u.segmentCodec=tt.segmentAudioCodec),y=tt.id3Pid,y>0&&(d.pid=y),T!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${w} after unknown PID '${T}'. Backtracking to sync byte @${C} to parse all TS packets.`),T=null,w=C-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=B;break}}else D++;D>0&&Zd(this.observer,new Error(`Found ${D} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=p,u.pesData=v,d.pesData=S;const N={audioTrack:u,videoTrack:l,id3Track:d,textTrack:f};return s&&this.extractRemainingSamples(N),N}flush(){const{remainderData:t}=this;this.remainderData=null;let e;return t?e=this.demux(t,-1,!1,!0):e={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:s,textTrack:a}=t,l=i.pesData,u=e.pesData,d=s.pesData;let f;if(l&&(f=Nr(l,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,a,f,!0),i.pesData=null)):i.pesData=l,u&&(f=Nr(u,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,f);break;case"mp3":this.parseMPEGPES(e,f);break;case"ac3":this.parseAC3PES(e,f);break}e.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=u;d&&(f=Nr(d,this.logger))?(this.parseID3PES(s,f),s.pesData=null):s.pesData=d}demuxSampleAes(t,e,i){const s=this.demux(t,i,!0,!this.config.progressive),a=this.sampleAes=new rw(this.observer,this.config,e);return this.decrypt(s,a)}readyVideoParser(t){this.videoParser===null&&(t==="avc"?this.videoParser=new aw:t==="hevc"&&(this.videoParser=new ow))}decrypt(t,e){return new Promise(i=>{const{audioTrack:s,videoTrack:a}=t;s.samples&&s.segmentCodec==="aac"?e.decryptAacSamples(s.samples,0,()=>{a.samples?e.decryptAvcSamples(a.samples,0,0,()=>{i(t)}):i(t)}):a.samples&&e.decryptAvcSamples(a.samples,0,0,()=>{i(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0;const s=this.aacOverFlow;let a=e.data;if(s){this.aacOverFlow=null;const p=s.missing,g=s.sample.unit.byteLength;if(p===-1)a=Ci(s.sample.unit,a);else{const y=g-p;s.sample.unit.set(a.subarray(0,p),y),t.samples.push(s.sample),i=s.missing}}let l,u;for(l=i,u=a.length;l<u-1&&!Tu(a,l);l++);if(l!==i){let p;const g=l<u-1;if(g?p=`AAC PES did not start with ADTS header,offset:${l}`:p="No ADTS header found in AAC PES",Zd(this.observer,new Error(p),g,this.logger),!g)return}Cx(t,this.observer,a,l,this.audioCodec);let d;if(e.pts!==void 0)d=e.pts;else if(s){const p=wx(t.samplerate);d=s.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,h;for(;l<u;)if(h=Dx(t,a,l,d,f),l+=h.length,h.missing){this.aacOverFlow=h;break}else for(f++;l<u-1&&!Tu(a,l);l++);}parseMPEGPES(t,e){const i=e.data,s=i.length;let a=0,l=0;const u=e.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<s;)if(Px(i,l)){const d=kx(t,i,l,u,a);if(d)l+=d.length,a++;else break}else l++}parseAC3PES(t,e){{const i=e.data,s=e.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=i.length;let l=0,u=0,d;for(;u<a&&(d=Bx(t,i,u,s,l++))>0;)u+=d}}parseID3PES(t,e){if(e.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Xt({},e,{type:this._videoTrack?mi.emsg:mi.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function Qd(r,t){return((r[t+1]&31)<<8)+r[t+2]}function lw(r,t){return(r[t+10]&31)<<8|r[t+11]}function uw(r,t,e,i,s,a){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(r[t+1]&15)<<8|r[t+2],d=t+3+u-4,f=(r[t+10]&15)<<8|r[t+11];for(t+=12+f;t<d;){const h=Qd(r,t),p=(r[t+3]&15)<<8|r[t+4];switch(r[t]){case 207:if(!i){xd("ADTS AAC",a);break}case 15:l.audioPid===-1&&(l.audioPid=h);break;case 21:l.id3Pid===-1&&(l.id3Pid=h);break;case 219:if(!i){xd("H.264",a);break}case 27:l.videoPid===-1&&(l.videoPid=h);break;case 3:case 4:!e.mpeg&&!e.mp3?a.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="mp3");break;case 193:if(!i){xd("AC-3",a);break}case 129:e.ac3?l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&p>0){let g=t+5,y=p;for(;y>2;){switch(r[g]){case 106:e.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=h,l.segmentAudioCodec="ac3");break}const S=r[g+1]+2;g+=S,y-=S}}break;case 194:case 135:return Zd(s,new Error("Unsupported EC-3 in M2TS found"),void 0,a),l;case 36:l.videoPid===-1&&(l.videoPid=h,l.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}t+=p+5}return l}function Zd(r,t,e,i){i.warn(`parsing error: ${t.message}`),r.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:t,reason:t.message})}function xd(r,t){t.log(`${r} with AES-128-CBC encryption found in unencrypted stream`)}function Nr(r,t){let e=0,i,s,a,l,u;const d=r.data;if(!r||r.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Ci(d[0],d[1]),d.splice(1,1);if(i=d[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(s=(i[4]<<8)+i[5],s&&s>r.size-6)return null;const h=i[7];h&192&&(l=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,h&64?(u=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,l-u>60*9e4&&(t.warn(`${Math.round((l-u)/9e4)}s delta between PTS and DTS, align them`),l=u)):u=l),a=i[8];let p=a+9;if(r.size<=p)return null;r.size-=p;const g=new Uint8Array(r.size);for(let y=0,v=d.length;y<v;y++){i=d[y];let S=i.byteLength;if(p)if(p>S){p-=S;continue}else i=i.subarray(p),S-=p,p=0;g.set(i,e),e+=S}return s&&(s-=a+3),{data:g,pts:l,dts:u,len:s}}return null}class cw{static getSilentFrame(t,e){switch(t){case"mp4a.40.2":if(e===1)return new Uint8Array([0,200,0,128,35,128]);if(e===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(e===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(e===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(e===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(e===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(e===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const os=Math.pow(2,32)-1;class W{static init(){W.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in W.types)W.types.hasOwnProperty(t)&&(W.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);W.HDLR_TYPES={video:e,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);W.STTS=W.STSC=W.STCO=a,W.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),W.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),W.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);W.FTYP=W.box(W.types.ftyp,l,d,l,u),W.DINF=W.box(W.types.dinf,W.box(W.types.dref,s))}static box(t,...e){let i=8,s=e.length;const a=s;for(;s--;)i+=e[s].byteLength;const l=new Uint8Array(i);for(l[0]=i>>24&255,l[1]=i>>16&255,l[2]=i>>8&255,l[3]=i&255,l.set(t,4),s=0,i=8;s<a;s++)l.set(e[s],i),i+=e[s].byteLength;return l}static hdlr(t){return W.box(W.types.hdlr,W.HDLR_TYPES[t])}static mdat(t){return W.box(W.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(os+1)),s=Math.floor(e%(os+1));return W.box(W.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(t){return W.box(W.types.mdia,W.mdhd(t.timescale||0,t.duration||0),W.hdlr(t.type),W.minf(t))}static mfhd(t){return W.box(W.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?W.box(W.types.minf,W.box(W.types.smhd,W.SMHD),W.DINF,W.stbl(t)):W.box(W.types.minf,W.box(W.types.vmhd,W.VMHD),W.DINF,W.stbl(t))}static moof(t,e,i){return W.box(W.types.moof,W.mfhd(t),W.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=W.trak(t[e]);return W.box.apply(null,[W.types.moov,W.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(W.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=W.trex(t[e]);return W.box.apply(null,[W.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(os+1)),s=Math.floor(e%(os+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return W.box(W.types.mvhd,a)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let s,a;for(s=0;s<e.length;s++)a=e[s].flags,i[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return W.box(W.types.sdtp,i)}static stbl(t){return W.box(W.types.stbl,W.stsd(t),W.box(W.types.stts,W.STTS),W.box(W.types.stsc,W.STSC),W.box(W.types.stsz,W.STSZ),W.box(W.types.stco,W.STCO))}static avc1(t){let e=[],i=[],s,a,l;for(s=0;s<t.sps.length;s++)a=t.sps[s],l=a.byteLength,e.push(l>>>8&255),e.push(l&255),e=e.concat(Array.prototype.slice.call(a));for(s=0;s<t.pps.length;s++)a=t.pps[s],l=a.byteLength,i.push(l>>>8&255),i.push(l&255),i=i.concat(Array.prototype.slice.call(a));const u=W.box(W.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(i))),d=t.width,f=t.height,h=t.pixelRatio[0],p=t.pixelRatio[1];return W.box(W.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,e&255,0,0])}static mp4a(t){return W.box(W.types.mp4a,W.audioStsd(t),W.box(W.types.esds,W.esds(t)))}static mp3(t){return W.box(W.types[".mp3"],W.audioStsd(t))}static ac3(t){return W.box(W.types["ac-3"],W.audioStsd(t),W.box(W.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if(t.type==="audio"){if(e==="aac")return W.box(W.types.stsd,W.STSD,W.mp4a(t));if(e==="ac3"&&t.config)return W.box(W.types.stsd,W.STSD,W.ac3(t));if(e==="mp3"&&t.codec==="mp3")return W.box(W.types.stsd,W.STSD,W.mp3(t))}else if(t.pps&&t.sps){if(e==="avc")return W.box(W.types.stsd,W.STSD,W.avc1(t));if(e==="hevc"&&t.vps)return W.box(W.types.stsd,W.STSD,W.hvc1(t))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){const e=t.id,i=(t.duration||0)*(t.timescale||0),s=t.width||0,a=t.height||0,l=Math.floor(i/(os+1)),u=Math.floor(i%(os+1));return W.box(W.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,a>>8&255,a&255,0,0]))}static traf(t,e){const i=W.sdtp(t),s=t.id,a=Math.floor(e/(os+1)),l=Math.floor(e%(os+1));return W.box(W.types.traf,W.box(W.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),W.box(W.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255])),W.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,W.box(W.types.trak,W.tkhd(t),W.mdia(t))}static trex(t){const e=t.id;return W.box(W.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],s=i.length,a=12+16*s,l=new Uint8Array(a);let u,d,f,h,p,g;for(e+=8+a,l.set([t.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255],0),u=0;u<s;u++)d=i[u],f=d.duration,h=d.size,p=d.flags,g=d.cts,l.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*u);return W.box(W.types.trun,l)}static initSegment(t){W.types||W.init();const e=W.moov(t);return Ci(W.FTYP,e)}static hvc1(t){const e=t.params,i=[t.vps,t.sps,t.pps],s=4,a=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),s-1|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),i.length]);let l=a.length;for(let v=0;v<i.length;v+=1){l+=3;for(let S=0;S<i[v].length;S+=1)l+=2+i[v][S].length}const u=new Uint8Array(l);u.set(a,0),l=a.length;const d=i.length-1;for(let v=0;v<i.length;v+=1){u.set(new Uint8Array([32+v|(v===d?128:0),0,i[v].length]),l),l+=3;for(let S=0;S<i[v].length;S+=1)u.set(new Uint8Array([i[v][S].length>>8,i[v][S].length&255]),l),l+=2,u.set(i[v][S],l),l+=i[v][S].length}const f=W.box(W.types.hvcC,u),h=t.width,p=t.height,g=t.pixelRatio[0],y=t.pixelRatio[1];return W.box(W.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,y>>24,y>>16&255,y>>8&255,y&255])))}}W.types=void 0;W.HDLR_TYPES=void 0;W.STTS=void 0;W.STSC=void 0;W.STCO=void 0;W.STSZ=void 0;W.VMHD=void 0;W.SMHD=void 0;W.STSD=void 0;W.FTYP=void 0;W.DINF=void 0;const $x=9e4;function Gh(r,t,e=1,i=!1){const s=r*t*e;return i?Math.round(s):s}function fw(r,t,e=1,i=!1){return Gh(r,t,1/e,i)}function Ya(r,t=!1){return Gh(r,1e3,1/$x,t)}function dw(r,t=1){return Gh(r,$x,1/t)}function fv(r){const{baseTime:t,timescale:e,trackId:i}=r;return`${t/e} (${t}/${e}) trackId: ${i}`}const hw=10*1e3,mw=1024,pw=1152,gw=1536;let Fr=null,Sd=null;function dv(r,t,e,i){return{duration:t,size:e,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:r?2:1,isNonSync:r?0:1}}}class eu extends wi{constructor(t,e,i,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,Fr===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Fr=l?parseInt(l[1]):0}if(Sd===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);Sd=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){const e=this._initPTS;(!e||!t||t.trackId!==e.trackId||t.baseTime!==e.baseTime||t.timescale!==e.timescale)&&this.log(`Reset initPTS: ${e&&fv(e)} > ${t&&fv(t)}`),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t[0].pts,s=t.reduce((a,l)=>{let u=l.pts,d=u-a;return d<-4294967296&&(e=!0,u=di(u,i),d=u-a),d>0?a:u},i);return e&&this.debug("PTS rollover detected"),s}remux(t,e,i,s,a,l,u,d){let f,h,p,g,y,v,S=a,T=a;const A=t.pid>-1,b=e.pid>-1,R=e.samples.length,C=t.samples.length>0,D=u&&R>0||R>1;if((!A||C)&&(!b||D)||this.ISGenerated||u){if(this.ISGenerated){var w,P,B,M;const G=this.videoTrackConfig;(G&&(e.width!==G.width||e.height!==G.height||((w=e.pixelRatio)==null?void 0:w[0])!==((P=G.pixelRatio)==null?void 0:P[0])||((B=e.pixelRatio)==null?void 0:B[1])!==((M=G.pixelRatio)==null?void 0:M[1]))||!G&&D||this.nextAudioTs===null&&C)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(t,e,a,l));const K=this.isVideoContiguous;let tt=-1,z;if(D&&(tt=yw(e.samples),!K&&this.config.forceKeyFrameOnDiscontinuity))if(v=!0,tt>0){this.warn(`Dropped ${tt} out of ${R} video samples due to a missing keyframe`);const G=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(tt),e.dropped+=tt,T+=(e.samples[0].pts-G)/e.inputTimeScale,z=T}else tt===-1&&(this.warn(`No keyframe found out of ${R} video samples`),v=!1);if(this.ISGenerated){if(C&&D){const G=this.getVideoStartPts(e.samples),O=(di(t.samples[0].pts,G)-G)/e.inputTimeScale;S+=Math.max(0,O),T+=Math.max(0,-O)}if(C){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(t,e,a,l)),h=this.remuxAudio(t,S,this.isAudioContiguous,l,b||D||d===mt.AUDIO?T:void 0),D){const G=h?h.endPTS-h.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(t,e,a,l)),f=this.remuxVideo(e,T,K,G)}}else D&&(f=this.remuxVideo(e,T,K,0));f&&(f.firstKeyFrame=tt,f.independent=tt!==-1,f.firstKeyFramePTS=z)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(y=jx(i,a,this._initPTS,this._initDTS)),s.samples.length&&(g=Gx(s,a,this._initPTS))),{audio:h,video:f,initSegment:p,independent:v,text:g,id3:y}}computeInitPts(t,e,i,s){const a=Math.round(i*e);let l=di(t,a);if(l<a+e)for(this.log(`Adjusting PTS for rollover in timeline near ${(a-l)/e} ${s}`);l<a+e;)l+=8589934592;return l-a}generateIS(t,e,i,s){const a=t.samples,l=e.samples,u=this.typeSupported,d={},f=this._initPTS;let h=!f||s,p="audio/mp4",g,y,v,S=-1;if(h&&(g=y=1/0),t.config&&a.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":u.mpeg?(p="audio/mpeg",t.codec=""):u.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}d.audio={id:"audio",container:p,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):W.initSegment([t]),metadata:{channelCount:t.channelCount}},h&&(S=t.id,v=t.inputTimeScale,!f||v!==f.timescale?g=y=this.computeInitPts(a[0].pts,v,i,"audio"):h=!1)}if(e.sps&&e.pps&&l.length){if(e.timescale=e.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:W.initSegment([e]),metadata:{width:e.width,height:e.height}},h)if(S=e.id,v=e.inputTimeScale,!f||v!==f.timescale){const T=this.getVideoStartPts(l),A=di(l[0].dts,T),b=this.computeInitPts(A,v,i,"video"),R=this.computeInitPts(T,v,i,"video");y=Math.min(y,b),g=Math.min(g,R)}else h=!1;this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,h?(f&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${i} ${g/v} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${g/v} (${g}/${v}) trackId: ${S}`),this._initPTS={baseTime:g,timescale:v,trackId:S},this._initDTS={baseTime:y,timescale:v,trackId:S}):g=v=void 0,{tracks:d,initPTS:g,timescale:v,trackId:S}}remuxVideo(t,e,i,s){const a=t.inputTimeScale,l=t.samples,u=[],d=l.length,f=this._initPTS,h=f.baseTime*a/f.timescale;let p=this.nextVideoTs,g=8,y=this.videoSampleDuration,v,S,T=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,b=!1;if(!i||p===null){const k=h+e*a,$=l[0].pts-di(l[0].dts,l[0].pts);Fr&&p!==null&&Math.abs(k-$-(p+h))<15e3?i=!0:p=k-$-h}const R=p+h;for(let k=0;k<d;k++){const $=l[k];$.pts=di($.pts,R),$.dts=di($.dts,R),$.dts<l[k>0?k-1:k].dts&&(b=!0)}b&&l.sort(function(k,$){const st=k.dts-$.dts,ct=k.pts-$.pts;return st||ct}),v=l[0].dts,S=l[l.length-1].dts;const C=S-v,D=C?Math.round(C/(d-1)):y||t.inputTimeScale/30;if(i){const k=v-R,$=k>D,st=k<-1;if(($||st)&&($?this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Ya(k,!0)} ms (${k}dts) hole between fragments detected at ${e.toFixed(3)}`):this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${Ya(-k,!0)} ms (${k}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!st||R>=l[0].pts||Fr)){v=R;const ct=l[0].pts-k;if($)l[0].dts=v,l[0].pts=ct;else{let ft=!0;for(let dt=0;dt<l.length&&!(l[dt].dts>ct&&ft);dt++){const Et=l[dt].pts;if(l[dt].dts-=k,l[dt].pts-=k,dt<l.length-1){const Lt=l[dt+1].pts,_t=l[dt].pts,ee=Lt<=_t,he=Lt<=Et;ft=ee==he}}}this.log(`Video: Initial PTS/DTS adjusted: ${Ya(ct,!0)}/${Ya(v,!0)}, delta: ${Ya(k,!0)} ms`)}}v=Math.max(0,v);let N=0,w=0,P=v;for(let k=0;k<d;k++){const $=l[k],st=$.units,ct=st.length;let ft=0;for(let dt=0;dt<ct;dt++)ft+=st[dt].data.length;w+=ft,N+=ct,$.length=ft,$.dts<P?($.dts=P,P+=D/4|0||1):P=$.dts,T=Math.min($.pts,T),A=Math.max($.pts,A)}S=l[d-1].dts;const B=w+4*N+8;let M;try{M=new Uint8Array(B)}catch(k){this.observer.emit(_.ERROR,_.ERROR,{type:vt.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:B,reason:`fail allocating video mdat ${B}`});return}const K=new DataView(M.buffer);K.setUint32(0,B),M.set(W.types.mdat,4);let tt=!1,z=Number.POSITIVE_INFINITY,G=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let k=0;k<d;k++){const $=l[k],st=$.units;let ct=0;for(let Et=0,Lt=st.length;Et<Lt;Et++){const _t=st[Et],ee=_t.data,he=_t.data.byteLength;K.setUint32(g,he),g+=4,M.set(ee,g),g+=he,ct+=4+he}let ft;if(k<d-1)y=l[k+1].dts-$.dts,ft=l[k+1].pts-$.pts;else{const Et=this.config,Lt=k>0?$.dts-l[k-1].dts:D;if(ft=k>0?$.pts-l[k-1].pts:D,Et.stretchShortVideoTrack&&this.nextAudioTs!==null){const _t=Math.floor(Et.maxBufferHole*a),ee=(s?T+s*a:this.nextAudioTs+h)-$.pts;ee>_t?(y=ee-Lt,y<0?y=Lt:tt=!0,this.log(`It is approximately ${ee/90} ms to the next segment; using duration ${y/90} ms for the last video frame.`)):y=Lt}else y=Lt}const dt=Math.round($.pts-$.dts);z=Math.min(z,y),Y=Math.max(Y,y),G=Math.min(G,ft),O=Math.max(O,ft),u.push(dv($.key,y,ct,dt))}if(u.length){if(Fr){if(Fr<70){const k=u[0].flags;k.dependsOn=2,k.isNonSync=0}}else if(Sd&&O-G<Y-z&&D/Y<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let k=v;for(let $=0,st=u.length;$<st;$++){const ct=k+u[$].duration,ft=k+u[$].cts;if($<st-1){const dt=ct+u[$+1].cts;u[$].duration=dt-ft}else u[$].duration=$?u[$-1].duration:D;u[$].cts=0,k=ct}}}y=tt||!y?D:y;const j=S+y;this.nextVideoTs=p=j-h,this.videoSampleDuration=y,this.isVideoContiguous=!0;const ut={data1:W.moof(t.sequenceNumber++,v,Xt(t,{samples:u})),data2:M,startPTS:(T-h)/a,endPTS:(A+y-h)/a,startDTS:(v-h)/a,endDTS:p/a,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:t.dropped};return t.samples=[],t.dropped=0,ut}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return pw;case"ac3":return gw;default:return mw}}remuxAudio(t,e,i,s,a){const l=t.inputTimeScale,u=t.samplerate?t.samplerate:l,d=l/u,f=this.getSamplesPerFrame(t),h=f*d,p=this._initPTS,g=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,y=[],v=a!==void 0;let S=t.samples,T=g?0:8,A=this.nextAudioTs||-1;const b=p.baseTime*l/p.timescale,R=b+e*l;if(this.isAudioContiguous=i=i||S.length&&A>0&&(s&&Math.abs(R-(A+b))<9e3||Math.abs(di(S[0].pts,R)-(A+b))<20*h),S.forEach(function(O){O.pts=di(O.pts,R)}),!i||A<0){const O=S.length;if(S=S.filter(j=>j.pts>=0),O!==S.length&&this.warn(`Removed ${S.length-O} of ${O} samples (initPTS ${b} / ${l})`),!S.length)return;a===0?A=0:s&&!v?A=Math.max(0,R-b):A=S[0].pts-b}if(t.segmentCodec==="aac"){const O=this.config.maxAudioFramesDrift;for(let j=0,V=A+b;j<S.length;j++){const nt=S[j],ut=nt.pts,k=ut-V,$=Math.abs(1e3*k/l);if(k<=-O*h&&v)j===0&&(this.warn(`Audio frame @ ${(ut/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*k/l)} ms.`),this.nextAudioTs=A=ut-b,V=ut);else if(k>=O*h&&$<hw&&v){let st=Math.round(k/h);for(V=ut-st*h;V<0&&st&&h;)st--,V+=h;j===0&&(this.nextAudioTs=A=V-b),this.warn(`Injecting ${st} audio frames @ ${((V-b)/l).toFixed(3)}s due to ${Math.round(1e3*k/l)} ms gap.`);for(let ct=0;ct<st;ct++){let ft=cw.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);ft||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ft=nt.unit.subarray()),S.splice(j,0,{unit:ft,pts:V}),V+=h,j++}}nt.pts=V,V+=h}}let C=null,D=null,N,w=0,P=S.length;for(;P--;)w+=S[P].unit.byteLength;for(let O=0,j=S.length;O<j;O++){const V=S[O],nt=V.unit;let ut=V.pts;if(D!==null){const $=y[O-1];$.duration=Math.round((ut-D)/d)}else if(i&&t.segmentCodec==="aac"&&(ut=A+b),C=ut,w>0){w+=T;try{N=new Uint8Array(w)}catch($){this.observer.emit(_.ERROR,_.ERROR,{type:vt.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:w,reason:`fail allocating audio mdat ${w}`});return}g||(new DataView(N.buffer).setUint32(0,w),N.set(W.types.mdat,4))}else return;N.set(nt,T);const k=nt.byteLength;T+=k,y.push(dv(!0,f,k,0)),D=ut}const B=y.length;if(!B)return;const M=y[y.length-1];A=D-b,this.nextAudioTs=A+d*M.duration;const K=g?new Uint8Array(0):W.moof(t.sequenceNumber++,C/d,Xt({},t,{samples:y}));t.samples=[];const tt=(C-b)/l,z=A/l,Y={data1:K,data2:N,startPTS:tt,endPTS:z,startDTS:tt,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,Y}}function di(r,t){let e;if(t===null)return r;for(t<r?e=-8589934592:e=8589934592;Math.abs(r-t)>4294967296;)r+=e;return r}function yw(r){for(let t=0;t<r.length;t++)if(r[t].key)return t;return-1}function jx(r,t,e,i){const s=r.samples.length;if(!s)return;const a=r.inputTimeScale;for(let u=0;u<s;u++){const d=r.samples[u];d.pts=di(d.pts-e.baseTime*a/e.timescale,t*a)/a,d.dts=di(d.dts-i.baseTime*a/i.timescale,t*a)/a}const l=r.samples;return r.samples=[],{samples:l}}function Gx(r,t,e){const i=r.samples.length;if(!i)return;const s=r.inputTimeScale;for(let l=0;l<i;l++){const u=r.samples[l];u.pts=di(u.pts-e.baseTime*s/e.timescale,t*s)/s}r.samples.sort((l,u)=>l.pts-u.pts);const a=r.samples;return r.samples=[],{samples:a}}class vw extends wi{constructor(t,e,i,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,i,s){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(t,s),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:i,videoCodec:s}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:a,video:l}=this.initData=YE(t);if(e)r_(t,e);else{const d=a||l;d!=null&&d.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${d.codec}")!`)}a&&(i=hv(a,Qt.AUDIO,this)),l&&(s=hv(l,Qt.VIDEO,this));const u={};a&&l?u.audiovideo={container:"video/mp4",codec:i+","+s,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:t,id:"main"}:a?u.audio={container:"audio/mp4",codec:i,encrypted:a.encrypted,initSegment:t,id:"audio"}:l?u.video={container:"video/mp4",codec:s,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(t,e,i,s,a,l){var u,d;let{initPTS:f,lastEndTime:h}=this;const p={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};ht(h)||(h=this.lastEndTime=a||0);const g=e.samples;if(!g.length)return p;const y={initPTS:void 0,timescale:void 0,trackId:void 0};let v=this.initData;if((u=v)!=null&&u.length||(this.generateInitSegment(g),v=this.initData),!((d=v)!=null&&d.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(y.tracks=this.initTracks,this.emitInitSegment=!1);const S=o_(g,v,this),T=v.audio?S[v.audio.id]:null,A=v.video?S[v.video.id]:null,b=$l(A,1/0),R=$l(T,1/0),C=$l(A,0,!0),D=$l(T,0,!0);let N=a,w=0;const P=T&&(!A||!f&&R<b||f&&f.trackId===v.audio.id),B=P?T:A;if(B){const V=B.timescale,nt=B.start-a*V,ut=P?v.audio.id:v.video.id;N=B.start/V,w=P?D-R:C-b,(l||!f)&&(Ew(f,N,a,w)||V!==f.timescale)&&(f&&this.warn(`Timestamps at playlist time: ${l?"":"~"}${a} ${nt/V} != initPTS: ${f.baseTime/f.timescale} (${f.baseTime}/${f.timescale}) trackId: ${f.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${N-a} (${nt}/${V}) trackId: ${ut}`),f=null,y.initPTS=nt,y.timescale=V,y.trackId=ut)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);f?(y.initPTS=f.baseTime,y.timescale=f.timescale,y.trackId=f.trackId):((!y.timescale||y.trackId===void 0||y.initPTS===void 0)&&(this.warn("Could not set initPTS"),y.initPTS=N,y.timescale=1,y.trackId=-1),this.initPTS=f={baseTime:y.initPTS,timescale:y.timescale,trackId:y.trackId});const M=N-f.baseTime/f.timescale,K=M+w;w>0?this.lastEndTime=K:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const tt=!!v.audio,z=!!v.video;let G="";tt&&(G+="audio"),z&&(G+="video");const Y=(v.audio?v.audio.encrypted:!1)||(v.video?v.video.encrypted:!1),O={data1:g,startPTS:M,startDTS:M,endPTS:K,endDTS:K,type:G,hasAudio:tt,hasVideo:z,nb:1,dropped:0,encrypted:Y};p.audio=tt&&!z?O:void 0,p.video=z?O:void 0;const j=A?.sampleCount;if(j){const V=A.keyFrameIndex,nt=V!==-1;O.nb=j,O.dropped=V===0||this.isVideoContiguous?0:nt?V:j,O.independent=nt,O.firstKeyFrame=V,nt&&A.keyFrameStart&&(O.firstKeyFramePTS=(A.keyFrameStart-f.baseTime)/f.timescale),this.isVideoContiguous||(p.independent=nt),this.isVideoContiguous||(this.isVideoContiguous=nt),O.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${V}/${j} dropped: ${O.dropped} start: ${O.firstKeyFramePTS||"NA"}`)}return p.initSegment=y,p.id3=jx(i,a,f,f),s.samples.length&&(p.text=Gx(s,a,f)),p}}function $l(r,t,e=!1){return r?.start!==void 0?(r.start+(e?r.duration:0))/r.timescale:t}function Ew(r,t,e,i){if(r===null)return!0;const s=Math.max(i,1),a=t-r.baseTime/r.timescale;return Math.abs(a-e)>s}function hv(r,t,e){const i=r.codec;return i&&i.length>4?i:t===Qt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?mu(i,!1):(e.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(e.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let Dn;try{Dn=self.performance.now.bind(self.performance)}catch{Dn=Date.now}const iu=[{demux:sw,remux:vw},{demux:cs,remux:eu},{demux:tw,remux:eu},{demux:iw,remux:eu}];iu.splice(2,0,{demux:ew,remux:eu});class mv{constructor(t,e,i,s,a,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=a,this.logger=l}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,s){const a=i.transmuxing;a.executeStart=Dn();let l=new Uint8Array(t);const{currentTransmuxState:u,transmuxConfig:d}=this;s&&(this.currentTransmuxState=s);const{contiguous:f,discontinuity:h,trackSwitch:p,accurateTimeOffset:g,timeOffset:y,initSegmentChange:v}=s||u,{audioCodec:S,videoCodec:T,defaultInitPts:A,duration:b,initSegmentData:R}=d,C=xw(l,e);if(C&&Hr(C.method)){const P=this.getDecrypter(),B=kh(C.method);if(P.isSync()){let M=P.softwareDecrypt(l,C.key.buffer,C.iv.buffer,B);if(i.part>-1){const tt=P.flush();M=tt&&tt.buffer}if(!M)return a.executeEnd=Dn(),Td(i);l=new Uint8Array(M)}else return this.asyncResult=!0,this.decryptionPromise=P.webCryptoDecrypt(l,C.key.buffer,C.iv.buffer,B).then(M=>{const K=this.push(M,null,i);return this.decryptionPromise=null,K}),this.decryptionPromise}const D=this.needsProbing(h,p);if(D){const P=this.configureTransmuxer(l);if(P)return this.logger.warn(`[transmuxer] ${P.message}`),this.observer.emit(_.ERROR,_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),a.executeEnd=Dn(),Td(i)}(h||p||v||D)&&this.resetInitSegment(R,S,T,b,e),(h||v||D)&&this.resetInitialTimestamp(A),f||this.resetContiguity();const N=this.transmux(l,C,y,g,i);this.asyncResult=oo(N);const w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,a.executeEnd=Dn(),N}flush(t){const e=t.transmuxing;e.executeStart=Dn();const{decrypter:i,currentTransmuxState:s,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(t));const l=[],{timeOffset:u}=s;if(i){const p=i.flush();p&&l.push(this.push(p.buffer,null,t))}const{demuxer:d,remuxer:f}=this;if(!d||!f){e.executeEnd=Dn();const p=[Td(t)];return this.asyncResult?Promise.resolve(p):p}const h=d.flush(u);return oo(h)?(this.asyncResult=!0,h.then(p=>(this.flushRemux(l,p,t),l))):(this.flushRemux(l,h,t),this.asyncResult?Promise.resolve(l):l)}flushRemux(t,e,i){const{audioTrack:s,videoTrack:a,id3Track:l,textTrack:u}=e,{accurateTimeOffset:d,timeOffset:f}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===mt.MAIN?"level":"track"} ${i.level}`);const h=this.remuxer.remux(s,a,l,u,f,d,!0,this.id);t.push({remuxResult:h,chunkMeta:i}),i.transmuxing.executeEnd=Dn()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;!e||!i||(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;!t||!e||(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,s,a){const{demuxer:l,remuxer:u}=this;!l||!u||(l.resetInitSegment(t,e,i,s),u.resetInitSegment(t,e,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,s,a){let l;return e&&e.method==="SAMPLE-AES"?l=this.transmuxSampleAes(t,e,i,s,a):l=this.transmuxUnencrypted(t,i,s,a),l}transmuxUnencrypted(t,e,i,s){const{audioTrack:a,videoTrack:l,id3Track:u,textTrack:d}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,l,u,d,e,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(t,e,i,s,a){return this.demuxer.demuxSampleAes(t,e,i).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,i,s,!1,this.id),chunkMeta:a}))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:s}=this;let a;for(let p=0,g=iu.length;p<g;p++){var l;if((l=iu[p].demux)!=null&&l.probe(t,this.logger)){a=iu[p];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,d=this.remuxer,f=a.remux,h=a.demux;(!d||!(d instanceof f))&&(this.remuxer=new f(i,e,s,this.logger)),(!u||!(u instanceof h))&&(this.demuxer=new h(i,e,s,this.logger),this.probe=h.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Ih(this.config)),t}}function xw(r,t){let e=null;return r.byteLength>0&&t?.key!=null&&t.iv!==null&&t.method!=null&&(e=t),e}const Td=r=>({remuxResult:{},chunkMeta:r});function oo(r){return"then"in r&&r.then instanceof Function}class Sw{constructor(t,e,i,s,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=s,this.defaultInitPts=a||null}}class Tw{constructor(t,e,i,s,a,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=a,this.initSegmentChange=l}}let pv=0;class Hx{constructor(t,e,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=pv++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const f=d.data,h=this.hls;if(!(!h||!(f!=null&&f.event)||f.instanceNo!==this.instanceNo))switch(f.event){case"init":{var p;const g=(p=this.workerContext)==null?void 0:p.objectURL;g&&self.URL.revokeObjectURL(g);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":{h.logger[f.data.logType]&&h.logger[f.data.logType](f.data.message);break}default:{f.data=f.data||{},f.data.frag=this.frag,f.data.part=this.part,f.data.id=this.id,h.trigger(f.event,f.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})};const a=t.config;this.hls=t,this.id=e,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const l=(d,f)=>{f=f||{},f.frag=this.frag||void 0,d===_.ERROR&&(f=f,f.parent=this.id,f.part=this.part,this.error=f.error),this.hls.trigger(d,f)};this.observer=new Nh,this.observer.on(_.FRAG_DECRYPTED,l),this.observer.on(_.ERROR,l);const u=Dy(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(a.workerPath||LC()){try{a.workerPath?(d.log(`loading Web Worker ${a.workerPath} for "${e}"`),this.workerContext=CC(a.workerPath)):(d.log(`injecting Web Worker for "${e}"`),this.workerContext=_C());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:e,config:Zt(a)})}catch(h){d.warn(`Error setting up "${e}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new mv(this.observer,u,a,"",e,t.logger)}return}}this.transmuxer=new mv(this.observer,u,a,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=pv++;const e=this.hls.config,i=Dy(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:Zt(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),wC(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,s,a,l,u,d,f,h){var p,g;f.transmuxing.start=self.performance.now();const{instanceNo:y,transmuxer:v}=this,S=l?l.start:a.start,T=a.decryptdata,A=this.frag,b=!(A&&a.cc===A.cc),R=!(A&&f.level===A.level),C=A?f.sn-A.sn:-1,D=this.part?f.part-this.part.index:-1,N=C===0&&f.id>1&&f.id===A?.stats.chunkCount,w=!R&&(C===1||C===0&&(D===1||N&&D<=0)),P=self.performance.now();(R||C||a.stats.parsing.start===0)&&(a.stats.parsing.start=P),l&&(D||!w)&&(l.stats.parsing.start=P);const B=!(A&&((p=a.initSegment)==null?void 0:p.url)===((g=A.initSegment)==null?void 0:g.url)),M=new Tw(b,w,d,R,S,B);if(!w||b||B){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${f.sn}${f.part>-1?" part: "+f.part:""} ${this.id===mt.MAIN?"level":"track"}: ${f.level} id: ${f.id}
        discontinuity: ${b}
        trackSwitch: ${R}
        contiguous: ${w}
        accurateTimeOffset: ${d}
        timeOffset: ${S}
        initSegmentChange: ${B}`);const K=new Sw(i,s,e,u,h);this.configureTransmuxer(K)}if(this.frag=a,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:y,cmd:"demux",data:t,decryptdata:T,chunkMeta:f,state:M},t instanceof ArrayBuffer?[t]:[]);else if(v){const K=v.push(t,T,f,M);oo(K)?K.then(tt=>{this.handleTransmuxComplete(tt)}).catch(tt=>{this.transmuxerError(tt,f,"transmuxer-interface push error")}):this.handleTransmuxComplete(K)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){const s=i.flush(t);oo(s)?s.then(a=>{this.handleFlushResult(a,t)}).catch(a=>{this.transmuxerError(a,t,"transmuxer-interface flush error")}):this.handleFlushResult(s,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}const gv=100;class bw extends Ph{constructor(t,e,i){super(t,e,i,"audio-stream-controller",mt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(_.BUFFER_RESET,this.onBufferReset,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(_.BUFFER_RESET,this.onBufferReset,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:a,trackId:l}){if(i===mt.MAIN){const u=e.cc,d=this.fragCurrent;if(this.initPTS[u]={baseTime:s,timescale:a,trackId:l},this.log(`InitPTS for cc: ${u} found from main: ${s/a} (${s}/${a}) trackId: ${l}`),this.mainAnchor=e,this.state===at.WAITING_INIT_PTS){const f=this.waitingData;(!f&&!this.loadingParts||f&&f.frag.cc!==u)&&this.syncWithAnchor(e,f?.frag)}else!this.hls.hasEnoughToStart&&d&&d.cc!==u?(d.abortRequests(),this.syncWithAnchor(e,d)):this.state===at.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var i;const s=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(e&&s?.cc===e.cc)return;const a=(s||t).cc,l=this.getLevelDetails(),u=this.getLoadPosition(),d=rx(l,a,u);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===at.IDLE&&this.doTickIdle())}startLoad(t,e){if(!this.levels){this.startPosition=t,this.state=at.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(gv),i>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=at.IDLE):this.state=at.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case at.IDLE:this.doTickIdle();break;case at.WAITING_TRACK:{const{levels:t,trackId:e}=this,i=t?.[e],s=i?.details;if(s&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(s))break;this.state=at.WAITING_INIT_PTS}break}case at.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case at.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:e,part:i,cache:s,complete:a}=t,l=this.mainAnchor;if(this.initPTS[e.cc]!==void 0){this.waitingData=null,this.state=at.FRAG_LOADING;const u=s.flush().buffer,d={frag:e,part:i,payload:u,networkDetails:null};this._handleFragmentLoadProgress(d),a&&super._handleFragmentLoadComplete(d)}else l&&l.cc!==t.frag.cc&&this.syncWithAnchor(l,t.frag)}else this.state=at.IDLE}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;t!=null&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:i,media:s,trackId:a}=this,l=e.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(i!=null&&i[a]))return;const u=i[a],d=u.details;if(!d||this.waitForLive(u)||this.waitForCdnTuneIn(d)){this.state=at.WAITING_TRACK,this.startFragRequested=!1;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,Qt.AUDIO,mt.AUDIO));const h=this.getFwdBufferInfo(f,mt.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,d)){e.trigger(_.BUFFER_EOS,{type:"audio"}),this.state=at.ENDED;return}const p=h.len,g=e.maxBufferLength,y=d.fragments,v=y[0].start,S=this.getLoadPosition(),T=this.flushing?S:h.end;if(this.switchingTrack&&s){const R=S;d.PTSKnown&&R<v&&(h.end>v||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=v+.05)}if(p>=g&&!this.switchingTrack&&T<y[y.length-1].start)return;let A=this.getNextFragment(T,d);if(A&&this.isLoopLoading(A,T)&&(A=this.getNextFragmentLoopLoading(A,d,h,mt.MAIN,g)),!A){this.bufferFlushed=!0;return}let b=((t=this.mainFragLoading)==null?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&xe(A)&&!A.endList&&(!d.live||!this.loadingParts&&T<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===Ae.OK&&(this.mainFragLoading=b=null),b&&xe(b))){if(A.start>b.end){const C=this.fragmentTracker.getFragAtPos(T,mt.MAIN);C&&C.end>b.end&&(b=C,this.mainFragLoading={frag:C,targetBufferTime:null})}if(A.start>b.end)return}this.loadFragment(A,u,T)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(i=>new so(i))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==at.STOPPED&&(this.setInterval(gv),this.state=at.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(_.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;const{levels:s}=this,{details:a,id:l,groupId:u,track:d}=e;if(!s){this.warn(`Audio tracks reset while loading track ${l} "${d.name}" of "${u}"`);return}const f=this.mainDetails;if(!f||a.endCC>f.endCC||f.expired){this.cachedTrackLoadedData=e,this.state!==at.STOPPED&&(this.state=at.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${d.name}" of "${u}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const h=s[l];let p=0;if(a.live||(i=h.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(h.details){var g;p=this.alignPlaylists(a,h.details,(g=this.levelLastLoaded)==null?void 0:g.details)}a.alignedSliding||(bx(a,f),a.alignedSliding||Su(a,f),p=a.fragmentStart)}h.details=a,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(f,p),this.hls.trigger(_.AUDIO_TRACK_UPDATED,{details:a,id:l,groupId:e.groupId}),this.state===at.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=at.IDLE),this.tick()}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:s,payload:a}=t,{config:l,trackId:u,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const f=d[u];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const h=f.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const p=l.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let g=this.transmuxer;g||(g=this.transmuxer=new Hx(this.hls,mt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const y=this.initPTS[i.cc],v=(e=i.initSegment)==null?void 0:e.data;if(y!==void 0){const T=s?s.index:-1,A=T!==-1,b=new Oh(i.level,i.sn,i.stats.chunkCount,a.byteLength,T,A);g.push(a,v,p,"",i,s,h.totalduration,!1,b,y)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${h.startSN} ,${h.endSN}],track ${u}`);const{cache:S}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new Ax,complete:!1};S.push(new Uint8Array(a)),this.state!==at.STOPPED&&(this.state=at.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===mt.MAIN&&xe(e.frag)&&(this.mainFragLoading=e,this.state===at.IDLE&&this.tick())}onFragBuffered(t,e){const{frag:i,part:s}=e;if(i.type!==mt.AUDIO){!this.audioOnly&&i.type===mt.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(xe(i)){this.fragPrevious=i;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(_.AUDIO_TRACK_SWITCHED,zt({},a)))}this.fragBufferedComplete(i,s),this.media&&this.tick()}onError(t,e){var i;if(e.fatal){this.state=at.ERROR;return}switch(e.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.AUDIO,e);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===at.WAITING_TRACK&&((i=e.context)==null?void 0:i.type)===It.AUDIO_TRACK&&(this.state=at.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onBufferFlushing(t,{type:e}){e!==Qt.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==Qt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===at.ENDED&&(this.state=at.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,e,mt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:s}=this,{remuxResult:a,chunkMeta:l}=t,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:d,part:f,level:h}=u,{details:p}=h,{audio:g,text:y,id3:v,initSegment:S}=a;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=at.PARSING,this.switchingTrack&&g&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const T=d.initSegment||d;if(this.unhandledEncryptionError(S,d))return;this._bufferInitSegment(h,S.tracks,T,l),s.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:i,tracks:S.tracks})}if(g){const{startPTS:T,endPTS:A,startDTS:b,endDTS:R}=g;f&&(f.elementaryStreams[Qt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:R}),d.setElementaryStreamInfo(Qt.AUDIO,T,A,b,R),this.bufferFragmentData(g,d,f,l)}if(v!=null&&(e=v.samples)!=null&&e.length){const T=Xt({id:i,frag:d,details:p},v);s.trigger(_.FRAG_PARSING_METADATA,T)}if(y){const T=Xt({id:i,frag:d,details:p},y);s.trigger(_.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(t,e,i,s){if(this.state!==at.PARSING||(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio))return;const a=e.audio;a.id=mt.AUDIO;const l=t.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${l}/${a.codec}]`),l&&l.split(",").length===1&&(a.levelCodec=l),this.hls.trigger(_.BUFFER_CODECS,e);const u=a.initSegment;if(u!=null&&u.byteLength){const d={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:u};this.hls.trigger(_.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);if(this.switchingTrack||s===Ae.NOT_LOADED||s===Ae.PARTIAL){var a;if(!xe(t))this._loadInitSegment(t,e);else if((a=e.details)!=null&&a.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=at.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==e.details.fragmentStart&&Su(e.details,l)}else super.loadFragment(t,e,i)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:i,assocLang:s,characteristics:a,audioCodec:l,channels:u}=this.bufferedTrack;js({name:e,lang:i,assocLang:s,characteristics:a,audioCodec:l,channels:u},t,Us)||(gu(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(_.AUDIO_TRACK_SWITCHED,zt({},t))}}class Hh extends wi{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const s=e?.renditionReports;if(s){let a=-1;for(let l=0;l<s.length;l++){const u=s[l];let d;try{d=new self.URL(u.URI,e.url).href}catch(f){this.warn(`Could not construct new URL for Rendition Report: ${f}`),d=u.URI||""}if(d===t){a=l;break}else d===t.substring(0,d.length)&&(a=l)}if(a!==-1){const l=s[a],u=parseInt(l["LAST-MSN"])||e.lastPartSn;let d=parseInt(l["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(e.age-e.partTarget,e.targetduration);d>=0&&h>e.partTarget&&(d+=1)}const f=i&&Iy(i);return new Oy(u,d>=0?d:void 0,f)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){const{details:s,stats:a}=e,l=self.performance.now(),u=a.loading.first?Math.max(0,l-a.loading.first):0;s.advancedDateTime=Date.now()-u;const d=this.hls.config.timelineOffset;if(d!==s.appliedTimelineOffset){const h=Math.max(d||0,0);s.appliedTimelineOffset=h,s.fragments.forEach(p=>{p.setStart(p.playlistOffset+h)})}if(s.live||i!=null&&i.live){const h="levelInfo"in e?e.levelInfo:e.track;if(s.reloaded(i),i&&s.fragments.length>0){pC(i,s,this);const b=s.playlistParsingError;if(b){this.warn(b);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var f;const{networkDetails:C}=e;R.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:b,reason:b.message,level:e.level||void 0,parent:(f=s.fragments[0])==null?void 0:f.type,networkDetails:C,stats:a});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=a.loading.start);const p=this.hls.mainForwardBufferInfo,g=p?p.end-p.len:0,y=(s.edge-g)*1e3,v=vx(s,y);if(s.requestScheduled+v<l?s.requestScheduled=l:s.requestScheduled+=v,this.log(`live playlist ${t} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let S,T,A;if(s.canBlockReload&&s.endSN&&s.advanced){const b=this.hls.config.lowLatencyMode,R=s.lastPartSn,C=s.endSN,D=s.lastPartIndex,N=D!==-1,w=R===C;N?w?(T=C+1,A=b?0:D):(T=R,A=b?D+1:s.maxPartIndex):T=C+1;const P=s.age,B=P+s.ageHeader;let M=Math.min(B-s.partTarget,s.targetduration*1.5);if(M>0){if(B>s.targetduration*3)this.log(`Playlist last advanced ${P.toFixed(2)}s ago. Omitting segment and part directives.`),T=void 0,A=void 0;else if(i!=null&&i.tuneInGoal&&B-s.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${M} with playlist age: ${s.age}`),M=0;else{const K=Math.floor(M/s.targetduration);if(T+=K,A!==void 0){const tt=Math.round(M%s.targetduration/s.partTarget);A+=tt}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${P.toFixed(2)}s goal: ${M} skip sn ${K} to part ${A}`)}s.tuneInGoal=M}if(S=this.getDeliveryDirectives(s,e.deliveryDirectives,T,A),b||!w){s.requestScheduled=l,this.loadingPlaylist(h,S);return}}else(s.canBlockReload||s.canSkipUntil)&&(S=this.getDeliveryDirectives(s,e.deliveryDirectives,T,A));S&&T!==void 0&&s.canBlockReload&&(s.requestScheduled=a.loading.first+Math.max(v-u*2,v/2)),this.scheduleLoading(h,S,s)}else this.clearTimer()}scheduleLoading(t,e,i){const s=i||t.details;if(!s){this.loadingPlaylist(t,e);return}const a=self.performance.now(),l=s.requestScheduled;if(a>=l){this.loadingPlaylist(t,e);return}const u=l-a;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),u)}getDeliveryDirectives(t,e,i,s){let a=Iy(t);return e!=null&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,s=e.part,a=Jl.No),new Oy(i,s,a)}checkRetry(t){const e=t.details,i=yu(t),s=t.errorAction,{action:a,retryCount:l=0,retryConfig:u}=s||{},d=!!s&&!!u&&(a===Fe.RetryRequest||!s.resolved&&a===Fe.SendAlternateToPenaltyBox);if(d){var f;if(l>=u.maxNumRetry)return!1;if(i&&(f=t.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const h=Dh(u,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${e}" in ${h}ms`)}t.levelRetry=!0,s.resolved=!0}return d}}function zx(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(!lo(r[e].attrs,t[e].attrs))return!1;return!0}function lo(r,t,e){const i=r["STABLE-RENDITION-ID"];return i&&!e?i===t["STABLE-RENDITION-ID"]:!(e||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>r[s]!==t[s])}function Jd(r,t){return t.label.toLowerCase()===r.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(r.lang||"").toLowerCase())}class Aw extends Hh{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(_.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:s,details:a}=e,l=this.tracksInGroup[i];if(!l||l.groupId!==s){this.warn(`Audio track with id:${i} and group:${s} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=e.details,this.log(`Audio track ${i} "${l.name}" lang:${l.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,u)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(u=>s?.indexOf(u)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(g=>!i||i.indexOf(g.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(g=>g.default)&&(this.selectDefaultTrack=!1),u.forEach((g,y)=>{g.id=y});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const d=this.hls.config.audioPreference;if(!a&&d){const g=Wi(d,u,Us);if(g>-1)a=u[g];else{const y=Wi(d,this.tracks);a=this.tracks[y]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const h={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${i?.join(",")}`),this.hls.trigger(_.AUDIO_TRACKS_UPDATED,h);const p=this.trackId;if(f!==-1&&p===-1)this.setAudioTrack(f);else if(u.length&&p===-1){var l;const g=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${u.length}`);this.warn(g.message),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:g})}}}onError(t,e){e.fatal||!e.context||e.context.type===It.AUDIO_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&js(t,s,Us))return s;const a=Wi(t,this.tracksInGroup,Us);if(a>-1){const l=this.tracksInGroup[a];return this.setAudioTrack(a),l}else if(s){let l=e.loadLevel;l===-1&&(l=e.firstAutoLevel);const u=N_(t,e.levels,i,l,Us);if(u===-1)return null;e.nextLoadLevel=u}if(t.channels||t.audioCodec){const l=Wi(t,i);if(l>-1)return i[l]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length){this.warn(`Invalid audio track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t],a=s.details&&!s.details.live;if(t===this.trackId&&s===i&&a||(this.log(`Switching to audio-track ${t} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=t,this.currentTrack=s,this.hls.trigger(_.AUDIO_TRACK_SWITCHING,zt({},s)),a))return;const l=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(l)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const s=e[i];if(!(this.selectDefaultTrack&&!s.default)&&(!t||js(t,s,Us)))return i}if(t){const{name:i,lang:s,assocLang:a,characteristics:l,audioCodec:u,channels:d}=t;for(let f=0;f<e.length;f++){const h=e[f];if(js({name:i,lang:s,assocLang:a,characteristics:l,audioCodec:u,channels:d},h,Us))return f}for(let f=0;f<e.length;f++){const h=e[f];if(lo(t.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<e.length;f++){const h=e[f];if(lo(t.attrs,h.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&gu(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,s=t.groupId,a=this.getUrlWithDirectives(t.url,e),l=t.details,u=l?.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(_.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:e||null,track:t})}}class Rw{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(this.queues===null||this.tracks===null)return;const s=this.queues[e];s.push(t),s.length===1&&!i&&this.executeNext(e)}appendBlocker(t){return new Promise(e=>{const i={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,t)})}prependBlocker(t){return new Promise(e=>{if(this.queues){const i={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;const i=(e=t[0])==null?void 0:e.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(t[0].execute(),t.splice(0,1))})}unblockAudio(t){if(this.queues===null)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(this.queues===null||this.tracks===null)return;const e=this.queues[t];if(e.length){const s=e[0];try{s.execute()}catch(a){var i;if(s.onError(a),this.queues===null||this.tracks===null)return;const l=(i=this.tracks[t])==null?void 0:i.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues!==null&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return((e=this.queues)==null?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return t===null||e===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(t){var e,i;return(e=this.queues)!=null&&e[t]||(i=this.tracks)!=null&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const i=(e=this.tracks)==null?void 0:e[t],s=i?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return((e=this.queues)==null?void 0:e[t].map(i=>i.label).join(", "))||""}}const yv=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Vx="HlsJsTrackRemovedError";class Lw extends Error{constructor(t){super(t),this.name=Vx}}class _w extends wi{constructor(t,e){super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:s,mediaSource:a}=this;i&&this.log("Media source opened"),!(!s||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(_.MEDIA_ATTACHED,{media:s,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:s}=this;i!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${i})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=XL(hs(t.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.BUFFER_RESET,this.onBufferReset,this),t.on(_.BUFFER_APPENDING,this.onBufferAppending,this),t.on(_.BUFFER_CODECS,this.onBufferCodecs,this),t.on(_.BUFFER_EOS,this.onBufferEos,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.FRAG_PARSED,this.onFragParsed,this),t.on(_.FRAG_CHANGED,this.onFragChanged,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.BUFFER_RESET,this.onBufferReset,this),t.off(_.BUFFER_APPENDING,this.onBufferAppending,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.BUFFER_EOS,this.onBufferEos,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.FRAG_PARSED,this.onFragParsed,this),t.off(_.FRAG_CHANGED,this.onFragChanged,this),t.off(_.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const i={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const l=this.isQueued();(a||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===e?Xt(i,s.tracks):this.sourceBuffers.forEach(a=>{const[l]=a;l&&(i[l]=Xt({},this.tracks[l]),this.removeBuffer(l)),a[0]=a[1]=null}),{media:t,mediaSource:e,tracks:i}}initTracks(){const t={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=t,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let s=2;(e.audio&&!e.video||!e.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(t,e){const i=this.media=e.media;this.transferData=this.overrides=void 0;const s=hs(this.appendSource);if(s){const a=!!e.mediaSource;(a||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const l=this.mediaSource=e.mediaSource||new s;if(this.assignMediaSource(l),a)this._objectUrl=i.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{i.removeAttribute("src");const d=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||d&&l instanceof d,vv(i),Cw(i,u),i.load()}catch{i.src=u}else i.src=u}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${((e=this.transferData)==null?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${(i=t.constructor)==null?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const i=this.tracks,s=e.tracks,a=s?Object.keys(s):null,l=a?a.length:0,u=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&a&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Zt(i,(d,f)=>d==="initSegment"?void 0:f)};
transfer tracks: ${Zt(s,(d,f)=>d==="initSegment"?void 0:f)}}`),!jE(s,i)){e.mediaSource=null,e.tracks=void 0;const d=t.currentTime,f=this.details,h=Math.max(d,f?.fragments[0].start||0);if(h-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(i)}") start time: ${h} currentTime: ${d}`),this.onMediaDetaching(_.MEDIA_DETACHING,{}),this.onMediaAttaching(_.MEDIA_ATTACHING,e),t.currentTime=h;return}this.transferData=void 0,a.forEach(d=>{const f=d,h=s[f];if(h){const p=h.buffer;if(p){const g=this.fragmentTracker,y=h.id;if(g.hasFragments(y)||g.hasParts(y)){const T=At.getBuffered(p);g.detectEvictedFragments(f,T,y,null,!0)}const v=bd(f),S=[f,p];this.sourceBuffers[v]=S,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(f),this.trackSourceBuffer(f,h)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var t;const e=(t=this.mediaSource)==null?void 0:t.readyState;return e==="open"||e==="ended"}onMediaDetaching(t,e){const i=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:a,_objectUrl:l}=this;if(a){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=a.readyState==="open";try{const d=a.sourceBuffers;for(let f=d.length;f--;)u&&d[f].abort(),a.removeSourceBuffer(d[f]);u&&a.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),i||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(s.removeAttribute("src"),this.appendSource&&vv(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(_.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(([t])=>{t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(t){var e;const i=(e=this.tracks[t])==null?void 0:e.buffer;if(this.removeBuffer(t),i)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${t}`,a)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[bd(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Rw(this.tracks)}onBufferCodecs(t,e){var i;const s=this.tracks,a=Object.keys(e);this.log(`BUFFER_CODECS: "${a}" (current SB count ${this.sourceBufferCount})`);const l="audiovideo"in e&&(s.audio||s.video)||s.audiovideo&&("audio"in e||"video"in e),u=!l&&this.sourceBufferCount&&this.media&&a.some(d=>!s[d]);if(l||u){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${a}" SourceBuffers`);return}a.forEach(d=>{var f,h;const p=e[d],{id:g,codec:y,levelCodec:v,container:S,metadata:T,supplemental:A}=p;let b=s[d];const R=(f=this.transferData)==null||(f=f.tracks)==null?void 0:f[d],C=R!=null&&R.buffer?R:b,D=C?.pendingCodec||C?.codec,N=C?.levelCodec;b||(b=s[d]={buffer:void 0,listeners:[],codec:y,supplemental:A,container:S,levelCodec:v,metadata:T,id:g});const w=Zl(D,N),P=w?.replace(yv,"$1");let B=Zl(y,v);const M=(h=B)==null?void 0:h.replace(yv,"$1");B&&w&&P!==M&&(d.slice(0,5)==="audio"&&(B=mu(B,this.appendSource)),this.log(`switching codec ${D} to ${B}`),B!==(b.pendingCodec||b.codec)&&(b.pendingCodec=B),b.container=S,this.appendChangeType(d,S,B))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!e.video&&((i=e.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{const i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t},{})}appendChangeType(t,e,i){const s=`${e};codecs=${i}`,a={label:`change-type=${s}`,execute:()=>{const l=this.tracks[t];if(l){const u=l.buffer;u!=null&&u.changeType&&(this.log(`changing ${t} sourceBuffer type to ${s}`),u.changeType(s),l.codec=i,l.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${t} SourceBuffer type`,l)}};this.append(a,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const i=t.start,s=i+t.duration*.05;if(((e=this.fragmentTracker.getAppendedFrag(i,mt.MAIN))==null?void 0:e.gap)===!0)return;const l={label:"block-audio",execute:()=>{var u;const d=this.tracks.video;(this.lastVideoAppendEnd>s||d!=null&&d.buffer&&At.isBuffered(d.buffer,s)||((u=this.fragmentTracker.getAppendedFrag(s,mt.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:l,frag:t},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:i}=this,{data:s,type:a,parent:l,frag:u,part:d,chunkMeta:f,offset:h}=e,p=f.buffering[a],{sn:g,cc:y}=u,v=self.performance.now();p.start=v;const S=u.stats.buffering,T=d?d.stats.buffering:null;S.start===0&&(S.start=v),T&&T.start===0&&(T.start=v);const A=i.audio;let b=!1;a==="audio"&&A?.container==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||f.id===1||this.lastMpegAudioChunk.sn!==f.sn,this.lastMpegAudioChunk=f);const R=i.video,C=R?.buffer;if(C&&g!=="initSegment"){const w=d||u,P=this.blockedAudioAppend;if(a==="audio"&&l!=="main"&&!this.blockedAudioAppend&&!(R.ending||R.ended)){const M=w.start+w.duration*.05,K=C.buffered,tt=this.currentOp("video");!K.length&&!tt?this.blockAudio(w):!tt&&!At.isBuffered(C,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(w)}else if(a==="video"){const B=w.end;if(P){const M=P.frag.start;(B>M||B<this.lastVideoAppendEnd||At.isBuffered(C,M))&&this.unblockAudio()}this.lastVideoAppendEnd=B}}const D=(d||u).start,N={label:`append-${a}`,execute:()=>{var w;p.executeStart=self.performance.now();const P=(w=this.tracks[a])==null?void 0:w.buffer;P&&(b?this.updateTimestampOffset(P,D,.1,a,g,y):h!==void 0&&ht(h)&&this.updateTimestampOffset(P,h,1e-6,a,g,y)),this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const w=self.performance.now();p.executeEnd=p.end=w,S.first===0&&(S.first=w),T&&T.first===0&&(T.first=w);const P={};this.sourceBuffers.forEach(([B,M])=>{B&&(P[B]=At.getBuffered(M))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(_.BUFFER_APPENDED,{type:a,frag:u,part:d,chunkMeta:f,parent:u.type,timeRanges:P})},onError:w=>{var P;const B={type:vt.MEDIA_ERROR,parent:u.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:u,part:d,chunkMeta:f,error:w,err:w,fatal:!1},M=(P=this.media)==null?void 0:P.error;if(w.code===DOMException.QUOTA_EXCEEDED_ERR||w.name=="QuotaExceededError"||"quota"in w)B.details=Q.BUFFER_FULL_ERROR;else if(w.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)B.errorAction=Gr(!0);else if(w.name===Vx&&this.sourceBufferCount===0)B.errorAction=Gr(!0);else{const K=++this.appendErrors[a];this.warn(`Failed ${K}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${M||"no media error"})`),(K>=this.hls.config.appendErrorMaxRetry||M)&&(B.fatal=!0)}this.hls.trigger(_.ERROR,B)}};this.log(`queuing "${a}" append sn: ${g}${d?" p: "+d.index:""} of ${u.type===mt.MAIN?"level":"track"} ${u.level} cc: ${y}`),this.append(N,a,this.isPending(this.tracks[a]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(_.BUFFER_FLUSHED,{type:t})},onError:s=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,s)}}}onBufferFlushing(t,e){const{type:i,startOffset:s,endOffset:a}=e;i?this.append(this.getFlushOp(i,s,a),i):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,s,a),l)})}onFragParsed(t,e){const{frag:i,part:s}=e,a=[],l=s?s.elementaryStreams:i.elementaryStreams;l[Qt.AUDIOVIDEO]?a.push("audiovideo"):(l[Qt.AUDIO]&&a.push("audio"),l[Qt.VIDEO]&&a.push("video"));const u=()=>{const d=self.performance.now();i.stats.buffering.end=d,s&&(s.stats.buffering.end=d);const f=s?s.stats:i.stats;this.hls.trigger(_.FRAG_BUFFERED,{frag:i,part:s,stats:f,id:i.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(u,a).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([t])=>{if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1})}onBufferEos(t,e){var i;this.sourceBuffers.forEach(([l])=>{if(l){const u=this.tracks[l];(!e.type||e.type===l)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${l} buffer reached EOS`)))}});const s=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var u;return l&&!((u=this.tracks[l])!=null&&u.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(_.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(_.BUFFERED_TO_END,void 0)):e.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([t])=>{if(t!==null){const e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)})}onError(t,e){if(e.details===Q.BUFFER_APPEND_ERROR&&e.frag){var i;const s=(i=e.errorAction)==null?void 0:i.nextAutoLevel;ht(s)&&s!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||e===null||!this.sourceBufferCount)return;const s=t.config,a=i.currentTime,l=e.levelTargetDuration,u=e.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(ht(u)&&u>=0){const f=Math.max(u,l),h=Math.floor(a/l)*l-f;this.flushBackBuffer(a,l,h)}const d=s.frontBufferFlushThreshold;if(ht(d)&&d>0){const f=Math.max(s.maxBufferLength,d),h=Math.max(f,l),p=Math.floor(a/l)*l+h;this.flushFrontBuffer(a,l,p)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach(([s,a])=>{if(a){const u=At.getBuffered(a);if(u.length>0&&i>u.start(0)){var l;this.hls.trigger(_.BACK_BUFFER_REACHED,{bufferEnd:i});const d=this.tracks[s];if((l=this.details)!=null&&l.live)this.hls.trigger(_.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(d!=null&&d.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:s})}}})}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach(([s,a])=>{if(a){const l=At.getBuffered(a),u=l.length;if(u<2)return;const d=l.start(u-1),f=l.end(u-1);if(i>d||t>=d&&t<=f)return;this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:s})}})}getDurationAndRange(){var t;const{details:e,mediaSource:i}=this;if(!e||!this.media||i?.readyState!=="open")return null;const s=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&i.setLiveSeekableRange){const f=Math.max(0,e.fragmentStart),h=Math.max(f,s);return{duration:1/0,start:f,end:h}}return{duration:1/0}}const a=(t=this.overrides)==null?void 0:t.duration;if(a)return ht(a)?{duration:a}:null;const l=this.media.duration,u=ht(i.duration)?i.duration:0;return s>u&&s>l||!ht(l)?{duration:s}:null}updateMediaSource({duration:t,start:e,end:i}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==t&&(ht(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),s.duration=t),e!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${e}-${i}.`),s.setLiveSeekableRange(e,i)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${Zt(i)}`),this.tracksReady){var s;const a=(s=this.transferData)==null?void 0:s.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach(([e,i])=>{if(e){const s=this.tracks[e];t[e]={buffer:i,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(_.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in t){const l=a,u=t[l];if(this.isPending(u)){const d=this.getTrackCodec(u,l),f=`${u.container};codecs=${d}`;u.codec=d,this.log(`creating sourceBuffer(${f})${this.currentOp(l)?" Queued":""} ${Zt(u)}`);try{const h=i.addSourceBuffer(f),p=bd(l),g=[l,h];e[p]=g,u.buffer=h}catch(h){var s;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(l),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[l],this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:l,mimeType:f,parent:u.id});return}this.trackSourceBuffer(l,u)}}this.bufferCreated()}getTrackCodec(t,e){const i=t.supplemental;let s=t.codec;i&&(e==="video"||e==="audiovideo")&&io(i,"video")&&(s=y_(s,i));const a=Zl(s,t.levelCodec);return a?e.slice(0,5)==="audio"?mu(a,this.appendSource):a:""}trackSourceBuffer(t,e){const i=e.buffer;if(!i)return;const s=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:s,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(a,l)=>{const u=l.removedRanges;u!=null&&u.length&&this.hls.trigger(_.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var t,e;const i=((t=this.media)==null||(e=t.querySelector)==null?void 0:e.call(t,"source"))||this.media;return i?.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if(((e=this.mediaSource)==null?void 0:e.readyState)==="closed"){this.resetBuffer(t);return}const i=this.currentOp(t);i&&(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;const s=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${s}`,e),this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:s,fatal:!1});const a=this.currentOp(t);a&&a.onError(s)}updateTimestampOffset(t,e,i,s,a,l){const u=e-t.timestampOffset;Math.abs(u)>=i&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${e} (sn: ${a} cc: ${l})`),t.timestampOffset=e)}removeExecutor(t,e,i){const{media:s,mediaSource:a}=this,l=this.tracks[t],u=l?.buffer;if(!s||!a||!u){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(t);return}const d=ht(s.duration)?s.duration:1/0,f=ht(a.duration)?a.duration:1/0,h=Math.max(0,e),p=Math.min(i,d,f);p>h&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${h},${p}] from the ${t} SourceBuffer`),u.remove(h,p)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.tracks[e],s=i?.buffer;if(!s)throw new Lw(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,s.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([t,e])=>t&&e.updating)}isQueued(){return this.sourceBuffers.some(([t])=>t&&!!this.currentOp(t))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:i}=this,s=e.map(l=>this.appendBlocker(l));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(l=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(e=>{var i;const s=(i=this.tracks[e])==null?void 0:i.buffer;!s||s.updating||this.shiftAndExecuteNext(e)})}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,[e])=>t+(e?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([t])=>t).filter(t=>!!t)}addBufferListener(t,e,i){const s=this.tracks[t];if(!s)return;const a=s.buffer;if(!a)return;const l=i.bind(this,t);s.listeners.push({event:e,listener:l}),a.addEventListener(e,l)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const i=e.buffer;i&&(e.listeners.forEach(s=>{i.removeEventListener(s.event,s.listener)}),e.listeners.length=0)}}function vv(r){const t=r.querySelectorAll("source");[].slice.call(t).forEach(e=>{r.removeChild(e)})}function Cw(r,t){const e=self.document.createElement("source");e.type="video/mp4",e.src=t,r.appendChild(e)}function bd(r){return r==="audio"?1:0}class zh{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.BUFFER_CODECS,this.onBufferCodecs,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&ht(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter((s,a)=>this.isLevelAllowed(s)&&a<=t);return this.clientRect=null,zh.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,!e.width&&!e.height&&(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch{}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(i=>t.bitrate===i.bitrate&&t.width===i.width&&t.height===i.height)}static getMaxLevelByMediaSize(t,e,i){if(!(t!=null&&t.length))return-1;const s=(u,d)=>d?u.width!==d.width||u.height!==d.height:!0;let a=t.length-1;const l=Math.max(e,i);for(let u=0;u<t.length;u+=1){const d=t[u];if((d.width>=l||d.height>=l)&&s(d,t[u+1])){a=u;break}}return a}}const ww={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ei=ww,Dw={HLS:"h"},Iw=Dw;class en{constructor(t,e){Array.isArray(t)&&(t=t.map(i=>i instanceof en?i:new en(i))),this.value=t,this.params=e}}const Ow="Dict";function kw(r){return Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":typeof r=="object"?JSON.stringify(r):String(r)}function Mw(r,t,e,i){return new Error(`failed to ${r} "${kw(t)}" as ${e}`,{cause:i})}function nn(r,t,e){return Mw("serialize",r,t,e)}class Kx{constructor(t){this.description=t}}const Ev="Bare Item",Pw="Boolean";function Nw(r){if(typeof r!="boolean")throw nn(r,Pw);return r?"?1":"?0"}function Fw(r){return btoa(String.fromCharCode(...r))}const Bw="Byte Sequence";function Uw(r){if(ArrayBuffer.isView(r)===!1)throw nn(r,Bw);return`:${Fw(r)}:`}const $w="Integer";function jw(r){return r<-999999999999999||999999999999999<r}function qx(r){if(jw(r))throw nn(r,$w);return r.toString()}function Gw(r){return`@${qx(r.getTime()/1e3)}`}function Yx(r,t){if(r<0)return-Yx(-r,t);const e=Math.pow(10,t);if(Math.abs(r*e%1-.5)<Number.EPSILON){const s=Math.floor(r*e);return(s%2===0?s:s+1)/e}else return Math.round(r*e)/e}const Hw="Decimal";function zw(r){const t=Yx(r,3);if(Math.floor(Math.abs(t)).toString().length>12)throw nn(r,Hw);const e=t.toString();return e.includes(".")?e:`${e}.0`}const Vw="String",Kw=/[\x00-\x1f\x7f]+/;function qw(r){if(Kw.test(r))throw nn(r,Vw);return`"${r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Yw(r){return r.description||r.toString().slice(7,-1)}const Xw="Token";function xv(r){const t=Yw(r);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw nn(t,Xw);return t}function th(r){switch(typeof r){case"number":if(!ht(r))throw nn(r,Ev);return Number.isInteger(r)?qx(r):zw(r);case"string":return qw(r);case"symbol":return xv(r);case"boolean":return Nw(r);case"object":if(r instanceof Date)return Gw(r);if(r instanceof Uint8Array)return Uw(r);if(r instanceof Kx)return xv(r);default:throw nn(r,Ev)}}const Ww="Key";function eh(r){if(/^[a-z*][a-z0-9\-_.*]*$/.test(r)===!1)throw nn(r,Ww);return r}function Vh(r){return r==null?"":Object.entries(r).map(([t,e])=>e===!0?`;${eh(t)}`:`;${eh(t)}=${th(e)}`).join("")}function Xx(r){return r instanceof en?`${th(r.value)}${Vh(r.params)}`:th(r)}function Qw(r){return`(${r.value.map(Xx).join(" ")})${Vh(r.params)}`}function Zw(r,t={whitespace:!0}){if(typeof r!="object"||r==null)throw nn(r,Ow);const e=r instanceof Map?r.entries():Object.entries(r),i=t?.whitespace?" ":"";return Array.from(e).map(([s,a])=>{a instanceof en||(a=new en(a));let l=eh(s);return a.value===!0?l+=Vh(a.params):(l+="=",Array.isArray(a.value)?l+=Qw(a):l+=Xx(a)),l}).join(`,${i}`)}function Wx(r,t){return Zw(r,t)}const Ki="CMCD-Object",de="CMCD-Request",Fs="CMCD-Session",ls="CMCD-Status",Jw={br:Ki,ab:Ki,d:Ki,ot:Ki,tb:Ki,tpb:Ki,lb:Ki,tab:Ki,lab:Ki,url:Ki,pb:de,bl:de,tbl:de,dl:de,ltc:de,mtp:de,nor:de,nrr:de,rc:de,sn:de,sta:de,su:de,ttfb:de,ttfbb:de,ttlb:de,cmsdd:de,cmsds:de,smrt:de,df:de,cs:de,ts:de,cid:Fs,pr:Fs,sf:Fs,sid:Fs,st:Fs,v:Fs,msd:Fs,bs:ls,bsd:ls,cdn:ls,rtp:ls,bg:ls,pt:ls,ec:ls,e:ls},tD={REQUEST:de};function eD(r){return Object.keys(r).reduce((t,e)=>{var i;return(i=r[e])===null||i===void 0||i.forEach(s=>t[s]=e),t},{})}function iD(r,t){const e={};if(!r)return e;const i=Object.keys(r),s=t?eD(t):{};return i.reduce((a,l)=>{var u;const d=Jw[l]||s[l]||tD.REQUEST,f=(u=a[d])!==null&&u!==void 0?u:a[d]={};return f[l]=r[l],a},e)}function nD(r){return["ot","sf","st","e","sta"].includes(r)}function sD(r){return typeof r=="number"?ht(r):r!=null&&r!==""&&r!==!1}const Qx="event";function rD(r,t){const e=new URL(r),i=new URL(t);if(e.origin!==i.origin)return r;const s=e.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);for(;s[0]===a[0];)s.shift(),a.shift();for(;a.length;)a.shift(),s.unshift("..");return s.join("/")+e.search+e.hash}const nu=r=>Math.round(r),ih=(r,t)=>Array.isArray(r)?r.map(e=>ih(e,t)):r instanceof en&&typeof r.value=="string"?new en(ih(r.value,t),r.params):(t.baseUrl&&(r=rD(r,t.baseUrl)),t.version===1?encodeURIComponent(r):r),jl=r=>nu(r/100)*100,aD=(r,t)=>{let e=r;return t.version>=2&&(r instanceof en&&typeof r.value=="string"?e=new en([r]):typeof r=="string"&&(e=[r])),ih(e,t)},oD={br:nu,d:nu,bl:jl,dl:jl,mtp:jl,nor:aD,rtp:jl,tb:nu},Zx="request",Jx="response",Kh=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],lD=["e"],uD=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Nu(r){return uD.test(r)}function cD(r){return Kh.includes(r)||lD.includes(r)||Nu(r)}const tS=["d","dl","nor","ot","rtp","su"];function fD(r){return Kh.includes(r)||tS.includes(r)||Nu(r)}const dD=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function hD(r){return Kh.includes(r)||tS.includes(r)||dD.includes(r)||Nu(r)}const mD=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function pD(r){return mD.includes(r)||Nu(r)}const gD={[Jx]:hD,[Qx]:cD,[Zx]:fD};function eS(r,t={}){const e={};if(r==null||typeof r!="object")return e;const i=t.version||r.v||1,s=t.reportingMode||Zx,a=i===1?pD:gD[s];let l=Object.keys(r).filter(a);const u=t.filter;typeof u=="function"&&(l=l.filter(u));const d=s===Jx||s===Qx;d&&!l.includes("ts")&&l.push("ts"),i>1&&!l.includes("v")&&l.push("v");const f=Xt({},oD,t.formatters),h={version:i,reportingMode:s,baseUrl:t.baseUrl};return l.sort().forEach(p=>{let g=r[p];const y=f[p];if(typeof y=="function"&&(g=y(g,h)),p==="v"){if(i===1)return;g=i}p=="pr"&&g===1||(d&&p==="ts"&&!ht(g)&&(g=Date.now()),sD(g)&&(nD(p)&&typeof g=="string"&&(g=new Kx(g)),e[p]=g))}),e}function yD(r,t={}){const e={};if(!r)return e;const i=eS(r,t),s=iD(i,t?.customHeaderMap);return Object.entries(s).reduce((a,[l,u])=>{const d=Wx(u,{whitespace:!1});return d&&(a[l]=d),a},e)}function vD(r,t,e){return Xt(r,yD(t,e))}const ED="CMCD";function xD(r,t={}){return r?Wx(eS(r,t),{whitespace:!1}):""}function SD(r,t={}){if(!r)return"";const e=xD(r,t);return encodeURIComponent(e)}function TD(r,t={}){if(!r)return"";const e=SD(r,t);return`${ED}=${e}`}const Sv=/CMCD=[^&#]+/;function bD(r,t,e){const i=TD(t,e);if(!i)return r;if(Sv.test(r))return r.replace(Sv,i);const s=r.includes("?")?"&":"?";return`${r}${s}${i}`}class AD{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:ei.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=s=>{try{const{frag:a,part:l}=s,u=this.hls.levels[a.level],d=this.getObjectType(a),f={d:(l||a).duration*1e3,ot:d};(d===ei.VIDEO||d===ei.AUDIO||d==ei.MUXED)&&(f.br=u.bitrate/1e3,f.tb=this.getTopBandwidth(d)/1e3,f.bl=this.getBufferLength(d));const h=l?this.getNextPart(l):this.getNextFrag(a);h!=null&&h.url&&h.url!==a.url&&(f.nor=h.url),this.apply(s,f)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;i!=null&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHED,this.onMediaDetached,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHED,this.onMediaDetached,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,s;this.audioBuffer=(i=e.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(s=e.tracks.video)==null?void 0:s.buffer}createData(){var t;return{v:1,sf:Iw.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){Xt(e,this.createData());const i=e.ot===ei.INIT||e.ot===ei.VIDEO||e.ot===ei.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),e.su==null&&(e.su=this.buffering);const{includeKeys:s}=this;s&&(e=Object.keys(e).reduce((l,u)=>(s.includes(u)&&(l[u]=e[u]),l),{}));const a={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),vD(t.headers,e,a)):t.url=bD(t.url,e,a)}getNextFrag(t){var e;const i=(e=this.hls.levels[t.level])==null?void 0:e.details;if(i){const s=t.sn-i.startSN;return i.fragments[s+1]}}getNextPart(t){var e;const{index:i,fragment:s}=t,a=(e=this.hls.levels[s.level])==null||(e=e.details)==null?void 0:e.partList;if(a){const{sn:l}=s;for(let u=a.length-1;u>=0;u--){const d=a[u];if(d.index===i&&d.fragment.sn===l)return a[u+1]}}}getObjectType(t){const{type:e}=t;if(e==="subtitle")return ei.TIMED_TEXT;if(t.sn==="initSegment")return ei.INIT;if(e==="audio")return ei.AUDIO;if(e==="main")return this.hls.audioTracks.length?ei.VIDEO:ei.MUXED}getTopBandwidth(t){let e=0,i;const s=this.hls;if(t===ei.AUDIO)i=s.audioTracks;else{const a=s.maxAutoLevel,l=a>-1?a+1:s.levels.length;i=s.levels.slice(0,l)}return i.forEach(a=>{a.bitrate>e&&(e=a.bitrate)}),e>0?e:NaN}getBufferLength(t){const e=this.media,i=t===ei.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!e?NaN:At.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){e(a),this.loader.load(a,l,u)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){e(a),this.loader.load(a,l,u)}}}}const RD=3e5;class LD extends wi{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(t.indexOf(e.pathwayId)===-1&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter(i=>i!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if(i?.action===Fe.SendAlternateToPenaltyBox&&i.flags===fi.MoveAllAlternatesMatchingHost){const s=this.levels;let a=this._pathwayPriority,l=this.pathwayId;if(e.context){const{groupId:u,pathwayId:d,type:f}=e.context;u&&s?l=this.getPathwayForGroupId(u,f,l):d&&(l=d)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!a&&s&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),i.resolved=this.pathwayId!==l),e.details===Q.BUFFER_APPEND_ERROR&&!e.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${l} levels: ${s&&s.length} priorities: ${Zt(a)} penalized: ${Zt(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(e.length===0){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){this._pathwayPriority=t;let e;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach(a=>{s-i[a]>RD&&delete i[a]});for(let a=0;a<t.length;a++){const l=t[a];if(l in i)continue;if(l===this.pathwayId)return;const u=this.hls.nextLoadLevel,d=this.hls.levels[u];if(e=this.getLevelsForPathway(l),e.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,Sx(e),this.hls.trigger(_.LEVELS_UPDATED,{levels:e});const f=this.hls.levels[u];d&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(t,e,i){const s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let a=0;a<s.length;a++)if(e===It.AUDIO_TRACK&&s[a].hasAudioGroup(t)||e===It.SUBTITLE_TRACK&&s[a].hasSubtitleGroup(t))return s[a].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},s={};t.forEach(a=>{const{ID:l,"BASE-ID":u,"URI-REPLACEMENT":d}=a;if(e.some(h=>h.pathwayId===l))return;const f=this.getLevelsForPathway(u).map(h=>{const p=new se(h.attrs);p["PATHWAY-ID"]=l;const g=p.AUDIO&&`${p.AUDIO}_clone_${l}`,y=p.SUBTITLES&&`${p.SUBTITLES}_clone_${l}`;g&&(i[p.AUDIO]=g,p.AUDIO=g),y&&(s[p.SUBTITLES]=y,p.SUBTITLES=y);const v=iS(h.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),S=new so({attrs:p,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:v,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let T=1;T<h.audioGroups.length;T++)S.addGroupId("audio",`${h.audioGroups[T]}_clone_${l}`);if(h.subtitleGroups)for(let T=1;T<h.subtitleGroups.length;T++)S.addGroupId("text",`${h.subtitleGroups[T]}_clone_${l}`);return S});e.push(...f),Tv(this.audioTracks,i,d,l),Tv(this.subtitleTracks,s,d,l)})}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;this.loader&&this.loader.destroy(),this.loader=new i(e);let s;try{s=new self.URL(t)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(s.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+h)}const a={responseType:"json",url:s.href},l=e.steeringManifestLoadPolicy.default,u=l.errorRetry||l.timeoutRetry||{},d={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},f={onSuccess:(h,p,g,y)=>{this.log(`Loaded steering manifest: "${s}"`);const v=h.data;if(v?.VERSION!==1){this.log(`Steering VERSION ${v.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=v.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":A}=v;if(S)try{this.uri=new self.URL(S,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||g.url),T&&this.clonePathways(T);const b={steeringManifest:v,url:s.toString()};this.hls.trigger(_.STEERING_MANIFEST_LOADED,b),A&&this.updatePathwayPriority(A)},onError:(h,p,g,y)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${p.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let v=this.timeToLoad*1e3;if(h.code===429){const S=this.loader;if(typeof S?.getResponseHeader=="function"){const T=S.getResponseHeader("Retry-After");T&&(v=parseFloat(T)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,v)},onTimeout:(h,p,g)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(a,d,f)}scheduleRefresh(t,e=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const s=(i=this.hls)==null?void 0:i.media;if(s&&!s.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},e)}}function Tv(r,t,e,i){r&&Object.keys(t).forEach(s=>{const a=r.filter(l=>l.groupId===s).map(l=>{const u=Xt({},l);return u.details=void 0,u.attrs=new se(u.attrs),u.url=u.attrs.URI=iS(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",e),u.groupId=u.attrs["GROUP-ID"]=t[s],u.attrs["PATHWAY-ID"]=i,u});r.push(...a)})}function iS(r,t,e,i){const{HOST:s,PARAMS:a,[e]:l}=i;let u;t&&(u=l?.[t],u&&(r=u));const d=new self.URL(r);return s&&!u&&(d.host=s),a&&Object.keys(a).sort().forEach(f=>{f&&d.searchParams.set(f,a[f])}),d.href}class zr extends wi{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=zr.CDMCleanupPromise?[zr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=e=>{const{initDataType:i,initData:s}=e,a=`"${e.type}" event: init data type: "${i}"`;if(this.debug(a),s!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Xa(this.config));const u=l.map(pd).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(l=>{const u=tu(l);if(i!=="sinf"||u!==re.FAIRPLAY){this.log(`Ignoring "${e.type}" event with init data type: "${i}" for selected key-system ${u}`);return}let d;try{const y=be(new Uint8Array(s)),v=Mh(JSON.parse(y).sinf),S=WE(v);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(S.subarray(8,24))}catch(y){this.warn(`${a} Failed to parse sinf: ${y}`);return}const f=Ve(d),{keyIdToKeySessionPromise:h,mediaKeySessions:p}=this;let g=h[f];for(let y=0;y<p.length;y++){const v=p[y],S=v.decryptdata;if(!S.keyId)continue;const T=Ve(S.keyId);if(Eu(d,S.keyId)||S.uri.replace(/-/g,"").indexOf(f)!==-1){if(g=h[T],!g)continue;if(S.pssh)break;delete h[T],S.pssh=new Uint8Array(s),S.keyId=d,g=h[f]=g.then(()=>this.generateRequestWithPreferredKeySession(v,i,s,"encrypted-event-key-match")),g.catch(A=>this.handleError(A));break}}g||this.handleError(new Error(`Key ID ${f} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(l=>this.handleError(l))}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(_.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(_.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:i}=this.config,s=e?.[t];if(s)return s.licenseUrl;if(t===re.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(e===void 0)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,i=e?.[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,i=(l,u,d)=>!!l&&d.indexOf(l)===u,s=e.map(l=>l.audioCodec).filter(i),a=e.map(l=>l.videoCodec).filter(i);return s.length+a.length===0&&a.push("avc1.42e01e"),new Promise((l,u)=>{const d=f=>{const h=f.shift();this.getMediaKeysPromise(h,s,a).then(p=>l({keySystem:h,mediaKeys:p})).catch(p=>{f.length?d(f):p instanceof ci?u(p):u(new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(t)})}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${i}`;return hx===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return i(t,e)}getMediaKeysPromise(t,e,i){var s;const a=aC(t,e,i,this.config.drmSystemOptions||{});let l=this.keySystemAccessPromises[t],u=(s=l)==null?void 0:s.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${t}" key-system access with config: ${Zt(a)}`),u=this.requestMediaKeySystemAccess(t,a);const d=l=this.keySystemAccessPromises[t]={keySystemAccess:u};return u.catch(f=>{this.log(`Failed to obtain access to key-system "${t}": ${f}`)}),u.then(f=>{this.log(`Access for key-system "${f.keySystem}" obtained`);const h=this.fetchServerCertificate(t);this.log(`Create media-keys for "${t}"`);const p=d.mediaKeys=f.createMediaKeys().then(g=>(this.log(`Media-keys created for "${t}"`),d.hasMediaKeys=!0,h.then(y=>y?this.setMediaKeysServerCertificate(g,t,y):g)));return p.catch(g=>{this.error(`Failed to create media-keys for "${t}"}: ${g}`)}),p})}return u.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:i}){this.log(`Creating key-system session "${e}" keyId: ${Ve(t.keyId||[])} keyUri: ${t.uri}`);const s=i.createSession(),a={decryptdata:t,keySystem:e,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const i=this.createMediaKeySessionContext(t),s=Gl(e),a="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,a,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}updateKeySession(t,e){const i=t.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${Ve(t.decryptdata.keyId||[])}
      } (data length: ${e.byteLength})`),i.update(e)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(t=>({keySystem:t,hasMediaKeys:this.keySystemAccessPromises[t].hasMediaKeys})).filter(({hasMediaKeys:t})=>!!t).map(({keySystem:t})=>pd(t)).filter(t=>!!t)}getKeySystemAccess(t){return this.getKeySystemSelectionPromise(t).then(({keySystem:e,mediaKeys:i})=>this.attemptSetMediaKeys(e,i))}selectKeySystem(t){return new Promise((e,i)=>{this.getKeySystemSelectionPromise(t).then(({keySystem:s})=>{const a=pd(s);a?e(a):i(new Error(`Unable to find format for key-system "${s}"`))}).catch(i)})}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){const e=Xa(this.config),i=t.map(tu).filter(s=>!!s&&e.indexOf(s)!==-1);return this.selectKeySystem(i)}getKeyStatus(t){const{mediaKeySessions:e}=this;for(let i=0;i<e.length;i++){const s=_D(t,e[i]);if(s)return s}}loadKey(t){const e=t.keyInfo.decryptdata,i=Gl(e),s=this.bannedKeyIds[i];if(s||this.getKeyStatus(e)==="internal-error"){const u=bv(s||"internal-error",e);return this.handleError(u,t.frag),Promise.reject(u)}const a=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${a}`);const l=this.keyIdToKeySessionPromise[i];if(!l){const u=this.getKeySystemForKeyPromise(e).then(({keySystem:d,mediaKeys:f})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${a}`),this.attemptSetMediaKeys(d,f).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:d,mediaKeys:f,decryptdata:e}))))).then(d=>{const f="cenc",h=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(d,f,h,"playlist-key")});return u.catch(d=>this.handleError(d,t.frag)),this.keyIdToKeySessionPromise[i]=u,u}return l.catch(u=>{if(u instanceof ci){const d=zt({},u.data);this.getKeyStatus(e)==="internal-error"&&(d.decryptdata=e);const f=new ci(d,u.message);this.handleError(f,t.frag)}}),l}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t,e){if(this.hls)if(t instanceof ci){e&&(t.data.frag=e);const i=t.data.decryptdata;this.error(`${t.message}${i?` (${Ve(i.keyId||[])})`:""}`),this.hls.trigger(_.ERROR,t.data)}else this.error(t.message),this.hls.trigger(_.ERROR,{type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0})}getKeySystemForKeyPromise(t){const e=Gl(t),i=this.keyIdToKeySessionPromise[e];if(!i){const s=tu(t.keyFormat),a=s?[s]:Xa(this.config);return this.attemptKeySystemAccess(a)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=Xa(this.config)),t.length===0)throw new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Zt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){if(this.mediaResolved=void 0,this.mediaKeys===e)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const s=Promise.all(i).then(()=>this.media?this.media.setMediaKeys(e):new Promise((a,l)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return l(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=e,this.media.setMediaKeys(e).then(a).catch(l)}}));return this.mediaKeys=e,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>i.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(t,e,i,s){var a;const l=(a=this.config.drmSystems)==null||(a=a[t.keySystem])==null?void 0:a.generateRequest;if(l)try{const v=l.call(this.hls,e,i,t);if(!v)throw new Error("Invalid response from configured generateRequest filter");e=v.initDataType,i=v.initData?v.initData:null,t.decryptdata.pssh=i?new Uint8Array(i):null}catch(v){if(this.warn(v.message),this.hls&&this.hls.config.debug)throw v}if(i===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);const u=Gl(t.decryptdata),d=t.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${u} URI: ${d} (init data type: ${e} length: ${i.byteLength})`);const f=new Nh,h=t._onmessage=v=>{const S=t.mediaKeysSession;if(!S){f.emit("error",new Error("invalid state"));return}const{messageType:T,message:A}=v;this.log(`"${T}" message event for session "${S.sessionId}" message size: ${A.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(t,A).catch(b=>{f.eventNames().length?f.emit("error",b):this.handleError(b)}):T==="license-release"?t.keySystem===re.FAIRPLAY&&this.updateKeySession(t,Yd("acknowledged")).then(()=>this.removeSession(t)).catch(b=>this.handleError(b)):this.warn(`unhandled media key message type "${T}"`)},p=(v,S)=>{S.keyStatus=v;let T;v.startsWith("usable")?f.emit("resolved"):v==="internal-error"||v==="output-restricted"||v==="output-downscaled"?T=bv(v,S.decryptdata):v==="expired"?T=new Error(`key expired (keyId: ${u})`):v==="released"?T=new Error("key released"):v==="status-pending"||this.warn(`unhandled key status change "${v}" (keyId: ${u})`),T&&(f.eventNames().length?f.emit("error",T):this.handleError(T))},g=t._onkeystatuseschange=v=>{if(!t.mediaKeysSession){f.emit("error",new Error("invalid state"));return}const T=this.getKeyStatuses(t);if(!Object.keys(T).some(C=>T[C]!=="status-pending"))return;if(T[u]==="expired"){this.log(`Expired key ${Zt(T)} in key-session "${t.mediaKeysSession.sessionId}"`),this.renewKeySession(t);return}let b=T[u];if(b)p(b,t);else{var R;t.keyStatusTimeouts||(t.keyStatusTimeouts={}),(R=t.keyStatusTimeouts)[u]||(R[u]=self.setTimeout(()=>{if(!t.mediaKeysSession||!this.mediaKeys)return;const D=this.getKeyStatus(t.decryptdata);if(D&&D!=="status-pending")return this.log(`No status for keyId ${u} in key-session "${t.mediaKeysSession.sessionId}". Using session key-status ${D} from other session.`),p(D,t);this.log(`key status for ${u} in key-session "${t.mediaKeysSession.sessionId}" timed out after 1000ms`),b="internal-error",p(b,t)},1e3)),this.log(`No status for keyId ${u} (${Zt(T)}).`)}};Ke(t.mediaKeysSession,"message",h),Ke(t.mediaKeysSession,"keystatuseschange",g);const y=new Promise((v,S)=>{f.on("error",S),f.on("resolved",v)});return t.mediaKeysSession.generateRequest(e,i).then(()=>{this.log(`Request generated for key-session "${t.mediaKeysSession.sessionId}" keyId: ${u} URI: ${d}`)}).catch(v=>{throw new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:v,decryptdata:t.decryptdata,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>y).catch(v=>(f.removeAllListeners(),this.removeSession(t).then(()=>{throw v}))).then(()=>(f.removeAllListeners(),t))}getKeyStatuses(t){const e={};return t.mediaKeysSession.keyStatuses.forEach((i,s)=>{if(typeof s=="string"&&typeof i=="object"){const u=s;s=i,i=u}const a="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);t.keySystem===re.PLAYREADY&&a.length===16&&fx(a);const l=Ve(a);i==="internal-error"&&(this.bannedKeyIds[l]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${l} key-session "${t.mediaKeysSession.sessionId}"`),e[l]=i}),e}fetchServerCertificate(t){const e=this.config,i=e.loader,s=new i(e),a=this.getServerCertificateUrl(t);return a?(this.log(`Fetching server certificate for "${t}"`),new Promise((l,u)=>{const d={responseType:"arraybuffer",url:a},f=e.certLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,y,v,S)=>{l(g.data)},onError:(g,y,v,S)=>{u(new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:zt({url:d.url,data:void 0},g)},`"${t}" certificate request failed (${a}). Status: ${g.code} (${g.text})`))},onTimeout:(g,y,v)=>{u(new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:{url:d.url,data:void 0}},`"${t}" certificate request timed out (${a})`))},onAbort:(g,y,v)=>{u(new Error("aborted"))}};s.load(d,h,p)})):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise((s,a)=>{t.setServerCertificate(i).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${i.byteLength}) on "${e}"`),s(t)}).catch(l=>{a(new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then(i=>this.updateKeySession(t,new Uint8Array(i)).catch(s=>{throw new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:t.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(t,e){const i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const s=new DOMParser().parseFromString(i,"application/xml"),a=s.querySelectorAll("HttpHeader");if(a.length>0){let h;for(let p=0,g=a.length;p<g;p++){var l,u;h=a[p];const y=(l=h.querySelector("name"))==null?void 0:l.textContent,v=(u=h.querySelector("value"))==null?void 0:u.textContent;y&&v&&t.setRequestHeader(y,v)}}const d=s.querySelector("Challenge"),f=d?.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return Yd(atob(f))}setupLicenseXHR(t,e,i,s){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,t,e,i,s)}).catch(l=>{if(!i.decryptdata)throw l;return t.open("POST",e,!0),a.call(this.hls,t,e,i,s)}).then(l=>(t.readyState||t.open("POST",e,!0),{xhr:t,licenseChallenge:l||s})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,e){const i=this.config.keyLoadPolicy.default;return new Promise((s,a)=>{const l=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${l}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return a(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let d=u.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const f=this.config.licenseResponseCallback;if(f)try{d=f.call(this.hls,u,l,t)}catch(h){this.error(h)}s(d)}else{const d=i.errorRetry,f=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||u.status>=400&&u.status<500)a(new ci({type:vt.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:t.decryptdata,fatal:!0,networkDetails:u,response:{url:l,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${l}). Status: ${u.status} (${u.statusText})`));else{const h=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(t,e).then(s,a)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=u,this.setupLicenseXHR(u,l,t,e).then(({xhr:d,licenseChallenge:f})=>{t.keySystem==re.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(d,f)),d.send(f)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const i=e.media;this.media=i,Ke(i,"encrypted",this.onMediaEncrypted),Ke(i,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=i.mediaKeys}onMediaDetached(){const t=this.media;t&&(ii(t,"encrypted",this.onMediaEncrypted),ii(t,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var t;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const e=this.mediaResolved;if(e&&e(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const i=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Gs.clearKeyUriToKeyIdMap();const a=s.length;zr.CDMCleanupPromise=Promise.all(s.map(l=>this.removeSession(l)).concat((i==null||(t=i.setMediaKeys(null))==null?void 0:t.catch(l=>{this.log(`Could not clear media keys: ${l}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${l}`)})}))||Promise.resolve())).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${l}`)})}).then(()=>{a&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(t,{sessionKeys:e}){if(!(!e||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=e.reduce((s,a)=>(s.indexOf(a.keyFormat)===-1&&s.push(a.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:i,decryptdata:s}=t;if(e){this.log(`Remove licenses and keys and close session "${e.sessionId}" keyId: ${Ve(s?.keyId||[])}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(t);a>-1&&this.mediaKeySessions.splice(a,1);const{keyStatusTimeouts:l}=t;l&&Object.keys(l).forEach(f=>self.clearTimeout(l[f]));const{drmSystemOptions:u}=this.config;return(lC(u)?new Promise((f,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),e.remove().then(f).catch(h)}):Promise.resolve()).catch(f=>{this.log(`Could not remove session: ${f}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${f}`)})}).then(()=>e.close()).catch(f=>{this.log(`Could not close session: ${f}`),this.hls&&this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${f}`)})})}return Promise.resolve()}}zr.CDMCleanupPromise=void 0;function Gl(r){if(!r)throw new Error("Could not read keyId of undefined decryptdata");if(r.keyId===null)throw new Error("keyId is null");return Ve(r.keyId)}function _D(r,t){if(r.keyId&&t.mediaKeysSession.keyStatuses.has(r.keyId))return t.mediaKeysSession.keyStatuses.get(r.keyId);if(r.matches(t.decryptdata))return t.keyStatus}class ci extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function bv(r,t){const e=r==="output-restricted",i=e?Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new ci({type:vt.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},e?"HDCP level output restricted":`key status changed to "${r}"`)}class CD{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const s=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){const s=performance.now();if(e){if(this.lastTime){const a=s-this.lastTime,l=i-this.lastDroppedFrames,u=e-this.lastDecodedFrames,d=1e3*l/a,f=this.hls;if(f.trigger(_.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:i}),d>0&&l>f.config.fpsDroppedMonitoringThreshold*u){let h=f.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=h)&&(h=h-1,f.trigger(_.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:f.currentLevel}),f.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}function nS(r,t){let e;try{e=new Event("addtrack")}catch{e=document.createEvent("Event"),e.initEvent("addtrack",!1,!1)}e.track=r,t.dispatchEvent(e)}function sS(r,t){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(t.id))try{if(r.addCue(t),!r.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){Vt.debug(`[texttrack-utils]: ${i}`);try{const s=new self.TextTrackCue(t.startTime,t.endTime,t.text);s.id=t.id,r.addCue(s)}catch(s){Vt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}e==="disabled"&&(r.mode=e)}function $r(r,t){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let i=r.cues.length;i--;)t&&r.cues[i].removeEventListener("enter",t),r.removeCue(r.cues[i]);e==="disabled"&&(r.mode=e)}function nh(r,t,e,i){const s=r.mode;if(s==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const a=DD(r.cues,t,e);for(let l=0;l<a.length;l++)(!i||i(a[l]))&&r.removeCue(a[l])}s==="disabled"&&(r.mode=s)}function wD(r,t){if(t<=r[0].startTime)return 0;const e=r.length-1;if(t>r[e].endTime)return-1;let i=0,s=e,a;for(;i<=s;)if(a=Math.floor((s+i)/2),t<r[a].startTime)s=a-1;else if(t>r[a].startTime&&i<e)i=a+1;else return a;return r[i].startTime-t<t-r[s].startTime?i:s}function DD(r,t,e){const i=[],s=wD(r,t);if(s>-1)for(let a=s,l=r.length;a<l;a++){const u=r[a];if(u.startTime>=t&&u.endTime<=e)i.push(u);else if(u.startTime>e)return i}return i}function su(r){const t=[];for(let e=0;e<r.length;e++){const i=r[e];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&t.push(r[e])}return t}class ID extends Hh{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const i=su(this.media.textTracks);for(let a=0;a<i.length;a++)if(i[a].mode==="hidden")e=i[a];else if(i[a].mode==="showing"){e=i[a];break}const s=this.findTrackForTextTrack(e);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(_.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(_.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const i=this.media;if(!i)return;const s=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;su(i.textTracks).forEach(l=>{$r(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:s,details:a}=e,l=this.tracksInGroup[i];if(!l||l.groupId!==s){this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=e.details,this.log(`Subtitle track ${i} "${l.name}" lang:${l.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,u)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||s?.length!==i?.length||i!=null&&i.some(l=>s?.indexOf(l)===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(h=>!i||i.indexOf(h.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(h=>h.default)&&(this.selectDefaultTrack=!1),l.forEach((h,p)=>{h.id=p});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.subtitlePreference;if(!a&&u){this.selectDefaultTrack=!1;const h=Wi(u,l);if(h>-1)a=l[h];else{const p=Wi(u,this.tracks);a=this.tracks[p]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const f={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${i?.join(",")}" group-id`),this.hls.trigger(_.SUBTITLE_TRACKS_UPDATED,f),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<e.length;s++){const a=e[s];if(!(i&&!a.default||!i&&!t)&&(!t||js(a,t)))return s}if(t){for(let s=0;s<e.length;s++){const a=e[s];if(lo(t.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<e.length;s++){const a=e[s];if(lo(t.attrs,a.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const s=e[i];if(Jd(s,t))return i}}return-1}onError(t,e){e.fatal||!e.context||e.context.type===It.SUBTITLE_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(t.id===-1)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&js(t,i))return i;const s=Wi(t,this.tracksInGroup);if(s>-1){const a=this.tracksInGroup[s];return this.setSubtitleTrack(s),a}else{if(i)return null;{const a=Wi(t,e);if(a>-1)return e[a]}}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,s=t.groupId,a=this.getUrlWithDirectives(t.url,e),l=t.details,u=l?.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${a}`),this.hls.trigger(_.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=su(t.textTracks),i=this.currentTrack;let s;if(i&&(s=e.filter(a=>Jd(i,a))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach(a=>{a.mode!=="disabled"&&a!==s&&(a.mode="disabled")}),s){const a=this.subtitleDisplay?"showing":"hidden";s.mode!==a&&(s.mode=a)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=e.length||!ht(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t]||null;if(this.trackId=t,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:t});return}const a=!!s.details&&!s.details.live;if(t===this.trackId&&s===i&&a)return;this.log(`Switching to subtitle-track ${t}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:l,groupId:u="",name:d,type:f,url:h}=s;this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:l,groupId:u,name:d,type:f,url:h});const p=this.switchParams(s.url,i?.details,s.details);this.loadPlaylist(p)}}function OD(){try{return crypto.randomUUID()}catch{try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch{let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const a=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(s=="x"?a:a&3|8).toString(16)})}}}function Za(r){let t=5381,e=r.length;for(;e;)t=t*33^r.charCodeAt(--e);return(t>>>0).toString()}const Vr=.025;let bu=(function(r){return r[r.Point=0]="Point",r[r.Range=1]="Range",r})({});function kD(r,t,e){return`${r.identifier}-${e+1}-${Za(t)}`}class MD{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,(t=this.assetListLoader)==null||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const i=this.playoutLimit;return t<=0||isNaN(i)?!1:i===0?!0:(((e=this.assetList[t])==null?void 0:e.startOffset)||0)>i}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return Ad(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime,i=Ad(e,t);return e-i<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=ht(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return Ad(t,e)}return t}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Vr))}set appendInPlace(t){if(this.appendInPlaceStarted){this.resetOnResume=!t;return}this.appendInPlaceDisabled=!t}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return this._duration!==null?e=this._duration:this.dateRange.duration?e=this.dateRange.duration:e=this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?bu.Range:bu.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return PD(this)}}function Ad(r,t){return r-t.start<t.duration/2&&!(Math.abs(r-(t.start+t.duration))<Vr)?t.start:t.start+t.duration}function rS(r,t,e){const i=new self.URL(r,e);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",t),i}function Rd(r,t){for(;(e=r.assetList[++t])!=null&&e.error;)var e;return t}function PD(r){return`["${r.identifier}" ${r.cue.pre?"<pre>":r.cue.post?"<post>":""}${r.timelineStart.toFixed(2)}-${r.resumeTime.toFixed(2)}]`}function Br(r){const t=r.timelineStart,e=r.duration||0;return`["${r.identifier}" ${t.toFixed(2)}-${(t+e).toFixed(2)}]`}class ND{constructor(t,e,i,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(_.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new t(e);this.interstitial=i,this.assetItem=s;const l=()=>{this.hasDetails=!0};a.once(_.LEVEL_LOADED,l),a.once(_.AUDIO_TRACK_LOADED,l),a.once(_.SUBTITLE_TRACK_LOADED,l),a.on(_.MEDIA_ATTACHING,(u,{media:d})=>{this.removeMediaListeners(),this.mediaAttached=d,this.interstitial.playoutLimit&&(d.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(_.BUFFER_APPENDED,()=>{const h=this.bufferedEnd;this.reachedPlayout(h)&&(this._bufferedEosTime=h,a.trigger(_.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=rS(e,t.config.primarySessionId||"").href}catch{}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if((e=this.hls)!=null&&e.bufferedToEnd)return!0;if(!t)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,a=At.bufferInfo(t,s,0);return this.getAssetTime(a.end)>=i-.02}reachedPlayout(t){const i=this.interstitial.playoutLimit;return this.startOffset+t>=i}get destroyed(){var t;return!((t=this.hls)!=null&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return((t=this.hls)==null?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=At.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const i=e-this.startOffset;if(i>0&&i<t)return i}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return((t=this.hls)==null?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const i=t-e;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,t-e),i)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var t;(t=this.hls)!=null&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),(e=this.hls)==null||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,(t=this.hls)==null||t.detachMedia()}resumeBuffering(){var t;(t=this.hls)==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.hls)==null||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),((t=this.hls)==null?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=i=>delete i.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,i){var s;(s=this.hls)==null||s.on(t,e)}once(t,e,i){var s;(s=this.hls)==null||s.once(t,e)}off(t,e,i){var s;(s=this.hls)==null||s.off(t,e)}toString(){var t;return`HlsAssetPlayer: ${Br(this.assetItem)} ${(t=this.hls)==null?void 0:t.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Av=.033;class FD extends wi{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((i,s)=>t<=s.startOffset&&e>s.startOffset?(delete s.error,i+1):i,0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);const s=this.items;if(s)for(s[i]||(e===void 0&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&(a=s[i])!=null&&a.event;){var a;i--}return i}findItemIndexAtTime(t,e){const i=this.items;if(i)for(let s=0;s<i.length;s++){let a=i[s];if(e&&e!=="primary"&&(a=a[e]),t===a.start||t>a.start&&t<a.end)return s}return-1}findJumpRestrictedIndex(t,e){const i=this.items;if(i)for(let s=t;s<=e&&i[s];s++){const a=i[s].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return s}return-1}findEventIndex(t){const e=this.items;if(e)for(let s=e.length;s--;){var i;if(((i=e[s].event)==null?void 0:i.identifier)===t)return s}return-1}findAssetIndex(t,e){const i=t.assetList,s=i.length;if(s>1)for(let a=0;a<s;a++){const l=i[a];if(!l.error){const u=l.timelineStart;if(e===u||e>u&&(e<u+(l.duration||0)||a===s-1))return a}}return 0}get assetIdAtEnd(){var t;const e=(t=this.items)==null||(t=t[this.length-1])==null?void 0:t.event;if(e){const i=e.assetList,s=i[i.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(t,e){const i=t.main.details,{dateRanges:s}=i,a=this.events,l=this.parseDateRanges(s,{url:i.url},e),u=Object.keys(s),d=a?a.filter(f=>!u.includes(f.identifier)):[];l.length&&l.sort((f,h)=>{const p=f.cue.pre,g=f.cue.post,y=h.cue.pre,v=h.cue.post;if(p&&!y)return-1;if(y&&!p||g&&!v)return 1;if(v&&!g)return-1;if(!p&&!y&&!g&&!v){const S=f.startTime,T=h.startTime;if(S!==T)return S-T}return f.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=l,d.forEach(f=>{this.removeEvent(f)}),this.updateSchedule(t,d)}updateSchedule(t,e=[],i=!1){const s=this.events||[];if(s.length||e.length||this.length<2){const a=this.items,l=this.parseSchedule(s,t);(i||e.length||a?.length!==l.length||l.some((d,f)=>Math.abs(d.playout.start-a[f].playout.start)>.005||Math.abs(d.playout.end-a[f].playout.end)>.005))&&(this.items=l,this.onScheduleUpdate(e,a))}}parseDateRanges(t,e,i){const s=[],a=Object.keys(t);for(let l=0;l<a.length;l++){const u=a[l],d=t[u];if(d.isInterstitial){let f=this.eventMap[u];f?f.setDateRange(d):(f=new MD(d,e),this.eventMap[u]=f,i===!1&&(f.appendInPlace=i)),s.push(f)}}return s}parseSchedule(t,e){const i=[],s=e.main.details,a=s.live?1/0:s.edge;let l=0;if(t=t.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),t.length){this.resolveOffsets(t,e);let d=0,f=0;if(t.forEach((h,p)=>{const g=h.cue.pre,y=h.cue.post,v=t[p-1]||null,S=h.appendInPlace,T=y?a:h.startOffset,A=h.duration,b=h.timelineOccupancy===bu.Range?A:0,R=h.resumptionOffset,C=v?.startTime===T,D=T+h.cumulativeDuration;let N=S?D+A:T+R;if(g||!y&&T<=0){const P=f;f+=b,h.timelineStart=D;const B=l;l+=A,i.push({event:h,start:D,end:N,playout:{start:B,end:l},integrated:{start:P,end:f}})}else if(T<=a){if(!C){const M=T-d;if(M>Av){const K=d,tt=f;f+=M;const z=l;l+=M;const G={previousEvent:t[p-1]||null,nextEvent:h,start:K,end:K+M,playout:{start:z,end:l},integrated:{start:tt,end:f}};i.push(G)}else M>0&&v&&(v.cumulativeDuration+=M,i[i.length-1].end=T)}y&&(N=D),h.timelineStart=D;const P=f;f+=b;const B=l;l+=A,i.push({event:h,start:D,end:N,playout:{start:B,end:l},integrated:{start:P,end:f}})}else return;const w=h.resumeTime;y||w>a?d=a:d=w}),d<a){var u;const h=d,p=f,g=a-d;f+=g;const y=l;l+=g,i.push({previousEvent:((u=i[i.length-1])==null?void 0:u.event)||null,nextEvent:null,start:d,end:h+g,playout:{start:y,end:l},integrated:{start:p,end:f}})}this.setDurations(a,l,f)}else i.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){const i=e.main.details,s=i.live?1/0:i.edge;let a=0,l=-1;t.forEach((u,d)=>{const f=u.cue.pre,h=u.cue.post,p=f?0:h?s:u.startTime;this.updateAssetDurations(u),l===p?u.cumulativeDuration=a:(a=0,l=p),!h&&u.snapOptions.in&&(u.resumeAnchor=Vs(null,i.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,e)||(u.appendInPlace=!1)),!u.appendInPlace&&d+1<t.length&&t[d+1].startTime-t[d].resumeTime<Av&&(t[d+1].appendInPlace=!1,t[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const y=ht(u.resumeOffset)?u.resumeOffset:u.duration;a+=y})}primaryCanResumeInPlaceAt(t,e){const i=t.resumeTime,s=t.startTime+t.resumptionOffset;return Math.abs(i-s)>Vr?(this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${s}`),!1):!Object.keys(e).some(l=>{const u=e[l].details,d=u.edge;if(i>=d)return this.log(`"${t.identifier}" resumption ${i} past ${l} playlist end ${d}`),!1;const f=Vs(null,u.fragments,i);if(!f)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${l} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const h=l==="audio"?.175:0;return Math.abs(f.start-i)<Vr+h||Math.abs(f.end-i)<Vr+h?!1:(this.log(`"${t.identifier}" resumption ${i} not aligned with ${l} fragment bounds (${f.start}-${f.end} sn: ${f.sn} cc: ${f.cc})`),!0)})}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let i=0,s=!1,a=!1;for(let l=0;l<t.assetList.length;l++){const u=t.assetList[l],d=e+i;u.startOffset=i,u.timelineStart=d,s||(s=u.duration===null),a||(a=!!u.error);const f=u.error?0:u.duration||0;i+=f}s&&!a?t.duration=Math.max(i,t.duration):t.duration=i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function ki(r){return`[${r.event?'"'+r.event.identifier+'"':"primary"}: ${r.start.toFixed(2)}-${r.end.toFixed(2)}]`}class BD{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const i=t.assetListUrl;let s;try{s=rS(i,this.hls.sessionId,t.baseUrl)}catch(g){const y=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_ERROR,g,i);this.hls.trigger(_.ERROR,y);return}e&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+e);const a=this.hls.config,l=a.loader,u=new l(a),d={responseType:"json",url:s.href},f=a.interstitialAssetListLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,y,v,S)=>{const T=g.data,A=T?.ASSETS;if(!Array.isArray(A)){const b=this.assignAssetListError(t,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),v.url,y,S);this.hls.trigger(_.ERROR,b);return}t.assetListResponse=T,this.hls.trigger(_.ASSET_LIST_LOADED,{event:t,assetListResponse:T,networkDetails:S})},onError:(g,y,v,S)=>{const T=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${g.code} ${g.text} (${y.url})`),y.url,S,v);this.hls.trigger(_.ERROR,T)},onTimeout:(g,y,v)=>{const S=this.assignAssetListError(t,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${y.url})`),y.url,g,v);this.hls.trigger(_.ERROR,S)}};return u.load(d,h,p),this.hls.trigger(_.ASSET_LIST_LOADING,{event:t}),u}assignAssetListError(t,e,i,s,a,l){return t.error=i,{type:vt.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:s,error:i,networkDetails:l,stats:a}}}function Rv(r){var t;r==null||(t=r.play())==null||t.catch(()=>{})}function Hl(r,t){return`[${r}] Advancing timeline position to ${t}`}class UD extends wi{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const s=i-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const l=s<=-.01;this.timelinePos=i,this.bufferedPos=i;const u=this.playingItem;if(!u){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(i,i-s)&&this.updateSchedule(!0),this.checkBuffer(),l&&i<u.start||i>=u.end){var d;const y=this.findItemIndex(u);let v=this.schedule.findItemIndexAtTime(i);if(v===-1&&(v=y+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${i} (resolving from ${y} to ${v})`)),!this.isInterstitial(u)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!l&&v>y){const S=this.schedule.findJumpRestrictedIndex(y+1,v);if(S>y){this.setSchedulePosition(S);return}}this.setSchedulePosition(v);return}const f=this.playingAsset;if(!f){if(this.playingLastItem&&this.isInterstitial(u)){const y=u.event.assetList[0];y&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,y))}return}const h=f.timelineStart,p=f.duration||0;if(l&&i<h||i>=h+p){var g;(g=u.event)!=null&&g.appendInPlace&&(this.clearInterstitial(u.event,u),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,f)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(i>=s.end){this.timelinePos=s.end;const u=this.findItemIndex(s);this.setSchedulePosition(u+1)}const a=this.playingAsset;if(!a)return;const l=a.timelineStart+(a.duration||0);i>=l&&this.setScheduleToAssetAtTime(i,a)},this.onScheduleUpdate=(i,s)=>{const a=this.schedule;if(!a)return;const l=this.playingItem,u=a.events||[],d=a.items||[],f=a.durations,h=i.map(S=>S.identifier),p=!!(u.length||h.length);(p||s)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${d.map(S=>ki(S))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`);let g=null,y=null;l&&(g=this.updateItem(l,this.timelinePos),this.itemsMatch(l,g)?this.playingItem=g:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const v=this.bufferingItem;if(v&&(y=this.updateItem(v,this.bufferedPos),this.itemsMatch(v,y)?this.bufferingItem=y:v.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(v.event,null))),i.forEach(S=>{S.assetList.forEach(T=>{this.clearAssetPlayer(T.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const T=S.assetItem.timelineStart,A=S.timelineOffset-T;if(A)try{S.timelineOffset=T}catch(b){Math.abs(A)>Vr&&this.warn(`${b} ("${S.assetId}" ${S.timelineOffset}->${T})`)}}}),p||s){if(this.hls.trigger(_.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:d.slice(0),durations:f,removedIds:h}),this.isInterstitial(l)&&h.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}l&&this.trimInPlace(g,l),v&&y!==g&&this.trimInPlace(y,v),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new BD(t),this.schedule=new FD(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(_.MEDIA_ENDED,this.onMediaEnded,this),t.on(_.ERROR,this.onError,this),t.on(_.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(_.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(_.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(_.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(_.BUFFER_CODECS,this.onBufferCodecs,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(_.MEDIA_ENDED,this.onMediaEnded,this),t.off(_.ERROR,this.onError,this),t.off(_.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;(t=this.getBufferingPlayer())==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.getBufferingPlayer())==null||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){ii(t,"play",this.onPlay),ii(t,"pause",this.onPause),ii(t,"seeking",this.onSeeking),ii(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const i=this.media=e.media;Ke(i,"seeking",this.onSeeking),Ke(i,"timeupdate",this.onTimeupdate),Ke(i,"play",this.onPlay),Ke(i,"pause",this.onPause)}onMediaAttached(t,e){const i=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!s){this.clearScheduleState();const a=this.findItemIndex(i);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const i=!!e.transferMedia,s=this.media;if(this.media=null,!i&&(s&&this.removeMediaListeners(s),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,i=p=>p&&t.getAssetPlayer(p.identifier),s=(p,g,y,v,S)=>{if(p){let T=p[g].start;const A=p.event;if(A){if(g==="playout"||A.timelineOccupancy!==bu.Point){const b=i(y);b?.interstitial===A&&(T+=b.assetItem.startOffset+b[S])}}else{const b=v==="bufferedPos"?l():t[v];T+=b-p.start}return T}return 0},a=(p,g)=>{var y;if(p!==0&&g!=="primary"&&(y=t.schedule)!=null&&y.length){var v;const S=t.schedule.findItemIndexAtTime(p),T=(v=t.schedule.items)==null?void 0:v[S];if(T){const A=T[g].start-T.start;return p+A}}return p},l=()=>{const p=t.bufferedPos;return p===Number.MAX_VALUE?u("primary"):Math.max(p,0)},u=p=>{var g,y;return(g=t.primaryDetails)!=null&&g.live?t.primaryDetails.edge:((y=t.schedule)==null?void 0:y.durations[p])||0},d=(p,g)=>{var y,v;const S=t.effectivePlayingItem;if(S!=null&&(y=S.event)!=null&&y.restrictions.skip||!t.schedule)return;t.log(`seek to ${p} "${g}"`);const T=t.effectivePlayingItem,A=t.schedule.findItemIndexAtTime(p,g),b=(v=t.schedule.items)==null?void 0:v[A],R=t.getBufferingPlayer(),C=R?.interstitial,D=C?.appendInPlace,N=T&&t.itemsMatch(T,b);if(T&&(D||N)){const w=i(t.playingAsset),P=w?.media||t.primaryMedia;if(P){const B=g==="primary"?P.currentTime:s(T,g,t.playingAsset,"timelinePos","currentTime"),M=p-B,K=(D?B:P.currentTime)+M;if(K>=0&&(!w||D||K<=w.duration)){P.currentTime=K;return}}}if(b){let w=p;if(g!=="primary"){const B=b[g].start,M=p-B;w=b.start+M}const P=!t.isInterstitial(b);if((!t.isInterstitial(T)||T.event.appendInPlace)&&(P||b.event.appendInPlace)){const B=t.media||(D?R?.media:null);B&&(B.currentTime=w)}else if(T){const B=t.findItemIndex(T);if(A>B){const K=t.schedule.findJumpRestrictedIndex(B+1,A);if(K>B){t.setSchedulePosition(K);return}}let M=0;if(P)t.timelinePos=w,t.checkBuffer();else{const K=b.event.assetList,tt=p-(b[g]||b).start;for(let z=K.length;z--;){const G=K[z];if(G.duration&&tt>=G.startOffset&&tt<G.startOffset+G.duration){M=z;break}}}t.setSchedulePosition(A,M)}}},f=()=>{const p=t.effectivePlayingItem;if(t.isInterstitial(p))return p;const g=e();return t.isInterstitial(g)?g:null},h={get bufferedEnd(){const p=e(),g=t.bufferingItem;if(g&&g===p){var y;return s(g,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-g.playout.start||((y=t.bufferingAsset)==null?void 0:y.startOffset)||0}return 0},get currentTime(){const p=f(),g=t.effectivePlayingItem;return g&&g===p?s(g,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-g.playout.start:0},set currentTime(p){const g=f(),y=t.effectivePlayingItem;y&&y===g&&d(p+y.playout.start,"playout")},get duration(){const p=f();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const g=(p=f())==null?void 0:p.event.assetList;return g?g.map(y=>t.getAssetPlayer(y.identifier)):[]},get playingIndex(){var p;const g=(p=f())==null?void 0:p.event;return g&&t.effectivePlayingAsset?g.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return f()}};return this.manager={get events(){var p;return((p=t.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=t.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return f()?h:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const p=e();return t.findItemIndex(p)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const p=t.effectivePlayingItem;return t.findItemIndex(p)},primary:{get bufferedEnd(){return l()},get currentTime(){const p=t.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return u("primary")},get seekableStart(){var p;return((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return u("integrated")},get seekableStart(){var p;return a(((p=t.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=t.effectivePlayingItem,g=p?.event;if(g&&!g.restrictions.skip){const y=t.findItemIndex(p);if(g.appendInPlace){const v=p.playout.start+p.event.duration;d(v+.001,"playout")}else t.advanceAfterAssetEnded(g,y,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,i=(t=this.schedule)==null?void 0:t.items;return!this.playbackStarted||!e||!i?!1:this.findItemIndex(e)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var t,e;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let s=this.media;!s&&(t=this.bufferingItem)!=null&&(t=t.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const a=(e=s)==null?void 0:e.currentTime;if(!(a===void 0||!ht(a)))return a}get primaryMedia(){var t;return this.media||((t=this.detachedData)==null?void 0:t.media)||null}isInterstitial(t){return!!(t!=null&&t.event)}retreiveMediaSource(t,e){const i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){const i=t.interstitial.appendInPlace,s=t.media;if(i&&s===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&s){this.detachedData={media:s};return}const a=t.transferMedia();this.log(`transfer MediaSource from ${t} ${Zt(a)}`),this.detachedData=a}else e&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(t,e){var i,s;if(t.media===e)return;let a=null;const l=this.hls,u=t!==l,d=u&&t.interstitial.appendInPlace,f=(i=this.detachedData)==null?void 0:i.mediaSource;let h;if(l.media)d&&(a=l.transferMedia(),this.detachedData=a),h="Primary";else if(f){const v=this.getBufferingPlayer();v?(a=v.transferMedia(),h=`${v}`):h="detached MediaSource"}else h="detached media";if(!a){if(f)a=this.detachedData,this.log(`using detachedData: MediaSource ${Zt(a)}`);else if(!this.detachedData||l.media===e){const v=this.playerQueue;v.length>1&&v.forEach(S=>{if(u&&S.interstitial.appendInPlace!==d){const T=S.interstitial;this.clearInterstitial(S.interstitial,null),T.appendInPlace=!1,T.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${T}`)}}),this.hls.detachMedia(),this.detachedData={media:e}}}const p=a&&"mediaSource"in a&&((s=a.mediaSource)==null?void 0:s.readyState)!=="closed",g=p&&a?a:e;this.log(`${p?"transfering MediaSource":"attaching media"} to ${u?t:"Primary"} from ${h} (media.currentTime: ${e.currentTime})`);const y=this.schedule;if(g===a&&y){const v=u&&t.assetId===y.assetIdAtEnd;g.overrides={duration:y.duration,endOfStream:!u||v,cueRemoval:!u}}t.attachMedia(g)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=t?.events;if(!e||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,s=this.effectivePlayingItem;if(i===-1){const a=this.hls.startPosition;if(this.log(Hl("checkStart",a)),this.timelinePos=a,e.length&&e[0].cue.pre){const l=t.findEventIndex(e[0].identifier);this.setSchedulePosition(l)}else if(a>=0||!this.primaryLive){const l=this.timelinePos=a>0?a:0,u=t.findItemIndexAtTime(l);this.setSchedulePosition(u)}}else if(s&&!this.playingItem){const a=t.findItemIndex(s);this.setSchedulePosition(a)}}advanceAssetBuffering(t,e){const i=t.event,s=i.findAssetIndex(e),a=Rd(i,s);if(!i.isAssetPastPlayoutLimit(a))this.bufferedToEvent(t,a);else if(this.schedule){var l;const u=(l=this.schedule.items)==null?void 0:l[this.findItemIndex(t)+1];u&&this.bufferedToItem(u)}}advanceAfterAssetEnded(t,e,i){const s=Rd(t,i);if(t.isAssetPastPlayoutLimit(s)){if(this.schedule){const a=this.schedule.items;if(a){const l=e+1,u=a.length;if(l>=u){this.setSchedulePosition(-1);return}const d=t.resumeTime;this.timelinePos<d&&(this.log(Hl("advanceAfterAssetEnded",d)),this.timelinePos=d,t.appendInPlace&&this.advanceInPlace(d),this.checkBuffer(this.bufferedPos<d)),this.setSchedulePosition(l)}}}else{if(t.appendInPlace){const a=t.assetList[s];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(e,s)}}setScheduleToAssetAtTime(t,e){const i=this.schedule;if(!i)return;const s=e.parentIdentifier,a=i.getEvent(s);if(a){const l=i.findEventIndex(s),u=i.findAssetIndex(a,t);this.advanceAfterAssetEnded(a,l,u-1)}}setSchedulePosition(t,e){var i;const s=(i=this.schedule)==null?void 0:i.items;if(!s||this.playbackDisabled)return;const a=t>=0?s[t]:null;this.log(`setSchedulePosition ${t}, ${e} (${a&&ki(a)}) pos: ${this.timelinePos}`);const l=this.waitingItem||this.playingItem,u=this.playingLastItem;if(this.isInterstitial(l)){const h=l.event,p=this.playingAsset,g=p?.identifier,y=g?this.getAssetPlayer(g):null;if(y&&g&&(!this.eventItemsMatch(l,a)||e!==void 0&&g!==h.assetList[e].identifier)){var d;const v=h.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${v+1}/${h.assetList.length} ${Br(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(_.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:v,event:h,schedule:s.slice(0),scheduleIndex:t,player:y}),l!==this.playingItem){this.itemsMatch(l,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(h,this.findItemIndex(this.playingItem),v);return}this.retreiveMediaSource(g,a),y.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&y.detachMedia()}if(!this.eventItemsMatch(l,a)&&(this.endedItem=l,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${h} ${ki(l)}`),h.hasPlayed=!0,this.hls.trigger(_.INTERSTITIAL_ENDED,{event:h,schedule:s.slice(0),scheduleIndex:t}),h.cue.once)){var f;this.updateSchedule();const v=(f=this.schedule)==null?void 0:f.items;if(a&&v){const S=this.findItemIndex(a);this.advanceSchedule(S,v,e,l,u)}return}}this.advanceSchedule(t,s,e,l,u)}advanceSchedule(t,e,i,s,a){const l=this.schedule;if(!l)return;const u=e[t]||null,d=this.primaryMedia,f=this.playerQueue;if(f.length&&f.forEach(h=>{const p=h.interstitial,g=l.findEventIndex(p.identifier);(g<t||g>t+1)&&this.clearInterstitial(p,u)}),this.isInterstitial(u)){this.timelinePos=Math.min(Math.max(this.timelinePos,u.start),u.end);const h=u.event;if(i===void 0){i=l.findAssetIndex(h,this.timelinePos);const v=Rd(h,i-1);if(h.isAssetPastPlayoutLimit(v)||h.appendInPlace&&this.timelinePos===u.end){this.advanceAfterAssetEnded(h,t,i);return}i=v}const p=this.waitingItem;this.assetsBuffered(u,d)||this.setBufferingItem(u);let g=this.preloadAssets(h,i);if(this.eventItemsMatch(u,p||s)||(this.waitingItem=u,this.log(`INTERSTITIAL_STARTED ${ki(u)} ${h.appendInPlace?"append in place":""}`),this.hls.trigger(_.INTERSTITIAL_STARTED,{event:h,schedule:e.slice(0),scheduleIndex:t})),!h.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${h}`);return}if(h.assetListLoader&&(h.assetListLoader.destroy(),h.assetListLoader=void 0),!d){this.log(`Waiting for attachMedia to start Interstitial ${h}`);return}this.waitingItem=this.endedItem=null,this.playingItem=u;const y=h.assetList[i];if(!y){this.advanceAfterAssetEnded(h,t,i||0);return}if(g||(g=this.getAssetPlayer(y.identifier)),g===null||g.destroyed){const v=h.assetList.length;this.warn(`asset ${i+1}/${v} player destroyed ${h}`),g=this.createAssetPlayer(h,y,i),g.loadSource()}if(!this.eventItemsMatch(u,this.bufferingItem)&&h.appendInPlace&&this.isAssetBuffered(y))return;this.startAssetPlayer(g,i,e,t,d),this.shouldPlay&&Rv(g.media)}else u?(this.resumePrimary(u,t,s),this.shouldPlay&&Rv(this.hls.media)):a&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(l.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var t;return(t=this.mediaSelection)==null?void 0:t.main.details}get primaryLive(){var t;return!!((t=this.primaryDetails)!=null&&t.live)}resumePrimary(t,e,i){var s,a;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${ki(t)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let u=this.timelinePos;(u<t.start||u>=t.end)&&(u=this.getPrimaryResumption(t,e),this.log(Hl("resumePrimary",u)),this.timelinePos=u),this.attachPrimary(u,t)}if(!i)return;const l=(a=this.schedule)==null?void 0:a.items;l&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ki(t)}`),this.hls.trigger(_.INTERSTITIALS_PRIMARY_RESUMED,{schedule:l.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const i=t.start;if(this.primaryLive){const s=this.primaryDetails;if(e===0)return this.hls.startPosition;if(s&&(i<s.fragmentStart||i>s.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);return e!=null&&e.hls?e.hls.bufferedToEnd:At.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,s),i&&this.startLoadingPrimaryAt(t,i)),i||(this.log(Hl("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((i=s.mainForwardBufferInfo)==null?void 0:i.start)||s.media.currentTime)-t)>.5?s.startLoad(t,e):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),(t=this.schedule)==null||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(_.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(_.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(e.level===-1||!this.schedule)return;const i=this.hls.levels[e.level];if(!i.details)return;const s=zt(zt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const i=this.hls.audioTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=zt(zt({},this.altSelection),{},{audio:i});return}const a=zt(zt({},s),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(t,e){const i=this.hls.subtitleTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=zt(zt({},this.altSelection),{},{subtitles:i});return}const a=zt(zt({},s),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(t,e){const i=My(e);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(e)||s.setAudioOption(i)))}onSubtitleTrackSwitch(t,e){const i=My(e);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(e)||e.id!==-1&&s.setSubtitleOption(i)))}onBufferCodecs(t,e){const i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let s=0;s<e.length;s++){const a=e[s];if(a.cue.post){var i;const l=this.schedule.findEventIndex(a.identifier),u=(i=this.schedule.items)==null?void 0:i[l];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const i=this.findItemIndex(e);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(t,e){var i;const s=(i=this.schedule)==null?void 0:i.items;if(t&&s){const a=this.findItemIndex(t,e);return s[a]||null}return null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach((a,l)=>{t.event.isAssetPastPlayoutLimit(l)&&this.clearAssetPlayer(a.identifier,null)});const i=t.end+.25,s=At.bufferInfo(this.primaryMedia,i,0);(s.end>i||(s.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${ki(t)} (was ${ki(e)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===((i=e.event)==null?void 0:i.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(t=!1){var e;const i=this.mediaSelection;i&&((e=this.schedule)==null||e.updateSchedule(i,[],t))}checkBuffer(t){var e;const i=(e=this.schedule)==null?void 0:e.items;if(!i)return;const s=At.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=s.len<1),this.updateBufferedPos(s.end,i,t)}updateBufferedPos(t,e,i){const s=this.schedule,a=this.bufferingItem;if(this.bufferedPos>t||!s)return;if(e.length===1&&this.itemsMatch(e[0],a)){this.bufferedPos=t;return}const l=this.playingItem,u=this.findItemIndex(l);let d=s.findItemIndexAtTime(t);if(this.bufferedPos<t){var f;const h=this.findItemIndex(a),p=Math.min(h+1,e.length-1),g=e[p];if((d===-1&&a&&t>=a.end||(f=g.event)!=null&&f.appendInPlace&&t+.01>=g.start)&&(d=p),this.isInterstitial(a)){const y=a.event;if(p-u>1&&y.appendInPlace===!1||y.assetList.length===0&&y.assetListLoader)return}if(this.bufferedPos=t,d>h&&d>u)this.bufferedToItem(g);else{const y=this.primaryDetails;this.primaryLive&&y&&t>y.edge-y.targetduration&&g.start<y.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else i&&l&&!this.itemsMatch(l,a)&&(d===u?this.bufferedToItem(l):d===u+1&&this.bufferedToItem(e[d]))}assetsBuffered(t,e){return t.event.assetList.length===0?!1:!t.event.assetList.some(s=>{const a=this.getAssetPlayer(s.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(e))})}setBufferingItem(t){const e=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(t,e)&&i){const{items:s,events:a}=i;if(!s||!a)return e;const l=this.isInterstitial(t),u=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const d=u?u.remaining:e?e.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ki(t)}`+(e?` (${d.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(l){const f=i.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach((h,p)=>{const g=this.getAssetPlayer(h.identifier);g&&(p===f&&g.loadSource(),g.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(f=>f.pauseBuffering());this.hls.trigger(_.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t,e=0){const i=this.setBufferingItem(t);if(!this.playbackDisabled){if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(i!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(t.start,t,!0):this.preloadPrimary(t):this.preloadPrimary(t)}}}preloadPrimary(t){const e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){const i=t.event,s=i.assetList.length===0&&!i.assetListLoader,a=i.cue.once;if(s||!a){const l=this.preloadAssets(i,e);if(l!=null&&l.interstitial.appendInPlace){const u=this.primaryMedia;u&&this.bufferAssetPlayer(l,u)}}}preloadAssets(t,e){const i=t.assetUrl,s=t.assetList.length,a=s===0&&!t.assetListLoader,l=t.cue.once;if(a){const d=t.timelineStart;if(t.appendInPlace){var u;const g=this.playingItem;!this.isInterstitial(g)&&(g==null||(u=g.nextEvent)==null?void 0:u.identifier)===t.identifier&&this.flushFrontBuffer(d+.25)}let f,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(t.cue.pre||t.cue.post)){const g=h-d;g>0&&(f=Math.round(g*1e3)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:s} ${t}${f?` live-start: ${h} start-offset: ${f}`:""}`),i)return this.createAsset(t,0,0,d,t.duration,i);const p=this.assetListLoader.loadAssetList(t,f);p&&(t.assetListLoader=p)}else if(!l&&s){for(let f=e;f<s;f++){const h=t.assetList[f],p=this.getAssetPlayerQueueIndex(h.identifier);(p===-1||this.playerQueue[p].destroyed)&&!h.error&&this.createAssetPlayer(t,h,f)}const d=t.assetList[e];if(d){const f=this.getAssetPlayer(d.identifier);return f&&f.loadSource(),f}}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`),Object.keys(e).forEach(s=>{this.hls.trigger(_.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e){for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i]}return null}createAsset(t,e,i,s,a,l){const u={parentIdentifier:t.identifier,identifier:kD(t,l,e),duration:a,startOffset:i,timelineStart:s,uri:l};return this.createAssetPlayer(t,u,e)}createAssetPlayer(t,e,i){const s=this.hls,a=s.userConfig;let l=a.videoPreference;const u=s.loadLevelObj||s.levels[s.currentLevel];(l||u)&&(l=Xt({},l),u.videoCodec&&(l.videoCodec=u.videoCodec),u.videoRange&&(l.allowedVideoRanges=[u.videoRange]));const d=s.audioTracks[s.audioTrack],f=s.subtitleTracks[s.subtitleTrack];let h=0;if(this.primaryLive||t.appendInPlace){const C=this.timelinePos-e.timelineStart;if(C>1){const D=e.duration;D&&C<D&&(h=C)}}const p=e.identifier,g=zt(zt({},a),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:d||a.audioPreference,subtitlePreference:f||a.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(g.timelineOffset=e.timelineStart));const y=g.cmcd;y!=null&&y.sessionId&&y.contentId&&(g.cmcd=Xt({},y,{contentId:Za(e.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${t} and asset ${p}`);const v=new ND(this.HlsPlayerClass,g,t,e);this.playerQueue.push(v),t.assetList[i]=e;let S=!0;const T=C=>{if(C.live){var D;const P=new Error(`Interstitials MUST be VOD assets ${t}`),B={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:P},M=((D=this.schedule)==null?void 0:D.findEventIndex(t.identifier))||-1;this.handleAssetItemError(B,t,M,i,P.message);return}const N=C.edge-C.fragmentStart,w=e.duration;(S||w===null||N>w)&&(S=!1,this.log(`Interstitial asset "${p}" duration change ${w} > ${N}`),e.duration=N,this.updateSchedule())};v.on(_.LEVEL_UPDATED,(C,{details:D})=>T(D)),v.on(_.LEVEL_PTS_UPDATED,(C,{details:D})=>T(D)),v.on(_.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const A=(C,D)=>{const N=this.getAssetPlayer(p);if(N&&D.tracks){N.off(_.BUFFER_CODECS,A),N.tracks=D.tracks;const w=this.primaryMedia;this.bufferingAsset===N.assetItem&&w&&!N.media&&this.bufferAssetPlayer(N,w)}};v.on(_.BUFFER_CODECS,A);const b=()=>{var C;const D=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${D}`),!D||!this.schedule)return;const N=this.schedule.findEventIndex(t.identifier),w=(C=this.schedule.items)==null?void 0:C[N];this.isInterstitial(w)&&this.advanceAssetBuffering(w,e)};v.on(_.BUFFERED_TO_END,b);const R=C=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const N=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,N,C)};return v.once(_.MEDIA_ENDED,R(i)),v.once(_.PLAYOUT_LIMIT_REACHED,R(1/0)),v.on(_.ERROR,(C,D)=>{if(!this.schedule)return;const N=this.getAssetPlayer(p);if(D.details===Q.BUFFER_STALLED_ERROR){if(N!=null&&N.appendInPlace){this.handleInPlaceStall(t);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(D,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${D.error} ${t}`)}),v.on(_.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const D=new Error(`Asset player destroyed unexpectedly ${p}`),N={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:D};this.handleAssetItemError(N,t,this.schedule.findEventIndex(t.identifier),i,D.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Br(e)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:v}),v}clearInterstitial(t,e){t.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,e)}),t.reset()}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(e!==-1){this.log(`reset asset player "${t}" after error`);const i=this.playerQueue[e];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(t,e){const i=this.getAssetPlayerQueueIndex(t);if(i!==-1){const s=this.playerQueue[i];this.log(`clear ${s} toSegment: ${e&&ki(e)}`),this.transferMediaFromPlayer(s,e),this.playerQueue.splice(i,1),s.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,s,a){const{interstitial:l,assetItem:u,assetId:d}=t,f=l.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!h||h.identifier!==d)&&(h&&(this.clearAssetPlayer(h.identifier,i[s]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${f} ${Br(u)}`),this.hls.trigger(_.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:e,event:l,schedule:i.slice(0),scheduleIndex:s,player:t})),this.bufferAssetPlayer(t,a)}bufferAssetPlayer(t,e){var i,s;if(!this.schedule)return;const{interstitial:a,assetItem:l}=t,u=this.schedule.findEventIndex(a.identifier),d=(i=this.schedule.items)==null?void 0:i[u];if(!d)return;t.loadSource(),this.setBufferingItem(d),this.bufferingAsset=l;const f=this.getBufferingPlayer();if(f===t)return;const h=a.appendInPlace;if(h&&f?.interstitial.appendInPlace===!1)return;const p=f?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(h&&l!==this.playingAsset){if(!t.tracks){this.log(`Waiting for track info before buffering ${t}`);return}if(p&&!jE(p,t.tracks)){const g=new Error(`Asset ${Br(l)} SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),y={fatal:!0,type:vt.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:g},v=a.findAssetIndex(l);this.handleAssetItemError(y,a,u,v,g.message);return}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,i=this.primaryMedia;if(!e||!i)return;const s=i.currentTime,a=e.findAssetIndex(t,s),l=t.assetList[a];if(l){const u=this.getAssetPlayer(l.identifier);if(u){const d=u.currentTime||s-l.timelineStart,f=u.duration-d;if(this.warn(`Stalled at ${d} of ${d+f} in ${u} ${t} (media.currentTime: ${s})`),d&&(f/i.playbackRate<.5||u.bufferedInPlaceToEnd(i))&&u.hls){const h=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,h,a)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,i,s,a){if(t.details===Q.BUFFER_STALLED_ERROR)return;const l=e.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${l&&Br(l)} ${t.error}`),!this.schedule)return;const u=l?.identifier||"",d=this.getAssetPlayerQueueIndex(u),f=this.playerQueue[d]||null,h=this.schedule.items,p=Xt({},t,{fatal:!1,errorAction:Gr(!0),asset:l,assetListIndex:s,event:e,schedule:h,scheduleIndex:i,player:f});if(this.hls.trigger(_.INTERSTITIAL_ASSET_ERROR,p),!t.fatal)return;const g=this.playingAsset,y=this.bufferingAsset,v=new Error(a);if(l&&(this.clearAssetPlayer(u,null),l.error=v),!e.assetList.some(S=>!S.error))e.error=v;else for(let S=s;S<e.assetList.length;S++)this.resetAssetPlayer(e.assetList[S].identifier);this.updateSchedule(!0),e.error?this.primaryFallback(e):g&&g.identifier===u?this.advanceAfterAssetEnded(e,i,s):y&&y.identifier===u&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,y)}primaryFallback(t){const e=t.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${ki(i)} error: ${t.error}`);let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const a=this.updateItem(i,s);if(this.itemsMatch(i,a)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e)),!this.schedule)return;const l=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(l)}else this.checkStart()}onAssetListLoaded(t,e){var i,s;const a=e.event,l=a.identifier,u=e.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(l)))return;const d=a.timelineStart,f=a.duration;let h=0;u.forEach((S,T)=>{const A=parseFloat(S.DURATION);this.createAsset(a,T,h,d+h,A,S.URI),h+=A}),a.duration=h,this.log(`Loaded asset-list with duration: ${h} (was: ${f}) ${a}`);const p=this.waitingItem,g=p?.event.identifier===l;this.updateSchedule();const y=(s=this.bufferingItem)==null?void 0:s.event;if(g){var v;const S=this.schedule.findEventIndex(l),T=(v=this.schedule.items)==null?void 0:v[S];if(T){if(!this.playingItem&&this.timelinePos>T.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){a.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${a}`),this.updateSchedule(!0),this.primaryFallback(a);return}this.setBufferingItem(T)}this.setSchedulePosition(S)}else if(y?.identifier===l){const S=a.assetList[0];if(S){const T=this.getAssetPlayer(S.identifier);if(y.appendInPlace){const A=this.primaryMedia;T&&A&&this.bufferAssetPlayer(T,A)}else T&&T.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const i=e.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case Q.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Lv=500;class $D extends Ph{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller",mt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=at.IDLE,this.setInterval(Lv),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:s}=e;if(this.fragContextChanged(i)||(xe(i)&&(this.fragPrevious=i),this.state=at.IDLE),!s)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let l;const u=i.start;for(let f=0;f<a.length;f++)if(u>=a[f].start&&u<=a[f].end){l=a[f];break}const d=i.start+i.duration;l?l.end=d:(l={start:u,end:d},a.push(l)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:i,endOffset:s}=e;if(i===0&&s!==Number.POSITIVE_INFINITY){const a=s-1;if(a<=0)return;e.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(l=>{for(let u=0;u<l.length;){if(l[u].end<=a){l.shift();continue}else if(l[u].start<a)l[u].start=a;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(i,a,mt.SUBTITLE)}}onError(t,e){const i=e.frag;i?.type===mt.SUBTITLE&&(e.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==at.STOPPED&&(this.state=at.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){if(this.levels&&zx(this.levels,e)){this.levels=e.map(i=>new so(i));return}this.tracksBuffered=[],this.levels=e.map(i=>{const s=new so(i);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,mt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==at.STOPPED&&this.setInterval(Lv)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:s,levels:a}=this,{details:l,id:u}=e;if(!a){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const d=a[u];if(u>=a.length||!d)return;this.log(`Subtitle track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(l.live||(i=d.details)!=null&&i.live){if(l.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const g=p.fragments[0];if(!d.details)l.hasProgramDateTime&&p.hasProgramDateTime?(Su(l,p),f=l.fragmentStart):g&&(f=g.start,Wd(l,f));else{var h;f=this.alignPlaylists(l,d.details,(h=this.levelLastLoaded)==null?void 0:h.details),f===0&&g&&(f=g.start,Wd(l,f))}p&&!this.startFragRequested&&this.setStartPosition(p,f)}d.details=l,this.levelLastLoaded=d,u===s&&(this.hls.trigger(_.SUBTITLE_TRACK_UPDATED,{details:l,id:u,groupId:e.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===at.IDLE&&(Vs(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,s=e.decryptdata,a=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&s!=null&&s.key&&s.iv&&Hr(s.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer,kh(s.method)).catch(u=>{throw a.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:e}),u}).then(u=>{const d=performance.now();a.trigger(_.FRAG_DECRYPTED,{frag:e,payload:u,stats:{tstart:l,tdecrypt:d}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=at.IDLE})}}doTick(){if(!this.media){this.state=at.IDLE;return}if(this.state===at.IDLE){const{currentTrackId:t,levels:e}=this,i=e?.[t];if(!i||!e.length||!i.details||this.waitForLive(i))return;const{config:s}=this,a=this.getLoadPosition(),l=At.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,s.maxBufferHole),{end:u,len:d}=l,f=i.details,h=this.hls.maxBufferLength+f.levelTargetDuration;if(d>h)return;const p=f.fragments,g=p.length,y=f.edge;let v=null;const S=this.fragPrevious;if(u<y){const b=s.maxFragLookUpTolerance,R=u>y-b?0:b;v=Vs(S,p,Math.max(p[0].start,u),R),!v&&S&&S.start<p[0].start&&(v=p[0])}else v=p[g-1];if(v=this.filterReplacedPrimary(v,i.details),!v)return;const T=v.sn-f.startSN,A=p[T-1];if(A&&A.cc===v.cc&&this.fragmentTracker.getState(A)===Ae.NOT_LOADED&&(v=A),this.fragmentTracker.getState(v)===Ae.NOT_LOADED){const b=this.mapToInitFragWhenRequired(v);b&&this.loadFragment(b,i,u)}}}loadFragment(t,e,i){xe(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new jD(this.tracksBuffered[this.currentTrackId]||[])}}class jD{constructor(t){this.buffered=void 0;const e=(i,s,a)=>{if(s=s>>>0,s>a-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${a})`);return t[s][i]};this.buffered={get length(){return t.length},end(i){return e("end",i,t.length)},start(i){return e("start",i,t.length)}}}}const GD={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},aS=r=>String.fromCharCode(GD[r]||r),Mi=15,Cn=100,HD={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},zD={17:2,18:4,21:6,22:8,23:10,19:13,20:15},VD={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},KD={25:2,26:4,29:6,30:8,31:10,27:13,28:15},qD=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class YD{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i=typeof e=="function"?e():e;Vt.log(`${this.time} [${t}] ${i}`)}}}const Bs=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class oS{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class XD{constructor(){this.uchar=" ",this.penState=new oS}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class WD{constructor(t){this.chars=[],this.pos=0,this.currPenState=new oS,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<Cn;e++)this.chars.push(new XD);this.logger=t}equals(t){for(let e=0;e<Cn;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<Cn;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<Cn;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Cn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Cn)}moveCursor(t){const e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=aS(t);if(this.pos>=Cn){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)}clearFromPos(t){let e;for(e=t;e<Cn;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<Cn;i++){const s=this.chars[i].uchar;s!==" "&&(e=!1),t.push(s)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class Ld{constructor(t){this.rows=[],this.currRow=Mi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<Mi;e++)this.rows.push(new WD(t));this.logger=t}reset(){for(let t=0;t<Mi;t++)this.rows[t].clear();this.currRow=Mi-1}equals(t){let e=!0;for(let i=0;i<Mi;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<Mi;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<Mi;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+Zt(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let u=0;u<Mi;u++)this.rows[u].clear();const a=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const u=l.rows[a].cueStartTime,d=this.logger.time;if(u!==null&&d!==null&&u<d)for(let f=0;f<this.nrRollUpRows;f++)this.rows[e-this.nrRollUpRows+f+1].copy(l.rows[a+f])}}this.currRow=e;const i=this.rows[this.currRow];if(t.indent!==null){const a=t.indent,l=Math.max(a-1,0);i.setCursor(t.indent),t.color=i.chars[l].penState.foreground}const s={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+Zt(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",s=-1;for(let a=0;a<Mi;a++){const l=this.rows[a].getTextString();l&&(s=a+1,t?e.push("Row "+s+": '"+l+"'"):e.push(l.trim()))}return e.length>0&&(t?i="["+e.join(" | ")+"]":i=e.join(`
`)),i}getTextAndFormat(){return this.rows}}class _v{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Ld(i),this.nonDisplayedMemory=new Ld(i),this.lastOutputScreen=new Ld(i),this.currRollUpRow=this.displayedMemory.rows[Mi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Mi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=s[i]}this.logger.log(2,"MIDROW: "+Zt(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;e!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=e:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Cv{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=ZD(),this.logger=void 0;const s=this.logger=new YD;this.channels=[null,new _v(t,e,s),new _v(t+1,i,s)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){const s=e[i]&127,a=e[i+1]&127;let l=!1,u=null;if(s===0&&a===0)continue;this.logger.log(3,()=>"["+Bs([e[i],e[i+1]])+"] -> ("+Bs([s,a])+")");const d=this.cmdHistory;if(s>=16&&s<=31){if(QD(s,a,d)){zl(null,null,d),this.logger.log(3,()=>"Repeated command ("+Bs([s,a])+") is dropped");continue}zl(s,a,this.cmdHistory),l=this.parseCmd(s,a),l||(l=this.parseMidrow(s,a)),l||(l=this.parsePAC(s,a)),l||(l=this.parseBackgroundAttributes(s,a))}else zl(null,null,d);if(!l&&(u=this.parseChars(s,a),u)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Bs([s,a])+" orig: "+Bs([e[i],e[i+1]]))}}parseCmd(t,e){const i=(t===20||t===28||t===21||t===29)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=33&&e<=35;if(!(i||s))return!1;const a=t===20||t===21||t===23?1:2,l=this.channels[a];return t===20||t===21||t===28||t===29?e===32?l.ccRCL():e===33?l.ccBS():e===34?l.ccAOF():e===35?l.ccAON():e===36?l.ccDER():e===37?l.ccRU(2):e===38?l.ccRU(3):e===39?l.ccRU(4):e===40?l.ccFON():e===41?l.ccRDC():e===42?l.ccTR():e===43?l.ccRTD():e===44?l.ccEDM():e===45?l.ccCR():e===46?l.ccENM():e===47&&l.ccEOC():l.ccTO(e-32),this.currentChannel=a,!0}parseMidrow(t,e){let i=0;if((t===17||t===25)&&e>=32&&e<=47){if(t===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return s?(s.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+Bs([t,e])+")"),!0):!1}return!1}parsePAC(t,e){let i;const s=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,a=(t===16||t===24)&&e>=64&&e<=95;if(!(s||a))return!1;const l=t<=23?1:2;e>=64&&e<=95?i=l===1?HD[t]:VD[t]:i=l===1?zD[t]:KD[t];const u=this.channels[l];return u?(u.setPAC(this.interpretPAC(i,e)),this.currentChannel=l,!0):!1}interpretPAC(t,e){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:t};return e>95?i=e-96:i=e-64,s.underline=(i&1)===1,i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((i-16)/2)*4,s}parseChars(t,e){let i,s=null,a=null;if(t>=25?(i=2,a=t-8):(i=1,a=t),a>=17&&a<=19){let l;a===17?l=e+80:a===18?l=e+112:l=e+144,this.logger.log(2,()=>"Special char '"+aS(l)+"' in channel "+i),s=[l]}else t>=32&&t<=127&&(s=e===0?[t]:[t,e]);return s&&this.logger.log(3,()=>"Char codes =  "+Bs(s).join(",")),s}parseBackgroundAttributes(t,e){const i=(t===16||t===24)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=45&&e<=47;if(!(i||s))return!1;let a;const l={};t===16||t===24?(a=Math.floor((e-32)/2),l.background=qD[a],e%2===1&&(l.background=l.background+"_semi")):e===45?l.background="transparent":(l.foreground="black",e===47&&(l.underline=!0));const u=t<=23?1:2;return this.channels[u].setBkgData(l),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}zl(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function zl(r,t,e){e.a=r,e.b=t}function QD(r,t,e){return e.a===r&&e.b===t}function ZD(){return{a:null,b:null}}var qh=(function(){if(xu!=null&&xu.VTTCue)return self.VTTCue;const r=["","lr","rl"],t=["start","middle","end","left","right"];function e(u,d){if(typeof d!="string"||!Array.isArray(u))return!1;const f=d.toLowerCase();return~u.indexOf(f)?f:!1}function i(u){return e(r,u)}function s(u){return e(t,u)}function a(u,...d){let f=1;for(;f<arguments.length;f++){const h=arguments[f];for(const p in h)u[p]=h[p]}return u}function l(u,d,f){const h=this,p={enumerable:!0};h.hasBeenReset=!1;let g="",y=!1,v=u,S=d,T=f,A=null,b="",R=!0,C="auto",D="start",N=50,w="middle",P=50,B="middle";Object.defineProperty(h,"id",a({},p,{get:function(){return g},set:function(M){g=""+M}})),Object.defineProperty(h,"pauseOnExit",a({},p,{get:function(){return y},set:function(M){y=!!M}})),Object.defineProperty(h,"startTime",a({},p,{get:function(){return v},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");v=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",a({},p,{get:function(){return S},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");S=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",a({},p,{get:function(){return T},set:function(M){T=""+M,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",a({},p,{get:function(){return A},set:function(M){A=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",a({},p,{get:function(){return b},set:function(M){const K=i(M);if(K===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=K,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",a({},p,{get:function(){return R},set:function(M){R=!!M,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",a({},p,{get:function(){return C},set:function(M){if(typeof M!="number"&&M!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",a({},p,{get:function(){return D},set:function(M){const K=s(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");D=K,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",a({},p,{get:function(){return N},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");N=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",a({},p,{get:function(){return w},set:function(M){const K=s(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");w=K,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",a({},p,{get:function(){return P},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");P=M,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",a({},p,{get:function(){return B},set:function(M){const K=s(M);if(!K)throw new SyntaxError("An invalid or illegal string was specified.");B=K,this.hasBeenReset=!0}})),h.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l})();class JD{decode(t,e){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function lS(r){function t(i,s,a,l){return(i|0)*3600+(s|0)*60+(a|0)+parseFloat(l||0)}const e=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return e?parseFloat(e[2])>59?t(e[2],e[3],0,e[4]):t(e[1],e[2],e[3],e[4]):null}class tI{constructor(){this.values=Object.create(null)}set(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let s=0;s<i.length;++s)if(e===i[s]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function uS(r,t,e,i){const s=i?r.split(i):[r];for(const a in s){if(typeof s[a]!="string")continue;const l=s[a].split(e);if(l.length!==2)continue;const u=l[0],d=l[1];t(u,d)}}const sh=new qh(0,0,""),Vl=sh.align==="middle"?"middle":"center";function eI(r,t,e){const i=r;function s(){const u=lS(r);if(u===null)throw new Error("Malformed timestamp: "+i);return r=r.replace(/^[^\sa-zA-Z-]+/,""),u}function a(u,d){const f=new tI;uS(u,function(g,y){let v;switch(g){case"region":for(let S=e.length-1;S>=0;S--)if(e[S].id===y){f.set(g,e[S].region);break}break;case"vertical":f.alt(g,y,["rl","lr"]);break;case"line":v=y.split(","),f.integer(g,v[0]),f.percent(g,v[0])&&f.set("snapToLines",!1),f.alt(g,v[0],["auto"]),v.length===2&&f.alt("lineAlign",v[1],["start",Vl,"end"]);break;case"position":v=y.split(","),f.percent(g,v[0]),v.length===2&&f.alt("positionAlign",v[1],["start",Vl,"end","line-left","line-right","auto"]);break;case"size":f.percent(g,y);break;case"align":f.alt(g,y,["start",Vl,"end","left","right"]);break}},/:/,/\s/),d.region=f.get("region",null),d.vertical=f.get("vertical","");let h=f.get("line","auto");h==="auto"&&sh.line===-1&&(h=-1),d.line=h,d.lineAlign=f.get("lineAlign","start"),d.snapToLines=f.get("snapToLines",!0),d.size=f.get("size",100),d.align=f.get("align",Vl);let p=f.get("position","auto");p==="auto"&&sh.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function l(){r=r.replace(/^\s+/,"")}if(l(),t.startTime=s(),l(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);r=r.slice(3),l(),t.endTime=s(),l(),a(r,t)}function cS(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class iI{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new JD,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){let a=e.buffer,l=0;for(a=cS(a);l<a.length&&a[l]!=="\r"&&a[l]!==`
`;)++l;const u=a.slice(0,l);return a[l]==="\r"&&++l,a[l]===`
`&&++l,e.buffer=a.slice(l),u}function s(a){uS(a,function(l,u){},/:/)}try{let a="";if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;a=i();const u=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let l=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(l?l=!1:a=i(),e.state){case"HEADER":/:/.test(a)?s(a):a||(e.state="ID");continue;case"NOTE":a||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){e.state="NOTE";break}if(!a)continue;if(e.cue=new qh(0,0,""),e.state="CUE",a.indexOf("-->")===-1){e.cue.id=a;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{eI(a,e.cue,e.regionList)}catch{e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const u=a.indexOf("-->")!==-1;if(!a||u&&(l=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(e.cue===null)continue;e.cue.text&&(e.cue.text+=`
`),e.cue.text+=a}continue;case"BADCUE":a||(e.state="ID")}}}catch{e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const nI=/\r\n|\n\r|\n|\r/g,_d=function(t,e,i=0){return t.slice(i,i+e.length)===e},sI=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),s=parseInt(t.slice(-9,-7)),a=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!ht(e)||!ht(i)||!ht(s)||!ht(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=60*1e3*s,e+=3600*1e3*a,e};function Yh(r,t,e){return Za(r.toString())+Za(t.toString())+Za(e)}const rI=function(t,e,i){let s=t[e],a=t[s.prevCC];if(!a||!a.new&&s.new){t.ccOffset=t.presentationOffset=s.start,s.new=!1;return}for(;(l=a)!=null&&l.new;){var l;t.ccOffset+=s.start-a.start,s.new=!1,s=a,a=t[s.prevCC]}t.presentationOffset=i};function aI(r,t,e,i,s,a,l){const u=new iI,d=gi(new Uint8Array(r)).trim().replace(nI,`
`).split(`
`),f=[],h=t?dw(t.baseTime,t.timescale):0;let p="00:00.000",g=0,y=0,v,S=!0;u.oncue=function(T){const A=e[i];let b=e.ccOffset;const R=(g-h)/9e4;if(A!=null&&A.new&&(y!==void 0?b=e.ccOffset=A.start:rI(e,i,R)),R){if(!t){v=new Error("Missing initPTS for VTT MPEGTS");return}b=R-e.presentationOffset}const C=T.endTime-T.startTime,D=di((T.startTime+b-y)*9e4,s*9e4)/9e4;T.startTime=Math.max(D,0),T.endTime=Math.max(D+C,0);const N=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(N)),T.id||(T.id=Yh(T.startTime,T.endTime,N)),T.endTime>0&&f.push(T)},u.onparsingerror=function(T){v=T},u.onflush=function(){if(v){l(v);return}a(f)},d.forEach(T=>{if(S)if(_d(T,"X-TIMESTAMP-MAP=")){S=!1,T.slice(16).split(",").forEach(A=>{_d(A,"LOCAL:")?p=A.slice(6):_d(A,"MPEGTS:")&&(g=parseInt(A.slice(7)))});try{y=sI(p)/1e3}catch(A){v=A}return}else T===""&&(S=!1);u.parse(T+`
`)}),u.flush()}const Cd="stpp.ttml.im1t",fS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,dS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,oI={left:"start",center:"center",right:"end",start:"start",end:"end"};function wv(r,t,e,i){const s=Dt(new Uint8Array(r),["mdat"]);if(s.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const a=s.map(u=>gi(u)),l=fw(t.baseTime,1,t.timescale);try{a.forEach(u=>e(lI(u,l)))}catch(u){i(u)}}function lI(r,t){const s=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(a).reduce((p,g)=>(p[g]=s.getAttribute(`ttp:${g}`)||a[g],p),{}),u=s.getAttribute("xml:space")!=="preserve",d=Dv(wd(s,"styling","style")),f=Dv(wd(s,"layout","region")),h=wd(s,"body","[begin]");return[].map.call(h,p=>{const g=hS(p,u);if(!g||!p.hasAttribute("begin"))return null;const y=Id(p.getAttribute("begin"),l),v=Id(p.getAttribute("dur"),l);let S=Id(p.getAttribute("end"),l);if(y===null)throw Iv(p);if(S===null){if(v===null)throw Iv(p);S=y+v}const T=new qh(y-t,S-t,g);T.id=Yh(T.startTime,T.endTime,T.text);const A=f[p.getAttribute("region")],b=d[p.getAttribute("style")],R=uI(A,b,d),{textAlign:C}=R;if(C){const D=oI[C];D&&(T.lineAlign=D),T.align=C}return Xt(T,R),T}).filter(p=>p!==null)}function wd(r,t,e){const i=r.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(e)):[]}function Dv(r){return r.reduce((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t},{})}function hS(r,t){return[].slice.call(r.childNodes).reduce((e,i,s)=>{var a;return i.nodeName==="br"&&s?e+`
`:(a=i.childNodes)!=null&&a.length?hS(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function uI(r,t,e){const i="http://www.w3.org/ns/ttml#styling";let s=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return l&&e.hasOwnProperty(l)&&(s=e[l]),a.reduce((u,d)=>{const f=Dd(t,i,d)||Dd(r,i,d)||Dd(s,i,d);return f&&(u[d]=f),u},{})}function Dd(r,t,e){return r&&r.hasAttributeNS(t,e)?r.getAttributeNS(t,e):null}function Iv(r){return new Error(`Could not parse ttml timestamp ${r}`)}function Id(r,t){if(!r)return null;let e=lS(r);return e===null&&(fS.test(r)?e=cI(r,t):dS.test(r)&&(e=fI(r,t))),e}function cI(r,t){const e=fS.exec(r),i=(e[4]|0)+(e[5]|0)/t.subFrameRate;return(e[1]|0)*3600+(e[2]|0)*60+(e[3]|0)+i/t.frameRate}function fI(r,t){const e=dS.exec(r),i=Number(e[1]);switch(e[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}class Kl{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class dI{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=kv(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(_.FRAG_LOADING,this.onFragLoading,this),t.on(_.FRAG_LOADED,this.onFragLoaded,this),t.on(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(_.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(_.FRAG_LOADING,this.onFragLoading,this),t.off(_.FRAG_LOADED,this.onFragLoaded,this),t.off(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(_.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new Kl(this,"textTrack1"),e=new Kl(this,"textTrack2"),i=new Kl(this,"textTrack3"),s=new Kl(this,"textTrack4");this.cea608Parser1=new Cv(1,t,e),this.cea608Parser2=new Cv(3,i,s)}addCues(t,e,i,s,a){let l=!1;for(let u=a.length;u--;){const d=a[u],f=hI(d[0],d[1],e,i);if(f>=0&&(d[0]=Math.min(d[0],e),d[1]=Math.max(d[1],i),l=!0,f/(i-e)>.5))return}if(l||a.push([e,i]),this.config.renderTextTracksNatively){const u=this.captionsTracks[t];this.Cues.newCue(u,e,i,s)}else{const u=this.Cues.newCue(null,e,i,s);this.hls.trigger(_.CUES_PARSED,{type:"captions",cues:u,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:a,trackId:l}){const{unparsedVttFrags:u}=this;i===mt.MAIN&&(this.initPTS[e.cc]={baseTime:s,timescale:a,trackId:l}),u.length&&(this.unparsedVttFrags=[],u.forEach(d=>{this.initPTS[d.frag.cc]?this.onFragLoaded(_.FRAG_LOADED,d):this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){const a=i.textTracks[s];if(Ov(a,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:s}=this,{label:a,languageCode:l}=e[t],u=this.getExistingTrack(a,l);if(u)i[t]=u,$r(i[t]),nS(i[t],s);else{const d=this.createTextTrack("captions",a,l);d&&(d[t]=!0,i[t]=d)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const i=e.label,s={_id:t,label:i,kind:"captions",default:e.media?!!e.media.default:!1,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=s,this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(t,e,i){const s=this.media;if(s)return s.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const i=!!e.transferMedia;if(this.media=null,i)return;const{captionsTracks:s}=this;Object.keys(s).forEach(a=>{$r(s[a]),delete s[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=kv(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let i=0;i<e.length;i++)$r(e[i])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],s=i.some(a=>a.textCodec===Cd);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(zx(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const l=this.media,u=l?su(l.textTracks):null;if(this.tracks.forEach((d,f)=>{let h;if(u){let p=null;for(let g=0;g<u.length;g++)if(u[g]&&Ov(u[g],d)){p=u[g],u[g]=null;break}p&&(h=p)}if(h)$r(h);else{const p=mS(d);h=this.createTextTrack(p,d.name,d.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),u!=null&&u.length){const d=u.filter(f=>f!==null).map(f=>f.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(i=>{const s=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!s)return;const a=`textTrack${s[1]}`,l=this.captionsProperties[a];l&&(l.label=i.name,i.lang&&(l.languageCode=i.lang),l.media=i)})}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return e?.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===mt.MAIN){var i,s;const{cea608Parser1:a,cea608Parser2:l,lastSn:u}=this,{cc:d,sn:f}=e.frag,h=(i=(s=e.part)==null?void 0:s.index)!=null?i:-1;a&&l&&(f!==u+1||f===u&&h!==this.lastPartIndex+1||d!==this.lastCc)&&(a.reset(),l.reset()),this.lastCc=d,this.lastSn=f,this.lastPartIndex=h}}onFragLoaded(t,e){const{frag:i,payload:s}=e;if(i.type===mt.SUBTITLE)if(s.byteLength){const a=i.decryptdata,l="stats"in e;if(a==null||!a.encrypted||l){const u=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),u&&u.textCodec===Cd?this._parseIMSC1(i,s):this._parseVTTs(e)}}else this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;wv(e,this.initPTS[t.cc],s=>{this._appendCues(s,t.level),i.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},s=>{i.logger.log(`Failed to parse IMSC1: ${s}`),i.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:s})})}_parseVTTs(t){var e;const{frag:i,payload:s}=t,{initPTS:a,unparsedVttFrags:l}=this,u=a.length-1;if(!a[i.cc]&&u===-1){l.push(t);return}const d=this.hls,f=(e=i.initSegment)!=null&&e.data?Ci(i.initSegment.data,new Uint8Array(s)).buffer:s;aI(f,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,h=>{this._appendCues(h,i.level),d.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},h=>{const p=h.message==="Missing initPTS for VTT MPEGTS";p?l.push(t):this._fallbackToIMSC1(i,s),d.logger.log(`Failed to parse VTT cue: ${h}`),!(p&&u>i.cc)&&d.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:h})})}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||wv(e,this.initPTS[t.cc],()=>{i.textCodec=Cd,this._parseIMSC1(t,e)},()=>{i.textCodec="wvtt"})}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[e];if(!s||s.mode==="disabled")return;t.forEach(a=>sS(s,a))}else{const s=this.tracks[e];if(!s)return;const a=s.default?"default":"subtitles"+e;i.trigger(_.CUES_PARSED,{type:"subtitles",cues:t,track:a})}}onFragDecrypted(t,e){const{frag:i}=e;i.type===mt.SUBTITLE&&this.onFragLoaded(_.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:s}=e;if(!(i.type===mt.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let a=0;a<s.length;a++){const l=s[a].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(l);this.cea608Parser1.addData(s[a].pts,u[0]),this.cea608Parser2.addData(s[a].pts,u[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:s,type:a}){const{media:l}=this;if(!(!l||l.currentTime<i)){if(!a||a==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(d=>nh(u[d],e,i))}if(this.config.renderTextTracksNatively&&e===0&&s!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(d=>nh(u[d],e,s))}}}extractCea608Data(t){const e=[[],[]],i=t[0]&31;let s=2;for(let a=0;a<i;a++){const l=t[s++],u=127&t[s++],d=127&t[s++];if(u===0&&d===0)continue;if((4&l)!==0){const h=3&l;(h===0||h===1)&&(e[h].push(u),e[h].push(d))}}return e}}function mS(r){return r.characteristics&&/transcribes-spoken-dialog/gi.test(r.characteristics)&&/describes-music-and-sound/gi.test(r.characteristics)?"captions":"subtitles"}function Ov(r,t){return!!r&&r.kind===mS(t)&&Jd(t,r)}function hI(r,t,e,i){return Math.min(t,i)-Math.max(r,e)}function kv(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const mI=/\s/,pI={newCue(r,t,e,i){const s=[];let a,l,u,d,f;const h=self.VTTCue||self.TextTrackCue;for(let g=0;g<i.rows.length;g++)if(a=i.rows[g],u=!0,d=0,f="",!a.isEmpty()){var p;for(let S=0;S<a.chars.length;S++)mI.test(a.chars[S].uchar)&&u?d++:(f+=a.chars[S].uchar,u=!1);a.cueStartTime=t,t===e&&(e+=1e-4),d>=16?d--:d++;const y=cS(f.trim()),v=Yh(t,e,y);r!=null&&(p=r.cues)!=null&&p.getCueById(v)||(l=new h(t,e,y),l.id=v,l.line=g+1,l.align="left",l.position=10+Math.min(80,Math.floor(d*8/32)*10),s.push(l))}return r&&s.length&&(s.sort((g,y)=>g.line==="auto"||y.line==="auto"?0:g.line>8&&y.line>8?y.line-g.line:g.line-y.line),s.forEach(g=>sS(r,g))),s}};function gI(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const yI=/(\d+)-(\d+)\/(\d+)/;class Mv{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||SI,this.controller=new self.AbortController,this.stats=new Lh}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const a=vI(t,this.controller.signal),l=t.responseType==="arraybuffer",u=l?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:f}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,a),self.clearTimeout(this.requestTimeout),e.timeout=d&&ht(d)?d:f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},e.timeout),(oo(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var g;this.response=this.loader=p;const y=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=f,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},f-(y-s.loading.start)),!p.ok){const{status:S,statusText:T}=p;throw new TI(T||"fetch, bad network response",S,p)}s.loading.first=y,s.total=xI(p.headers)||s.total;const v=(g=this.callbacks)==null?void 0:g.onProgress;return v&&ht(e.highWaterMark)?this.loadProgressively(p,s,t,e.highWaterMark,v):l?p.arrayBuffer():t.responseType==="json"?p.json():p.text()}).then(p=>{var g,y;const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const S=p[u];S&&(s.loaded=s.total=S);const T={url:v.url,data:p,code:v.status},A=(g=this.callbacks)==null?void 0:g.onProgress;A&&!ht(e.highWaterMark)&&A(s,t,p,v),(y=this.callbacks)==null||y.onSuccess(T,s,t,v)}).catch(p=>{var g;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const y=p&&p.code||0,v=p?p.message:null;(g=this.callbacks)==null||g.onError({code:y,text:v},t,p?p.details:null,s)})}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,s=0,a){const l=new Ax,u=t.body.getReader(),d=()=>u.read().then(f=>{if(f.done)return l.dataLength&&a(e,i,l.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const h=f.value,p=h.length;return e.loaded+=p,p<s||l.dataLength?(l.push(h),l.dataLength>=s&&a(e,i,l.flush().buffer,t)):a(e,i,h.buffer,t),d()}).catch(()=>Promise.reject());return d()}}function vI(r,t){const e={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Xt({},r.headers))};return r.rangeEnd&&e.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),e}function EI(r){const t=yI.exec(r);if(t)return parseInt(t[2])-parseInt(t[1])+1}function xI(r){const t=r.get("Content-Range");if(t){const i=EI(t);if(ht(i))return i}const e=r.get("Content-Length");if(e)return parseInt(e)}function SI(r,t){return new self.Request(r.url,t)}class TI extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const bI=/^age:\s*[\d.]+\s*$/im;class pS{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Lh,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return a(i,e.url)}).catch(l=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",e.url,!0),a(i,e.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)}).catch(l=>{var u;(u=this.callbacks)==null||u.onError({code:i.status,text:l.message},e,i,s)}):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const s=e.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:l}=i.loadPolicy;if(s)for(const u in s)t.setRequestHeader(u,s[u]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&ht(a)?a:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const s=e.readyState,a=this.config;if(!i.aborted&&s>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const f=e.status,h=e.responseType==="text"?e.responseText:null;if(f>=200&&f<300){const v=h??e.response;if(v!=null){var l,u;i.loading.end=Math.max(self.performance.now(),i.loading.first);const S=e.responseType==="arraybuffer"?v.byteLength:v.length;i.loaded=i.total=S,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const T=(l=this.callbacks)==null?void 0:l.onProgress;T&&T(i,t,v,e);const A={url:e.responseURL,data:v,code:f};(u=this.callbacks)==null||u.onSuccess(A,i,t,e);return}}const p=a.loadPolicy.errorRetry,g=i.retry,y={url:t.url,data:void 0,code:f};if(vu(p,g,!1,y))this.retry(p);else{var d;Vt.error(`${f} while loading ${t.url}`),(d=this.callbacks)==null||d.onError({code:f,text:e.statusText},t,e,i)}}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry,e=this.stats.retry;if(vu(t,e,!0))this.retry(t);else{var i;Vt.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=Dh(t,i.retry),i.retry++,Vt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e?.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&bI.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const AI={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},RI=zt(zt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:pS,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:F_,bufferController:_w,capLevelController:zh,errorController:G_,fpsController:CD,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:hx,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:AI},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},LI()),{},{subtitleStreamController:$D,subtitleTrackController:ID,timelineController:dI,audioStreamController:bw,audioTrackController:Aw,emeController:zr,cmcdController:AD,contentSteeringController:LD,interstitialsController:UD});function LI(){return{cueHandler:pI,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function _I(r,t,e){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=rh(r),s=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(l=>{const u=`${l==="level"?"playlist":l}LoadPolicy`,d=t[u]===void 0,f=[];a.forEach(h=>{const p=`${l}Loading${h}`,g=t[p];if(g!==void 0&&d){f.push(p);const y=i[u].default;switch(t[u]={default:y},h){case"TimeOut":y.maxLoadTimeMs=g,y.maxTimeToFirstByteMs=g;break;case"MaxRetry":y.errorRetry.maxNumRetry=g,y.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":y.errorRetry.retryDelayMs=g,y.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":y.errorRetry.maxRetryDelayMs=g,y.timeoutRetry.maxRetryDelayMs=g;break}}}),f.length&&e.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${u}": ${Zt(t[u])}`)}),zt(zt({},i),t)}function rh(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(rh):Object.keys(r).reduce((t,e)=>(t[e]=rh(r[e]),t),{}):r}function CI(r,t){const e=r.loader;e!==Mv&&e!==pS?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):gI()&&(r.loader=Mv,r.progressive=!0,r.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}const ru=2,wI=.1,DI=.05,II=100;class OI extends lx{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1})}},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(II),this.mediaSource=e.mediaSource;const i=this.media=e.media;Ke(i,"playing",this.onMediaPlaying),Ke(i,"waiting",this.onMediaWaiting),Ke(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:i}=this;i&&(ii(i,"playing",this.onMediaPlaying),ii(i,"waiting",this.onMediaWaiting),ii(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(!((t=this.media)!=null&&t.readyState)||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,s;const a=(i=this.hls)==null?void 0:i.config;if(!a)return;const l=this.media;if(!l)return;const{seeking:u}=l,d=this.seeking&&!u,f=!this.seeking&&u,h=l.paused&&!u||l.ended||l.playbackRate===0;if(this.seeking=u,t!==e){e&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!h&&t>e&&this.nudgeOnVideoHole(t,e)),this.waiting===0&&this.stallResolved(t);return}if(f||d){d&&this.stallResolved(t);return}if(h){this.nudgeRetry=0,this.stallResolved(t),!this.ended&&l.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!1}));return}if(!At.getBuffered(l).length){this.nudgeRetry=0;return}const p=At.bufferInfo(l,t,0),g=p.nextStart||0,y=this.fragmentTracker;if(u&&y&&this.hls){const N=Pv(this.hls.inFlightFragments,t),w=p.len>ru,P=!g||N||g-t>ru&&!y.getPartialFragment(t);if(w||P)return;this.moved=!1}const v=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&y){if(!(p.len>0)&&!g)return;const w=Math.max(g,p.start||0)-t,B=!!(v!=null&&v.live)?v.targetduration*2:ru,M=ql(t,y);if(w>0&&(w<=B||M)){l.paused||this._trySkipBufferHole(M);return}}const S=a.detectStallWithCurrentTimeMs,T=self.performance.now(),A=this.waiting;let b=this.stalled;if(b===null)if(A>0&&T-A<S)b=this.stalled=A;else{this.stalled=T;return}const R=T-b;if(!u&&(R>=S||A)&&this.hls){var C;if(((C=this.mediaSource)==null?void 0:C.readyState)==="ended"&&!(v!=null&&v.live)&&Math.abs(t-(v?.edge||0))<1){if(this.ended)return;this.ended=t||1,this.hls.trigger(_.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const D=At.bufferInfo(l,t,a.maxBufferHole);this._tryFixBufferStall(D,R,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(_.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&s&&s.length>1&&t>s.end(0)){const a=At.bufferedInfo(At.timeRangesToArray(this.buffered.audio),t,0);if(a.len>1&&e>=a.start){const l=At.timeRangesToArray(s),u=At.bufferedInfo(l,e,0).bufferedIndex;if(u>-1&&u<l.length-1){const d=At.bufferedInfo(l,t,0).bufferedIndex,f=l[u].end,h=l[u+1].start;if((d===-1||d>u)&&h-f<1&&t-f<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${f} -> ${h} buffered index: ${d}`);this.warn(p.message),this.media.currentTime+=1e-6;let g=ql(t,this.fragmentTracker);g&&"fragment"in g?g=g.fragment:g||(g=void 0);const y=At.bufferInfo(this.media,t,0);this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:g,buffer:y.len,bufferInfo:y})}}}}}_tryFixBufferStall(t,e,i){var s,a;const{fragmentTracker:l,media:u}=this,d=(s=this.hls)==null?void 0:s.config;if(!u||!l||!d)return;const f=(a=this.hls)==null?void 0:a.latestLevelDetails,h=ql(i,l);if((h||f!=null&&f.live&&i<f.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const p=t.buffered,g=this.adjacentTraversal(t,i);(p&&p.length>1&&t.len>d.maxBufferHole||t.nextStart&&(t.nextStart-i<d.maxBufferHole||g))&&(e>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const i=this.fragmentTracker,s=t.nextStart;if(i&&s){const a=i.getFragAtPos(e,mt.MAIN),l=i.getFragAtPos(s,mt.MAIN);if(a&&l)return l.sn-a.sn<2}return!1}_reportStall(t){const{hls:e,media:i,stallReported:s,stalled:a}=this;if(!s&&a!==null&&i&&e){this.stallReported=!0;const l=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Zt(t)})`);this.warn(l.message),e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:t.len,bufferInfo:t,stalled:{start:a}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:i,media:s}=this,a=(e=this.hls)==null?void 0:e.config;if(!s||!i||!a)return 0;const l=s.currentTime,u=At.bufferInfo(s,l,0),d=l<u.start?u.start:u.nextStart;if(d&&this.hls){const h=u.len<=a.maxBufferHole,p=u.len>0&&u.len<1&&s.readyState<3,g=d-l;if(g>0&&(h||p)){if(g>a.maxBufferHole){let v=!1;if(l===0){const S=i.getAppendedFrag(0,mt.MAIN);S&&d<S.end&&(v=!0)}if(!v&&t){var f;if(!((f=this.hls.loadLevelObj)!=null&&f.details)||Pv(this.hls.inFlightFragments,d))return 0;let T=!1,A=t.end;for(;A<d;){const b=ql(A,i);if(b)A+=b.duration;else{T=!0;break}}if(T)return 0}}const y=Math.max(d+DI,l+wI);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${y}`),this.moved=!0,s.currentTime=y,!(t!=null&&t.gap)){const v=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${y}`),S={type:vt.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,buffer:u.len,bufferInfo:u};t&&("fragment"in t?S.part=t:S.frag=t),this.hls.trigger(_.ERROR,S)}return y}}return 0}_tryNudgeBuffer(t){const{hls:e,media:i,nudgeRetry:s}=this,a=e?.config;if(!i||!a)return 0;const l=i.currentTime;if(this.nudgeRetry++,s<a.nudgeMaxRetry){const u=l+(s+1)*a.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${l} to ${u}`);this.warn(d.message),i.currentTime=u,e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:t.len,bufferInfo:t})}else{const u=new Error(`Playhead still not moving while enough data buffered @${l} after ${a.nudgeMaxRetry} nudges`);this.error(u.message),e.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:t.len,bufferInfo:t})}}}function Pv(r,t){const e=Nv(r.main);if(e&&e.start<=t)return e;const i=Nv(r.audio);return i&&i.start<=t?i:null}function Nv(r){if(!r)return null;switch(r.state){case at.IDLE:case at.STOPPED:case at.ENDED:case at.ERROR:return null}return r.frag}function ql(r,t){return t.getAppendedFrag(r,mt.MAIN)||t.getPartialFragment(r)}const kI=.25;function ah(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Od(r,t,e,i,s){let a=new r(t,e,"");try{a.value=i,s&&(a.type=s)}catch{a=new r(t,e,Zt(s?zt({type:s},i):i))}return a}const Yl=(()=>{const r=ah();try{r&&new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class MI{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(_.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var i;this.media=e.media,((i=e.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var t;const e=(t=this.hls)==null?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null,!e.transferMedia&&(this.id3Track&&(this.removeCues&&$r(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if(i.kind==="metadata"&&i.label==="id3")return nS(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:s}=this.hls.config;if(!i&&!s)return;const{samples:a}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=ah();if(l)for(let u=0;u<a.length;u++){const d=a[u].type;if(d===mi.emsg&&!i||!s)continue;const f=Ix(a[u].data),h=a[u].pts;let p=h+a[u].duration;p>Yl&&(p=Yl),p-h<=0&&(p=h+kI);for(let y=0;y<f.length;y++){const v=f[y];if(!Ox(v)){this.updateId3CueEnds(h,d);const S=Od(l,h,p,v,d);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(t,e){var i;const s=(i=this.id3Track)==null?void 0:i.cues;if(s)for(let a=s.length;a--;){const l=s[a];l.type===e&&l.startTime<t&&l.endTime===Yl&&(l.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:s}){const{id3Track:a,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:d}}=l;if(a&&(u||d)){let f;s==="audio"?f=h=>h.type===mi.audioId3&&d:s==="video"?f=h=>h.type===mi.emsg&&u:f=h=>h.type===mi.audioId3&&d||h.type===mi.emsg&&u,nh(a,e,i,f)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:s,enableDateRangeMetadataCues:a,interstitialsController:l}=this.hls.config;if(!a)return;const u=ah();if(i&&s&&!l){const{fragmentStart:S,fragmentEnd:T}=t;let A=this.assetCue;A?(A.startTime=S,A.endTime=T):u&&(A=this.assetCue=Od(u,S,T,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),A&&(A.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(A),A.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:d}=this,{dateRanges:f}=t,h=Object.keys(f);let p=this.dateRangeCuesAppended;if(d&&e){var g;if((g=d.cues)!=null&&g.length){const S=Object.keys(p).filter(T=>!h.includes(T));for(let T=S.length;T--;){var y;const A=S[T],b=(y=p[A])==null?void 0:y.cues;delete p[A],b&&Object.keys(b).forEach(R=>{const C=b[R];if(C){C.removeEventListener("enter",this.onEventCueEnter);try{d.removeCue(C)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const v=t.fragments[t.fragments.length-1];if(!(h.length===0||!ht(v?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<h.length;S++){const T=h[S],A=f[T],b=A.startTime,R=p[T],C=R?.cues||{};let D=R?.durationKnown||!1,N=Yl;const{duration:w,endDate:P}=A;if(P&&w!==null)N=b+w,D=!0;else if(A.endOnNext&&!D){const M=h.reduce((K,tt)=>{if(tt!==A.id){const z=f[tt];if(z.class===A.class&&z.startDate>A.startDate&&(!K||A.startDate<K.startDate))return z}return K},null);M&&(N=M.startTime,D=!0)}const B=Object.keys(A.attr);for(let M=0;M<B.length;M++){const K=B[M];if(!eC(K))continue;const tt=C[K];if(tt)D&&!(R!=null&&R.durationKnown)?tt.endTime=N:Math.abs(tt.startTime-b)>.01&&(tt.startTime=b,tt.endTime=N);else if(u){let z=A.attr[K];iC(K)&&(z=GE(z));const Y=Od(u,b,N,{key:K,data:z},mi.dateRange);Y&&(Y.id=T,this.id3Track.addCue(Y),C[K]=Y,l&&(K==="X-ASSET-LIST"||K==="X-ASSET-URL")&&Y.addEventListener("enter",this.onEventCueEnter))}}p[T]={cues:C,dateRange:A,durationKnown:D}}}}}class PI{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,i=this.levelDetails;if(!e||!i)return;this.currentTime=e.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:l}=this.config;if(!a||l===1||!i.live)return;const u=this.targetLatency;if(u===null)return;const d=s-u,f=Math.min(this.maxLatency,u+i.targetduration);if(d<f&&d>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,l)),g=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,y=Math.min(p,Math.max(1,g));this.changeMediaPlaybackRate(e,y)}else e.playbackRate!==1&&e.playbackRate!==0&&this.changeMediaPlaybackRate(e,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return((t=this.hls)==null?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(t.liveMaxLatencyDuration!==void 0)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(t===null||this.hls===null)return null;const{holdBack:e,partHoldBack:i,targetduration:s}=t,{liveSyncDuration:a,liveSyncDurationCount:l,lowLatencyMode:u}=this.config,d=this.hls.userConfig;let f=u&&i||e;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||f===0)&&(f=a!==void 0?a:l*s);const h=s;return f+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(t===null||e===null)return null;const i=this.levelDetails;if(i===null)return null;const s=i.edge,a=t-e-this.edgeStalled,l=s-i.totalduration,u=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(l,a),u)}get drift(){const t=this.levelDetails;return t===null?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(t===null)return 0;const e=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(_.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(_.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,s;t.playbackRate!==e&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}class NI extends Hh{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this),t.on(_.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this),t.off(_.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,s=[],a={},l={};let u=!1,d=!1,f=!1;e.levels.forEach(h=>{const p=h.attrs;let{audioCodec:g,videoCodec:y}=h;g&&(h.audioCodec=g=mu(g,i)||void 0),y&&(y=h.videoCodec=v_(y));const{width:v,height:S,unknownCodecs:T}=h,A=T?.length||0;if(u||(u=!!(v&&S)),d||(d=!!y),f||(f=!!g),A||g&&!this.isAudioSupported(g)||y&&!this.isVideoSupported(y)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:b,"FRAME-RATE":R,"HDCP-LEVEL":C,"PATHWAY-ID":D,RESOLUTION:N,"VIDEO-RANGE":w}=p,B=`${`${D||"."}-`}${h.bitrate}-${N}-${R}-${b}-${w}-${C}`;if(a[B])if(a[B].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const M=l[B]+=1;h.attrs["PATHWAY-ID"]=new Array(M+1).join(".");const K=this.createLevel(h);a[B]=K,s.push(K)}else a[B].addGroupId("audio",p.AUDIO),a[B].addGroupId("text",p.SUBTITLES);else{const M=this.createLevel(h);a[B]=M,l[B]=1,s.push(M)}}),this.filterAndSortMediaOptions(s,e,u,d,f)}createLevel(t){const e=new so(t),i=t.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(s.message),e.supportedResult=tx(s,[])}return e}isAudioSupported(t){return io(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return io(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,s,a){var l;let u=[],d=[],f=t;const h=((l=e.stats)==null?void 0:l.parsing)||{};if((i||s)&&a&&(f=f.filter(({videoCodec:b,videoRange:R,width:C,height:D})=>(!!b||!!(C&&D))&&C_(R))),f.length===0){Promise.resolve().then(()=>{if(this.hls){let b="no level with compatible codecs found in manifest",R=b;e.levels.length&&(R=`one or more CODECS in variant not supported: ${Zt(e.levels.map(D=>D.attrs.CODECS).filter((D,N,w)=>w.indexOf(D)===N))}`,this.warn(R),b+=` (${R})`);const C=new Error(b);this.hls.trigger(_.ERROR,{type:vt.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:C,reason:R})}}),h.end=performance.now();return}e.audioTracks&&(u=e.audioTracks.filter(b=>!b.audioCodec||this.isAudioSupported(b.audioCodec)),Fv(u)),e.subtitles&&(d=e.subtitles,Fv(d));const p=f.slice(0);f.sort((b,R)=>{if(b.attrs["HDCP-LEVEL"]!==R.attrs["HDCP-LEVEL"])return(b.attrs["HDCP-LEVEL"]||"")>(R.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&b.height!==R.height)return b.height-R.height;if(b.frameRate!==R.frameRate)return b.frameRate-R.frameRate;if(b.videoRange!==R.videoRange)return pu.indexOf(b.videoRange)-pu.indexOf(R.videoRange);if(b.videoCodec!==R.videoCodec){const C=Cy(b.videoCodec),D=Cy(R.videoCodec);if(C!==D)return D-C}if(b.uri===R.uri&&b.codecSet!==R.codecSet){const C=hu(b.codecSet),D=hu(R.codecSet);if(C!==D)return D-C}return b.averageBitrate!==R.averageBitrate?b.averageBitrate-R.averageBitrate:0});let g=p[0];if(this.steering&&(f=this.steering.filterParsedLevels(f),f.length!==p.length)){for(let b=0;b<p.length;b++)if(p[b].pathwayId===f[0].pathwayId){g=p[b];break}}this._levels=f;for(let b=0;b<f.length;b++)if(f[b]===g){var y;this._firstLevel=b;const R=g.bitrate,C=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${f.length} level(s) found, first bitrate: ${R}`),((y=this.hls.userConfig)==null?void 0:y.abrEwmaDefaultEstimate)===void 0){const D=Math.min(R,this.hls.config.abrEwmaDefaultEstimateMax);D>C&&C===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=D)}break}const v=a&&!s,S=this.hls.config,T=!!(S.audioStreamController&&S.audioTrackController),A={levels:f,audioTracks:u,subtitleTracks:d,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:s,altAudio:T&&!v&&u.some(b=>!!b.url)};h.end=performance.now(),this.hls.trigger(_.MANIFEST_PARSED,A)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(e.length===0)return;if(t<0||t>=e.length){const h=new Error("invalid level idx"),p=t<0;if(this.hls.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:t,fatal:p,error:h,reason:h.message}),p)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,a=s?s.attrs["PATHWAY-ID"]:void 0,l=e[t],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=l,i===t&&s&&a===u)return;this.log(`Switching to level ${t} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${u?" with Pathway "+u:""} from level ${i}${a?" with Pathway "+a:""}`);const d={level:t,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(_.LEVEL_SWITCHING,d);const f=l.details;if(!f||f.live){const h=this.switchParams(l.uri,s?.details,f);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),i=t.filter(s=>e.indexOf(s)!==-1);if(t.length<1){this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);return}this.steering.pathwayPriority=i}}onError(t,e){e.fatal||!e.context||e.context.type===It.LEVEL&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(e!==void 0&&e.type===mt.MAIN){const i=e.elementaryStreams;if(!Object.keys(i).some(a=>!!i[a]))return;const s=this._levels[e.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(t,e){var i;const{level:s,details:a}=e,l=e.levelInfo;if(!l){var u;this.warn(`Invalid level index ${s}`),(u=e.deliveryDirectives)!=null&&u.skip&&(a.deltaUpdateFailed=!0);return}if(l===this.currentLevel||e.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let d=l.details;d===e.details&&d.advanced&&(d=void 0),this.playlistLoaded(s,e,d)}else(i=e.deliveryDirectives)!=null&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=this.getUrlWithDirectives(t.uri,e),s=this.currentLevelIndex,a=t.attrs["PATHWAY-ID"],l=t.details,u=l?.age;this.log(`Loading level index ${s}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""}${a?" Pathway "+a:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${i}`),this.hls.trigger(_.LEVEL_LOADING,{url:i,level:s,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(this._levels.length===1)return;const i=this._levels.filter((a,l)=>l!==t?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(u=>u.level=-1)),!1));Sx(i),this._levels=i,this.currentLevelIndex>-1&&(e=this.currentLevel)!=null&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=i.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(_.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(_.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Fv(r){const t={};r.forEach(e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function gS(){return self.SourceBuffer||self.WebKitSourceBuffer}function yS(){if(!hs())return!1;const t=gS();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function FI(){if(!yS())return!1;const r=hs();return typeof r?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>r.isTypeSupported(no(t,"video")))||["mp4a.40.2","fLaC"].some(t=>r.isTypeSupported(no(t,"audio"))))}function BI(){var r;const t=gS();return typeof(t==null||(r=t.prototype)==null?void 0:r.changeType)=="function"}const UI=100;class $I extends Ph{constructor(t,e,i){super(t,e,i,"stream-controller",mt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,a=s?s.currentTime:null;if(a===null||!ht(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const l=this.getFwdBufferInfoAtPos(s,a,mt.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(_.MANIFEST_PARSED,this.onManifestParsed,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.LEVEL_LOADED,this.onLevelLoaded,this),t.on(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(_.BUFFER_CREATED,this.onBufferCreated,this),t.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(_.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(_.MANIFEST_PARSED,this.onManifestParsed,this),t.off(_.LEVEL_LOADED,this.onLevelLoaded,this),t.off(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(_.BUFFER_CREATED,this.onBufferCreated,this),t.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(_.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(UI),this.level=-1,!this.startFragRequested){let a=s.startLevel;a===-1&&(s.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=s.firstAutoLevel),s.nextLoadLevel=a,this.level=s.loadLevel,this._hasEnoughToStart=!!e}i>0&&t===-1&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=at.IDLE,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=at.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case at.WAITING_LEVEL:{const{levels:t,level:e}=this,i=t?.[e],s=i?.details;if(s&&(!s.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(s))break;this.state=at.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=at.IDLE;break}break}case at.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===at.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),(t=this.media)!=null&&t.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:s}=this;if(e===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?t.nextLoadLevel:t.loadLevel;if(!(i!=null&&i[a]))return;const l=i[a],u=this.getMainFwdBufferInfo();if(u===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(u,d)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(_.BUFFER_EOS,S),this.state=at.ENDED;return}if(!this.buffering)return;t.loadLevel!==a&&t.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=t.nextLoadLevel=a;const f=l.details;if(!f||this.state===at.WAITING_LEVEL||this.waitForLive(l)){this.level=a,this.state=at.WAITING_LEVEL,this.startFragRequested=!1;return}const h=u.len,p=this.getMaxBufferLength(l.maxBitrate);if(h>=p)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:u.end;let y=this.getNextFragment(g,f);if(this.couldBacktrack&&!this.fragPrevious&&y&&xe(y)&&this.fragmentTracker.getState(y)!==Ae.OK){var v;const T=((v=this.backtrackFragment)!=null?v:y).sn-f.startSN,A=f.fragments[T-1];A&&y.cc===A.cc&&(y=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(y&&this.isLoopLoading(y,g)){if(!y.gap){const T=this.audioOnly&&!this.altAudio?Qt.AUDIO:Qt.VIDEO,A=(T===Qt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,T,mt.MAIN)}y=this.getNextFragmentLoopLoading(y,f,u,mt.MAIN,p)}y&&(y.initSegment&&!y.initSegment.data&&!this.bitrateTest&&(y=y.initSegment),this.loadFragment(y,l,g))}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);s===Ae.NOT_LOADED||s===Ae.PARTIAL?xe(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,mt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(e!=null&&e.readyState){let i;const s=this.getAppendedFrag(e.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<a.targetduration*2)return}if(!e.paused&&t){const u=this.hls.nextLoadLevel,d=t[u],f=this.fragLastKbps;f&&this.fragCurrent?i=this.fragCurrent.duration*d.maxBitrate/(1e3*f)+1:i=0}else i=0;const l=this.getBufferedFrag(e.currentTime+i);if(l){const u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();const d=u.maxStartPTS?u.maxStartPTS:u.start,f=u.duration,h=Math.max(l.end,d+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case at.KEY_LOADING:case at.FRAG_LOADING:case at.FRAG_LOADING_WAITING_RETRY:case at.PARSING:case at.PARSED:this.state=at.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio===2?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;Ke(i,"playing",this.onMediaPlaying),Ke(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:i}=this;i&&(ii(i,"playing",this.onMediaPlaying),ii(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e),!e.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(_.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,s=!1;for(let a=0;a<e.levels.length;a++){const l=e.levels[a].audioCodec;l&&(i=i||l.indexOf("mp4a.40.2")!==-1,s=s||l.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&s&&!BI(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==at.IDLE)return;const s=e.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=at.WAITING_LEVEL)}onLevelLoaded(t,e){var i;const{levels:s,startFragRequested:a}=this,l=e.level,u=e.details,d=u.totalduration;if(!s){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${d}`);const f=e.levelInfo,h=this.fragCurrent;h&&(this.state===at.FRAG_LOADING||this.state===at.FRAG_LOADING_WAITING_RETRY)&&h.level!==e.level&&h.loader&&this.abortCurrentFrag();let p=0;if(u.live||(i=f.details)!=null&&i.live){var g;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;p=this.alignPlaylists(u,f.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(f.details=u,this.levelLastLoaded=f,a||this.setStartPosition(u,p),this.hls.trigger(_.LEVEL_UPDATED,{details:u,level:l}),this.state===at.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=at.IDLE}a&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,a=this.getLoadPosition(),l=t.fragmentStart,u=t.edge,d=a>=l-e.maxFragLookUpTolerance&&a<=u;if(s!==null&&i.duration>s&&(a<s||!d)){const h=e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;if((!d&&i.readyState<4||a<u-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var f;const p=At.bufferInfo(i,s,0);if(!((f=p.buffered)!=null&&f.length)){i.currentTime=s;return}if(p.start<=a){i.currentTime=s;return}const{nextStart:y}=At.bufferedInfo(p.buffered,a,0);y&&(i.currentTime=y)}else i.currentTime=s}}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:s,payload:a}=t,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=l[i.level];if(!u){this.warn(`Level ${i.level} not found on progress`);return}const d=u.details;if(!d){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const f=u.videoCodec,h=d.PTSKnown||!d.live,p=(e=i.initSegment)==null?void 0:e.data,g=this._getAudioCodec(u),y=this.transmuxer=this.transmuxer||new Hx(this.hls,mt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),v=s?s.index:-1,S=v!==-1,T=new Oh(i.level,i.sn,i.stats.chunkCount,a.byteLength,v,S),A=this.initPTS[i.cc];y.push(a,p,g,f,i,s,d.totalduration,h,T,A)}onAudioTrackSwitching(t,e){const i=this.hls,s=this.altAudio===2;if(gu(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),i.once(_.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(_.AUDIO_TRACK_SWITCHED,e)}),i.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(_.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=gu(e.url,this.hls);if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){const i=e.tracks;let s,a,l=!1;for(const u in i){const d=i[u];if(d.id==="main"){if(a=u,s=d,u==="video"){const f=i[u];f&&(this.videoBuffer=f.buffer)}}else l=!0}l&&s?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:s}=e,a=i.type===mt.MAIN;if(a){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===at.PARSED&&(this.state=at.IDLE);return}const u=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),xe(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}const l=this.media;l&&(!this._hasEnoughToStart&&At.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal){this.state=at.ERROR;return}switch(e.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(mt.MAIN,e);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===at.WAITING_LEVEL&&((i=e.context)==null?void 0:i.type)===It.LEVEL&&(this.state=at.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onFragLoadEmergencyAborted(){this.state=at.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==Qt.AUDIO||!this.altAudio){const i=(e===Qt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,e,mt.MAIN),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking){this.log(`could not seek to ${i}, already seeking at ${e}`);return}const s=this.timelineOffset;s&&i&&(i+=s);const a=this.getLevelDetails(),l=At.getBuffered(t),u=l.length?l.start(0):0,d=u-i,f=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<f||this.loadingParts&&d<2*(a?.partTarget||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),i+=d,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${u}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e.indexOf("mp4a.40.5")!==-1?e="mp4a.40.2":e="mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(i=>{const{hls:s}=this,a=i?.frag;if(!a||this.fragContextChanged(a))return;e.fragmentError=0,this.state=at.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=a.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),s.trigger(_.FRAG_LOADED,i),a.bitrateTest=!1}).catch(i=>{this.state===at.STOPPED||this.state===at.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}_handleTransmuxComplete(t){const e=this.playlistType,{hls:i}=this,{remuxResult:s,chunkMeta:a}=t,l=this.getCurrentContext(a);if(!l){this.resetWhenMissingContext(a);return}const{frag:u,part:d,level:f}=l,{video:h,text:p,id3:g,initSegment:y}=s,{details:v}=f,S=this.altAudio?void 0:s.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=at.PARSING,y){const T=y.tracks;if(T){const C=u.initSegment||u;if(this.unhandledEncryptionError(y,u))return;this._bufferInitSegment(f,T,C,a),i.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:e,tracks:T})}const A=y.initPTS,b=y.timescale,R=this.initPTS[u.cc];if(ht(A)&&(!R||R.baseTime!==A||R.timescale!==b)){const C=y.trackId;this.initPTS[u.cc]={baseTime:A,timescale:b,trackId:C},i.trigger(_.INIT_PTS_FOUND,{frag:u,id:e,initPTS:A,timescale:b,trackId:C})}}if(h&&v){S&&h.type==="audiovideo"&&this.logMuxedErr(u);const T=v.fragments[u.sn-1-v.startSN],A=u.sn===v.startSN,b=!T||u.cc>T.cc;if(s.independent!==!1){const{startPTS:R,endPTS:C,startDTS:D,endDTS:N}=h;if(d)d.elementaryStreams[h.type]={startPTS:R,endPTS:C,startDTS:D,endDTS:N};else if(h.firstKeyFrame&&h.independent&&a.id===1&&!b&&(this.couldBacktrack=!0),h.dropped&&h.independent){const w=this.getMainFwdBufferInfo(),P=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,B=h.firstKeyFramePTS?h.firstKeyFramePTS:R;if(!A&&P<B-this.config.maxBufferHole&&!b){this.backtrack(u);return}else b&&(u.gap=!0);u.setElementaryStreamInfo(h.type,u.start,C,u.start,N,!0)}else A&&R-(v.appliedTimelineOffset||0)>ru&&(u.gap=!0);u.setElementaryStreamInfo(h.type,R,C,D,N),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(h,u,d,a,A||b)}else if(A||b)u.gap=!0;else{this.backtrack(u);return}}if(S){const{startPTS:T,endPTS:A,startDTS:b,endDTS:R}=S;d&&(d.elementaryStreams[Qt.AUDIO]={startPTS:T,endPTS:A,startDTS:b,endDTS:R}),u.setElementaryStreamInfo(Qt.AUDIO,T,A,b,R),this.bufferFragmentData(S,u,d,a)}if(v&&g!=null&&g.samples.length){const T={id:e,frag:u,details:v,samples:g.samples};i.trigger(_.FRAG_PARSING_METADATA,T)}if(v&&p){const T={id:e,frag:u,details:v,samples:p.samples};i.trigger(_.FRAG_PARSING_USERDATA,T)}}logMuxedErr(t){this.warn(`${xe(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,s){if(this.state!==at.PARSING)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));const{audio:a,video:l,audiovideo:u}=e;if(a){const f=t.audioCodec;let h=Zl(a.codec,f);h==="mp4a"&&(h="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const g=a.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),f&&f!==h&&this.log(`Swapping manifest audio codec "${f}" for "${h}"`),a.levelCodec=h,a.id=mt.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${h||""}/${f||""}/${a.codec}]`),delete e.audiovideo}if(l){l.levelCodec=t.videoCodec,l.id=mt.MAIN;const f=l.codec;if(f?.length===4)switch(f){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${t.videoCodec||""}/${f}]${l.codec!==f?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete e.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${t.codecs}/${u.codec}]`),delete e.video,delete e.audio);const d=Object.keys(e);if(d.length){if(this.hls.trigger(_.BUFFER_CODECS,e),!this.hls)return;d.forEach(f=>{const p=e[f].initSegment;p!=null&&p.byteLength&&this.hls.trigger(_.BUFFER_APPENDING,{type:f,data:p,frag:i,part:null,chunkMeta:s,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,mt.MAIN)}get maxBufferLength(){const{levels:t,level:e}=this,i=t?.[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=at.IDLE}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&t.seeking===!1){const i=t.currentTime;if(At.isBuffered(t,i)?e=this.getAppendedFrag(i):At.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const s=this.fragPlaying,a=e.level;(!s||e.sn!==s.sn||s.level!==a)&&(this.fragPlaying=e,this.hls.trigger(_.FRAG_CHANGED,{frag:e}),(!s||s.level!==a)&&this.hls.trigger(_.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;return ht(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;if(ht(e)){const i=this.getLevelDetails(),s=this.currentFrag||(i?Vs(null,i.fragments,e):null);if(s){const a=s.programDateTime;if(a!==null){const l=a+(e-s.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class jI extends wi{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[i].loader;if(s){var e;if(t&&t!==((e=s.context)==null?void 0:e.frag.type))return;s.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t,e=Q.KEY_LOAD_ERROR,i,s,a){return new wn({type:vt.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:a,error:i,networkDetails:s})}loadClear(t,e,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let s=0,a=e.length;s<a;s++){const l=e[s];if(t.cc<=l.cc&&(!xe(t)||!xe(l)||t.sn<l.sn)||!i&&s==a-1)return this.emeController.selectKeySystemFormat(l).then(u=>{if(!this.emeController)return;l.setKeyFormat(u);const d=tu(u);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const s=Xa(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var i,s;e&&t.setKeyFormat(e);const a=t.decryptdata;if(!a){const f=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,f))}const l=a.uri;if(!l)return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));const u=kd(a);let d=this.keyIdToKeyInfo[u];if((i=d)!=null&&i.decryptdata.key)return a.key=d.decryptdata.key,Promise.resolve({frag:t,keyInfo:d});if(this.emeController&&(s=d)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(d.decryptdata)){case"usable":case"usable-in-future":return d.keyLoadPromise.then(h=>{const{keyInfo:p}=h;return a.key=p.decryptdata.key,{frag:t,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[u]?"Rel":"L"}oading${a.keyId?" keyId: "+Ve(a.keyId):""} URI: ${a.uri} from ${t.type} ${t.level}`),d=this.keyIdToKeyInfo[u]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(d,t):this.loadKeyEME(d,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(d,t);default:return Promise.reject(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var s;if(!t.decryptdata.keyId&&(s=e.initSegment)!=null&&s.data){const l=a_(e.initSegment.data);if(l.length){const u=l[0];u.some(d=>d!==0)&&(this.log(`Using keyId found in init segment ${Ve(u)}`),t.decryptdata.keyId=u,Gs.setKeyIdForUri(t.decryptdata.uri,u))}}const a=this.emeController.loadKey(i);return(t.keyLoadPromise=a.then(l=>(t.mediaKeySessionContext=l,i))).catch(l=>{throw t.keyLoadPromise=null,"data"in l&&(l.data.frag=e),l})}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,s=i.loader,a=new s(i);return e.keyLoader=t.loader=a,t.keyLoadPromise=new Promise((l,u)=>{const d={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},f=i.keyLoadPolicy.default,h={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,y,v,S)=>{const{frag:T,keyInfo:A}=v,b=kd(A.decryptdata);if(!T.decryptdata||A!==this.keyIdToKeyInfo[b])return u(this.createKeyLoadError(T,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));A.decryptdata.key=T.decryptdata.key=new Uint8Array(g.data),T.keyLoader=null,A.loader=null,l({frag:T,keyInfo:A})},onError:(g,y,v,S)=>{this.resetLoader(y),u(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${g.code} loading key ${g.text}`),v,zt({url:d.url,data:void 0},g)))},onTimeout:(g,y,v)=>{this.resetLoader(y),u(this.createKeyLoadError(e,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),v))},onAbort:(g,y,v)=>{this.resetLoader(y),u(this.createKeyLoadError(e,Q.INTERNAL_ABORTED,new Error("key loading aborted"),v))}};a.load(d,h,p)})}resetLoader(t){const{frag:e,keyInfo:i,url:s}=t,a=i.loader;e.keyLoader===a&&(e.keyLoader=null,i.loader=null);const l=kd(i.decryptdata)||s;delete this.keyIdToKeyInfo[l],a&&a.destroy()}}function kd(r){if(r.keyFormat!==Be.FAIRPLAY){const t=r.keyId;if(t)return Ve(t)}return r.uri}function Bv(r){const{type:t}=r;switch(t){case It.AUDIO_TRACK:return mt.AUDIO;case It.SUBTITLE_TRACK:return mt.SUBTITLE;default:return mt.MAIN}}function Md(r,t){let e=r.url;return(e===void 0||e.indexOf("data:")===0)&&(e=t.url),e}class GI{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(_.MANIFEST_LOADING,this.onManifestLoading,this),t.on(_.LEVEL_LOADING,this.onLevelLoading,this),t.on(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(_.MANIFEST_LOADING,this.onManifestLoading,this),t.off(_.LEVEL_LOADING,this.onLevelLoading,this),t.off(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,s=e.loader,a=i||s,l=new a(e);return this.loaders[t.type]=l,l}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:It.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:i,level:s,pathwayId:a,url:l,deliveryDirectives:u,levelInfo:d}=e;this.load({id:i,level:s,pathwayId:a,responseType:"text",type:It.LEVEL,url:l,deliveryDirectives:u,levelOrTrack:d})}onAudioTrackLoading(t,e){const{id:i,groupId:s,url:a,deliveryDirectives:l,track:u}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:It.AUDIO_TRACK,url:a,deliveryDirectives:l,levelOrTrack:u})}onSubtitleTrackLoading(t,e){const{id:i,groupId:s,url:a,deliveryDirectives:l,track:u}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:It.SUBTITLE_TRACK,url:a,deliveryDirectives:l,levelOrTrack:u})}onLevelsUpdated(t,e){const i=this.loaders[It.LEVEL];if(i){const s=i.context;s&&!e.levels.some(a=>a===s.levelOrTrack)&&(i.abort(),delete this.loaders[It.LEVEL])}}load(t){var e;const i=this.hls.config;let s=this.getInternalLoader(t);if(s){const f=this.hls.logger,h=s.context;if(h&&h.levelOrTrack===t.levelOrTrack&&(h.url===t.url||h.deliveryDirectives&&!t.deliveryDirectives)){h.url===t.url?f.log(`[playlist-loader]: ignore ${t.url} ongoing request`):f.log(`[playlist-loader]: ignore ${t.url} in favor of ${h.url}`);return}f.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),s.abort()}let a;if(t.type===It.MANIFEST?a=i.manifestLoadPolicy.default:a=Xt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(t),ht((e=t.deliveryDirectives)==null?void 0:e.part)){let f;if(t.type===It.LEVEL&&t.level!==null?f=this.hls.levels[t.level].details:t.type===It.AUDIO_TRACK&&t.id!==null?f=this.hls.audioTracks[t.id].details:t.type===It.SUBTITLE_TRACK&&t.id!==null&&(f=this.hls.subtitleTracks[t.id].details),f){const h=f.partTarget,p=f.targetduration;if(h&&p){const g=Math.max(h*3,p*.8)*1e3;a=Xt({},a,{maxTimeToFirstByteMs:Math.min(g,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(g,a.maxTimeToFirstByteMs)})}}}const l=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:(f,h,p,g)=>{const y=this.getInternalLoader(p);this.resetInternalLoader(p.type);const v=f.data;h.parsing.start=performance.now(),Qi.isMediaPlaylist(v)||p.type!==It.MANIFEST?this.handleTrackOrLevelPlaylist(f,h,p,g||null,y):this.handleMasterPlaylist(f,h,p,g)},onError:(f,h,p,g)=>{this.handleNetworkError(h,p,!1,f,g)},onTimeout:(f,h,p)=>{this.handleNetworkError(h,p,!0,void 0,f)}};s.load(t,u,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,s){const a=this.hls,l=t.data,u=Md(t,i),d=Qi.parseMasterPlaylist(l,u);if(d.playlistParsingError){e.parsing.end=performance.now(),this.handleManifestParsingError(t,i,d.playlistParsingError,s,e);return}const{contentSteering:f,levels:h,sessionData:p,sessionKeys:g,startTimeOffset:y,variableList:v}=d;this.variableList=v,h.forEach(b=>{const{unknownCodecs:R}=b;if(R){const{preferManagedMediaSource:C}=this.hls.config;let{audioCodec:D,videoCodec:N}=b;for(let w=R.length;w--;){const P=R[w];io(P,"audio",C)?(b.audioCodec=D=D?`${D},${P}`:P,qr.audio[D.substring(0,4)]=2,R.splice(w,1)):io(P,"video",C)&&(b.videoCodec=N=N?`${N},${P}`:P,qr.video[N.substring(0,4)]=2,R.splice(w,1))}}});const{AUDIO:S=[],SUBTITLES:T,"CLOSED-CAPTIONS":A}=Qi.parseMasterPlaylistMedia(l,u,d);S.length&&!S.some(R=>!R.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new se({}),bitrate:0,url:""})),a.trigger(_.MANIFEST_LOADED,{levels:h,audioTracks:S,subtitles:T,captions:A,contentSteering:f,url:u,stats:e,networkDetails:s,sessionData:p,sessionKeys:g,startTimeOffset:y,variableList:v})}handleTrackOrLevelPlaylist(t,e,i,s,a){const l=this.hls,{id:u,level:d,type:f}=i,h=Md(t,i),p=ht(d)?d:ht(u)?u:0,g=Bv(i),y=Qi.parseLevelPlaylist(t.data,h,p,g,0,this.variableList);if(f===It.MANIFEST){const v={attrs:new se({}),bitrate:0,details:y,name:"",url:h};y.requestScheduled=e.loading.start+vx(y,0),l.trigger(_.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:h,stats:e,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=y,this.handlePlaylistLoaded(y,t,e,i,s,a)}handleManifestParsingError(t,e,i,s,a){this.hls.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:e.type===It.MANIFEST,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:s,stats:a})}handleNetworkError(t,e,i=!1,s,a){let l=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${t.type}`;t.type===It.LEVEL?l+=`: ${t.level} id: ${t.id}`:(t.type===It.AUDIO_TRACK||t.type===It.SUBTITLE_TRACK)&&(l+=` id: ${t.id} group-id: "${t.groupId}"`);const u=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let d=Q.UNKNOWN,f=!1;const h=this.getInternalLoader(t);switch(t.type){case It.MANIFEST:d=i?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,f=!0;break;case It.LEVEL:d=i?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,f=!1;break;case It.AUDIO_TRACK:d=i?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case It.SUBTITLE_TRACK:d=i?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,f=!1;break}h&&this.resetInternalLoader(t.type);const p={type:vt.NETWORK_ERROR,details:d,fatal:f,url:t.url,loader:h,context:t,error:u,networkDetails:e,stats:a};if(s){const g=e?.url||t.url;p.response=zt({url:g,data:void 0},s)}this.hls.trigger(_.ERROR,p)}handlePlaylistLoaded(t,e,i,s,a,l){const u=this.hls,{type:d,level:f,levelOrTrack:h,id:p,groupId:g,deliveryDirectives:y}=s,v=Md(e,s),S=Bv(s);let T=typeof s.level=="number"&&S===mt.MAIN?f:void 0;const A=t.playlistParsingError;if(A){if(this.hls.logger.warn(`${A} ${t.url}`),!u.config.ignorePlaylistParsingErrors){u.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:A,reason:A.message,response:e,context:s,level:T,parent:S,networkDetails:a,stats:i});return}t.playlistParsingError=null}if(!t.fragments.length){const b=t.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(_.ERROR,{type:vt.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:b,reason:b.message,response:e,context:s,level:T,parent:S,networkDetails:a,stats:i});return}switch(t.live&&l&&(l.getCacheAge&&(t.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),d){case It.MANIFEST:case It.LEVEL:if(T){if(!h)T=0;else if(h!==u.levels[T]){const b=u.levels.indexOf(h);b>-1&&(T=b)}}u.trigger(_.LEVEL_LOADED,{details:t,levelInfo:h||u.levels[0],level:T||0,id:p||0,stats:i,networkDetails:a,deliveryDirectives:y,withoutMultiVariant:d===It.MANIFEST});break;case It.AUDIO_TRACK:u.trigger(_.AUDIO_TRACK_LOADED,{details:t,track:h,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:y});break;case It.SUBTITLE_TRACK:u.trigger(_.SUBTITLE_TRACK_LOADED,{details:t,track:h,id:p||0,groupId:g||"",stats:i,networkDetails:a,deliveryDirectives:y});break}}}class In{static get version(){return ro}static isMSESupported(){return yS()}static isSupported(){return FI()}static getMediaSource(){return hs()}static get Events(){return _}static get MetadataSchema(){return mi}static get ErrorTypes(){return vt}static get ErrorDetails(){return Q}static get DefaultConfig(){return In.defaultConfig?In.defaultConfig:RI}static set DefaultConfig(t){In.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Nh,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=YL(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=_I(In.DefaultConfig,t,e);this.userConfig=t,i.progressive&&CI(i,e);const{abrController:s,bufferController:a,capLevelController:l,errorController:u,fpsController:d}=i,f=new u(this),h=this.abrController=new s(this),p=new H_(this),g=i.interstitialsController,y=g?this.interstitialsController=new g(this,In):null,v=this.bufferController=new a(this,p),S=this.capLevelController=new l(this),T=new d(this),A=new GI(this),b=i.contentSteeringController,R=b?new b(this):null,C=this.levelController=new NI(this,R),D=new MI(this),N=new jI(this.config,this.logger),w=this.streamController=new $I(this,p,N),P=this.gapController=new OI(this,p);S.setStreamController(w),T.setStreamController(w);const B=[A,C,w];y&&B.splice(1,0,y),R&&B.splice(1,0,R),this.networkControllers=B;const M=[h,v,P,S,T,D,p];this.audioTrackController=this.createController(i.audioTrackController,B);const K=i.audioStreamController;K&&B.push(this.audioStreamController=new K(this,p,N)),this.subtitleTrackController=this.createController(i.subtitleTrackController,B);const tt=i.subtitleStreamController;tt&&B.push(this.subtititleStreamController=new tt(this,p,N)),this.createController(i.timelineController,M),N.emeController=this.emeController=this.createController(i.emeController,M),this.cmcdController=this.createController(i.cmcdController,M),this.latencyController=this.createController(PI,M),this.coreComponents=M,B.push(f);const z=f.onErrorOut;typeof z=="function"&&this.on(_.ERROR,z,f),this.on(_.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(t,e){if(t){const i=new t(this);return e&&e.push(i),i}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,s){this._emitter.off(t,e,i,s)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const s=t===_.ERROR;this.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:s,event:t,error:i}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(_.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const a=new Error(`attachMedia failed: invalid argument (${t})`);this.trigger(_.ERROR,{type:vt.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,i=e?t.media:t,s=e?t:{media:i};this._media=i,this.trigger(_.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(_.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(_.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,i=this._url,s=this._url=Rh.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),e&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(_.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(t=-1,e){this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!(this.started||!this.networkControllers));t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()}))}get inFlightFragments(){const t={[mt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[mt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[mt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=t?.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=OD()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){__(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let s=0;s<i;s++)if(t[s].maxBitrate>=e)return s;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this;let s;if(e===-1&&t!=null&&t.length?s=t.length-1:s=e,i)for(let a=s;a--;){const l=t[a].attrs["HDCP-LEVEL"];if(l&&l<=i)return a}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return((e=this.audioTrackController)==null?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return((e=this.subtitleTrackController)==null?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!!((t=this.bufferController)!=null&&t.bufferedToEnd)}get interstitialsManager(){var t;return((t=this.interstitialsController)==null?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t,e=this.allAudioTracks){const i=nx(e);return ex(t,i,navigator.mediaCapabilities)}}In.defaultConfig=void 0;function HI({url:r,containerRef:t}){const e=F.useRef(null);return F.useEffect(()=>{if(!t?.current)return;const i=new UL({container:t.current,url:r,type:"m3u8",autoSize:!0,fullscreen:!0,fullscreenWeb:!0,playbackRate:!0,aspectRatio:!0,setting:!0,customType:{m3u8:(l,u)=>{if(In.isSupported()){const d=new In;d.loadSource(u),d.attachMedia(l)}else l.canPlayType("application/vnd.apple.mpegurl")&&(l.src=u)}}});e.current=i;const s=l=>{(l.key==="f"||l.key==="F")&&(i.fullscreen=!i.fullscreen)};let a=!1;return i.on("focus",()=>{a||(window.addEventListener("keydown",s),a=!0)}),i.on("blur",()=>{a&&(window.removeEventListener("keydown",s),a=!1)}),()=>{i&&i.destroy(!0)}},[]),F.useEffect(()=>{e.current&&e.current.url!==r&&e.current.switchUrl(r,"Tp mi")},[r]),null}const zI="_watch_ysw7b_2",VI="_info_ysw7b_83",KI="_episodes_ysw7b_159",qI="_active_ysw7b_178",YI={watch:zI,"watch-container":"_watch-container_ysw7b_7","watch-player":"_watch-player_ysw7b_7","player-center":"_player-center_ysw7b_16","player-return":"_player-return_ysw7b_27","player-ratio":"_player-ratio_ysw7b_40","watch-main":"_watch-main_ysw7b_62","watch-info":"_watch-info_ysw7b_71","thumb-container":"_thumb-container_ysw7b_79","info-thumb":"_info-thumb_ysw7b_83",info:VI,"info-name":"_info-name_ysw7b_105","info-alias-name":"_info-alias-name_ysw7b_111","info-detail":"_info-detail_ysw7b_118","detail-tags":"_detail-tags_ysw7b_124","tag-topic":"_tag-topic_ysw7b_129","detail-desc":"_detail-desc_ysw7b_138",episodes:KI,"episodes-button":"_episodes-button_ysw7b_165",active:qI,"watch-side":"_watch-side_ysw7b_192","actors-header":"_actors-header_ysw7b_197","actors-container":"_actors-container_ysw7b_202","actors-item":"_actors-item_ysw7b_209","actors-img":"_actors-img_ysw7b_215","actors-name":"_actors-name_ysw7b_222"},XI=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M73.4 297.4C60.9 309.9 60.9 330.2 73.4 342.7L233.4 502.7C245.9 515.2 266.2 515.2 278.7 502.7C291.2 490.2 291.2 469.9 278.7 457.4L173.3 352L544 352C561.7 352 576 337.7 576 320C576 302.3 561.7 288 544 288L173.3 288L278.7 182.6C291.2 170.1 291.2 149.8 278.7 137.3C266.2 124.8 245.9 124.8 233.4 137.3L73.4 297.3z"})),Bt=qs.bind(YI);function Uv(){const{slug:r,episodeSlug:t}=b1(),[e,i]=F.useState(null),[s,a]=F.useState(null),l=F.useRef();F.useEffect(()=>{const g=`https://ophim1.com/v1/api/phim/${r}`;fetch(g,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>i(T.data)).catch(T=>console.error(T));const v=g+"/peoples";fetch(v,{method:"GET",headers:{accept:"application/json"}}).then(T=>T.json()).then(T=>a(T.data)).catch(T=>console.error(T))},[r]);const u=F.useMemo(()=>e?.breadCrumb.slice(0,2)||[],[e]),d=F.useMemo(()=>e?.breadCrumb.slice(2,e?.breadCrumb.length-1)||[],[e]),f=F.useMemo(()=>e?.item.episodes[0].server_data||[],[e]),h=F.useMemo(()=>f.length?t&&f.find(g=>g.slug===t)||f[0]:null,[f,t]),p=F.useMemo(()=>e?.item?.content&&new DOMParser().parseFromString(e.item.content,"text/html").body.textContent||"",[e]);return r?e?X.jsxs("div",{className:Bt("watch"),children:[X.jsxs("div",{className:Bt("watch-player"),children:[X.jsxs("div",{className:Bt("player-center"),children:[X.jsx(Ur,{to:`/movies/${r}`,className:Bt("player-return"),children:X.jsx(XI,{})}),X.jsxs("div",{className:Bt("player-name"),children:["X l play pause bng du cch, X l focus blur input B call API ly nh thanh search https://img.ophim.live/uploads/movies/ + path CSS control Thm webkit gii hn cho desc Xem phim ",e.item.name]})]}),X.jsx("div",{className:Bt("player-ratio"),ref:l,children:X.jsx(HI,{url:h?.link_m3u8,containerRef:l})})]}),X.jsxs("div",{className:Bt("watch-container"),children:[X.jsxs("div",{className:Bt("watch-main"),children:[X.jsxs("div",{className:Bt("watch-info"),children:[X.jsx("div",{className:Bt("thumb-container"),children:X.jsx("div",{className:Bt("info-thumb"),children:X.jsx("img",{src:e.APP_DOMAIN_CDN_IMAGE+"/uploads/"+e.seoOnPage.og_image[0],alt:e.item.name})})}),X.jsx("div",{className:Bt("info"),children:X.jsxs("div",{children:[X.jsx("div",{className:Bt("info-name"),children:X.jsx(Ur,{to:`/movies/${e.params.slug}`,children:e.item.name})}),X.jsx("div",{className:Bt("info-alias-name"),children:e.item.origin_name}),X.jsxs("div",{className:Bt("info-detail"),children:[X.jsx("div",{className:Bt("detail-tags"),children:u.map((g,y)=>X.jsx("a",{className:Bt("tag-topic"),href:g.slug,children:g.name},y))}),X.jsx("div",{className:Bt("detail-tags"),children:d.map((g,y)=>X.jsx("a",{className:Bt("tag-topic"),href:g.slug,children:g.name},y))})]})]})}),X.jsxs("div",{className:Bt("detail-desc"),children:[X.jsx("div",{className:Bt("desc"),children:p}),X.jsxs(Ur,{to:`/movies/${e.params.slug}`,children:["Thng tin phim",X.jsx($E,{})]})]})]}),X.jsx("div",{className:Bt("watch-episodes"),children:X.jsx("div",{className:Bt("episodes"),children:f.length>1&&f.map(g=>{const y=t===g.slug||!t&&g.slug===f[0].slug;return X.jsxs(Ur,{to:`/watch/${r}/${g.slug}`,className:Bt("episodes-button",{active:y}),children:[X.jsx(UE,{}),"Tp ",g.name]},g.slug)})})})]}),X.jsxs("div",{className:Bt("watch-side"),children:[X.jsx("div",{className:Bt("side-rate")}),X.jsxs("div",{className:Bt("side-actors"),children:[X.jsx("div",{className:Bt("actors-header"),children:"Din vin"}),X.jsx("div",{className:Bt("actors-container"),children:s&&s.peoples.map(g=>X.jsxs("div",{className:Bt("actors-item"),children:[X.jsx("div",{className:Bt("actors-img"),children:X.jsx("img",{src:s.profile_sizes.original+g.profile_path,alt:g.name})}),X.jsx("div",{className:Bt("actors-name"),children:g.name})]},g.id))})]})]})]})]}):X.jsx("div",{className:Bt("loading"),children:"ang ti phim..."}):X.jsxs("div",{children:[X.jsx("h1",{children:"Trang danh sch phim (Watch)"}),X.jsx("p",{children:"Hin th danh sch cc phim..."})]})}const WI="_fixed_4e0uc_8",QI="_header_4e0uc_1",ZI="_logo_4e0uc_29",JI={"header-wrapper":"_header-wrapper_4e0uc_1",fixed:WI,header:QI,logo:ZI},t2="_search_1as0s_2",e2="_fadeInUp_1as0s_1",i2="_item_1as0s_94",n2="_spinner_1as0s_1",s2={search:t2,"search-container":"_search-container_1as0s_6","search-element":"_search-element_1as0s_10","search-icon":"_search-icon_1as0s_14","remove-icon":"_remove-icon_1as0s_28","search-input":"_search-input_1as0s_42","search-list":"_search-list_1as0s_56",fadeInUp:e2,"list-container":"_list-container_1as0s_82","list-title":"_list-title_1as0s_89",item:i2,"item-poster-container":"_item-poster-container_1as0s_108","item-poster":"_item-poster_1as0s_108","item-desc":"_item-desc_1as0s_130","item-name":"_item-name_1as0s_149","item-tag-span":"_item-tag-span_1as0s_155","view-all":"_view-all_1as0s_173","no-result":"_no-result_1as0s_190","loading-icon":"_loading-icon_1as0s_207",spinner:n2},r2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M480 272C480 317.9 465.1 360.3 440 394.7L566.6 521.4C579.1 533.9 579.1 554.2 566.6 566.7C554.1 579.2 533.8 579.2 521.3 566.7L394.7 440C360.3 465.1 317.9 480 272 480C157.1 480 64 386.9 64 272C64 157.1 157.1 64 272 64C386.9 64 480 157.1 480 272zM272 416C351.5 416 416 351.5 416 272C416 192.5 351.5 128 272 128C192.5 128 128 192.5 128 272C128 351.5 192.5 416 272 416z"})),a2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM231 231C240.4 221.6 255.6 221.6 264.9 231L319.9 286L374.9 231C384.3 221.6 399.5 221.6 408.8 231C418.1 240.4 418.2 255.6 408.8 264.9L353.8 319.9L408.8 374.9C418.2 384.3 418.2 399.5 408.8 408.8C399.4 418.1 384.2 418.2 374.9 408.8L319.9 353.8L264.9 408.8C255.5 418.2 240.3 418.2 231 408.8C221.7 399.4 221.6 384.2 231 374.9L286 319.9L231 264.9C221.6 255.5 221.6 240.3 231 231z"})),o2=r=>F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",...r},F.createElement("path",{d:"M272 112C272 85.5 293.5 64 320 64C346.5 64 368 85.5 368 112C368 138.5 346.5 160 320 160C293.5 160 272 138.5 272 112zM272 528C272 501.5 293.5 480 320 480C346.5 480 368 501.5 368 528C368 554.5 346.5 576 320 576C293.5 576 272 554.5 272 528zM112 272C138.5 272 160 293.5 160 320C160 346.5 138.5 368 112 368C85.5 368 64 346.5 64 320C64 293.5 85.5 272 112 272zM480 320C480 293.5 501.5 272 528 272C554.5 272 576 293.5 576 320C576 346.5 554.5 368 528 368C501.5 368 480 346.5 480 320zM139 433.1C157.8 414.3 188.1 414.3 206.9 433.1C225.7 451.9 225.7 482.2 206.9 501C188.1 519.8 157.8 519.8 139 501C120.2 482.2 120.2 451.9 139 433.1zM139 139C157.8 120.2 188.1 120.2 206.9 139C225.7 157.8 225.7 188.1 206.9 206.9C188.1 225.7 157.8 225.7 139 206.9C120.2 188.1 120.2 157.8 139 139zM501 433.1C519.8 451.9 519.8 482.2 501 501C482.2 519.8 451.9 519.8 433.1 501C414.3 482.2 414.3 451.9 433.1 433.1C451.9 414.3 482.2 414.3 501 433.1z"})),fe=qs.bind(s2);function l2(){const[r,t]=F.useState(""),[e,i]=F.useState([]),[s,a]=F.useState(!0),[l,u]=F.useState(!0),[d,f]=F.useState(!0),h=F.useRef(null);return F.useEffect(()=>{if(!r.trim()){i([]);return}const p=setTimeout(()=>{const g=`https://ophim1.com/v1/api/tim-kiem?keyword=${r}`,y={method:"GET",headers:{accept:"application/json"}};fetch(g,y).then(v=>v.json()).then(v=>{u(!0);const T=(v.data.items||[]).slice(0,5);if(console.log(T),T.length===0){i([]);return}const A=T.map(b=>{const R=`https://ophim1.com/v1/api/phim/${b.slug}/images`;return fetch(R,y).then(C=>C.json()).then(C=>{const w=`https://image.tmdb.org/t/p/original${C.data.images.find(P=>P.type==="poster").file_path}`;return b.posterHandlePath=w,b}).catch(C=>(console.error(`Li khi ly nh cho ${b.slug}:`,C),b))});return Promise.all(A)}).then(v=>{v&&(i(v),u(!1))}).catch(v=>{console.error("Li trong chui API:",v),i([])})},400);return()=>{clearTimeout(p)}},[r]),X.jsx("div",{className:fe("search"),children:X.jsxs("div",{className:fe("search-container"),children:[X.jsxs("div",{className:fe("search-element"),children:[X.jsx("div",{className:fe("search-icon"),children:X.jsx(r2,{})}),X.jsx("input",{value:r,onChange:p=>t(p.target.value),id:"main-search",className:fe("search-input"),type:"text",placeholder:"Tm kim phim",autoComplete:"off",ref:h}),X.jsx("div",{onClick:()=>{t(""),h.current.focus()},className:fe("remove-icon"),children:r.length>0&&X.jsx(a2,{})})]}),s&&r&&X.jsxs("div",{className:fe("search-list"),children:[r.length>0&&e.length==0&&X.jsx("div",{className:fe("no-result"),children:"Khng tm thy kt qu"}),l&&d&&X.jsx(o2,{className:fe("loading-icon")}),!l&&r.length>0&&e.length>0&&X.jsxs("div",{className:fe("list-container"),children:[X.jsx("div",{className:fe("list-title"),children:"Danh sch phim"}),X.jsx("div",{className:fe("list-result"),children:r.length>0&&e.map(p=>X.jsxs("a",{className:fe("item"),href:`/watch/${p.slug}`,children:[X.jsx("div",{className:fe("item-poster-container"),children:X.jsx("div",{className:fe("item-poster"),children:X.jsx("img",{onLoad:()=>f(!1),src:p.posterHandlePath,alt:"poster"})})}),X.jsxs("div",{className:fe("item-desc"),children:[X.jsx("div",{className:fe("item-name"),children:p.name}),X.jsx("div",{className:fe("item-origin-name"),children:p.origin_name}),X.jsxs("div",{className:fe("item-tag"),children:[X.jsx("span",{children:p.year}),X.jsx("span",{className:fe("item-tag-span"),children:p.time}),X.jsx("span",{className:fe("item-tag-span"),children:p.episode_current||p.time})]})]})]},p._id))})]}),r.length>0&&e.length>0&&X.jsx("a",{className:fe("view-all"),href:"/tim-kiem?q=a",children:"Ton b kt qu"})]})]})})}const Pd=qs.bind(JI);function vS(){return X.jsx("div",{className:Pd("header-wrapper","fixed"),children:X.jsxs("div",{className:Pd("header"),children:[X.jsx("a",{href:"/",className:Pd("logo"),children:X.jsx("img",{src:"/logo.svg",alt:"ATPhim"})}),X.jsx(l2,{}),X.jsx("div",{style:{backgroundColor:"blue",width:"882px",height:"40px"}})]})})}function u2(){}function c2({children:r}){return X.jsxs("div",{children:[X.jsx(vS,{}),X.jsxs("div",{className:"container",children:[X.jsx(u2,{}),r]})]})}function $v({children:r}){return X.jsxs("div",{children:[X.jsx(vS,{}),X.jsx("div",{className:"contaier",children:r})]})}const f2=[{path:"/",component:BL},{path:"/watch/:slug",component:Uv,layout:$v},{path:"/watch/:slug/:episodeSlug",component:Uv,layout:$v}];function d2(){return X.jsx(X.Fragment,{children:X.jsx(oA,{children:X.jsx("div",{className:"app",children:X.jsx(B1,{children:f2.map((r,t)=>{const e=r.component;let i=c2;return r.layout?i=r.layout:r.layout===null&&(i=F.Fragment),X.jsx(Jv,{path:r.path,element:X.jsx(i,{children:X.jsx(e,{})})},t)})})})})})}Vb.createRoot(document.getElementById("root")).render(X.jsx(F.StrictMode,{children:X.jsx(Kb,{children:X.jsx(d2,{})})}))});export default h2();
